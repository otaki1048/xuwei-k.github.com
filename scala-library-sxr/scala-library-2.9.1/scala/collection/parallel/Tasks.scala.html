<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>scala/collection/parallel/Tasks.scala</title>
        <script type="text/javascript" src="../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/*                     __                                               *\
**     ________ ___   / /  ___     Scala API                            **
**    / __/ __// _ | / /  / _ |    (c) 2003-2011, LAMP/EPFL             **
**  __\ \/ /__/ __ |/ /__/ __ |    http://scala-lang.org/               **
** /____/\___/_/ |_/____/_/ | |                                         **
**                          |/                                          **
\*                                                                      */</span>


<span class="keyword">package</span> scala.collection.parallel




<span class="keyword">import</span> scala.concurrent.forkjoin._
<span class="keyword">import</span> scala.util.control.<a href="../../util/control/Breaks.scala.html#21839" title="object scala.util.control.Breaks">Breaks</a>._


<span class="keyword">import</span> annotation.unchecked.uncheckedVariance




<span class="comment">/** A trait that declares task execution capabilities used
 *  by parallel collections.
 */</span>
<span class="keyword">trait</span> <a title="trait Tasks extends java.lang.Object with ScalaObject" id="16913">Tasks</a> <a href="../../ScalaObject.scala.html#460" title="ScalaObject" class="delimiter">{</a>
  
  <span class="keyword">private</span><span class="delimiter">[</span>parallel<span class="delimiter">]</span> <span class="keyword">val</span> <a title="scala.collection.mutable.ArrayBuffer[String]" id="215840">debugMessages</a> = collection.mutable.<a href="../generic/GenericCompanion.scala.html#26139" title="[A](elems: A*)scala.collection.mutable.ArrayBuffer[A]">ArrayBuffer</a><span title="(elems: String*)scala.collection.mutable.ArrayBuffer[String]" class="delimiter">[</span><span title="String">String</span><span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>
  
  <span class="keyword">private</span><span class="delimiter">[</span>parallel<span class="delimiter">]</span> <span class="keyword">def</span> <a title="(s: String)scala.collection.mutable.ArrayBuffer[String]" id="215842">debuglog</a><span class="delimiter">(</span><a title="String" id="368402">s</a>: <span title="String">String</span><span class="delimiter">)</span> = <a href="#16913" title="(x$1: scala.collection.mutable.ArrayBuffer[String])scala.collection.mutable.ArrayBuffer[String]">synchronized</a> <span class="delimiter">{</span>
    <a href="#215840" title="=&gt; scala.collection.mutable.ArrayBuffer[String]">debugMessages</a> <a href="../mutable/ArrayBuffer.scala.html#43452" title="(elem: String)Tasks.this.debugMessages.type">+=</a> <a href="#368402" title="String">s</a>
  <span class="delimiter">}</span>
  
  <span class="keyword">trait</span> <a title="trait Task[R, +Tp] extends java.lang.Object with ScalaObject" id="215843">Task</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="215844">R</a>, +<a title="&gt;: Nothing &lt;: Any" id="215845">Tp</a><span class="delimiter">]</span> <a href="../../ScalaObject.scala.html#460" title="ScalaObject" class="delimiter">{</a>
    <span class="keyword">type</span> <a title="R" id="215984">Result</a> = <a href="#215844" title="R">R</a>
    
    <span class="keyword">def</span> <a title="=&gt; Tp" id="215985">repr</a> = <a href="#215843" title="Task.this.type" class="keyword">this</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="Tp" class="delimiter">[</span><a href="#215845" title="Tp">Tp</a><span class="delimiter">]</span>    
    
    <span class="comment">/** Body of the task - non-divisible unit of work done by this task.
     *  Optionally is provided with the result from the previous completed task
     *  or `None` if there was no previous task (or the previous task is uncompleted or unknown).
     */</span>
    <span class="keyword">def</span> <a title="(result: Option[R])Unit" id="215986">leaf</a><span class="delimiter">(</span><a title="Option[R]" id="216068">result</a>: <a href="../../Option.scala.html#556" title="Option[R]">Option</a><span class="delimiter">[</span>R<span class="delimiter">]</span><span class="delimiter">)</span>    
    
    <span class="comment">/** A result that can be accessed once the task is completed. */</span>
    <span class="keyword">var</span> <a title="=&gt; R" id="215988">result</a>: <a href="#215844" title="R">R</a>
    
    <span class="comment">/** Decides whether or not this task should be split further. */</span>
    <span class="keyword">def</span> <a title="=&gt; Boolean" id="215989">shouldSplitFurther</a>: <a href="../../Boolean.scala.html#61" title="Boolean">Boolean</a>
    
    <span class="comment">/** Splits this task into a list of smaller tasks. */</span>
    <span class="keyword">private</span><span class="delimiter">[</span>parallel<span class="delimiter">]</span> <span class="keyword">def</span> <a title="=&gt; Seq[Tasks.this.Task[R,Tp]]" id="215990">split</a>: <a href="../Seq.scala.html#8631" title="Seq[Tasks.this.Task[R,Tp]]">Seq</a><span class="delimiter">[</span>Task<span class="delimiter">[</span>R, Tp<span class="delimiter">]</span><span class="delimiter">]</span>
    
    <span class="comment">/** Read of results of `that` task and merge them into results of this one. */</span>
    <span class="keyword">private</span><span class="delimiter">[</span>parallel<span class="delimiter">]</span> <span class="keyword">def</span> <a title="(that: Tp)Unit" id="215991">merge</a><span class="delimiter">(</span><a title="Tp @scala.annotation.unchecked.uncheckedVariance" id="338098">that</a>: Tp @<a href="#215845" title="Tp @scala.annotation.unchecked.uncheckedVariance">uncheckedVariance</a><span class="delimiter">)</span> <span title="Unit" class="delimiter">{</span><span class="delimiter">}</span>
    
    <span class="comment">// exception handling mechanism</span>
    @volatile <span class="keyword">var</span> <a title="Throwable" id="215993">throwable</a>: <span title="Throwable">Throwable</span> = <span title="Null(null)" class="keyword">null</span>
    <span class="keyword">def</span> <a title="()Unit" id="215995">forwardThrowable</a><span class="delimiter">(</span><span class="delimiter">)</span> = <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#215993" title="=&gt; Throwable">throwable</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <span title="Nothing" class="keyword">throw</span> <a href="#215993" title="=&gt; Throwable">throwable</a>
    
    <span class="comment">// tries to do the leaf computation, storing the possible exception</span>
    <span class="keyword">private</span><span class="delimiter">[</span>parallel<span class="delimiter">]</span> <span class="keyword">def</span> <a title="(lastres: Option[R])Unit" id="215996">tryLeaf</a><span class="delimiter">(</span><a title="Option[R]" id="368429">lastres</a>: <a href="../../Option.scala.html#556" title="Option[R]">Option</a><span class="delimiter">[</span>R<span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="keyword">try</span> <span class="delimiter">{</span>
        <a href="../../util/control/Breaks.scala.html#30806" title="(op: =&gt; Unit)java.lang.Object with util.control.Breaks.TryBlock">tryBreakable</a> <span class="delimiter">{</span>
          <a href="#215986" title="(result: Option[R])Unit">leaf</a><span class="delimiter">(</span><a href="#368429" title="Option[R]">lastres</a><span class="delimiter">)</span>
          <a href="#215988" title="(x$1: R)Unit">result</a> = <a href="#215988" title="=&gt; R">result</a> <span class="comment">// ensure that effects of `leaf` are visible to readers of `result`</span>
        <span class="delimiter">}</span> <a href="../../util/control/Breaks.scala.html#368435" title="(onBreak: =&gt; Unit)Unit">catchBreak</a> <span class="delimiter">{</span>
          <a href="#216000" title="()Unit">signalAbort</a>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span> <span class="keyword">catch</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <a title="Unit" id="368455">thr</a>: <span title="Exception">Exception</span> =&gt;
          <a href="#215988" title="(x$1: R)Unit">result</a> = <a href="#215988" title="=&gt; R">result</a> <span class="comment">// ensure that effects of `leaf` are visible</span>
          <a href="#215993" title="(x$1: Throwable)Unit">throwable</a> = <a href="#368455" title="Exception">thr</a>
          <a href="#216000" title="()Unit">signalAbort</a>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
    
    <span class="keyword">private</span><span class="delimiter">[</span>parallel<span class="delimiter">]</span> <span class="keyword">def</span> <a title="(t: Tp)Unit" id="215997">tryMerge</a><span class="delimiter">(</span><a title="Tp @scala.annotation.unchecked.uncheckedVariance" id="368456">t</a>: Tp @<a href="#215845" title="Tp @scala.annotation.unchecked.uncheckedVariance">uncheckedVariance</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="Tasks.this.Task[R,Tp]" id="368458">that</a> = <a href="#368456" title="Tp @scala.annotation.unchecked.uncheckedVariance">t</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="Tasks.this.Task[R,Tp]" class="delimiter">[</span><a href="#215843" title="Tasks.this.Task[R,Tp]">Task</a><span class="delimiter">[</span>R, Tp<span class="delimiter">]</span><span class="delimiter">]</span>
      <span class="keyword">val</span> <a title="R" id="368459">local</a> = <a href="#215988" title="=&gt; R">result</a> <span class="comment">// ensure that any effects of modifying `result` are detected</span>
      <span class="comment">// checkMerge(that)</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#215843" title="Task.this.type" class="keyword">this</a>.<a href="#215993" title="=&gt; Throwable">throwable</a> <span title="(x$1: AnyRef)Boolean">==</span> <span title="Null(null)" class="keyword">null</span> <a href="../../Boolean.scala.html#32906" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#368458" title="Tasks.this.Task[R,Tp]">that</a>.<a href="#215993" title="=&gt; Throwable">throwable</a> <span title="(x$1: AnyRef)Boolean">==</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <a href="#215991" title="(that: Tp)Unit">merge</a><span class="delimiter">(</span><a href="#368456" title="Tp @scala.annotation.unchecked.uncheckedVariance">t</a><span class="delimiter">)</span>
      <a href="#215999" title="(that: Tasks.this.Task[_, _])Unit">mergeThrowables</a><span class="delimiter">(</span><a href="#368458" title="Tasks.this.Task[R,Tp]">that</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
    
    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(that: Tasks.this.Task[R,Tp])Unit" id="215998">checkMerge</a><span class="delimiter">(</span><a title="Tasks.this.Task[R,Tp] @scala.annotation.unchecked.uncheckedVariance" id="368473">that</a>: Task<span class="delimiter">[</span>R, Tp<span class="delimiter">]</span> @<a href="#215843" title="Tasks.this.Task[R,Tp] @scala.annotation.unchecked.uncheckedVariance">uncheckedVariance</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#215843" title="Task.this.type" class="keyword">this</a>.<a href="#215993" title="=&gt; Throwable">throwable</a> <span title="(x$1: AnyRef)Boolean">==</span> <span title="Null(null)" class="keyword">null</span> <a href="../../Boolean.scala.html#32906" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#368473" title="Tasks.this.Task[R,Tp] @scala.annotation.unchecked.uncheckedVariance">that</a>.<a href="#215993" title="=&gt; Throwable">throwable</a> <span title="(x$1: AnyRef)Boolean">==</span> <span title="Null(null)" class="keyword">null</span> <a href="../../Boolean.scala.html#32906" title="(x: Boolean)Boolean">&amp;&amp;</a> <span class="delimiter">(</span><a href="#215843" title="Task.this.type" class="keyword">this</a>.<a href="#215988" title="=&gt; R">result</a> <span title="(x$1: Any)Boolean">==</span> <span title="Null(null)" class="keyword">null</span> <a href="../../Boolean.scala.html#32905" title="(x: Boolean)Boolean">||</a> <a href="#368473" title="Tasks.this.Task[R,Tp] @scala.annotation.unchecked.uncheckedVariance">that</a>.<a href="#215988" title="=&gt; R">result</a> <span title="(x$1: Any)Boolean">==</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="../../Predef.scala.html#9577" title="(x: Any)Unit">println</a><span class="delimiter">(</span><span title="java.lang.String(&quot;This: &quot;)" class="string">&quot;This: &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#215843" title="Tasks.this.Task[R,Tp]" class="keyword">this</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;, thr=&quot;)" class="string">&quot;, thr=&quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#215843" title="Task.this.type" class="keyword">this</a>.<a href="#215993" title="=&gt; Throwable">throwable</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;; merged with &quot;)" class="string">&quot;; merged with &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#368473" title="Tasks.this.Task[R,Tp] @scala.annotation.unchecked.uncheckedVariance">that</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;, thr=&quot;)" class="string">&quot;, thr=&quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#368473" title="Tasks.this.Task[R,Tp] @scala.annotation.unchecked.uncheckedVariance">that</a>.<a href="#215993" title="=&gt; Throwable">throwable</a><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#215843" title="Task.this.type" class="keyword">this</a>.<a href="#215993" title="=&gt; Throwable">throwable</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span> <a href="../../Boolean.scala.html#32905" title="(x: Boolean)Boolean">||</a> <a href="#368473" title="Tasks.this.Task[R,Tp] @scala.annotation.unchecked.uncheckedVariance">that</a>.<a href="#215993" title="=&gt; Throwable">throwable</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="../../Predef.scala.html#9577" title="(x: Any)Unit">println</a><span class="delimiter">(</span><span title="java.lang.String(&quot;merging this thr: &quot;)" class="string">&quot;merging this thr: &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#215843" title="Task.this.type" class="keyword">this</a>.<a href="#215993" title="=&gt; Throwable">throwable</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot; with &quot;)" class="string">&quot; with &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#368473" title="Tasks.this.Task[R,Tp] @scala.annotation.unchecked.uncheckedVariance">that</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;, thr=&quot;)" class="string">&quot;, thr=&quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#368473" title="Tasks.this.Task[R,Tp] @scala.annotation.unchecked.uncheckedVariance">that</a>.<a href="#215993" title="=&gt; Throwable">throwable</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
    
    <span class="keyword">private</span><span class="delimiter">[</span>parallel<span class="delimiter">]</span> <span class="keyword">def</span> <a title="(that: Tasks.this.Task[_, _])Unit" id="215999">mergeThrowables</a><span class="delimiter">(</span><a title="Tasks.this.Task[_, _]" id="338024">that</a>: <a href="#215843" title="Tasks.this.Task[_, _]">Task</a><span class="delimiter">[</span>_, _<span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#215843" title="Task.this.type" class="keyword">this</a>.<a href="#215993" title="=&gt; Throwable">throwable</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span> <a href="../../Boolean.scala.html#32906" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#338024" title="Tasks.this.Task[_, _]">that</a>.<a href="#215993" title="=&gt; Throwable">throwable</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="comment">// merge exceptions, since there were multiple exceptions</span>
        <a href="#215843" title="Task.this.type" class="keyword">this</a>.<a href="#215993" title="(x$1: Throwable)Unit">throwable</a> = <a href="#215843" title="Task.this.type" class="keyword">this</a>.<a href="package.scala.html#24924" title="implicit scala.collection.parallel.package.throwable2ops : (self: Throwable)java.lang.Object with scala.collection.parallel.package#ThrowableOps">throwable</a> <a href="package.scala.html#42516" title="(that: Throwable)Throwable">alongWith</a> <a href="#338024" title="Tasks.this.Task[_, _]">that</a>.<a href="#215993" title="=&gt; Throwable">throwable</a>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#338024" title="Tasks.this.Task[_, _]">that</a>.<a href="#215993" title="=&gt; Throwable">throwable</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <a href="#215843" title="Task.this.type" class="keyword">this</a>.<a href="#215993" title="(x$1: Throwable)Unit">throwable</a> = <a href="#338024" title="Tasks.this.Task[_, _]">that</a>.<a href="#215993" title="=&gt; Throwable">throwable</a>
      <span class="keyword">else</span> <a href="#215843" title="Task.this.type" class="keyword">this</a>.<a href="#215993" title="(x$1: Throwable)Unit">throwable</a> = <a href="#215843" title="Task.this.type" class="keyword">this</a>.<a href="#215993" title="=&gt; Throwable">throwable</a>
    <span class="delimiter">}</span>
    
    <span class="comment">// override in concrete task implementations to signal abort to other tasks</span>
    <span class="keyword">private</span><span class="delimiter">[</span>parallel<span class="delimiter">]</span> <span class="keyword">def</span> <a title="()Unit" id="216000">signalAbort</a><span class="delimiter">(</span><span class="delimiter">)</span> <span title="Unit" class="delimiter">{</span><span class="delimiter">}</span>
  <span class="delimiter">}</span>
  
  <span class="keyword">trait</span> <a title="trait TaskImpl[R, +Tp] extends java.lang.Object with ScalaObject" id="215846">TaskImpl</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="215847">R</a>, +<a title="&gt;: Nothing &lt;: Any" id="215848">Tp</a><span class="delimiter">]</span> <a href="../../ScalaObject.scala.html#460" title="ScalaObject" class="delimiter">{</a>
    <span class="comment">/** the body of this task - what it executes, how it gets split and how results are merged. */</span>
    <span class="keyword">val</span> <a title="=&gt; Tasks.this.Task[R,Tp]" id="368522">body</a>: <a href="#215843" title="Tasks.this.Task[R,Tp]">Task</a><span class="delimiter">[</span>R, Tp<span class="delimiter">]</span>
    
    <span class="keyword">def</span> <a title="=&gt; Seq[Tasks.this.TaskImpl[R,Tp]]" id="368523">split</a>: <a href="../Seq.scala.html#8631" title="Seq[Tasks.this.TaskImpl[R,Tp]]">Seq</a><span class="delimiter">[</span>TaskImpl<span class="delimiter">[</span>R, Tp<span class="delimiter">]</span><span class="delimiter">]</span>
    <span class="comment">/** Code that gets called after the task gets started - it may spawn other tasks instead of calling `leaf`. */</span>
    <span class="keyword">def</span> <a title="()Unit" id="368524">compute</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="comment">/** Start task. */</span>
    <span class="keyword">def</span> <a title="()Unit" id="368525">start</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="comment">/** Wait for task to finish. */</span>
    <span class="keyword">def</span> <a title="()Unit" id="368526">sync</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="comment">/** Try to cancel the task.
     *  @return     `true` if cancellation is successful.
     */</span>
    <span class="keyword">def</span> <a title="=&gt; Boolean" id="368527">tryCancel</a>: <a href="../../Boolean.scala.html#61" title="Boolean">Boolean</a>
    <span class="comment">/** If the task has been cancelled successfully, those syncing on it may
     *  automatically be notified, depending on the implementation. If they
     *  aren't, this release method should be called after processing the
     *  cancelled task.
     *
     *  This method may be overridden.
     */</span>
    <span class="keyword">def</span> <a title="()Unit" id="368528">release</a><span class="delimiter">(</span><span class="delimiter">)</span> <span title="Unit" class="delimiter">{</span><span class="delimiter">}</span>
  <span class="delimiter">}</span>
  
  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="[R, Tp](b: Tasks.this.Task[R,Tp])Tasks.this.TaskImpl[R,Tp]" id="215849">newTaskImpl</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="215852">R</a>, <a title="&gt;: Nothing &lt;: Any" id="215853">Tp</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="Tasks.this.Task[R,Tp]" id="368539">b</a>: <a href="#215843" title="Tasks.this.Task[R,Tp]">Task</a><span class="delimiter">[</span>R, Tp<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#215846" title="Tasks.this.TaskImpl[R,Tp]">TaskImpl</a><span class="delimiter">[</span>R, Tp<span class="delimiter">]</span>
  
  <span class="comment">/* task control */</span>
  
  <span class="comment">// safe to assume it will always have the same type,</span>
  <span class="comment">// because the `tasksupport` in parallel iterable is final</span>
  <span class="keyword">var</span> <a title="=&gt; AnyRef" id="215855">environment</a>: <span title="AnyRef">AnyRef</span>
  
  <span class="comment">/** Executes a task and returns a future. Forwards an exception if some task threw it. */</span>
  <span class="keyword">def</span> <a title="[R, Tp](fjtask: Tasks.this.Task[R,Tp])() =&gt; R" id="215856">execute</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="215859">R</a>, <a title="&gt;: Nothing &lt;: Any" id="215860">Tp</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="Tasks.this.Task[R,Tp]" id="216166">fjtask</a>: <a href="#215843" title="Tasks.this.Task[R,Tp]">Task</a><span class="delimiter">[</span>R, Tp<span class="delimiter">]</span><span class="delimiter">)</span>: <span class="delimiter">(</span><span class="delimiter">)</span> =&gt; R
  
  <span class="comment">/** Executes a result task, waits for it to finish, then returns its result. Forwards an exception if some task threw it. */</span>
  <span class="keyword">def</span> <a title="[R, Tp](task: Tasks.this.Task[R,Tp])R" id="215861">executeAndWaitResult</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="215864">R</a>, <a title="&gt;: Nothing &lt;: Any" id="215865">Tp</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="Tasks.this.Task[R,Tp]" id="216075">task</a>: <a href="#215843" title="Tasks.this.Task[R,Tp]">Task</a><span class="delimiter">[</span>R, Tp<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#215864" title="R">R</a>
  
  <span class="comment">/** Retrieves the parallelism level of the task execution environment. */</span>
  <span class="keyword">def</span> <a title="=&gt; Int" id="215866">parallelismLevel</a>: <a href="../../Int.scala.html#382" title="Int">Int</a>
  
<span class="delimiter">}</span>



<span class="comment">/** This trait implements scheduling by employing
 *  an adaptive work stealing technique.
 */</span>
<span class="keyword">trait</span> <a title="trait AdaptiveWorkStealingTasks extends java.lang.Object with scala.collection.parallel.Tasks with ScalaObject" id="15935">AdaptiveWorkStealingTasks</a> <a href="../../ScalaObject.scala.html#460" title="ScalaObject" class="keyword">extends</a> <a href="#16913" title="scala.collection.parallel.Tasks">Tasks</a> <span class="delimiter">{</span>
  
  <span class="keyword">trait</span> <a title="trait TaskImpl[R, Tp] extends java.lang.Object with AdaptiveWorkStealingTasks.this.TaskImpl[R,Tp] with ScalaObject" id="368345">TaskImpl</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="368346">R</a>, <a title="&gt;: Nothing &lt;: Any" id="368347">Tp</a><span class="delimiter">]</span> <a href="../../ScalaObject.scala.html#460" title="ScalaObject" class="keyword">extends</a> <span class="keyword">super</span>.<a href="#215846" title="AdaptiveWorkStealingTasks.this.TaskImpl[R,Tp]">TaskImpl</a><span class="delimiter">[</span>R, Tp<span class="delimiter">]</span> <span class="delimiter">{</span>
    @volatile <span class="keyword">var</span> <a title="AdaptiveWorkStealingTasks.this.TaskImpl[R,Tp]" id="368547">next</a>: <a href="#368345" title="AdaptiveWorkStealingTasks.this.TaskImpl[R,Tp]">TaskImpl</a><span class="delimiter">[</span>R, Tp<span class="delimiter">]</span> = <span title="Null(null)" class="keyword">null</span>
    @volatile <span class="keyword">var</span> <a title="Boolean" id="368550">shouldWaitFor</a> = <span title="Boolean(true)" class="keyword">true</span>
    
    <span class="keyword">def</span> <a title="=&gt; Seq[AdaptiveWorkStealingTasks.this.TaskImpl[R,Tp]]" id="368552">split</a>: <a href="../Seq.scala.html#8631" title="Seq[AdaptiveWorkStealingTasks.this.TaskImpl[R,Tp]]">Seq</a><span class="delimiter">[</span>TaskImpl<span class="delimiter">[</span>R, Tp<span class="delimiter">]</span><span class="delimiter">]</span>
    
    <span class="keyword">def</span> <a title="()Unit" id="368553">compute</a><span class="delimiter">(</span><span class="delimiter">)</span> = <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#368522" title="=&gt; AdaptiveWorkStealingTasks.this.Task[R,Tp]">body</a>.<a href="#215989" title="=&gt; Boolean">shouldSplitFurther</a><span class="delimiter">)</span> <a href="#368554" title="()Unit">internal</a> <span class="keyword">else</span> <a href="#368522" title="=&gt; AdaptiveWorkStealingTasks.this.Task[R,Tp]">body</a>.<a href="#215996" title="(lastres: Option[R])Unit">tryLeaf</a><span class="delimiter">(</span><a href="../../Option.scala.html#1733" title="object None">None</a><span class="delimiter">)</span>
    
    <span class="keyword">def</span> <a title="()Unit" id="368554">internal</a><span class="delimiter">(</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
      <span class="keyword">var</span> <a title="AdaptiveWorkStealingTasks.this.TaskImpl[R,Tp]" id="368567">last</a> = <a href="#368555" title="()AdaptiveWorkStealingTasks.this.TaskImpl[R,Tp]">spawnSubtasks</a><span class="delimiter">(</span><span class="delimiter">)</span>
      
      <a href="#368567" title="AdaptiveWorkStealingTasks.this.TaskImpl[R,Tp]">last</a>.<a href="#368522" title="=&gt; AdaptiveWorkStealingTasks.this.Task[R,Tp]">body</a>.<a href="#215996" title="(lastres: Option[R])Unit">tryLeaf</a><span class="delimiter">(</span><a href="../../Option.scala.html#1733" title="object None">None</a><span class="delimiter">)</span>
      <a href="#368522" title="=&gt; AdaptiveWorkStealingTasks.this.Task[R,Tp]">body</a>.<a href="#215988" title="(x$1: R)Unit">result</a> = <a href="#368567" title="AdaptiveWorkStealingTasks.this.TaskImpl[R,Tp]">last</a>.<a href="#368522" title="=&gt; AdaptiveWorkStealingTasks.this.Task[R,Tp]">body</a>.<a href="#215988" title="=&gt; R">result</a>
      <a href="#368522" title="=&gt; AdaptiveWorkStealingTasks.this.Task[R,Tp]">body</a>.<a href="#215993" title="(x$1: Throwable)Unit">throwable</a> = <a href="#368567" title="AdaptiveWorkStealingTasks.this.TaskImpl[R,Tp]">last</a>.<a href="#368522" title="=&gt; AdaptiveWorkStealingTasks.this.Task[R,Tp]">body</a>.<a href="#215993" title="=&gt; Throwable">throwable</a>
      
      <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><a href="#368567" title="AdaptiveWorkStealingTasks.this.TaskImpl[R,Tp]">last</a>.<a href="#368547" title="=&gt; AdaptiveWorkStealingTasks.this.TaskImpl[R,Tp]">next</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <a href="#368600" title="()Unit" class="delimiter">{</a>
        <span class="comment">// val lastresult = Option(last.body.result)</span>
        <span class="keyword">val</span> <a title="AdaptiveWorkStealingTasks.this.TaskImpl[R,Tp]" id="368606">beforelast</a> = <a href="#368567" title="AdaptiveWorkStealingTasks.this.TaskImpl[R,Tp]">last</a>
        <a href="#368567" title="AdaptiveWorkStealingTasks.this.TaskImpl[R,Tp]">last</a> = <a href="#368567" title="AdaptiveWorkStealingTasks.this.TaskImpl[R,Tp]">last</a>.<a href="#368547" title="=&gt; AdaptiveWorkStealingTasks.this.TaskImpl[R,Tp]">next</a>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#368567" title="AdaptiveWorkStealingTasks.this.TaskImpl[R,Tp]">last</a>.<a href="#368527" title="=&gt; Boolean">tryCancel</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <span class="comment">// println(&quot;Done with &quot; + beforelast.body + &quot;, next direct is &quot; + last.body)</span>
          <a href="#368567" title="AdaptiveWorkStealingTasks.this.TaskImpl[R,Tp]">last</a>.<a href="#368522" title="=&gt; AdaptiveWorkStealingTasks.this.Task[R,Tp]">body</a>.<a href="#215996" title="(lastres: Option[R])Unit">tryLeaf</a><span class="delimiter">(</span><a href="../../Option.scala.html#35216" title="(x: R)Some[R]">Some</a><span class="delimiter">(</span><a href="#368522" title="=&gt; AdaptiveWorkStealingTasks.this.Task[R,Tp]">body</a>.<a href="#215988" title="=&gt; R">result</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <a href="#368567" title="AdaptiveWorkStealingTasks.this.TaskImpl[R,Tp]">last</a>.<a href="#368528" title="()Unit">release</a>
        <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
          <span class="comment">// println(&quot;Done with &quot; + beforelast.body + &quot;, next sync is &quot; + last.body)</span>
          <a href="#368567" title="AdaptiveWorkStealingTasks.this.TaskImpl[R,Tp]">last</a>.<a href="#368526" title="()Unit">sync</a>
        <span class="delimiter">}</span>
        <span class="comment">// println(&quot;Merging &quot; + body + &quot; with &quot; + last.body)</span>
        <a href="#368522" title="=&gt; AdaptiveWorkStealingTasks.this.Task[R,Tp]">body</a>.<a href="#215997" title="(t: Tp)Unit">tryMerge</a><span class="delimiter">(</span><a href="#368567" title="AdaptiveWorkStealingTasks.this.TaskImpl[R,Tp]">last</a>.<a href="#368522" title="=&gt; AdaptiveWorkStealingTasks.this.Task[R,Tp]">body</a>.<a href="#215985" title="=&gt; Tp">repr</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
    
    <span class="keyword">def</span> <a title="()AdaptiveWorkStealingTasks.this.TaskImpl[R,Tp]" id="368555">spawnSubtasks</a><span class="delimiter">(</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
      <span class="keyword">var</span> <a title="AdaptiveWorkStealingTasks.this.TaskImpl[R,Tp]" id="368570">last</a>: <a href="#368345" title="AdaptiveWorkStealingTasks.this.TaskImpl[R,Tp]">TaskImpl</a><span class="delimiter">[</span>R, Tp<span class="delimiter">]</span> = <span title="Null(null)" class="keyword">null</span>
      <span class="keyword">var</span> <a title="AdaptiveWorkStealingTasks.this.TaskImpl[R,Tp]" id="368571">head</a>: <a href="#368345" title="AdaptiveWorkStealingTasks.this.TaskImpl[R,Tp]">TaskImpl</a><span class="delimiter">[</span>R, Tp<span class="delimiter">]</span> = <a href="#368345" title="AdaptiveWorkStealingTasks.this.TaskImpl[R,Tp]" class="keyword">this</a>
      <a href="#368572" title="Unit" class="keyword">do</a> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="Seq[AdaptiveWorkStealingTasks.this.TaskImpl[R,Tp]]" id="368573">subtasks</a> = <a href="#368571" title="AdaptiveWorkStealingTasks.this.TaskImpl[R,Tp]">head</a>.<a href="#368552" title="=&gt; Seq[AdaptiveWorkStealingTasks.this.TaskImpl[R,Tp]]">split</a>
        <a href="#368571" title="AdaptiveWorkStealingTasks.this.TaskImpl[R,Tp]">head</a> = <a href="#368573" title="Seq[AdaptiveWorkStealingTasks.this.TaskImpl[R,Tp]]">subtasks</a>.<a href="../IterableLike.scala.html#31196" title="=&gt; AdaptiveWorkStealingTasks.this.TaskImpl[R,Tp]">head</a>
        <span class="keyword">for</span> <span class="delimiter">(</span><a title="AdaptiveWorkStealingTasks.this.TaskImpl[R,Tp]" id="368596">t</a> &lt;- <a href="#368573" title="Seq[AdaptiveWorkStealingTasks.this.TaskImpl[R,Tp]]">subtasks</a>.<a href="../TraversableLike.scala.html#26408" title="=&gt; Seq[AdaptiveWorkStealingTasks.this.TaskImpl[R,Tp]]">tail</a>.<a href="../IterableLike.scala.html#31182" title="(f: AdaptiveWorkStealingTasks.this.TaskImpl[R,Tp] =&gt; Unit)Unit">reverse</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="#368596" title="AdaptiveWorkStealingTasks.this.TaskImpl[R,Tp]">t</a>.<a href="#368547" title="(x$1: AdaptiveWorkStealingTasks.this.TaskImpl[R,Tp])Unit">next</a> = <a href="#368570" title="AdaptiveWorkStealingTasks.this.TaskImpl[R,Tp]">last</a>
          <a href="#368570" title="AdaptiveWorkStealingTasks.this.TaskImpl[R,Tp]">last</a> = <a href="#368596" title="AdaptiveWorkStealingTasks.this.TaskImpl[R,Tp]">t</a>
          <a href="#368596" title="AdaptiveWorkStealingTasks.this.TaskImpl[R,Tp]">t</a>.<a href="#368525" title="()Unit">start</a>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span> <span class="keyword">while</span> <span class="delimiter">(</span><a href="#368571" title="AdaptiveWorkStealingTasks.this.TaskImpl[R,Tp]">head</a>.<a href="#368522" title="=&gt; AdaptiveWorkStealingTasks.this.Task[R,Tp]">body</a>.<a href="#215989" title="=&gt; Boolean">shouldSplitFurther</a><span class="delimiter">)</span>;
      <a href="#368571" title="AdaptiveWorkStealingTasks.this.TaskImpl[R,Tp]">head</a>.<a href="#368547" title="(x$1: AdaptiveWorkStealingTasks.this.TaskImpl[R,Tp])Unit">next</a> = <a href="#368570" title="AdaptiveWorkStealingTasks.this.TaskImpl[R,Tp]">last</a>
      <a href="#368571" title="AdaptiveWorkStealingTasks.this.TaskImpl[R,Tp]">head</a>
    <span class="delimiter">}</span>
    
    <span class="keyword">def</span> <a title="()Unit" id="368556">printChain</a><span class="delimiter">(</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
      <span class="keyword">var</span> <a title="AdaptiveWorkStealingTasks.this.TaskImpl[R,Tp]" id="368614">curr</a> = <a href="#368345" title="AdaptiveWorkStealingTasks.this.TaskImpl[R,Tp]" class="keyword">this</a>
      <span class="keyword">var</span> <a title="java.lang.String" id="368615">chain</a> = <span title="java.lang.String(&quot;chain: &quot;)" class="string">&quot;chain: &quot;</span>
      <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><a href="#368614" title="AdaptiveWorkStealingTasks.this.TaskImpl[R,Tp]">curr</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <a href="#368616" title="()Unit" class="delimiter">{</a>
        <a href="#368615" title="java.lang.String">chain</a> <span title="(x$1: Any)java.lang.String">+=</span> <a href="../../Predef.scala.html#9664" title="implicit scala.Predef.any2stringadd : (x: Any)scala.runtime.StringAdd">curr</a> <a href="../../runtime/StringAdd.scala.html#35781" title="(other: String)java.lang.String">+</a> <span title="java.lang.String(&quot; ---&gt; &quot;)" class="string">&quot; ---&gt; &quot;</span>
        <a href="#368614" title="AdaptiveWorkStealingTasks.this.TaskImpl[R,Tp]">curr</a> = <a href="#368614" title="AdaptiveWorkStealingTasks.this.TaskImpl[R,Tp]">curr</a>.<a href="#368547" title="=&gt; AdaptiveWorkStealingTasks.this.TaskImpl[R,Tp]">next</a>
      <span class="delimiter">}</span>
      <a href="../../Predef.scala.html#9577" title="(x: Any)Unit">println</a><span class="delimiter">(</span><a href="#368615" title="java.lang.String">chain</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
  
  <span class="comment">// specialize ctor</span>
  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="[R, Tp](b: AdaptiveWorkStealingTasks.this.Task[R,Tp])AdaptiveWorkStealingTasks.this.TaskImpl[R,Tp]" id="368348">newTaskImpl</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="368351">R</a>, <a title="&gt;: Nothing &lt;: Any" id="368352">Tp</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="AdaptiveWorkStealingTasks.this.Task[R,Tp]" id="368628">b</a>: <a href="#215843" title="AdaptiveWorkStealingTasks.this.Task[R,Tp]">Task</a><span class="delimiter">[</span>R, Tp<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#368345" title="AdaptiveWorkStealingTasks.this.TaskImpl[R,Tp]">TaskImpl</a><span class="delimiter">[</span>R, Tp<span class="delimiter">]</span>
  
<span class="delimiter">}</span>


<span class="comment">/** An implementation of tasks objects based on the Java thread pooling API. */</span>
<span class="keyword">trait</span> <a title="trait ThreadPoolTasks extends java.lang.Object with scala.collection.parallel.Tasks with ScalaObject" id="16787">ThreadPoolTasks</a> <a href="../../ScalaObject.scala.html#460" title="ScalaObject" class="keyword">extends</a> <a href="#16913" title="scala.collection.parallel.Tasks">Tasks</a> <span class="delimiter">{</span>
  <span class="keyword">import</span> java.util.concurrent._
  
  <span class="keyword">trait</span> <a title="trait TaskImpl[R, +Tp] extends java.lang.Object with java.lang.Runnable with ThreadPoolTasks.this.TaskImpl[R,Tp] with ScalaObject" id="368357">TaskImpl</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="368358">R</a>, +<a title="&gt;: Nothing &lt;: Any" id="368359">Tp</a><span class="delimiter">]</span> <a href="../../ScalaObject.scala.html#460" title="ScalaObject" class="keyword">extends</a> <span title="java.lang.Runnable">Runnable</span> <span class="keyword">with</span> <span class="keyword">super</span>.<a href="#215846" title="ThreadPoolTasks.this.TaskImpl[R,Tp]">TaskImpl</a><span class="delimiter">[</span>R, Tp<span class="delimiter">]</span> <span class="delimiter">{</span>
    <span class="comment">// initially, this is null</span>
    <span class="comment">// once the task is started, this future is set and used for `sync`</span>
    <span class="comment">// utb: var future: Future[_] = null</span>
    @volatile <span class="keyword">var</span> <a title="Boolean" id="368641">owned</a> = <span title="Boolean(false)" class="keyword">false</span>
    @volatile <span class="keyword">var</span> <a title="Boolean" id="368644">completed</a> = <span title="Boolean(false)" class="keyword">false</span>
    
    <span class="keyword">def</span> <a title="()Unit" id="368646">start</a><span class="delimiter">(</span><span class="delimiter">)</span> = <a href="#368357" title="(x$1: java.util.concurrent.Future[?0])java.util.concurrent.Future[?0]">synchronized</a> <span title="Unit" class="delimiter">{</span>
      <span class="comment">// debuglog(&quot;Starting &quot; + body)</span>
      <span class="comment">// utb: future = executor.submit(this)</span>
      <a href="#368368" title="=&gt; java.util.concurrent.ThreadPoolExecutor">executor</a>.<span title="(x$1: java.util.concurrent.Future[?0])java.util.concurrent.Future[?0]">synchronized</span> <span class="delimiter">{</span>
        <a href="#368373" title="()Unit">incrTasks</a>
        <a href="#368368" title="=&gt; java.util.concurrent.ThreadPoolExecutor">executor</a>.<span title="(x$1: java.lang.Runnable)java.util.concurrent.Future[_]">submit</span><span class="delimiter">(</span><a href="#368357" title="ThreadPoolTasks.this.TaskImpl[R,Tp]" class="keyword">this</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
    <span class="keyword">def</span> <a title="()Unit" id="368647">sync</a><span class="delimiter">(</span><span class="delimiter">)</span> = <a href="#368357" title="(x$1: Unit)Unit">synchronized</a> <span class="delimiter">{</span>
      <span class="comment">// debuglog(&quot;Syncing on &quot; + body)</span>
      <span class="comment">// utb: future.get()</span>
      <a href="#368368" title="=&gt; java.util.concurrent.ThreadPoolExecutor">executor</a>.<span title="(x$1: Unit)Unit">synchronized</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="Int" id="368698">coresize</a> = <a href="#368368" title="=&gt; java.util.concurrent.ThreadPoolExecutor">executor</a>.<span title="()Int">getCorePoolSize</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#368698" title="Int">coresize</a> <a href="../../Int.scala.html#32087" title="(x: Int)Boolean">&lt;</a> <a href="#368371" title="=&gt; Int">totaltasks</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="#368368" title="=&gt; java.util.concurrent.ThreadPoolExecutor">executor</a>.<span title="(x$1: Int)Unit">setCorePoolSize</span><span class="delimiter">(</span><a href="#368698" title="Int">coresize</a> <a href="../../Int.scala.html#32130" title="(x: Int)Int">+</a> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
          <span class="comment">//assert(executor.getCorePoolSize == (coresize + 1))</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../Boolean.scala.html#32902" title="=&gt; Boolean">!</a><a href="#368644" title="=&gt; Boolean">completed</a><span class="delimiter">)</span> <a href="#368357" title="TaskImpl.this.type" class="keyword">this</a>.<span title="()Unit">wait</span>
    <span class="delimiter">}</span>
    <span class="keyword">def</span> <a title="=&gt; Boolean" id="368648">tryCancel</a> = <a href="#368357" title="(x$1: Boolean)Boolean">synchronized</a> <span class="delimiter">{</span>
      <span class="comment">// utb: future.cancel(false)</span>
      <span title="Boolean" class="keyword">if</span> <span class="delimiter">(</span><a href="../../Boolean.scala.html#32902" title="=&gt; Boolean">!</a><a href="#368641" title="=&gt; Boolean">owned</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="comment">// debuglog(&quot;Cancelling &quot; + body)</span>
        <a href="#368641" title="(x$1: Boolean)Unit">owned</a> = <span title="Boolean(true)" class="keyword">true</span>
        <span title="Boolean(true)" class="keyword">true</span>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span title="Boolean(false)" class="keyword">false</span>
    <span class="delimiter">}</span>
    <span class="keyword">def</span> <a title="()Unit" id="368649">run</a> = <span class="delimiter">{</span>
      <span class="comment">// utb: compute</span>
      <span class="keyword">var</span> <a title="Boolean" id="368720">isOkToRun</a> = <span title="Boolean(false)" class="keyword">false</span>
      <a href="#368357" title="(x$1: Unit)Unit">synchronized</a> <span class="delimiter">{</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../Boolean.scala.html#32902" title="=&gt; Boolean">!</a><a href="#368641" title="=&gt; Boolean">owned</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="#368641" title="(x$1: Boolean)Unit">owned</a> = <span title="Boolean(true)" class="keyword">true</span>
          <a href="#368720" title="Boolean">isOkToRun</a> = <span title="Boolean(true)" class="keyword">true</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#368720" title="Boolean">isOkToRun</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="comment">// debuglog(&quot;Running body of &quot; + body)</span>
        <a href="#368524" title="()Unit">compute</a>
        <a href="#368650" title="()Unit">release</a>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span title="Unit" class="delimiter">{</span>
        <span class="comment">// just skip</span>
        <span class="comment">// debuglog(&quot;skipping body of &quot; + body)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="()Unit" id="368650">release</a> = <a href="#368357" title="(x$1: Unit)Unit">synchronized</a> <span class="delimiter">{</span>
      <a href="#368644" title="(x$1: Boolean)Unit">completed</a> = <span title="Boolean(true)" class="keyword">true</span>
      <a href="#368368" title="=&gt; java.util.concurrent.ThreadPoolExecutor">executor</a>.<span title="(x$1: Unit)Unit">synchronized</span> <span class="delimiter">{</span>
        <a href="#368374" title="()Unit">decrTasks</a>
      <span class="delimiter">}</span>
      <a href="#368357" title="TaskImpl.this.type" class="keyword">this</a>.<span title="()Unit">notifyAll</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
  
  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="[R, Tp](b: ThreadPoolTasks.this.Task[R,Tp])ThreadPoolTasks.this.TaskImpl[R,Tp]" id="368360">newTaskImpl</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="368363">R</a>, <a title="&gt;: Nothing &lt;: Any" id="368364">Tp</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="ThreadPoolTasks.this.Task[R,Tp]" id="368742">b</a>: <a href="#215843" title="ThreadPoolTasks.this.Task[R,Tp]">Task</a><span class="delimiter">[</span>R, Tp<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#368357" title="ThreadPoolTasks.this.TaskImpl[R,Tp]">TaskImpl</a><span class="delimiter">[</span>R, Tp<span class="delimiter">]</span>
  
  <span class="keyword">var</span> <a title="AnyRef" id="368366">environment</a>: <span title="AnyRef">AnyRef</span> = <a href="#16788" title="object scala.collection.parallel.ThreadPoolTasks">ThreadPoolTasks</a>.<a href="#368754" title="=&gt; java.util.concurrent.ThreadPoolExecutor">defaultThreadPool</a>
  <span class="keyword">def</span> <a title="=&gt; java.util.concurrent.ThreadPoolExecutor" id="368368">executor</a> = <a href="#368366" title="=&gt; AnyRef">environment</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="java.util.concurrent.ThreadPoolExecutor" class="delimiter">[</span><span title="java.util.concurrent.ThreadPoolExecutor">ThreadPoolExecutor</span><span class="delimiter">]</span>
  <span class="keyword">def</span> <a title="=&gt; java.util.concurrent.LinkedBlockingQueue[java.lang.Runnable]" id="368369">queue</a> = <a href="#368368" title="=&gt; java.util.concurrent.ThreadPoolExecutor">executor</a>.<span title="()java.util.concurrent.BlockingQueue[java.lang.Runnable]">getQueue</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="java.util.concurrent.LinkedBlockingQueue[java.lang.Runnable]" class="delimiter">[</span><span title="java.util.concurrent.LinkedBlockingQueue[java.lang.Runnable]">LinkedBlockingQueue</span><span class="delimiter">[</span>Runnable<span class="delimiter">]</span><span class="delimiter">]</span>
  @volatile <span class="keyword">var</span> <a title="Int" id="368371">totaltasks</a> = <span title="Int(0)" class="int">0</span>
  
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="()Unit" id="368373">incrTasks</a><span class="delimiter">(</span><span class="delimiter">)</span> = <a href="#16787" title="(x$1: Unit)Unit">synchronized</a> <span class="delimiter">{</span>
    <a href="#368371" title="(x$1: Int)Unit">totaltasks</a> <a href="../../Int.scala.html#32130" title="(x: Int)Int">+=</a> <span title="Int(1)" class="int">1</span>
  <span class="delimiter">}</span>
  
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="()Unit" id="368374">decrTasks</a><span class="delimiter">(</span><span class="delimiter">)</span> = <a href="#16787" title="(x$1: Unit)Unit">synchronized</a> <span class="delimiter">{</span>
    <a href="#368371" title="(x$1: Int)Unit">totaltasks</a> <a href="../../Int.scala.html#32137" title="(x: Int)Int">-=</a> <span title="Int(1)" class="int">1</span>
  <span class="delimiter">}</span>
  
  <span class="keyword">def</span> <a title="[R, Tp](task: ThreadPoolTasks.this.Task[R,Tp])() =&gt; R" id="368375">execute</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="368378">R</a>, <a title="&gt;: Nothing &lt;: Any" id="368379">Tp</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="ThreadPoolTasks.this.Task[R,Tp]" id="368892">task</a>: <a href="#215843" title="ThreadPoolTasks.this.Task[R,Tp]">Task</a><span class="delimiter">[</span>R, Tp<span class="delimiter">]</span><span class="delimiter">)</span>: <span class="delimiter">(</span><span class="delimiter">)</span> =&gt; R = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="ThreadPoolTasks.this.TaskImpl[R,Tp]" id="368898">t</a> = <a href="#368360" title="(b: ThreadPoolTasks.this.Task[R,Tp])ThreadPoolTasks.this.TaskImpl[R,Tp]">newTaskImpl</a><span class="delimiter">(</span><a href="#368892" title="ThreadPoolTasks.this.Task[R,Tp]">task</a><span class="delimiter">)</span>
    
    <span class="comment">// debuglog(&quot;-----------&gt; Executing without wait: &quot; + task)</span>
    <a href="#368898" title="ThreadPoolTasks.this.TaskImpl[R,Tp]">t</a>.<a href="#368646" title="()Unit">start</a>
    
    <span class="delimiter">(</span><span class="delimiter">)</span> =&gt; <span class="delimiter">{</span>
      <a href="#368898" title="ThreadPoolTasks.this.TaskImpl[R,Tp]">t</a>.<a href="#368647" title="()Unit">sync</a>
      <a href="#368898" title="ThreadPoolTasks.this.TaskImpl[R,Tp]">t</a>.<a href="#368522" title="=&gt; ThreadPoolTasks.this.Task[R,Tp]">body</a>.<a href="#215995" title="()Unit">forwardThrowable</a>
      <a href="#368898" title="ThreadPoolTasks.this.TaskImpl[R,Tp]">t</a>.<a href="#368522" title="=&gt; ThreadPoolTasks.this.Task[R,Tp]">body</a>.<a href="#215988" title="=&gt; R">result</a>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
  
  <span class="keyword">def</span> <a title="[R, Tp](task: ThreadPoolTasks.this.Task[R,Tp])R" id="368380">executeAndWaitResult</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="368383">R</a>, <a title="&gt;: Nothing &lt;: Any" id="368384">Tp</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="ThreadPoolTasks.this.Task[R,Tp]" id="368905">task</a>: <a href="#215843" title="ThreadPoolTasks.this.Task[R,Tp]">Task</a><span class="delimiter">[</span>R, Tp<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#368383" title="R">R</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="ThreadPoolTasks.this.TaskImpl[R,Tp]" id="368911">t</a> = <a href="#368360" title="(b: ThreadPoolTasks.this.Task[R,Tp])ThreadPoolTasks.this.TaskImpl[R,Tp]">newTaskImpl</a><span class="delimiter">(</span><a href="#368905" title="ThreadPoolTasks.this.Task[R,Tp]">task</a><span class="delimiter">)</span>
    
    <span class="comment">// debuglog(&quot;-----------&gt; Executing with wait: &quot; + task)</span>
    <a href="#368911" title="ThreadPoolTasks.this.TaskImpl[R,Tp]">t</a>.<a href="#368646" title="()Unit">start</a>
    
    <a href="#368911" title="ThreadPoolTasks.this.TaskImpl[R,Tp]">t</a>.<a href="#368647" title="()Unit">sync</a>
    <a href="#368911" title="ThreadPoolTasks.this.TaskImpl[R,Tp]">t</a>.<a href="#368522" title="=&gt; ThreadPoolTasks.this.Task[R,Tp]">body</a>.<a href="#215995" title="()Unit">forwardThrowable</a>
    <a href="#368911" title="ThreadPoolTasks.this.TaskImpl[R,Tp]">t</a>.<a href="#368522" title="=&gt; ThreadPoolTasks.this.Task[R,Tp]">body</a>.<a href="#215988" title="=&gt; R">result</a>
  <span class="delimiter">}</span>
  
  <span class="keyword">def</span> <a title="=&gt; Int" id="368385">parallelismLevel</a> = <a href="#16788" title="object scala.collection.parallel.ThreadPoolTasks">ThreadPoolTasks</a>.<a href="#368750" title="=&gt; Int">numCores</a>
  
<span class="delimiter">}</span>

<span class="keyword">object</span> <a title="object scala.collection.parallel.ThreadPoolTasks" id="16788">ThreadPoolTasks</a> <a href="../../ScalaObject.scala.html#460" title="ScalaObject" class="delimiter">{</a>
  <span class="keyword">import</span> java.util.concurrent._
  
  <span class="keyword">val</span> <a title="Int" id="368750">numCores</a> = <span title="object java.lang.Runtime">Runtime</span>.<span title="()java.lang.Runtime">getRuntime</span>.<span title="()Int">availableProcessors</span>
  
  <span class="keyword">val</span> <a title="java.util.concurrent.atomic.AtomicLong" id="368752">tcount</a> = <span title="java.util.concurrent.atomic.AtomicLong" class="keyword">new</span> atomic.<span title="java.util.concurrent.atomic.AtomicLong">AtomicLong</span><span class="delimiter">(</span><span title="Long(0L)" class="long">0L</span><span class="delimiter">)</span>
  
  <span class="keyword">val</span> <a title="java.util.concurrent.ThreadPoolExecutor" id="368754">defaultThreadPool</a> = <span title="(x$1: Int, x$2: Int, x$3: Long, x$4: java.util.concurrent.TimeUnit, x$5: java.util.concurrent.BlockingQueue[java.lang.Runnable], x$6: java.util.concurrent.ThreadFactory, x$7: java.util.concurrent.RejectedExecutionHandler)java.util.concurrent.ThreadPoolExecutor" class="keyword">new</span> <span title="java.util.concurrent.ThreadPoolExecutor">ThreadPoolExecutor</span><span class="delimiter">(</span>
    <a href="#368750" title="=&gt; Int">numCores</a>,
    Int.<span title="Int(2147483647)">MaxValue</span>,
    <span title="Long(60L)" class="long">60L</span>, TimeUnit.<span title="java.util.concurrent.TimeUnit(value MILLISECONDS)">MILLISECONDS</span>,
    <span title="java.util.concurrent.LinkedBlockingQueue[java.lang.Runnable]" class="keyword">new</span> <span title="java.util.concurrent.LinkedBlockingQueue[java.lang.Runnable]">LinkedBlockingQueue</span><span class="delimiter">[</span>Runnable<span class="delimiter">]</span>,
    <a href="#368841" title="java.lang.Object with java.util.concurrent.ThreadFactory" class="keyword">new</a> <a title="anonymous class $anon extends java.lang.Object with java.util.concurrent.ThreadFactory" id="368841">ThreadFactory</a> <span class="delimiter">{</span>
      <span class="keyword">def</span> <a title="(r: java.lang.Runnable)java.lang.Thread" id="368845">newThread</a><span class="delimiter">(</span><a title="java.lang.Runnable" id="368846">r</a>: <span title="java.lang.Runnable">Runnable</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="java.lang.Thread" id="368849">t</a> = <span title="(x$1: java.lang.Runnable)java.lang.Thread" class="keyword">new</span> <span title="java.lang.Thread">Thread</span><span class="delimiter">(</span><a href="#368846" title="java.lang.Runnable">r</a><span class="delimiter">)</span>
        <a href="#368849" title="java.lang.Thread">t</a>.<span title="(x$1: java.lang.String)Unit">setName</span><span class="delimiter">(</span><span title="java.lang.String(&quot;pc-thread-&quot;)" class="string">&quot;pc-thread-&quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#368752" title="=&gt; java.util.concurrent.atomic.AtomicLong">tcount</a>.<span title="()Long">incrementAndGet</span><span class="delimiter">)</span>
        <a href="#368849" title="java.lang.Thread">t</a>.<span title="(x$1: Boolean)Unit">setDaemon</span><span class="delimiter">(</span><span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span>
        <a href="#368849" title="java.lang.Thread">t</a>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>,
    <span title="java.util.concurrent.ThreadPoolExecutor.CallerRunsPolicy" class="keyword">new</span> <span title="object java.util.concurrent.ThreadPoolExecutor">ThreadPoolExecutor</span>.<span title="java.util.concurrent.ThreadPoolExecutor.CallerRunsPolicy">CallerRunsPolicy</span>
  <span class="delimiter">)</span>
<span class="delimiter">}</span>


<span class="comment">/** An implementation of tasks objects based on the Java thread pooling API and synchronization using futures. */</span>
<span class="keyword">trait</span> <a title="trait FutureThreadPoolTasks extends java.lang.Object with scala.collection.parallel.Tasks with ScalaObject" id="16127">FutureThreadPoolTasks</a> <a href="../../ScalaObject.scala.html#460" title="ScalaObject" class="keyword">extends</a> <a href="#16913" title="scala.collection.parallel.Tasks">Tasks</a> <span class="delimiter">{</span>
  <span class="keyword">import</span> java.util.concurrent._
  
  <span class="keyword">trait</span> <a title="trait TaskImpl[R, +Tp] extends java.lang.Object with java.lang.Runnable with FutureThreadPoolTasks.this.TaskImpl[R,Tp] with ScalaObject" id="368923">TaskImpl</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="368924">R</a>, +<a title="&gt;: Nothing &lt;: Any" id="368925">Tp</a><span class="delimiter">]</span> <a href="../../ScalaObject.scala.html#460" title="ScalaObject" class="keyword">extends</a> <span title="java.lang.Runnable">Runnable</span> <span class="keyword">with</span> <span class="keyword">super</span>.<a href="#215846" title="FutureThreadPoolTasks.this.TaskImpl[R,Tp]">TaskImpl</a><span class="delimiter">[</span>R, Tp<span class="delimiter">]</span> <span class="delimiter">{</span>
    @volatile <span class="keyword">var</span> <a title="java.util.concurrent.Future[_]" id="368952">future</a>: <span title="java.util.concurrent.Future[_]">Future</span><span class="delimiter">[</span>_<span class="delimiter">]</span> = <span title="Null(null)" class="keyword">null</span>
    
    <span class="keyword">def</span> <a title="()Unit" id="368954">start</a><span class="delimiter">(</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
      <a href="#368934" title="=&gt; java.util.concurrent.ThreadPoolExecutor">executor</a>.<span title="(x$1: Unit)Unit">synchronized</span> <span class="delimiter">{</span>
        <a href="#368952" title="(x$1: java.util.concurrent.Future[_])Unit">future</a> = <a href="#368934" title="=&gt; java.util.concurrent.ThreadPoolExecutor">executor</a>.<span title="(x$1: java.lang.Runnable)java.util.concurrent.Future[_]">submit</span><span class="delimiter">(</span><a href="#368923" title="FutureThreadPoolTasks.this.TaskImpl[R,Tp]" class="keyword">this</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
    <span class="keyword">def</span> <a title="()Unit" id="368955">sync</a><span class="delimiter">(</span><span class="delimiter">)</span> = <a href="#368952" title="=&gt; java.util.concurrent.Future[_]">future</a>.<span title="()_$3">get</span>
    <span class="keyword">def</span> <a title="=&gt; Boolean" id="368956">tryCancel</a> = <span title="Boolean(false)" class="keyword">false</span>
    <span class="keyword">def</span> <a title="()Unit" id="368957">run</a> = <span class="delimiter">{</span>
      <a href="#368524" title="()Unit">compute</a>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
  
  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="[R, Tp](b: FutureThreadPoolTasks.this.Task[R,Tp])FutureThreadPoolTasks.this.TaskImpl[R,Tp]" id="368926">newTaskImpl</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="368929">R</a>, <a title="&gt;: Nothing &lt;: Any" id="368930">Tp</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="FutureThreadPoolTasks.this.Task[R,Tp]" id="369015">b</a>: <a href="#215843" title="FutureThreadPoolTasks.this.Task[R,Tp]">Task</a><span class="delimiter">[</span>R, Tp<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#368923" title="FutureThreadPoolTasks.this.TaskImpl[R,Tp]">TaskImpl</a><span class="delimiter">[</span>R, Tp<span class="delimiter">]</span>
  
  <span class="keyword">var</span> <a title="AnyRef" id="368932">environment</a>: <span title="AnyRef">AnyRef</span> = <a href="#16128" title="object scala.collection.parallel.FutureThreadPoolTasks">FutureThreadPoolTasks</a>.<a href="#369027" title="=&gt; java.util.concurrent.ExecutorService">defaultThreadPool</a>
  <span class="keyword">def</span> <a title="=&gt; java.util.concurrent.ThreadPoolExecutor" id="368934">executor</a> = <a href="#368932" title="=&gt; AnyRef">environment</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="java.util.concurrent.ThreadPoolExecutor" class="delimiter">[</span><span title="java.util.concurrent.ThreadPoolExecutor">ThreadPoolExecutor</span><span class="delimiter">]</span>
  
  <span class="keyword">def</span> <a title="[R, Tp](task: FutureThreadPoolTasks.this.Task[R,Tp])() =&gt; R" id="368935">execute</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="368938">R</a>, <a title="&gt;: Nothing &lt;: Any" id="368939">Tp</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="FutureThreadPoolTasks.this.Task[R,Tp]" id="369113">task</a>: <a href="#215843" title="FutureThreadPoolTasks.this.Task[R,Tp]">Task</a><span class="delimiter">[</span>R, Tp<span class="delimiter">]</span><span class="delimiter">)</span>: <span class="delimiter">(</span><span class="delimiter">)</span> =&gt; R = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="FutureThreadPoolTasks.this.TaskImpl[R,Tp]" id="369119">t</a> = <a href="#368926" title="(b: FutureThreadPoolTasks.this.Task[R,Tp])FutureThreadPoolTasks.this.TaskImpl[R,Tp]">newTaskImpl</a><span class="delimiter">(</span><a href="#369113" title="FutureThreadPoolTasks.this.Task[R,Tp]">task</a><span class="delimiter">)</span>
    
    <span class="comment">// debuglog(&quot;-----------&gt; Executing without wait: &quot; + task)</span>
    <a href="#369119" title="FutureThreadPoolTasks.this.TaskImpl[R,Tp]">t</a>.<a href="#368954" title="()Unit">start</a>
    
    <span class="delimiter">(</span><span class="delimiter">)</span> =&gt; <span class="delimiter">{</span>
      <a href="#369119" title="FutureThreadPoolTasks.this.TaskImpl[R,Tp]">t</a>.<a href="#368955" title="()Unit">sync</a>
      <a href="#369119" title="FutureThreadPoolTasks.this.TaskImpl[R,Tp]">t</a>.<a href="#368522" title="=&gt; FutureThreadPoolTasks.this.Task[R,Tp]">body</a>.<a href="#215995" title="()Unit">forwardThrowable</a>
      <a href="#369119" title="FutureThreadPoolTasks.this.TaskImpl[R,Tp]">t</a>.<a href="#368522" title="=&gt; FutureThreadPoolTasks.this.Task[R,Tp]">body</a>.<a href="#215988" title="=&gt; R">result</a>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
  
  <span class="keyword">def</span> <a title="[R, Tp](task: FutureThreadPoolTasks.this.Task[R,Tp])R" id="368940">executeAndWaitResult</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="368943">R</a>, <a title="&gt;: Nothing &lt;: Any" id="368944">Tp</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="FutureThreadPoolTasks.this.Task[R,Tp]" id="369126">task</a>: <a href="#215843" title="FutureThreadPoolTasks.this.Task[R,Tp]">Task</a><span class="delimiter">[</span>R, Tp<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#368943" title="R">R</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="FutureThreadPoolTasks.this.TaskImpl[R,Tp]" id="369132">t</a> = <a href="#368926" title="(b: FutureThreadPoolTasks.this.Task[R,Tp])FutureThreadPoolTasks.this.TaskImpl[R,Tp]">newTaskImpl</a><span class="delimiter">(</span><a href="#369126" title="FutureThreadPoolTasks.this.Task[R,Tp]">task</a><span class="delimiter">)</span>
    
    <span class="comment">// debuglog(&quot;-----------&gt; Executing with wait: &quot; + task)</span>
    <a href="#369132" title="FutureThreadPoolTasks.this.TaskImpl[R,Tp]">t</a>.<a href="#368954" title="()Unit">start</a>
    
    <a href="#369132" title="FutureThreadPoolTasks.this.TaskImpl[R,Tp]">t</a>.<a href="#368955" title="()Unit">sync</a>
    <a href="#369132" title="FutureThreadPoolTasks.this.TaskImpl[R,Tp]">t</a>.<a href="#368522" title="=&gt; FutureThreadPoolTasks.this.Task[R,Tp]">body</a>.<a href="#215995" title="()Unit">forwardThrowable</a>
    <a href="#369132" title="FutureThreadPoolTasks.this.TaskImpl[R,Tp]">t</a>.<a href="#368522" title="=&gt; FutureThreadPoolTasks.this.Task[R,Tp]">body</a>.<a href="#215988" title="=&gt; R">result</a>
  <span class="delimiter">}</span>
  
  <span class="keyword">def</span> <a title="=&gt; Int" id="368945">parallelismLevel</a> = <a href="#16128" title="object scala.collection.parallel.FutureThreadPoolTasks">FutureThreadPoolTasks</a>.<a href="#369023" title="=&gt; Int">numCores</a>
  
<span class="delimiter">}</span>

<span class="keyword">object</span> <a title="object scala.collection.parallel.FutureThreadPoolTasks" id="16128">FutureThreadPoolTasks</a> <a href="../../ScalaObject.scala.html#460" title="ScalaObject" class="delimiter">{</a>
  <span class="keyword">import</span> java.util.concurrent._
  
  <span class="keyword">val</span> <a title="Int" id="369023">numCores</a> = <span title="object java.lang.Runtime">Runtime</span>.<span title="()java.lang.Runtime">getRuntime</span>.<span title="()Int">availableProcessors</span>
  
  <span class="keyword">val</span> <a title="java.util.concurrent.atomic.AtomicLong" id="369025">tcount</a> = <span title="java.util.concurrent.atomic.AtomicLong" class="keyword">new</span> atomic.<span title="java.util.concurrent.atomic.AtomicLong">AtomicLong</span><span class="delimiter">(</span><span title="Long(0L)" class="long">0L</span><span class="delimiter">)</span>
  
  <span class="keyword">val</span> <a title="java.util.concurrent.ExecutorService" id="369027">defaultThreadPool</a> = <span title="object java.util.concurrent.Executors">Executors</span>.<span title="()java.util.concurrent.ExecutorService">newCachedThreadPool</span><span class="delimiter">(</span><span class="delimiter">)</span>
<span class="delimiter">}</span>



<span class="comment">/**
 * A trait describing objects that provide a fork/join pool.
 */</span>
<span class="keyword">trait</span> <a title="trait HavingForkJoinPool extends java.lang.Object" id="15932">HavingForkJoinPool</a> <span title="java.lang.Object" class="delimiter">{</span>
  <span class="keyword">def</span> <a title="=&gt; scala.concurrent.forkjoin.ForkJoinPool" id="368343">forkJoinPool</a>: <span title="scala.concurrent.forkjoin.ForkJoinPool">ForkJoinPool</span>
<span class="delimiter">}</span>


<span class="comment">/** An implementation trait for parallel tasks based on the fork/join framework.
 *  
 *  @define fjdispatch
 *  If the current thread is a fork/join worker thread, the task's `fork` method will
 *  be invoked. Otherwise, the task will be executed on the fork/join pool.
 */</span>
<span class="keyword">trait</span> <a title="trait ForkJoinTasks extends java.lang.Object with scala.collection.parallel.Tasks with scala.collection.parallel.HavingForkJoinPool with ScalaObject" id="16451">ForkJoinTasks</a> <a href="../../ScalaObject.scala.html#460" title="ScalaObject" class="keyword">extends</a> <a href="#16913" title="scala.collection.parallel.Tasks">Tasks</a> <span class="keyword">with</span> <a href="#15932" title="scala.collection.parallel.HavingForkJoinPool">HavingForkJoinPool</a> <span class="delimiter">{</span>
  
  <span class="keyword">trait</span> <a title="trait TaskImpl[R, +Tp] extends scala.concurrent.forkjoin.RecursiveAction with ForkJoinTasks.this.TaskImpl[R,Tp] with ScalaObject" id="368311">TaskImpl</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="368312">R</a>, +<a title="&gt;: Nothing &lt;: Any" id="368313">Tp</a><span class="delimiter">]</span> <a href="../../ScalaObject.scala.html#460" title="ScalaObject" class="keyword">extends</a> <span title="scala.concurrent.forkjoin.RecursiveAction">RecursiveAction</span> <span class="keyword">with</span> <span class="keyword">super</span>.<a href="#215846" title="ForkJoinTasks.this.TaskImpl[R,Tp]">TaskImpl</a><span class="delimiter">[</span>R, Tp<span class="delimiter">]</span> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="()Unit" id="369150">start</a><span class="delimiter">(</span><span class="delimiter">)</span> = <a href="#368311" title="()Unit">fork</a>
    <span class="keyword">def</span> <a title="()Unit" id="369151">sync</a><span class="delimiter">(</span><span class="delimiter">)</span> = <a href="#368311" title="()java.lang.Void">join</a>
    <span class="keyword">def</span> <a title="=&gt; Boolean" id="369152">tryCancel</a> = <a href="#368311" title="()Boolean">tryUnfork</a>
  <span class="delimiter">}</span>
  
  <span class="comment">// specialize ctor</span>
  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="[R, Tp](b: ForkJoinTasks.this.Task[R,Tp])ForkJoinTasks.this.TaskImpl[R,Tp]" id="368314">newTaskImpl</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="368317">R</a>, <a title="&gt;: Nothing &lt;: Any" id="368318">Tp</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="ForkJoinTasks.this.Task[R,Tp]" id="369165">b</a>: <a href="#215843" title="ForkJoinTasks.this.Task[R,Tp]">Task</a><span class="delimiter">[</span>R, Tp<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#368311" title="ForkJoinTasks.this.TaskImpl[R,Tp]">TaskImpl</a><span class="delimiter">[</span>R, Tp<span class="delimiter">]</span>
  
  <span class="comment">/** The fork/join pool of this collection.
   */</span>
  <span class="keyword">def</span> <a title="=&gt; scala.concurrent.forkjoin.ForkJoinPool" id="368319">forkJoinPool</a>: <span title="scala.concurrent.forkjoin.ForkJoinPool">ForkJoinPool</span> = <a href="#368321" title="=&gt; AnyRef">environment</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="scala.concurrent.forkjoin.ForkJoinPool" class="delimiter">[</span><span title="scala.concurrent.forkjoin.ForkJoinPool">ForkJoinPool</span><span class="delimiter">]</span>
  <span class="keyword">var</span> <a title="AnyRef" id="368321">environment</a>: <span title="AnyRef">AnyRef</span> = <a href="#16452" title="object scala.collection.parallel.ForkJoinTasks">ForkJoinTasks</a>.<a href="#369174" title="=&gt; scala.concurrent.forkjoin.ForkJoinPool">defaultForkJoinPool</a>
  
  <span class="comment">/** Executes a task and does not wait for it to finish - instead returns a future.
   *  
   *  $fjdispatch
   */</span>
  <span class="keyword">def</span> <a title="[R, Tp](task: ForkJoinTasks.this.Task[R,Tp])() =&gt; R" id="368323">execute</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="368326">R</a>, <a title="&gt;: Nothing &lt;: Any" id="368327">Tp</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="ForkJoinTasks.this.Task[R,Tp]" id="369176">task</a>: <a href="#215843" title="ForkJoinTasks.this.Task[R,Tp]">Task</a><span class="delimiter">[</span>R, Tp<span class="delimiter">]</span><span class="delimiter">)</span>: <span class="delimiter">(</span><span class="delimiter">)</span> =&gt; R = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="ForkJoinTasks.this.TaskImpl[R,Tp]" id="369182">fjtask</a> = <a href="#368314" title="(b: ForkJoinTasks.this.Task[R,Tp])ForkJoinTasks.this.TaskImpl[R,Tp]">newTaskImpl</a><span class="delimiter">(</span><a href="#369176" title="ForkJoinTasks.this.Task[R,Tp]">task</a><span class="delimiter">)</span>
    
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><span title="object java.lang.Thread">Thread</span>.<span title="()java.lang.Thread">currentThread</span>.<span title="[T0]=&gt; Boolean">isInstanceOf</span><span title="Boolean" class="delimiter">[</span><span title="scala.concurrent.forkjoin.ForkJoinWorkerThread">ForkJoinWorkerThread</span><span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#369182" title="ForkJoinTasks.this.TaskImpl[R,Tp]">fjtask</a>.<span title="()Unit">fork</span>
    <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
      <a href="#368319" title="=&gt; scala.concurrent.forkjoin.ForkJoinPool">forkJoinPool</a>.<span title="(x$1: scala.concurrent.forkjoin.ForkJoinTask[java.lang.Void])Unit">execute</span><span class="delimiter">(</span><a href="#369182" title="ForkJoinTasks.this.TaskImpl[R,Tp]">fjtask</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
    
    <span class="delimiter">(</span><span class="delimiter">)</span> =&gt; <span class="delimiter">{</span>
      <a href="#369182" title="ForkJoinTasks.this.TaskImpl[R,Tp]">fjtask</a>.<a href="#369151" title="()Unit">sync</a>
      <a href="#369182" title="ForkJoinTasks.this.TaskImpl[R,Tp]">fjtask</a>.<a href="#368522" title="=&gt; ForkJoinTasks.this.Task[R,Tp]">body</a>.<a href="#215995" title="()Unit">forwardThrowable</a>
      <a href="#369182" title="ForkJoinTasks.this.TaskImpl[R,Tp]">fjtask</a>.<a href="#368522" title="=&gt; ForkJoinTasks.this.Task[R,Tp]">body</a>.<a href="#215988" title="=&gt; R">result</a>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
  
  <span class="comment">/** Executes a task on a fork/join pool and waits for it to finish.
   *  Returns its result when it does.
   * 
   *  $fjdispatch
   *  
   *  @return    the result of the task
   */</span>
  <span class="keyword">def</span> <a title="[R, Tp](task: ForkJoinTasks.this.Task[R,Tp])R" id="368328">executeAndWaitResult</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="368331">R</a>, <a title="&gt;: Nothing &lt;: Any" id="368332">Tp</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="ForkJoinTasks.this.Task[R,Tp]" id="369270">task</a>: <a href="#215843" title="ForkJoinTasks.this.Task[R,Tp]">Task</a><span class="delimiter">[</span>R, Tp<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#368331" title="R">R</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="ForkJoinTasks.this.TaskImpl[R,Tp]" id="369276">fjtask</a> = <a href="#368314" title="(b: ForkJoinTasks.this.Task[R,Tp])ForkJoinTasks.this.TaskImpl[R,Tp]">newTaskImpl</a><span class="delimiter">(</span><a href="#369270" title="ForkJoinTasks.this.Task[R,Tp]">task</a><span class="delimiter">)</span>
    
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><span title="object java.lang.Thread">Thread</span>.<span title="()java.lang.Thread">currentThread</span>.<span title="[T0]=&gt; Boolean">isInstanceOf</span><span title="Boolean" class="delimiter">[</span><span title="scala.concurrent.forkjoin.ForkJoinWorkerThread">ForkJoinWorkerThread</span><span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#369276" title="ForkJoinTasks.this.TaskImpl[R,Tp]">fjtask</a>.<span title="()Unit">fork</span>
    <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
      <a href="#368319" title="=&gt; scala.concurrent.forkjoin.ForkJoinPool">forkJoinPool</a>.<span title="(x$1: scala.concurrent.forkjoin.ForkJoinTask[java.lang.Void])Unit">execute</span><span class="delimiter">(</span><a href="#369276" title="ForkJoinTasks.this.TaskImpl[R,Tp]">fjtask</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
    
    <a href="#369276" title="ForkJoinTasks.this.TaskImpl[R,Tp]">fjtask</a>.<a href="#369151" title="()Unit">sync</a>
    <span class="comment">// if (fjtask.body.throwable != null) println(&quot;throwing: &quot; + fjtask.body.throwable + &quot; at &quot; + fjtask.body)</span>
    <a href="#369276" title="ForkJoinTasks.this.TaskImpl[R,Tp]">fjtask</a>.<a href="#368522" title="=&gt; ForkJoinTasks.this.Task[R,Tp]">body</a>.<a href="#215995" title="()Unit">forwardThrowable</a>
    <a href="#369276" title="ForkJoinTasks.this.TaskImpl[R,Tp]">fjtask</a>.<a href="#368522" title="=&gt; ForkJoinTasks.this.Task[R,Tp]">body</a>.<a href="#215988" title="=&gt; R">result</a>
  <span class="delimiter">}</span>
  
  <span class="keyword">def</span> <a title="=&gt; Int" id="368333">parallelismLevel</a> = <a href="#368319" title="=&gt; scala.concurrent.forkjoin.ForkJoinPool">forkJoinPool</a>.<span title="()Int">getParallelism</span>
  
<span class="delimiter">}</span>


<span class="keyword">object</span> <a title="object scala.collection.parallel.ForkJoinTasks" id="16452">ForkJoinTasks</a> <a href="../../ScalaObject.scala.html#460" title="ScalaObject" class="delimiter">{</a>
  <span class="keyword">val</span> <a title="scala.concurrent.forkjoin.ForkJoinPool" id="369174">defaultForkJoinPool</a>: <span title="scala.concurrent.forkjoin.ForkJoinPool">ForkJoinPool</span> = <span title="scala.concurrent.forkjoin.ForkJoinPool" class="keyword">new</span> <span title="scala.concurrent.forkjoin.ForkJoinPool">ForkJoinPool</span><span class="delimiter">(</span><span class="delimiter">)</span> <span class="comment">// scala.parallel.forkjoinpool</span>
  <span class="comment">// defaultForkJoinPool.setParallelism(Runtime.getRuntime.availableProcessors)</span>
  <span class="comment">// defaultForkJoinPool.setMaximumPoolSize(Runtime.getRuntime.availableProcessors)</span>
<span class="delimiter">}</span>


<span class="comment">/* Some boilerplate due to no deep mixin composition. Not sure if it can be done differently without them.
 */</span>
<span class="keyword">trait</span> <a title="trait AdaptiveWorkStealingForkJoinTasks extends java.lang.Object with scala.collection.parallel.ForkJoinTasks with scala.collection.parallel.AdaptiveWorkStealingTasks with ScalaObject" id="15956">AdaptiveWorkStealingForkJoinTasks</a> <a href="../../ScalaObject.scala.html#460" title="ScalaObject" class="keyword">extends</a> <a href="#16451" title="scala.collection.parallel.ForkJoinTasks">ForkJoinTasks</a> <span class="keyword">with</span> <a href="#15935" title="scala.collection.parallel.AdaptiveWorkStealingTasks">AdaptiveWorkStealingTasks</a> <span class="delimiter">{</span>
  
  <span class="keyword">class</span> <a title="class TaskImpl[R, Tp] extends scala.concurrent.forkjoin.RecursiveAction with AdaptiveWorkStealingForkJoinTasks.this.TaskImpl[R,Tp] with AdaptiveWorkStealingForkJoinTasks.this.TaskImpl[R,Tp] with ScalaObject" id="368335">TaskImpl</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="368336">R</a>, <a title="&gt;: Nothing &lt;: Any" id="368337">Tp</a><span class="delimiter">]</span><a href="../../ScalaObject.scala.html#460" title="ScalaObject" class="delimiter">(</a><span class="keyword">val</span> <a title="AdaptiveWorkStealingForkJoinTasks.this.Task[R,Tp]" id="369308">body</a>: <a href="#215843" title="AdaptiveWorkStealingForkJoinTasks.this.Task[R,Tp]">Task</a><span class="delimiter">[</span>R, Tp<span class="delimiter">]</span><span class="delimiter">)</span>
  <span class="keyword">extends</span> <span class="keyword">super</span><span class="delimiter">[</span>ForkJoinTasks<span class="delimiter">]</span>.<a href="#368311" title="AdaptiveWorkStealingForkJoinTasks.this.TaskImpl[R,Tp]">TaskImpl</a><span class="delimiter">[</span>R, Tp<span class="delimiter">]</span> <span class="keyword">with</span> <span class="keyword">super</span><span class="delimiter">[</span>AdaptiveWorkStealingTasks<span class="delimiter">]</span>.<a href="#368345" title="AdaptiveWorkStealingForkJoinTasks.this.TaskImpl[R,Tp]">TaskImpl</a><span class="delimiter">[</span>R, Tp<span class="delimiter">]</span> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="=&gt; Seq[AdaptiveWorkStealingForkJoinTasks.this.TaskImpl[R,Tp]]" id="369305">split</a> = <a href="#369308" title="=&gt; AdaptiveWorkStealingForkJoinTasks.this.Task[R,Tp]">body</a>.<a href="#215990" title="=&gt; Seq[AdaptiveWorkStealingForkJoinTasks.this.Task[R,Tp]]">split</a>.<a href="../TraversableLike.scala.html#26367" title="(f: AdaptiveWorkStealingForkJoinTasks.this.Task[R,Tp] =&gt; AdaptiveWorkStealingForkJoinTasks.this.TaskImpl[R,Tp])(implicit bf: scala.collection.generic.CanBuildFrom[Seq[AdaptiveWorkStealingForkJoinTasks.this.Task[R,Tp]],AdaptiveWorkStealingForkJoinTasks.this.TaskImpl[R,Tp],Seq[AdaptiveWorkStealingForkJoinTasks.this.TaskImpl[R,Tp]]])Seq[AdaptiveWorkStealingForkJoinTasks.this.TaskImpl[R,Tp]]">map</a><a href="../Seq.scala.html#41665" title="scala.collection.generic.CanBuildFrom[scala.collection.Seq.Coll,AdaptiveWorkStealingForkJoinTasks.this.TaskImpl[R,Tp],Seq[AdaptiveWorkStealingForkJoinTasks.this.TaskImpl[R,Tp]]]" class="delimiter">(</a><a title="AdaptiveWorkStealingForkJoinTasks.this.Task[R,Tp]" id="369334">b</a> =&gt; <a href="#368338" title="(b: AdaptiveWorkStealingForkJoinTasks.this.Task[R,Tp])AdaptiveWorkStealingForkJoinTasks.this.TaskImpl[R,Tp]">newTaskImpl</a><span class="delimiter">(</span><a href="#369334" title="AdaptiveWorkStealingForkJoinTasks.this.Task[R,Tp]">b</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>
  
  <span class="keyword">def</span> <a title="[R, Tp](b: AdaptiveWorkStealingForkJoinTasks.this.Task[R,Tp])AdaptiveWorkStealingForkJoinTasks.this.TaskImpl[R,Tp]" id="368338">newTaskImpl</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="368341">R</a>, <a title="&gt;: Nothing &lt;: Any" id="368342">Tp</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="AdaptiveWorkStealingForkJoinTasks.this.Task[R,Tp]" id="369335">b</a>: <a href="#215843" title="AdaptiveWorkStealingForkJoinTasks.this.Task[R,Tp]">Task</a><span class="delimiter">[</span>R, Tp<span class="delimiter">]</span><span class="delimiter">)</span> = <span title="AdaptiveWorkStealingForkJoinTasks.this.TaskImpl[R,Tp]" class="keyword">new</span> <a href="#368335" title="AdaptiveWorkStealingForkJoinTasks.this.TaskImpl[R,Tp]">TaskImpl</a><span class="delimiter">[</span>R, Tp<span class="delimiter">]</span><span class="delimiter">(</span><a href="#369335" title="AdaptiveWorkStealingForkJoinTasks.this.Task[R,Tp]">b</a><span class="delimiter">)</span>
  
<span class="delimiter">}</span>


<span class="keyword">trait</span> <a title="trait AdaptiveWorkStealingThreadPoolTasks extends java.lang.Object with scala.collection.parallel.ThreadPoolTasks with scala.collection.parallel.AdaptiveWorkStealingTasks with ScalaObject" id="16193">AdaptiveWorkStealingThreadPoolTasks</a> <a href="../../ScalaObject.scala.html#460" title="ScalaObject" class="keyword">extends</a> <a href="#16787" title="scala.collection.parallel.ThreadPoolTasks">ThreadPoolTasks</a> <span class="keyword">with</span> <a href="#15935" title="scala.collection.parallel.AdaptiveWorkStealingTasks">AdaptiveWorkStealingTasks</a> <span class="delimiter">{</span>
  
  <span class="keyword">class</span> <a title="class TaskImpl[R, Tp] extends java.lang.Object with AdaptiveWorkStealingThreadPoolTasks.this.TaskImpl[R,Tp] with AdaptiveWorkStealingThreadPoolTasks.this.TaskImpl[R,Tp] with ScalaObject" id="368387">TaskImpl</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="368388">R</a>, <a title="&gt;: Nothing &lt;: Any" id="368389">Tp</a><span class="delimiter">]</span><a href="../../ScalaObject.scala.html#460" title="ScalaObject" class="delimiter">(</a><span class="keyword">val</span> <a title="AdaptiveWorkStealingThreadPoolTasks.this.Task[R,Tp]" id="369394">body</a>: <a href="#215843" title="AdaptiveWorkStealingThreadPoolTasks.this.Task[R,Tp]">Task</a><span class="delimiter">[</span>R, Tp<span class="delimiter">]</span><span class="delimiter">)</span>
  <span class="keyword">extends</span> <span class="keyword">super</span><span class="delimiter">[</span>ThreadPoolTasks<span class="delimiter">]</span>.<a href="#368357" title="AdaptiveWorkStealingThreadPoolTasks.this.TaskImpl[R,Tp]">TaskImpl</a><span class="delimiter">[</span>R, Tp<span class="delimiter">]</span> <span class="keyword">with</span> <span class="keyword">super</span><span class="delimiter">[</span>AdaptiveWorkStealingTasks<span class="delimiter">]</span>.<a href="#368345" title="AdaptiveWorkStealingThreadPoolTasks.this.TaskImpl[R,Tp]">TaskImpl</a><span class="delimiter">[</span>R, Tp<span class="delimiter">]</span> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="=&gt; Seq[AdaptiveWorkStealingThreadPoolTasks.this.TaskImpl[R,Tp]]" id="369391">split</a> = <a href="#369394" title="=&gt; AdaptiveWorkStealingThreadPoolTasks.this.Task[R,Tp]">body</a>.<a href="#215990" title="=&gt; Seq[AdaptiveWorkStealingThreadPoolTasks.this.Task[R,Tp]]">split</a>.<a href="../TraversableLike.scala.html#26367" title="(f: AdaptiveWorkStealingThreadPoolTasks.this.Task[R,Tp] =&gt; AdaptiveWorkStealingThreadPoolTasks.this.TaskImpl[R,Tp])(implicit bf: scala.collection.generic.CanBuildFrom[Seq[AdaptiveWorkStealingThreadPoolTasks.this.Task[R,Tp]],AdaptiveWorkStealingThreadPoolTasks.this.TaskImpl[R,Tp],Seq[AdaptiveWorkStealingThreadPoolTasks.this.TaskImpl[R,Tp]]])Seq[AdaptiveWorkStealingThreadPoolTasks.this.TaskImpl[R,Tp]]">map</a><a href="../Seq.scala.html#41665" title="scala.collection.generic.CanBuildFrom[scala.collection.Seq.Coll,AdaptiveWorkStealingThreadPoolTasks.this.TaskImpl[R,Tp],Seq[AdaptiveWorkStealingThreadPoolTasks.this.TaskImpl[R,Tp]]]" class="delimiter">(</a><a title="AdaptiveWorkStealingThreadPoolTasks.this.Task[R,Tp]" id="369420">b</a> =&gt; <a href="#368390" title="(b: AdaptiveWorkStealingThreadPoolTasks.this.Task[R,Tp])AdaptiveWorkStealingThreadPoolTasks.this.TaskImpl[R,Tp]">newTaskImpl</a><span class="delimiter">(</span><a href="#369420" title="AdaptiveWorkStealingThreadPoolTasks.this.Task[R,Tp]">b</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>
  
  <span class="keyword">def</span> <a title="[R, Tp](b: AdaptiveWorkStealingThreadPoolTasks.this.Task[R,Tp])AdaptiveWorkStealingThreadPoolTasks.this.TaskImpl[R,Tp]" id="368390">newTaskImpl</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="368393">R</a>, <a title="&gt;: Nothing &lt;: Any" id="368394">Tp</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="AdaptiveWorkStealingThreadPoolTasks.this.Task[R,Tp]" id="369421">b</a>: <a href="#215843" title="AdaptiveWorkStealingThreadPoolTasks.this.Task[R,Tp]">Task</a><span class="delimiter">[</span>R, Tp<span class="delimiter">]</span><span class="delimiter">)</span> = <span title="AdaptiveWorkStealingThreadPoolTasks.this.TaskImpl[R,Tp]" class="keyword">new</span> <a href="#368387" title="AdaptiveWorkStealingThreadPoolTasks.this.TaskImpl[R,Tp]">TaskImpl</a><span class="delimiter">[</span>R, Tp<span class="delimiter">]</span><span class="delimiter">(</span><a href="#369421" title="AdaptiveWorkStealingThreadPoolTasks.this.Task[R,Tp]">b</a><span class="delimiter">)</span>
  
<span class="delimiter">}</span>









        </pre>
    </body>
</html>