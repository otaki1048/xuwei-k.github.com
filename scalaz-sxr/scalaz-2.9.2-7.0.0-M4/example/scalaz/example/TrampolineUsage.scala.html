<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>example/scalaz/example/TrampolineUsage.scala</title>
        <script type="text/javascript" src="../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> scalaz.example

<span class="keyword">object</span> <a title="object scalaz.example.TrampolineUsage" id="33286">TrampolineUsage</a> <span title="ScalaObject" class="keyword">extends</span> <span title="App">App</span> <span class="delimiter">{</span>

  <span class="keyword">import</span> scalaz._, <a href="../../../core/scalaz/Scalaz.scala.html#20121" title="object scalaz.Scalaz">Scalaz</a>._, <a href="../../../core/scalaz/Free.scala.html#23010" title="object scalaz.Free">Free</a>._

  <span class="keyword">def</span> <a title="[F[+_], T](xs: List[T])(implicit evidence$1: scalaz.Pointed[F], implicit evidence$2: scalaz.Order[T])scalaz.Free[F,List[T]]" id="640013">quickSort</a><span class="delimiter">[</span><a title="[+_]&gt;: Nothing &lt;: Any" id="638678">F</a><span class="delimiter">[</span>+ <a title="&gt;: Nothing &lt;: Any" id="640014">_</a><span class="delimiter">]</span> : Pointed, <a title="&gt;: Nothing &lt;: Any" id="638679">T</a>: Order<span class="delimiter">]</span><span class="delimiter">(</span><a title="List[T]" id="640011">xs</a>: <span title="List[T]">List</span><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../../core/scalaz/Free.scala.html#23009" title="scalaz.Free[F,List[T]]">Free</a><span class="delimiter">[</span>F, List<span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">]</span> = <span class="delimiter">{</span>
    <a href="#640011" title="List[T]">xs</a> <span title="scalaz.Free[F,List[T]]" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <span title="scalaz.Free[F,scala.collection.immutable.Nil.type]">Nil</span> =&gt;
        <a href="../../../core/scalaz/Free.scala.html#52804" title="(value: =&gt; scala.collection.immutable.Nil.type)(implicit S: scalaz.Pointed[F])scalaz.Free[F,scala.collection.immutable.Nil.type]">return_</a> <a href="#640013" title="scalaz.Pointed[F]" class="delimiter">{</a>
          <span title="object Nil">Nil</span>
        <span class="delimiter">}</span>
      <span class="keyword">case</span> <a title="scalaz.Free[F,List[T]]" id="640499">x</a> :: <a title="List[T]" id="640500">tail</a> =&gt;
        <a href="../../../core/scalaz/Free.scala.html#52809" title="(value: =&gt; scalaz.Free[F,List[T]])(implicit S: scalaz.Pointed[F])scalaz.Free[F,List[T]]">suspend</a> <a href="#640013" title="scalaz.Pointed[F]" class="delimiter">{</a>
          <span class="keyword">val</span> <a href="#640510" title="(List[T], List[T])" class="delimiter">(</a><a href="#640509" title="List[T]" id="640510">left</a>, <a href="#640509" title="List[T]" id="640511">right</a><span class="delimiter">)</span> = <a href="#640500" title="List[T]">tail</a>.<span title="(p: T =&gt; Boolean)(List[T], List[T])">partition</span><span title="(List[T], List[T]) @unchecked" class="delimiter">(</span><a href="../../../core/scalaz/syntax/OrderSyntax.scala.html#53465" title="(v: T)(implicit F0: scalaz.Order[T])java.lang.Object with scalaz.syntax.OrderOps[T]">_</a> <a href="../../../core/scalaz/syntax/OrderSyntax.scala.html#191286" title="(other: T)Boolean">&lt;</a> <a href="#640499" title="T">x</a><span class="delimiter">)</span>
          <span class="keyword">for</span> <span class="delimiter">{</span>
            <a title="List[T]" id="642395">ls</a> &lt;- <a href="#640013" title="[F[+_], T](xs: List[T])(implicit evidence$1: scalaz.Pointed[F], implicit evidence$2: scalaz.Order[T])scalaz.Free[F,List[T]]">quickSort</a><span title="(xs: List[T])(implicit evidence$1: scalaz.Pointed[F], implicit evidence$2: scalaz.Order[T])scalaz.Free[F,List[T]]" class="delimiter">[</span><a href="#638678" title="F">F</a>, <a href="#638679" title="T">T</a><span class="delimiter">]</span><a href="../../../core/scalaz/Free.scala.html#117065" title="(f: List[T] =&gt; scalaz.Free[F,List[T]])scalaz.Free[F,List[T]]" class="delimiter">(</a><a href="#640510" title="List[T]">left</a><span class="delimiter">)</span>
            <a title="List[T]" id="643212">rs</a> &lt;- <a href="#640013" title="[F[+_], T](xs: List[T])(implicit evidence$1: scalaz.Pointed[F], implicit evidence$2: scalaz.Order[T])scalaz.Free[F,List[T]]">quickSort</a><span title="(xs: List[T])(implicit evidence$1: scalaz.Pointed[F], implicit evidence$2: scalaz.Order[T])scalaz.Free[F,List[T]]" class="delimiter">[</span><a href="#638678" title="F">F</a>, <a href="#638679" title="T">T</a><span class="delimiter">]</span><a href="../../../core/scalaz/Free.scala.html#117059" title="(f: List[T] =&gt; List[T])scalaz.Free[F,List[T]]" class="delimiter">(</a><a href="#640511" title="List[T]">right</a><span class="delimiter">)</span>
          <span class="delimiter">}</span> <span class="keyword">yield</span> <a href="#642395" title="List[T]">ls</a> <a href="#643213" title="(prefix: List[T])List[T]">:::</a> <span class="delimiter">(</span><a href="#640499" title="T">x</a> <a href="#643214" title="(x: T)List[T]">::</a> <a href="#643212" title="List[T]">rs</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="[F[+_], T](xs: List[T])(implicit evidence$3: scalaz.Pointed[F], implicit evidence$4: scalaz.Copointed[F], implicit evidence$5: scalaz.Order[T])List[T]" id="643677">runQuickSort</a><span class="delimiter">[</span><a title="[+_]&gt;: Nothing &lt;: Any" id="638683">F</a><span class="delimiter">[</span>+ <a title="&gt;: Nothing &lt;: Any" id="643679">_</a><span class="delimiter">]</span> : Pointed : Copointed, <a title="&gt;: Nothing &lt;: Any" id="638684">T</a>: Order<span class="delimiter">]</span><span class="delimiter">(</span><a title="List[T]" id="643674">xs</a>: <span title="List[T]">List</span><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="List[T]">List</span><span class="delimiter">[</span>T<span class="delimiter">]</span> =
    <a href="#640013" title="[F[+_], T](xs: List[T])(implicit evidence$1: scalaz.Pointed[F], implicit evidence$2: scalaz.Order[T])scalaz.Free[F,List[T]]">quickSort</a><span title="(xs: List[T])(implicit evidence$1: scalaz.Pointed[F], implicit evidence$2: scalaz.Order[T])scalaz.Free[F,List[T]]" class="delimiter">[</span><a href="#638683" title="F">F</a>, <a href="#638684" title="T">T</a><span class="delimiter">]</span><a href="#643677" title="scalaz.Pointed[F]" class="delimiter">(</a><a href="#643674" title="List[T]">xs</a><span class="delimiter">)</span>.<a href="../../../core/scalaz/Free.scala.html#117088" title="(f: F[scalaz.Free[F,List[T]]] =&gt; scalaz.Free[F,List[T]])List[T]">go</a><span class="delimiter">(</span><a title="F[scalaz.Free[F,List[T]]]" id="644504">f</a> =&gt; <a href="../../../core/scalaz/Copointed.scala.html#149622" title="[F[_]](implicit F: scalaz.Copointed[F])scalaz.Copointed[F]">Copointed</a><a href="#643677" title="(implicit F: scalaz.Copointed[F])scalaz.Copointed[F]" class="delimiter">[</a><a href="#638683" title="F">F</a><span class="delimiter">]</span>.<a href="../../../core/scalaz/Copointed.scala.html#43430" title="(p: F[scalaz.Free[F,List[T]]])scalaz.Free[F,List[T]]">copoint</a><span class="delimiter">(</span><a href="#644504" title="F[scalaz.Free[F,List[T]]]">f</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">val</span> <a title="List[Int]" id="638685">xs</a> = <span title="object List">List</span>.<span title="(n: Int)(elem: =&gt; Int)List[Int]">fill</span><span class="delimiter">(</span><span title="Int(32)" class="int">32</span><span class="delimiter">)</span><span class="delimiter">(</span>util.<span title="object scala.util.Random">Random</span>.<span title="()Int">nextInt</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="delimiter">{</span>
    <span class="comment">// Trampoline is Free[Function0, A].</span>

    <span class="comment">// use the heap</span>
    <span class="keyword">val</span> <a title="List[Int]" id="644869">sorted</a> = <a href="#643677" title="[F[+_], T](xs: List[T])(implicit evidence$3: scalaz.Pointed[F], implicit evidence$4: scalaz.Copointed[F], implicit evidence$5: scalaz.Order[T])List[T]">runQuickSort</a><span title="(xs: List[Int])(implicit evidence$3: scalaz.Pointed[Function0], implicit evidence$4: scalaz.Copointed[Function0], implicit evidence$5: scalaz.Order[Int])List[Int]" class="delimiter">[</span><span title="Function0">Function0</span>, <span title="Int">Int</span><span class="delimiter">]</span><a href="../../../core/scalaz/std/Function.scala.html#52879" title="function0Instance extends java.lang.Object with scalaz.Traverse[Function0] with scalaz.Monad[Function0] with scalaz.Copointed[Function0]" class="delimiter">(</a><a href="#638685" title="=&gt; List[Int]">xs</a><span class="delimiter">)</span>
    <span title="(x: Any)Unit">println</span><span class="delimiter">(</span><a href="#644869" title="List[Int]">sorted</a><span class="delimiter">)</span>

    <span class="keyword">val</span> <a href="#644871" title="(Int, List[Int])" class="delimiter">(</a><a href="#644870" title="Int" id="644871">steps</a>, <a href="#644870" title="List[Int]" id="644872">sorted1</a><span class="delimiter">)</span> = <a href="#640013" title="[F[+_], T](xs: List[T])(implicit evidence$1: scalaz.Pointed[F], implicit evidence$2: scalaz.Order[T])scalaz.Free[F,List[T]]">quickSort</a><span title="(xs: List[Int])(implicit evidence$1: scalaz.Pointed[Function0], implicit evidence$2: scalaz.Order[Int])scalaz.Free[Function0,List[Int]]" class="delimiter">[</span><span title="Function0">Function0</span>, <span title="Int">Int</span><span class="delimiter">]</span><a href="../../../core/scalaz/std/Function.scala.html#52879" title="function0Instance extends java.lang.Object with scalaz.Traverse[Function0] with scalaz.Monad[Function0] with scalaz.Copointed[Function0]" class="delimiter">(</a><a href="#638685" title="=&gt; List[Int]">xs</a><span class="delimiter">)</span>.<a href="../../../core/scalaz/Free.scala.html#117091" title="(b: Int)(f: (Int, () =&gt; scalaz.Free[Function0,List[Int]]) =&gt; (Int, scalaz.Free[Function0,List[Int]]))(Int, List[Int])">foldRun</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span><span title="(Int, List[Int]) @unchecked" class="delimiter">(</span><span class="delimiter">(</span><a title="Int" id="646873">i</a>, <a title="() =&gt; scalaz.Free[Function0,List[Int]]" id="646874">f</a><span class="delimiter">)</span> =&gt; <span title="(_1: Int, _2: scalaz.Free[Function0,List[Int]])(Int, scalaz.Free[Function0,List[Int]])" class="delimiter">(</span><a href="#646873" title="Int">i</a> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span>, <a href="#646874" title="()scalaz.Free[Function0,List[Int]]">f</a><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <span title="(x: Any)Unit">println</span><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;sort using heap took %d steps&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#644871" title="Int">steps</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="delimiter">{</span>
    <span class="comment">// Use the stack.</span>
    <span class="keyword">val</span> <a title="List[Int]" id="652443">sorted</a> = <a href="#643677" title="[F[+_], T](xs: List[T])(implicit evidence$3: scalaz.Pointed[F], implicit evidence$4: scalaz.Copointed[F], implicit evidence$5: scalaz.Order[T])List[T]">runQuickSort</a><span title="(xs: List[Int])(implicit evidence$3: scalaz.Pointed[scalaz.Scalaz.Id], implicit evidence$4: scalaz.Copointed[scalaz.Scalaz.Id], implicit evidence$5: scalaz.Order[Int])List[Int]" class="delimiter">[</span><a href="../../../core/scalaz/Id.scala.html#42334" title="scalaz.Scalaz.Id">Id</a>, <span title="Int">Int</span><span class="delimiter">]</span><a href="../../../core/scalaz/package.scala.html#38664" title="=&gt; scalaz.Traverse[scalaz.Id.Id] with scalaz.Each[scalaz.Id.Id] with scalaz.Monad[scalaz.Id.Id] with scalaz.Comonad[scalaz.Id.Id] with scalaz.Cojoin[scalaz.Id.Id] with scalaz.Distributive[scalaz.Id.Id] with scalaz.Zip[scalaz.Id.Id] with scalaz.Unzip[scalaz.Id.Id] with scalaz.Cozip[scalaz.Id.Id]" class="delimiter">(</a><a href="#638685" title="=&gt; List[Int]">xs</a><span class="delimiter">)</span>
    <span title="(x: Any)Unit">println</span><span class="delimiter">(</span><a href="#652443" title="List[Int]">sorted</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">import</span> scalaz.concurrent._
  <span class="keyword">import</span> annotation.unchecked.uncheckedVariance
  <span class="keyword">type</span> <a title="[+A]scalaz.concurrent.Promise[A @scala.annotation.unchecked.uncheckedVariance]" id="638689">PromiseCov</a><span class="delimiter">[</span>+<a title="&gt;: Nothing &lt;: Any" id="638690">A</a><span class="delimiter">]</span> = <a href="../../../concurrent/scalaz/concurrent/Promise.scala.html#24211" title="scalaz.concurrent.Promise[A @scala.annotation.unchecked.uncheckedVariance]">Promise</a><span class="delimiter">[</span>A @uncheckedVariance<span class="delimiter">]</span>

  <span class="delimiter">{</span>
    <span class="comment">// Run in parallel.</span>
    <span class="keyword">val</span> <a title="List[Int]" id="653632">sorted</a> = <a href="#643677" title="[F[+_], T](xs: List[T])(implicit evidence$3: scalaz.Pointed[F], implicit evidence$4: scalaz.Copointed[F], implicit evidence$5: scalaz.Order[T])List[T]">runQuickSort</a><span title="(xs: List[Int])(implicit evidence$3: scalaz.Pointed[scalaz.example.TrampolineUsage.PromiseCov], implicit evidence$4: scalaz.Copointed[scalaz.example.TrampolineUsage.PromiseCov], implicit evidence$5: scalaz.Order[Int])List[Int]" class="delimiter">[</span><a href="../../../concurrent/scalaz/concurrent/Promise.scala.html#24211" title="scalaz.example.TrampolineUsage.PromiseCov">PromiseCov</a>, <span title="Int">Int</span><span class="delimiter">]</span><a href="../../../concurrent/scalaz/concurrent/Promise.scala.html#56330" title="implicit scalaz.concurrent.PromiseInstances.promiseInstance : (implicit s: scalaz.concurrent.Strategy)java.lang.Object with scalaz.Traverse[scalaz.concurrent.Promise] with scalaz.Monad[scalaz.concurrent.Promise] with scalaz.Comonad[scalaz.concurrent.Promise]" class="delimiter">(</a><a href="#638685" title="=&gt; List[Int]">xs</a><span class="delimiter">)</span>
    <span title="(x: Any)Unit">println</span><span class="delimiter">(</span><a href="#653632" title="List[Int]">sorted</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>


  <span class="comment">/**Run using `F1` as a binding for lists longer than `threshold`, and `F2` otherwise. */</span>
  <span class="keyword">def</span> <a title="[F[+_], F2[+_], T](xs: List[T], nat: scalaz.package.~&gt;[F2,F], threshold: Int)(implicit evidence$6: scalaz.Pointed[F], implicit evidence$7: scalaz.Pointed[F2], implicit evidence$8: scalaz.Order[T])scalaz.Free[F,List[T]]" id="655537">quickSort2</a><span class="delimiter">[</span><a title="[+_]&gt;: Nothing &lt;: Any" id="638695">F</a><span class="delimiter">[</span>+ <a title="&gt;: Nothing &lt;: Any" id="655538">_</a><span class="delimiter">]</span> : Pointed, <a title="[+_]&gt;: Nothing &lt;: Any" id="638696">F2</a><span class="delimiter">[</span>+ <a title="&gt;: Nothing &lt;: Any" id="655540">_</a><span class="delimiter">]</span> : Pointed, <a title="&gt;: Nothing &lt;: Any" id="638697">T</a>: Order<span class="delimiter">]</span><span class="delimiter">(</span><a title="List[T]" id="655532">xs</a>: <span title="List[T]">List</span><span class="delimiter">[</span>T<span class="delimiter">]</span>, <a title="scalaz.package.~&gt;[F2,F]" id="655533">nat</a>: F2 <a href="../../../core/scalaz/NaturalTransformation.scala.html#16919" title="scalaz.package.~&gt;[F2,F]">~&gt;</a> F, <a title="Int" id="655534">threshold</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <a href="../../../core/scalaz/Free.scala.html#23009" title="scalaz.Free[F,List[T]]">Free</a><span class="delimiter">[</span>F, List<span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="(as: List[T])scalaz.Free[F,List[T]]" id="655547">qs</a><span class="delimiter">(</span><a title="List[T]" id="655548">as</a>: <span title="List[T]">List</span><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../../core/scalaz/Free.scala.html#23009" title="scalaz.Free[F,List[T]]">Free</a><span class="delimiter">[</span>F, List<span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">]</span> =
      <span title="scalaz.Free[F,List[T]]" class="keyword">if</span> <span class="delimiter">(</span><a href="#655548" title="List[T]">as</a>.<span title="(len: Int)Int">lengthCompare</span><span class="delimiter">(</span><a href="#655534" title="Int">threshold</a><span class="delimiter">)</span> <span title="(x: Int)Boolean">&lt;</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="scalaz.Free[F2,List[T]]" id="655553">free</a>: <a href="../../../core/scalaz/Free.scala.html#23009" title="scalaz.Free[F2,List[T]]">Free</a><span class="delimiter">[</span>F2, List<span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">]</span> = <a href="#655537" title="[F[+_], F2[+_], T](xs: List[T], nat: scalaz.package.~&gt;[F2,F], threshold: Int)(implicit evidence$6: scalaz.Pointed[F], implicit evidence$7: scalaz.Pointed[F2], implicit evidence$8: scalaz.Order[T])scalaz.Free[F,List[T]]">quickSort2</a><span title="(xs: List[T], nat: scalaz.package.~&gt;[F2,F2], threshold: Int)(implicit evidence$6: scalaz.Pointed[F2], implicit evidence$7: scalaz.Pointed[F2], implicit evidence$8: scalaz.Order[T])scalaz.Free[F2,List[T]]" class="delimiter">[</span><a href="#638696" title="F2">F2</a>, <a href="#638696" title="F2">F2</a>, <a href="#638697" title="T">T</a><span class="delimiter">]</span><a href="#655537" title="scalaz.Pointed[F2]" class="delimiter">(</a><a href="#655548" title="List[T]">as</a>, <a href="../../../core/scalaz/NaturalTransformation.scala.html#16920" title="object scalaz.NaturalTransformation">NaturalTransformation</a>.<a href="../../../core/scalaz/NaturalTransformation.scala.html#323736" title="[F[_]]=&gt; java.lang.Object with scalaz.package.~&gt;[F,F]">refl</a><span title="refl extends java.lang.Object with scalaz.package.~&gt;[F2,F2]" class="delimiter">[</span><a href="#638696" title="F2">F2</a><span class="delimiter">]</span>, <a href="#655534" title="Int">threshold</a><span class="delimiter">)</span>
        <a href="#655553" title="scalaz.Free[F2,List[T]]">free</a>.<a href="../../../core/scalaz/Free.scala.html#117069" title="(f: scalaz.package.~&gt;[F2,F])(implicit evidence$4: scalaz.Functor[F])scalaz.Free[F,List[T]]">mapSuspension</a><a href="#655537" title="scalaz.Pointed[F]" class="delimiter">(</a><a href="#655533" title="scalaz.package.~&gt;[F2,F]">nat</a><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">else</span> <a href="#655537" title="[F[+_], F2[+_], T](xs: List[T], nat: scalaz.package.~&gt;[F2,F], threshold: Int)(implicit evidence$6: scalaz.Pointed[F], implicit evidence$7: scalaz.Pointed[F2], implicit evidence$8: scalaz.Order[T])scalaz.Free[F,List[T]]">quickSort2</a><span title="(xs: List[T], nat: scalaz.package.~&gt;[F2,F], threshold: Int)(implicit evidence$6: scalaz.Pointed[F], implicit evidence$7: scalaz.Pointed[F2], implicit evidence$8: scalaz.Order[T])scalaz.Free[F,List[T]]" class="delimiter">[</span><a href="#638695" title="F">F</a>, <a href="#638696" title="F2">F2</a>, <a href="#638697" title="T">T</a><span class="delimiter">]</span><a href="#655537" title="scalaz.Pointed[F]" class="delimiter">(</a><a href="#655548" title="List[T]">as</a>, <a href="#655533" title="scalaz.package.~&gt;[F2,F]">nat</a>, <a href="#655534" title="Int">threshold</a><span class="delimiter">)</span>

    <a href="#655532" title="List[T]">xs</a> <span title="scalaz.Free[F,List[T]]" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <span title="scalaz.Free[F,scala.collection.immutable.Nil.type]">Nil</span> =&gt;
        <a href="../../../core/scalaz/Free.scala.html#52804" title="(value: =&gt; scala.collection.immutable.Nil.type)(implicit S: scalaz.Pointed[F])scalaz.Free[F,scala.collection.immutable.Nil.type]">return_</a> <a href="#655537" title="scalaz.Pointed[F]" class="delimiter">{</a>
          <span title="object Nil">Nil</span>
        <span class="delimiter">}</span>
      <span class="keyword">case</span> <a title="scalaz.Free[F,List[T]]" id="659013">x</a> :: <a title="List[T]" id="659014">tail</a> =&gt;
        <a href="../../../core/scalaz/Free.scala.html#52809" title="(value: =&gt; scalaz.Free[F,List[T]])(implicit S: scalaz.Pointed[F])scalaz.Free[F,List[T]]">suspend</a> <a href="#655537" title="scalaz.Pointed[F]" class="delimiter">{</a>
          <span class="keyword">val</span> <a href="#659024" title="(List[T], List[T])" class="delimiter">(</a><a href="#659023" title="List[T]" id="659024">left</a>, <a href="#659023" title="List[T]" id="659025">right</a><span class="delimiter">)</span> = <a href="#659014" title="List[T]">tail</a>.<span title="(p: T =&gt; Boolean)(List[T], List[T])">partition</span><span title="(List[T], List[T]) @unchecked" class="delimiter">(</span><a href="../../../core/scalaz/syntax/OrderSyntax.scala.html#53465" title="(v: T)(implicit F0: scalaz.Order[T])java.lang.Object with scalaz.syntax.OrderOps[T]">_</a> <a href="../../../core/scalaz/syntax/OrderSyntax.scala.html#191286" title="(other: T)Boolean">&lt;</a> <a href="#659013" title="T">x</a><span class="delimiter">)</span>
          <span class="keyword">for</span> <span class="delimiter">{</span>
            <a title="List[T]" id="660097">ls</a> &lt;- <a href="#655547" title="(as: List[T])scalaz.Free[F,List[T]]">qs</a><a href="../../../core/scalaz/Free.scala.html#117065" title="(f: List[T] =&gt; scalaz.Free[F,List[T]])scalaz.Free[F,List[T]]" class="delimiter">(</a><a href="#659024" title="List[T]">left</a><span class="delimiter">)</span>
            <a title="List[T]" id="660102">rs</a> &lt;- <a href="#655547" title="(as: List[T])scalaz.Free[F,List[T]]">qs</a><a href="../../../core/scalaz/Free.scala.html#117059" title="(f: List[T] =&gt; List[T])scalaz.Free[F,List[T]]" class="delimiter">(</a><a href="#659025" title="List[T]">right</a><span class="delimiter">)</span>
          <span class="delimiter">}</span> <span class="keyword">yield</span> <a href="#660097" title="List[T]">ls</a> <a href="#660103" title="(prefix: List[T])List[T]">:::</a> <span class="delimiter">(</span><a href="#659013" title="T">x</a> <a href="#660104" title="(x: T)List[T]">::</a> <a href="#660102" title="List[T]">rs</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="[F[+_], F2[+_], T](xs: List[T], nat: scalaz.package.~&gt;[F2,F], threshold: Int)(implicit evidence$9: scalaz.Pointed[F], implicit evidence$10: scalaz.Copointed[F], implicit evidence$11: scalaz.Pointed[F2], implicit evidence$12: scalaz.Order[T])List[T]" id="660571">runQuickSort2</a><span class="delimiter">[</span><a title="[+_]&gt;: Nothing &lt;: Any" id="638702">F</a><span class="delimiter">[</span>+ <a title="&gt;: Nothing &lt;: Any" id="660574">_</a><span class="delimiter">]</span> : Pointed : Copointed, <a title="[+_]&gt;: Nothing &lt;: Any" id="638703">F2</a><span class="delimiter">[</span>+ <a title="&gt;: Nothing &lt;: Any" id="660573">_</a><span class="delimiter">]</span> : Pointed, <a title="&gt;: Nothing &lt;: Any" id="638704">T</a>: Order<span class="delimiter">]</span><span class="delimiter">(</span><a title="List[T]" id="660565">xs</a>: <span title="List[T]">List</span><span class="delimiter">[</span>T<span class="delimiter">]</span>, <a title="scalaz.package.~&gt;[F2,F]" id="660566">nat</a>: F2 <a href="../../../core/scalaz/NaturalTransformation.scala.html#16919" title="scalaz.package.~&gt;[F2,F]">~&gt;</a> F, <a title="Int" id="660567">threshold</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="List[T]">List</span><span class="delimiter">[</span>T<span class="delimiter">]</span> =
    <a href="#655537" title="[F[+_], F2[+_], T](xs: List[T], nat: scalaz.package.~&gt;[F2,F], threshold: Int)(implicit evidence$6: scalaz.Pointed[F], implicit evidence$7: scalaz.Pointed[F2], implicit evidence$8: scalaz.Order[T])scalaz.Free[F,List[T]]">quickSort2</a><span title="(xs: List[T], nat: scalaz.package.~&gt;[F2,F], threshold: Int)(implicit evidence$6: scalaz.Pointed[F], implicit evidence$7: scalaz.Pointed[F2], implicit evidence$8: scalaz.Order[T])scalaz.Free[F,List[T]]" class="delimiter">[</span><a href="#638702" title="F">F</a>, <a href="#638703" title="F2">F2</a>, <a href="#638704" title="T">T</a><span class="delimiter">]</span><a href="#660571" title="scalaz.Pointed[F]" class="delimiter">(</a><a href="#660565" title="List[T]">xs</a>, <a href="#660566" title="scalaz.package.~&gt;[F2,F]">nat</a>, <a href="#660567" title="Int">threshold</a><span class="delimiter">)</span>.<a href="../../../core/scalaz/Free.scala.html#117088" title="(f: F[scalaz.Free[F,List[T]]] =&gt; scalaz.Free[F,List[T]])List[T]">go</a><span class="delimiter">(</span><a title="F[scalaz.Free[F,List[T]]]" id="661845">f</a> =&gt; <a href="../../../core/scalaz/Copointed.scala.html#149622" title="[F[_]](implicit F: scalaz.Copointed[F])scalaz.Copointed[F]">Copointed</a><a href="#660571" title="(implicit F: scalaz.Copointed[F])scalaz.Copointed[F]" class="delimiter">[</a><a href="#638702" title="F">F</a><span class="delimiter">]</span>.<a href="../../../core/scalaz/Copointed.scala.html#43430" title="(p: F[scalaz.Free[F,List[T]]])scalaz.Free[F,List[T]]">copoint</a><span class="delimiter">(</span><a href="#661845" title="F[scalaz.Free[F,List[T]]]">f</a><span class="delimiter">)</span><span class="delimiter">)</span>


  <span class="delimiter">{</span>
    <span class="comment">// mixed binding</span>
    <span class="keyword">val</span> <a title="promise2Id extends java.lang.Object with scalaz.package.~&gt;[scalaz.Scalaz.Id,scalaz.example.TrampolineUsage.PromiseCov]" id="662210">promise2Id</a> = <a href="#662212" title="java.lang.Object with scalaz.package.~&gt;[scalaz.Scalaz.Id,scalaz.example.TrampolineUsage.PromiseCov]" class="keyword">new</a> <a title="anonymous class $anon extends java.lang.Object with scalaz.package.~&gt;[scalaz.Scalaz.Id,scalaz.example.TrampolineUsage.PromiseCov]" id="662212" class="delimiter">(</a>Id <a href="../../../core/scalaz/NaturalTransformation.scala.html#16919" title="scalaz.package.~&gt;[scalaz.Scalaz.Id,scalaz.example.TrampolineUsage.PromiseCov]">~&gt;</a> PromiseCov<span class="delimiter">)</span> <span class="delimiter">{</span> <span class="keyword">def</span> <a title="[A](a: A)scalaz.concurrent.Promise[A]" id="662214">apply</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="662216">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="A" id="662217">a</a>: <a href="#662216" title="A">A</a><span class="delimiter">)</span> = <a href="../../../concurrent/scalaz/concurrent/Promise.scala.html#56309" title="(a: =&gt; A)(implicit s: scalaz.concurrent.Strategy)scalaz.concurrent.Promise[A]">Promise</a><a href="../../../concurrent/scalaz/concurrent/Strategy.scala.html#57938" title="=&gt; scalaz.concurrent.Strategy" class="delimiter">(</a><a href="#662217" title="A">a</a><span class="delimiter">)</span><span class="delimiter">}</span>

    <span class="comment">// run in parallel for lists larger then 8 elements, and on the stack for lists smaller.</span>
    <span class="keyword">val</span> <a title="List[Int]" id="662211">sorted</a> = <a href="#660571" title="[F[+_], F2[+_], T](xs: List[T], nat: scalaz.package.~&gt;[F2,F], threshold: Int)(implicit evidence$9: scalaz.Pointed[F], implicit evidence$10: scalaz.Copointed[F], implicit evidence$11: scalaz.Pointed[F2], implicit evidence$12: scalaz.Order[T])List[T]">runQuickSort2</a><span title="(xs: List[Int], nat: scalaz.package.~&gt;[scalaz.Scalaz.Id,scalaz.example.TrampolineUsage.PromiseCov], threshold: Int)(implicit evidence$9: scalaz.Pointed[scalaz.example.TrampolineUsage.PromiseCov], implicit evidence$10: scalaz.Copointed[scalaz.example.TrampolineUsage.PromiseCov], implicit evidence$11: scalaz.Pointed[scalaz.Scalaz.Id], implicit evidence$12: scalaz.Order[Int])List[Int]" class="delimiter">[</span><a href="../../../concurrent/scalaz/concurrent/Promise.scala.html#24211" title="scalaz.example.TrampolineUsage.PromiseCov">PromiseCov</a>, <a href="../../../core/scalaz/Id.scala.html#42334" title="scalaz.Scalaz.Id">Id</a>, <span title="Int">Int</span><span class="delimiter">]</span><a href="../../../concurrent/scalaz/concurrent/Promise.scala.html#56330" title="implicit scalaz.concurrent.PromiseInstances.promiseInstance : (implicit s: scalaz.concurrent.Strategy)java.lang.Object with scalaz.Traverse[scalaz.concurrent.Promise] with scalaz.Monad[scalaz.concurrent.Promise] with scalaz.Comonad[scalaz.concurrent.Promise]" class="delimiter">(</a><a href="#638685" title="=&gt; List[Int]">xs</a>, <a href="#662210" title="promise2Id extends java.lang.Object with scalaz.package.~&gt;[scalaz.Scalaz.Id,scalaz.example.TrampolineUsage.PromiseCov]">promise2Id</a>, <span title="Int(8)" class="int">8</span><span class="delimiter">)</span>
    <span title="(x: Any)Unit">println</span><span class="delimiter">(</span><a href="#662211" title="List[Int]">sorted</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">// Ackermann function. Blows the stack for very small inputs.</span>
  <span class="keyword">def</span> <a title="(m: Int, n: Int)Int" id="638705">ack</a><span class="delimiter">(</span><a title="Int" id="664950">m</a>: <span title="Int">Int</span>, <a title="Int" id="664951">n</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="Int">Int</span> =
    <span title="Int" class="keyword">if</span> <span class="delimiter">(</span><a href="#664950" title="Int">m</a> <span title="(x: Int)Boolean">&lt;=</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
      <a href="#664951" title="Int">n</a> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span>
    <span class="keyword">else</span> <span title="Int" class="keyword">if</span> <span class="delimiter">(</span><a href="#664951" title="Int">n</a> <span title="(x: Int)Boolean">&lt;=</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
      <a href="#638705" title="(m: Int, n: Int)Int">ack</a><span class="delimiter">(</span><a href="#664950" title="Int">m</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span>, <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
    <span class="keyword">else</span> <a href="#638705" title="(m: Int, n: Int)Int">ack</a><span class="delimiter">(</span><a href="#664950" title="Int">m</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span>, <a href="#638705" title="(m: Int, n: Int)Int">ack</a><span class="delimiter">(</span><a href="#664950" title="Int">m</a>, <a href="#664951" title="Int">n</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="comment">// Trampolined ackermann function. Never blows the stack, even for large inputs.</span>
  <span class="keyword">def</span> <a title="(m: Int, n: Int)scalaz.Free.Trampoline[Int]" id="638706">ackermann</a><span class="delimiter">(</span><a title="Int" id="680993">m</a>: <span title="Int">Int</span>, <a title="Int" id="680994">n</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <a href="../../../core/scalaz/Free.scala.html#23009" title="scalaz.Free.Trampoline[Int]">Trampoline</a><span class="delimiter">[</span>Int<span class="delimiter">]</span> =
    <span title="scalaz.Free.Trampoline[Int]" class="keyword">if</span> <span class="delimiter">(</span><a href="#680993" title="Int">m</a> <span title="(x: Int)Boolean">&lt;=</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
      <a href="../../../core/scalaz/Free.scala.html#52804" title="(value: =&gt; Int)(implicit S: scalaz.Pointed[Function0])scalaz.Free[Function0,Int]">return_</a><a href="../../../core/scalaz/std/Function.scala.html#52879" title="function0Instance extends java.lang.Object with scalaz.Traverse[Function0] with scalaz.Monad[Function0] with scalaz.Copointed[Function0]" class="delimiter">(</a><a href="#680994" title="Int">n</a> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
    <span class="keyword">else</span> <span title="scalaz.Free.Trampoline[Int]" class="keyword">if</span> <span class="delimiter">(</span><a href="#680994" title="Int">n</a> <span title="(x: Int)Boolean">&lt;=</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
      <a href="../../../core/scalaz/Free.scala.html#52809" title="(value: =&gt; scalaz.Free[Function0,Int])(implicit S: scalaz.Pointed[Function0])scalaz.Free[Function0,Int]">suspend</a><a href="../../../core/scalaz/std/Function.scala.html#52879" title="function0Instance extends java.lang.Object with scalaz.Traverse[Function0] with scalaz.Monad[Function0] with scalaz.Copointed[Function0]" class="delimiter">(</a><a href="#638706" title="(m: Int, n: Int)scalaz.Free.Trampoline[Int]">ackermann</a><span class="delimiter">(</span><a href="#680993" title="Int">m</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span>, <span title="Int(1)" class="int">1</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="keyword">else</span> <span class="keyword">for</span> <span class="delimiter">{</span>
      <a title="Int" id="694693">a</a> &lt;- <a href="../../../core/scalaz/Free.scala.html#52809" title="(value: =&gt; scalaz.Free[Function0,Int])(implicit S: scalaz.Pointed[Function0])scalaz.Free[Function0,Int]">suspend</a><a href="../../../core/scalaz/Free.scala.html#117065" title="(f: Int =&gt; scalaz.Free[Function0,Int])scalaz.Free[Function0,Int]" class="delimiter">(</a><a href="#638706" title="(m: Int, n: Int)scalaz.Free.Trampoline[Int]">ackermann</a><span class="delimiter">(</span><a href="#680993" title="Int">m</a>, <a href="#680994" title="Int">n</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <a title="Int" id="698847">b</a> &lt;- <a href="../../../core/scalaz/Free.scala.html#52809" title="(value: =&gt; scalaz.Free[Function0,Int])(implicit S: scalaz.Pointed[Function0])scalaz.Free[Function0,Int]">suspend</a><a href="../../../core/scalaz/Free.scala.html#117059" title="(f: Int =&gt; Int)scalaz.Free[Function0,Int]" class="delimiter">(</a><a href="#638706" title="(m: Int, n: Int)scalaz.Free.Trampoline[Int]">ackermann</a><span class="delimiter">(</span><a href="#680993" title="Int">m</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span>, <a href="#694693" title="Int">a</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span> <span class="keyword">yield</span> <a href="#698847" title="Int">b</a>


<span class="delimiter">}</span>

        </pre>
    </body>
</html>