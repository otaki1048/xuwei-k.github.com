<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>effect/scalaz/effect/ST.scala</title>
        <script type="text/javascript" src="../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> scalaz
<span class="keyword">package</span> effect

<span class="keyword">import</span> <a href="World.scala.html#32051" title="object scalaz.effect.RealWorld">RealWorld</a>._
<span class="keyword">import</span> <a href="#32372" title="object scalaz.effect.STRef">STRef</a>._
<span class="keyword">import</span> <a href="#31835" title="object scalaz.effect.STArray">STArray</a>._
<span class="keyword">import</span> <a href="#32528" title="object scalaz.effect.ST">ST</a>._
<span class="keyword">import</span> std.<a href="../../../core/scalaz/std/Function.scala.html#26012" title="object scalaz.std.function">function</a>._
<span class="keyword">import</span> <a href="../../../core/scalaz/Id.scala.html#11472" title="object scalaz.Id">Id</a>._

<span class="comment">/**Mutable variable in state thread S containing a value of type A. http://research.microsoft.com/en-us/um/people/simonpj/papers/lazy-functional-state-threads.ps.Z */</span>
<span class="keyword">sealed</span> <span class="keyword">trait</span> <a title="trait STRef[S, A] extends java.lang.Object with ScalaObject" id="32371">STRef</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="32622">S</a>, <a title="&gt;: Nothing &lt;: Any" id="32623">A</a><span class="delimiter">]</span> <span title="ScalaObject" class="delimiter">{</span>
  <span class="keyword">protected</span> <span class="keyword">var</span> <a title="=&gt; A" id="429974">value</a>: <a href="#32623" title="A">A</a>

  <span class="comment">/**Reads the value pointed at by this reference. */</span>
  <span class="keyword">def</span> <a title="=&gt; scalaz.effect.ST[S,A]" id="429975">read</a>: <a href="#32527" title="scalaz.effect.ST[S,A]">ST</a><span class="delimiter">[</span>S, A<span class="delimiter">]</span> = <a href="#52702" title="(a: =&gt; A)scalaz.effect.ST[S,A]">returnST</a><span class="delimiter">(</span><a href="#429974" title="=&gt; A">value</a><span class="delimiter">)</span>

  <span class="comment">/**Modifies the value at this reference with the given function. */</span>
  <span class="keyword">def</span> <a title="[B](f: A =&gt; A)scalaz.effect.ST[S,scalaz.effect.STRef[S,A]]" id="429976">mod</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="429978">B</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="A =&gt; A" id="430640">f</a>: A =&gt; A<span class="delimiter">)</span>: <a href="#32527" title="scalaz.effect.ST[S,scalaz.effect.STRef[S,A]]">ST</a><span class="delimiter">[</span>S, STRef<span class="delimiter">[</span>S, A<span class="delimiter">]</span><span class="delimiter">]</span> = <a href="#52694" title="(f: scalaz.effect.World[S] =&gt; (scalaz.effect.World[S], scalaz.effect.STRef[S,A]))scalaz.effect.ST[S,scalaz.effect.STRef[S,A]]">st</a><span class="delimiter">(</span><span class="delimiter">(</span>s: <a href="World.scala.html#32035" title="scalaz.effect.World[S]">World</a><span class="delimiter">[</span>S<span class="delimiter">]</span><span class="delimiter">)</span> =&gt; <span class="delimiter">{</span>
    <a href="#429974" title="(x$1: A)Unit">value</a> = <a href="#430640" title="(v1: A)A">f</a><span class="delimiter">(</span><a href="#429974" title="=&gt; A">value</a><span class="delimiter">)</span>;
    <span title="(_1: scalaz.effect.World[S], _2: scalaz.effect.STRef[S,A])(scalaz.effect.World[S], scalaz.effect.STRef[S,A])" class="delimiter">(</span><a href="#436066" title="scalaz.effect.World[S]">s</a>, <a href="#32371" title="scalaz.effect.STRef[S,A]" class="keyword">this</a><span class="delimiter">)</span>
  <span class="delimiter">}</span><span class="delimiter">)</span>

  <span class="comment">/**Associates this reference with the given value. */</span>
  <span class="keyword">def</span> <a title="(a: =&gt; A)scalaz.effect.ST[S,scalaz.effect.STRef[S,A]]" id="429979">write</a><span class="delimiter">(</span><a title="=&gt; A" id="430625">a</a>: =&gt; A<span class="delimiter">)</span>: <a href="#32527" title="scalaz.effect.ST[S,scalaz.effect.STRef[S,A]]">ST</a><span class="delimiter">[</span>S, STRef<span class="delimiter">[</span>S, A<span class="delimiter">]</span><span class="delimiter">]</span> = <a href="#52694" title="(f: scalaz.effect.World[S] =&gt; (scalaz.effect.World[S], scalaz.effect.STRef[S,A]))scalaz.effect.ST[S,scalaz.effect.STRef[S,A]]">st</a><span class="delimiter">(</span><span class="delimiter">(</span>s: <a href="World.scala.html#32035" title="scalaz.effect.World[S]">World</a><span class="delimiter">[</span>S<span class="delimiter">]</span><span class="delimiter">)</span> =&gt; <span class="delimiter">{</span>
    <a href="#429974" title="(x$1: A)Unit">value</a> = <a href="#430625" title="=&gt; A">a</a>;
    <span title="(_1: scalaz.effect.World[S], _2: scalaz.effect.STRef[S,A])(scalaz.effect.World[S], scalaz.effect.STRef[S,A])" class="delimiter">(</span><a href="#436079" title="scalaz.effect.World[S]">s</a>, <a href="#32371" title="scalaz.effect.STRef[S,A]" class="keyword">this</a><span class="delimiter">)</span>
  <span class="delimiter">}</span><span class="delimiter">)</span>

  <span class="comment">/**Synonym for write*/</span>
  <span class="keyword">def</span> <a title="(a: =&gt; A)scalaz.effect.ST[S,scalaz.effect.STRef[S,A]]" id="429980">|=</a><span class="delimiter">(</span><a title="=&gt; A" id="436087">a</a>: =&gt; A<span class="delimiter">)</span>: <a href="#32527" title="scalaz.effect.ST[S,scalaz.effect.STRef[S,A]]">ST</a><span class="delimiter">[</span>S, STRef<span class="delimiter">[</span>S, A<span class="delimiter">]</span><span class="delimiter">]</span> =
    <a href="#429979" title="(a: =&gt; A)scalaz.effect.ST[S,scalaz.effect.STRef[S,A]]">write</a><span class="delimiter">(</span><a href="#436087" title="=&gt; A">a</a><span class="delimiter">)</span>

  <span class="comment">/**Swap the value at this reference with the value at another. */</span>
  <span class="keyword">def</span> <a title="(that: scalaz.effect.STRef[S,A])scalaz.effect.ST[S,Unit]" id="429981">swap</a><span class="delimiter">(</span><a title="scalaz.effect.STRef[S,A]" id="436089">that</a>: <a href="#32371" title="scalaz.effect.STRef[S,A]">STRef</a><span class="delimiter">[</span>S, A<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#32527" title="scalaz.effect.ST[S,Unit]">ST</a><span class="delimiter">[</span>S, Unit<span class="delimiter">]</span> = <span class="keyword">for</span> <span class="delimiter">{</span>
    <a title="A" id="436095">v1</a> &lt;- <a href="#32371" title="STRef.this.type" class="keyword">this</a>.<a href="#428231" title="(g: A =&gt; scalaz.effect.ST[S,Unit])scalaz.effect.ST[S,Unit]">read</a>
    <a title="A" id="436099">v2</a> &lt;- <a href="#436089" title="scalaz.effect.STRef[S,A]">that</a>.<a href="#428231" title="(g: A =&gt; scalaz.effect.ST[S,Unit])scalaz.effect.ST[S,Unit]">read</a>
    <a title="scalaz.effect.STRef[S,A]" id="436104">_</a> &lt;- <a href="#32371" title="STRef.this.type" class="keyword">this</a> <a href="#428231" title="(g: scalaz.effect.STRef[S,A] =&gt; scalaz.effect.ST[S,Unit])scalaz.effect.ST[S,Unit]">write</a> <a href="#436099" title="A">v2</a>
    <a title="scalaz.effect.STRef[S,A]" id="436109">_</a> &lt;- <a href="#436089" title="scalaz.effect.STRef[S,A]">that</a> <a href="#428234" title="(g: scalaz.effect.STRef[S,A] =&gt; Unit)scalaz.effect.ST[S,Unit]">write</a> <a href="#436095" title="A">v1</a>
  <span class="delimiter">}</span> <span class="keyword">yield</span> <span title="Unit" class="delimiter">(</span><span class="delimiter">)</span>
<span class="delimiter">}</span>

<span class="keyword">object</span> <a title="object scalaz.effect.STRef" id="32372">STRef</a> <span title="ScalaObject" class="keyword">extends</span> <a href="#32512" title="scalaz.effect.STRefFunctions">STRefFunctions</a> <span class="keyword">with</span> <a href="#32416" title="scalaz.effect.STRefInstances">STRefInstances</a> <span class="delimiter">{</span>

  <span class="keyword">def</span> <a title="[S]=&gt; scalaz.package.~&gt;[scalaz.Id.Id,[α]scalaz.effect.STRef[S,α]]" id="428291">apply</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="428293">S</a><span class="delimiter">]</span>: <span class="delimiter">(</span>Id <a href="../../../core/scalaz/NaturalTransformation.scala.html#16934" title="scalaz.package.~&gt;[scalaz.Id.Id,[α]scalaz.effect.STRef[S,α]]">~&gt;</a> <span class="delimiter">(</span><span class="delimiter">{</span><span class="keyword">type</span> λ<span class="delimiter">[</span>α<span class="delimiter">]</span> = STRef<span class="delimiter">[</span>S, α<span class="delimiter">]</span><span class="delimiter">}</span><span class="delimiter">)</span>#λ<span class="delimiter">)</span> =
    <a href="#428287" title="[S]=&gt; scalaz.package.~&gt;[scalaz.Id.Id,[α]scalaz.effect.STRef[S,α]]">stRef</a><span title="scalaz.package.~&gt;[scalaz.Id.Id,[α]scalaz.effect.STRef[S,α]]" class="delimiter">[</span><a href="#428293" title="S">S</a><span class="delimiter">]</span>
<span class="delimiter">}</span>

<span class="keyword">trait</span> <a title="trait STRefFunctions extends java.lang.Object with ScalaObject" id="32512">STRefFunctions</a> <span title="ScalaObject" class="delimiter">{</span>

  <span class="keyword">def</span> <a title="[S]=&gt; scalaz.package.~&gt;[scalaz.Id.Id,[α]scalaz.effect.STRef[S,α]]" id="428287">stRef</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="428289">S</a><span class="delimiter">]</span>: <span class="delimiter">(</span>Id <a href="../../../core/scalaz/NaturalTransformation.scala.html#16934" title="scalaz.package.~&gt;[scalaz.Id.Id,[α]scalaz.effect.STRef[S,α]]">~&gt;</a> <span class="delimiter">(</span><span class="delimiter">{</span><span class="keyword">type</span> λ<span class="delimiter">[</span>α<span class="delimiter">]</span> = STRef<span class="delimiter">[</span>S, α<span class="delimiter">]</span><span class="delimiter">}</span><span class="delimiter">)</span>#λ<span class="delimiter">)</span> = <a href="#436140" title="java.lang.Object with scalaz.package.~&gt;[scalaz.Id.Id,[α]scalaz.effect.STRef[S,α]]" class="keyword">new</a> <a title="anonymous class $anon extends java.lang.Object with scalaz.package.~&gt;[scalaz.Id.Id,[α]scalaz.effect.STRef[S,α]]" id="436140" class="delimiter">(</a>Id <a href="../../../core/scalaz/NaturalTransformation.scala.html#16934" title="scalaz.package.~&gt;[scalaz.Id.Id,[α]scalaz.effect.STRef[S,α]]">~&gt;</a> <span class="delimiter">(</span><span class="delimiter">{</span><span class="keyword">type</span> λ<span class="delimiter">[</span>α<span class="delimiter">]</span> = STRef<span class="delimiter">[</span>S, α<span class="delimiter">]</span><span class="delimiter">}</span><span class="delimiter">)</span>#λ<span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="[A](a: A)java.lang.Object with scalaz.effect.STRef[S,A]" id="436149">apply</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="436151">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="A" id="436152">a</a>: <a href="#436151" title="A">A</a><span class="delimiter">)</span> = <a href="#436161" title="java.lang.Object with scalaz.effect.STRef[S,A]{}" class="keyword">new</a> <a title="anonymous class $anon extends java.lang.Object with scalaz.effect.STRef[S,A]" id="436161">STRef</a><span class="delimiter">[</span>S, A<span class="delimiter">]</span> <span class="delimiter">{</span>
      <span class="keyword">var</span> <a title="A" id="436166">value</a> = <a href="#436152" title="A">a</a>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="keyword">trait</span> <a title="trait STRefInstances extends java.lang.Object with ScalaObject" id="32416">STRefInstances</a> <span title="ScalaObject" class="delimiter">{</span>
  
  <span class="comment">/**Equality for STRefs is reference equality */</span>
  <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="[S, A]=&gt; scalaz.Equal[scalaz.effect.STRef[S,A]]" id="428295">STRefEqual</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="428298">S</a>, <a title="&gt;: Nothing &lt;: Any" id="428299">A</a><span class="delimiter">]</span>: <a href="../../../core/scalaz/Equal.scala.html#20114" title="scalaz.Equal[scalaz.effect.STRef[S,A]]">Equal</a><span class="delimiter">[</span>STRef<span class="delimiter">[</span>S, A<span class="delimiter">]</span><span class="delimiter">]</span> =
    <a href="../../../core/scalaz/Equal.scala.html#20115" title="object scalaz.Equal">Equal</a>.<a href="../../../core/scalaz/Equal.scala.html#105771" title="scalaz.Equal[scalaz.effect.STRef[S,A]]">equalA</a> <span class="comment">// todo reference equality?</span>
<span class="delimiter">}</span>

<span class="comment">/**Mutable array in state thread S containing values of type A. */</span>
<span class="keyword">sealed</span> <span class="keyword">trait</span> <a title="trait STArray[S, A] extends java.lang.Object with ScalaObject" id="31834">STArray</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="32624">S</a>, <a title="&gt;: Nothing &lt;: Any" id="32625">A</a><span class="delimiter">]</span> <span title="ScalaObject" class="delimiter">{</span>
  <span class="keyword">def</span> <a title="=&gt; Int" id="436201">size</a>: <span title="Int">Int</span>
  <span class="keyword">def</span> <a title="=&gt; A" id="436202">z</a>: <a href="#32625" title="A">A</a>
  <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="=&gt; Manifest[A]" id="436203">manifest</a>: <span title="Manifest[A]">Manifest</span><span class="delimiter">[</span>A<span class="delimiter">]</span>

  <span class="keyword">private</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="Array[A]" id="436205">value</a>: <span title="Array[A]">Array</span><span class="delimiter">[</span>A<span class="delimiter">]</span> = <span title="object Array">Array</span>.<span title="(n: Int)(elem: =&gt; A)(implicit evidence$9: scala.reflect.ClassManifest[A])Array[A]">fill</span><span class="delimiter">(</span><a href="#436201" title="=&gt; Int">size</a><span class="delimiter">)</span><a href="#436203" title="=&gt; Manifest[A]" class="delimiter">(</a><a href="#436202" title="=&gt; A">z</a><span class="delimiter">)</span>

  <span class="keyword">import</span> <a href="#32528" title="object scalaz.effect.ST">ST</a>._

  <span class="comment">/**Reads the value at the given index. */</span>
  <span class="keyword">def</span> <a title="(i: Int)scalaz.effect.ST[S,A]" id="436207">read</a><span class="delimiter">(</span><a title="Int" id="436280">i</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <a href="#32527" title="scalaz.effect.ST[S,A]">ST</a><span class="delimiter">[</span>S, A<span class="delimiter">]</span> = <a href="#52702" title="(a: =&gt; A)scalaz.effect.ST[S,A]">returnST</a><span class="delimiter">(</span><a href="#436204" title="(i: Int)A">value</a><span class="delimiter">(</span><a href="#436280" title="Int">i</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="comment">/**Writes the given value to the array, at the given offset. */</span>
  <span class="keyword">def</span> <a title="(i: Int, a: A)scalaz.effect.ST[S,scalaz.effect.STArray[S,A]]" id="436208">write</a><span class="delimiter">(</span><a title="Int" id="436286">i</a>: <span title="Int">Int</span>, <a title="A" id="436287">a</a>: <a href="#32625" title="A">A</a><span class="delimiter">)</span>: <a href="#32527" title="scalaz.effect.ST[S,scalaz.effect.STArray[S,A]]">ST</a><span class="delimiter">[</span>S, STArray<span class="delimiter">[</span>S, A<span class="delimiter">]</span><span class="delimiter">]</span> = <a href="#52694" title="(f: scalaz.effect.World[S] =&gt; (scalaz.effect.World[S], scalaz.effect.STArray[S,A]))scalaz.effect.ST[S,scalaz.effect.STArray[S,A]]">st</a><span class="delimiter">(</span><a title="scalaz.effect.World[S]" id="436293">s</a> =&gt; <span class="delimiter">{</span>
    <a href="#436204" title="(i: Int, x: A)Unit">value</a><span class="delimiter">(</span><a href="#436286" title="Int">i</a><span class="delimiter">)</span> = <a href="#436287" title="A">a</a>;
    <span title="(_1: scalaz.effect.World[S], _2: scalaz.effect.STArray[S,A])(scalaz.effect.World[S], scalaz.effect.STArray[S,A])" class="delimiter">(</span><a href="#436293" title="scalaz.effect.World[S]">s</a>, <a href="#31834" title="scalaz.effect.STArray[S,A]" class="keyword">this</a><span class="delimiter">)</span>
  <span class="delimiter">}</span><span class="delimiter">)</span>

  <span class="comment">/**Turns a mutable array into an immutable one which is safe to return. */</span>
  <span class="keyword">def</span> <a title="=&gt; scalaz.effect.ST[S,scalaz.ImmutableArray[A]]" id="436209">freeze</a>: <a href="#32527" title="scalaz.effect.ST[S,scalaz.ImmutableArray[A]]">ST</a><span class="delimiter">[</span>S, ImmutableArray<span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span> = <a href="#52694" title="(f: scalaz.effect.World[S] =&gt; (scalaz.effect.World[S], scalaz.ImmutableArray[A]))scalaz.effect.ST[S,scalaz.ImmutableArray[A]]">st</a><span class="delimiter">(</span><a title="scalaz.effect.World[S]" id="436309">s</a> =&gt; <span title="(_1: scalaz.effect.World[S], _2: scalaz.ImmutableArray[A])(scalaz.effect.World[S], scalaz.ImmutableArray[A])" class="delimiter">(</span><a href="#436309" title="scalaz.effect.World[S]">s</a>, <a href="../../../core/scalaz/ImmutableArray.scala.html#10572" title="object scalaz.ImmutableArray">ImmutableArray</a>.<a href="../../../core/scalaz/ImmutableArray.scala.html#188670" title="(x: Array[A])scalaz.ImmutableArray[A]">fromArray</a><span class="delimiter">(</span><a href="#436204" title="=&gt; Array[A]">value</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="comment">/**Fill this array from the given association list. */</span>
  <span class="keyword">def</span> <a title="[B](f: (A, B) =&gt; A, xs: Traversable[(Int, B)])scalaz.effect.ST[S,Unit]" id="436210">fill</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="436212">B</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="(A, B) =&gt; A" id="436320">f</a>: <span class="delimiter">(</span>A, B<span class="delimiter">)</span> =&gt; A, <a title="Traversable[(Int, B)]" id="436321">xs</a>: <span title="Traversable[(Int, B)]">Traversable</span><span class="delimiter">[</span><span class="delimiter">(</span>Int, B<span class="delimiter">)</span><span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#32527" title="scalaz.effect.ST[S,Unit]">ST</a><span class="delimiter">[</span>S, Unit<span class="delimiter">]</span> = <a href="#436321" title="Traversable[(Int, B)]">xs</a> <span title="scalaz.effect.ST[S,Unit]" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <span title="scalaz.effect.ST[S,Unit]">Nil</span>             =&gt; <a href="#52702" title="(a: =&gt; Unit)scalaz.effect.ST[S,Unit]">returnST</a><span class="delimiter">(</span><span title="Unit" class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="keyword">case</span> <span title="scalaz.effect.ST[S,Unit]" class="delimiter">(</span><span class="delimiter">(</span><a title="Int" id="436338">i</a>, <a title="B" id="436339">v</a><span class="delimiter">)</span> :: <a title="List[(Int, B)]" id="436340">ivs</a><span class="delimiter">)</span> =&gt; <span class="keyword">for</span> <span class="delimiter">{</span>
      <a title="Unit" id="436374">_</a> &lt;- <a href="#436213" title="(f: (A, B) =&gt; A, i: Int, v: B)scalaz.effect.ST[S,Unit]">update</a><a href="#428231" title="(g: Unit =&gt; scalaz.effect.ST[S,Unit])scalaz.effect.ST[S,Unit]" class="delimiter">(</a><a href="#436320" title="(A, B) =&gt; A">f</a>, <a href="#436338" title="Int">i</a>, <a href="#436339" title="B">v</a><span class="delimiter">)</span>
      <a title="Unit" id="436393">_</a> &lt;- <a href="#436210" title="(f: (A, B) =&gt; A, xs: Traversable[(Int, B)])scalaz.effect.ST[S,Unit]">fill</a><a href="#428234" title="(g: Unit =&gt; Unit)scalaz.effect.ST[S,Unit]" class="delimiter">(</a><a href="#436320" title="(A, B) =&gt; A">f</a>, <a href="#436340" title="List[(Int, B)]">ivs</a><span class="delimiter">)</span>
    <span class="delimiter">}</span> <span class="keyword">yield</span> <span title="Unit" class="delimiter">(</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**Combine the given value with the value at the given index, using the given function. */</span>
  <span class="keyword">def</span> <a title="[B](f: (A, B) =&gt; A, i: Int, v: B)scalaz.effect.ST[S,Unit]" id="436213">update</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="436215">B</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="(A, B) =&gt; A" id="436341">f</a>: <span class="delimiter">(</span>A, B<span class="delimiter">)</span> =&gt; A, <a title="Int" id="436342">i</a>: <span title="Int">Int</span>, <a title="B" id="436343">v</a>: <a href="#436215" title="B">B</a><span class="delimiter">)</span> = <span class="keyword">for</span> <span class="delimiter">{</span>
    <a title="A" id="436350">x</a> &lt;- <a href="#436207" title="(i: Int)scalaz.effect.ST[S,A]">read</a><a href="#428231" title="(g: A =&gt; scalaz.effect.ST[S,Unit])scalaz.effect.ST[S,Unit]" class="delimiter">(</a><a href="#436342" title="Int">i</a><span class="delimiter">)</span>
    <a title="scalaz.effect.STArray[S,A]" id="436357">_</a> &lt;- <a href="#436208" title="(i: Int, a: A)scalaz.effect.ST[S,scalaz.effect.STArray[S,A]]">write</a><a href="#428234" title="(g: scalaz.effect.STArray[S,A] =&gt; Unit)scalaz.effect.ST[S,Unit]" class="delimiter">(</a><a href="#436342" title="Int">i</a>, <a href="#436341" title="(v1: A, v2: B)A">f</a><span class="delimiter">(</span><a href="#436350" title="A">x</a>, <a href="#436343" title="B">v</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span> <span class="keyword">yield</span> <span title="Unit" class="delimiter">(</span><span class="delimiter">)</span>
<span class="delimiter">}</span>

<span class="keyword">object</span> <a title="object scalaz.effect.STArray" id="31835">STArray</a> <span title="ScalaObject" class="keyword">extends</span> <a href="#32479" title="scalaz.effect.STArrayFunctions">STArrayFunctions</a> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="[S, A](s: Int, a: A)(implicit m: Manifest[A])scalaz.effect.STArray[S,A]" id="428281">apply</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="428284">S</a>, <a title="&gt;: Nothing &lt;: Any" id="428285">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="Int" id="436397">s</a>: <span title="Int">Int</span>, <a title="A" id="436398">a</a>: <a href="#428285" title="A">A</a><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="Manifest[A]" id="436399">m</a>: <span title="Manifest[A]">Manifest</span><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#31834" title="scalaz.effect.STArray[S,A]">STArray</a><span class="delimiter">[</span>S, A<span class="delimiter">]</span> = <a href="#428275" title="(s: Int, a: A)(implicit m: Manifest[A])scalaz.effect.STArray[S,A]">stArray</a><a href="#436399" title="Manifest[A]" class="delimiter">(</a><a href="#436397" title="Int">s</a>, <a href="#436398" title="A">a</a><span class="delimiter">)</span>
<span class="delimiter">}</span>

<span class="keyword">trait</span> <a title="trait STArrayFunctions extends java.lang.Object with ScalaObject" id="32479">STArrayFunctions</a> <span title="ScalaObject" class="delimiter">{</span>
  <span class="keyword">def</span> <a title="[S, A](s: Int, a: A)(implicit m: Manifest[A])scalaz.effect.STArray[S,A]" id="428275">stArray</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="428278">S</a>, <a title="&gt;: Nothing &lt;: Any" id="428279">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="Int" id="436404">s</a>: <span title="Int">Int</span>, <a title="A" id="436405">a</a>: <a href="#428279" title="A">A</a><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="Manifest[A]" id="436406">m</a>: <span title="Manifest[A]">Manifest</span><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#31834" title="scalaz.effect.STArray[S,A]">STArray</a><span class="delimiter">[</span>S, A<span class="delimiter">]</span> = <a href="#436442" title="java.lang.Object with scalaz.effect.STArray[S,A]{}" class="keyword">new</a> <a title="anonymous class $anon extends java.lang.Object with scalaz.effect.STArray[S,A]" id="436442">STArray</a><span class="delimiter">[</span>S, A<span class="delimiter">]</span> <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Int" id="436446">size</a> = <a href="#436404" title="Int">s</a>
    <span class="keyword">val</span> <a title="A" id="436448">z</a> = <a href="#436405" title="A">a</a>
    <span class="keyword">implicit</span> <span class="keyword">val</span> <a title="Manifest[A]" id="436450">manifest</a> = <a href="#436406" title="Manifest[A]">m</a>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="comment">/**
 * Purely functional mutable state threads.
 * Based on JL and SPJ's paper &quot;Lazy Functional State Threads&quot;
 */</span>
<span class="keyword">sealed</span> <span class="keyword">trait</span> <a title="trait ST[S, A] extends java.lang.Object with ScalaObject" id="32527">ST</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="32626">S</a>, <a title="&gt;: Nothing &lt;: Any" id="32627">A</a><span class="delimiter">]</span> <span title="ScalaObject" class="delimiter">{</span>
  <span class="keyword">private</span><span class="delimiter">[</span>effect<span class="delimiter">]</span> <span class="keyword">def</span> <a title="(s: scalaz.effect.World[S])(scalaz.effect.World[S], A)" id="428229">apply</a><span class="delimiter">(</span><a title="scalaz.effect.World[S]" id="436456">s</a>: <a href="World.scala.html#32035" title="scalaz.effect.World[S]">World</a><span class="delimiter">[</span>S<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="(scalaz.effect.World[S], A)" class="delimiter">(</span>World<span class="delimiter">[</span>S<span class="delimiter">]</span>, A<span class="delimiter">)</span>

  <span class="keyword">import</span> <a href="#32528" title="object scalaz.effect.ST">ST</a>._

  <span class="keyword">def</span> <a title="[B](g: A =&gt; scalaz.effect.ST[S,B])scalaz.effect.ST[S,B]" id="428231">flatMap</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="428233">B</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="A =&gt; scalaz.effect.ST[S,B]" id="430644">g</a>: A =&gt; ST<span class="delimiter">[</span>S, B<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#32527" title="scalaz.effect.ST[S,B]">ST</a><span class="delimiter">[</span>S, B<span class="delimiter">]</span> =
    <a href="#52694" title="(f: scalaz.effect.World[S] =&gt; (scalaz.effect.World[S], B))scalaz.effect.ST[S,B]">st</a><span class="delimiter">(</span><a title="scalaz.effect.World[S]" id="436462">s</a> =&gt; <a href="#428229" title="(s: scalaz.effect.World[S])(scalaz.effect.World[S], A)">apply</a><span class="delimiter">(</span><a href="#436462" title="scalaz.effect.World[S]">s</a><span class="delimiter">)</span> <span title="(scalaz.effect.World[S], B)" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <span title="(scalaz.effect.World[S], B)" class="delimiter">(</span><a title="scalaz.effect.World[S]" id="436465">ns</a>, <a title="A" id="436466">a</a><span class="delimiter">)</span> =&gt; <a href="#430644" title="(v1: A)scalaz.effect.ST[S,B]">g</a><a href="#428229" title="(s: scalaz.effect.World[S])(scalaz.effect.World[S], B)" class="delimiter">(</a><a href="#436466" title="A">a</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#436465" title="scalaz.effect.World[S]">ns</a><span class="delimiter">)</span>
    <span class="delimiter">}</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="[B](g: A =&gt; B)scalaz.effect.ST[S,B]" id="428234">map</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="428236">B</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="A =&gt; B" id="430628">g</a>: A =&gt; B<span class="delimiter">)</span>: <a href="#32527" title="scalaz.effect.ST[S,B]">ST</a><span class="delimiter">[</span>S, B<span class="delimiter">]</span> =
    <a href="#52694" title="(f: scalaz.effect.World[S] =&gt; (scalaz.effect.World[S], B))scalaz.effect.ST[S,B]">st</a><span class="delimiter">(</span><a title="scalaz.effect.World[S]" id="436473">s</a> =&gt; <a href="#428229" title="(s: scalaz.effect.World[S])(scalaz.effect.World[S], A)">apply</a><span class="delimiter">(</span><a href="#436473" title="scalaz.effect.World[S]">s</a><span class="delimiter">)</span> <span title="(scalaz.effect.World[S], B)" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <span title="(scalaz.effect.World[S], B)" class="delimiter">(</span><a title="scalaz.effect.World[S]" id="436476">ns</a>, <a title="A" id="436477">a</a><span class="delimiter">)</span> =&gt; <span title="(_1: scalaz.effect.World[S], _2: B)(scalaz.effect.World[S], B)" class="delimiter">(</span><a href="#436476" title="scalaz.effect.World[S]">ns</a>, <a href="#430628" title="(v1: A)B">g</a><span class="delimiter">(</span><a href="#436477" title="A">a</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span><span class="delimiter">)</span>
<span class="delimiter">}</span>

<span class="keyword">object</span> <a title="object scalaz.effect.ST" id="32528">ST</a> <span title="ScalaObject" class="keyword">extends</span> <a href="#32503" title="scalaz.effect.STFunctions">STFunctions</a> <span class="keyword">with</span> <a href="#32158" title="scalaz.effect.STInstances">STInstances</a> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="[S, A](a: =&gt; A)scalaz.effect.ST[S,A]" id="52731">apply</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="52734">S</a>, <a title="&gt;: Nothing &lt;: Any" id="52735">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="=&gt; A" id="436487">a</a>: =&gt; A<span class="delimiter">)</span>: <a href="#32527" title="scalaz.effect.ST[S,A]">ST</a><span class="delimiter">[</span>S, A<span class="delimiter">]</span> =
    <a href="#52702" title="(a: =&gt; A)scalaz.effect.ST[S,A]">returnST</a><span class="delimiter">(</span><a href="#436487" title="=&gt; A">a</a><span class="delimiter">)</span>
<span class="delimiter">}</span>

<span class="keyword">trait</span> <a title="trait STFunctions extends java.lang.Object with ScalaObject" id="32503">STFunctions</a> <span title="ScalaObject" class="delimiter">{</span>
  <span class="keyword">def</span> <a title="[S, A](f: scalaz.effect.World[S] =&gt; (scalaz.effect.World[S], A))scalaz.effect.ST[S,A]" id="52694">st</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="52697">S</a>, <a title="&gt;: Nothing &lt;: Any" id="52698">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="scalaz.effect.World[S] =&gt; (scalaz.effect.World[S], A)" id="430551">f</a>: World<span class="delimiter">[</span>S<span class="delimiter">]</span> =&gt; <span class="delimiter">(</span>World<span class="delimiter">[</span>S<span class="delimiter">]</span>, A<span class="delimiter">)</span><span class="delimiter">)</span>: <a href="#32527" title="scalaz.effect.ST[S,A]">ST</a><span class="delimiter">[</span>S, A<span class="delimiter">]</span> = <a href="#436496" title="java.lang.Object with scalaz.effect.ST[S,A]" class="keyword">new</a> <a title="anonymous class $anon extends java.lang.Object with scalaz.effect.ST[S,A]" id="436496">ST</a><span class="delimiter">[</span>S, A<span class="delimiter">]</span> <span class="delimiter">{</span>
    <span class="keyword">private</span><span class="delimiter">[</span>effect<span class="delimiter">]</span> <span class="keyword">def</span> <a title="(s: scalaz.effect.World[S])(scalaz.effect.World[S], A)" id="436500">apply</a><span class="delimiter">(</span><a title="scalaz.effect.World[S]" id="436501">s</a>: <a href="World.scala.html#32035" title="scalaz.effect.World[S]">World</a><span class="delimiter">[</span>S<span class="delimiter">]</span><span class="delimiter">)</span> = <a href="#430551" title="(v1: scalaz.effect.World[S])(scalaz.effect.World[S], A)">f</a><span class="delimiter">(</span><a href="#436501" title="scalaz.effect.World[S]">s</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">// Implicit conversions between IO and ST</span>
  <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="[A](st: scalaz.effect.ST[scalaz.effect.RealWorld,A])scalaz.effect.IO[A]" id="52699">STToIO</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="52701">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="scalaz.effect.ST[scalaz.effect.RealWorld,A]" id="428315">st</a>: <a href="#32527" title="scalaz.effect.ST[scalaz.effect.RealWorld,A]">ST</a><span class="delimiter">[</span>RealWorld, A<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="IO.scala.html#31912" title="scalaz.effect.IO[A]">IO</a><span class="delimiter">[</span>A<span class="delimiter">]</span> =
    <a href="IO.scala.html#31913" title="object scalaz.effect.IO">IO</a>.<a href="IO.scala.html#52638" title="(f: scalaz.effect.World[scalaz.effect.RealWorld] =&gt; scalaz.Free.Trampoline[(scalaz.effect.World[scalaz.effect.RealWorld], A)])scalaz.effect.IO[A]">io</a><span class="delimiter">(</span><a title="scalaz.effect.World[scalaz.effect.RealWorld]" id="436511">rw</a> =&gt; <a href="../../../core/scalaz/Free.scala.html#23049" title="object scalaz.Free">Free</a>.<a href="../../../core/scalaz/Free.scala.html#52932" title="(value: =&gt; (scalaz.effect.World[scalaz.effect.RealWorld], A))(implicit S: scalaz.Pointed[Function0])scalaz.Free[Function0,(scalaz.effect.World[scalaz.effect.RealWorld], A)]">return_</a><a href="../../../core/scalaz/std/Function.scala.html#53007" title="function0Instance extends java.lang.Object with scalaz.Traverse[Function0] with scalaz.Monad[Function0] with scalaz.Copointed[Function0]" class="delimiter">(</a><a href="#428229" title="(s: scalaz.effect.World[scalaz.effect.RealWorld])(scalaz.effect.World[scalaz.effect.RealWorld], A)">st</a><span class="delimiter">(</span><a href="#436511" title="scalaz.effect.World[scalaz.effect.RealWorld]">rw</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="comment">/**Put a value in a state thread */</span>
  <span class="keyword">def</span> <a title="[S, A](a: =&gt; A)scalaz.effect.ST[S,A]" id="52702">returnST</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="52705">S</a>, <a title="&gt;: Nothing &lt;: Any" id="52706">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="=&gt; A" id="436055">a</a>: =&gt; A<span class="delimiter">)</span>: <a href="#32527" title="scalaz.effect.ST[S,A]">ST</a><span class="delimiter">[</span>S, A<span class="delimiter">]</span> =
    <a href="#52694" title="(f: scalaz.effect.World[S] =&gt; (scalaz.effect.World[S], A))scalaz.effect.ST[S,A]">st</a><span class="delimiter">(</span><a title="scalaz.effect.World[S]" id="436561">s</a> =&gt; <span title="(_1: scalaz.effect.World[S], _2: A)(scalaz.effect.World[S], A)" class="delimiter">(</span><a href="#436561" title="scalaz.effect.World[S]">s</a>, <a href="#436055" title="=&gt; A">a</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="comment">/**Run a state thread */</span>
  <span class="keyword">def</span> <a title="[A](f: scalaz.Forall[[S]scalaz.effect.ST[S,A]])A" id="52707">runST</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="52709">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="scalaz.Forall[[S]scalaz.effect.ST[S,A]]" id="436569">f</a>: <a href="../../../core/scalaz/Forall.scala.html#19142" title="scalaz.Forall[[S]scalaz.effect.ST[S,A]]">Forall</a><span class="delimiter">[</span><span class="delimiter">(</span><span class="delimiter">{</span><span class="keyword">type</span> λ<span class="delimiter">[</span>S<span class="delimiter">]</span> = ST<span class="delimiter">[</span>S, A<span class="delimiter">]</span><span class="delimiter">}</span><span class="delimiter">)</span>#λ<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#52709" title="A">A</a> =
    <a href="#436569" title="scalaz.Forall[[S]scalaz.effect.ST[S,A]]">f</a>.<a href="../../../core/scalaz/Forall.scala.html#195662" title="scalaz.effect.ST[scalaz.effect.RealWorld,A]">apply</a>.<a href="#428229" title="(s: scalaz.effect.World[scalaz.effect.RealWorld])(scalaz.effect.World[scalaz.effect.RealWorld], A)">apply</a><span class="delimiter">(</span><a href="World.scala.html#52791" title="=&gt; scalaz.effect.World[scalaz.effect.RealWorld]">realWorld</a><span class="delimiter">)</span>.<span title="=&gt; A">_2</span>

  <span class="comment">/**Allocates a fresh mutable reference. */</span>
  <span class="keyword">def</span> <a title="[S]=&gt; scalaz.package.~&gt;[scalaz.Id.Id,[α]scalaz.effect.ST[S,scalaz.effect.STRef[S,α]]]" id="52710">newVar</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="52712">S</a><span class="delimiter">]</span>: <span class="delimiter">(</span>Id <a href="../../../core/scalaz/NaturalTransformation.scala.html#16934" title="scalaz.package.~&gt;[scalaz.Id.Id,[α]scalaz.effect.ST[S,scalaz.effect.STRef[S,α]]]">~&gt;</a> <span class="delimiter">(</span><span class="delimiter">{</span><span class="keyword">type</span> λ<span class="delimiter">[</span>α<span class="delimiter">]</span> = ST<span class="delimiter">[</span>S, STRef<span class="delimiter">[</span>S, α<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">}</span><span class="delimiter">)</span>#λ<span class="delimiter">)</span> = <a href="#436585" title="java.lang.Object with scalaz.package.~&gt;[scalaz.Id.Id,[α]scalaz.effect.ST[S,scalaz.effect.STRef[S,α]]]" class="keyword">new</a> <a title="anonymous class $anon extends java.lang.Object with scalaz.package.~&gt;[scalaz.Id.Id,[α]scalaz.effect.ST[S,scalaz.effect.STRef[S,α]]]" id="436585" class="delimiter">(</a>Id <a href="../../../core/scalaz/NaturalTransformation.scala.html#16934" title="scalaz.package.~&gt;[scalaz.Id.Id,[α]scalaz.effect.ST[S,scalaz.effect.STRef[S,α]]]">~&gt;</a> <span class="delimiter">(</span><span class="delimiter">{</span><span class="keyword">type</span> λ<span class="delimiter">[</span>α<span class="delimiter">]</span> = ST<span class="delimiter">[</span>S, STRef<span class="delimiter">[</span>S, α<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">}</span><span class="delimiter">)</span>#λ<span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="[A](a: A)scalaz.effect.ST[S,scalaz.effect.STRef[S,A]]" id="436594">apply</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="436596">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="A" id="436597">a</a>: <a href="#436596" title="A">A</a><span class="delimiter">)</span> = <a href="#52702" title="(a: =&gt; scalaz.effect.STRef[S,A])scalaz.effect.ST[S,scalaz.effect.STRef[S,A]]">returnST</a><span class="delimiter">(</span><a href="#428287" title="[S]=&gt; scalaz.package.~&gt;[scalaz.Id.Id,[α]scalaz.effect.STRef[S,α]]">stRef</a><a href="../../../core/scalaz/NaturalTransformation.scala.html#148051" title="(fa: scalaz.Id.Id[A])scalaz.effect.STRef[S,A]" class="delimiter">[</a><a href="#52712" title="S">S</a><span class="delimiter">]</span><span class="delimiter">(</span><a href="#436597" title="A">a</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**Allocates a fresh mutable array. */</span>
  <span class="keyword">def</span> <a title="[S, A](size: Int, z: A)(implicit evidence$1: Manifest[A])scalaz.effect.ST[S,scalaz.effect.STArray[S,A]]" id="436627">newArr</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="52716">S</a>, <a title="&gt;: Nothing &lt;: Any" id="52717">A</a>: Manifest<span class="delimiter">]</span><span class="delimiter">(</span><a title="Int" id="436625">size</a>: <span title="Int">Int</span>, <a title="A" id="436626">z</a>: <a href="#52717" title="A">A</a><span class="delimiter">)</span>: <a href="#32527" title="scalaz.effect.ST[S,scalaz.effect.STArray[S,A]]">ST</a><span class="delimiter">[</span>S, STArray<span class="delimiter">[</span>S, A<span class="delimiter">]</span><span class="delimiter">]</span> =
    <a href="#52702" title="(a: =&gt; scalaz.effect.STArray[S,A])scalaz.effect.ST[S,scalaz.effect.STArray[S,A]]">returnST</a><span class="delimiter">(</span><a href="#428275" title="[S, A](s: Int, a: A)(implicit m: Manifest[A])scalaz.effect.STArray[S,A]">stArray</a><span title="(s: Int, a: A)(implicit m: Manifest[A])scalaz.effect.STArray[S,A]" class="delimiter">[</span><a href="#52716" title="S">S</a>, <a href="#52717" title="A">A</a><span class="delimiter">]</span><a href="#436627" title="Manifest[A]" class="delimiter">(</a><a href="#436625" title="Int">size</a>, <a href="#436626" title="A">z</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="comment">/**Allows the result of a state transformer computation to be used lazily inside the computation. */</span>
  <span class="keyword">def</span> <a title="[S, A](k: =&gt; A =&gt; scalaz.effect.ST[S,A])scalaz.effect.ST[S,A]" id="52718">fixST</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="52721">S</a>, <a title="&gt;: Nothing &lt;: Any" id="52722">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="=&gt; A =&gt; scalaz.effect.ST[S,A]" id="436658">k</a>: <span class="delimiter">(</span>=&gt; A<span class="delimiter">)</span> =&gt; ST<span class="delimiter">[</span>S, A<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#32527" title="scalaz.effect.ST[S,A]">ST</a><span class="delimiter">[</span>S, A<span class="delimiter">]</span> = <a href="#52694" title="(f: scalaz.effect.World[S] =&gt; (scalaz.effect.World[S], A))scalaz.effect.ST[S,A]">st</a><span class="delimiter">(</span><a title="scalaz.effect.World[S]" id="436665">s</a> =&gt; <span class="delimiter">{</span>
    <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="(scalaz.effect.World[S], A)" id="436667">ans</a>: <span title="(scalaz.effect.World[S], A)" class="delimiter">(</span>World<span class="delimiter">[</span>S<span class="delimiter">]</span>, A<span class="delimiter">)</span> = <a href="#436658" title="(v1: =&gt; A)scalaz.effect.ST[S,A]">k</a><a href="#428229" title="(s: scalaz.effect.World[S])(scalaz.effect.World[S], A)" class="delimiter">(</a><a href="#436668" title="=&gt; A">r</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#436665" title="scalaz.effect.World[S]">s</a><span class="delimiter">)</span>
    <span class="keyword">lazy</span> <span class="keyword">val</span> <a href="#436673" title="A" id="436669" class="delimiter">(</a>_, <a title="A" id="436673">r</a><span class="delimiter">)</span> = <a href="#436666" title="=&gt; (scalaz.effect.World[S], A)">ans</a>
    <a href="#436666" title="=&gt; (scalaz.effect.World[S], A)">ans</a>
  <span class="delimiter">}</span><span class="delimiter">)</span>

  <span class="comment">/**Accumulates an integer-associated list into an immutable array. */</span>
  <span class="keyword">def</span> <a title="[F[_], A, B](size: Int, f: (A, B) =&gt; A, z: A, ivs: F[(Int, B)])(implicit F: scalaz.Foldable[F], implicit mf: Manifest[A])scalaz.ImmutableArray[A]" id="52723">accumArray</a><span class="delimiter">[</span><a title="[_]&gt;: Nothing &lt;: Any" id="52727">F</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="436683">_</a><span class="delimiter">]</span>, <a title="&gt;: Nothing &lt;: Any" id="52728">A</a>, <a title="&gt;: Nothing &lt;: Any" id="52729">B</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="Int" id="436676">size</a>: <span title="Int">Int</span>, <a title="(A, B) =&gt; A" id="436677">f</a>: <span class="delimiter">(</span>A, B<span class="delimiter">)</span> =&gt; A, <a title="A" id="436678">z</a>: <a href="#52728" title="A">A</a>, <a title="F[(Int, B)]" id="436679">ivs</a>: <a href="#52727" title="F[(Int, B)]">F</a><span class="delimiter">[</span><span class="delimiter">(</span>Int, B<span class="delimiter">)</span><span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scalaz.Foldable[F]" id="436680">F</a>: <a href="../../../core/scalaz/Foldable.scala.html#20873" title="scalaz.Foldable[F]">Foldable</a><span class="delimiter">[</span>F<span class="delimiter">]</span>, <a title="Manifest[A]" id="436681">mf</a>: <span title="Manifest[A]">Manifest</span><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../../core/scalaz/ImmutableArray.scala.html#10571" title="scalaz.ImmutableArray[A]">ImmutableArray</a><span class="delimiter">[</span>A<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">import</span> std.<a href="../../../core/scalaz/std/AnyVal.scala.html#26657" title="object scalaz.std.anyVal">anyVal</a>.unitInstance
    <span class="keyword">type</span> <a title="[S]scalaz.effect.ST[S,scalaz.ImmutableArray[A]]" id="436691">STA</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="436692">S</a><span class="delimiter">]</span> = <a href="#32527" title="scalaz.effect.ST[S,scalaz.ImmutableArray[A]]">ST</a><span class="delimiter">[</span>S, ImmutableArray<span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span>
    <a href="#52707" title="(f: scalaz.Forall[[S]scalaz.effect.ST[S,scalaz.ImmutableArray[A]]])scalaz.ImmutableArray[A]">runST</a><span class="delimiter">(</span><a href="#436695" title="java.lang.Object with scalaz.Forall[STA]" class="keyword">new</a> <a title="anonymous class $anon extends java.lang.Object with scalaz.Forall[STA]" id="436695">Forall</a><span class="delimiter">[</span>STA<span class="delimiter">]</span> <span class="delimiter">{</span>
      <span class="keyword">def</span> <a title="[S]=&gt; scalaz.effect.ST[S,scalaz.ImmutableArray[A]]" id="436699">apply</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="436701">S</a><span class="delimiter">]</span> = <span class="keyword">for</span> <span class="delimiter">{</span>
        <a title="scalaz.effect.STArray[S,A]" id="436738">a</a> &lt;- <a href="#436627" title="(size: Int, z: A)(implicit evidence$1: Manifest[A])scalaz.effect.ST[S,scalaz.effect.STArray[S,A]]">newArr</a><a href="#428231" title="(g: scalaz.effect.STArray[S,A] =&gt; scalaz.effect.ST[S,scalaz.ImmutableArray[A]])scalaz.effect.ST[S,scalaz.ImmutableArray[A]]" class="delimiter">(</a><a href="#436676" title="Int">size</a>, <a href="#436678" title="A">z</a><span class="delimiter">)</span>
        <a title="Unit" id="436794">_</a> &lt;- <span class="delimiter">{</span>
          <a href="#436680" title="scalaz.Foldable[F]">F</a>.<a href="../../../core/scalaz/Foldable.scala.html#42682" title="(fa: F[(Int, B)])(f: ((Int, B)) =&gt; scalaz.effect.ST[S,Unit])(implicit F: scalaz.Monoid[scalaz.effect.ST[S,Unit]])scalaz.effect.ST[S,Unit]">foldMap</a><span class="delimiter">(</span><a href="#436679" title="F[(Int, B)]">ivs</a><span class="delimiter">)</span><span class="delimiter">(</span><span class="delimiter">(</span>x: <span title="(Int, B)" class="delimiter">(</span>Int, B<span class="delimiter">)</span><span class="delimiter">)</span> =&gt; <a href="#436738" title="scalaz.effect.STArray[S,A]">a</a>.<a href="#436213" title="(f: (A, B) =&gt; A, i: Int, v: B)scalaz.effect.ST[S,Unit]">update</a><span class="delimiter">(</span><a href="#436677" title="(A, B) =&gt; A">f</a>, <a href="#436753" title="(Int, B)">x</a>.<span title="=&gt; Int">_1</span>, <a href="#436753" title="(Int, B)">x</a>.<span title="=&gt; B">_2</span><span class="delimiter">)</span><span class="delimiter">)</span><a href="#428231" title="(g: Unit =&gt; scalaz.effect.ST[S,scalaz.ImmutableArray[A]])scalaz.effect.ST[S,scalaz.ImmutableArray[A]]" class="delimiter">(</a><a href="#52743" title="[S, A](implicit A: scalaz.Monoid[A])scalaz.Monoid[scalaz.effect.ST[S,A]]">stMonoid</a><a href="../../../core/scalaz/std/AnyVal.scala.html#54182" title="(implicit A: scalaz.Monoid[Unit])scalaz.Monoid[scalaz.effect.ST[S,Unit]]" class="delimiter">[</a><a href="#436701" title="S">S</a>, <span title="Unit">Unit</span><span class="delimiter">]</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>
        <a title="scalaz.ImmutableArray[A]" id="436799">frozen</a> &lt;- <a href="#436738" title="scalaz.effect.STArray[S,A]">a</a>.<a href="#428234" title="(g: scalaz.ImmutableArray[A] =&gt; scalaz.ImmutableArray[A])scalaz.effect.ST[S,scalaz.ImmutableArray[A]]">freeze</a>
      <span class="delimiter">}</span> <span class="keyword">yield</span> <a href="#436799" title="scalaz.ImmutableArray[A]">frozen</a>
    <span class="delimiter">}</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="keyword">trait</span> <a title="trait STInstance0 extends java.lang.Object with ScalaObject" id="31828">STInstance0</a> <span title="ScalaObject" class="delimiter">{</span>
  <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="[S, A](implicit A: scalaz.Semigroup[A])scalaz.Semigroup[scalaz.effect.ST[S,A]]" id="52737">stSemigroup</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="52740">S</a>, <a title="&gt;: Nothing &lt;: Any" id="52741">A</a><span class="delimiter">]</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scalaz.Semigroup[A]" id="428312">A</a>: <a href="../../../core/scalaz/Semigroup.scala.html#20426" title="scalaz.Semigroup[A]">Semigroup</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../../core/scalaz/Semigroup.scala.html#20426" title="scalaz.Semigroup[scalaz.effect.ST[S,A]]">Semigroup</a><span class="delimiter">[</span>ST<span class="delimiter">[</span>S, A<span class="delimiter">]</span><span class="delimiter">]</span> =
      <a href="../../../core/scalaz/Monoid.scala.html#19194" title="object scalaz.Monoid">Monoid</a>.<a href="../../../core/scalaz/Monoid.scala.html#57269" title="[F[_], M](implicit F0: scalaz.Applicative[F], implicit M0: scalaz.Semigroup[M])scalaz.Semigroup[F[M]]">liftSemigroup</a><span title="(implicit F0: scalaz.Applicative[[α]scalaz.effect.ST[S,α]], implicit M0: scalaz.Semigroup[A])scalaz.Semigroup[scalaz.effect.ST[S,A]]" class="delimiter">[</span><span class="delimiter">(</span><span class="delimiter">{</span><span class="keyword">type</span> λ<span class="delimiter">[</span>α<span class="delimiter">]</span> = ST<span class="delimiter">[</span>S, α<span class="delimiter">]</span><span class="delimiter">}</span><span class="delimiter">)</span>#<a href="#32527" title="[α]scalaz.effect.ST[S,α]">λ</a>, <a href="#52741" title="A">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a href="#32528" title="object scalaz.effect.ST">ST</a>.<a href="#52748" title="[S]=&gt; scalaz.Monad[[α]scalaz.effect.ST[S,α]]">stMonad</a><span title="scalaz.Monad[[α]scalaz.effect.ST[S,α]]" class="delimiter">[</span><a href="#52740" title="S">S</a><span class="delimiter">]</span>, <a href="#428312" title="scalaz.Semigroup[A]">A</a><span class="delimiter">)</span>
<span class="delimiter">}</span>

<span class="keyword">trait</span> <a title="trait STInstances extends java.lang.Object with scalaz.effect.STInstance0 with ScalaObject" id="32158">STInstances</a> <span title="ScalaObject" class="keyword">extends</span> <a href="#31828" title="scalaz.effect.STInstance0">STInstance0</a> <span class="delimiter">{</span>
  <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="[S, A](implicit A: scalaz.Monoid[A])scalaz.Monoid[scalaz.effect.ST[S,A]]" id="52743">stMonoid</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="52746">S</a>, <a title="&gt;: Nothing &lt;: Any" id="52747">A</a><span class="delimiter">]</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scalaz.Monoid[A]" id="428309">A</a>: <a href="../../../core/scalaz/Monoid.scala.html#19193" title="scalaz.Monoid[A]">Monoid</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../../core/scalaz/Monoid.scala.html#19193" title="scalaz.Monoid[scalaz.effect.ST[S,A]]">Monoid</a><span class="delimiter">[</span>ST<span class="delimiter">[</span>S, A<span class="delimiter">]</span><span class="delimiter">]</span> =
    <a href="../../../core/scalaz/Monoid.scala.html#19194" title="object scalaz.Monoid">Monoid</a>.<a href="../../../core/scalaz/Monoid.scala.html#57274" title="[F[_], M](implicit F0: scalaz.Applicative[F], implicit M0: scalaz.Monoid[M])scalaz.Monoid[F[M]]">liftMonoid</a><span title="(implicit F0: scalaz.Applicative[[α]scalaz.effect.ST[S,α]], implicit M0: scalaz.Monoid[A])scalaz.Monoid[scalaz.effect.ST[S,A]]" class="delimiter">[</span><span class="delimiter">(</span><span class="delimiter">{</span><span class="keyword">type</span> λ<span class="delimiter">[</span>α<span class="delimiter">]</span> = ST<span class="delimiter">[</span>S, α<span class="delimiter">]</span><span class="delimiter">}</span><span class="delimiter">)</span>#<a href="#32527" title="[α]scalaz.effect.ST[S,α]">λ</a>, <a href="#52747" title="A">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a href="#52748" title="[S]=&gt; scalaz.Monad[[α]scalaz.effect.ST[S,α]]">stMonad</a><span title="scalaz.Monad[[α]scalaz.effect.ST[S,α]]" class="delimiter">[</span><a href="#52746" title="S">S</a><span class="delimiter">]</span>, <a href="#428309" title="scalaz.Monoid[A]">A</a><span class="delimiter">)</span>

  <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="[S]=&gt; scalaz.Monad[[α]scalaz.effect.ST[S,α]]" id="52748">stMonad</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="52750">S</a><span class="delimiter">]</span>: <a href="../../../core/scalaz/Monad.scala.html#22208" title="scalaz.Monad[[α]scalaz.effect.ST[S,α]]">Monad</a><span class="delimiter">[</span><span class="delimiter">(</span><span class="delimiter">{</span><span class="keyword">type</span> λ<span class="delimiter">[</span>α<span class="delimiter">]</span> = ST<span class="delimiter">[</span>S, α<span class="delimiter">]</span><span class="delimiter">}</span><span class="delimiter">)</span>#λ<span class="delimiter">]</span> = <a href="#436842" title="java.lang.Object with scalaz.Monad[[α]scalaz.effect.ST[S,α]]" class="keyword">new</a> <a title="anonymous class $anon extends java.lang.Object with scalaz.Monad[[α]scalaz.effect.ST[S,α]]" id="436842">Monad</a><span class="delimiter">[</span><span class="delimiter">(</span><span class="delimiter">{</span><span class="keyword">type</span> λ<span class="delimiter">[</span>α<span class="delimiter">]</span> = ST<span class="delimiter">[</span>S, α<span class="delimiter">]</span><span class="delimiter">}</span><span class="delimiter">)</span>#λ<span class="delimiter">]</span> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="[A](a: =&gt; A)scalaz.effect.ST[S,A]" id="436900">point</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="436902">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="=&gt; A" id="436908">a</a>: =&gt; A<span class="delimiter">)</span>: <a href="#32527" title="scalaz.effect.ST[S,A]">ST</a><span class="delimiter">[</span>S, A<span class="delimiter">]</span> = <a href="#52702" title="(a: =&gt; A)scalaz.effect.ST[S,A]">returnST</a><span class="delimiter">(</span><a href="#436908" title="=&gt; A">a</a><span class="delimiter">)</span>
    <span class="keyword">def</span> <a title="[A, B](fa: scalaz.effect.ST[S,A])(f: A =&gt; scalaz.effect.ST[S,B])scalaz.effect.ST[S,B]" id="436903">bind</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="436906">A</a>, <a title="&gt;: Nothing &lt;: Any" id="436907">B</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="scalaz.effect.ST[S,A]" id="436914">fa</a>: <a href="#32527" title="scalaz.effect.ST[S,A]">ST</a><span class="delimiter">[</span>S, A<span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">(</span><a title="A =&gt; scalaz.effect.ST[S,B]" id="436915">f</a>: <span class="delimiter">(</span>A<span class="delimiter">)</span> =&gt; ST<span class="delimiter">[</span>S, B<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#32527" title="scalaz.effect.ST[S,B]">ST</a><span class="delimiter">[</span>S, B<span class="delimiter">]</span> = <a href="#436914" title="scalaz.effect.ST[S,A]">fa</a> <a href="#428231" title="(g: A =&gt; scalaz.effect.ST[S,B])scalaz.effect.ST[S,B]">flatMap</a> <a href="#436915" title="A =&gt; scalaz.effect.ST[S,B]">f</a>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>