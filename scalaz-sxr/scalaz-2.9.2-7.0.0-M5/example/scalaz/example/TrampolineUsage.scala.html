<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>example/scalaz/example/TrampolineUsage.scala</title>
        <script type="text/javascript" src="../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> scalaz.example

<span class="keyword">object</span> <a title="object scalaz.example.TrampolineUsage" id="33443">TrampolineUsage</a> <span title="ScalaObject" class="keyword">extends</span> <span title="App">App</span> <span class="delimiter">{</span>

  <span class="keyword">import</span> scalaz._, <a href="../../../core/scalaz/Scalaz.scala.html#20157" title="object scalaz.Scalaz">Scalaz</a>._, <a href="../../../core/scalaz/Free.scala.html#23049" title="object scalaz.Free">Free</a>._

  <span class="keyword">def</span> <a title="[F[+_], T](xs: List[T])(implicit evidence$1: scalaz.Pointed[F], implicit evidence$2: scalaz.Order[T])scalaz.Free[F,List[T]]" id="645786">quickSort</a><span class="delimiter">[</span><a title="[+_]&gt;: Nothing &lt;: Any" id="644451">F</a><span class="delimiter">[</span>+ <a title="&gt;: Nothing &lt;: Any" id="645787">_</a><span class="delimiter">]</span> : Pointed, <a title="&gt;: Nothing &lt;: Any" id="644452">T</a>: Order<span class="delimiter">]</span><span class="delimiter">(</span><a title="List[T]" id="645784">xs</a>: <span title="List[T]">List</span><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../../core/scalaz/Free.scala.html#23048" title="scalaz.Free[F,List[T]]">Free</a><span class="delimiter">[</span>F, List<span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">]</span> = <span class="delimiter">{</span>
    <a href="#645784" title="List[T]">xs</a> <span title="scalaz.Free[F,List[T]]" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <span title="scalaz.Free[F,scala.collection.immutable.Nil.type]">Nil</span> =&gt;
        <a href="../../../core/scalaz/Free.scala.html#52932" title="(value: =&gt; scala.collection.immutable.Nil.type)(implicit S: scalaz.Pointed[F])scalaz.Free[F,scala.collection.immutable.Nil.type]">return_</a> <a href="#645786" title="scalaz.Pointed[F]" class="delimiter">{</a>
          <span title="object Nil">Nil</span>
        <span class="delimiter">}</span>
      <span class="keyword">case</span> <a title="scalaz.Free[F,List[T]]" id="646272">x</a> :: <a title="List[T]" id="646273">tail</a> =&gt;
        <a href="../../../core/scalaz/Free.scala.html#52937" title="(value: =&gt; scalaz.Free[F,List[T]])(implicit S: scalaz.Pointed[F])scalaz.Free[F,List[T]]">suspend</a> <a href="#645786" title="scalaz.Pointed[F]" class="delimiter">{</a>
          <span class="keyword">val</span> <a href="#646283" title="(List[T], List[T])" class="delimiter">(</a><a href="#646282" title="List[T]" id="646283">left</a>, <a href="#646282" title="List[T]" id="646284">right</a><span class="delimiter">)</span> = <a href="#646273" title="List[T]">tail</a>.<span title="(p: T =&gt; Boolean)(List[T], List[T])">partition</span><span title="(List[T], List[T]) @unchecked" class="delimiter">(</span><a href="../../../core/scalaz/syntax/OrderSyntax.scala.html#53593" title="(v: T)(implicit F0: scalaz.Order[T])java.lang.Object with scalaz.syntax.OrderOps[T]">_</a> <a href="../../../core/scalaz/syntax/OrderSyntax.scala.html#192694" title="(other: T)Boolean">&lt;</a> <a href="#646272" title="T">x</a><span class="delimiter">)</span>
          <span class="keyword">for</span> <span class="delimiter">{</span>
            <a title="List[T]" id="648168">ls</a> &lt;- <a href="#645786" title="[F[+_], T](xs: List[T])(implicit evidence$1: scalaz.Pointed[F], implicit evidence$2: scalaz.Order[T])scalaz.Free[F,List[T]]">quickSort</a><span title="(xs: List[T])(implicit evidence$1: scalaz.Pointed[F], implicit evidence$2: scalaz.Order[T])scalaz.Free[F,List[T]]" class="delimiter">[</span><a href="#644451" title="F">F</a>, <a href="#644452" title="T">T</a><span class="delimiter">]</span><a href="../../../core/scalaz/Free.scala.html#117205" title="(f: List[T] =&gt; scalaz.Free[F,List[T]])scalaz.Free[F,List[T]]" class="delimiter">(</a><a href="#646283" title="List[T]">left</a><span class="delimiter">)</span>
            <a title="List[T]" id="648985">rs</a> &lt;- <a href="#645786" title="[F[+_], T](xs: List[T])(implicit evidence$1: scalaz.Pointed[F], implicit evidence$2: scalaz.Order[T])scalaz.Free[F,List[T]]">quickSort</a><span title="(xs: List[T])(implicit evidence$1: scalaz.Pointed[F], implicit evidence$2: scalaz.Order[T])scalaz.Free[F,List[T]]" class="delimiter">[</span><a href="#644451" title="F">F</a>, <a href="#644452" title="T">T</a><span class="delimiter">]</span><a href="../../../core/scalaz/Free.scala.html#117199" title="(f: List[T] =&gt; List[T])scalaz.Free[F,List[T]]" class="delimiter">(</a><a href="#646284" title="List[T]">right</a><span class="delimiter">)</span>
          <span class="delimiter">}</span> <span class="keyword">yield</span> <a href="#648168" title="List[T]">ls</a> <a href="#648986" title="(prefix: List[T])List[T]">:::</a> <span class="delimiter">(</span><a href="#646272" title="T">x</a> <a href="#648987" title="(x: T)List[T]">::</a> <a href="#648985" title="List[T]">rs</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="[F[+_], T](xs: List[T])(implicit evidence$3: scalaz.Pointed[F], implicit evidence$4: scalaz.Copointed[F], implicit evidence$5: scalaz.Order[T])List[T]" id="649450">runQuickSort</a><span class="delimiter">[</span><a title="[+_]&gt;: Nothing &lt;: Any" id="644456">F</a><span class="delimiter">[</span>+ <a title="&gt;: Nothing &lt;: Any" id="649452">_</a><span class="delimiter">]</span> : Pointed : Copointed, <a title="&gt;: Nothing &lt;: Any" id="644457">T</a>: Order<span class="delimiter">]</span><span class="delimiter">(</span><a title="List[T]" id="649447">xs</a>: <span title="List[T]">List</span><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="List[T]">List</span><span class="delimiter">[</span>T<span class="delimiter">]</span> =
    <a href="#645786" title="[F[+_], T](xs: List[T])(implicit evidence$1: scalaz.Pointed[F], implicit evidence$2: scalaz.Order[T])scalaz.Free[F,List[T]]">quickSort</a><span title="(xs: List[T])(implicit evidence$1: scalaz.Pointed[F], implicit evidence$2: scalaz.Order[T])scalaz.Free[F,List[T]]" class="delimiter">[</span><a href="#644456" title="F">F</a>, <a href="#644457" title="T">T</a><span class="delimiter">]</span><a href="#649450" title="scalaz.Pointed[F]" class="delimiter">(</a><a href="#649447" title="List[T]">xs</a><span class="delimiter">)</span>.<a href="../../../core/scalaz/Free.scala.html#117228" title="(f: F[scalaz.Free[F,List[T]]] =&gt; scalaz.Free[F,List[T]])List[T]">go</a><span class="delimiter">(</span><a title="F[scalaz.Free[F,List[T]]]" id="650277">f</a> =&gt; <a href="../../../core/scalaz/Copointed.scala.html#151118" title="[F[_]](implicit F: scalaz.Copointed[F])scalaz.Copointed[F]">Copointed</a><a href="#649450" title="(implicit F: scalaz.Copointed[F])scalaz.Copointed[F]" class="delimiter">[</a><a href="#644456" title="F">F</a><span class="delimiter">]</span>.<a href="../../../core/scalaz/Copointed.scala.html#43555" title="(p: F[scalaz.Free[F,List[T]]])scalaz.Free[F,List[T]]">copoint</a><span class="delimiter">(</span><a href="#650277" title="F[scalaz.Free[F,List[T]]]">f</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">val</span> <a title="List[Int]" id="644458">xs</a> = <span title="object List">List</span>.<span title="(n: Int)(elem: =&gt; Int)List[Int]">fill</span><span class="delimiter">(</span><span title="Int(32)" class="int">32</span><span class="delimiter">)</span><span class="delimiter">(</span>util.<span title="object scala.util.Random">Random</span>.<span title="()Int">nextInt</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="delimiter">{</span>
    <span class="comment">// Trampoline is Free[Function0, A].</span>

    <span class="comment">// use the heap</span>
    <span class="keyword">val</span> <a title="List[Int]" id="650642">sorted</a> = <a href="#649450" title="[F[+_], T](xs: List[T])(implicit evidence$3: scalaz.Pointed[F], implicit evidence$4: scalaz.Copointed[F], implicit evidence$5: scalaz.Order[T])List[T]">runQuickSort</a><span title="(xs: List[Int])(implicit evidence$3: scalaz.Pointed[Function0], implicit evidence$4: scalaz.Copointed[Function0], implicit evidence$5: scalaz.Order[Int])List[Int]" class="delimiter">[</span><span title="Function0">Function0</span>, <span title="Int">Int</span><span class="delimiter">]</span><a href="../../../core/scalaz/std/Function.scala.html#53007" title="function0Instance extends java.lang.Object with scalaz.Traverse[Function0] with scalaz.Monad[Function0] with scalaz.Copointed[Function0]" class="delimiter">(</a><a href="#644458" title="=&gt; List[Int]">xs</a><span class="delimiter">)</span>
    <span title="(x: Any)Unit">println</span><span class="delimiter">(</span><a href="#650642" title="List[Int]">sorted</a><span class="delimiter">)</span>

    <span class="keyword">val</span> <a href="#650644" title="(Int, List[Int])" class="delimiter">(</a><a href="#650643" title="Int" id="650644">steps</a>, <a href="#650643" title="List[Int]" id="650645">sorted1</a><span class="delimiter">)</span> = <a href="#645786" title="[F[+_], T](xs: List[T])(implicit evidence$1: scalaz.Pointed[F], implicit evidence$2: scalaz.Order[T])scalaz.Free[F,List[T]]">quickSort</a><span title="(xs: List[Int])(implicit evidence$1: scalaz.Pointed[Function0], implicit evidence$2: scalaz.Order[Int])scalaz.Free[Function0,List[Int]]" class="delimiter">[</span><span title="Function0">Function0</span>, <span title="Int">Int</span><span class="delimiter">]</span><a href="../../../core/scalaz/std/Function.scala.html#53007" title="function0Instance extends java.lang.Object with scalaz.Traverse[Function0] with scalaz.Monad[Function0] with scalaz.Copointed[Function0]" class="delimiter">(</a><a href="#644458" title="=&gt; List[Int]">xs</a><span class="delimiter">)</span>.<a href="../../../core/scalaz/Free.scala.html#117231" title="(b: Int)(f: (Int, () =&gt; scalaz.Free[Function0,List[Int]]) =&gt; (Int, scalaz.Free[Function0,List[Int]]))(Int, List[Int])">foldRun</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span><span title="(Int, List[Int]) @unchecked" class="delimiter">(</span><span class="delimiter">(</span><a title="Int" id="652646">i</a>, <a title="() =&gt; scalaz.Free[Function0,List[Int]]" id="652647">f</a><span class="delimiter">)</span> =&gt; <span title="(_1: Int, _2: scalaz.Free[Function0,List[Int]])(Int, scalaz.Free[Function0,List[Int]])" class="delimiter">(</span><a href="#652646" title="Int">i</a> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span>, <a href="#652647" title="()scalaz.Free[Function0,List[Int]]">f</a><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <span title="(x: Any)Unit">println</span><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;sort using heap took %d steps&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#650644" title="Int">steps</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="delimiter">{</span>
    <span class="comment">// Use the stack.</span>
    <span class="keyword">val</span> <a title="List[Int]" id="658216">sorted</a> = <a href="#649450" title="[F[+_], T](xs: List[T])(implicit evidence$3: scalaz.Pointed[F], implicit evidence$4: scalaz.Copointed[F], implicit evidence$5: scalaz.Order[T])List[T]">runQuickSort</a><span title="(xs: List[Int])(implicit evidence$3: scalaz.Pointed[scalaz.Scalaz.Id], implicit evidence$4: scalaz.Copointed[scalaz.Scalaz.Id], implicit evidence$5: scalaz.Order[Int])List[Int]" class="delimiter">[</span><a href="../../../core/scalaz/Id.scala.html#42459" title="scalaz.Scalaz.Id">Id</a>, <span title="Int">Int</span><span class="delimiter">]</span><a href="../../../core/scalaz/package.scala.html#38787" title="=&gt; scalaz.Traverse[scalaz.Id.Id] with scalaz.Each[scalaz.Id.Id] with scalaz.Monad[scalaz.Id.Id] with scalaz.Comonad[scalaz.Id.Id] with scalaz.Cojoin[scalaz.Id.Id] with scalaz.Distributive[scalaz.Id.Id] with scalaz.Zip[scalaz.Id.Id] with scalaz.Unzip[scalaz.Id.Id] with scalaz.Cozip[scalaz.Id.Id]" class="delimiter">(</a><a href="#644458" title="=&gt; List[Int]">xs</a><span class="delimiter">)</span>
    <span title="(x: Any)Unit">println</span><span class="delimiter">(</span><a href="#658216" title="List[Int]">sorted</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">import</span> scalaz.concurrent._
  <span class="keyword">import</span> annotation.unchecked.uncheckedVariance
  <span class="keyword">type</span> <a title="[+A]scalaz.concurrent.Promise[A @scala.annotation.unchecked.uncheckedVariance]" id="644462">PromiseCov</a><span class="delimiter">[</span>+<a title="&gt;: Nothing &lt;: Any" id="644463">A</a><span class="delimiter">]</span> = <a href="../../../concurrent/scalaz/concurrent/Promise.scala.html#24259" title="scalaz.concurrent.Promise[A @scala.annotation.unchecked.uncheckedVariance]">Promise</a><span class="delimiter">[</span>A @uncheckedVariance<span class="delimiter">]</span>

  <span class="delimiter">{</span>
    <span class="comment">// Run in parallel.</span>
    <span class="keyword">val</span> <a title="List[Int]" id="659405">sorted</a> = <a href="#649450" title="[F[+_], T](xs: List[T])(implicit evidence$3: scalaz.Pointed[F], implicit evidence$4: scalaz.Copointed[F], implicit evidence$5: scalaz.Order[T])List[T]">runQuickSort</a><span title="(xs: List[Int])(implicit evidence$3: scalaz.Pointed[scalaz.example.TrampolineUsage.PromiseCov], implicit evidence$4: scalaz.Copointed[scalaz.example.TrampolineUsage.PromiseCov], implicit evidence$5: scalaz.Order[Int])List[Int]" class="delimiter">[</span><a href="../../../concurrent/scalaz/concurrent/Promise.scala.html#24259" title="scalaz.example.TrampolineUsage.PromiseCov">PromiseCov</a>, <span title="Int">Int</span><span class="delimiter">]</span><a href="../../../concurrent/scalaz/concurrent/Promise.scala.html#56458" title="implicit scalaz.concurrent.PromiseInstances.promiseInstance : (implicit s: scalaz.concurrent.Strategy)java.lang.Object with scalaz.Traverse[scalaz.concurrent.Promise] with scalaz.Monad[scalaz.concurrent.Promise] with scalaz.Comonad[scalaz.concurrent.Promise]" class="delimiter">(</a><a href="#644458" title="=&gt; List[Int]">xs</a><span class="delimiter">)</span>
    <span title="(x: Any)Unit">println</span><span class="delimiter">(</span><a href="#659405" title="List[Int]">sorted</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>


  <span class="comment">/**Run using `F1` as a binding for lists longer than `threshold`, and `F2` otherwise. */</span>
  <span class="keyword">def</span> <a title="[F[+_], F2[+_], T](xs: List[T], nat: scalaz.package.~&gt;[F2,F], threshold: Int)(implicit evidence$6: scalaz.Pointed[F], implicit evidence$7: scalaz.Pointed[F2], implicit evidence$8: scalaz.Order[T])scalaz.Free[F,List[T]]" id="661310">quickSort2</a><span class="delimiter">[</span><a title="[+_]&gt;: Nothing &lt;: Any" id="644468">F</a><span class="delimiter">[</span>+ <a title="&gt;: Nothing &lt;: Any" id="661311">_</a><span class="delimiter">]</span> : Pointed, <a title="[+_]&gt;: Nothing &lt;: Any" id="644469">F2</a><span class="delimiter">[</span>+ <a title="&gt;: Nothing &lt;: Any" id="661313">_</a><span class="delimiter">]</span> : Pointed, <a title="&gt;: Nothing &lt;: Any" id="644470">T</a>: Order<span class="delimiter">]</span><span class="delimiter">(</span><a title="List[T]" id="661305">xs</a>: <span title="List[T]">List</span><span class="delimiter">[</span>T<span class="delimiter">]</span>, <a title="scalaz.package.~&gt;[F2,F]" id="661306">nat</a>: F2 <a href="../../../core/scalaz/NaturalTransformation.scala.html#16934" title="scalaz.package.~&gt;[F2,F]">~&gt;</a> F, <a title="Int" id="661307">threshold</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <a href="../../../core/scalaz/Free.scala.html#23048" title="scalaz.Free[F,List[T]]">Free</a><span class="delimiter">[</span>F, List<span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="(as: List[T])scalaz.Free[F,List[T]]" id="661320">qs</a><span class="delimiter">(</span><a title="List[T]" id="661321">as</a>: <span title="List[T]">List</span><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../../core/scalaz/Free.scala.html#23048" title="scalaz.Free[F,List[T]]">Free</a><span class="delimiter">[</span>F, List<span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">]</span> =
      <span title="scalaz.Free[F,List[T]]" class="keyword">if</span> <span class="delimiter">(</span><a href="#661321" title="List[T]">as</a>.<span title="(len: Int)Int">lengthCompare</span><span class="delimiter">(</span><a href="#661307" title="Int">threshold</a><span class="delimiter">)</span> <span title="(x: Int)Boolean">&lt;</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="scalaz.Free[F2,List[T]]" id="661326">free</a>: <a href="../../../core/scalaz/Free.scala.html#23048" title="scalaz.Free[F2,List[T]]">Free</a><span class="delimiter">[</span>F2, List<span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">]</span> = <a href="#661310" title="[F[+_], F2[+_], T](xs: List[T], nat: scalaz.package.~&gt;[F2,F], threshold: Int)(implicit evidence$6: scalaz.Pointed[F], implicit evidence$7: scalaz.Pointed[F2], implicit evidence$8: scalaz.Order[T])scalaz.Free[F,List[T]]">quickSort2</a><span title="(xs: List[T], nat: scalaz.package.~&gt;[F2,F2], threshold: Int)(implicit evidence$6: scalaz.Pointed[F2], implicit evidence$7: scalaz.Pointed[F2], implicit evidence$8: scalaz.Order[T])scalaz.Free[F2,List[T]]" class="delimiter">[</span><a href="#644469" title="F2">F2</a>, <a href="#644469" title="F2">F2</a>, <a href="#644470" title="T">T</a><span class="delimiter">]</span><a href="#661310" title="scalaz.Pointed[F2]" class="delimiter">(</a><a href="#661321" title="List[T]">as</a>, <a href="../../../core/scalaz/NaturalTransformation.scala.html#16935" title="object scalaz.NaturalTransformation">NaturalTransformation</a>.<a href="../../../core/scalaz/NaturalTransformation.scala.html#324695" title="[F[_]]=&gt; java.lang.Object with scalaz.package.~&gt;[F,F]">refl</a><span title="refl extends java.lang.Object with scalaz.package.~&gt;[F2,F2]" class="delimiter">[</span><a href="#644469" title="F2">F2</a><span class="delimiter">]</span>, <a href="#661307" title="Int">threshold</a><span class="delimiter">)</span>
        <a href="#661326" title="scalaz.Free[F2,List[T]]">free</a>.<a href="../../../core/scalaz/Free.scala.html#117209" title="(f: scalaz.package.~&gt;[F2,F])(implicit evidence$4: scalaz.Functor[F])scalaz.Free[F,List[T]]">mapSuspension</a><a href="#661310" title="scalaz.Pointed[F]" class="delimiter">(</a><a href="#661306" title="scalaz.package.~&gt;[F2,F]">nat</a><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">else</span> <a href="#661310" title="[F[+_], F2[+_], T](xs: List[T], nat: scalaz.package.~&gt;[F2,F], threshold: Int)(implicit evidence$6: scalaz.Pointed[F], implicit evidence$7: scalaz.Pointed[F2], implicit evidence$8: scalaz.Order[T])scalaz.Free[F,List[T]]">quickSort2</a><span title="(xs: List[T], nat: scalaz.package.~&gt;[F2,F], threshold: Int)(implicit evidence$6: scalaz.Pointed[F], implicit evidence$7: scalaz.Pointed[F2], implicit evidence$8: scalaz.Order[T])scalaz.Free[F,List[T]]" class="delimiter">[</span><a href="#644468" title="F">F</a>, <a href="#644469" title="F2">F2</a>, <a href="#644470" title="T">T</a><span class="delimiter">]</span><a href="#661310" title="scalaz.Pointed[F]" class="delimiter">(</a><a href="#661321" title="List[T]">as</a>, <a href="#661306" title="scalaz.package.~&gt;[F2,F]">nat</a>, <a href="#661307" title="Int">threshold</a><span class="delimiter">)</span>

    <a href="#661305" title="List[T]">xs</a> <span title="scalaz.Free[F,List[T]]" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <span title="scalaz.Free[F,scala.collection.immutable.Nil.type]">Nil</span> =&gt;
        <a href="../../../core/scalaz/Free.scala.html#52932" title="(value: =&gt; scala.collection.immutable.Nil.type)(implicit S: scalaz.Pointed[F])scalaz.Free[F,scala.collection.immutable.Nil.type]">return_</a> <a href="#661310" title="scalaz.Pointed[F]" class="delimiter">{</a>
          <span title="object Nil">Nil</span>
        <span class="delimiter">}</span>
      <span class="keyword">case</span> <a title="scalaz.Free[F,List[T]]" id="664786">x</a> :: <a title="List[T]" id="664787">tail</a> =&gt;
        <a href="../../../core/scalaz/Free.scala.html#52937" title="(value: =&gt; scalaz.Free[F,List[T]])(implicit S: scalaz.Pointed[F])scalaz.Free[F,List[T]]">suspend</a> <a href="#661310" title="scalaz.Pointed[F]" class="delimiter">{</a>
          <span class="keyword">val</span> <a href="#664797" title="(List[T], List[T])" class="delimiter">(</a><a href="#664796" title="List[T]" id="664797">left</a>, <a href="#664796" title="List[T]" id="664798">right</a><span class="delimiter">)</span> = <a href="#664787" title="List[T]">tail</a>.<span title="(p: T =&gt; Boolean)(List[T], List[T])">partition</span><span title="(List[T], List[T]) @unchecked" class="delimiter">(</span><a href="../../../core/scalaz/syntax/OrderSyntax.scala.html#53593" title="(v: T)(implicit F0: scalaz.Order[T])java.lang.Object with scalaz.syntax.OrderOps[T]">_</a> <a href="../../../core/scalaz/syntax/OrderSyntax.scala.html#192694" title="(other: T)Boolean">&lt;</a> <a href="#664786" title="T">x</a><span class="delimiter">)</span>
          <span class="keyword">for</span> <span class="delimiter">{</span>
            <a title="List[T]" id="665870">ls</a> &lt;- <a href="#661320" title="(as: List[T])scalaz.Free[F,List[T]]">qs</a><a href="../../../core/scalaz/Free.scala.html#117205" title="(f: List[T] =&gt; scalaz.Free[F,List[T]])scalaz.Free[F,List[T]]" class="delimiter">(</a><a href="#664797" title="List[T]">left</a><span class="delimiter">)</span>
            <a title="List[T]" id="665875">rs</a> &lt;- <a href="#661320" title="(as: List[T])scalaz.Free[F,List[T]]">qs</a><a href="../../../core/scalaz/Free.scala.html#117199" title="(f: List[T] =&gt; List[T])scalaz.Free[F,List[T]]" class="delimiter">(</a><a href="#664798" title="List[T]">right</a><span class="delimiter">)</span>
          <span class="delimiter">}</span> <span class="keyword">yield</span> <a href="#665870" title="List[T]">ls</a> <a href="#665876" title="(prefix: List[T])List[T]">:::</a> <span class="delimiter">(</span><a href="#664786" title="T">x</a> <a href="#665877" title="(x: T)List[T]">::</a> <a href="#665875" title="List[T]">rs</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="[F[+_], F2[+_], T](xs: List[T], nat: scalaz.package.~&gt;[F2,F], threshold: Int)(implicit evidence$9: scalaz.Pointed[F], implicit evidence$10: scalaz.Copointed[F], implicit evidence$11: scalaz.Pointed[F2], implicit evidence$12: scalaz.Order[T])List[T]" id="666344">runQuickSort2</a><span class="delimiter">[</span><a title="[+_]&gt;: Nothing &lt;: Any" id="644475">F</a><span class="delimiter">[</span>+ <a title="&gt;: Nothing &lt;: Any" id="666347">_</a><span class="delimiter">]</span> : Pointed : Copointed, <a title="[+_]&gt;: Nothing &lt;: Any" id="644476">F2</a><span class="delimiter">[</span>+ <a title="&gt;: Nothing &lt;: Any" id="666346">_</a><span class="delimiter">]</span> : Pointed, <a title="&gt;: Nothing &lt;: Any" id="644477">T</a>: Order<span class="delimiter">]</span><span class="delimiter">(</span><a title="List[T]" id="666338">xs</a>: <span title="List[T]">List</span><span class="delimiter">[</span>T<span class="delimiter">]</span>, <a title="scalaz.package.~&gt;[F2,F]" id="666339">nat</a>: F2 <a href="../../../core/scalaz/NaturalTransformation.scala.html#16934" title="scalaz.package.~&gt;[F2,F]">~&gt;</a> F, <a title="Int" id="666340">threshold</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="List[T]">List</span><span class="delimiter">[</span>T<span class="delimiter">]</span> =
    <a href="#661310" title="[F[+_], F2[+_], T](xs: List[T], nat: scalaz.package.~&gt;[F2,F], threshold: Int)(implicit evidence$6: scalaz.Pointed[F], implicit evidence$7: scalaz.Pointed[F2], implicit evidence$8: scalaz.Order[T])scalaz.Free[F,List[T]]">quickSort2</a><span title="(xs: List[T], nat: scalaz.package.~&gt;[F2,F], threshold: Int)(implicit evidence$6: scalaz.Pointed[F], implicit evidence$7: scalaz.Pointed[F2], implicit evidence$8: scalaz.Order[T])scalaz.Free[F,List[T]]" class="delimiter">[</span><a href="#644475" title="F">F</a>, <a href="#644476" title="F2">F2</a>, <a href="#644477" title="T">T</a><span class="delimiter">]</span><a href="#666344" title="scalaz.Pointed[F]" class="delimiter">(</a><a href="#666338" title="List[T]">xs</a>, <a href="#666339" title="scalaz.package.~&gt;[F2,F]">nat</a>, <a href="#666340" title="Int">threshold</a><span class="delimiter">)</span>.<a href="../../../core/scalaz/Free.scala.html#117228" title="(f: F[scalaz.Free[F,List[T]]] =&gt; scalaz.Free[F,List[T]])List[T]">go</a><span class="delimiter">(</span><a title="F[scalaz.Free[F,List[T]]]" id="667618">f</a> =&gt; <a href="../../../core/scalaz/Copointed.scala.html#151118" title="[F[_]](implicit F: scalaz.Copointed[F])scalaz.Copointed[F]">Copointed</a><a href="#666344" title="(implicit F: scalaz.Copointed[F])scalaz.Copointed[F]" class="delimiter">[</a><a href="#644475" title="F">F</a><span class="delimiter">]</span>.<a href="../../../core/scalaz/Copointed.scala.html#43555" title="(p: F[scalaz.Free[F,List[T]]])scalaz.Free[F,List[T]]">copoint</a><span class="delimiter">(</span><a href="#667618" title="F[scalaz.Free[F,List[T]]]">f</a><span class="delimiter">)</span><span class="delimiter">)</span>


  <span class="delimiter">{</span>
    <span class="comment">// mixed binding</span>
    <span class="keyword">val</span> <a title="promise2Id extends java.lang.Object with scalaz.package.~&gt;[scalaz.Scalaz.Id,scalaz.example.TrampolineUsage.PromiseCov]" id="667983">promise2Id</a> = <a href="#667985" title="java.lang.Object with scalaz.package.~&gt;[scalaz.Scalaz.Id,scalaz.example.TrampolineUsage.PromiseCov]" class="keyword">new</a> <a title="anonymous class $anon extends java.lang.Object with scalaz.package.~&gt;[scalaz.Scalaz.Id,scalaz.example.TrampolineUsage.PromiseCov]" id="667985" class="delimiter">(</a>Id <a href="../../../core/scalaz/NaturalTransformation.scala.html#16934" title="scalaz.package.~&gt;[scalaz.Scalaz.Id,scalaz.example.TrampolineUsage.PromiseCov]">~&gt;</a> PromiseCov<span class="delimiter">)</span> <span class="delimiter">{</span> <span class="keyword">def</span> <a title="[A](a: A)scalaz.concurrent.Promise[A]" id="667987">apply</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="667989">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="A" id="667990">a</a>: <a href="#667989" title="A">A</a><span class="delimiter">)</span> = <a href="../../../concurrent/scalaz/concurrent/Promise.scala.html#56437" title="(a: =&gt; A)(implicit s: scalaz.concurrent.Strategy)scalaz.concurrent.Promise[A]">Promise</a><a href="../../../concurrent/scalaz/concurrent/Strategy.scala.html#58066" title="=&gt; scalaz.concurrent.Strategy" class="delimiter">(</a><a href="#667990" title="A">a</a><span class="delimiter">)</span><span class="delimiter">}</span>

    <span class="comment">// run in parallel for lists larger then 8 elements, and on the stack for lists smaller.</span>
    <span class="keyword">val</span> <a title="List[Int]" id="667984">sorted</a> = <a href="#666344" title="[F[+_], F2[+_], T](xs: List[T], nat: scalaz.package.~&gt;[F2,F], threshold: Int)(implicit evidence$9: scalaz.Pointed[F], implicit evidence$10: scalaz.Copointed[F], implicit evidence$11: scalaz.Pointed[F2], implicit evidence$12: scalaz.Order[T])List[T]">runQuickSort2</a><span title="(xs: List[Int], nat: scalaz.package.~&gt;[scalaz.Scalaz.Id,scalaz.example.TrampolineUsage.PromiseCov], threshold: Int)(implicit evidence$9: scalaz.Pointed[scalaz.example.TrampolineUsage.PromiseCov], implicit evidence$10: scalaz.Copointed[scalaz.example.TrampolineUsage.PromiseCov], implicit evidence$11: scalaz.Pointed[scalaz.Scalaz.Id], implicit evidence$12: scalaz.Order[Int])List[Int]" class="delimiter">[</span><a href="../../../concurrent/scalaz/concurrent/Promise.scala.html#24259" title="scalaz.example.TrampolineUsage.PromiseCov">PromiseCov</a>, <a href="../../../core/scalaz/Id.scala.html#42459" title="scalaz.Scalaz.Id">Id</a>, <span title="Int">Int</span><span class="delimiter">]</span><a href="../../../concurrent/scalaz/concurrent/Promise.scala.html#56458" title="implicit scalaz.concurrent.PromiseInstances.promiseInstance : (implicit s: scalaz.concurrent.Strategy)java.lang.Object with scalaz.Traverse[scalaz.concurrent.Promise] with scalaz.Monad[scalaz.concurrent.Promise] with scalaz.Comonad[scalaz.concurrent.Promise]" class="delimiter">(</a><a href="#644458" title="=&gt; List[Int]">xs</a>, <a href="#667983" title="promise2Id extends java.lang.Object with scalaz.package.~&gt;[scalaz.Scalaz.Id,scalaz.example.TrampolineUsage.PromiseCov]">promise2Id</a>, <span title="Int(8)" class="int">8</span><span class="delimiter">)</span>
    <span title="(x: Any)Unit">println</span><span class="delimiter">(</span><a href="#667984" title="List[Int]">sorted</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">// Ackermann function. Blows the stack for very small inputs.</span>
  <span class="keyword">def</span> <a title="(m: Int, n: Int)Int" id="644478">ack</a><span class="delimiter">(</span><a title="Int" id="670723">m</a>: <span title="Int">Int</span>, <a title="Int" id="670724">n</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="Int">Int</span> =
    <span title="Int" class="keyword">if</span> <span class="delimiter">(</span><a href="#670723" title="Int">m</a> <span title="(x: Int)Boolean">&lt;=</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
      <a href="#670724" title="Int">n</a> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span>
    <span class="keyword">else</span> <span title="Int" class="keyword">if</span> <span class="delimiter">(</span><a href="#670724" title="Int">n</a> <span title="(x: Int)Boolean">&lt;=</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
      <a href="#644478" title="(m: Int, n: Int)Int">ack</a><span class="delimiter">(</span><a href="#670723" title="Int">m</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span>, <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
    <span class="keyword">else</span> <a href="#644478" title="(m: Int, n: Int)Int">ack</a><span class="delimiter">(</span><a href="#670723" title="Int">m</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span>, <a href="#644478" title="(m: Int, n: Int)Int">ack</a><span class="delimiter">(</span><a href="#670723" title="Int">m</a>, <a href="#670724" title="Int">n</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="comment">// Trampolined ackermann function. Never blows the stack, even for large inputs.</span>
  <span class="keyword">def</span> <a title="(m: Int, n: Int)scalaz.Free.Trampoline[Int]" id="644479">ackermann</a><span class="delimiter">(</span><a title="Int" id="686766">m</a>: <span title="Int">Int</span>, <a title="Int" id="686767">n</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <a href="../../../core/scalaz/Free.scala.html#23048" title="scalaz.Free.Trampoline[Int]">Trampoline</a><span class="delimiter">[</span>Int<span class="delimiter">]</span> =
    <span title="scalaz.Free.Trampoline[Int]" class="keyword">if</span> <span class="delimiter">(</span><a href="#686766" title="Int">m</a> <span title="(x: Int)Boolean">&lt;=</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
      <a href="../../../core/scalaz/Free.scala.html#52932" title="(value: =&gt; Int)(implicit S: scalaz.Pointed[Function0])scalaz.Free[Function0,Int]">return_</a><a href="../../../core/scalaz/std/Function.scala.html#53007" title="function0Instance extends java.lang.Object with scalaz.Traverse[Function0] with scalaz.Monad[Function0] with scalaz.Copointed[Function0]" class="delimiter">(</a><a href="#686767" title="Int">n</a> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
    <span class="keyword">else</span> <span title="scalaz.Free.Trampoline[Int]" class="keyword">if</span> <span class="delimiter">(</span><a href="#686767" title="Int">n</a> <span title="(x: Int)Boolean">&lt;=</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
      <a href="../../../core/scalaz/Free.scala.html#52937" title="(value: =&gt; scalaz.Free[Function0,Int])(implicit S: scalaz.Pointed[Function0])scalaz.Free[Function0,Int]">suspend</a><a href="../../../core/scalaz/std/Function.scala.html#53007" title="function0Instance extends java.lang.Object with scalaz.Traverse[Function0] with scalaz.Monad[Function0] with scalaz.Copointed[Function0]" class="delimiter">(</a><a href="#644479" title="(m: Int, n: Int)scalaz.Free.Trampoline[Int]">ackermann</a><span class="delimiter">(</span><a href="#686766" title="Int">m</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span>, <span title="Int(1)" class="int">1</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="keyword">else</span> <span class="keyword">for</span> <span class="delimiter">{</span>
      <a title="Int" id="700466">a</a> &lt;- <a href="../../../core/scalaz/Free.scala.html#52937" title="(value: =&gt; scalaz.Free[Function0,Int])(implicit S: scalaz.Pointed[Function0])scalaz.Free[Function0,Int]">suspend</a><a href="../../../core/scalaz/Free.scala.html#117205" title="(f: Int =&gt; scalaz.Free[Function0,Int])scalaz.Free[Function0,Int]" class="delimiter">(</a><a href="#644479" title="(m: Int, n: Int)scalaz.Free.Trampoline[Int]">ackermann</a><span class="delimiter">(</span><a href="#686766" title="Int">m</a>, <a href="#686767" title="Int">n</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <a title="Int" id="704620">b</a> &lt;- <a href="../../../core/scalaz/Free.scala.html#52937" title="(value: =&gt; scalaz.Free[Function0,Int])(implicit S: scalaz.Pointed[Function0])scalaz.Free[Function0,Int]">suspend</a><a href="../../../core/scalaz/Free.scala.html#117199" title="(f: Int =&gt; Int)scalaz.Free[Function0,Int]" class="delimiter">(</a><a href="#644479" title="(m: Int, n: Int)scalaz.Free.Trampoline[Int]">ackermann</a><span class="delimiter">(</span><a href="#686766" title="Int">m</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span>, <a href="#700466" title="Int">a</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span> <span class="keyword">yield</span> <a href="#704620" title="Int">b</a>


<span class="delimiter">}</span>

        </pre>
    </body>
</html>