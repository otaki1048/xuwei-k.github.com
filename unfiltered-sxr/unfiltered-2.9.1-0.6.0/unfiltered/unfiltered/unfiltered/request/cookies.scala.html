<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>unfiltered/unfiltered/unfiltered/request/cookies.scala</title>
        <script type="text/javascript" src="../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> unfiltered.request

<span class="keyword">import</span> unfiltered.Cookie

<span class="comment">/** An implementation of a function used to map cookie names to their value as an Option. If there
 *  is no associated Cookie value. None will always be returned. */</span>
<span class="keyword">private</span> <span class="delimiter">[</span>request<span class="delimiter">]</span> <span class="keyword">object</span> <a title="object unfiltered.request.CookieValueParser" id="10297">CookieValueParser</a> <span title="ScalaObject" class="keyword">extends</span> <span class="delimiter">(</span>Iterator<span class="delimiter">[</span>String<span class="delimiter">]</span> =&gt; Map<span class="delimiter">[</span>String, Option<span class="delimiter">[</span>Cookie<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="(values: Iterator[String])scala.collection.immutable.Map[String,Option[unfiltered.Cookie]]" id="77796">apply</a><span class="delimiter">(</span><a title="Iterator[String]" id="77798">values</a>: <span title="Iterator[String]">Iterator</span><span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="List[String]" id="77802">vs</a> = <a href="#77798" title="Iterator[String]">values</a>.<span title="=&gt; List[String]">toList</span>
    <span class="delimiter">(</span><span class="delimiter">(</span><span title="=&gt; scala.collection.immutable.Map.type">Map</span>.<span title="[A, B]=&gt; scala.collection.immutable.Map[A,B]">empty</span><span title="scala.collection.immutable.Map[String,Option[unfiltered.Cookie]]" class="delimiter">[</span><span title="String">String</span>, <span title="Option[unfiltered.Cookie]">Option</span><span class="delimiter">[</span>Cookie<span class="delimiter">]</span><span class="delimiter">]</span> <a href="#77803" title="(z: scala.collection.immutable.Map[String,Option[unfiltered.Cookie]])(op: (scala.collection.immutable.Map[String,Option[unfiltered.Cookie]], unfiltered.Cookie) =&gt; scala.collection.immutable.Map[String,Option[unfiltered.Cookie]])scala.collection.immutable.Map[String,Option[unfiltered.Cookie]]">/:</a> <a href="#77802" title="List[String]">vs</a>.<span title="(f: String =&gt; scala.collection.GenTraversableOnce[unfiltered.Cookie])(implicit bf: scala.collection.generic.CanBuildFrom[List[String],unfiltered.Cookie,List[unfiltered.Cookie]])List[unfiltered.Cookie]">flatMap</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.List.Coll,unfiltered.Cookie,List[unfiltered.Cookie]]" class="delimiter">(</span><a href="#10324" title="object unfiltered.request.FromCookies">FromCookies</a>.<a href="#77823" title="(cstr: String)Seq[unfiltered.Cookie]">apply</a> _<span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">(</span>
      <span class="delimiter">(</span><a title="scala.collection.immutable.Map[String,Option[unfiltered.Cookie]]" id="77884">m</a>, <a title="unfiltered.Cookie" id="77885">c</a><span class="delimiter">)</span> =&gt; <a href="#77884" title="scala.collection.immutable.Map[String,Option[unfiltered.Cookie]]">m</a> <span title="(kv: (String, Option[unfiltered.Cookie]))scala.collection.immutable.Map[String,Option[unfiltered.Cookie]]">+</span> <span class="delimiter">(</span><a href="#77885" title="unfiltered.Cookie">c</a>.<a href="../cookies.scala.html#24912" title="(x: String)ArrowAssoc[String]">name</a> <span title="(y: Some[unfiltered.Cookie])(String, Some[unfiltered.Cookie])">-&gt;</span> <span title="(x: unfiltered.Cookie)Some[unfiltered.Cookie]">Some</span><span class="delimiter">(</span><a href="#77885" title="unfiltered.Cookie">c</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">)</span>.<span title="(d: Option[unfiltered.Cookie])scala.collection.immutable.Map[String,Option[unfiltered.Cookie]]">withDefaultValue</span><span class="delimiter">(</span><span title="object None">None</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="comment">/** Primary Cookie extractor used for obtaining a collection cookies mapped
 *  to their names from the HTTP `Cookie` header */</span>
<span class="keyword">object</span> <a title="object unfiltered.request.Cookies" id="9799">Cookies</a> <span title="ScalaObject" class="keyword">extends</span> <a href="headers.scala.html#10326" title="unfiltered.request.MappedRequestHeader[String,Option[unfiltered.Cookie]]">MappedRequestHeader</a><span class="delimiter">[</span>String, Option<span class="delimiter">[</span>Cookie<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">(</span><span title="java.lang.String(&quot;Cookie&quot;)" class="string">&quot;Cookie&quot;</span><span class="delimiter">)</span><span class="delimiter">(</span><a href="#10297" title="object unfiltered.request.CookieValueParser">CookieValueParser</a><span class="delimiter">)</span>

<span class="comment">/** Module for Cookie deserialization.
 * Some optional cookie properties defined in http://tools.ietf.org/html/rfc2965 are not included in this implementation's 
 * deserialized cookie representation. This list includes `Comment`, `CommentURL`, `Discard`, and `Port` */</span>
<span class="keyword">object</span> <a title="object unfiltered.request.FromCookies" id="10324">FromCookies</a> <span title="ScalaObject" class="delimiter">{</span>
  <span class="keyword">import</span> unfiltered.<a href="../cookies.scala.html#9507" title="object unfiltered.CookieKeys">CookieKeys</a>._
  <span class="keyword">val</span> <a title="scala.util.matching.Regex" id="77821">Cutter</a> = <span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;(?:\\s|[;,])*\\$*([^;=]+)(?:=(?:[\&quot;']((?:\\\\.|[^\&quot;])*)[\&quot;']|([^;,]*)))?(\\s*(?:[;,]+\\s*|$))&quot;</span>.<span title="=&gt; scala.util.matching.Regex">r</span>

  <span class="keyword">def</span> <a title="(cstr: String)Seq[unfiltered.Cookie]" id="77823">apply</a><span class="delimiter">(</span><a title="String" id="77824">cstr</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="Seq[unfiltered.Cookie]">Seq</span><span class="delimiter">[</span>Cookie<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a href="#77985" title="(List[String], List[String])" class="delimiter">(</a><a href="#77984" title="List[String]" id="77985">names</a>, <a href="#77984" title="List[String]" id="77986">values</a><span class="delimiter">)</span> =
      <span class="delimiter">(</span><span class="delimiter">(</span><span title="(_1: List[String], _2: List[String], _3: Option[(String, String, String)])(List[String], List[String], Option[(String, String, String)])" class="delimiter">(</span><span title="object List">List</span>.<span title="[A]=&gt; List[A]">empty</span><span title="List[String]" class="delimiter">[</span><span title="String">String</span><span class="delimiter">]</span>, <span title="object List">List</span>.<span title="[A]=&gt; List[A]">empty</span><span title="List[String]" class="delimiter">[</span><span title="String">String</span><span class="delimiter">]</span>, <span class="delimiter">(</span><span title="object None">None</span>: <span title="Option[(String, String, String)]">Option</span><span class="delimiter">[</span><span class="delimiter">(</span>String, String, String<span class="delimiter">)</span><span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">)</span> <a href="#77987" title="(z: (List[String], List[String], Option[(String, String, String)]))(op: ((List[String], List[String], Option[(String, String, String)]), String) =&gt; (List[String], List[String], Option[(String, String, String)]))(List[String], List[String], Option[(String, String, String)])">/:</a>
         <a href="#77821" title="=&gt; scala.util.matching.Regex">Cutter</a>.<span title="(source: java.lang.CharSequence)scala.util.matching.Regex.MatchIterator">findAllIn</span><span class="delimiter">(</span><a href="#77824" title="String">cstr</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
           <span class="delimiter">(</span><a title="(List[String], List[String], Option[(String, String, String)])" id="78011">a</a>, <a title="String" id="78012">e</a><span class="delimiter">)</span> =&gt; <span title="(_1: (List[String], List[String], Option[(String, String, String)]), _2: String)((List[String], List[String], Option[(String, String, String)]), String)" class="delimiter">(</span><a href="#78011" title="(List[String], List[String], Option[(String, String, String)])">a</a>, <a href="#78012" title="String">e</a><span class="delimiter">)</span> <span title="(List[String], List[String], Option[(String, String, String)])" class="keyword">match</span> <span class="delimiter">{</span>
             <span class="keyword">case</span> <span title="(List[String], List[String], Option[(String, String, String)])" class="delimiter">(</span><span class="delimiter">(</span><a title="List[String]" id="78024">names</a>, <a title="List[String]" id="78025">values</a>, <a title="Option[(String, String, String)]" id="78026">prev</a><span class="delimiter">)</span>, <a title="String" id="78027">matchresult</a><span class="delimiter">)</span> =&gt;
               <a href="#78027" title="String">matchresult</a> <span title="(List[String], List[String], Option[(String, String, String)])" class="keyword">match</span> <span class="delimiter">{</span>
                 <span class="keyword">case</span> <a href="#77821" title="(List[String], List[String], Option[(String, String, String)])">Cutter</a><span class="delimiter">(</span><a title="String" id="78029">cname</a>, <a title="String" id="78030">couldBeValue</a>, <a title="String" id="78031">cvalue</a>, <a title="String" id="78032">delim</a><span class="delimiter">)</span> =&gt;

                   <span class="keyword">val</span> <a href="#78034" title="(String, String, String)" class="delimiter">(</a><a href="#78033" title="String" id="78034">name</a>, <a href="#78033" title="String" id="78035">value</a>, <a href="#78033" title="String" id="78036">sep</a><span class="delimiter">)</span> = <span title="(_1: String, _2: String, _3: String)(String, String, String)" class="delimiter">(</span><a href="#78029" title="String">cname</a>, <a href="#78031" title="String">cvalue</a> <span title="String" class="keyword">match</span> <span class="delimiter">{</span>
                     <span class="keyword">case</span> <span title="String" class="keyword">null</span> =&gt; <a href="#78030" title="String">couldBeValue</a> <span title="String" class="keyword">match</span> <span class="delimiter">{</span>
                       <span class="keyword">case</span> <span title="String" class="keyword">null</span> =&gt; <a href="#78031" title="String">cvalue</a>
                       <span class="keyword">case</span> <a title="java.lang.String" id="78043">is</a> =&gt; <a href="#78043" title="String">is</a>.<span title="(x$1: java.lang.CharSequence, x$2: java.lang.CharSequence)java.lang.String">replace</span><span class="delimiter">(</span><span title="java.lang.String(&quot;\\\&quot;&quot;)" class="string">&quot;\\\&quot;&quot;</span>, <span title="java.lang.String(&quot;\&quot;&quot;)" class="string">&quot;\&quot;&quot;</span><span class="delimiter">)</span>.<span title="(x$1: java.lang.CharSequence, x$2: java.lang.CharSequence)java.lang.String">replace</span><span class="delimiter">(</span><span title="java.lang.String(&quot;\\\\&quot;)" class="string">&quot;\\\\&quot;</span>, <span title="java.lang.String(&quot;\\&quot;)" class="string">&quot;\\&quot;</span><span class="delimiter">)</span>
                     <span class="delimiter">}</span>
                     <span class="keyword">case</span> <a title="String" id="78052">v</a> =&gt; <a href="#78052" title="String">v</a>
                   <span class="delimiter">}</span>, <a href="#78032" title="String">delim</a><span class="delimiter">)</span>

                   <a href="#78026" title="Option[(String, String, String)]">prev</a> <span title="(List[String], List[String], Option[(String, String, String)])" class="keyword">match</span> <span class="delimiter">{</span>
                     <span class="keyword">case</span> <span title="(List[String], List[String], Some[(String, String, String)])">None</span> =&gt;
                       <span title="(_1: List[String], _2: List[String], _3: Some[(String, String, String)])(List[String], List[String], Some[(String, String, String)])" class="delimiter">(</span><a href="#78024" title="List[String]">names</a>, <a href="#78025" title="List[String]">values</a>, <span title="(x: (String, String, String))Some[(String, String, String)]">Some</span><span class="delimiter">(</span><span title="(_1: String, _2: String, _3: String)(String, String, String)" class="delimiter">(</span><a href="#78034" title="String">name</a>, <span title="(x: String)Option[String]">Option</span><span class="delimiter">(</span><a href="#78035" title="String">value</a><span class="delimiter">)</span>.<span title="(default: =&gt; String)String">getOrElse</span><span class="delimiter">(</span><span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span>, <a href="#78036" title="String">sep</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
                     <span class="keyword">case</span> <span title="(List[String], List[String], Option[(String, String, String)])">Some</span><span class="delimiter">(</span><span class="delimiter">(</span><a title="String" id="78104">n0</a>, <a title="String" id="78105">v0</a>, <a title="String" id="78106">s0</a><span class="delimiter">)</span><span class="delimiter">)</span> =&gt;
                       <span title="(List[String], List[String], Option[(String, String, String)])" class="keyword">if</span><span class="delimiter">(</span><a href="#78035" title="String">value</a> <span title="(x$1: AnyRef)Boolean">==</span> <span title="Null(null)" class="keyword">null</span> <span title="(x: Boolean)Boolean">&amp;&amp;</span>
                          <a href="../cookies.scala.html#75901" title="=&gt; Seq[java.lang.String]">KeyOnly</a>.<span title="(p: java.lang.String =&gt; Boolean)Seq[java.lang.String]">filter</span><span class="delimiter">(</span><a href="#78114" title="java.lang.String">_</a>.<span title="(x$1: java.lang.String)Boolean">equalsIgnoreCase</span><span class="delimiter">(</span><a href="#78034" title="String">name</a><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="=&gt; Boolean">isEmpty</span><span class="delimiter">)</span> <span class="delimiter">{</span>
                         <span title="(_1: List[String], _2: List[String], _3: Some[(String, java.lang.String, String)])(List[String], List[String], Some[(String, java.lang.String, String)])" class="delimiter">(</span><a href="#78024" title="List[String]">names</a>, <a href="#78025" title="List[String]">values</a>, <span title="(x: (String, java.lang.String, String))Some[(String, java.lang.String, String)]">Some</span><span class="delimiter">(</span><span title="(_1: String, _2: java.lang.String, _3: String)(String, java.lang.String, String)" class="delimiter">(</span><a href="#78104" title="String">n0</a>, <a href="#78105" title="String">v0</a> <span title="(x$1: Any)java.lang.String">+</span> <a href="#78106" title="String">s0</a> <span title="(x$1: Any)java.lang.String">+</span> <a href="#78034" title="String">name</a>, <a href="#78036" title="String">sep</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
                       <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
                         <span title="(_1: List[String], _2: List[String], _3: Some[(String, String, String)])(List[String], List[String], Some[(String, String, String)])" class="delimiter">(</span><a href="#78104" title="String">n0</a> <a href="#78143" title="(x: String)List[String]">::</a> <a href="#78024" title="List[String]">names</a>, <a href="#78105" title="String">v0</a> <a href="#78149" title="(x: String)List[String]">::</a> <a href="#78025" title="List[String]">values</a>, <span title="(x: (String, String, String))Some[(String, String, String)]">Some</span><span class="delimiter">(</span><span title="(_1: String, _2: String, _3: String)(String, String, String)" class="delimiter">(</span><a href="#78034" title="String">name</a>, <a href="#78035" title="String">value</a>, <a href="#78032" title="String">delim</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
                       <span class="delimiter">}</span>
                   <span class="delimiter">}</span>
               <span class="delimiter">}</span>
             <span class="delimiter">}</span>
         <span class="delimiter">}</span><span class="delimiter">)</span> <span title="(List[String], List[String])" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <span title="(List[String], List[String])" class="delimiter">(</span><a title="List[String]" id="78173">ns</a>, <a title="List[String]" id="78174">vs</a>, Some<span class="delimiter">(</span><span class="delimiter">(</span><a title="String" id="78179">n</a>, <a title="String" id="78180">v</a>, _<span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span> =&gt;
          <span title="(List[String], List[String])" class="keyword">if</span><span class="delimiter">(</span><a href="#78179" title="String">n</a> <span title="(x$1: AnyRef)Boolean">==</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <span title="(_1: List[String], _2: List[String])(List[String], List[String])" class="delimiter">(</span><a href="#78173" title="List[String]">ns</a>.<span title="=&gt; List[String]">reverse</span>, <a href="#78174" title="List[String]">vs</a>.<span title="=&gt; List[String]">reverse</span><span class="delimiter">)</span>
          <span class="keyword">else</span> <span title="(_1: List[String], _2: List[String])(List[String], List[String])" class="delimiter">(</span><span class="delimiter">(</span><a href="#78179" title="String">n</a> <a href="#78195" title="(x: String)List[String]">::</a> <a href="#78173" title="List[String]">ns</a><span class="delimiter">)</span>.<span title="=&gt; List[String]">reverse</span>, <span class="delimiter">(</span><a href="#78180" title="String">v</a> <a href="#78211" title="(x: String)List[String]">::</a> <a href="#78174" title="List[String]">vs</a><span class="delimiter">)</span>.<span title="=&gt; List[String]">reverse</span><span class="delimiter">)</span>
        <span class="keyword">case</span> <span title="Nothing">_</span> =&gt; <span class="comment">/*sys.*/</span><span title="(message: String)Nothing">error</span><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;Error parsing cookie string %s&quot;</span> <span title="(args: Any*)String">format</span> <a href="#77824" title="String">cstr</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>

    <span title="Seq[unfiltered.Cookie]" class="keyword">if</span><span class="delimiter">(</span><a href="#77985" title="List[String]">names</a>.<span title="=&gt; Boolean">isEmpty</span><span class="delimiter">)</span> <span class="delimiter">{</span> <span title="object Seq">Seq</span>.<span title="[A]=&gt; Seq[A]">empty</span><span title="Seq[unfiltered.Cookie]" class="delimiter">[</span><a href="../cookies.scala.html#9467" title="unfiltered.Cookie">Cookie</a><span class="delimiter">]</span> <span class="delimiter">}</span>
    <span class="keyword">else</span> <span class="delimiter">{</span>
      <span class="comment">// version may appear before name-value</span>
      <span class="keyword">val</span> <a href="#78246" title="(Int, Int)" class="delimiter">(</a><a href="#78245" title="Int" id="78246">version</a>, <a href="#78245" title="Int" id="78247">startAt</a><span class="delimiter">)</span> =
        <span title="(Int, Int)" class="keyword">if</span><span class="delimiter">(</span><a href="#77985" title="(n: Int)String">names</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>.<span title="(x$1: java.lang.String)Boolean">equalsIgnoreCase</span><span class="delimiter">(</span><a href="../cookies.scala.html#75877" title="=&gt; java.lang.String">Version</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <span class="keyword">try</span> <span class="delimiter">{</span> <span title="(_1: Int, _2: Int)(Int, Int)" class="delimiter">(</span><span title="object java.lang.Integer">Integer</span>.<span title="(x$1: java.lang.String)Int">parseInt</span><span class="delimiter">(</span><a href="#77986" title="(n: Int)String">values</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span><span class="delimiter">)</span>, <span title="Int(1)" class="int">1</span><span class="delimiter">)</span> <span class="delimiter">}</span> <span class="keyword">catch</span> <span class="delimiter">{</span> <span class="keyword">case</span> <span title="(Int, Int)">_</span> =&gt; <span title="(_1: Int, _2: Int)(Int, Int)" class="delimiter">(</span><span title="Int(0)" class="int">0</span>, <span title="Int(1)" class="int">1</span><span class="delimiter">)</span> <span class="delimiter">}</span>
        <span class="keyword">else</span> <span title="(_1: Int, _2: Int)(Int, Int)" class="delimiter">(</span><span title="Int(0)" class="int">0</span>, <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>

      <span title="Seq[unfiltered.Cookie]" class="keyword">if</span><span class="delimiter">(</span><a href="#77985" title="List[String]">names</a>.<span title="=&gt; Boolean">isEmpty</span><span class="delimiter">)</span> <span title="object Seq">Seq</span>.<span title="[A]=&gt; Seq[A]">empty</span><span title="Seq[unfiltered.Cookie]" class="delimiter">[</span><a href="../cookies.scala.html#9467" title="unfiltered.Cookie">Cookie</a><span class="delimiter">]</span>
      <span class="keyword">else</span> <span class="delimiter">{</span>
        <span class="comment">// baking the cookies.</span>
        <span class="comment">// Given a seq of names and a seq of values</span>
        <span class="comment">// iterate by one value, i, which creates a base cookie using a name, value combo </span>
        <span class="comment">// then fold over the rest of the names &amp; values building up the cookie</span>
        <span class="comment">// along with a flag that indicates of the a cookie has been build.</span>
        <span class="comment">// On each application of the fold, move the top level iterator's cursor</span>
        <span class="comment">// forword until a cookie is complete. We keep track of the completion flag</span>
        <span class="comment">// as a member of the fold to a) avoid introducing a mutable var, and b)</span>
        <span class="comment">// scala does not have a way to break from a for comprehention while still returning</span>
        <span class="comment">// a value. scala.util.control.Breakable is not an option here</span>
        <span class="keyword">val</span> <a title="Iterator[Int]" id="78292">iter</a>: <span title="Iterator[Int]">Iterator</span><span class="delimiter">[</span>Int<span class="delimiter">]</span> = <span class="delimiter">(</span><a href="#78247" title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt">startAt</a> <span title="(end: Int)scala.collection.immutable.Range">until</span> <a href="#77985" title="List[String]">names</a>.<span title="=&gt; Int">size</span><span class="delimiter">)</span>.<span title="=&gt; Iterator[Int]">iterator</span>
        <span class="delimiter">(</span><span class="keyword">for</span><span class="delimiter">(</span><a title="Int" id="78347">i</a> &lt;- <a href="#78292" title="(f: Int =&gt; (Boolean, unfiltered.Cookie))Iterator[(Boolean, unfiltered.Cookie)]">iter</a><span class="delimiter">)</span> <span class="keyword">yield</span> <span class="delimiter">{</span>
          <span class="delimiter">(</span><span title="(_1: Boolean, _2: unfiltered.Cookie)(Boolean, unfiltered.Cookie)" class="delimiter">(</span><span title="Boolean(false)" class="keyword">false</span>, <a href="../cookies.scala.html#26187" title="(name: String, value: String, domain: Option[String], path: Option[String], maxAge: Option[Int], secure: Option[Boolean], httpOnly: Boolean, version: Int)unfiltered.Cookie">Cookie</a><span class="delimiter">(</span><a href="#77985" title="(n: Int)String">names</a><span class="delimiter">(</span><a href="#78347" title="Int">i</a><span class="delimiter">)</span>, <span title="(x: String)Option[String]">Option</span><span class="delimiter">(</span><a href="#77986" title="(n: Int)String">values</a><span class="delimiter">(</span><a href="#78347" title="Int">i</a><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="(default: =&gt; String)String">getOrElse</span><span class="delimiter">(</span><span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span> <a href="#78348" title="(z: (Boolean, unfiltered.Cookie))(op: ((Boolean, unfiltered.Cookie), Int) =&gt; (Boolean, unfiltered.Cookie))(Boolean, unfiltered.Cookie)">/:</a> <span class="delimiter">(</span>
            <a href="#78347" title="Int">i</a> <span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt">+</span> <span title="Int(1)" class="int">1</span> <span title="(end: Int)scala.collection.immutable.Range">until</span> <a href="#77985" title="List[String]">names</a>.<span title="=&gt; Int">size</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span> <span class="delimiter">(</span><a title="(Boolean, unfiltered.Cookie)" id="78489">a</a>, <a title="Int" id="78490">j</a><span class="delimiter">)</span> =&gt;
            <span class="keyword">val</span> <a href="#78492" title="(Boolean, unfiltered.Cookie)" class="delimiter">(</a><a href="#78491" title="Boolean" id="78492">complete</a>, <a href="#78491" title="unfiltered.Cookie" id="78493">cookie</a><span class="delimiter">)</span> = <a href="#78489" title="(Boolean, unfiltered.Cookie)">a</a>
            <span title="(Boolean, unfiltered.Cookie)" class="keyword">if</span><span class="delimiter">(</span><a href="#78492" title="Boolean">complete</a><span class="delimiter">)</span> <a href="#78489" title="(Boolean, unfiltered.Cookie)">a</a>
            <span class="keyword">else</span> <span title="(_1: java.lang.String, _2: String)(java.lang.String, String)" class="delimiter">(</span><a href="#77985" title="(n: Int)String">names</a><span class="delimiter">(</span><a href="#78490" title="Int">j</a><span class="delimiter">)</span>.<span title="()java.lang.String">toLowerCase</span>, <a href="#77986" title="(n: Int)String">values</a><span class="delimiter">(</span><a href="#78490" title="Int">j</a><span class="delimiter">)</span><span class="delimiter">)</span> <span title="(Boolean, unfiltered.Cookie)" class="keyword">match</span> <span class="delimiter">{</span>
              <span class="keyword">case</span> <span title="(Boolean, unfiltered.Cookie)" class="delimiter">(</span><a href="../cookies.scala.html#75895" title="=&gt; java.lang.String">LCDiscard</a>,    _<span class="delimiter">)</span> =&gt; <a href="#78292" title="Iterator[Int]">iter</a>.<span title="()Int">next</span>; <span title="(_1: Boolean, _2: unfiltered.Cookie)(Boolean, unfiltered.Cookie)" class="delimiter">(</span><span title="Boolean(false)" class="keyword">false</span>, <a href="#78493" title="unfiltered.Cookie">cookie</a><span class="delimiter">)</span> <span class="comment">// don't support</span>
              <span class="keyword">case</span> <span title="(Boolean, unfiltered.Cookie)" class="delimiter">(</span><a href="../cookies.scala.html#75887" title="=&gt; java.lang.String">LCSecure</a>,     <a title="String" id="78536">v</a><span class="delimiter">)</span> =&gt; <a href="#78292" title="Iterator[Int]">iter</a>.<span title="()Int">next</span>; <span title="(_1: Boolean, _2: unfiltered.Cookie)(Boolean, unfiltered.Cookie)" class="delimiter">(</span><span title="Boolean(false)" class="keyword">false</span>, <a href="#78493" title="unfiltered.Cookie">cookie</a>.<a href="../cookies.scala.html#75961" title="String" id="78551">copy</a><span class="delimiter">(</span>secure = <span title="(x: Boolean)Option[Boolean]">Option</span><a title="Option[Boolean]" id="78544" class="delimiter">(</a><span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
              <span class="keyword">case</span> <span title="(Boolean, unfiltered.Cookie)" class="delimiter">(</span><a href="../cookies.scala.html#75889" title="=&gt; java.lang.String">LCHTTPOnly</a>,   <a title="String" id="78556">v</a><span class="delimiter">)</span> =&gt; <a href="#78292" title="Iterator[Int]">iter</a>.<span title="()Int">next</span>; <span title="(_1: Boolean, _2: unfiltered.Cookie)(Boolean, unfiltered.Cookie)" class="delimiter">(</span><span title="Boolean(false)" class="keyword">false</span>, <a href="#78493" title="unfiltered.Cookie">cookie</a>.<a href="../cookies.scala.html#75961" title="String" id="78568">copy</a><span class="delimiter">(</span>httpOnly = <a title="Boolean(true)" id="78561" class="keyword">true</a><span class="delimiter">)</span><span class="delimiter">)</span>
              <span class="keyword">case</span> <span title="(Boolean, unfiltered.Cookie)" class="delimiter">(</span><a href="../cookies.scala.html#75891" title="=&gt; java.lang.String">LCComment</a>,    _<span class="delimiter">)</span> =&gt; <a href="#78292" title="Iterator[Int]">iter</a>.<span title="()Int">next</span>; <span title="(_1: Boolean, _2: unfiltered.Cookie)(Boolean, unfiltered.Cookie)" class="delimiter">(</span><span title="Boolean(false)" class="keyword">false</span>, <a href="#78493" title="unfiltered.Cookie">cookie</a><span class="delimiter">)</span> <span class="comment">// don't support </span>
              <span class="keyword">case</span> <span title="(Boolean, unfiltered.Cookie)" class="delimiter">(</span><a href="../cookies.scala.html#75893" title="=&gt; java.lang.String">LCCommentURL</a>, _<span class="delimiter">)</span> =&gt; <a href="#78292" title="Iterator[Int]">iter</a>.<span title="()Int">next</span>; <span title="(_1: Boolean, _2: unfiltered.Cookie)(Boolean, unfiltered.Cookie)" class="delimiter">(</span><span title="Boolean(false)" class="keyword">false</span>, <a href="#78493" title="unfiltered.Cookie">cookie</a><span class="delimiter">)</span> <span class="comment">// don't support</span>
              <span class="keyword">case</span> <span title="(Boolean, unfiltered.Cookie)" class="delimiter">(</span><a href="../cookies.scala.html#75885" title="=&gt; java.lang.String">LCDomain</a>,     <a title="String" id="78589">v</a><span class="delimiter">)</span> =&gt; <a href="#78292" title="Iterator[Int]">iter</a>.<span title="()Int">next</span>; <span title="(_1: Boolean, _2: unfiltered.Cookie)(Boolean, unfiltered.Cookie)" class="delimiter">(</span><span title="Boolean(false)" class="keyword">false</span>, <a href="#78493" title="unfiltered.Cookie">cookie</a>.<a href="../cookies.scala.html#75961" title="String" id="78604">copy</a><span class="delimiter">(</span>domain = <span title="(x: String)Option[String]">Option</span><a title="Option[String]" id="78597" class="delimiter">(</a><a href="#78589" title="String">v</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
              <span class="keyword">case</span> <span title="(Boolean, unfiltered.Cookie)" class="delimiter">(</span><a href="../cookies.scala.html#75879" title="=&gt; java.lang.String">LCPath</a>,       <a title="String" id="78609">v</a><span class="delimiter">)</span> =&gt; <a href="#78292" title="Iterator[Int]">iter</a>.<span title="()Int">next</span>; <span title="(_1: Boolean, _2: unfiltered.Cookie)(Boolean, unfiltered.Cookie)" class="delimiter">(</span><span title="Boolean(false)" class="keyword">false</span>, <a href="#78493" title="unfiltered.Cookie">cookie</a>.<a href="../cookies.scala.html#75961" title="String" id="78624">copy</a><span class="delimiter">(</span>path = <span title="(x: String)Option[String]">Option</span><a title="Option[String]" id="78617" class="delimiter">(</a><a href="#78609" title="String">v</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
              <span class="keyword">case</span> <span title="(Boolean, unfiltered.Cookie)" class="delimiter">(</span><a href="../cookies.scala.html#75881" title="=&gt; java.lang.String">LCExpires</a>,    <a title="String" id="78629">v</a><span class="delimiter">)</span> =&gt; <a href="#78292" title="Iterator[Int]">iter</a>.<span title="()Int">next</span>; <span title="(_1: Boolean, _2: unfiltered.Cookie)(Boolean, unfiltered.Cookie)" class="delimiter">(</span><span title="Boolean(false)" class="keyword">false</span>, <span class="keyword">try</span> <span class="delimiter">{</span>
                <span class="keyword">val</span> <a title="Long" id="78634">maxMils</a> =
                  unfiltered.request.<a href="headers.scala.html#9847" title="object unfiltered.request.DateFormatting">DateFormatting</a>.<a href="headers.scala.html#78643" title="(raw: String)Option[java.util.Date]">parseDate</a><span class="delimiter">(</span><a href="#78629" title="String">v</a><span class="delimiter">)</span>.<span title="=&gt; java.util.Date">get</span>.<span title="()Long">getTime</span> <span title="(x: Long)Long">-</span>
                    <span title="object java.lang.System">System</span>.<span title="()Long">currentTimeMillis</span>
                <a href="#78493" title="unfiltered.Cookie">cookie</a>.<a href="../cookies.scala.html#75961" title="String" id="78709">copy</a><span class="delimiter">(</span>maxAge = <span title="(x: Int)Option[Int]">Option</span><a title="Option[Int]" id="78702" class="delimiter">(</a>
                  <span title="Int" class="keyword">if</span><span class="delimiter">(</span><a href="#78634" title="Long">maxMils</a> <span title="(x: Int)Boolean">&lt;</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>  <span title="Int(0)" class="int">0</span>
                  <span class="keyword">else</span> <span class="delimiter">(</span><a href="#78634" title="Long">maxMils</a> <span title="(x: Int)Long">/</span> <span title="Int(1000)" class="int">1000</span><span class="delimiter">)</span>.<span title="=&gt; Int">toInt</span> <span title="(x: Int)Int">+</span> <span class="delimiter">(</span><span title="Int" class="keyword">if</span><span class="delimiter">(</span><a href="#78634" title="Long">maxMils</a> <span title="(x: Int)Long">%</span> <span title="Int(1000)" class="int">1000</span> <span title="(x: Int)Boolean">!=</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span title="Int(1)" class="int">1</span> <span class="keyword">else</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
              <span class="delimiter">}</span> <span class="keyword">catch</span> <span class="delimiter">{</span>
                <span class="keyword">case</span> <span title="unfiltered.Cookie">_</span> =&gt; <a href="#78493" title="unfiltered.Cookie">cookie</a>
              <span class="delimiter">}</span><span class="delimiter">)</span>
              <span class="keyword">case</span> <span title="(Boolean, unfiltered.Cookie)" class="delimiter">(</span><a href="../cookies.scala.html#75883" title="=&gt; java.lang.String">LCMaxAge</a>, <a title="String" id="78714">v</a><span class="delimiter">)</span>     =&gt; <a href="#78292" title="Iterator[Int]">iter</a>.<span title="()Int">next</span>;  <span title="(_1: Boolean, _2: unfiltered.Cookie)(Boolean, unfiltered.Cookie)" class="delimiter">(</span><span title="Boolean(false)" class="keyword">false</span>, <span class="keyword">try</span> <span class="delimiter">{</span>
                <a href="#78493" title="unfiltered.Cookie">cookie</a>.<a href="../cookies.scala.html#75961" title="String" id="78731">copy</a><span class="delimiter">(</span>maxAge = <span title="(x: Int)Option[Int]">Option</span><a title="Option[Int]" id="78724" class="delimiter">(</a><span title="object java.lang.Integer">Integer</span>.<span title="(x$1: java.lang.String)Int">parseInt</span><span class="delimiter">(</span><a href="#78714" title="String">v</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
              <span class="delimiter">}</span> <span class="keyword">catch</span> <span class="delimiter">{</span>
                <span class="keyword">case</span> <span title="unfiltered.Cookie">_</span> =&gt; <a href="#78493" title="unfiltered.Cookie">cookie</a>
              <span class="delimiter">}</span><span class="delimiter">)</span>
              <span class="keyword">case</span> <span title="(Boolean, unfiltered.Cookie)" class="delimiter">(</span><a href="../cookies.scala.html#75899" title="=&gt; java.lang.String">LCVersion</a>, <a title="String" id="78736">v</a><span class="delimiter">)</span>    =&gt; <a href="#78292" title="Iterator[Int]">iter</a>.<span title="()Int">next</span>;  <span title="(_1: Boolean, _2: unfiltered.Cookie)(Boolean, unfiltered.Cookie)" class="delimiter">(</span><span title="Boolean(false)" class="keyword">false</span>, <span class="keyword">try</span> <span class="delimiter">{</span>
                <a href="#78493" title="unfiltered.Cookie">cookie</a>.<a href="../cookies.scala.html#75961" title="String" id="78750">copy</a><span class="delimiter">(</span>version = <span title="object java.lang.Integer">Integer</span>.<span title="(x$1: java.lang.String)Int">parseInt</span><a title="Int" id="78743" class="delimiter">(</a><a href="#78736" title="String">v</a><span class="delimiter">)</span><span class="delimiter">)</span>
              <span class="delimiter">}</span> <span class="keyword">catch</span> <span class="delimiter">{</span>
                <span class="keyword">case</span> <span title="unfiltered.Cookie">_</span> =&gt; <a href="#78493" title="unfiltered.Cookie">cookie</a>
              <span class="delimiter">}</span><span class="delimiter">)</span>
              <span class="keyword">case</span> <span title="(Boolean, unfiltered.Cookie)" class="delimiter">(</span><a href="../cookies.scala.html#75897" title="=&gt; java.lang.String">LCPort</a>, _<span class="delimiter">)</span>    =&gt;  <a href="#78292" title="Iterator[Int]">iter</a>.<span title="()Int">next</span>; <span title="(_1: Boolean, _2: unfiltered.Cookie)(Boolean, unfiltered.Cookie)" class="delimiter">(</span><span title="Boolean(false)" class="keyword">false</span>, <a href="#78493" title="unfiltered.Cookie">cookie</a><span class="delimiter">)</span> <span class="comment">// don't support</span>
              <span class="keyword">case</span> <span title="(Boolean, unfiltered.Cookie)" class="delimiter">(</span><a title="java.lang.String" id="78763">pass</a>, _<span class="delimiter">)</span>      =&gt;  <span title="(_1: Boolean, _2: unfiltered.Cookie)(Boolean, unfiltered.Cookie)" class="delimiter">(</span><span title="Boolean(true)" class="keyword">true</span>, <a href="#78493" title="unfiltered.Cookie">cookie</a><span class="delimiter">)</span>
            <span class="delimiter">}</span>
          <span class="delimiter">}</span>
        <span class="delimiter">}</span><span class="delimiter">)</span>
        <span class="comment">// discard completion statuses</span>
        .<span title="(f: (Boolean, unfiltered.Cookie) =&gt; unfiltered.Cookie)Iterator[unfiltered.Cookie]">map</span><span class="delimiter">(</span><a href="#78775" title="(Boolean, unfiltered.Cookie)">_</a>.<span title="=&gt; unfiltered.Cookie">_2</span><span class="delimiter">)</span>.<span title="=&gt; Seq[unfiltered.Cookie]">toSeq</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>


        </pre>
    </body>
</html>