<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>uploads/unfiltered/request/request/uploads.scala</title>
        <script type="text/javascript" src="../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> unfiltered.request

<span class="keyword">import</span> scala.util.control.<span title="object scala.util.control.Exception">Exception</span>.allCatch

<span class="keyword">import</span> javax.servlet.http.HttpServletRequest

<span class="keyword">import</span> org.apache.commons.<span class="delimiter">{</span>fileupload =&gt; fu<span class="delimiter">}</span>
<span class="keyword">import</span> fu.servlet.ServletFileUpload
<span class="keyword">import</span> java.io.<span class="delimiter">{</span>File =&gt; JFile<span class="delimiter">}</span>

<span class="comment">/** Matches requests that have multipart content */</span>
<span class="keyword">object</span> <a title="object unfiltered.request.MultiPart" id="9868">MultiPart</a> <span title="ScalaObject" class="delimiter">{</span>
  <span class="keyword">def</span> <a title="(req: unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest])Option[unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest]]" id="88745">unapply</a><span class="delimiter">(</span><a title="unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest]" id="88747">req</a>: <a href="../../../../unfiltered/unfiltered/unfiltered/request/HttpRequest.scala.html#10254" title="unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest]">HttpRequest</a><span class="delimiter">[</span>HttpServletRequest<span class="delimiter">]</span><span class="delimiter">)</span> =
    <span title="Option[unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest]]" class="keyword">if</span> <span class="delimiter">(</span><span title="object org.apache.commons.fileupload.servlet.ServletFileUpload">ServletFileUpload</span>.<span title="(x$1: javax.servlet.http.HttpServletRequest)Boolean">isMultipartContent</span><span class="delimiter">(</span><a href="#88747" title="unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest]">req</a>.<a href="../../../../unfiltered/unfiltered/unfiltered/request/HttpRequest.scala.html#13021" title="=&gt; javax.servlet.http.HttpServletRequest">underlying</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span title="(x: unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest])Some[unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest]]">Some</span><span class="delimiter">(</span><a href="#88747" title="unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest]">req</a><span class="delimiter">)</span>
    <span class="keyword">else</span> <span title="object None">None</span>
<span class="delimiter">}</span>

case <span class="keyword">class</span> <a title="class MultipartData[W] extends java.lang.Object with ScalaObject with Product with Serializable" id="90223">MultipartData</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="88816">W</a><span class="delimiter">]</span><a href="#90223" title="ScalaObject" class="delimiter">(</a><a title="String =&gt; Seq[String]" id="89387">params</a>: String =&gt; Seq<span class="delimiter">[</span>String<span class="delimiter">]</span>, <a title="String =&gt; W" id="89388">files</a>: String =&gt; W<span class="delimiter">)</span>

<span class="keyword">trait</span> <a title="trait FileWrapper extends java.lang.Object" id="10029">FileWrapper</a> <span title="java.lang.Object" class="delimiter">{</span>
  <span class="keyword">val</span> <a title="=&gt; String" id="88864">name</a>: <span title="String">String</span>
  <span class="keyword">val</span> <a title="=&gt; String" id="88865">contentType</a>: <span title="String">String</span>
  <span class="keyword">def</span> <a title="(out: java.io.File)Option[java.io.File]" id="88866">write</a><span class="delimiter">(</span><a title="java.io.File" id="88868">out</a>: <span title="java.io.File">JFile</span><span class="delimiter">)</span>: <span title="Option[java.io.File]">Option</span><span class="delimiter">[</span>JFile<span class="delimiter">]</span>
<span class="delimiter">}</span>

<span class="comment">/** Represents an uploaded file loaded into memory (and possibly written to disk) */</span>
<span class="keyword">class</span> <a title="class DiskFileWrapper extends java.lang.Object with unfiltered.request.FileWrapper with ScalaObject" id="9714">DiskFileWrapper</a><a href="#9714" title="ScalaObject" class="delimiter">(</a><a title="org.apache.commons.fileupload.FileItem" id="88901">item</a>: fu.<span title="org.apache.commons.fileupload.FileItem">FileItem</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#10029" title="unfiltered.request.FileWrapper">FileWrapper</a> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="(out: java.io.File)Option[java.io.File]" id="88872">write</a><span class="delimiter">(</span><a title="java.io.File" id="88902">out</a>: <span title="java.io.File">JFile</span><span class="delimiter">)</span>: <span title="Option[java.io.File]">Option</span><span class="delimiter">[</span>JFile<span class="delimiter">]</span> = <span class="keyword">try</span> <span class="delimiter">{</span>
    <a href="#88901" title="org.apache.commons.fileupload.FileItem">item</a>.<span title="(x$1: java.io.File)Unit">write</span><span class="delimiter">(</span><a href="#88902" title="java.io.File">out</a><span class="delimiter">)</span>
    <span title="(x: java.io.File)Some[java.io.File]">Some</span><span class="delimiter">(</span><a href="#88902" title="java.io.File">out</a><span class="delimiter">)</span>
  <span class="delimiter">}</span> <span class="keyword">catch</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <span title="None.type">_</span> =&gt; <span title="object None">None</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="=&gt; Boolean" id="88873">isInMemory</a> = <a href="#88901" title="org.apache.commons.fileupload.FileItem">item</a>.<span title="()Boolean">isInMemory</span>
  <span class="keyword">def</span> <a title="=&gt; Array[Byte]" id="88874">bytes</a> = <a href="#88901" title="org.apache.commons.fileupload.FileItem">item</a>.<span title="()Array[Byte]">get</span>
  <span class="keyword">def</span> <a title="=&gt; Long" id="88875">size</a> = <a href="#88901" title="org.apache.commons.fileupload.FileItem">item</a>.<span title="()Long">getSize</span>
  <span class="keyword">val</span> <a title="java.lang.String" id="88876">name</a> = <a href="#88901" title="org.apache.commons.fileupload.FileItem">item</a>.<span title="()java.lang.String">getName</span>
  <span class="keyword">val</span> <a title="java.lang.String" id="88878">contentType</a> = <a href="#88901" title="org.apache.commons.fileupload.FileItem">item</a>.<span title="()java.lang.String">getContentType</span>
<span class="delimiter">}</span>

<span class="comment">/** Represents an uploaded file exposing a stream to read its contents */</span>
<span class="keyword">class</span> <a title="class StreamedFileWrapper extends java.lang.Object with unfiltered.request.FileWrapper with unfiltered.request.io.FileIO with ScalaObject" id="10266">StreamedFileWrapper</a><a href="#10266" title="ScalaObject" class="delimiter">(</a><a title="org.apache.commons.fileupload.FileItemStream" id="88940">fstm</a>: fu.<span title="org.apache.commons.fileupload.FileItemStream">FileItemStream</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#10029" title="unfiltered.request.FileWrapper">FileWrapper</a>
  <span class="keyword">with</span> unfiltered.request.io.<a href="io/files.scala.html#12800" title="unfiltered.request.io.FileIO">FileIO</a> <span class="delimiter">{</span>

  <span class="keyword">def</span> <a title="(out: java.io.File)Option[java.io.File]" id="88919">write</a><span class="delimiter">(</span><a title="java.io.File" id="88941">out</a>: <span title="java.io.File">JFile</span><span class="delimiter">)</span>: <span title="Option[java.io.File]">Option</span><span class="delimiter">[</span>JFile<span class="delimiter">]</span> = <span title="util.control.Exception.Catch[Nothing]">allCatch</span>.<span title="(body: =&gt; java.io.File)Option[java.io.File]">opt</span> <span class="delimiter">{</span>
    <a href="#88920" title="(v1: java.io.InputStream =&gt; java.io.File)java.io.File">stream</a> <span class="delimiter">{</span> <a title="java.io.InputStream" id="88953">stm</a> =&gt;
      <a href="io/files.scala.html#88125" title="(from: java.io.InputStream)(to: java.io.File)Unit">toFile</a><span class="delimiter">(</span><a href="#88953" title="java.io.InputStream">stm</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#88941" title="java.io.File">out</a><span class="delimiter">)</span>
      <a href="#88941" title="java.io.File">out</a>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="[T]=&gt; java.io.InputStream =&gt; T =&gt; T" id="88920">stream</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="88922">T</a><span class="delimiter">]</span>: <span class="delimiter">(</span>java.io.InputStream =&gt; T<span class="delimiter">)</span> =&gt; T =
    <a href="#9652" title="object unfiltered.request.MultiPartParams">MultiPartParams</a>.<a href="#88959" title="object unfiltered.request.MultiPartParams.Streamed">Streamed</a>.<a href="#88981" title="[T](fstm: org.apache.commons.fileupload.FileItemStream)(f: java.io.InputStream =&gt; T)T">withStreamedFile</a><span title="(fstm: org.apache.commons.fileupload.FileItemStream)(f: java.io.InputStream =&gt; T)T" class="delimiter">[</span><a href="#88922" title="T">T</a><span class="delimiter">]</span><a href="#88991" title="java.io.InputStream =&gt; T" class="delimiter">(</a><a href="#88940" title="org.apache.commons.fileupload.FileItemStream">fstm</a><span class="delimiter">)</span>_
  <span class="keyword">val</span> <a title="java.lang.String" id="88923">name</a> = <a href="#88940" title="org.apache.commons.fileupload.FileItemStream">fstm</a>.<span title="()java.lang.String">getName</span>
  <span class="keyword">val</span> <a title="java.lang.String" id="88925">contentType</a> = <a href="#88940" title="org.apache.commons.fileupload.FileItemStream">fstm</a>.<span title="()java.lang.String">getContentType</span>
<span class="delimiter">}</span>

<span class="comment">/** Extactors for multi-part form param processing
  * @note a request can go through one pass of this extractor
  * afterwards, the requests input stream will appear empty
  */</span>
<span class="keyword">object</span> <a title="object unfiltered.request.MultiPartParams" id="9652">MultiPartParams</a> <span title="ScalaObject" class="delimiter">{</span>

  <span class="comment">/** Stream-based multi-part form data extractor */</span>
  <span class="keyword">object</span> <a title="object unfiltered.request.MultiPartParams.Streamed" id="88959">Streamed</a> <span title="ScalaObject" class="delimiter">{</span>
    <span class="keyword">import</span> fu.<span class="delimiter">{</span>FileItemIterator, FileItemStream<span class="delimiter">}</span>
    <span class="keyword">import</span> fu.util.Streams

    case <span class="keyword">class</span> <a title="class FIIteratorWrapper extends java.lang.Object with Iterator[org.apache.commons.fileupload.FileItemStream] with ScalaObject with Product with Serializable" id="89409">FIIteratorWrapper</a><a href="#89409" title="ScalaObject" class="delimiter">(</a><a title="org.apache.commons.fileupload.FileItemIterator" id="89406">i</a>: <span title="org.apache.commons.fileupload.FileItemIterator">FileItemIterator</span><span class="delimiter">)</span> <span class="keyword">extends</span> <span title="Iterator[org.apache.commons.fileupload.FileItemStream]">Iterator</span><span class="delimiter">[</span>FileItemStream<span class="delimiter">]</span> <span class="delimiter">{</span>
      <span class="keyword">def</span> <a title="=&gt; Boolean" id="89011">hasNext</a>: <span title="Boolean">Boolean</span> = <a href="#89406" title="=&gt; org.apache.commons.fileupload.FileItemIterator">i</a>.<span title="()Boolean">hasNext</span>
      <span class="keyword">def</span> <a title="()org.apache.commons.fileupload.FileItemStream" id="89012">next</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="org.apache.commons.fileupload.FileItemStream">FileItemStream</span> = <a href="#89406" title="=&gt; org.apache.commons.fileupload.FileItemIterator">i</a>.<span title="()org.apache.commons.fileupload.FileItemStream">next</span>
    <span class="delimiter">}</span>

    <span class="comment">/** convert apache commons file iterator to scala iterator */</span>
    <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="implicit unfiltered.request.MultiPartParams.Streamed.acfi2si : (i: org.apache.commons.fileupload.FileItemIterator)unfiltered.request.MultiPartParams.Streamed.FIIteratorWrapper" id="88979">acfi2si</a><span class="delimiter">(</span><a title="org.apache.commons.fileupload.FileItemIterator" id="89065">i</a> : <span title="org.apache.commons.fileupload.FileItemIterator">FileItemIterator</span><span class="delimiter">)</span> = <span title="unfiltered.request.MultiPartParams.Streamed.FIIteratorWrapper" class="keyword">new</span> <a href="#89409" title="unfiltered.request.MultiPartParams.Streamed.FIIteratorWrapper">FIIteratorWrapper</a><span class="delimiter">(</span><a href="#89065" title="org.apache.commons.fileupload.FileItemIterator">i</a><span class="delimiter">)</span>

    <span class="comment">/**
      Provides extraction similar to MultiPartParams.Disk, except the second map will
      contain Map[String, Seq[StreamedFileWrapper]] rather than  Map[String, Seq[DiskFileWrapper]].
      @note the seq returned by keys will only return the `first` named value. This is a limitation
      on apache commons file upload streaming interface. To read from the stream iterator,
      you must read before #next is called or the stream read will fail. */</span>
    <span class="keyword">def</span> <a title="(req: unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest])unfiltered.request.MultipartData[Seq[unfiltered.request.StreamedFileWrapper]]" id="88980">apply</a><span class="delimiter">(</span><a title="unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest]" id="89068">req</a>: <a href="../../../../unfiltered/unfiltered/unfiltered/request/HttpRequest.scala.html#10254" title="unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest]">HttpRequest</a><span class="delimiter">[</span>HttpServletRequest<span class="delimiter">]</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
      <span class="keyword">def</span> <a title="=&gt; org.apache.commons.fileupload.FileItemIterator" id="89071">items</a> = <span title="org.apache.commons.fileupload.servlet.ServletFileUpload" class="keyword">new</span> <span title="org.apache.commons.fileupload.servlet.ServletFileUpload">ServletFileUpload</span><span class="delimiter">(</span><span class="delimiter">)</span>.<span title="(x$1: javax.servlet.http.HttpServletRequest)org.apache.commons.fileupload.FileItemIterator">getItemIterator</span><span class="delimiter">(</span><a href="#89068" title="unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest]">req</a>.<a href="../../../../unfiltered/unfiltered/unfiltered/request/HttpRequest.scala.html#13021" title="=&gt; javax.servlet.http.HttpServletRequest">underlying</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="org.apache.commons.fileupload.FileItemIterator" class="delimiter">[</span><span title="org.apache.commons.fileupload.FileItemIterator">FileItemIterator</span><span class="delimiter">]</span>
      <span class="comment">/** attempt to extract the first named param from the stream */</span>
      <span class="keyword">def</span> <a title="(name: String)Seq[String]" id="89072">extractParam</a><span class="delimiter">(</span><a title="String" id="89197">name</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="Seq[String]">Seq</span><span class="delimiter">[</span>String<span class="delimiter">]</span> = <span class="delimiter">{</span>
         <a href="#88979" title="implicit unfiltered.request.MultiPartParams.Streamed.acfi2si : (i: org.apache.commons.fileupload.FileItemIterator)unfiltered.request.MultiPartParams.Streamed.FIIteratorWrapper">items</a>.<span title="(p: org.apache.commons.fileupload.FileItemStream =&gt; Boolean)Option[org.apache.commons.fileupload.FileItemStream]">find</span><span class="delimiter">(</span><a title="org.apache.commons.fileupload.FileItemStream" id="89270">f</a> =&gt; <a href="#89270" title="org.apache.commons.fileupload.FileItemStream">f</a>.<span title="()java.lang.String">getFieldName</span> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#89197" title="String">name</a> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#89270" title="org.apache.commons.fileupload.FileItemStream">f</a>.<span title="()Boolean">isFormField</span><span class="delimiter">)</span> <span title="Seq[String]" class="keyword">match</span> <span class="delimiter">{</span>
           <span class="keyword">case</span> <span title="Seq[String]">Some</span><span class="delimiter">(</span><a title="org.apache.commons.fileupload.FileItemStream" id="89277">p</a><span class="delimiter">)</span> =&gt; <span title="(elems: String*)Seq[String]">Seq</span><span class="delimiter">(</span><a href="#88984" title="(fstm: org.apache.commons.fileupload.FileItemStream)String">extractStr</a><span class="delimiter">(</span><a href="#89277" title="org.apache.commons.fileupload.FileItemStream">p</a><span class="delimiter">)</span><span class="delimiter">)</span>
           <span class="keyword">case</span> <span title="scala.collection.immutable.Nil.type">_</span> =&gt; <span title="object Nil">Nil</span>
         <span class="delimiter">}</span>
      <span class="delimiter">}</span>
      <span class="comment">/** attempt to extract the first named file from the stream */</span>
      <span class="keyword">def</span> <a title="(name: String)Seq[unfiltered.request.StreamedFileWrapper]" id="89073">extractFile</a><span class="delimiter">(</span><a title="String" id="89303">name</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="Seq[unfiltered.request.StreamedFileWrapper]">Seq</span><span class="delimiter">[</span>StreamedFileWrapper<span class="delimiter">]</span> = <span class="delimiter">{</span>
         <a href="#88979" title="implicit unfiltered.request.MultiPartParams.Streamed.acfi2si : (i: org.apache.commons.fileupload.FileItemIterator)unfiltered.request.MultiPartParams.Streamed.FIIteratorWrapper">items</a>.<span title="(p: org.apache.commons.fileupload.FileItemStream =&gt; Boolean)Option[org.apache.commons.fileupload.FileItemStream]">find</span><span class="delimiter">(</span><a title="org.apache.commons.fileupload.FileItemStream" id="89376">f</a> =&gt; <a href="#89376" title="org.apache.commons.fileupload.FileItemStream">f</a>.<span title="()java.lang.String">getFieldName</span> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#89303" title="String">name</a> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <span title="=&gt; Boolean">!</span><a href="#89376" title="org.apache.commons.fileupload.FileItemStream">f</a>.<span title="()Boolean">isFormField</span><span class="delimiter">)</span> <span title="Seq[unfiltered.request.StreamedFileWrapper]" class="keyword">match</span> <span class="delimiter">{</span>
           <span class="keyword">case</span> <span title="Seq[unfiltered.request.StreamedFileWrapper]">Some</span><span class="delimiter">(</span><a title="org.apache.commons.fileupload.FileItemStream" id="89383">f</a><span class="delimiter">)</span> =&gt; <span title="(elems: unfiltered.request.StreamedFileWrapper*)Seq[unfiltered.request.StreamedFileWrapper]">Seq</span><span class="delimiter">(</span><span title="unfiltered.request.StreamedFileWrapper" class="keyword">new</span> <a href="#10266" title="unfiltered.request.StreamedFileWrapper">StreamedFileWrapper</a><span class="delimiter">(</span><a href="#89383" title="org.apache.commons.fileupload.FileItemStream">f</a><span class="delimiter">)</span><span class="delimiter">)</span>
           <span class="keyword">case</span> <span title="scala.collection.immutable.Nil.type">_</span> =&gt; <span title="object Nil">Nil</span>
         <span class="delimiter">}</span>
      <span class="delimiter">}</span>
      <a href="#90223" title="(params: String =&gt; Seq[String], files: String =&gt; Seq[unfiltered.request.StreamedFileWrapper])unfiltered.request.MultipartData[Seq[unfiltered.request.StreamedFileWrapper]]">MultipartData</a><span class="delimiter">(</span><a href="#89072" title="(name: String)Seq[String]">extractParam</a> _,<a href="#89073" title="(name: String)Seq[unfiltered.request.StreamedFileWrapper]">extractFile</a> _<span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="[T](fstm: org.apache.commons.fileupload.FileItemStream)(f: java.io.InputStream =&gt; T)T" id="88981">withStreamedFile</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="88983">T</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="org.apache.commons.fileupload.FileItemStream" id="88985">fstm</a>: <span title="org.apache.commons.fileupload.FileItemStream">FileItemStream</span><span class="delimiter">)</span><span class="delimiter">(</span><a title="java.io.InputStream =&gt; T" id="88986">f</a>: java.io.InputStream =&gt; T<span class="delimiter">)</span>: <a href="#88983" title="T">T</a> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="java.io.InputStream" id="89401">stm</a> = <a href="#88985" title="org.apache.commons.fileupload.FileItemStream">fstm</a>.<span title="()java.io.InputStream">openStream</span>
      <span class="keyword">try</span> <span class="delimiter">{</span> <a href="#88986" title="(v1: java.io.InputStream)T">f</a><span class="delimiter">(</span><a href="#89401" title="java.io.InputStream">stm</a><span class="delimiter">)</span> <span class="delimiter">}</span> <span class="keyword">finally</span> <span class="delimiter">{</span> <a href="#89401" title="java.io.InputStream">stm</a>.<span title="()Unit">close</span> <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(fstm: org.apache.commons.fileupload.FileItemStream)String" id="88984">extractStr</a><span class="delimiter">(</span><a title="org.apache.commons.fileupload.FileItemStream" id="89280">fstm</a>: <span title="org.apache.commons.fileupload.FileItemStream">FileItemStream</span><span class="delimiter">)</span> = <a href="#88981" title="[T](fstm: org.apache.commons.fileupload.FileItemStream)(f: java.io.InputStream =&gt; T)T">withStreamedFile</a><span title="(fstm: org.apache.commons.fileupload.FileItemStream)(f: java.io.InputStream =&gt; String)String" class="delimiter">[</span><span title="String">String</span><span class="delimiter">]</span><span class="delimiter">(</span><a href="#89280" title="org.apache.commons.fileupload.FileItemStream">fstm</a><span class="delimiter">)</span> <span class="delimiter">{</span> <a title="java.io.InputStream" id="89285">stm</a> =&gt;
      <span title="object org.apache.commons.fileupload.util.Streams">Streams</span>.<span title="(x$1: java.io.InputStream)java.lang.String">asString</span><span class="delimiter">(</span><a href="#89285" title="java.io.InputStream">stm</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="comment">/** On-disk  multi-part form data extractor */</span>
  <span class="keyword">object</span> <a title="object unfiltered.request.MultiPartParams.Disk" id="88961">Disk</a> <span title="ScalaObject" class="keyword">extends</span> <a href="#88965" title="unfiltered.request.MultiPartParams.AbstractDisk">AbstractDisk</a> <span class="delimiter">{</span>
    <span class="keyword">import</span> fu.disk.<span class="delimiter">{</span>DiskFileItemFactory<span class="delimiter">}</span>

    <span class="comment">// TODO come up with sensible default</span>
    <span class="keyword">val</span> <a title="Int" id="89426">memLimit</a> = Int.<span title="Int(2147483647)">MaxValue</span>
    <span class="keyword">val</span> <a title="java.io.File" id="89428">tempDir</a> = <span title="java.io.File" class="keyword">new</span> java.io.<span title="java.io.File">File</span><span class="delimiter">(</span><span title="java.lang.String(&quot;.&quot;)" class="string">&quot;.&quot;</span><span class="delimiter">)</span>
    <span class="keyword">def</span> <a title="(writeAfter: Int, writeDir: java.io.File)org.apache.commons.fileupload.disk.DiskFileItemFactory" id="89430">factory</a><span class="delimiter">(</span><a title="Int" id="89442">writeAfter</a>: <span title="Int">Int</span>, <a title="java.io.File" id="89443">writeDir</a>: <span title="java.io.File">JFile</span><span class="delimiter">)</span> = <span title="(x$1: Int, x$2: java.io.File)org.apache.commons.fileupload.disk.DiskFileItemFactory" class="keyword">new</span> <span title="org.apache.commons.fileupload.disk.DiskFileItemFactory">DiskFileItemFactory</span><span class="delimiter">(</span><a href="#89442" title="Int">writeAfter</a>, <a href="#89443" title="java.io.File">writeDir</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/** All in memory multi-part form data extractor.
      This exposes a very specific class of file references
      intended for use in environments such as GAE where writing
      to disk is prohibited.
      */</span>
  <span class="keyword">object</span> <a title="object unfiltered.request.MultiPartParams.Memory" id="88963">Memory</a> <span title="ScalaObject" class="keyword">extends</span> <a href="#88965" title="unfiltered.request.MultiPartParams.AbstractDisk">AbstractDisk</a> <span class="delimiter">{</span>

    <span class="keyword">class</span> <a title="class ByteArrayFileItem extends java.lang.Object with org.apache.commons.fileupload.FileItem with ScalaObject" id="89533">ByteArrayFileItem</a><a href="#89533" title="ScalaObject" class="delimiter">(</a><span class="keyword">var</span> <a title="String" id="89595">fieldName</a>: <span title="String">String</span>,
        <span class="keyword">val</span> <a title="String" id="89596">contentType</a>: <span title="String">String</span>,
     	  <span class="keyword">var</span> <a title="Boolean" id="89597">formField</a>: <span title="Boolean">Boolean</span>,
        <span class="keyword">val</span> <a title="String" id="89598">name</a>: <span title="String">String</span>,
        <span class="keyword">val</span> <a title="Int" id="89599">sizeThreshold</a>: <span title="Int">Int</span><span class="delimiter">)</span> <span class="keyword">extends</span> fu.<span title="org.apache.commons.fileupload.FileItem">FileItem</span> <span class="delimiter">{</span>

        <span class="keyword">import</span> java.io.<span class="delimiter">{</span>InputStream, ByteArrayInputStream,
          OutputStream, ByteArrayOutputStream<span class="delimiter">}</span>

        <span class="keyword">var</span> <a title="Option[Array[Byte]]" id="89565">cache</a>: <span title="Option[Array[Byte]]">Option</span><span class="delimiter">[</span>Array<span class="delimiter">[</span>Byte<span class="delimiter">]</span><span class="delimiter">]</span> = <span title="object None">None</span>
        <span class="keyword">val</span> <a title="java.io.ByteArrayOutputStream" id="89567">out</a> = <span title="java.io.ByteArrayOutputStream" class="keyword">new</span> <span title="java.io.ByteArrayOutputStream">ByteArrayOutputStream</span><span class="delimiter">(</span><span class="delimiter">)</span>
        <span class="keyword">override</span> <span class="keyword">def</span> <a title="()Unit" id="89569">delete</a> <span title="Unit" class="delimiter">{</span><span class="delimiter">}</span>
        <span class="keyword">override</span> <span class="keyword">def</span> <a title="()Array[Byte]" id="89570">get</a> = <a href="#89565" title="=&gt; Option[Array[Byte]]">cache</a> <span title="(default: =&gt; Array[Byte])Array[Byte]">getOrElse</span> <span class="delimiter">{</span>
          <span class="keyword">val</span> <a title="Array[Byte]" id="89609">content</a> = <a href="#89567" title="=&gt; java.io.ByteArrayOutputStream">out</a>.<span title="()Array[Byte]">toByteArray</span>
          <a href="#89565" title="(x$1: Option[Array[Byte]])Unit">cache</a> = <span title="(x: Array[Byte])Some[Array[Byte]]">Some</span><span class="delimiter">(</span><a href="#89609" title="Array[Byte]">content</a><span class="delimiter">)</span>
          <a href="#89609" title="Array[Byte]">content</a>
        <span class="delimiter">}</span>

        <span class="keyword">override</span> <span class="keyword">def</span> <a title="()String" id="89571">getContentType</a> = <a href="#89596" title="=&gt; String">contentType</a>
        <span class="keyword">override</span> <span class="keyword">def</span> <a title="()String" id="89572">getFieldName</a> = <a href="#89595" title="=&gt; String">fieldName</a>
        <span class="keyword">override</span> <span class="keyword">def</span> <a title="()java.io.InputStream" id="89573">getInputStream</a>: <span title="java.io.InputStream">InputStream</span> = <span title="java.io.ByteArrayInputStream" class="keyword">new</span> <span title="java.io.ByteArrayInputStream">ByteArrayInputStream</span><span class="delimiter">(</span><a href="#89570" title="()Array[Byte]">get</a><span class="delimiter">)</span>
        <span class="keyword">override</span> <span class="keyword">def</span> <a title="()String" id="89574">getName</a> = <a href="#89598" title="=&gt; String">name</a>
        <span class="keyword">override</span> <span class="keyword">def</span> <a title="()java.io.ByteArrayOutputStream" id="89575">getOutputStream</a> = <a href="#89567" title="=&gt; java.io.ByteArrayOutputStream">out</a>
        <span class="keyword">override</span> <span class="keyword">def</span> <a title="()Long" id="89576">getSize</a> = <a href="#89570" title="implicit scala.Predef.byteArrayOps : (xs: Array[Byte])scala.collection.mutable.ArrayOps[Byte]">get</a>.<span title="=&gt; Long">size</span>
        <span class="keyword">override</span> <span class="keyword">def</span> <a title="(charset: String)java.lang.String" id="89577">getString</a><span class="delimiter">(</span><a title="String" id="89763">charset</a>: <span title="String">String</span><span class="delimiter">)</span> = <span title="(x$1: Array[Byte], x$2: java.lang.String)java.lang.String" class="keyword">new</span> <span title="java.lang.String">String</span><span class="delimiter">(</span><a href="#89570" title="()Array[Byte]">get</a>, <a href="#89763" title="String">charset</a><span class="delimiter">)</span>
        <span class="keyword">override</span> <span class="keyword">def</span> <a title="()java.lang.String" id="89578">getString</a> = <a href="#89577" title="(charset: String)java.lang.String">getString</a><span class="delimiter">(</span><span title="java.lang.String(&quot;UTF-8&quot;)" class="string">&quot;UTF-8&quot;</span><span class="delimiter">)</span>
        <span class="keyword">override</span> <span class="keyword">def</span> <a title="()Boolean" id="89579">isFormField</a> = <a href="#89597" title="=&gt; Boolean">formField</a>
        <span class="keyword">override</span> <span class="keyword">def</span> <a title="()Boolean" id="89580">isInMemory</a> = <span title="Boolean(true)" class="keyword">true</span>
        <span class="keyword">override</span> <span class="keyword">def</span> <a title="(value: String)Unit" id="89581">setFieldName</a><span class="delimiter">(</span><a title="String" id="89788">value</a>: <span title="String">String</span><span class="delimiter">)</span> <span class="delimiter">{</span> <a href="#89595" title="(x$1: String)Unit">fieldName</a> = <a href="#89788" title="String">value</a> <span class="delimiter">}</span>
        <span class="keyword">override</span> <span class="keyword">def</span> <a title="(state: Boolean)Unit" id="89582">setFormField</a><span class="delimiter">(</span><a title="Boolean" id="89790">state</a>: <span title="Boolean">Boolean</span><span class="delimiter">)</span> <span class="delimiter">{</span> <a href="#89597" title="(x$1: Boolean)Unit">formField</a> = <a href="#89790" title="Boolean">state</a> <span class="delimiter">}</span>
        <span class="keyword">override</span> <span class="keyword">def</span> <a title="(file: java.io.File)Unit" id="89583">write</a><span class="delimiter">(</span><a title="java.io.File" id="89792">file</a>: <span title="java.io.File">JFile</span><span class="delimiter">)</span> <span class="delimiter">{</span> <span title="(message: String)Nothing">error</span><span class="delimiter">(</span><span title="java.lang.String(&quot;File writing is not permitted&quot;)" class="string">&quot;File writing is not permitted&quot;</span><span class="delimiter">)</span> <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <span class="keyword">class</span> <a title="class ByteArrayFileItemFactory extends java.lang.Object with org.apache.commons.fileupload.FileItemFactory with ScalaObject" id="89534">ByteArrayFileItemFactory</a> <a href="#89534" title="ScalaObject" class="keyword">extends</a> fu.<span title="org.apache.commons.fileupload.FileItemFactory">FileItemFactory</span> <span class="delimiter">{</span>
       <span class="keyword">override</span> <span class="keyword">def</span> <a title="(fieldName: String, contentType: String, isFormField: Boolean, fileName: String)unfiltered.request.MultiPartParams.Memory.ByteArrayFileItem" id="89795">createItem</a><span class="delimiter">(</span><a title="String" id="89797">fieldName</a>: <span title="String">String</span> , <a title="String" id="89798">contentType</a>: <span title="String">String</span> ,
    	                      <a title="Boolean" id="89799">isFormField</a>: <span title="Boolean">Boolean</span> , <a title="String" id="89800">fileName</a>: <span title="String">String</span> <span class="delimiter">)</span> = <span title="unfiltered.request.MultiPartParams.Memory.ByteArrayFileItem" class="keyword">new</span> <a href="#89533" title="unfiltered.request.MultiPartParams.Memory.ByteArrayFileItem">ByteArrayFileItem</a><span class="delimiter">(</span>
    	                        <a href="#89797" title="String">fieldName</a>, <a href="#89798" title="String">contentType</a>, <a href="#89799" title="Boolean">isFormField</a>, <a href="#89800" title="String">fileName</a>, Int.<span title="Int(2147483647)">MaxValue</span>
    	                      <span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="keyword">val</span> <a title="Int" id="89535">memLimit</a> = Int.<span title="Int(2147483647)">MaxValue</span>
    <span class="keyword">val</span> <a title="java.io.File" id="89537">tempDir</a> = <span title="java.io.File" class="keyword">new</span> java.io.<span title="java.io.File">File</span><span class="delimiter">(</span><span title="java.lang.String(&quot;.&quot;)" class="string">&quot;.&quot;</span><span class="delimiter">)</span>
    <span class="keyword">def</span> <a title="(writeAfter: Int, writeDir: java.io.File)unfiltered.request.MultiPartParams.Memory.ByteArrayFileItemFactory" id="89539">factory</a><span class="delimiter">(</span><a title="Int" id="89803">writeAfter</a>: <span title="Int">Int</span>, <a title="java.io.File" id="89804">writeDir</a>: <span title="java.io.File">JFile</span><span class="delimiter">)</span> = <span title="unfiltered.request.MultiPartParams.Memory.ByteArrayFileItemFactory" class="keyword">new</span> <a href="#89534" title="unfiltered.request.MultiPartParams.Memory.ByteArrayFileItemFactory">ByteArrayFileItemFactory</a>
  <span class="delimiter">}</span>

  <span class="comment">/** Base trait for disk-based multi part form data extraction */</span>
  <span class="keyword">trait</span> <a title="trait AbstractDisk extends java.lang.Object with ScalaObject" id="88965">AbstractDisk</a> <span title="ScalaObject" class="delimiter">{</span>
    <span class="keyword">import</span> fu.<span class="delimiter">{</span>FileItemFactory, FileItem =&gt; ACFileItem<span class="delimiter">}</span>
    <span class="keyword">import</span> java.util.<span class="delimiter">{</span>Iterator =&gt; JIterator<span class="delimiter">}</span>

    <span class="comment">/** @return the number of bytes to load a file into memory before writing to disk */</span>
    <span class="keyword">def</span> <a title="=&gt; Int" id="89413">memLimit</a>: <span title="Int">Int</span>
    <span class="comment">/** @return the directory to write temp files to */</span>
    <span class="keyword">def</span> <a title="=&gt; java.io.File" id="89414">tempDir</a>: <span title="java.io.File">JFile</span>
    <span class="comment">/** @return a configured FileItemFactory to parse a request */</span>
    <span class="keyword">def</span> <a title="(writeAfter: Int, writeDir: java.io.File)org.apache.commons.fileupload.FileItemFactory" id="89415">factory</a><span class="delimiter">(</span><a title="Int" id="89445">writeAfter</a>: <span title="Int">Int</span>, <a title="java.io.File" id="89446">writeDir</a>: <span title="java.io.File">JFile</span><span class="delimiter">)</span>: <span title="org.apache.commons.fileupload.FileItemFactory">FileItemFactory</span>

    case <span class="keyword">class</span> <a title="class JIteratorWrapper[A] extends java.lang.Object with Iterator[A] with ScalaObject with Product with Serializable" id="89843">JIteratorWrapper</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="89845">A</a><span class="delimiter">]</span><a href="#89843" title="ScalaObject" class="delimiter">(</a><a title="java.util.Iterator[A]" id="90214">i</a>: <span title="java.util.Iterator[A]">JIterator</span><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span> <span class="keyword">extends</span> <span title="Iterator[A]">Iterator</span><span class="delimiter">[</span>A<span class="delimiter">]</span> <span class="delimiter">{</span>
      <span class="keyword">def</span> <a title="=&gt; Boolean" id="89817">hasNext</a>: <span title="Boolean">Boolean</span> = <a href="#90214" title="=&gt; java.util.Iterator[A]">i</a>.<span title="()Boolean">hasNext</span>
      <span class="keyword">def</span> <a title="()A" id="89818">next</a><span class="delimiter">(</span><span class="delimiter">)</span>: <a href="#89845" title="A">A</a> = <a href="#90214" title="=&gt; java.util.Iterator[A]">i</a>.<span title="()A">next</span>
    <span class="delimiter">}</span>

    <span class="comment">/** convert java iterator to scala iterator */</span>
    <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="[A](i: java.util.Iterator[A])AbstractDisk.this.JIteratorWrapper[A]" id="89420">ji2si</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="89422">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="java.util.Iterator[A]" id="89881">i</a> : <span title="java.util.Iterator[A]">JIterator</span><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span> = <span title="AbstractDisk.this.JIteratorWrapper[A]" class="keyword">new</span> <a href="#89843" title="AbstractDisk.this.JIteratorWrapper[A]">JIteratorWrapper</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">(</span><a href="#89881" title="java.util.Iterator[A]">i</a><span class="delimiter">)</span>

    <span class="comment">/**
      Given a req, extract the multipart form params into a (Map[String, Seq[String]], Map[String, Seq[FileItem]], request).
      The Map is assigned a default value of Nil, so param(&quot;p&quot;) would return Nil if there
      is no such parameter, or (as normal for servlets) a single empty string if the
      parameter was supplied without a value. */</span>
    <span class="keyword">def</span> <a title="(req: unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest])unfiltered.request.MultipartData[List[unfiltered.request.DiskFileWrapper]]" id="89423">apply</a><span class="delimiter">(</span><a title="unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest]" id="89886">req</a>: <a href="../../../../unfiltered/unfiltered/unfiltered/request/HttpRequest.scala.html#10254" title="unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest]">HttpRequest</a><span class="delimiter">[</span>HttpServletRequest<span class="delimiter">]</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="java.util.Iterator[org.apache.commons.fileupload.FileItem]" id="89889">items</a> =  <span title="(x$1: org.apache.commons.fileupload.FileItemFactory)org.apache.commons.fileupload.servlet.ServletFileUpload" class="keyword">new</span> <span title="org.apache.commons.fileupload.servlet.ServletFileUpload">ServletFileUpload</span><span class="delimiter">(</span><a href="#89415" title="(writeAfter: Int, writeDir: java.io.File)org.apache.commons.fileupload.FileItemFactory">factory</a><span class="delimiter">(</span><a href="#89413" title="=&gt; Int">memLimit</a>, <a href="#89414" title="=&gt; java.io.File">tempDir</a><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="(x$1: javax.servlet.http.HttpServletRequest)java.util.List[_]">parseRequest</span><span class="delimiter">(</span>
        <a href="#89886" title="unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest]">req</a>.<a href="../../../../unfiltered/unfiltered/unfiltered/request/HttpRequest.scala.html#13021" title="=&gt; javax.servlet.http.HttpServletRequest">underlying</a>
      <span class="delimiter">)</span>.<span title="()java.util.Iterator[?0]">iterator</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="java.util.Iterator[org.apache.commons.fileupload.FileItem]" class="delimiter">[</span><span title="java.util.Iterator[org.apache.commons.fileupload.FileItem]">JIterator</span><span class="delimiter">[</span>ACFileItem<span class="delimiter">]</span><span class="delimiter">]</span>
      <span class="keyword">val</span> <a href="#89891" title="(scala.collection.immutable.Map[String,List[String]], scala.collection.immutable.Map[String,List[unfiltered.request.DiskFileWrapper]])" class="delimiter">(</a><a href="#89890" title="scala.collection.immutable.Map[String,List[String]]" id="89891">params</a>, <a href="#89890" title="scala.collection.immutable.Map[String,List[unfiltered.request.DiskFileWrapper]]" id="89892">files</a><span class="delimiter">)</span> = <a href="#88966" title="[A, B, C](iter: Iterator[C])(f: ((Map[String,List[A]], Map[String,List[B]]), C) =&gt; (Map[String,List[A]], Map[String,List[B]]))(scala.collection.immutable.Map[String,List[A]], scala.collection.immutable.Map[String,List[B]])">genTuple</a><span title="(iter: Iterator[org.apache.commons.fileupload.FileItem])(f: ((Map[String,List[String]], Map[String,List[unfiltered.request.DiskFileWrapper]]), org.apache.commons.fileupload.FileItem) =&gt; (Map[String,List[String]], Map[String,List[unfiltered.request.DiskFileWrapper]]))(scala.collection.immutable.Map[String,List[String]], scala.collection.immutable.Map[String,List[unfiltered.request.DiskFileWrapper]])" class="delimiter">[</span><span title="String">String</span>, <a href="#9714" title="unfiltered.request.DiskFileWrapper">DiskFileWrapper</a>, <span title="org.apache.commons.fileupload.FileItem">ACFileItem</span><span class="delimiter">]</span><span class="delimiter">(</span><a href="#89420" title="(i: java.util.Iterator[org.apache.commons.fileupload.FileItem])AbstractDisk.this.JIteratorWrapper[org.apache.commons.fileupload.FileItem]">items</a><span class="delimiter">)</span> <span title="(scala.collection.immutable.Map[String,List[String]], scala.collection.immutable.Map[String,List[unfiltered.request.DiskFileWrapper]]) @unchecked" class="delimiter">(</span><span class="delimiter">(</span><a title="(Map[String,List[String]], Map[String,List[unfiltered.request.DiskFileWrapper]])" id="89960">maps</a>, <a title="org.apache.commons.fileupload.FileItem" id="89961">item</a><span class="delimiter">)</span> =&gt;
        <span title="(Map[String,List[String]], Map[String,List[unfiltered.request.DiskFileWrapper]])" class="keyword">if</span><span class="delimiter">(</span><a href="#89961" title="org.apache.commons.fileupload.FileItem">item</a>.<span title="()Boolean">isFormField</span><span class="delimiter">)</span> <span title="(_1: scala.collection.immutable.Map[String,List[String]], _2: Map[String,List[unfiltered.request.DiskFileWrapper]])(scala.collection.immutable.Map[String,List[String]], Map[String,List[unfiltered.request.DiskFileWrapper]])" class="delimiter">(</span><a href="#89960" title="(Map[String,List[String]], Map[String,List[unfiltered.request.DiskFileWrapper]])">maps</a>.<span title="=&gt; Map[String,List[String]]">_1</span> <span title="(kv: (String, List[String]))scala.collection.immutable.Map[String,List[String]]">+</span> <span class="delimiter">(</span><a href="#89961" title="org.apache.commons.fileupload.FileItem">item</a>.<span title="(x: java.lang.String)ArrowAssoc[java.lang.String]">getFieldName</span> <span title="(y: List[String])(java.lang.String, List[String])">-&gt;</span> <span class="delimiter">(</span><a href="#89961" title="org.apache.commons.fileupload.FileItem">item</a>.<span title="()java.lang.String">getString</span> <a href="#90051" title="(x: String)List[String]">::</a> <a href="#89960" title="(Map[String,List[String]], Map[String,List[unfiltered.request.DiskFileWrapper]])">maps</a>.<span title="(key: String)List[String]">_1</span><span class="delimiter">(</span><a href="#89961" title="org.apache.commons.fileupload.FileItem">item</a>.<span title="()java.lang.String">getFieldName</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>, <a href="#89960" title="(Map[String,List[String]], Map[String,List[unfiltered.request.DiskFileWrapper]])">maps</a>.<span title="=&gt; Map[String,List[unfiltered.request.DiskFileWrapper]]">_2</span><span class="delimiter">)</span>
        <span class="keyword">else</span> <span title="(_1: Map[String,List[String]], _2: scala.collection.immutable.Map[String,List[unfiltered.request.DiskFileWrapper]])(Map[String,List[String]], scala.collection.immutable.Map[String,List[unfiltered.request.DiskFileWrapper]])" class="delimiter">(</span><a href="#89960" title="(Map[String,List[String]], Map[String,List[unfiltered.request.DiskFileWrapper]])">maps</a>.<span title="=&gt; Map[String,List[String]]">_1</span>, <a href="#89960" title="(Map[String,List[String]], Map[String,List[unfiltered.request.DiskFileWrapper]])">maps</a>.<span title="=&gt; Map[String,List[unfiltered.request.DiskFileWrapper]]">_2</span> <span title="(kv: (String, List[unfiltered.request.DiskFileWrapper]))scala.collection.immutable.Map[String,List[unfiltered.request.DiskFileWrapper]]">+</span> <span class="delimiter">(</span><a href="#89961" title="org.apache.commons.fileupload.FileItem">item</a>.<span title="(x: java.lang.String)ArrowAssoc[java.lang.String]">getFieldName</span> <span title="(y: List[unfiltered.request.DiskFileWrapper])(java.lang.String, List[unfiltered.request.DiskFileWrapper])">-&gt;</span> <span class="delimiter">(</span><span title="unfiltered.request.DiskFileWrapper" class="keyword">new</span> <a href="#9714" title="unfiltered.request.DiskFileWrapper">DiskFileWrapper</a><span class="delimiter">(</span><a href="#89961" title="org.apache.commons.fileupload.FileItem">item</a><span class="delimiter">)</span> <a href="#90163" title="(x: unfiltered.request.DiskFileWrapper)List[unfiltered.request.DiskFileWrapper]">::</a> <a href="#89960" title="(Map[String,List[String]], Map[String,List[unfiltered.request.DiskFileWrapper]])">maps</a>.<span title="(key: String)List[unfiltered.request.DiskFileWrapper]">_2</span><span class="delimiter">(</span><a href="#89961" title="org.apache.commons.fileupload.FileItem">item</a>.<span title="()java.lang.String">getFieldName</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">)</span>
      <a href="#90223" title="(params: String =&gt; Seq[String], files: String =&gt; List[unfiltered.request.DiskFileWrapper])unfiltered.request.MultipartData[List[unfiltered.request.DiskFileWrapper]]">MultipartData</a><span class="delimiter">(</span><a href="#89891" title="scala.collection.immutable.Map[String,List[String]]">params</a>, <a href="#89892" title="scala.collection.immutable.Map[String,List[unfiltered.request.DiskFileWrapper]]">files</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="comment">/** generates a tuple of (Map[String, List[A]], Map[String, List[B]]) */</span>
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="[A, B, C](iter: Iterator[C])(f: ((Map[String,List[A]], Map[String,List[B]]), C) =&gt; (Map[String,List[A]], Map[String,List[B]]))(scala.collection.immutable.Map[String,List[A]], scala.collection.immutable.Map[String,List[B]])" id="88966">genTuple</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="88970">A</a>, <a title="&gt;: Nothing &lt;: Any" id="88971">B</a>, <a title="&gt;: Nothing &lt;: Any" id="88972">C</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="Iterator[C]" id="89902">iter</a>: <span title="Iterator[C]">Iterator</span><span class="delimiter">[</span>C<span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">(</span><a title="((Map[String,List[A]], Map[String,List[B]]), C) =&gt; (Map[String,List[A]], Map[String,List[B]])" id="89903">f</a>: <span class="delimiter">(</span><span class="delimiter">(</span>Map<span class="delimiter">[</span>String, List<span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span>, Map<span class="delimiter">[</span>String, List<span class="delimiter">[</span>B<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span>, C<span class="delimiter">)</span> =&gt; <span class="delimiter">(</span>Map<span class="delimiter">[</span>String, List<span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span>, Map<span class="delimiter">[</span>String, List<span class="delimiter">[</span>B<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">)</span> =
   <span class="delimiter">(</span><span title="(_1: scala.collection.immutable.Map[String,List[A]], _2: scala.collection.immutable.Map[String,List[B]])(scala.collection.immutable.Map[String,List[A]], scala.collection.immutable.Map[String,List[B]])" class="delimiter">(</span><span title="=&gt; scala.collection.immutable.Map.type">Map</span>.<span title="[A, B]=&gt; scala.collection.immutable.Map[A,B]">empty</span><span title="scala.collection.immutable.Map[String,List[A]]" class="delimiter">[</span><span title="String">String</span>, <span title="List[A]">List</span><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span>.<span title="(d: List[A])scala.collection.immutable.Map[String,List[A]]">withDefaultValue</span><span class="delimiter">(</span><span title="object Nil">Nil</span><span class="delimiter">)</span>, <span title="=&gt; scala.collection.immutable.Map.type">Map</span>.<span title="[A, B]=&gt; scala.collection.immutable.Map[A,B]">empty</span><span title="scala.collection.immutable.Map[String,List[B]]" class="delimiter">[</span><span title="String">String</span>, <span title="List[B]">List</span><span class="delimiter">[</span>B<span class="delimiter">]</span><span class="delimiter">]</span>.<span title="(d: List[B])scala.collection.immutable.Map[String,List[B]]">withDefaultValue</span><span class="delimiter">(</span><span title="object Nil">Nil</span><span class="delimiter">)</span><span class="delimiter">)</span> <a href="#89906" title="(z: (scala.collection.immutable.Map[String,List[A]], scala.collection.immutable.Map[String,List[B]]))(op: ((scala.collection.immutable.Map[String,List[A]], scala.collection.immutable.Map[String,List[B]]), C) =&gt; (scala.collection.immutable.Map[String,List[A]], scala.collection.immutable.Map[String,List[B]]))(scala.collection.immutable.Map[String,List[A]], scala.collection.immutable.Map[String,List[B]])">/:</a> <a href="#89902" title="Iterator[C]">iter</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#89903" title="(v1: (Map[String,List[A]], Map[String,List[B]]), v2: C)(Map[String,List[A]], Map[String,List[B]])">f</a><span class="delimiter">(</span><a href="#89945" title="(scala.collection.immutable.Map[String,List[A]], scala.collection.immutable.Map[String,List[B]])">_</a>,<a href="#89946" title="C">_</a><span class="delimiter">)</span><span class="delimiter">)</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>