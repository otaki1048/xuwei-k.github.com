<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>unfiltered/unfiltered/unfiltered/request/params.scala</title>
        <script type="text/javascript" src="../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> unfiltered.request

<span class="keyword">import</span> unfiltered.response.ResponseFunction
<span class="keyword">import</span> scala.util.control.<span title="object scala.util.control.Exception">Exception</span>.allCatch
<span class="keyword">import</span> java.net.URLDecoder

<span class="comment">/** Basic parameter acess, and a pattern matching extractor in Extract. */</span>
<span class="keyword">object</span> <a title="object unfiltered.request.Params" id="10082">Params</a> <span title="ScalaObject" class="delimiter">{</span>
  <span class="keyword">type</span> <a title="scala.collection.Map[String,Seq[String]]" id="38446">Map</a> = scala.collection.<span title="scala.collection.Map[String,Seq[String]]">Map</span><span class="delimiter">[</span>String, Seq<span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">]</span>
  <span class="comment">/**
   * Given a req, extract the request params into a (Map[String, Seq[String]], request).
   * The Map is assigned a default value of Nil, so param(&quot;p&quot;) would return Nil if there
   * is no such parameter, or (as normal for servlets) a single empty string if the
   * parameter was supplied without a value. */</span>
  <span class="keyword">def</span> <a title="[T](req: unfiltered.request.HttpRequest[T])Some[scala.collection.immutable.Map[String,Seq[String]]]" id="38447">unapply</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="38449">T</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="unfiltered.request.HttpRequest[T]" id="40531">req</a>: <a href="HttpRequest.scala.html#9907" title="unfiltered.request.HttpRequest[T]">HttpRequest</a><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Iterator[String]" id="40534">names</a> = <a href="#40531" title="unfiltered.request.HttpRequest[T]">req</a>.<a href="HttpRequest.scala.html#13899" title="=&gt; Iterator[String]">parameterNames</a>
    <span title="(x: scala.collection.immutable.Map[String,Seq[String]])Some[scala.collection.immutable.Map[String,Seq[String]]]">Some</span><span class="delimiter">(</span><span class="delimiter">(</span><span class="delimiter">(</span><span title="=&gt; scala.collection.immutable.Map.type">Map</span>.<span title="[A, B]=&gt; scala.collection.immutable.Map[A,B]">empty</span><span title="scala.collection.immutable.Map[String,Seq[String]]" class="delimiter">[</span><span title="String">String</span>, <span title="Seq[String]">Seq</span><span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">]</span> <a href="#40537" title="(z: scala.collection.immutable.Map[String,Seq[String]])(op: (scala.collection.immutable.Map[String,Seq[String]], String) =&gt; scala.collection.immutable.Map[String,Seq[String]])scala.collection.immutable.Map[String,Seq[String]]">/:</a> <a href="#40534" title="Iterator[String]">names</a><span class="delimiter">)</span> <span class="delimiter">(</span><span class="delimiter">(</span><a title="scala.collection.immutable.Map[String,Seq[String]]" id="40565">m</a>, <a title="String" id="40566">n</a><span class="delimiter">)</span> =&gt;
        <a href="#40565" title="scala.collection.immutable.Map[String,Seq[String]]">m</a> <span title="(kv: (String, Seq[String]))scala.collection.immutable.Map[String,Seq[String]]">+</span> <span class="delimiter">(</span><a href="#40566" title="(x: String)ArrowAssoc[String]">n</a> <span title="(y: Seq[String])(String, Seq[String])">-&gt;</span> <a href="#40531" title="unfiltered.request.HttpRequest[T]">req</a>.<a href="HttpRequest.scala.html#13900" title="(param: String)Seq[String]">parameterValues</a><span class="delimiter">(</span><a href="#40566" title="String">n</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">)</span><span class="delimiter">)</span>.<span title="(d: Seq[String])scala.collection.immutable.Map[String,Seq[String]]">withDefaultValue</span><span class="delimiter">(</span><span title="object Nil">Nil</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * A function Seq[String] =&gt; Option[B]  used to test and transform values
   * from the parameter map. Conditions may be chained with `~&gt;` */</span>
  <span class="keyword">class</span> <a title="class ParamMapper[B] extends java.lang.Object with Seq[String] =&gt; Option[B] with ScalaObject" id="38450">ParamMapper</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="38451">B</a><span class="delimiter">]</span><a href="#38450" title="ScalaObject" class="delimiter">(</a><a title="Seq[String] =&gt; Option[B]" id="39530">f</a>: Seq<span class="delimiter">[</span>String<span class="delimiter">]</span> =&gt; Option<span class="delimiter">[</span>B<span class="delimiter">]</span><span class="delimiter">)</span> <span class="keyword">extends</span> <span class="delimiter">(</span>Seq<span class="delimiter">[</span>String<span class="delimiter">]</span> =&gt; Option<span class="delimiter">[</span>B<span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="(a: Seq[String])Option[B]" id="39525">apply</a><span class="delimiter">(</span><a title="Seq[String]" id="88412">a</a>: <span title="Seq[String]">Seq</span><span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">)</span> = <a href="#39530" title="(v1: Seq[String])Option[B]">f</a><span class="delimiter">(</span><a href="#88412" title="Seq[String]">a</a><span class="delimiter">)</span>
    <span class="keyword">def</span> <a title="[C](that: Option[B] =&gt; Option[C])unfiltered.request.Params.ParamMapper[C]" id="39526">~&gt;</a> <span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="39528">C</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="Option[B] =&gt; Option[C]" id="88417">that</a>: Option<span class="delimiter">[</span>B<span class="delimiter">]</span> =&gt; Option<span class="delimiter">[</span>C<span class="delimiter">]</span><span class="delimiter">)</span> = <span title="unfiltered.request.Params.ParamMapper[C]" class="keyword">new</span> <a href="#38450" title="unfiltered.request.Params.ParamMapper[C]">ParamMapper</a><span class="delimiter">(</span><span class="delimiter">{</span> <a href="#39530" title="Seq[String] =&gt; Option[B]">f</a> <span title="(g: Option[B] =&gt; Option[C])Seq[String] =&gt; Option[C]">andThen</span> <a href="#88417" title="Option[B] =&gt; Option[C]">that</a> <span class="delimiter">}</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/** Maps first parameter, if present. */</span>
  <span class="keyword">val</span> <a title="unfiltered.request.Params.ParamMapper[String]" id="38452">first</a> = <span title="unfiltered.request.Params.ParamMapper[String]" class="keyword">new</span> <a href="#38450" title="unfiltered.request.Params.ParamMapper[String]">ParamMapper</a><span class="delimiter">(</span><a href="#39533" title="Seq[String]">_</a>.<span title="=&gt; Option[String]">headOption</span><span class="delimiter">)</span>

  <span class="comment">/**
   * Base class for parameter extractor objects, may be extended inline with
   * chained ParamMapper objects. */</span>
  <span class="keyword">class</span> <a title="class Extract[E, T] extends java.lang.Object with ScalaObject" id="38454">Extract</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="38455">E</a>,<a title="&gt;: Nothing &lt;: Any" id="38456">T</a><span class="delimiter">]</span><a href="#38454" title="ScalaObject" class="delimiter">(</a><a title="unfiltered.request.Params.Map =&gt; Option[T]" id="38486">f</a>: Map =&gt; Option<span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="(name: String, f: Seq[String] =&gt; Option[T])unfiltered.request.Params.Extract[E,T]" id="38476" class="keyword">this</a><span class="delimiter">(</span><a title="String" id="38482">name</a>: <span title="String">String</span>, <a title="Seq[String] =&gt; Option[T]" id="38483">f</a>: Seq<span class="delimiter">[</span>String<span class="delimiter">]</span> =&gt; Option<span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">)</span> =
      <a href="#38454" title="Extract.this.type" class="keyword">this</a><span class="delimiter">(</span><span class="delimiter">{</span> params: <span title="unfiltered.request.Params.Map">Map</span> =&gt; <a href="#38483" title="(v1: Seq[String])Option[T]">f</a><span class="delimiter">(</span><a href="#88440" title="(key: String)Seq[String]">params</a><span class="delimiter">(</span><a href="#38482" title="String">name</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">}</span><span class="delimiter">)</span>
    <span class="keyword">def</span> <a title="(params: unfiltered.request.Params.Map)Option[T]" id="38477">unapply</a><span class="delimiter">(</span><a title="unfiltered.request.Params.Map" id="40996">params</a>: <span title="unfiltered.request.Params.Map">Map</span><span class="delimiter">)</span> = <a href="#38486" title="(v1: unfiltered.request.Params.Map)Option[T]">f</a><span class="delimiter">(</span><a href="#40996" title="unfiltered.request.Params.Map">params</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>
  <span class="comment">/** Construct a parameter predicate */</span>
  <span class="keyword">def</span> <a title="[E, A](p: A =&gt; Boolean)Option[A] =&gt; Option[A]" id="38457">pred</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="38460">E</a>,<a title="&gt;: Nothing &lt;: Any" id="38461">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="A =&gt; Boolean" id="62549">p</a>: A =&gt; Boolean<span class="delimiter">)</span>: Option<span class="delimiter">[</span>A<span class="delimiter">]</span> =&gt; Option<span class="delimiter">[</span>A<span class="delimiter">]</span> =
    <a title="Option[A]" id="88468">opt</a> =&gt; <a href="#88468" title="Option[A]">opt</a> <span title="(p: A =&gt; Boolean)Option[A]">filter</span> <a href="#62549" title="A =&gt; Boolean">p</a>

  <span class="keyword">def</span> <a title="(os: Option[String])Option[Int]" id="38462">int</a><span class="delimiter">(</span><a title="Option[String]" id="88470">os</a>: <span title="Option[String]">Option</span><span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">)</span> =
    <a href="#88470" title="Option[String]">os</a>.<span title="(f: String =&gt; Option[Int])Option[Int]">flatMap</span> <span class="delimiter">{</span> <a title="String" id="88477">s</a> =&gt; <span title="util.control.Exception.Catch[Nothing]">allCatch</span>.<span title="(body: =&gt; Int)Option[Int]">opt</span> <span class="delimiter">{</span> <a href="#88477" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">s</a>.<span title="=&gt; Int">toInt</span> <span class="delimiter">}</span> <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(os: Option[String])Option[Long]" id="38463">long</a><span class="delimiter">(</span><a title="Option[String]" id="88490">os</a>: <span title="Option[String]">Option</span><span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">)</span> =
    <a href="#88490" title="Option[String]">os</a>.<span title="(f: String =&gt; Option[Long])Option[Long]">flatMap</span> <span class="delimiter">{</span> <a title="String" id="88497">s</a> =&gt; <span title="util.control.Exception.Catch[Nothing]">allCatch</span>.<span title="(body: =&gt; Long)Option[Long]">opt</span> <span class="delimiter">{</span> <a href="#88497" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">s</a>.<span title="=&gt; Long">toLong</span> <span class="delimiter">}</span> <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(os: Option[String])Option[Float]" id="38464">float</a><span class="delimiter">(</span><a title="Option[String]" id="88510">os</a>: <span title="Option[String]">Option</span><span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">)</span> =
    <a href="#88510" title="Option[String]">os</a>.<span title="(f: String =&gt; Option[Float])Option[Float]">flatMap</span> <span class="delimiter">{</span> <a title="String" id="88517">s</a> =&gt; <span title="util.control.Exception.Catch[Nothing]">allCatch</span>.<span title="(body: =&gt; Float)Option[Float]">opt</span> <span class="delimiter">{</span> <a href="#88517" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">s</a>.<span title="=&gt; Float">toFloat</span> <span class="delimiter">}</span> <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(os: Option[String])Option[Double]" id="38465">double</a><span class="delimiter">(</span><a title="Option[String]" id="88532">os</a>: <span title="Option[String]">Option</span><span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">)</span> =
    <a href="#88532" title="Option[String]">os</a>.<span title="(f: String =&gt; Option[Double])Option[Double]">flatMap</span> <span class="delimiter">{</span> <a title="String" id="88539">s</a> =&gt; <span title="util.control.Exception.Catch[Nothing]">allCatch</span>.<span title="(body: =&gt; Double)Option[Double]">opt</span> <span class="delimiter">{</span> <a href="#88539" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">s</a>.<span title="=&gt; Double">toDouble</span> <span class="delimiter">}</span> <span class="delimiter">}</span>

  <span class="keyword">val</span> <a title="Option[Int] =&gt; Option[Int]" id="38466">even</a> = <a href="#38457" title="(p: Int =&gt; Boolean)Option[Int] =&gt; Option[Int]">pred</a> <span class="delimiter">{</span> <span class="delimiter">(</span><a href="#88384" title="Int">_</a>:<span title="Int">Int</span><span class="delimiter">)</span> <span title="(x: Int)Int">%</span> <span title="Int(2)" class="int">2</span> <span title="(x: Int)Boolean">==</span> <span title="Int(0)" class="int">0</span> <span class="delimiter">}</span>
  <span class="keyword">val</span> <a title="Option[Int] =&gt; Option[Int]" id="38468">odd</a> = <a href="#38457" title="(p: Int =&gt; Boolean)Option[Int] =&gt; Option[Int]">pred</a> <span class="delimiter">{</span> <span class="delimiter">(</span><a href="#88399" title="Int">_</a>:<span title="Int">Int</span><span class="delimiter">)</span> <span title="(x: Int)Int">%</span> <span title="Int(2)" class="int">2</span> <span title="(x: Int)Boolean">==</span> <span title="Int(1)" class="int">1</span> <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(s: Option[String])Option[java.lang.String]" id="38470">trimmed</a><span class="delimiter">(</span><a title="Option[String]" id="88552">s</a>: <span title="Option[String]">Option</span><span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">)</span> = <a href="#88552" title="Option[String]">s</a> <span title="(f: String =&gt; java.lang.String)Option[java.lang.String]">map</span> <span class="delimiter">{</span> <a href="#88559" title="String">_</a>.<span title="()java.lang.String">trim</span> <span class="delimiter">}</span>
  <span class="keyword">val</span> <a title="Option[String] =&gt; Option[String]" id="38471">nonempty</a> = <a href="#38457" title="(p: String =&gt; Boolean)Option[String] =&gt; Option[String]">pred</a> <span class="delimiter">{</span> <span title="=&gt; Boolean">!</span><span class="delimiter">(</span><a href="#62556" title="String">_</a>:<span title="String">String</span><span class="delimiter">)</span>.<span title="()Boolean">isEmpty</span> <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="comment">/** Basic query parameter acess. */</span>
<span class="keyword">object</span> <a title="object unfiltered.request.QueryParams" id="10211">QueryParams</a> <span title="ScalaObject" class="delimiter">{</span>
  
  <span class="comment">/**
   * Given a req, extract the request query params into a (Map[String, Seq[String]], request).
   * The Map is assigned a default value of Nil, so param(&quot;p&quot;) would return Nil if there
   * is no such parameter, or (as normal for servlets) a single empty string if the
   * parameter was supplied without a value. */</span>
  <span class="keyword">def</span> <a title="[T](req: unfiltered.request.HttpRequest[T])Some[Map[String,Seq[String]]]" id="88562">unapply</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="88564">T</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="unfiltered.request.HttpRequest[T]" id="88567">req</a>: <a href="HttpRequest.scala.html#9907" title="unfiltered.request.HttpRequest[T]">HttpRequest</a><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">)</span> = <span title="(x: Map[String,Seq[String]])Some[Map[String,Seq[String]]]">Some</span><span class="delimiter">(</span><a href="#88565" title="(enc: String)Map[String,Seq[String]]">urldecode</a><span class="delimiter">(</span><a href="#88567" title="unfiltered.request.HttpRequest[T]">req</a>.<a href="HttpRequest.scala.html#13898" title="=&gt; String">uri</a><span class="delimiter">)</span><span class="delimiter">)</span>
  
  <span class="keyword">def</span> <a title="(enc: String)Map[String,Seq[String]]" id="88565">urldecode</a><span class="delimiter">(</span><a title="String" id="88572">enc</a>: <span title="String">String</span><span class="delimiter">)</span> : <span title="Map[String,Seq[String]]">Map</span><span class="delimiter">[</span>String, Seq<span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="(raw: String)java.lang.String" id="88576">decode</a><span class="delimiter">(</span><a title="String" id="88579">raw</a>: <span title="String">String</span><span class="delimiter">)</span> = <span title="object java.net.URLDecoder">URLDecoder</span>.<span title="(x$1: java.lang.String, x$2: java.lang.String)java.lang.String">decode</span><span class="delimiter">(</span><a href="#88579" title="String">raw</a>, <span title="java.lang.String(&quot;UTF-8&quot;)" class="string">&quot;UTF-8&quot;</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="String" id="88577">params</a> = <a href="#88572" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">enc</a>.<span title="(p: Char =&gt; Boolean)String">dropWhile</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="delimiter">(</span><span title="Char(\'?\')" class="char">'?'</span><a href="#88790" title="(x: Char)Boolean">!=</a><span class="delimiter">)</span>.<span title="(p: Char =&gt; Boolean)String">dropWhile</span><span class="delimiter">(</span><span title="Char(\'?\')" class="char">'?'</span><a href="#88889" title="(x: Char)Boolean">==</a><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="Seq[(String, String)]" id="88578">pairs</a>: <span title="Seq[(String, String)]">Seq</span><span class="delimiter">[</span><span class="delimiter">(</span>String,String<span class="delimiter">)</span><span class="delimiter">]</span> = <a href="#88577" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">params</a>.<span title="(separator: Char)Array[String]">split</span><span title="(xs: Array[String])scala.collection.mutable.ArrayOps[String]" class="delimiter">(</span><span title="Char(\'&amp;\')" class="char">'&amp;'</span><span class="delimiter">)</span>.<span title="(f: String =&gt; scala.collection.GenTraversableOnce[(java.lang.String, java.lang.String)])(implicit bf: scala.collection.generic.CanBuildFrom[Array[String],(java.lang.String, java.lang.String),Seq[(String, String)]])Seq[(String, String)]">flatMap</span> <span title="(implicit m: DummyImplicit)scala.collection.generic.CanBuildFrom[Array[_],(java.lang.String, java.lang.String),scala.collection.mutable.ArraySeq[(java.lang.String, java.lang.String)]]" class="delimiter">{</span>
      <a href="#89372" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">_</a>.<span title="(separator: Char)Array[String]">split</span><span class="delimiter">(</span><span title="Char(\'=\')" class="char">'='</span><span class="delimiter">)</span> <span title="List[(java.lang.String, java.lang.String)]" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <a href="#89396" title="List[(java.lang.String, java.lang.String)]">Array</a><span class="delimiter">(</span><a title="String" id="89402">key</a>, <a title="String" id="89403">value</a><span class="delimiter">)</span> =&gt; <span title="(xs: (java.lang.String, java.lang.String)*)List[(java.lang.String, java.lang.String)]">List</span><span class="delimiter">(</span><span title="(_1: java.lang.String, _2: java.lang.String)(java.lang.String, java.lang.String)" class="delimiter">(</span><a href="#88576" title="(raw: String)java.lang.String">decode</a><span class="delimiter">(</span><a href="#89402" title="String">key</a><span class="delimiter">)</span>, <a href="#88576" title="(raw: String)java.lang.String">decode</a><span class="delimiter">(</span><a href="#89403" title="String">value</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="keyword">case</span> <a href="#89417" title="List[(java.lang.String, java.lang.String)]">Array</a><span class="delimiter">(</span><a title="String" id="89423">key</a><span class="delimiter">)</span> <span class="keyword">if</span> <a href="#89423" title="String">key</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span> =&gt; <span title="(xs: (java.lang.String, java.lang.String)*)List[(java.lang.String, java.lang.String)]">List</span><span class="delimiter">(</span><span title="(_1: java.lang.String, _2: java.lang.String)(java.lang.String, java.lang.String)" class="delimiter">(</span><a href="#88576" title="(raw: String)java.lang.String">decode</a><span class="delimiter">(</span><a href="#89423" title="String">key</a><span class="delimiter">)</span>, <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="keyword">case</span> <span title="scala.collection.immutable.Nil.type">_</span> =&gt; <span title="object Nil">Nil</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
    <a href="#88578" title="Seq[(String, String)]">pairs</a>.<span title="(f: (String, String) =&gt; String)scala.collection.immutable.Map[String,Seq[(String, String)]]">groupBy</span><span class="delimiter">(</span><a href="#89470" title="(String, String)">_</a>.<span title="=&gt; String">_1</span><span class="delimiter">)</span>.<span title="(f: (String, Seq[(String, String)]) =&gt; (String, Seq[String]))(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.Map[String,Seq[(String, String)]],(String, Seq[String]),scala.collection.immutable.Map[String,Seq[String]]])scala.collection.immutable.Map[String,Seq[String]]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.Map.Coll,(String, Seq[String]),scala.collection.immutable.Map[String,Seq[String]]]" class="delimiter">(</span><a title="(String, Seq[(String, String)])" id="89501">t</a> =&gt; <span title="(_1: String, _2: Seq[String])(String, Seq[String])" class="delimiter">(</span><a href="#89501" title="(String, Seq[(String, String)])">t</a>.<span title="=&gt; String">_1</span>, <a href="#89501" title="(String, Seq[(String, String)])">t</a>.<span title="=&gt; Seq[(String, String)]">_2</span>.<span title="(f: (String, String) =&gt; String)(implicit bf: scala.collection.generic.CanBuildFrom[Seq[(String, String)],String,Seq[String]])Seq[String]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.Seq.Coll,String,Seq[String]]" class="delimiter">(</span><a href="#89522" title="(String, String)">_</a>.<span title="=&gt; String">_2</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="(implicit ev: &lt;:&lt;[(String, Seq[String]),(String, Seq[String])])scala.collection.immutable.Map[String,Seq[String]]">toMap</span>.<span title="(d: String =&gt; Seq[String])scala.collection.immutable.Map[String,Seq[String]]">withDefault</span> <span class="delimiter">{</span> <a title="String" id="89614">_</a> =&gt; <span title="object Nil">Nil</span> <span class="delimiter">}</span>
  <span class="delimiter">}</span>
  
<span class="delimiter">}</span>

<span class="comment">/** Fined-grained error reporting for arbitrarily many failing parameters.
 * Import QParams._ to use; see ParamsSpec for examples. */</span>
<span class="keyword">object</span> <a title="object unfiltered.request.QParams" id="10184">QParams</a> <span title="ScalaObject" class="delimiter">{</span>
  <span class="keyword">type</span> <a title="[E]List[unfiltered.request.QParams.Fail[E]]" id="62196">Log</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="62197">E</a><span class="delimiter">]</span> = <span title="List[unfiltered.request.QParams.Fail[E]]">List</span><span class="delimiter">[</span>Fail<span class="delimiter">[</span>E<span class="delimiter">]</span><span class="delimiter">]</span>
  <span class="keyword">type</span> <a title="[E, A](unfiltered.request.Params.Map, Option[String], unfiltered.request.QParams.Log[E]) =&gt; (Option[String], unfiltered.request.QParams.Log[E], A)" id="62198">QueryFn</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="62199">E</a>,<a title="&gt;: Nothing &lt;: Any" id="62200">A</a><span class="delimiter">]</span> = <span class="delimiter">(</span>Params.Map, Option<span class="delimiter">[</span>String<span class="delimiter">]</span>, Log<span class="delimiter">[</span>E<span class="delimiter">]</span><span class="delimiter">)</span> =&gt;
    <span class="delimiter">(</span>Option<span class="delimiter">[</span>String<span class="delimiter">]</span>, Log<span class="delimiter">[</span>E<span class="delimiter">]</span>, A<span class="delimiter">)</span>
  <span class="keyword">type</span> <a title="[E, A]Either[unfiltered.request.QParams.Log[E],A]" id="62201">QueryResult</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="62202">E</a>,<a title="&gt;: Nothing &lt;: Any" id="62203">A</a><span class="delimiter">]</span> = <span title="Either[unfiltered.request.QParams.Log[E],A]">Either</span><span class="delimiter">[</span>Log<span class="delimiter">[</span>E<span class="delimiter">]</span>, A<span class="delimiter">]</span>
  <span class="comment">/** Left if the query has failed, right if it has not (but may be empty) */</span>
  <span class="keyword">type</span> <a title="[E, A]Either[E,Option[A]]" id="62204">Report</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="62205">E</a>,<a title="&gt;: Nothing &lt;: Any" id="62206">A</a><span class="delimiter">]</span> = <span title="Either[E,Option[A]]">Either</span><span class="delimiter">[</span>E,Option<span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span>
  <span class="keyword">type</span> <a title="[E, A, B]Option[A] =&gt; unfiltered.request.QParams.Report[E,B]" id="62207">Reporter</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="62208">E</a>,<a title="&gt;: Nothing &lt;: Any" id="62209">A</a>,<a title="&gt;: Nothing &lt;: Any" id="62210">B</a><span class="delimiter">]</span> = Option<span class="delimiter">[</span>A<span class="delimiter">]</span> =&gt; Report<span class="delimiter">[</span>E,B<span class="delimiter">]</span>

  case <span class="keyword">class</span> <a title="class Fail[E] extends java.lang.Object with ScalaObject with Product with Serializable" id="90234">Fail</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="63156">E</a><span class="delimiter">]</span><a href="#90234" title="ScalaObject" class="delimiter">(</a><a title="String" id="89931">name</a>: <span title="String">String</span>, <a title="E" id="89932">error</a>: <a href="#63156" title="E">E</a><span class="delimiter">)</span>

  <span class="comment">/* Implicitly provide 'orFail' for QueryResult (either) type. */</span>
  case <span class="keyword">class</span> <a title="class QueryResultX[E, A] extends java.lang.Object with ScalaObject with Product with Serializable" id="90228">QueryResultX</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="89709">E</a>,<a title="&gt;: Nothing &lt;: Any" id="89710">A</a><span class="delimiter">]</span><a href="#90228" title="ScalaObject" class="delimiter">(</a><a title="unfiltered.request.QParams.QueryResult[E,A]" id="89748">r</a>: <span title="unfiltered.request.QParams.QueryResult[E,A]">QueryResult</span><span class="delimiter">[</span>E,A<span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="[B &gt;: A](handler: unfiltered.request.QParams.Log[E] =&gt; B)B" id="62989">orFail</a><span class="delimiter">[</span><a title="&gt;: A &lt;: Any" id="62991">B</a> &gt;: A<span class="delimiter">]</span><span class="delimiter">(</span><a title="unfiltered.request.QParams.Log[E] =&gt; B" id="62999">handler</a>: Log<span class="delimiter">[</span>E<span class="delimiter">]</span> =&gt; B<span class="delimiter">)</span> =
      <a href="#89748" title="=&gt; unfiltered.request.QParams.QueryResult[E,A]">r</a>.<span title="=&gt; Either.LeftProjection[unfiltered.request.QParams.Log[E],A]">left</span>.<span title="(f: unfiltered.request.QParams.Log[E] =&gt; B)Product with Either[B,A] with Serializable">map</span><span class="delimiter">(</span><a href="#62999" title="unfiltered.request.QParams.Log[E] =&gt; B">handler</a><span class="delimiter">)</span> <span title="B" class="keyword">match</span> <span class="delimiter">{</span> <span class="comment">// i.e. .merge, in 2.8</span>
        <span class="keyword">case</span> <span title="B">Left</span><span class="delimiter">(</span><a title="B" id="63049">v</a><span class="delimiter">)</span> =&gt; <a href="#63049" title="B">v</a>
        <span class="keyword">case</span> <span title="A">Right</span><span class="delimiter">(</span><a title="A" id="63087">v</a><span class="delimiter">)</span> =&gt; <a href="#63087" title="A">v</a>
      <span class="delimiter">}</span>
  <span class="delimiter">}</span>
  <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="[E, A](r: unfiltered.request.QParams.QueryResult[E,A])unfiltered.request.QParams.QueryResultX[E,A]" id="62220">queryOrElse</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="62223">E</a>,<a title="&gt;: Nothing &lt;: Any" id="62224">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="unfiltered.request.QParams.QueryResult[E,A]" id="62312">r</a>: <span title="unfiltered.request.QParams.QueryResult[E,A]">QueryResult</span><span class="delimiter">[</span>E,A<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#90228" title="unfiltered.request.QParams.QueryResultX[E,A]">QueryResultX</a><span class="delimiter">[</span>E,A<span class="delimiter">]</span> =
    <a href="#90228" title="(r: unfiltered.request.QParams.QueryResult[E,A])unfiltered.request.QParams.QueryResultX[E,A]">QueryResultX</a><span class="delimiter">(</span><a href="#62312" title="unfiltered.request.QParams.QueryResult[E,A]">r</a><span class="delimiter">)</span>

  <span class="comment">/* The query-building monad, a variant of state-transformer. */</span>
  case <span class="keyword">class</span> <a title="class QueryM[E, A] extends java.lang.Object with ScalaObject with Product with Serializable" id="90223">QueryM</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="89763">E</a>,<a title="&gt;: Nothing &lt;: Any" id="89764">A</a><span class="delimiter">]</span><a href="#90223" title="ScalaObject" class="delimiter">(</a><a title="(unfiltered.request.Params.Map, Option[String], unfiltered.request.QParams.Log[E]) =&gt; (Option[String], unfiltered.request.QParams.Log[E], A)" id="89770">exec</a>: <span title="(unfiltered.request.Params.Map, Option[String], unfiltered.request.QParams.Log[E]) =&gt; (Option[String], unfiltered.request.QParams.Log[E], A)">QueryFn</span><span class="delimiter">[</span>E,A<span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="[B](f: A =&gt; unfiltered.request.QParams.QueryM[E,B])unfiltered.request.QParams.QueryM[E,B]" id="62512">flatMap</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="62514">B</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="A =&gt; unfiltered.request.QParams.QueryM[E,B]" id="62579">f</a>: A =&gt; QueryM<span class="delimiter">[</span>E,B<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#90223" title="unfiltered.request.QParams.QueryM[E,B]">QueryM</a><span class="delimiter">[</span>E,B<span class="delimiter">]</span> =
      <a href="#90223" title="(exec: (unfiltered.request.Params.Map, Option[String], unfiltered.request.QParams.Log[E]) =&gt; (Option[String], unfiltered.request.QParams.Log[E], B))unfiltered.request.QParams.QueryM[E,B]">QueryM</a> <span class="delimiter">{</span>
        <span class="delimiter">(</span><a title="unfiltered.request.Params.Map" id="89777">params</a>, <a title="Option[String]" id="89778">key0</a>, <a title="unfiltered.request.QParams.Log[E]" id="89779">log0</a><span class="delimiter">)</span> =&gt;
          <span class="keyword">val</span> <a href="#89781" title="(Option[String], unfiltered.request.QParams.Log[E], A)" class="delimiter">(</a><a href="#89780" title="Option[String]" id="89781">key1</a>, <a href="#89780" title="unfiltered.request.QParams.Log[E]" id="89782">log1</a>, <a href="#89780" title="A" id="89783">value</a><span class="delimiter">)</span> = <a href="#89770" title="(v1: unfiltered.request.Params.Map, v2: Option[String], v3: unfiltered.request.QParams.Log[E])(Option[String], unfiltered.request.QParams.Log[E], A)">exec</a><span title="(Option[String], unfiltered.request.QParams.Log[E], A) @unchecked" class="delimiter">(</span><a href="#89777" title="unfiltered.request.Params.Map">params</a>, <a href="#89778" title="Option[String]">key0</a>, <a href="#89779" title="unfiltered.request.QParams.Log[E]">log0</a><span class="delimiter">)</span>
          <a href="#62579" title="(v1: A)unfiltered.request.QParams.QueryM[E,B]">f</a><span class="delimiter">(</span><a href="#89783" title="A">value</a><span class="delimiter">)</span>.<a href="#89770" title="(v1: unfiltered.request.Params.Map, v2: Option[String], v3: unfiltered.request.QParams.Log[E])(Option[String], unfiltered.request.QParams.Log[E], B)">exec</a><span class="delimiter">(</span><a href="#89777" title="unfiltered.request.Params.Map">params</a>, <a href="#89781" title="Option[String]">key1</a>, <a href="#89782" title="unfiltered.request.QParams.Log[E]">log1</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>

    <span class="comment">/* Compose monads, ignoring value of this. */</span>
    <span class="keyword">def</span> <a title="[B](that: unfiltered.request.QParams.QueryM[E,B])unfiltered.request.QParams.QueryM[E,B]" id="62515">andThen</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="62517">B</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="unfiltered.request.QParams.QueryM[E,B]" id="89825">that</a>: <a href="#90223" title="unfiltered.request.QParams.QueryM[E,B]">QueryM</a><span class="delimiter">[</span>E,B<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#90223" title="unfiltered.request.QParams.QueryM[E,B]">QueryM</a><span class="delimiter">[</span>E,B<span class="delimiter">]</span> =
      <a href="#62512" title="(f: A =&gt; unfiltered.request.QParams.QueryM[E,B])unfiltered.request.QParams.QueryM[E,B]">flatMap</a><span class="delimiter">(</span><a title="A" id="89831">_</a> =&gt; <a href="#89825" title="unfiltered.request.QParams.QueryM[E,B]">that</a><span class="delimiter">)</span>

    <span class="comment">/* This map is not defined as flatMap(unit(f(_))), as expected.
       If any errors have been accumulated, it does NOT run the
       query function. */</span>
    <span class="keyword">def</span> <a title="[B](f: A =&gt; B)unfiltered.request.QParams.QueryM[E,unfiltered.request.QParams.QueryResult[E,B]]" id="62518">map</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="62520">B</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="A =&gt; B" id="62743">f</a>: A =&gt; B<span class="delimiter">)</span>: <a href="#90223" title="unfiltered.request.QParams.QueryM[E,unfiltered.request.QParams.QueryResult[E,B]]">QueryM</a><span class="delimiter">[</span>E,QueryResult<span class="delimiter">[</span>E,B<span class="delimiter">]</span><span class="delimiter">]</span> =
      <a href="#90223" title="(exec: (unfiltered.request.Params.Map, Option[String], unfiltered.request.QParams.Log[E]) =&gt; (Option[String], unfiltered.request.QParams.Log[E], unfiltered.request.QParams.QueryResult[E,B]))unfiltered.request.QParams.QueryM[E,unfiltered.request.QParams.QueryResult[E,B]]">QueryM</a> <span class="delimiter">{</span>
        <span class="delimiter">(</span><a title="unfiltered.request.Params.Map" id="89837">params</a>, <a title="Option[String]" id="89838">key0</a>, <a title="unfiltered.request.QParams.Log[E]" id="89839">log0</a><span class="delimiter">)</span> =&gt;
          <span class="keyword">val</span> <a href="#89841" title="(Option[String], unfiltered.request.QParams.Log[E], A)" class="delimiter">(</a><a href="#89840" title="Option[String]" id="89841">key1</a>, <a href="#89840" title="unfiltered.request.QParams.Log[E]" id="89842">log1</a>, <a href="#89840" title="A" id="89843">value</a><span class="delimiter">)</span> = <a href="#89770" title="(v1: unfiltered.request.Params.Map, v2: Option[String], v3: unfiltered.request.QParams.Log[E])(Option[String], unfiltered.request.QParams.Log[E], A)">exec</a><span title="(Option[String], unfiltered.request.QParams.Log[E], A) @unchecked" class="delimiter">(</span><a href="#89837" title="unfiltered.request.Params.Map">params</a>, <a href="#89838" title="Option[String]">key0</a>, <a href="#89839" title="unfiltered.request.QParams.Log[E]">log0</a><span class="delimiter">)</span>
          <span title="(_1: Option[String], _2: unfiltered.request.QParams.Log[E], _3: unfiltered.request.QParams.QueryResult[E,B])(Option[String], unfiltered.request.QParams.Log[E], unfiltered.request.QParams.QueryResult[E,B])" class="delimiter">(</span><a href="#89841" title="Option[String]">key1</a>, <a href="#89842" title="unfiltered.request.QParams.Log[E]">log1</a>, <a href="#89842" title="unfiltered.request.QParams.Log[E]">log1</a> <span title="unfiltered.request.QParams.QueryResult[E,B]" class="keyword">match</span> <span class="delimiter">{</span>
            <span class="keyword">case</span> <span title="Right[Nothing,B]">Nil</span> =&gt; <span title="(b: B)Right[Nothing,B]">Right</span><span class="delimiter">(</span><a href="#62743" title="(v1: A)B">f</a><span class="delimiter">(</span><a href="#89843" title="A">value</a><span class="delimiter">)</span><span class="delimiter">)</span>
            <span class="keyword">case</span> <span title="Left[List[unfiltered.request.QParams.Fail[E]],Nothing]">_</span> =&gt; <span title="(a: List[unfiltered.request.QParams.Fail[E]])Left[List[unfiltered.request.QParams.Fail[E]],Nothing]">Left</span><span class="delimiter">(</span><a href="#89842" title="unfiltered.request.QParams.Log[E]">log1</a>.<span title="=&gt; List[unfiltered.request.QParams.Fail[E]]">reverse</span><span class="delimiter">)</span>
          <span class="delimiter">}</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>

    <span class="comment">/* Combinator for filtering the value and tagging errors. */</span>
    <span class="keyword">def</span> <a title="[B](f: A =&gt; unfiltered.request.QParams.Report[E,B])unfiltered.request.QParams.QueryM[E,Option[B]]" id="62521">is</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="62523">B</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="A =&gt; unfiltered.request.QParams.Report[E,B]" id="62530">f</a>: A =&gt; Report<span class="delimiter">[</span>E,B<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#90223" title="unfiltered.request.QParams.QueryM[E,Option[B]]">QueryM</a><span class="delimiter">[</span>E,Option<span class="delimiter">[</span>B<span class="delimiter">]</span><span class="delimiter">]</span> =
      <a href="#90223" title="(exec: (unfiltered.request.Params.Map, Option[String], unfiltered.request.QParams.Log[E]) =&gt; (Option[String], unfiltered.request.QParams.Log[E], Option[B]))unfiltered.request.QParams.QueryM[E,Option[B]]">QueryM</a> <span class="delimiter">{</span>
        <span class="delimiter">(</span><a title="unfiltered.request.Params.Map" id="89888">params</a>, <a title="Option[String]" id="89889">key0</a>, <a title="unfiltered.request.QParams.Log[E]" id="89890">log0</a><span class="delimiter">)</span> =&gt;
          <span class="keyword">val</span> <a href="#89892" title="(Option[String], unfiltered.request.QParams.Log[E], A)" class="delimiter">(</a><a href="#89891" title="Option[String]" id="89892">key1</a>, <a href="#89891" title="unfiltered.request.QParams.Log[E]" id="89893">log1</a>, <a href="#89891" title="A" id="89894">value</a><span class="delimiter">)</span> = <a href="#89770" title="(v1: unfiltered.request.Params.Map, v2: Option[String], v3: unfiltered.request.QParams.Log[E])(Option[String], unfiltered.request.QParams.Log[E], A)">exec</a><span title="(Option[String], unfiltered.request.QParams.Log[E], A) @unchecked" class="delimiter">(</span><a href="#89888" title="unfiltered.request.Params.Map">params</a>, <a href="#89889" title="Option[String]">key0</a>, <a href="#89890" title="unfiltered.request.QParams.Log[E]">log0</a><span class="delimiter">)</span>
          <a href="#89892" title="Option[String]">key1</a> <span title="(Option[String], unfiltered.request.QParams.Log[E], Option[B])" class="keyword">match</span> <span class="delimiter">{</span>
            <span class="keyword">case</span> <span title="(Option[String], unfiltered.request.QParams.Log[E], None.type)">None</span> =&gt; <span title="(_1: Option[String], _2: unfiltered.request.QParams.Log[E], _3: None.type)(Option[String], unfiltered.request.QParams.Log[E], None.type)" class="delimiter">(</span><a href="#89892" title="Option[String]">key1</a>, <a href="#89893" title="unfiltered.request.QParams.Log[E]">log1</a>, <span title="object None">None</span><span class="delimiter">)</span> <span class="comment">// do not record error</span>
            <span class="keyword">case</span> <span title="(Option[String], unfiltered.request.QParams.Log[E], Option[B])">Some</span><span class="delimiter">(</span><a title="String" id="89920">k</a><span class="delimiter">)</span> =&gt;
              <a href="#62530" title="(v1: A)unfiltered.request.QParams.Report[E,B]">f</a><span class="delimiter">(</span><a href="#89894" title="A">value</a><span class="delimiter">)</span> <span title="(Option[String], unfiltered.request.QParams.Log[E], Option[B])" class="keyword">match</span> <span class="delimiter">{</span>
                <span class="keyword">case</span> <span title="(None.type, List[unfiltered.request.QParams.Fail[E]], None.type)">Left</span><span class="delimiter">(</span><a title="E" id="89923">err</a><span class="delimiter">)</span> =&gt; <span title="(_1: None.type, _2: List[unfiltered.request.QParams.Fail[E]], _3: None.type)(None.type, List[unfiltered.request.QParams.Fail[E]], None.type)" class="delimiter">(</span><span title="object None">None</span>, <a href="#90234" title="(name: String, error: E)unfiltered.request.QParams.Fail[E]">Fail</a><span class="delimiter">(</span><a href="#89920" title="String">k</a>,<a href="#89923" title="E">err</a><span class="delimiter">)</span><a href="#89930" title="(x: unfiltered.request.QParams.Fail[E])List[unfiltered.request.QParams.Fail[E]]">::</a><a href="#89893" title="unfiltered.request.QParams.Log[E]">log1</a>, <span title="object None">None</span><span class="delimiter">)</span> <span class="comment">// do record</span>
                <span class="keyword">case</span> <span title="(Option[String], unfiltered.request.QParams.Log[E], Option[B])">Right</span><span class="delimiter">(</span><a title="Option[B]" id="89950">v</a><span class="delimiter">)</span> =&gt; <span title="(_1: Option[String], _2: unfiltered.request.QParams.Log[E], _3: Option[B])(Option[String], unfiltered.request.QParams.Log[E], Option[B])" class="delimiter">(</span><a href="#89892" title="Option[String]">key1</a>, <a href="#89893" title="unfiltered.request.QParams.Log[E]">log1</a>, <a href="#89950" title="Option[B]">v</a><span class="delimiter">)</span>
              <span class="delimiter">}</span>
          <span class="delimiter">}</span>
      <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="(params: unfiltered.request.Params.Map)A" id="62524">apply</a><span class="delimiter">(</span><a title="unfiltered.request.Params.Map" id="62910">params</a>: Params.<span title="unfiltered.request.Params.Map">Map</span><span class="delimiter">)</span> = <a href="#89770" title="(v1: unfiltered.request.Params.Map, v2: Option[String], v3: unfiltered.request.QParams.Log[E])(Option[String], unfiltered.request.QParams.Log[E], A)">exec</a><span class="delimiter">(</span><a href="#62910" title="unfiltered.request.Params.Map">params</a>, <span title="object None">None</span>, <span title="object Nil">Nil</span><span class="delimiter">)</span>.<span title="=&gt; A">_3</span>
  <span class="delimiter">}</span>

  <span class="comment">/** Create a validion token from a named value from the input Params.Map */</span>
  <span class="keyword">def</span> <a title="[E](key: String)unfiltered.request.QParams.QueryM[E,Option[String]]" id="62230">lookup</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="62232">E</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="String" id="62505">key</a>: <span title="String">String</span><span class="delimiter">)</span>: <a href="#90223" title="unfiltered.request.QParams.QueryM[E,Option[String]]">QueryM</a><span class="delimiter">[</span>E,Option<span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">]</span> =
    <a href="#90223" title="(exec: (unfiltered.request.Params.Map, Option[String], unfiltered.request.QParams.Log[E]) =&gt; (Option[String], unfiltered.request.QParams.Log[E], Option[String]))unfiltered.request.QParams.QueryM[E,Option[String]]">QueryM</a> <span class="delimiter">{</span>
      <span class="delimiter">(</span><a title="unfiltered.request.Params.Map" id="90013">params</a>, <a title="Option[String]" id="90014">_</a>, <a title="unfiltered.request.QParams.Log[E]" id="90015">log0</a><span class="delimiter">)</span> =&gt;
        <span title="(_1: Some[String], _2: unfiltered.request.QParams.Log[E], _3: Option[String])(Some[String], unfiltered.request.QParams.Log[E], Option[String])" class="delimiter">(</span><span title="(x: String)Some[String]">Some</span><span class="delimiter">(</span><a href="#62505" title="String">key</a><span class="delimiter">)</span>, <a href="#90015" title="unfiltered.request.QParams.Log[E]">log0</a>, <a href="#90013" title="unfiltered.request.Params.Map">params</a>.<span title="(key: String)Option[Seq[String]]">get</span><span class="delimiter">(</span><a href="#62505" title="String">key</a><span class="delimiter">)</span>.<span title="(f: Seq[String] =&gt; Option[String])Option[String]">flatMap</span> <span class="delimiter">{</span> <a href="#90040" title="Seq[String]">_</a>.<span title="=&gt; Option[String]">headOption</span> <span class="delimiter">}</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

  <span class="comment">/** Create and name a validation token for an external input */</span>
  <span class="keyword">def</span> <a title="[E, A](key: String, value: Option[A])unfiltered.request.QParams.QueryM[E,Option[A]]" id="62233">external</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="62236">E</a>, <a title="&gt;: Nothing &lt;: Any" id="62237">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="String" id="90046">key</a>: <span title="String">String</span>, <a title="Option[A]" id="90047">value</a>: <span title="Option[A]">Option</span><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#90223" title="unfiltered.request.QParams.QueryM[E,Option[A]]">QueryM</a><span class="delimiter">[</span>E,Option<span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span> =
    <a href="#90223" title="(exec: (unfiltered.request.Params.Map, Option[String], unfiltered.request.QParams.Log[E]) =&gt; (Option[String], unfiltered.request.QParams.Log[E], Option[A]))unfiltered.request.QParams.QueryM[E,Option[A]]">QueryM</a> <span class="delimiter">{</span>
      <span class="delimiter">(</span><a title="unfiltered.request.Params.Map" id="90055">params</a>, <a title="Option[String]" id="90056">_</a>, <a title="unfiltered.request.QParams.Log[E]" id="90057">log0</a><span class="delimiter">)</span> =&gt;
        <span title="(_1: Some[String], _2: unfiltered.request.QParams.Log[E], _3: Option[A])(Some[String], unfiltered.request.QParams.Log[E], Option[A])" class="delimiter">(</span><span title="(x: String)Some[String]">Some</span><span class="delimiter">(</span><a href="#90046" title="String">key</a><span class="delimiter">)</span>, <a href="#90057" title="unfiltered.request.QParams.Log[E]">log0</a>, <a href="#90047" title="Option[A]">value</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>

  <span class="comment">/* Functions that are useful arguments to QueryM.is */</span>
  <span class="keyword">def</span> <a title="[E, A](err: E)Option[A] =&gt; unfiltered.request.QParams.Report[E,A]" id="62238">required</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="62241">E</a>,<a title="&gt;: Nothing &lt;: Any" id="62242">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="E" id="62571">err</a>:<a href="#62241" title="E">E</a><span class="delimiter">)</span>: <span title="Option[A] =&gt; unfiltered.request.QParams.Report[E,A]">Reporter</span><span class="delimiter">[</span>E,A,A<span class="delimiter">]</span> = <a href="#90081" title="unfiltered.request.QParams.Report[E,A]" class="delimiter">{</a>
    <span class="keyword">case</span> <span title="Left[E,Nothing]">None</span> =&gt; <span title="(a: E)Left[E,Nothing]">Left</span><span class="delimiter">(</span><a href="#62571" title="E">err</a><span class="delimiter">)</span>
    <span class="keyword">case</span> <a title="Right[Nothing,Option[A]]" id="90086">oa</a> =&gt; <span title="(b: Option[A])Right[Nothing,Option[A]]">Right</span><span class="delimiter">(</span><a href="#90086" title="Option[A]">oa</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="[E, A](xs: Option[A])unfiltered.request.QParams.Report[E,Option[A]]" id="62243">optional</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="62246">E</a>,<a title="&gt;: Nothing &lt;: Any" id="62247">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="Option[A]" id="62720">xs</a>: <span title="Option[A]">Option</span><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="unfiltered.request.QParams.Report[E,Option[A]]">Report</span><span class="delimiter">[</span>E,Option<span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">]</span> =
    <span title="(b: Some[Option[A]])Right[Nothing,Some[Option[A]]]">Right</span><span class="delimiter">(</span><span title="(x: Option[A])Some[Option[A]]">Some</span><span class="delimiter">(</span><a href="#62720" title="Option[A]">xs</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="comment">/** Promote c to an error reporter that fails if Some input is discarded */</span>
  <span class="keyword">def</span> <a title="[E, A, B](c: Option[A] =&gt; Option[B], err: A =&gt; E)Option[A] =&gt; unfiltered.request.QParams.Report[E,B]" id="62248">watch</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="62252">E</a>,<a title="&gt;: Nothing &lt;: Any" id="62253">A</a>,<a title="&gt;: Nothing &lt;: Any" id="62254">B</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="Option[A] =&gt; Option[B]" id="62539">c</a>: Option<span class="delimiter">[</span>A<span class="delimiter">]</span> =&gt; Option<span class="delimiter">[</span>B<span class="delimiter">]</span>, <a title="A =&gt; E" id="62540">err</a>: A =&gt; E<span class="delimiter">)</span>: <span title="Option[A] =&gt; unfiltered.request.QParams.Report[E,B]">Reporter</span><span class="delimiter">[</span>E,A,B<span class="delimiter">]</span> = <a href="#90099" title="unfiltered.request.QParams.Report[E,B]" class="delimiter">{</a>
    <span class="keyword">case</span> <span title="Right[Nothing,None.type]">None</span> =&gt; <span title="(b: None.type)Right[Nothing,None.type]">Right</span><span class="delimiter">(</span><span title="object None">None</span><span class="delimiter">)</span>
    <span class="keyword">case</span> <span title="&lt;none&gt; extends Product with Serializable with Either[E,Some[B]]">Some</span><span class="delimiter">(</span><a title="A" id="90105">a</a><span class="delimiter">)</span> =&gt; <a href="#62539" title="(v1: Option[A])Option[B]">c</a><span class="delimiter">(</span><span title="(x: A)Some[A]">Some</span><span class="delimiter">(</span><a href="#90105" title="A">a</a><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="(f: B =&gt; Right[Nothing,Some[B]])Option[Right[Nothing,Some[B]]]">map</span> <span class="delimiter">{</span> <a title="B" id="90114">b</a> =&gt; <span title="(b: Some[B])Right[Nothing,Some[B]]">Right</span><span class="delimiter">(</span><span title="(x: B)Some[B]">Some</span><span class="delimiter">(</span><a href="#90114" title="B">b</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">}</span> <span title="(default: =&gt; Product with Serializable with Either[E,Some[B]])Product with Serializable with Either[E,Some[B]]">getOrElse</span> <span title="(a: E)Left[E,Nothing]">Left</span><span class="delimiter">(</span><a href="#62540" title="(v1: A)E">err</a><span class="delimiter">(</span><a href="#90105" title="A">a</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/** Convert a predicate into an error reporter */</span>
  <span class="keyword">def</span> <a title="[E, A](p: A =&gt; Boolean, err: A =&gt; E)Option[A] =&gt; unfiltered.request.QParams.Report[E,A]" id="62255">pred</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="62258">E</a>,<a title="&gt;: Nothing &lt;: Any" id="62259">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="A =&gt; Boolean" id="62696">p</a>: A =&gt; Boolean, <a title="A =&gt; E" id="62697">err</a>: A =&gt; E<span class="delimiter">)</span>: <span title="Option[A] =&gt; unfiltered.request.QParams.Report[E,A]">Reporter</span><span class="delimiter">[</span>E,A,A<span class="delimiter">]</span> =
    <a href="#62248" title="(c: Option[A] =&gt; Option[A], err: A =&gt; E)Option[A] =&gt; unfiltered.request.QParams.Report[E,A]">watch</a><span class="delimiter">(</span><span class="delimiter">{</span><a href="#90151" title="Option[A]">_</a> <span title="(p: A =&gt; Boolean)Option[A]">filter</span> <a href="#62696" title="A =&gt; Boolean">p</a><span class="delimiter">}</span>, <a href="#62697" title="A =&gt; E">err</a><span class="delimiter">)</span>

  <span class="comment">/** Convert f into an error reporter that never reports errors */</span>
  <span class="keyword">def</span> <a title="[E, A](f: Option[A] =&gt; Option[A])Option[A] =&gt; unfiltered.request.QParams.Report[E,A]" id="62260">ignore</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="62263">E</a>,<a title="&gt;: Nothing &lt;: Any" id="62264">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="Option[A] =&gt; Option[A]" id="90155">f</a>: Option<span class="delimiter">[</span>A<span class="delimiter">]</span> =&gt; Option<span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="Option[A] =&gt; unfiltered.request.QParams.Report[E,A]">Reporter</span><span class="delimiter">[</span>E,A,A<span class="delimiter">]</span> =
    <a title="Option[A]" id="90159">opt</a> =&gt; <span title="(b: Option[A])Right[Nothing,Option[A]]">Right</span><span class="delimiter">(</span><a href="#90155" title="(v1: Option[A])Option[A]">f</a><span class="delimiter">(</span><a href="#90159" title="Option[A]">opt</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="[E](e: String =&gt; E)Option[String] =&gt; unfiltered.request.QParams.Report[E,Int]" id="62265">int</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="62267">E</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="String =&gt; E" id="90165">e</a>: String =&gt; E<span class="delimiter">)</span> = <a href="#62248" title="(c: Option[String] =&gt; Option[Int], err: String =&gt; E)Option[String] =&gt; unfiltered.request.QParams.Report[E,Int]">watch</a><span class="delimiter">(</span><a href="#10082" title="object unfiltered.request.Params">Params</a>.<a href="#38462" title="(os: Option[String])Option[Int]">int</a>, <a href="#90165" title="String =&gt; E">e</a><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="[E](e: String =&gt; E)Option[String] =&gt; unfiltered.request.QParams.Report[E,Long]" id="62268">long</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="62270">E</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="String =&gt; E" id="90178">e</a>: String =&gt; E<span class="delimiter">)</span> = <a href="#62248" title="(c: Option[String] =&gt; Option[Long], err: String =&gt; E)Option[String] =&gt; unfiltered.request.QParams.Report[E,Long]">watch</a><span class="delimiter">(</span><a href="#10082" title="object unfiltered.request.Params">Params</a>.<a href="#38463" title="(os: Option[String])Option[Long]">long</a>, <a href="#90178" title="String =&gt; E">e</a><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="[E](e: Int =&gt; E)Option[Int] =&gt; unfiltered.request.QParams.Report[E,Int]" id="62271">even</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="62273">E</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="Int =&gt; E" id="90191">e</a>: Int =&gt; E<span class="delimiter">)</span> = <a href="#62248" title="(c: Option[Int] =&gt; Option[Int], err: Int =&gt; E)Option[Int] =&gt; unfiltered.request.QParams.Report[E,Int]">watch</a><span class="delimiter">(</span><a href="#10082" title="object unfiltered.request.Params">Params</a>.<a href="#38466" title="=&gt; Option[Int] =&gt; Option[Int]">even</a>, <a href="#90191" title="Int =&gt; E">e</a><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="[E](e: Int =&gt; E)Option[Int] =&gt; unfiltered.request.QParams.Report[E,Int]" id="62274">odd</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="62276">E</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="Int =&gt; E" id="90202">e</a>: Int =&gt; E<span class="delimiter">)</span> = <a href="#62248" title="(c: Option[Int] =&gt; Option[Int], err: Int =&gt; E)Option[Int] =&gt; unfiltered.request.QParams.Report[E,Int]">watch</a><span class="delimiter">(</span><a href="#10082" title="object unfiltered.request.Params">Params</a>.<a href="#38468" title="=&gt; Option[Int] =&gt; Option[Int]">odd</a>, <a href="#90202" title="Int =&gt; E">e</a><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="[E]=&gt; Option[String] =&gt; unfiltered.request.QParams.Report[E,String]" id="62277">trimmed</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="62279">E</a><span class="delimiter">]</span> = <a href="#62260" title="[E, A](f: Option[A] =&gt; Option[A])Option[A] =&gt; unfiltered.request.QParams.Report[E,A]">ignore</a><span title="(f: Option[String] =&gt; Option[String])Option[String] =&gt; unfiltered.request.QParams.Report[E,String]" class="delimiter">[</span><a href="#62279" title="E">E</a>,<span title="String">String</span><span class="delimiter">]</span><span class="delimiter">(</span><a href="#10082" title="object unfiltered.request.Params">Params</a>.<a href="#38470" title="(s: Option[String])Option[java.lang.String]">trimmed</a><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="[E](e: E)Option[String] =&gt; unfiltered.request.QParams.Report[E,String]" id="62280">nonempty</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="62282">E</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="E" id="62536">e</a>: <a href="#62282" title="E">E</a><span class="delimiter">)</span> = <a href="#62248" title="(c: Option[String] =&gt; Option[String], err: String =&gt; E)Option[String] =&gt; unfiltered.request.QParams.Report[E,String]">watch</a><span class="delimiter">(</span><a href="#10082" title="object unfiltered.request.Params">Params</a>.<a href="#38471" title="=&gt; Option[String] =&gt; Option[String]">nonempty</a>, <span class="delimiter">(</span>s: <span title="String">String</span><span class="delimiter">)</span> =&gt; <a href="#62536" title="E">e</a><span class="delimiter">)</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>