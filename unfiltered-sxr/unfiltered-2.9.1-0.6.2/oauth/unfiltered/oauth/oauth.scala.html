<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>oauth/unfiltered/oauth/oauth.scala</title>
        <script type="text/javascript" src="../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> unfiltered.oauth

<span class="keyword">import</span> unfiltered._
<span class="keyword">import</span> unfiltered.request._
<span class="keyword">import</span> unfiltered.response._
<span class="keyword">import</span> unfiltered.request.<span class="delimiter">{</span>HttpRequest =&gt; Req<span class="delimiter">}</span>

<span class="keyword">object</span> <a title="object unfiltered.oauth.OAuth" id="62162">OAuth</a> <span title="ScalaObject" class="delimiter">{</span>
  <span class="keyword">val</span> <a title="java.lang.String" id="61575">ConsumerKey</a> = <span title="java.lang.String(&quot;oauth_consumer_key&quot;)" class="string">&quot;oauth_consumer_key&quot;</span>
  <span class="keyword">val</span> <a title="java.lang.String" id="61577">SignatureMethod</a> = <span title="java.lang.String(&quot;oauth_signature_method&quot;)" class="string">&quot;oauth_signature_method&quot;</span>
  <span class="keyword">val</span> <a title="java.lang.String" id="61579">Timestamp</a> = <span title="java.lang.String(&quot;oauth_timestamp&quot;)" class="string">&quot;oauth_timestamp&quot;</span>
  <span class="keyword">val</span> <a title="java.lang.String" id="61581">Nonce</a> = <span title="java.lang.String(&quot;oauth_nonce&quot;)" class="string">&quot;oauth_nonce&quot;</span>
  <span class="keyword">val</span> <a title="java.lang.String" id="61583">Callback</a> = <span title="java.lang.String(&quot;oauth_callback&quot;)" class="string">&quot;oauth_callback&quot;</span>
  <span class="keyword">val</span> <a title="java.lang.String" id="61585">Sig</a> = <span title="java.lang.String(&quot;oauth_signature&quot;)" class="string">&quot;oauth_signature&quot;</span>
  <span class="keyword">val</span> <a title="java.lang.String" id="61587">TokenKey</a> = <span title="java.lang.String(&quot;oauth_token&quot;)" class="string">&quot;oauth_token&quot;</span>
  <span class="keyword">val</span> <a title="java.lang.String" id="61589">Verifier</a> = <span title="java.lang.String(&quot;oauth_verifier&quot;)" class="string">&quot;oauth_verifier&quot;</span>
  <span class="keyword">val</span> <a title="java.lang.String" id="61591">Version</a> = <span title="java.lang.String(&quot;oauth_version&quot;)" class="string">&quot;oauth_version&quot;</span>

  <span class="comment">/** out-of-bounds callback value */</span>
  <span class="keyword">val</span> <a title="java.lang.String" id="61593">Oob</a> = <span title="java.lang.String(&quot;oob&quot;)" class="string">&quot;oob&quot;</span>

  <span class="keyword">val</span> <a title="java.lang.String" id="61595">XAuthorizedIdentity</a> = <span title="java.lang.String(&quot;X-Authorized-Identity&quot;)" class="string">&quot;X-Authorized-Identity&quot;</span>

  <span class="comment">/** Authorization: OAuth header extractor */</span>
  <span class="keyword">object</span> <a title="object unfiltered.oauth.OAuth.Header" id="61597">Header</a> <span title="ScalaObject" class="delimiter">{</span>
    <span class="keyword">val</span> <a title="scala.util.matching.Regex" id="61654">KeyVal</a> = <span title="java.lang.String(&quot;(\\w+)=\&quot;([\\w|:|\\/|.|%|-]+)\&quot; &quot;)" class="string">&quot;&quot;&quot;(\w+)=&quot;([\w|:|\/|.|%|-]+)&quot; &quot;&quot;&quot;</span>.<span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">trim</span>.<span title="=&gt; scala.util.matching.Regex">r</span>
    <span class="keyword">val</span> <a title="scala.collection.immutable.Set[java.lang.String]" id="61656">keys</a> = <span title="=&gt; scala.collection.immutable.Set.type">Set</span>.<span title="scala.collection.immutable.Set[java.lang.String]">empty</span> <span title="(elem: java.lang.String)scala.collection.immutable.Set[java.lang.String]">+</span> <span title="java.lang.String(&quot;realm&quot;)" class="string">&quot;realm&quot;</span> <span title="(elem: java.lang.String)scala.collection.immutable.Set[java.lang.String]">+</span> <a href="#61575" title="=&gt; java.lang.String">ConsumerKey</a> <span title="(elem: java.lang.String)scala.collection.immutable.Set[java.lang.String]">+</span> <a href="#61587" title="=&gt; java.lang.String">TokenKey</a> <span title="(elem: java.lang.String)scala.collection.immutable.Set[java.lang.String]">+</span> <a href="#61577" title="=&gt; java.lang.String">SignatureMethod</a> <span title="(elem: java.lang.String)scala.collection.immutable.Set[java.lang.String]">+</span>
      <a href="#61585" title="=&gt; java.lang.String">Sig</a> <span title="(elem: java.lang.String)scala.collection.immutable.Set[java.lang.String]">+</span> <a href="#61579" title="=&gt; java.lang.String">Timestamp</a> <span title="(elem: java.lang.String)scala.collection.immutable.Set[java.lang.String]">+</span> <a href="#61581" title="=&gt; java.lang.String">Nonce</a> <span title="(elem: java.lang.String)scala.collection.immutable.Set[java.lang.String]">+</span> <a href="#61583" title="=&gt; java.lang.String">Callback</a> <span title="(elem: java.lang.String)scala.collection.immutable.Set[java.lang.String]">+</span> <a href="#61589" title="=&gt; java.lang.String">Verifier</a> <span title="(elem: java.lang.String)scala.collection.immutable.Set[java.lang.String]">+</span> <a href="#61591" title="=&gt; java.lang.String">Version</a>

    <span class="keyword">def</span> <a title="(hvals: Seq[String])scala.collection.immutable.Map[String,Seq[String]]" id="61658">apply</a><span class="delimiter">(</span><a title="Seq[String]" id="61966">hvals</a>: <span title="Seq[String]">Seq</span><span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">)</span> =
      <span title="(elems: (String, Seq[String])*)scala.collection.immutable.Map[String,Seq[String]]">Map</span><span class="delimiter">(</span><span class="delimiter">(</span><a href="#61966" title="Seq[String]">hvals</a> <span title="(f: String =&gt; java.lang.String)(implicit bf: scala.collection.generic.CanBuildFrom[Seq[String],java.lang.String,Seq[java.lang.String]])Seq[java.lang.String]">map</span> <span class="delimiter">{</span> <a href="#61988" title="String">_</a>.<span title="(x$1: java.lang.CharSequence, x$2: java.lang.CharSequence)java.lang.String">replace</span><span class="delimiter">(</span><span title="java.lang.String(&quot;OAuth &quot;)" class="string">&quot;OAuth &quot;</span>, <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span> <span class="delimiter">}</span> <span title="(f: java.lang.String =&gt; scala.collection.GenTraversableOnce[(String, Seq[String])])(implicit bf: scala.collection.generic.CanBuildFrom[Seq[java.lang.String],(String, Seq[String]),Seq[(String, Seq[String])]])Seq[(String, Seq[String])]">flatMap</span> <a href="#62031" title="Seq[(String, Seq[String])]" class="delimiter">{</a>
        <span class="keyword">case</span> <a href="#61654" title="Seq[(String, Seq[String])]">KeyVal</a><span class="delimiter">(</span><a title="String" id="62033">k</a>, <a title="String" id="62034">v</a><span class="delimiter">)</span> <span class="keyword">if</span><span class="delimiter">(</span><a href="#61656" title="=&gt; scala.collection.immutable.Set[java.lang.String]">keys</a>.<span title="(elem: java.lang.String)Boolean">contains</span><span class="delimiter">(</span><a href="#62033" title="String">k</a><span class="delimiter">)</span><span class="delimiter">)</span> =&gt; <span title="(elems: (String, Seq[String])*)Seq[(String, Seq[String])]">Seq</span><span class="delimiter">(</span><span class="delimiter">(</span><a href="#62033" title="(x: String)ArrowAssoc[String]">k</a> <span title="(y: Seq[String])(String, Seq[String])">-&gt;</span> <span title="(elems: String*)Seq[String]">Seq</span><span class="delimiter">(</span><a href="#62034" title="String">v</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="keyword">case</span> <a title="scala.collection.immutable.Nil.type" id="62107">b</a> =&gt; <span title="object Nil">Nil</span>
      <span class="delimiter">}</span><span class="delimiter">)</span>: _*<span class="delimiter">)</span>

    <span class="keyword">def</span> <a title="(hvals: Seq[String])Some[scala.collection.immutable.Map[String,Seq[String]]]" id="61659">unapply</a><span class="delimiter">(</span><a title="Seq[String]" id="62131">hvals</a>: <span title="Seq[String]">Seq</span><span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">)</span> = <span title="(x: scala.collection.immutable.Map[String,Seq[String]])Some[scala.collection.immutable.Map[String,Seq[String]]]">Some</span><span class="delimiter">(</span><a href="#61658" title="(hvals: Seq[String])scala.collection.immutable.Map[String,Seq[String]]">apply</a><span class="delimiter">(</span><a href="#62131" title="Seq[String]">hvals</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="comment">/** Defines end points for oauth interation */</span>
<span class="keyword">trait</span> <a title="trait OAuthPaths extends java.lang.Object" id="13052">OAuthPaths</a> <span title="java.lang.Object" class="delimiter">{</span>
  <span class="keyword">val</span> <a title="=&gt; String" id="61639">RequestTokenPath</a>: <span title="String">String</span>
  <span class="keyword">val</span> <a title="=&gt; String" id="61640">AuthorizationPath</a>: <span title="String">String</span>
  <span class="keyword">val</span> <a title="=&gt; String" id="61641">AccessTokenPath</a>: <span title="String">String</span>
<span class="delimiter">}</span>

<span class="keyword">trait</span> <a title="trait DefaultOAuthPaths extends java.lang.Object with unfiltered.oauth.OAuthPaths with ScalaObject" id="12908">DefaultOAuthPaths</a> <span title="ScalaObject" class="keyword">extends</span> <a href="#13052" title="unfiltered.oauth.OAuthPaths">OAuthPaths</a> <span class="delimiter">{</span>
  <span class="keyword">val</span> <a title="java.lang.String" id="61643">RequestTokenPath</a> = <span title="java.lang.String(&quot;/request_token&quot;)" class="string">&quot;/request_token&quot;</span>
  <span class="keyword">val</span> <a title="java.lang.String" id="61645">AuthorizationPath</a> = <span title="java.lang.String(&quot;/authorize&quot;)" class="string">&quot;/authorize&quot;</span>
  <span class="keyword">val</span> <a title="java.lang.String" id="61647">AccessTokenPath</a> = <span title="java.lang.String(&quot;/access_token&quot;)" class="string">&quot;/access_token&quot;</span>
<span class="delimiter">}</span>

<span class="comment">/** Formatting for validation messages */</span>
<span class="keyword">trait</span> <a title="trait Messages extends java.lang.Object" id="12941">Messages</a> <span title="java.lang.Object" class="delimiter">{</span>
  <span class="keyword">def</span> <a title="(param: String)String" id="61634">blankMsg</a><span class="delimiter">(</span><a title="String" id="62167">param</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="String">String</span>
  <span class="keyword">def</span> <a title="(param: String)String" id="61635">requiredMsg</a><span class="delimiter">(</span><a title="String" id="62168">param</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="String">String</span>
<span class="delimiter">}</span>

<span class="keyword">trait</span> <a title="trait DefaultMessages extends java.lang.Object with unfiltered.oauth.Messages with ScalaObject" id="12905">DefaultMessages</a> <span title="ScalaObject" class="keyword">extends</span> <a href="#12941" title="unfiltered.oauth.Messages">Messages</a> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="(param: String)String" id="61637">blankMsg</a><span class="delimiter">(</span><a title="String" id="62171">param</a>: <span title="String">String</span><span class="delimiter">)</span> = <span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;%s can not be blank&quot;</span> <span title="(args: Any*)String">format</span> <a href="#62171" title="String">param</a>
  <span class="keyword">def</span> <a title="(param: String)String" id="61638">requiredMsg</a><span class="delimiter">(</span><a title="String" id="62177">param</a>: <span title="String">String</span><span class="delimiter">)</span> = <span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;%s is required&quot;</span> <span title="(args: Any*)String">format</span> <a href="#62177" title="String">param</a>
<span class="delimiter">}</span>

<span class="keyword">trait</span> <a title="trait Protected extends java.lang.Object with unfiltered.oauth.OAuthProvider with unfiltered.filter.Plan with ScalaObject" id="13133">Protected</a> <span title="ScalaObject" class="keyword">extends</span> <a href="#13076" title="unfiltered.oauth.OAuthProvider">OAuthProvider</a> <span class="keyword">with</span> unfiltered.filter.<a href="../../../filter/unfiltered/filter/plans.scala.html#10374" title="unfiltered.filter.Plan">Plan</a> <span class="delimiter">{</span>
  self: OAuthStores <span class="keyword">with</span> Messages =&gt;
  <span class="keyword">import</span> unfiltered.filter.request.ContextPath
  <span class="keyword">import</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#10184" title="object unfiltered.request.QParams">QParams</a>._
  <span class="keyword">import</span> <a href="#62162" title="object unfiltered.oauth.OAuth">OAuth</a>._

  <span class="keyword">def</span> <a title="=&gt; PartialFunction[unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest],unfiltered.response.ResponseFunction[javax.servlet.http.HttpServletResponse]]" id="62188">intent</a> = <a href="#62287" title="unfiltered.response.ResponseFunction[javax.servlet.http.HttpServletResponse]" class="delimiter">{</a>
    <span class="keyword">case</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#38447" title="~&gt; extends java.lang.Object with unfiltered.response.ResponseFunction[Any]">Params</a><span class="delimiter">(</span><a title="scala.collection.immutable.Map[String,Seq[String]]" id="62300">params</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/utils.scala.html#42898" title="(a: unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest])Some[(unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest], unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest])]">&amp;</a> <a title="unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest]" id="62301">request</a> =&gt;
      <span class="keyword">val</span> <a title="scala.collection.immutable.Map[String,Seq[String]]" id="62302">headers</a> = <a href="../../../unfiltered/unfiltered/unfiltered/request/headers.scala.html#16005" title="(req: unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest])Option[String]">Authorization</a><span class="delimiter">(</span><a href="#62301" title="unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest]">request</a><span class="delimiter">)</span> <span title="scala.collection.immutable.Map[String,Seq[String]]" class="keyword">match</span> <span class="delimiter">{</span>
         <span class="keyword">case</span> <span title="scala.collection.immutable.Map[String,Seq[String]]">Some</span><span class="delimiter">(</span><a title="String" id="62309">a</a><span class="delimiter">)</span> =&gt; <a href="#62162" title="object unfiltered.oauth.OAuth">OAuth</a>.<a href="#61658" title="(hvals: Seq[String])scala.collection.immutable.Map[String,Seq[String]]">Header</a><span class="delimiter">(</span><a href="#62309" title="String">a</a>.<span title="(x$1: java.lang.String)Array[java.lang.String]">split</span><span title="(xs: Array[java.lang.String])scala.collection.mutable.WrappedArray[java.lang.String]" class="delimiter">(</span><span title="java.lang.String(&quot;,&quot;)" class="string">&quot;,&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
         <span class="keyword">case</span> <span title="scala.collection.immutable.Map[String,Seq[String]]">_</span> =&gt; <span title="=&gt; scala.collection.immutable.Map.type">Map</span>.<span title="[A, B]=&gt; scala.collection.immutable.Map[A,B]">empty</span><span title="scala.collection.immutable.Map[String,Seq[String]]" class="delimiter">[</span><span title="String">String</span>, <span title="Seq[String]">Seq</span><span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">]</span>
      <span class="delimiter">}</span>
      <span class="keyword">val</span> <a title="unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,java.lang.Object with unfiltered.response.ResponseFunction[Any]]]" id="62303">expected</a> = <span class="keyword">for</span> <span class="delimiter">{</span>
        <a title="Option[String]" id="62586">oauth_consumer_key</a> &lt;- <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62230" title="(key: String)unfiltered.request.QParams.QueryM[String,Option[String]]">lookup</a><span class="delimiter">(</span><a href="#61575" title="=&gt; java.lang.String">ConsumerKey</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62521" title="(f: Option[String] =&gt; unfiltered.request.QParams.Report[String,String])unfiltered.request.QParams.QueryM[String,Option[String]]">is</a>
          <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62280" title="(e: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">nonempty</a><span class="delimiter">(</span><a href="#61634" title="(param: String)String">blankMsg</a><span class="delimiter">(</span><a href="#61575" title="=&gt; java.lang.String">ConsumerKey</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62512" title="(f: Option[String] =&gt; unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,java.lang.Object with unfiltered.response.ResponseFunction[Any]]])unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,java.lang.Object with unfiltered.response.ResponseFunction[Any]]]">is</a> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62238" title="(err: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">required</a><span class="delimiter">(</span><a href="#61635" title="(param: String)String">requiredMsg</a><span class="delimiter">(</span><a href="#61575" title="=&gt; java.lang.String">ConsumerKey</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <a title="Option[String]" id="62607">oauth_signature_method</a> &lt;- <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62230" title="(key: String)unfiltered.request.QParams.QueryM[String,Option[String]]">lookup</a><span class="delimiter">(</span><a href="#61577" title="=&gt; java.lang.String">SignatureMethod</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62521" title="(f: Option[String] =&gt; unfiltered.request.QParams.Report[String,String])unfiltered.request.QParams.QueryM[String,Option[String]]">is</a>
          <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62280" title="(e: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">nonempty</a><span class="delimiter">(</span><a href="#61634" title="(param: String)String">blankMsg</a><span class="delimiter">(</span><a href="#61577" title="=&gt; java.lang.String">SignatureMethod</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62512" title="(f: Option[String] =&gt; unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,java.lang.Object with unfiltered.response.ResponseFunction[Any]]])unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,java.lang.Object with unfiltered.response.ResponseFunction[Any]]]">is</a> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62238" title="(err: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">required</a><span class="delimiter">(</span><a href="#61635" title="(param: String)String">requiredMsg</a><span class="delimiter">(</span><a href="#61577" title="=&gt; java.lang.String">SignatureMethod</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <a title="Option[String]" id="62628">timestamp</a> &lt;- <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62230" title="(key: String)unfiltered.request.QParams.QueryM[String,Option[String]]">lookup</a><span class="delimiter">(</span><a href="#61579" title="=&gt; java.lang.String">Timestamp</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62521" title="(f: Option[String] =&gt; unfiltered.request.QParams.Report[String,String])unfiltered.request.QParams.QueryM[String,Option[String]]">is</a>
          <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62280" title="(e: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">nonempty</a><span class="delimiter">(</span><a href="#61634" title="(param: String)String">blankMsg</a><span class="delimiter">(</span><a href="#61579" title="=&gt; java.lang.String">Timestamp</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62512" title="(f: Option[String] =&gt; unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,java.lang.Object with unfiltered.response.ResponseFunction[Any]]])unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,java.lang.Object with unfiltered.response.ResponseFunction[Any]]]">is</a> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62238" title="(err: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">required</a><span class="delimiter">(</span><a href="#61635" title="(param: String)String">requiredMsg</a><span class="delimiter">(</span><a href="#61579" title="=&gt; java.lang.String">Timestamp</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <a title="Option[String]" id="62649">nonce</a> &lt;- <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62230" title="(key: String)unfiltered.request.QParams.QueryM[String,Option[String]]">lookup</a><span class="delimiter">(</span><a href="#61581" title="=&gt; java.lang.String">Nonce</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62521" title="(f: Option[String] =&gt; unfiltered.request.QParams.Report[String,String])unfiltered.request.QParams.QueryM[String,Option[String]]">is</a>
          <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62280" title="(e: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">nonempty</a><span class="delimiter">(</span><a href="#61634" title="(param: String)String">blankMsg</a><span class="delimiter">(</span><a href="#61581" title="=&gt; java.lang.String">Nonce</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62512" title="(f: Option[String] =&gt; unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,java.lang.Object with unfiltered.response.ResponseFunction[Any]]])unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,java.lang.Object with unfiltered.response.ResponseFunction[Any]]]">is</a> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62238" title="(err: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">required</a><span class="delimiter">(</span><a href="#61635" title="(param: String)String">requiredMsg</a><span class="delimiter">(</span><a href="#61581" title="=&gt; java.lang.String">Nonce</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <a title="Option[String]" id="62670">token</a> &lt;- <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62230" title="(key: String)unfiltered.request.QParams.QueryM[String,Option[String]]">lookup</a><span class="delimiter">(</span><a href="#61587" title="=&gt; java.lang.String">TokenKey</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62521" title="(f: Option[String] =&gt; unfiltered.request.QParams.Report[String,String])unfiltered.request.QParams.QueryM[String,Option[String]]">is</a>
          <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62280" title="(e: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">nonempty</a><span class="delimiter">(</span><a href="#61634" title="(param: String)String">blankMsg</a><span class="delimiter">(</span><a href="#61587" title="=&gt; java.lang.String">TokenKey</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62512" title="(f: Option[String] =&gt; unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,java.lang.Object with unfiltered.response.ResponseFunction[Any]]])unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,java.lang.Object with unfiltered.response.ResponseFunction[Any]]]">is</a> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62238" title="(err: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">required</a><span class="delimiter">(</span><a href="#61635" title="(param: String)String">requiredMsg</a><span class="delimiter">(</span><a href="#61587" title="=&gt; java.lang.String">TokenKey</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <a title="Option[String]" id="62691">signature</a> &lt;- <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62230" title="(key: String)unfiltered.request.QParams.QueryM[String,Option[String]]">lookup</a><span class="delimiter">(</span><a href="#61585" title="=&gt; java.lang.String">Sig</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62521" title="(f: Option[String] =&gt; unfiltered.request.QParams.Report[String,String])unfiltered.request.QParams.QueryM[String,Option[String]]">is</a>
          <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62280" title="(e: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">nonempty</a><span class="delimiter">(</span><a href="#61634" title="(param: String)String">blankMsg</a><span class="delimiter">(</span><a href="#61585" title="=&gt; java.lang.String">Sig</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62512" title="(f: Option[String] =&gt; unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,java.lang.Object with unfiltered.response.ResponseFunction[Any]]])unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,java.lang.Object with unfiltered.response.ResponseFunction[Any]]]">is</a> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62238" title="(err: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">required</a><span class="delimiter">(</span><a href="#61635" title="(param: String)String">requiredMsg</a><span class="delimiter">(</span><a href="#61585" title="=&gt; java.lang.String">Sig</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <a title="Option[Option[String]]" id="62732">version</a> &lt;- <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62230" title="(key: String)unfiltered.request.QParams.QueryM[java.lang.String,Option[String]]">lookup</a><span class="delimiter">(</span><a href="#61591" title="=&gt; java.lang.String">Version</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62521" title="(f: Option[String] =&gt; unfiltered.request.QParams.Report[java.lang.String,String])unfiltered.request.QParams.QueryM[java.lang.String,Option[String]]">is</a>
          <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62255" title="(p: String =&gt; Boolean, err: String =&gt; java.lang.String)Option[String] =&gt; unfiltered.request.QParams.Report[java.lang.String,String]">pred</a> <span class="delimiter">(</span> <a href="#62706" title="String">_</a> <span title="(x$1: AnyRef)Boolean">==</span> <span title="java.lang.String(&quot;1.0&quot;)" class="string">&quot;1.0&quot;</span>, <span title="java.lang.String(&quot;invalid oauth version &quot;)" class="string">&quot;invalid oauth version &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#62712" title="String">_</a> <span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62512" title="(f: Option[Option[String]] =&gt; unfiltered.request.QParams.QueryM[java.lang.String,unfiltered.request.QParams.QueryResult[String,java.lang.Object with unfiltered.response.ResponseFunction[Any]]])unfiltered.request.QParams.QueryM[java.lang.String,unfiltered.request.QParams.QueryResult[String,java.lang.Object with unfiltered.response.ResponseFunction[Any]]]">is</a>
          <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62243" title="[E, A](xs: Option[A])unfiltered.request.QParams.Report[E,Option[A]]">optional</a><a href="#62725" title="(xs: Option[String])unfiltered.request.QParams.Report[String,Option[String]]" class="delimiter">[</a><span title="String">String</span>,<span title="String">String</span><span class="delimiter">]</span>
        <a title="Option[Option[String]]" id="62750">realm</a> &lt;- <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62230" title="(key: String)unfiltered.request.QParams.QueryM[String,Option[String]]">lookup</a><span class="delimiter">(</span><span title="java.lang.String(&quot;realm&quot;)" class="string">&quot;realm&quot;</span><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62518" title="(f: Option[Option[String]] =&gt; java.lang.Object with unfiltered.response.ResponseFunction[Any])unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,java.lang.Object with unfiltered.response.ResponseFunction[Any]]]">is</a> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62243" title="[E, A](xs: Option[A])unfiltered.request.QParams.Report[E,Option[A]]">optional</a><a href="#62739" title="(xs: Option[String])unfiltered.request.QParams.Report[String,Option[String]]" class="delimiter">[</a><span title="String">String</span>, <span title="String">String</span><span class="delimiter">]</span>
      <span class="delimiter">}</span> <span class="keyword">yield</span> <span class="delimiter">{</span>
        <a href="#61603" title="(method: String, url: String, p: Map[String,Seq[String]])unfiltered.oauth.OAuthResponse">protect</a><span class="delimiter">(</span><a href="#62301" title="unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest]">request</a>.<a href="../../../unfiltered/unfiltered/unfiltered/request/HttpRequest.scala.html#13897" title="=&gt; String">method</a>, <a href="#62301" title="unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest]">request</a>.<a href="../../../unfiltered/unfiltered/unfiltered/request/HttpRequest.scala.html#13891" title="=&gt; javax.servlet.http.HttpServletRequest">underlying</a>.<span title="()java.lang.StringBuffer">getRequestURL</span>.<span title="()java.lang.String">toString</span>, <a href="#62300" title="scala.collection.immutable.Map[String,Seq[String]]">params</a> <span title="(xs: scala.collection.GenTraversableOnce[(String, Seq[String])])scala.collection.immutable.Map[String,Seq[String]]">++</span> <a href="#62302" title="scala.collection.immutable.Map[String,Seq[String]]">headers</a><span class="delimiter">)</span> <span title="~&gt; extends java.lang.Object with unfiltered.response.ResponseFunction[Any]" class="keyword">match</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> <span title="~&gt; extends java.lang.Object with unfiltered.response.ResponseFunction[Any]">Failure</span><span class="delimiter">(</span>_, _<span class="delimiter">)</span> =&gt;
            <a href="../../../unfiltered/unfiltered/unfiltered/response/statuses.scala.html#11277" title="object unfiltered.response.Unauthorized">Unauthorized</a> <a href="../../../unfiltered/unfiltered/unfiltered/response/functions.scala.html#25428" title="(that: unfiltered.response.ResponseFunction[Any])java.lang.Object with unfiltered.response.ResponseFunction[Any]">~&gt;</a> <a href="../../../unfiltered/unfiltered/unfiltered/response/headers.scala.html#43443" title="(value: String*)unfiltered.response.ResponseHeader">WWWAuthenticate</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;OAuth realm=\&quot;%s\&quot;&quot;</span> <span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#62750" title="Option[Option[String]]">realm</a> <span title="Any" class="keyword">match</span> <span class="delimiter">{</span>
              <span class="keyword">case</span> <span title="Option[String]">Some</span><span class="delimiter">(</span><a title="Option[String]" id="62869">value</a><span class="delimiter">)</span> =&gt; <a href="#62869" title="Option[String]">value</a>
              <span class="keyword">case</span> <span title="java.lang.String">_</span> =&gt; <a href="#62301" title="unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest]">request</a>.<a href="../../../unfiltered/unfiltered/unfiltered/request/HttpRequest.scala.html#13891" title="=&gt; javax.servlet.http.HttpServletRequest">underlying</a>.<span title="()java.lang.StringBuffer">getRequestURL</span>.<span title="()java.lang.String">toString</span>
            <span class="delimiter">}</span><span class="delimiter">)</span><span class="delimiter">)</span>
          <span class="keyword">case</span> <span title="unfiltered.response.Pass.type">Authorized</span><span class="delimiter">(</span><a title="String" id="62901">user</a><span class="delimiter">)</span> =&gt;
            <a href="#62301" title="unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest]">request</a>.<a href="../../../unfiltered/unfiltered/unfiltered/request/HttpRequest.scala.html#13891" title="=&gt; javax.servlet.http.HttpServletRequest">underlying</a>.<span title="(x$1: java.lang.String, x$2: Any)Unit">setAttribute</span><span class="delimiter">(</span><a href="#61595" title="=&gt; java.lang.String">XAuthorizedIdentity</a>, <a href="#62901" title="String">user</a><span class="delimiter">)</span>
            <a href="../../../unfiltered/unfiltered/unfiltered/response/pass.scala.html#10992" title="object unfiltered.response.Pass">Pass</a>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>

      <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62524" title="(params: unfiltered.request.Params.Map)unfiltered.request.QParams.QueryResult[String,java.lang.Object with unfiltered.response.ResponseFunction[Any]]">expected</a><a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62220" title="(r: unfiltered.request.QParams.QueryResult[String,java.lang.Object with unfiltered.response.ResponseFunction[Any]])unfiltered.request.QParams.QueryResultX[String,java.lang.Object with unfiltered.response.ResponseFunction[Any]]" class="delimiter">(</a><a href="#62300" title="scala.collection.immutable.Map[String,Seq[String]]">params</a> <span title="(xs: scala.collection.GenTraversableOnce[(String, Seq[String])])scala.collection.immutable.Map[String,Seq[String]]">++</span> <a href="#62302" title="scala.collection.immutable.Map[String,Seq[String]]">headers</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62989" title="(handler: unfiltered.request.QParams.Log[String] =&gt; java.lang.Object with unfiltered.response.ResponseFunction[Any])java.lang.Object with unfiltered.response.ResponseFunction[Any]">orFail</a> <span class="delimiter">{</span> <a title="unfiltered.request.QParams.Log[String]" id="63121">errors</a> =&gt;
        <a href="../../../unfiltered/unfiltered/unfiltered/response/statuses.scala.html#10581" title="object unfiltered.response.BadRequest">BadRequest</a> <a href="../../../unfiltered/unfiltered/unfiltered/response/functions.scala.html#25428" title="(that: unfiltered.response.ResponseFunction[Any])java.lang.Object with unfiltered.response.ResponseFunction[Any]">~&gt;</a> <a href="../../../unfiltered/unfiltered/unfiltered/response/writers.scala.html#39668" title="(content: String)unfiltered.response.ResponseString">ResponseString</a><span class="delimiter">(</span><a href="#63121" title="unfiltered.request.QParams.Log[String]">errors</a>.<span title="(f: unfiltered.request.QParams.Fail[String] =&gt; String)(implicit bf: scala.collection.generic.CanBuildFrom[List[unfiltered.request.QParams.Fail[String]],String,List[String]])List[String]">map</span> <span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.List.Coll,String,List[String]]" class="delimiter">{</span> <a href="#63147" title="unfiltered.request.QParams.Fail[String]">_</a>.<a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62920" title="=&gt; String">error</a> <span class="delimiter">}</span> <span title="(sep: String)String">mkString</span><span class="delimiter">(</span><span title="java.lang.String(&quot;. &quot;)" class="string">&quot;. &quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>

  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="keyword">trait</span> <a title="trait OAuthed extends java.lang.Object with unfiltered.oauth.OAuthProvider with unfiltered.filter.Plan with ScalaObject" id="13049">OAuthed</a> <span title="ScalaObject" class="keyword">extends</span> <a href="#13076" title="unfiltered.oauth.OAuthProvider">OAuthProvider</a> <span class="keyword">with</span> unfiltered.filter.<a href="../../../filter/unfiltered/filter/plans.scala.html#10374" title="unfiltered.filter.Plan">Plan</a> <span class="delimiter">{</span>
  self: OAuthStores <span class="keyword">with</span> Messages <span class="keyword">with</span> OAuthPaths =&gt;
  <span class="keyword">import</span> unfiltered.filter.request.ContextPath
  <span class="keyword">import</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#10184" title="object unfiltered.request.QParams">QParams</a>._
  <span class="keyword">import</span> <a href="#62162" title="object unfiltered.oauth.OAuth">OAuth</a>._

  <span class="keyword">def</span> <a title="=&gt; PartialFunction[unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest],unfiltered.response.ResponseFunction[javax.servlet.http.HttpServletResponse]]" id="61616">intent</a> = <a href="#63198" title="unfiltered.response.ResponseFunction[javax.servlet.http.HttpServletResponse]" class="delimiter">{</a>
    <span class="keyword">case</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/methods.scala.html#42286" title="~&gt; extends java.lang.Object with unfiltered.response.ResponseFunction[Any]">POST</a><span class="delimiter">(</span><a href="../../../filter/unfiltered/filter/request/paths.scala.html#29686" title="(req: unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest])Some[(java.lang.String, String)]">ContextPath</a><span class="delimiter">(</span>_, <a href="#61639" title="=&gt; String">RequestTokenPath</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/utils.scala.html#42898" title="(a: unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest])Some[(unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest], unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest])]">&amp;</a> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#38447" title="(req: unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest])Some[scala.collection.immutable.Map[String,Seq[String]]]">Params</a><span class="delimiter">(</span><a title="scala.collection.immutable.Map[String,Seq[String]]" id="63229">params</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/utils.scala.html#42898" title="(a: unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest])Some[(unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest], unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest])]">&amp;</a> <a title="unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest]" id="63230">request</a> =&gt;
       <span class="keyword">val</span> <a title="scala.collection.immutable.Map[String,Seq[String]]" id="63231">headers</a> = <a href="../../../unfiltered/unfiltered/unfiltered/request/headers.scala.html#16005" title="(req: unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest])Option[String]">Authorization</a><span class="delimiter">(</span><a href="#63230" title="unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest]">request</a><span class="delimiter">)</span> <span title="scala.collection.immutable.Map[String,Seq[String]]" class="keyword">match</span> <span class="delimiter">{</span>
         <span class="keyword">case</span> <span title="scala.collection.immutable.Map[String,Seq[String]]">Some</span><span class="delimiter">(</span><a title="String" id="63237">a</a><span class="delimiter">)</span> =&gt; <a href="#62162" title="object unfiltered.oauth.OAuth">OAuth</a>.<a href="#61658" title="(hvals: Seq[String])scala.collection.immutable.Map[String,Seq[String]]">Header</a><span class="delimiter">(</span><a href="#63237" title="String">a</a>.<span title="(x$1: java.lang.String)Array[java.lang.String]">split</span><span title="(xs: Array[java.lang.String])scala.collection.mutable.WrappedArray[java.lang.String]" class="delimiter">(</span><span title="java.lang.String(&quot;,&quot;)" class="string">&quot;,&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
         <span class="keyword">case</span> <span title="scala.collection.immutable.Map[String,Seq[String]]">_</span> =&gt; <span title="=&gt; scala.collection.immutable.Map.type">Map</span>.<span title="[A, B]=&gt; scala.collection.immutable.Map[A,B]">empty</span><span title="scala.collection.immutable.Map[String,Seq[String]]" class="delimiter">[</span><span title="String">String</span>, <span title="Seq[String]">Seq</span><span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">]</span>
      <span class="delimiter">}</span>
      <span class="keyword">val</span> <a title="unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[java.lang.String,java.lang.Object with unfiltered.response.ResponseFunction[Any]]]" id="63232">expected</a> = <span class="keyword">for</span> <span class="delimiter">{</span>
        <a title="Option[String]" id="63281">consumer_key</a> &lt;- <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62230" title="(key: String)unfiltered.request.QParams.QueryM[String,Option[String]]">lookup</a><span class="delimiter">(</span><a href="#61575" title="=&gt; java.lang.String">ConsumerKey</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62521" title="(f: Option[String] =&gt; unfiltered.request.QParams.Report[String,String])unfiltered.request.QParams.QueryM[String,Option[String]]">is</a>
          <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62280" title="(e: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">nonempty</a><span class="delimiter">(</span><a href="#61634" title="(param: String)String">blankMsg</a><span class="delimiter">(</span><a href="#61575" title="=&gt; java.lang.String">ConsumerKey</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62512" title="(f: Option[String] =&gt; unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[java.lang.String,java.lang.Object with unfiltered.response.ResponseFunction[Any]]])unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[java.lang.String,java.lang.Object with unfiltered.response.ResponseFunction[Any]]]">is</a> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62238" title="(err: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">required</a><span class="delimiter">(</span><a href="#61635" title="(param: String)String">requiredMsg</a><span class="delimiter">(</span><a href="#61575" title="=&gt; java.lang.String">ConsumerKey</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <a title="Option[String]" id="63302">oauth_signature_method</a> &lt;- <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62230" title="(key: String)unfiltered.request.QParams.QueryM[String,Option[String]]">lookup</a><span class="delimiter">(</span><a href="#61577" title="=&gt; java.lang.String">SignatureMethod</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62521" title="(f: Option[String] =&gt; unfiltered.request.QParams.Report[String,String])unfiltered.request.QParams.QueryM[String,Option[String]]">is</a>
          <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62280" title="(e: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">nonempty</a><span class="delimiter">(</span><a href="#61634" title="(param: String)String">blankMsg</a><span class="delimiter">(</span><a href="#61577" title="=&gt; java.lang.String">SignatureMethod</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62512" title="(f: Option[String] =&gt; unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[java.lang.String,java.lang.Object with unfiltered.response.ResponseFunction[Any]]])unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[java.lang.String,java.lang.Object with unfiltered.response.ResponseFunction[Any]]]">is</a> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62238" title="(err: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">required</a><span class="delimiter">(</span><a href="#61635" title="(param: String)String">requiredMsg</a><span class="delimiter">(</span><a href="#61577" title="=&gt; java.lang.String">SignatureMethod</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <a title="Option[String]" id="63323">timestamp</a> &lt;- <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62230" title="(key: String)unfiltered.request.QParams.QueryM[String,Option[String]]">lookup</a><span class="delimiter">(</span><a href="#61579" title="=&gt; java.lang.String">Timestamp</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62521" title="(f: Option[String] =&gt; unfiltered.request.QParams.Report[String,String])unfiltered.request.QParams.QueryM[String,Option[String]]">is</a>
          <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62280" title="(e: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">nonempty</a><span class="delimiter">(</span><a href="#61634" title="(param: String)String">blankMsg</a><span class="delimiter">(</span><a href="#61579" title="=&gt; java.lang.String">Timestamp</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62512" title="(f: Option[String] =&gt; unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[java.lang.String,java.lang.Object with unfiltered.response.ResponseFunction[Any]]])unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[java.lang.String,java.lang.Object with unfiltered.response.ResponseFunction[Any]]]">is</a> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62238" title="(err: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">required</a><span class="delimiter">(</span><a href="#61635" title="(param: String)String">requiredMsg</a><span class="delimiter">(</span><a href="#61579" title="=&gt; java.lang.String">Timestamp</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <a title="Option[String]" id="63344">nonce</a> &lt;- <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62230" title="(key: String)unfiltered.request.QParams.QueryM[String,Option[String]]">lookup</a><span class="delimiter">(</span><a href="#61581" title="=&gt; java.lang.String">Nonce</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62521" title="(f: Option[String] =&gt; unfiltered.request.QParams.Report[String,String])unfiltered.request.QParams.QueryM[String,Option[String]]">is</a>
          <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62280" title="(e: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">nonempty</a><span class="delimiter">(</span><a href="#61634" title="(param: String)String">blankMsg</a><span class="delimiter">(</span><a href="#61581" title="=&gt; java.lang.String">Nonce</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62512" title="(f: Option[String] =&gt; unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[java.lang.String,java.lang.Object with unfiltered.response.ResponseFunction[Any]]])unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[java.lang.String,java.lang.Object with unfiltered.response.ResponseFunction[Any]]]">is</a> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62238" title="(err: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">required</a><span class="delimiter">(</span><a href="#61635" title="(param: String)String">requiredMsg</a><span class="delimiter">(</span><a href="#61581" title="=&gt; java.lang.String">Nonce</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <a title="Option[String]" id="63365">callback</a> &lt;- <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62230" title="(key: String)unfiltered.request.QParams.QueryM[String,Option[String]]">lookup</a><span class="delimiter">(</span><a href="#61583" title="=&gt; java.lang.String">Callback</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62521" title="(f: Option[String] =&gt; unfiltered.request.QParams.Report[String,String])unfiltered.request.QParams.QueryM[String,Option[String]]">is</a>
          <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62280" title="(e: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">nonempty</a><span class="delimiter">(</span><a href="#61634" title="(param: String)String">blankMsg</a><span class="delimiter">(</span><a href="#61583" title="=&gt; java.lang.String">Callback</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62512" title="(f: Option[String] =&gt; unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[java.lang.String,java.lang.Object with unfiltered.response.ResponseFunction[Any]]])unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[java.lang.String,java.lang.Object with unfiltered.response.ResponseFunction[Any]]]">is</a> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62238" title="(err: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">required</a><span class="delimiter">(</span><a href="#61635" title="(param: String)String">requiredMsg</a><span class="delimiter">(</span><a href="#61583" title="=&gt; java.lang.String">Callback</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <a title="Option[String]" id="63386">signature</a> &lt;- <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62230" title="(key: String)unfiltered.request.QParams.QueryM[String,Option[String]]">lookup</a><span class="delimiter">(</span><a href="#61585" title="=&gt; java.lang.String">Sig</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62521" title="(f: Option[String] =&gt; unfiltered.request.QParams.Report[String,String])unfiltered.request.QParams.QueryM[String,Option[String]]">is</a>
          <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62280" title="(e: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">nonempty</a><span class="delimiter">(</span><a href="#61634" title="(param: String)String">blankMsg</a><span class="delimiter">(</span><a href="#61585" title="=&gt; java.lang.String">Sig</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62512" title="(f: Option[String] =&gt; unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[java.lang.String,java.lang.Object with unfiltered.response.ResponseFunction[Any]]])unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[java.lang.String,java.lang.Object with unfiltered.response.ResponseFunction[Any]]]">is</a> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62238" title="(err: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">required</a><span class="delimiter">(</span><a href="#61635" title="(param: String)String">requiredMsg</a><span class="delimiter">(</span><a href="#61585" title="=&gt; java.lang.String">Sig</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <a title="Option[Option[String]]" id="63419">version</a> &lt;- <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62230" title="(key: String)unfiltered.request.QParams.QueryM[java.lang.String,Option[String]]">lookup</a><span class="delimiter">(</span><a href="#61591" title="=&gt; java.lang.String">Version</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62521" title="(f: Option[String] =&gt; unfiltered.request.QParams.Report[java.lang.String,String])unfiltered.request.QParams.QueryM[java.lang.String,Option[String]]">is</a>
          <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62255" title="(p: String =&gt; Boolean, err: String =&gt; java.lang.String)Option[String] =&gt; unfiltered.request.QParams.Report[java.lang.String,String]">pred</a> <span class="delimiter">(</span> <a href="#63396" title="String">_</a> <span title="(x$1: AnyRef)Boolean">==</span> <span title="java.lang.String(&quot;1.0&quot;)" class="string">&quot;1.0&quot;</span>, <span title="java.lang.String(&quot;invalid oauth version &quot;)" class="string">&quot;invalid oauth version &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#63402" title="String">_</a> <span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62518" title="(f: Option[Option[String]] =&gt; java.lang.Object with unfiltered.response.ResponseFunction[Any])unfiltered.request.QParams.QueryM[java.lang.String,unfiltered.request.QParams.QueryResult[java.lang.String,java.lang.Object with unfiltered.response.ResponseFunction[Any]]]">is</a>
          <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62243" title="[E, A](xs: Option[A])unfiltered.request.QParams.Report[E,Option[A]]">optional</a><a href="#63412" title="(xs: Option[String])unfiltered.request.QParams.Report[String,Option[String]]" class="delimiter">[</a><span title="String">String</span>,<span title="String">String</span><span class="delimiter">]</span>
      <span class="delimiter">}</span> <span class="keyword">yield</span> <span class="delimiter">{</span>
        <span class="comment">// TODO how to extract the full url and not rely on underlying</span>
        <a href="#61604" title="(method: String, url: String, p: Map[String,Seq[String]])unfiltered.oauth.OAuthResponse">requestToken</a><span class="delimiter">(</span><a href="#63230" title="unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest]">request</a>.<a href="../../../unfiltered/unfiltered/unfiltered/request/HttpRequest.scala.html#13897" title="=&gt; String">method</a>, <a href="#63230" title="unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest]">request</a>.<a href="../../../unfiltered/unfiltered/unfiltered/request/HttpRequest.scala.html#13891" title="=&gt; javax.servlet.http.HttpServletRequest">underlying</a>.<span title="()java.lang.StringBuffer">getRequestURL</span>.<span title="()java.lang.String">toString</span>, <a href="#63229" title="scala.collection.immutable.Map[String,Seq[String]]">params</a> <span title="(xs: scala.collection.GenTraversableOnce[(String, Seq[String])])scala.collection.immutable.Map[String,Seq[String]]">++</span> <a href="#63231" title="scala.collection.immutable.Map[String,Seq[String]]">headers</a><span class="delimiter">)</span> <span title="~&gt; extends java.lang.Object with unfiltered.response.ResponseFunction[Any]" class="keyword">match</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> <span title="~&gt; extends java.lang.Object with unfiltered.response.ResponseFunction[Any]">Failure</span><span class="delimiter">(</span><a title="Int" id="63488">status</a>, <a title="String" id="63489">msg</a><span class="delimiter">)</span> =&gt; <a href="#61617" title="(status: Int, msg: String)java.lang.Object with unfiltered.response.ResponseFunction[Any]">fail</a><span class="delimiter">(</span><a href="#63488" title="Int">status</a>, <a href="#63489" title="String">msg</a><span class="delimiter">)</span>
          <span class="keyword">case</span> <a title="~&gt; extends java.lang.Object with unfiltered.response.ResponseFunction[Any]" id="63515">resp</a>: <a href="responses.scala.html#13082" title="unfiltered.oauth.OAuthResponseWriter">OAuthResponseWriter</a> =&gt; <a href="#63515" title="unfiltered.oauth.OAuthResponseWriter">resp</a> <a href="../../../unfiltered/unfiltered/unfiltered/response/functions.scala.html#25428" title="(that: unfiltered.response.ResponseFunction[Any])java.lang.Object with unfiltered.response.ResponseFunction[Any]">~&gt;</a> <a href="../../../unfiltered/unfiltered/unfiltered/response/types.scala.html#10743" title="object unfiltered.response.FormEncodedContent">FormEncodedContent</a>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>

      <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62524" title="(params: unfiltered.request.Params.Map)unfiltered.request.QParams.QueryResult[java.lang.String,java.lang.Object with unfiltered.response.ResponseFunction[Any]]">expected</a><a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62220" title="(r: unfiltered.request.QParams.QueryResult[java.lang.String,java.lang.Object with unfiltered.response.ResponseFunction[Any]])unfiltered.request.QParams.QueryResultX[java.lang.String,java.lang.Object with unfiltered.response.ResponseFunction[Any]]" class="delimiter">(</a><a href="#63229" title="scala.collection.immutable.Map[String,Seq[String]]">params</a> <span title="(xs: scala.collection.GenTraversableOnce[(String, Seq[String])])scala.collection.immutable.Map[String,Seq[String]]">++</span> <a href="#63231" title="scala.collection.immutable.Map[String,Seq[String]]">headers</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62989" title="(handler: unfiltered.request.QParams.Log[java.lang.String] =&gt; java.lang.Object with unfiltered.response.ResponseFunction[Any])java.lang.Object with unfiltered.response.ResponseFunction[Any]">orFail</a> <span class="delimiter">{</span> <a title="unfiltered.request.QParams.Log[java.lang.String]" id="63618">errors</a> =&gt;
        <a href="../../../unfiltered/unfiltered/unfiltered/response/statuses.scala.html#10581" title="object unfiltered.response.BadRequest">BadRequest</a> <a href="../../../unfiltered/unfiltered/unfiltered/response/functions.scala.html#25428" title="(that: unfiltered.response.ResponseFunction[Any])java.lang.Object with unfiltered.response.ResponseFunction[Any]">~&gt;</a> <a href="../../../unfiltered/unfiltered/unfiltered/response/writers.scala.html#39668" title="(content: String)unfiltered.response.ResponseString">ResponseString</a><span class="delimiter">(</span><a href="#63618" title="unfiltered.request.QParams.Log[java.lang.String]">errors</a>.<span title="(f: unfiltered.request.QParams.Fail[java.lang.String] =&gt; java.lang.String)(implicit bf: scala.collection.generic.CanBuildFrom[List[unfiltered.request.QParams.Fail[java.lang.String]],java.lang.String,List[java.lang.String]])List[java.lang.String]">map</span> <span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.List.Coll,java.lang.String,List[java.lang.String]]" class="delimiter">{</span> <a href="#63644" title="unfiltered.request.QParams.Fail[java.lang.String]">_</a>.<a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62920" title="=&gt; java.lang.String">error</a> <span class="delimiter">}</span> <span title="(sep: String)String">mkString</span><span class="delimiter">(</span><span title="java.lang.String(&quot;. &quot;)" class="string">&quot;. &quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>

    <span class="keyword">case</span> <a href="../../../filter/unfiltered/filter/request/paths.scala.html#29686" title="~&gt; extends java.lang.Object with unfiltered.response.ResponseFunction[Any]">ContextPath</a><span class="delimiter">(</span>_, <a href="#61640" title="=&gt; String">AuthorizationPath</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/utils.scala.html#42898" title="(a: unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest])Some[(unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest], unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest])]">&amp;</a> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#38447" title="(req: unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest])Some[scala.collection.immutable.Map[String,Seq[String]]]">Params</a><span class="delimiter">(</span><a title="scala.collection.immutable.Map[String,Seq[String]]" id="63703">params</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/utils.scala.html#42898" title="(a: unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest])Some[(unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest], unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest])]">&amp;</a> <a title="unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest]" id="63704">request</a> =&gt;
      <span class="keyword">val</span> <a title="unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,java.lang.Object with unfiltered.response.ResponseFunction[Any]]]" id="63705">expected</a> = <span class="keyword">for</span> <span class="delimiter">{</span>
        <a title="Option[String]" id="63727">token</a> &lt;- <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62230" title="(key: String)unfiltered.request.QParams.QueryM[String,Option[String]]">lookup</a><span class="delimiter">(</span><a href="#61587" title="=&gt; java.lang.String">TokenKey</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62521" title="(f: Option[String] =&gt; unfiltered.request.QParams.Report[String,String])unfiltered.request.QParams.QueryM[String,Option[String]]">is</a>
          <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62280" title="(e: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">nonempty</a><span class="delimiter">(</span><a href="#61634" title="(param: String)String">blankMsg</a><span class="delimiter">(</span><a href="#61587" title="=&gt; java.lang.String">TokenKey</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62518" title="(f: Option[String] =&gt; java.lang.Object with unfiltered.response.ResponseFunction[Any])unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[String,java.lang.Object with unfiltered.response.ResponseFunction[Any]]]">is</a> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62238" title="(err: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">required</a><span class="delimiter">(</span><a href="#61635" title="(param: String)String">requiredMsg</a><span class="delimiter">(</span><a href="#61587" title="=&gt; java.lang.String">TokenKey</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">yield</span> <span class="delimiter">{</span>
        <a href="#61605" title="(tokenKey: String, request: unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest])unfiltered.oauth.OAuthResponse">authorize</a><span class="delimiter">(</span><a href="#63727" title="Option[String]">token</a>.<span title="=&gt; String">get</span>, <a href="#63704" title="unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest]">request</a><span class="delimiter">)</span> <span title="~&gt; extends java.lang.Object with unfiltered.response.ResponseFunction[Any]" class="keyword">match</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> <span title="~&gt; extends java.lang.Object with unfiltered.response.ResponseFunction[Any]">Failure</span><span class="delimiter">(</span><a title="Int" id="63738">code</a>, <a title="String" id="63739">msg</a><span class="delimiter">)</span> =&gt; <a href="#61617" title="(status: Int, msg: String)java.lang.Object with unfiltered.response.ResponseFunction[Any]">fail</a><span class="delimiter">(</span><a href="#63738" title="Int">code</a>, <a href="#63739" title="String">msg</a><span class="delimiter">)</span>
          <span class="keyword">case</span> <span title="~&gt; extends java.lang.Object with unfiltered.response.ResponseFunction[Any]">HostResponse</span><span class="delimiter">(</span><a title="unfiltered.response.ResponseFunction[Any]" id="63775">resp</a><span class="delimiter">)</span> =&gt; <a href="../../../unfiltered/unfiltered/unfiltered/response/statuses.scala.html#10935" title="object unfiltered.response.Ok">Ok</a> <a href="../../../unfiltered/unfiltered/unfiltered/response/functions.scala.html#25428" title="(that: unfiltered.response.ResponseFunction[Any])java.lang.Object with unfiltered.response.ResponseFunction[Any]">~&gt;</a> <a href="#63775" title="unfiltered.response.ResponseFunction[Any]">resp</a>
          <span class="keyword">case</span> <span title="unfiltered.response.ResponseFunction[Any]">AuthorizeResponse</span><span class="delimiter">(</span><a title="String" id="63830">callback</a>, <a title="String" id="63831">token</a>, <a title="String" id="63832">verifier</a><span class="delimiter">)</span> =&gt; <a href="#63830" title="String">callback</a> <span title="unfiltered.response.ResponseFunction[Any]" class="keyword">match</span> <span class="delimiter">{</span>
            <span class="keyword">case</span> <a href="#62162" title="unfiltered.response.ResponseFunction[Any]">OAuth</a>.<a href="#61593" title="=&gt; java.lang.String">Oob</a> =&gt; <a href="stores.scala.html#61633" title="=&gt; unfiltered.oauth.UserHost">users</a>.<a href="users.scala.html#63834" title="(verifier: String)unfiltered.response.ResponseFunction[Any]">oobResponse</a><span class="delimiter">(</span><a href="#63832" title="String">verifier</a><span class="delimiter">)</span>
            <span class="keyword">case</span> <span title="unfiltered.response.Redirect">_</span> =&gt; <a href="../../../unfiltered/unfiltered/unfiltered/response/redirect.scala.html#63849" title="(loc: String)unfiltered.response.Redirect">Redirect</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;%s%soauth_token=%s&amp;oauth_verifier=%s&quot;</span> <span title="(args: Any*)String">format</span><span class="delimiter">(</span>
              <a href="#63830" title="String">callback</a>, <span title="Any" class="keyword">if</span><span class="delimiter">(</span><a href="#63830" title="String">callback</a>.<span title="(x$1: java.lang.CharSequence)Boolean">contains</span><span class="delimiter">(</span><span title="java.lang.String(&quot;?&quot;)" class="string">&quot;?&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span> <span title="java.lang.String(&quot;&amp;&quot;)" class="string">&quot;&amp;&quot;</span> <span class="keyword">else</span> <span title="java.lang.String(&quot;?&quot;)" class="string">&quot;?&quot;</span>, <a href="#63831" title="String">token</a>, <a href="#63832" title="String">verifier</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <span class="delimiter">}</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>

      <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62524" title="(params: unfiltered.request.Params.Map)unfiltered.request.QParams.QueryResult[String,java.lang.Object with unfiltered.response.ResponseFunction[Any]]">expected</a><a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62220" title="(r: unfiltered.request.QParams.QueryResult[String,java.lang.Object with unfiltered.response.ResponseFunction[Any]])unfiltered.request.QParams.QueryResultX[String,java.lang.Object with unfiltered.response.ResponseFunction[Any]]" class="delimiter">(</a><a href="#63703" title="scala.collection.immutable.Map[String,Seq[String]]">params</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62989" title="(handler: unfiltered.request.QParams.Log[String] =&gt; java.lang.Object with unfiltered.response.ResponseFunction[Any])java.lang.Object with unfiltered.response.ResponseFunction[Any]">orFail</a> <span class="delimiter">{</span> <a title="unfiltered.request.QParams.Log[String]" id="63900">errors</a> =&gt;
        <a href="../../../unfiltered/unfiltered/unfiltered/response/statuses.scala.html#10581" title="object unfiltered.response.BadRequest">BadRequest</a> <a href="../../../unfiltered/unfiltered/unfiltered/response/functions.scala.html#25428" title="(that: unfiltered.response.ResponseFunction[Any])java.lang.Object with unfiltered.response.ResponseFunction[Any]">~&gt;</a> <a href="../../../unfiltered/unfiltered/unfiltered/response/writers.scala.html#39668" title="(content: String)unfiltered.response.ResponseString">ResponseString</a><span class="delimiter">(</span><a href="#63900" title="unfiltered.request.QParams.Log[String]">errors</a>.<span title="(f: unfiltered.request.QParams.Fail[String] =&gt; String)(implicit bf: scala.collection.generic.CanBuildFrom[List[unfiltered.request.QParams.Fail[String]],String,List[String]])List[String]">map</span> <span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.List.Coll,String,List[String]]" class="delimiter">{</span> <a href="#63926" title="unfiltered.request.QParams.Fail[String]">_</a>.<a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62920" title="=&gt; String">error</a> <span class="delimiter">}</span> <span title="(sep: String)String">mkString</span><span class="delimiter">(</span><span title="java.lang.String(&quot;. &quot;)" class="string">&quot;. &quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>

    <span class="keyword">case</span> <a title="~&gt; extends java.lang.Object with unfiltered.response.ResponseFunction[Any]" id="63961">request</a> @ <a href="../../../unfiltered/unfiltered/unfiltered/request/methods.scala.html#42286" title="(req: unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest])Option[unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest]]">POST</a><span class="delimiter">(</span><a href="../../../filter/unfiltered/filter/request/paths.scala.html#29686" title="(req: unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest])Some[(java.lang.String, String)]">ContextPath</a><span class="delimiter">(</span>_, <a href="#61641" title="=&gt; String">AccessTokenPath</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/utils.scala.html#42898" title="(a: unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest])Some[(unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest], unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest])]">&amp;</a> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#38447" title="(req: unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest])Some[scala.collection.immutable.Map[String,Seq[String]]]">Params</a><span class="delimiter">(</span><a title="scala.collection.immutable.Map[String,Seq[String]]" id="63986">params</a><span class="delimiter">)</span><span class="delimiter">)</span> =&gt;
      <span class="keyword">val</span> <a title="scala.collection.immutable.Map[String,Seq[String]]" id="63987">headers</a> = <a href="../../../unfiltered/unfiltered/unfiltered/request/headers.scala.html#16005" title="(req: unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest])Option[String]">Authorization</a><span class="delimiter">(</span><a href="#63961" title="unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest]">request</a><span class="delimiter">)</span> <span title="scala.collection.immutable.Map[String,Seq[String]]" class="keyword">match</span> <span class="delimiter">{</span>
         <span class="keyword">case</span> <span title="scala.collection.immutable.Map[String,Seq[String]]">Some</span><span class="delimiter">(</span><a title="String" id="63993">a</a><span class="delimiter">)</span> =&gt; <a href="#62162" title="object unfiltered.oauth.OAuth">OAuth</a>.<a href="#61658" title="(hvals: Seq[String])scala.collection.immutable.Map[String,Seq[String]]">Header</a><span class="delimiter">(</span><a href="#63993" title="String">a</a>.<span title="(x$1: java.lang.String)Array[java.lang.String]">split</span><span title="(xs: Array[java.lang.String])scala.collection.mutable.WrappedArray[java.lang.String]" class="delimiter">(</span><span title="java.lang.String(&quot;,&quot;)" class="string">&quot;,&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
         <span class="keyword">case</span> <span title="scala.collection.immutable.Map[String,Seq[String]]">_</span> =&gt; <span title="=&gt; scala.collection.immutable.Map.type">Map</span>.<span title="[A, B]=&gt; scala.collection.immutable.Map[A,B]">empty</span><span title="scala.collection.immutable.Map[String,Seq[String]]" class="delimiter">[</span><span title="String">String</span>, <span title="Seq[String]">Seq</span><span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">]</span>
      <span class="delimiter">}</span>
      <span class="keyword">val</span> <a title="unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[java.lang.String,java.lang.Object with unfiltered.response.ResponseFunction[Any]]]" id="63988">expected</a> = <span class="keyword">for</span> <span class="delimiter">{</span>
        <a title="Option[String]" id="64036">consumer_key</a> &lt;- <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62230" title="(key: String)unfiltered.request.QParams.QueryM[String,Option[String]]">lookup</a><span class="delimiter">(</span><a href="#61575" title="=&gt; java.lang.String">ConsumerKey</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62521" title="(f: Option[String] =&gt; unfiltered.request.QParams.Report[String,String])unfiltered.request.QParams.QueryM[String,Option[String]]">is</a>
          <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62280" title="(e: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">nonempty</a><span class="delimiter">(</span><a href="#61634" title="(param: String)String">blankMsg</a><span class="delimiter">(</span><a href="#61575" title="=&gt; java.lang.String">ConsumerKey</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62512" title="(f: Option[String] =&gt; unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[java.lang.String,java.lang.Object with unfiltered.response.ResponseFunction[Any]]])unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[java.lang.String,java.lang.Object with unfiltered.response.ResponseFunction[Any]]]">is</a> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62238" title="(err: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">required</a><span class="delimiter">(</span><a href="#61635" title="(param: String)String">requiredMsg</a><span class="delimiter">(</span><a href="#61575" title="=&gt; java.lang.String">ConsumerKey</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <a title="Option[String]" id="64057">oauth_signature_method</a> &lt;- <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62230" title="(key: String)unfiltered.request.QParams.QueryM[String,Option[String]]">lookup</a><span class="delimiter">(</span><a href="#61577" title="=&gt; java.lang.String">SignatureMethod</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62521" title="(f: Option[String] =&gt; unfiltered.request.QParams.Report[String,String])unfiltered.request.QParams.QueryM[String,Option[String]]">is</a>
          <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62280" title="(e: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">nonempty</a><span class="delimiter">(</span><a href="#61634" title="(param: String)String">blankMsg</a><span class="delimiter">(</span><a href="#61577" title="=&gt; java.lang.String">SignatureMethod</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62512" title="(f: Option[String] =&gt; unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[java.lang.String,java.lang.Object with unfiltered.response.ResponseFunction[Any]]])unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[java.lang.String,java.lang.Object with unfiltered.response.ResponseFunction[Any]]]">is</a> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62238" title="(err: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">required</a><span class="delimiter">(</span><a href="#61635" title="(param: String)String">requiredMsg</a><span class="delimiter">(</span><a href="#61577" title="=&gt; java.lang.String">SignatureMethod</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <a title="Option[String]" id="64078">timestamp</a> &lt;- <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62230" title="(key: String)unfiltered.request.QParams.QueryM[String,Option[String]]">lookup</a><span class="delimiter">(</span><a href="#61579" title="=&gt; java.lang.String">Timestamp</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62521" title="(f: Option[String] =&gt; unfiltered.request.QParams.Report[String,String])unfiltered.request.QParams.QueryM[String,Option[String]]">is</a>
          <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62280" title="(e: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">nonempty</a><span class="delimiter">(</span><a href="#61634" title="(param: String)String">blankMsg</a><span class="delimiter">(</span><a href="#61579" title="=&gt; java.lang.String">Timestamp</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62512" title="(f: Option[String] =&gt; unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[java.lang.String,java.lang.Object with unfiltered.response.ResponseFunction[Any]]])unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[java.lang.String,java.lang.Object with unfiltered.response.ResponseFunction[Any]]]">is</a> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62238" title="(err: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">required</a><span class="delimiter">(</span><a href="#61635" title="(param: String)String">requiredMsg</a><span class="delimiter">(</span><a href="#61579" title="=&gt; java.lang.String">Timestamp</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <a title="Option[String]" id="64099">nonce</a> &lt;- <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62230" title="(key: String)unfiltered.request.QParams.QueryM[String,Option[String]]">lookup</a><span class="delimiter">(</span><a href="#61581" title="=&gt; java.lang.String">Nonce</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62521" title="(f: Option[String] =&gt; unfiltered.request.QParams.Report[String,String])unfiltered.request.QParams.QueryM[String,Option[String]]">is</a>
          <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62280" title="(e: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">nonempty</a><span class="delimiter">(</span><a href="#61634" title="(param: String)String">blankMsg</a><span class="delimiter">(</span><a href="#61581" title="=&gt; java.lang.String">Nonce</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62512" title="(f: Option[String] =&gt; unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[java.lang.String,java.lang.Object with unfiltered.response.ResponseFunction[Any]]])unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[java.lang.String,java.lang.Object with unfiltered.response.ResponseFunction[Any]]]">is</a> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62238" title="(err: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">required</a><span class="delimiter">(</span><a href="#61635" title="(param: String)String">requiredMsg</a><span class="delimiter">(</span><a href="#61581" title="=&gt; java.lang.String">Nonce</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <a title="Option[String]" id="64120">token</a> &lt;- <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62230" title="(key: String)unfiltered.request.QParams.QueryM[String,Option[String]]">lookup</a><span class="delimiter">(</span><a href="#61587" title="=&gt; java.lang.String">TokenKey</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62521" title="(f: Option[String] =&gt; unfiltered.request.QParams.Report[String,String])unfiltered.request.QParams.QueryM[String,Option[String]]">is</a>
          <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62280" title="(e: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">nonempty</a><span class="delimiter">(</span><a href="#61634" title="(param: String)String">blankMsg</a><span class="delimiter">(</span><a href="#61587" title="=&gt; java.lang.String">TokenKey</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62512" title="(f: Option[String] =&gt; unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[java.lang.String,java.lang.Object with unfiltered.response.ResponseFunction[Any]]])unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[java.lang.String,java.lang.Object with unfiltered.response.ResponseFunction[Any]]]">is</a> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62238" title="(err: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">required</a><span class="delimiter">(</span><a href="#61635" title="(param: String)String">requiredMsg</a><span class="delimiter">(</span><a href="#61587" title="=&gt; java.lang.String">TokenKey</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <a title="Option[String]" id="64141">verifier</a> &lt;- <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62230" title="(key: String)unfiltered.request.QParams.QueryM[String,Option[String]]">lookup</a><span class="delimiter">(</span><a href="#61589" title="=&gt; java.lang.String">Verifier</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62521" title="(f: Option[String] =&gt; unfiltered.request.QParams.Report[String,String])unfiltered.request.QParams.QueryM[String,Option[String]]">is</a>
          <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62280" title="(e: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">nonempty</a><span class="delimiter">(</span><a href="#61634" title="(param: String)String">blankMsg</a><span class="delimiter">(</span><a href="#61589" title="=&gt; java.lang.String">Verifier</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62512" title="(f: Option[String] =&gt; unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[java.lang.String,java.lang.Object with unfiltered.response.ResponseFunction[Any]]])unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[java.lang.String,java.lang.Object with unfiltered.response.ResponseFunction[Any]]]">is</a> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62238" title="(err: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">required</a><span class="delimiter">(</span><a href="#61635" title="(param: String)String">requiredMsg</a><span class="delimiter">(</span><a href="#61589" title="=&gt; java.lang.String">Verifier</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <a title="Option[String]" id="64162">signature</a> &lt;- <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62230" title="(key: String)unfiltered.request.QParams.QueryM[String,Option[String]]">lookup</a><span class="delimiter">(</span><a href="#61585" title="=&gt; java.lang.String">Sig</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62521" title="(f: Option[String] =&gt; unfiltered.request.QParams.Report[String,String])unfiltered.request.QParams.QueryM[String,Option[String]]">is</a>
          <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62280" title="(e: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">nonempty</a><span class="delimiter">(</span><a href="#61634" title="(param: String)String">blankMsg</a><span class="delimiter">(</span><a href="#61585" title="=&gt; java.lang.String">Sig</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62512" title="(f: Option[String] =&gt; unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[java.lang.String,java.lang.Object with unfiltered.response.ResponseFunction[Any]]])unfiltered.request.QParams.QueryM[String,unfiltered.request.QParams.QueryResult[java.lang.String,java.lang.Object with unfiltered.response.ResponseFunction[Any]]]">is</a> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62238" title="(err: String)Option[String] =&gt; unfiltered.request.QParams.Report[String,String]">required</a><span class="delimiter">(</span><a href="#61635" title="(param: String)String">requiredMsg</a><span class="delimiter">(</span><a href="#61585" title="=&gt; java.lang.String">Sig</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <a title="Option[Option[String]]" id="64195">version</a> &lt;- <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62230" title="(key: String)unfiltered.request.QParams.QueryM[java.lang.String,Option[String]]">lookup</a><span class="delimiter">(</span><a href="#61591" title="=&gt; java.lang.String">Version</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62521" title="(f: Option[String] =&gt; unfiltered.request.QParams.Report[java.lang.String,String])unfiltered.request.QParams.QueryM[java.lang.String,Option[String]]">is</a>
          <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62255" title="(p: String =&gt; Boolean, err: String =&gt; java.lang.String)Option[String] =&gt; unfiltered.request.QParams.Report[java.lang.String,String]">pred</a> <span class="delimiter">(</span> <a href="#64172" title="String">_</a> <span title="(x$1: AnyRef)Boolean">==</span> <span title="java.lang.String(&quot;1.0&quot;)" class="string">&quot;1.0&quot;</span>, <span title="java.lang.String(&quot;invalid oauth version &quot;)" class="string">&quot;invalid oauth version &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#64178" title="String">_</a> <span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62518" title="(f: Option[Option[String]] =&gt; java.lang.Object with unfiltered.response.ResponseFunction[Any])unfiltered.request.QParams.QueryM[java.lang.String,unfiltered.request.QParams.QueryResult[java.lang.String,java.lang.Object with unfiltered.response.ResponseFunction[Any]]]">is</a>
          <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62243" title="[E, A](xs: Option[A])unfiltered.request.QParams.Report[E,Option[A]]">optional</a><a href="#64188" title="(xs: Option[String])unfiltered.request.QParams.Report[String,Option[String]]" class="delimiter">[</a><span title="String">String</span>,<span title="String">String</span><span class="delimiter">]</span>
      <span class="delimiter">}</span> <span class="keyword">yield</span> <span class="delimiter">{</span>
        <a href="#61608" title="(method: String, url: String, p: Map[String,Seq[String]])unfiltered.oauth.OAuthResponse">accessToken</a><span class="delimiter">(</span><a href="#63961" title="unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest]">request</a>.<a href="../../../unfiltered/unfiltered/unfiltered/request/HttpRequest.scala.html#13897" title="=&gt; String">method</a>, <a href="#63961" title="unfiltered.request.HttpRequest[javax.servlet.http.HttpServletRequest]">request</a>.<a href="../../../unfiltered/unfiltered/unfiltered/request/HttpRequest.scala.html#13891" title="=&gt; javax.servlet.http.HttpServletRequest">underlying</a>.<span title="()java.lang.StringBuffer">getRequestURL</span>.<span title="()java.lang.String">toString</span>, <a href="#63986" title="scala.collection.immutable.Map[String,Seq[String]]">params</a> <span title="(xs: scala.collection.GenTraversableOnce[(String, Seq[String])])scala.collection.immutable.Map[String,Seq[String]]">++</span> <a href="#63987" title="scala.collection.immutable.Map[String,Seq[String]]">headers</a><span class="delimiter">)</span> <span title="~&gt; extends java.lang.Object with unfiltered.response.ResponseFunction[Any]" class="keyword">match</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> <span title="~&gt; extends java.lang.Object with unfiltered.response.ResponseFunction[Any]">Failure</span><span class="delimiter">(</span><a title="Int" id="64264">code</a>, <a title="String" id="64265">msg</a><span class="delimiter">)</span> =&gt; <a href="#61617" title="(status: Int, msg: String)java.lang.Object with unfiltered.response.ResponseFunction[Any]">fail</a><span class="delimiter">(</span><a href="#64264" title="Int">code</a>, <a href="#64265" title="String">msg</a><span class="delimiter">)</span>
          <span class="keyword">case</span> <a title="~&gt; extends java.lang.Object with unfiltered.response.ResponseFunction[Any]" id="64266">resp</a>@AccessResponse<span class="delimiter">(</span>_, _<span class="delimiter">)</span> =&gt;
            <a href="#64266" title="unfiltered.oauth.AccessResponse">resp</a> <a href="../../../unfiltered/unfiltered/unfiltered/response/functions.scala.html#25428" title="(that: unfiltered.response.ResponseFunction[Any])java.lang.Object with unfiltered.response.ResponseFunction[Any]">~&gt;</a> <a href="../../../unfiltered/unfiltered/unfiltered/response/types.scala.html#10743" title="object unfiltered.response.FormEncodedContent">FormEncodedContent</a>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>

      <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62524" title="(params: unfiltered.request.Params.Map)unfiltered.request.QParams.QueryResult[java.lang.String,java.lang.Object with unfiltered.response.ResponseFunction[Any]]">expected</a><a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62220" title="(r: unfiltered.request.QParams.QueryResult[java.lang.String,java.lang.Object with unfiltered.response.ResponseFunction[Any]])unfiltered.request.QParams.QueryResultX[java.lang.String,java.lang.Object with unfiltered.response.ResponseFunction[Any]]" class="delimiter">(</a><a href="#63986" title="scala.collection.immutable.Map[String,Seq[String]]">params</a> <span title="(xs: scala.collection.GenTraversableOnce[(String, Seq[String])])scala.collection.immutable.Map[String,Seq[String]]">++</span> <a href="#63987" title="scala.collection.immutable.Map[String,Seq[String]]">headers</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62989" title="(handler: unfiltered.request.QParams.Log[java.lang.String] =&gt; java.lang.Object with unfiltered.response.ResponseFunction[Any])java.lang.Object with unfiltered.response.ResponseFunction[Any]">orFail</a> <span class="delimiter">{</span> <a title="unfiltered.request.QParams.Log[java.lang.String]" id="64404">fails</a> =&gt;
        <a href="../../../unfiltered/unfiltered/unfiltered/response/statuses.scala.html#10581" title="object unfiltered.response.BadRequest">BadRequest</a> <a href="../../../unfiltered/unfiltered/unfiltered/response/functions.scala.html#25428" title="(that: unfiltered.response.ResponseFunction[Any])java.lang.Object with unfiltered.response.ResponseFunction[Any]">~&gt;</a> <a href="../../../unfiltered/unfiltered/unfiltered/response/writers.scala.html#39668" title="(content: String)unfiltered.response.ResponseString">ResponseString</a><span class="delimiter">(</span><a href="#64404" title="unfiltered.request.QParams.Log[java.lang.String]">fails</a>.<span title="(f: unfiltered.request.QParams.Fail[java.lang.String] =&gt; java.lang.String)(implicit bf: scala.collection.generic.CanBuildFrom[List[unfiltered.request.QParams.Fail[java.lang.String]],java.lang.String,List[java.lang.String]])List[java.lang.String]">map</span> <span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.List.Coll,java.lang.String,List[java.lang.String]]" class="delimiter">{</span> <a href="#64430" title="unfiltered.request.QParams.Fail[java.lang.String]">_</a>.<a href="../../../unfiltered/unfiltered/unfiltered/request/params.scala.html#62920" title="=&gt; java.lang.String">error</a> <span class="delimiter">}</span> <span title="(sep: String)String">mkString</span><span class="delimiter">(</span><span title="java.lang.String(&quot;. &quot;)" class="string">&quot;. &quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(status: Int, msg: String)java.lang.Object with unfiltered.response.ResponseFunction[Any]" id="61617">fail</a><span class="delimiter">(</span><a title="Int" id="63490">status</a>: <span title="Int">Int</span>, <a title="String" id="63491">msg</a>: <span title="String">String</span><span class="delimiter">)</span> =
    <a href="../../../unfiltered/unfiltered/unfiltered/response/statuses.scala.html#63496" title="(code: Int)unfiltered.response.Status">Status</a><span class="delimiter">(</span><a href="#63490" title="Int">status</a><span class="delimiter">)</span> <a href="../../../unfiltered/unfiltered/unfiltered/response/functions.scala.html#25428" title="(that: unfiltered.response.ResponseFunction[Any])java.lang.Object with unfiltered.response.ResponseFunction[Any]">~&gt;</a> <a href="../../../unfiltered/unfiltered/unfiltered/response/writers.scala.html#39668" title="(content: String)unfiltered.response.ResponseString">ResponseString</a><span class="delimiter">(</span><a href="#63491" title="String">msg</a><span class="delimiter">)</span>
<span class="delimiter">}</span>

<span class="comment">/** Configured OAuthed class that satisfies requirements for OAuthStores */</span>
case <span class="keyword">class</span> <a title="(x$0: unfiltered.oauth.OAuth)Option[unfiltered.oauth.OAuthStores]" id="64493">OAuth</a><a href="#64493" title="ScalaObject" class="delimiter">(</a><a title="unfiltered.oauth.OAuthStores" id="64474">stores</a>: <a href="stores.scala.html#13085" title="unfiltered.oauth.OAuthStores">OAuthStores</a><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#13049" title="unfiltered.oauth.OAuthed">OAuthed</a>
     <span class="keyword">with</span> <a href="stores.scala.html#13085" title="unfiltered.oauth.OAuthStores">OAuthStores</a> <span class="keyword">with</span> <a href="#12905" title="unfiltered.oauth.DefaultMessages">DefaultMessages</a> <span class="keyword">with</span> <a href="#12908" title="unfiltered.oauth.DefaultOAuthPaths">DefaultOAuthPaths</a> <span class="delimiter">{</span>
  <span class="keyword">val</span> <a title="unfiltered.oauth.NonceStore" id="61622">nonces</a> = <a href="#64474" title="=&gt; unfiltered.oauth.OAuthStores">stores</a>.<a href="stores.scala.html#61630" title="=&gt; unfiltered.oauth.NonceStore">nonces</a>
  <span class="keyword">val</span> <a title="unfiltered.oauth.TokenStore" id="61624">tokens</a> = <a href="#64474" title="=&gt; unfiltered.oauth.OAuthStores">stores</a>.<a href="stores.scala.html#61631" title="=&gt; unfiltered.oauth.TokenStore">tokens</a>
  <span class="keyword">val</span> <a title="unfiltered.oauth.ConsumerStore" id="61626">consumers</a> = <a href="#64474" title="=&gt; unfiltered.oauth.OAuthStores">stores</a>.<a href="stores.scala.html#61632" title="=&gt; unfiltered.oauth.ConsumerStore">consumers</a>
  <span class="keyword">val</span> <a title="unfiltered.oauth.UserHost" id="61628">users</a> = <a href="#64474" title="=&gt; unfiltered.oauth.OAuthStores">stores</a>.<a href="stores.scala.html#61633" title="=&gt; unfiltered.oauth.UserHost">users</a>
<span class="delimiter">}</span>

case <span class="keyword">class</span> <a title="class Protection extends java.lang.Object with unfiltered.oauth.Protected with unfiltered.oauth.OAuthStores with unfiltered.oauth.DefaultMessages with ScalaObject with Product with Serializable" id="65656">Protection</a><a href="#65656" title="ScalaObject" class="delimiter">(</a><a title="unfiltered.oauth.OAuthStores" id="65653">stores</a>: <a href="stores.scala.html#13085" title="unfiltered.oauth.OAuthStores">OAuthStores</a><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#13133" title="unfiltered.oauth.Protected">Protected</a>
    <span class="keyword">with</span> <a href="stores.scala.html#13085" title="unfiltered.oauth.OAuthStores">OAuthStores</a> <span class="keyword">with</span> <a href="#12905" title="unfiltered.oauth.DefaultMessages">DefaultMessages</a> <span class="delimiter">{</span>
  <span class="keyword">val</span> <a title="unfiltered.oauth.NonceStore" id="64499">nonces</a> = <a href="#65653" title="=&gt; unfiltered.oauth.OAuthStores">stores</a>.<a href="stores.scala.html#61630" title="=&gt; unfiltered.oauth.NonceStore">nonces</a>
  <span class="keyword">val</span> <a title="unfiltered.oauth.TokenStore" id="64501">tokens</a> = <a href="#65653" title="=&gt; unfiltered.oauth.OAuthStores">stores</a>.<a href="stores.scala.html#61631" title="=&gt; unfiltered.oauth.TokenStore">tokens</a>
  <span class="keyword">val</span> <a title="unfiltered.oauth.ConsumerStore" id="64503">consumers</a> = <a href="#65653" title="=&gt; unfiltered.oauth.OAuthStores">stores</a>.<a href="stores.scala.html#61632" title="=&gt; unfiltered.oauth.ConsumerStore">consumers</a>
  <span class="keyword">val</span> <a title="unfiltered.oauth.UserHost" id="64505">users</a> = <a href="#65653" title="=&gt; unfiltered.oauth.OAuthStores">stores</a>.<a href="stores.scala.html#61633" title="=&gt; unfiltered.oauth.UserHost">users</a>
<span class="delimiter">}</span>

<span class="keyword">trait</span> <a title="trait OAuthProvider extends java.lang.Object with ScalaObject" id="13076">OAuthProvider</a> <span title="ScalaObject" class="delimiter">{</span> self: OAuthStores =&gt;
  <span class="keyword">import</span> <a href="#62162" title="object unfiltered.oauth.OAuth">OAuth</a>._

  <span class="keyword">def</span> <a title="(method: String, url: String, p: Map[String,Seq[String]])unfiltered.oauth.OAuthResponse" id="61603">protect</a><span class="delimiter">(</span><a title="String" id="62751">method</a>: <span title="String">String</span>, <a title="String" id="62752">url</a>: <span title="String">String</span>, <a title="Map[String,Seq[String]]" id="62753">p</a>: <span title="Map[String,Seq[String]]">Map</span><span class="delimiter">[</span>String, Seq<span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span>: <a href="responses.scala.html#13079" title="unfiltered.oauth.OAuthResponse">OAuthResponse</a> =
    <span title="unfiltered.oauth.OAuthResponse" class="keyword">if</span><span class="delimiter">(</span><a href="#61610" title="(consumer: String, timestamp: String, nonce: String)Boolean">nonceValid</a><span class="delimiter">(</span><a href="#62753" title="(key: String)Seq[String]">p</a><span title="(idx: Int)String" class="delimiter">(</span><a href="#61575" title="=&gt; java.lang.String">ConsumerKey</a><span class="delimiter">)</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>, <a href="#62753" title="(key: String)Seq[String]">p</a><span title="(idx: Int)String" class="delimiter">(</span><a href="#61579" title="=&gt; java.lang.String">Timestamp</a><span class="delimiter">)</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>, <a href="#62753" title="(key: String)Seq[String]">p</a><span title="(idx: Int)String" class="delimiter">(</span><a href="#61581" title="=&gt; java.lang.String">Nonce</a><span class="delimiter">)</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">(</span><span class="keyword">for</span> <span class="delimiter">{</span>
      <a title="unfiltered.oauth.Consumer" id="64665">consumer</a> &lt;- <a href="stores.scala.html#61632" title="=&gt; unfiltered.oauth.ConsumerStore">consumers</a>.<a href="consumers.scala.html#61534" title="(key: String)Option[unfiltered.oauth.Consumer]">get</a><span title="(f: unfiltered.oauth.Consumer =&gt; unfiltered.oauth.OAuthResponse)Option[unfiltered.oauth.OAuthResponse]" class="delimiter">(</span><a href="#62753" title="(key: String)Seq[String]">p</a><span title="(idx: Int)String" class="delimiter">(</span><a href="#61575" title="=&gt; java.lang.String">ConsumerKey</a><span class="delimiter">)</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span> <span class="keyword">yield</span> <span class="delimiter">{</span>
      <a href="stores.scala.html#61631" title="=&gt; unfiltered.oauth.TokenStore">tokens</a>.<a href="tokens.scala.html#64470" title="(tokenId: String)Option[unfiltered.oauth.Token]">get</a><span class="delimiter">(</span><a href="#62753" title="(key: String)Seq[String]">p</a><span title="(idx: Int)String" class="delimiter">(</span><a href="#61587" title="=&gt; java.lang.String">TokenKey</a><span class="delimiter">)</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span><span class="delimiter">)</span> <span title="unfiltered.oauth.OAuthResponse" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <span title="unfiltered.oauth.OAuthResponse">Some</span><span class="delimiter">(</span>AccessToken<span class="delimiter">(</span><a title="String" id="64750">tokenKey</a>, <a title="String" id="64751">tokenSecret</a>, <a title="String" id="64752">user</a>, <a title="String" id="64753">consumerKey</a><span class="delimiter">)</span><span class="delimiter">)</span> =&gt;
          <span title="unfiltered.oauth.OAuthResponse" class="keyword">if</span><span class="delimiter">(</span><a href="#64753" title="String">consumerKey</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#64665" title="unfiltered.oauth.Consumer">consumer</a>.<a href="consumers.scala.html#61531" title="=&gt; String">key</a><span class="delimiter">)</span> <span class="delimiter">{</span>
            <span title="unfiltered.oauth.OAuthResponse" class="keyword">if</span><span class="delimiter">(</span><a href="signatures.scala.html#13185" title="object unfiltered.oauth.Signatures">Signatures</a>.<a href="signatures.scala.html#64771" title="(method: String, url: String, p: unfiltered.oauth.Signatures.Params, consumerSec: String, tokenSec: String)Boolean">verify</a><span class="delimiter">(</span><a href="#62751" title="String">method</a>, <a href="#62752" title="String">url</a>, <a href="#62753" title="Map[String,Seq[String]]">p</a>, <a href="#64665" title="unfiltered.oauth.Consumer">consumer</a>.<a href="consumers.scala.html#61532" title="=&gt; String">secret</a>, <a href="#64751" title="String">tokenSecret</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
              <a href="responses.scala.html#62876" title="(user: String)unfiltered.oauth.Authorized">Authorized</a><span class="delimiter">(</span><a href="#64752" title="String">user</a><span class="delimiter">)</span>
            <span class="delimiter">}</span> <span class="keyword">else</span> <a href="#61609" title="(status: Int, msg: String)unfiltered.oauth.OAuthResponse">challenge</a><span class="delimiter">(</span><span title="Int(400)" class="int">400</span>, <span title="java.lang.String(&quot;invalid signature&quot;)" class="string">&quot;invalid signature&quot;</span><span class="delimiter">)</span>
          <span class="delimiter">}</span> <span class="keyword">else</span> <a href="#61609" title="(status: Int, msg: String)unfiltered.oauth.OAuthResponse">challenge</a><span class="delimiter">(</span><span title="Int(400)" class="int">400</span>, <span title="java.lang.String(&quot;invalid token&quot;)" class="string">&quot;invalid token&quot;</span><span class="delimiter">)</span>
        <span class="keyword">case</span> <span title="unfiltered.oauth.OAuthResponse">_</span> =&gt; <a href="#61609" title="(status: Int, msg: String)unfiltered.oauth.OAuthResponse">challenge</a><span class="delimiter">(</span><span title="Int(400)" class="int">400</span>, <span title="java.lang.String(&quot;invalid token&quot;)" class="string">&quot;invalid token&quot;</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span><span class="delimiter">)</span> <span title="(default: =&gt; unfiltered.oauth.OAuthResponse)unfiltered.oauth.OAuthResponse">getOrElse</span> <a href="#61609" title="(status: Int, msg: String)unfiltered.oauth.OAuthResponse">challenge</a><span class="delimiter">(</span><span title="Int(400)" class="int">400</span>, <span title="java.lang.String(&quot;invalid consumer&quot;)" class="string">&quot;invalid consumer&quot;</span><span class="delimiter">)</span>
    <span class="keyword">else</span> <a href="#61609" title="(status: Int, msg: String)unfiltered.oauth.OAuthResponse">challenge</a><span class="delimiter">(</span><span title="Int(400)" class="int">400</span>, <span title="java.lang.String(&quot;invalid nonce&quot;)" class="string">&quot;invalid nonce&quot;</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(method: String, url: String, p: Map[String,Seq[String]])unfiltered.oauth.OAuthResponse" id="61604">requestToken</a><span class="delimiter">(</span><a title="String" id="63420">method</a>: <span title="String">String</span>, <a title="String" id="63421">url</a>: <span title="String">String</span>, <a title="Map[String,Seq[String]]" id="63422">p</a>: <span title="Map[String,Seq[String]]">Map</span><span class="delimiter">[</span>String, Seq<span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span>: <a href="responses.scala.html#13079" title="unfiltered.oauth.OAuthResponse">OAuthResponse</a> =
    <span title="unfiltered.oauth.OAuthResponse" class="keyword">if</span><span class="delimiter">(</span><a href="#61610" title="(consumer: String, timestamp: String, nonce: String)Boolean">nonceValid</a><span class="delimiter">(</span><a href="#63422" title="(key: String)Seq[String]">p</a><span title="(idx: Int)String" class="delimiter">(</span><a href="#61575" title="=&gt; java.lang.String">ConsumerKey</a><span class="delimiter">)</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>, <a href="#63422" title="(key: String)Seq[String]">p</a><span title="(idx: Int)String" class="delimiter">(</span><a href="#61579" title="=&gt; java.lang.String">Timestamp</a><span class="delimiter">)</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>, <a href="#63422" title="(key: String)Seq[String]">p</a><span title="(idx: Int)String" class="delimiter">(</span><a href="#61581" title="=&gt; java.lang.String">Nonce</a><span class="delimiter">)</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">(</span><span class="keyword">for</span> <span class="delimiter">{</span>
      <a title="unfiltered.oauth.Consumer" id="65039">consumer</a> &lt;- <a href="stores.scala.html#61632" title="=&gt; unfiltered.oauth.ConsumerStore">consumers</a>.<a href="consumers.scala.html#61534" title="(key: String)Option[unfiltered.oauth.Consumer]">get</a><span title="(f: unfiltered.oauth.Consumer =&gt; unfiltered.oauth.OAuthResponse)Option[unfiltered.oauth.OAuthResponse]" class="delimiter">(</span><a href="#63422" title="(key: String)Seq[String]">p</a><span title="(idx: Int)String" class="delimiter">(</span><a href="#61575" title="=&gt; java.lang.String">ConsumerKey</a><span class="delimiter">)</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span> <span class="keyword">yield</span> <span class="delimiter">{</span>
      <span title="unfiltered.oauth.OAuthResponse" class="keyword">if</span><span class="delimiter">(</span><a href="signatures.scala.html#13185" title="object unfiltered.oauth.Signatures">Signatures</a>.<a href="signatures.scala.html#64771" title="(method: String, url: String, p: unfiltered.oauth.Signatures.Params, consumerSec: String, tokenSec: String)Boolean">verify</a><span class="delimiter">(</span><a href="#63420" title="String">method</a>, <a href="#63421" title="String">url</a>, <a href="#63422" title="Map[String,Seq[String]]">p</a>, <a href="#65039" title="unfiltered.oauth.Consumer">consumer</a>.<a href="consumers.scala.html#61532" title="=&gt; String">secret</a>, <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
         <span class="keyword">val</span> <a href="#65041" title="(String, String)" class="delimiter">(</a><a href="#65040" title="String" id="65041">key</a>, <a href="#65040" title="String" id="65042">secret</a><span class="delimiter">)</span> = <a href="stores.scala.html#61631" title="=&gt; unfiltered.oauth.TokenStore">tokens</a>.<a href="tokens.scala.html#64467" title="=&gt; (String, String)">generate</a>
         <a href="stores.scala.html#61631" title="=&gt; unfiltered.oauth.TokenStore">tokens</a>.<a href="tokens.scala.html#64469" title="(token: unfiltered.oauth.Token)unfiltered.oauth.Token">put</a><span class="delimiter">(</span><a href="tokens.scala.html#65056" title="(key: String, secret: String, consumerKey: String, callback: String)unfiltered.oauth.RequestToken">RequestToken</a><span class="delimiter">(</span><a href="#65041" title="String">key</a>, <a href="#65042" title="String">secret</a>, <a href="#65039" title="unfiltered.oauth.Consumer">consumer</a>.<a href="consumers.scala.html#61531" title="=&gt; String">key</a>, java.net.<span title="object java.net.URLDecoder">URLDecoder</span>.<span title="(x$1: java.lang.String, x$2: java.lang.String)java.lang.String">decode</span><span class="delimiter">(</span><a href="#63422" title="(key: String)Seq[String]">p</a><span title="(idx: Int)String" class="delimiter">(</span><a href="#61583" title="=&gt; java.lang.String">Callback</a><span class="delimiter">)</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>, <span title="java.lang.String(&quot;utf-8&quot;)" class="string">&quot;utf-8&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
         <a href="responses.scala.html#65113" title="(oauth_token: String, oauth_token_secret: String, oauth_callback_confirmed: Boolean)unfiltered.oauth.TokenResponse">TokenResponse</a><span class="delimiter">(</span><a href="#65041" title="String">key</a>, <a href="#65042" title="String">secret</a>, <span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">else</span> <a href="#61609" title="(status: Int, msg: String)unfiltered.oauth.OAuthResponse">challenge</a><span class="delimiter">(</span><span title="Int(400)" class="int">400</span>, <span title="java.lang.String(&quot;invalid signature&quot;)" class="string">&quot;invalid signature&quot;</span><span class="delimiter">)</span>
    <span class="delimiter">}</span><span class="delimiter">)</span> <span title="(default: =&gt; unfiltered.oauth.OAuthResponse)unfiltered.oauth.OAuthResponse">getOrElse</span> <a href="#61609" title="(status: Int, msg: String)unfiltered.oauth.OAuthResponse">challenge</a><span class="delimiter">(</span><span title="Int(400)" class="int">400</span>, <span title="java.lang.String(&quot;invalid consumer&quot;)" class="string">&quot;invalid consumer&quot;</span><span class="delimiter">)</span>
    <span class="keyword">else</span> <a href="#61609" title="(status: Int, msg: String)unfiltered.oauth.OAuthResponse">challenge</a><span class="delimiter">(</span><span title="Int(400)" class="int">400</span>, <span title="java.lang.String(&quot;invalid nonce&quot;)" class="string">&quot;invalid nonce&quot;</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="[T](tokenKey: String, request: unfiltered.request.HttpRequest[T])unfiltered.oauth.OAuthResponse" id="61605">authorize</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="61607">T</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="String" id="63728">tokenKey</a>: <span title="String">String</span>, <a title="unfiltered.request.HttpRequest[T]" id="63729">request</a>: <a href="../../../unfiltered/unfiltered/unfiltered/request/HttpRequest.scala.html#9907" title="unfiltered.request.HttpRequest[T]">Req</a><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="responses.scala.html#13079" title="unfiltered.oauth.OAuthResponse">OAuthResponse</a> =
    <a href="stores.scala.html#61631" title="=&gt; unfiltered.oauth.TokenStore">tokens</a>.<a href="tokens.scala.html#64470" title="(tokenId: String)Option[unfiltered.oauth.Token]">get</a><span class="delimiter">(</span><a href="#63728" title="String">tokenKey</a><span class="delimiter">)</span> <span title="unfiltered.oauth.OAuthResponse" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <span title="unfiltered.oauth.OAuthResponse">Some</span><span class="delimiter">(</span>RequestToken<span class="delimiter">(</span><a title="String" id="65175">key</a>, <a title="String" id="65176">secret</a>, <a title="String" id="65177">consumerKey</a>, <a title="String" id="65178">callback</a><span class="delimiter">)</span><span class="delimiter">)</span> =&gt;
        <a href="stores.scala.html#61632" title="=&gt; unfiltered.oauth.ConsumerStore">consumers</a>.<a href="consumers.scala.html#61534" title="(key: String)Option[unfiltered.oauth.Consumer]">get</a><span class="delimiter">(</span><a href="#65177" title="String">consumerKey</a><span class="delimiter">)</span> <span title="unfiltered.oauth.OAuthResponse" class="keyword">match</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> <span title="unfiltered.oauth.OAuthResponse">Some</span><span class="delimiter">(</span><a title="unfiltered.oauth.Consumer" id="65180">consumer</a><span class="delimiter">)</span> =&gt;
            <a href="stores.scala.html#61633" title="=&gt; unfiltered.oauth.UserHost">users</a>.<a href="users.scala.html#63837" title="(r: unfiltered.request.HttpRequest[T])Option[unfiltered.oauth.UserLike]">current</a><span class="delimiter">(</span><a href="#63729" title="unfiltered.request.HttpRequest[T]">request</a><span class="delimiter">)</span> <span title="unfiltered.oauth.OAuthResponse" class="keyword">match</span> <span class="delimiter">{</span>
              <span class="keyword">case</span> <span title="unfiltered.oauth.OAuthResponse">Some</span><span class="delimiter">(</span><a title="unfiltered.oauth.UserLike" id="65188">user</a><span class="delimiter">)</span> =&gt;
                <span title="unfiltered.oauth.OAuthResponse" class="keyword">if</span><span class="delimiter">(</span><a href="stores.scala.html#61633" title="=&gt; unfiltered.oauth.UserHost">users</a>.<a href="users.scala.html#63840" title="(token: String, r: unfiltered.request.HttpRequest[T])Boolean">accepted</a><span class="delimiter">(</span><a href="#63728" title="String">tokenKey</a>, <a href="#63729" title="unfiltered.request.HttpRequest[T]">request</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
                  <span class="keyword">val</span> <a title="String" id="65199">verifier</a> = <a href="stores.scala.html#61631" title="=&gt; unfiltered.oauth.TokenStore">tokens</a>.<a href="tokens.scala.html#64468" title="=&gt; String">generateVerifier</a>
                  <a href="stores.scala.html#61631" title="=&gt; unfiltered.oauth.TokenStore">tokens</a>.<a href="tokens.scala.html#64469" title="(token: unfiltered.oauth.Token)unfiltered.oauth.Token">put</a><span class="delimiter">(</span><a href="tokens.scala.html#65209" title="(key: String, secret: String, consumerKey: String, user: String, verifier: String)unfiltered.oauth.AuthorizedRequestToken">AuthorizedRequestToken</a><span class="delimiter">(</span><a href="#65175" title="String">key</a>, <a href="#65176" title="String">secret</a>, <a href="#65177" title="String">consumerKey</a>, <a href="#65188" title="unfiltered.oauth.UserLike">user</a>.<a href="users.scala.html#65261" title="=&gt; String">id</a>, <a href="#65199" title="String">verifier</a><span class="delimiter">)</span><span class="delimiter">)</span>
                  <a href="responses.scala.html#63788" title="(oauth_callback: String, oauth_token: String, oauth_verifier: String)unfiltered.oauth.AuthorizeResponse">AuthorizeResponse</a><span class="delimiter">(</span><a href="#65178" title="String">callback</a>, <a href="#65175" title="String">key</a>, <a href="#65199" title="String">verifier</a><span class="delimiter">)</span>
                <span class="delimiter">}</span> <span class="keyword">else</span> <span title="unfiltered.oauth.OAuthResponse" class="keyword">if</span><span class="delimiter">(</span><a href="stores.scala.html#61633" title="=&gt; unfiltered.oauth.UserHost">users</a>.<a href="users.scala.html#63843" title="(token: String, r: unfiltered.request.HttpRequest[T])Boolean">denied</a><span class="delimiter">(</span><a href="#63728" title="String">tokenKey</a>, <a href="#63729" title="unfiltered.request.HttpRequest[T]">request</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
                  <a href="stores.scala.html#61631" title="=&gt; unfiltered.oauth.TokenStore">tokens</a>.<a href="tokens.scala.html#64471" title="(tokenId: String)Unit">delete</a><span class="delimiter">(</span><a href="#63728" title="String">tokenKey</a><span class="delimiter">)</span>
                  <a href="responses.scala.html#63742" title="(p: unfiltered.response.ResponseFunction[Any])unfiltered.oauth.HostResponse[Any]">HostResponse</a><span class="delimiter">(</span><a href="stores.scala.html#61633" title="=&gt; unfiltered.oauth.UserHost">users</a>.<a href="users.scala.html#63835" title="(consumer: unfiltered.oauth.Consumer)unfiltered.response.ResponseFunction[Any]">deniedConfirmation</a><span class="delimiter">(</span><a href="#65180" title="unfiltered.oauth.Consumer">consumer</a><span class="delimiter">)</span><span class="delimiter">)</span>
                <span class="delimiter">}</span> <span class="keyword">else</span> <a href="responses.scala.html#63742" title="(p: unfiltered.response.ResponseFunction[Any])unfiltered.oauth.HostResponse[Any]">HostResponse</a><span class="delimiter">(</span><a href="stores.scala.html#61633" title="=&gt; unfiltered.oauth.UserHost">users</a>.<a href="users.scala.html#63836" title="(token: String, consumer: unfiltered.oauth.Consumer)unfiltered.response.ResponseFunction[Any]">requestAcceptance</a><span class="delimiter">(</span><a href="#63728" title="String">tokenKey</a>, <a href="#65180" title="unfiltered.oauth.Consumer">consumer</a><span class="delimiter">)</span><span class="delimiter">)</span>
              <span class="keyword">case</span> <span title="unfiltered.oauth.HostResponse[Any]">_</span> =&gt;
                <span class="comment">// ask user to sign in</span>
                <a href="responses.scala.html#63742" title="(p: unfiltered.response.ResponseFunction[Any])unfiltered.oauth.HostResponse[Any]">HostResponse</a><span class="delimiter">(</span><a href="stores.scala.html#61633" title="=&gt; unfiltered.oauth.UserHost">users</a>.<a href="users.scala.html#63833" title="(token: String)unfiltered.response.ResponseFunction[Any]">login</a><span class="delimiter">(</span><a href="#63728" title="String">tokenKey</a><span class="delimiter">)</span><span class="delimiter">)</span>
            <span class="delimiter">}</span>
          <span class="keyword">case</span> <span title="unfiltered.oauth.OAuthResponse">_</span> =&gt; <a href="#61609" title="(status: Int, msg: String)unfiltered.oauth.OAuthResponse">challenge</a><span class="delimiter">(</span><span title="Int(400)" class="int">400</span>, <span title="java.lang.String(&quot;invalid consumer&quot;)" class="string">&quot;invalid consumer&quot;</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>
      <span class="keyword">case</span> <span title="unfiltered.oauth.OAuthResponse">_</span> =&gt; <a href="#61609" title="(status: Int, msg: String)unfiltered.oauth.OAuthResponse">challenge</a><span class="delimiter">(</span><span title="Int(400)" class="int">400</span>, <span title="java.lang.String(&quot;invalid token&quot;)" class="string">&quot;invalid token&quot;</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(method: String, url: String, p: Map[String,Seq[String]])unfiltered.oauth.OAuthResponse" id="61608">accessToken</a><span class="delimiter">(</span><a title="String" id="64196">method</a>: <span title="String">String</span>, <a title="String" id="64197">url</a>: <span title="String">String</span>, <a title="Map[String,Seq[String]]" id="64198">p</a>: <span title="Map[String,Seq[String]]">Map</span><span class="delimiter">[</span>String, Seq<span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span>: <a href="responses.scala.html#13079" title="unfiltered.oauth.OAuthResponse">OAuthResponse</a> =
    <span title="unfiltered.oauth.OAuthResponse" class="keyword">if</span><span class="delimiter">(</span><a href="#61610" title="(consumer: String, timestamp: String, nonce: String)Boolean">nonceValid</a><span class="delimiter">(</span><a href="#64198" title="(key: String)Seq[String]">p</a><span title="(idx: Int)String" class="delimiter">(</span><a href="#61575" title="=&gt; java.lang.String">ConsumerKey</a><span class="delimiter">)</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>, <a href="#64198" title="(key: String)Seq[String]">p</a><span title="(idx: Int)String" class="delimiter">(</span><a href="#61579" title="=&gt; java.lang.String">Timestamp</a><span class="delimiter">)</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>, <a href="#64198" title="(key: String)Seq[String]">p</a><span title="(idx: Int)String" class="delimiter">(</span><a href="#61581" title="=&gt; java.lang.String">Nonce</a><span class="delimiter">)</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">(</span><span class="keyword">for</span> <span class="delimiter">{</span>
      <a title="unfiltered.oauth.Consumer" id="65395">consumer</a> &lt;- <a href="stores.scala.html#61632" title="=&gt; unfiltered.oauth.ConsumerStore">consumers</a>.<a href="consumers.scala.html#61534" title="(key: String)Option[unfiltered.oauth.Consumer]">get</a><span title="(f: unfiltered.oauth.Consumer =&gt; Option[unfiltered.oauth.OAuthResponse])Option[unfiltered.oauth.OAuthResponse]" class="delimiter">(</span><a href="#64198" title="(key: String)Seq[String]">p</a><span title="(idx: Int)String" class="delimiter">(</span><a href="#61575" title="=&gt; java.lang.String">ConsumerKey</a><span class="delimiter">)</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <a title="unfiltered.oauth.Token" id="65423">token</a> &lt;- <a href="stores.scala.html#61631" title="=&gt; unfiltered.oauth.TokenStore">tokens</a>.<a href="tokens.scala.html#64470" title="(tokenId: String)Option[unfiltered.oauth.Token]">get</a><span title="(f: unfiltered.oauth.Token =&gt; unfiltered.oauth.OAuthResponse)Option[unfiltered.oauth.OAuthResponse]" class="delimiter">(</span><a href="#64198" title="(key: String)Seq[String]">p</a><span title="(idx: Int)String" class="delimiter">(</span><a href="#61587" title="=&gt; java.lang.String">TokenKey</a><span class="delimiter">)</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span> <span class="keyword">yield</span> <span class="delimiter">{</span>
      <a href="#65423" title="unfiltered.oauth.Token">token</a> <span title="unfiltered.oauth.OAuthResponse" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <span title="unfiltered.oauth.OAuthResponse">AuthorizedRequestToken</span><span class="delimiter">(</span><a title="String" id="65573">key</a>, <a title="String" id="65574">secret</a>, <a title="String" id="65575">consumerKey</a>, <a title="String" id="65576">user</a>, <a title="String" id="65577">verifier</a><span class="delimiter">)</span> =&gt;
          <span title="unfiltered.oauth.OAuthResponse" class="keyword">if</span><span class="delimiter">(</span><a href="#65577" title="String">verifier</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#64198" title="(key: String)Seq[String]">p</a><span title="(idx: Int)String" class="delimiter">(</span><a href="#61589" title="=&gt; java.lang.String">Verifier</a><span class="delimiter">)</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span><span class="delimiter">)</span>
            <span title="unfiltered.oauth.OAuthResponse" class="keyword">if</span><span class="delimiter">(</span><a href="signatures.scala.html#13185" title="object unfiltered.oauth.Signatures">Signatures</a>.<a href="signatures.scala.html#64771" title="(method: String, url: String, p: unfiltered.oauth.Signatures.Params, consumerSec: String, tokenSec: String)Boolean">verify</a><span class="delimiter">(</span><a href="#64196" title="String">method</a>, <a href="#64197" title="String">url</a>, <a href="#64198" title="Map[String,Seq[String]]">p</a>, <a href="#65395" title="unfiltered.oauth.Consumer">consumer</a>.<a href="consumers.scala.html#61532" title="=&gt; String">secret</a>, <a href="#65423" title="unfiltered.oauth.Token">token</a>.<a href="tokens.scala.html#64701" title="=&gt; String">secret</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
              <span class="keyword">val</span> <a href="#65606" title="(String, String)" class="delimiter">(</a><a href="#65605" title="String" id="65606">key</a>, <a href="#65605" title="String" id="65607">secret</a><span class="delimiter">)</span> = <a href="stores.scala.html#61631" title="=&gt; unfiltered.oauth.TokenStore">tokens</a>.<a href="tokens.scala.html#64467" title="=&gt; (String, String)">generate</a>
              <a href="stores.scala.html#61631" title="=&gt; unfiltered.oauth.TokenStore">tokens</a>.<a href="tokens.scala.html#64471" title="(tokenId: String)Unit">delete</a><span class="delimiter">(</span><a href="#65423" title="unfiltered.oauth.Token">token</a>.<a href="tokens.scala.html#64700" title="=&gt; String">key</a><span class="delimiter">)</span>
              <a href="stores.scala.html#61631" title="=&gt; unfiltered.oauth.TokenStore">tokens</a>.<a href="tokens.scala.html#64469" title="(token: unfiltered.oauth.Token)unfiltered.oauth.Token">put</a><span class="delimiter">(</span><a href="tokens.scala.html#64699" title="(key: String, secret: String, user: String, consumerKey: String)unfiltered.oauth.AccessToken">AccessToken</a><span class="delimiter">(</span><a href="#65606" title="String">key</a>, <a href="#65607" title="String">secret</a>, <a href="#65576" title="String">user</a>, <a href="#65395" title="unfiltered.oauth.Consumer">consumer</a>.<a href="consumers.scala.html#61531" title="=&gt; String">key</a><span class="delimiter">)</span><span class="delimiter">)</span>
              <a href="responses.scala.html#64269" title="(oauth_token: String, oauth_token_secret: String)unfiltered.oauth.AccessResponse">AccessResponse</a><span class="delimiter">(</span><a href="#65606" title="String">key</a>, <a href="#65607" title="String">secret</a><span class="delimiter">)</span>
            <span class="delimiter">}</span> <span class="keyword">else</span> <a href="#61609" title="(status: Int, msg: String)unfiltered.oauth.OAuthResponse">challenge</a><span class="delimiter">(</span><span title="Int(400)" class="int">400</span>, <span title="java.lang.String(&quot;invalid signature&quot;)" class="string">&quot;invalid signature&quot;</span><span class="delimiter">)</span>
          <span class="keyword">else</span> <a href="#61609" title="(status: Int, msg: String)unfiltered.oauth.OAuthResponse">challenge</a><span class="delimiter">(</span><span title="Int(400)" class="int">400</span>, <span title="java.lang.String(&quot;invalid verifier&quot;)" class="string">&quot;invalid verifier&quot;</span><span class="delimiter">)</span>
        <span class="keyword">case</span> <span title="unfiltered.oauth.OAuthResponse">_</span> =&gt; <a href="#61609" title="(status: Int, msg: String)unfiltered.oauth.OAuthResponse">challenge</a><span class="delimiter">(</span><span title="Int(400)" class="int">400</span>, <span title="java.lang.String(&quot;invalid token&quot;)" class="string">&quot;invalid token&quot;</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span><span class="delimiter">)</span> <span title="(default: =&gt; unfiltered.oauth.OAuthResponse)unfiltered.oauth.OAuthResponse">getOrElse</span> <a href="#61609" title="(status: Int, msg: String)unfiltered.oauth.OAuthResponse">challenge</a><span class="delimiter">(</span><span title="Int(400)" class="int">400</span>, <span title="java.lang.String(&quot;invalid consumer or token&quot;)" class="string">&quot;invalid consumer or token&quot;</span><span class="delimiter">)</span>
    <span class="keyword">else</span> <a href="#61609" title="(status: Int, msg: String)unfiltered.oauth.OAuthResponse">challenge</a><span class="delimiter">(</span><span title="Int(400)" class="int">400</span>, <span title="java.lang.String(&quot;invalid nonce&quot;)" class="string">&quot;invalid nonce&quot;</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(status: Int, msg: String)unfiltered.oauth.OAuthResponse" id="61609">challenge</a><span class="delimiter">(</span><a title="Int" id="64934">status</a>: <span title="Int">Int</span>, <a title="String" id="64935">msg</a>: <span title="String">String</span><span class="delimiter">)</span>: <a href="responses.scala.html#13079" title="unfiltered.oauth.OAuthResponse">OAuthResponse</a> = <a href="responses.scala.html#62821" title="(status: Int, msg: String)unfiltered.oauth.Failure">Failure</a><span class="delimiter">(</span><a href="#64934" title="Int">status</a>, <a href="#64935" title="String">msg</a><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(consumer: String, timestamp: String, nonce: String)Boolean" id="61610">nonceValid</a><span class="delimiter">(</span><a title="String" id="64556">consumer</a>: <span title="String">String</span>, <a title="String" id="64557">timestamp</a>: <span title="String">String</span>, <a title="String" id="64558">nonce</a>: <span title="String">String</span><span class="delimiter">)</span> =
    <a href="stores.scala.html#61630" title="=&gt; unfiltered.oauth.NonceStore">nonces</a>.<a href="nonces.scala.html#61566" title="(consumer: String, timestamp: String, nonce: String)Boolean">put</a><span class="delimiter">(</span><a href="#64556" title="String">consumer</a>, <a href="#64557" title="String">timestamp</a>, <a href="#64558" title="String">nonce</a><span class="delimiter">)</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>