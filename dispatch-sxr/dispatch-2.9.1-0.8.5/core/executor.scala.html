<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>core/executor.scala</title>
        <script type="text/javascript" src="../jquery-all.js"></script>
        <script type="text/javascript" src="../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> dispatch

<span class="keyword">import</span> org.apache.http.<span class="delimiter">{</span>HttpHost,HttpRequest,HttpResponse,HttpEntity<span class="delimiter">}</span>
<span class="keyword">import</span> org.apache.http.message.AbstractHttpMessage
<span class="keyword">import</span> org.apache.http.util.EntityUtils
<span class="keyword">import</span> org.apache.http.client.methods._

<span class="comment">/** Defines request execution and response status code behaviors. Implemented methods are finalized
    as any overrides would be lost when instantiating delegate executors, is in Threads#future. 
    Delegates should chain to parent `pack` and `execute` implementations. */</span>
<span class="keyword">trait</span> <a title="trait HttpExecutor extends java.lang.Object with dispatch.RequestLogging with ScalaObject" id="9466">HttpExecutor</a> <span title="ScalaObject" class="keyword">extends</span> <a href="#9472" title="dispatch.RequestLogging">RequestLogging</a> <span class="delimiter">{</span>
  <span class="comment">/** Type of value returned from request execution */</span>
  <span class="keyword">type</span> <a title="[T]&gt;: Nothing &lt;: Any" id="25106">HttpPackage</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="25140">T</a><span class="delimiter">]</span>
  <span class="comment">/** Execute the request against an HttpClient */</span>
  <span class="keyword">def</span> <a title="[T](host: org.apache.http.HttpHost, creds: Option[dispatch.Credentials], req: org.apache.http.client.methods.HttpRequestBase, block: org.apache.http.HttpResponse =&gt; T, listener: dispatch.package.ExceptionListener)HttpExecutor.this.HttpPackage[T]" id="25107">execute</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="25109">T</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="org.apache.http.HttpHost" id="25141">host</a>: <span title="org.apache.http.HttpHost">HttpHost</span>, 
                 <a title="Option[dispatch.Credentials]" id="25142">creds</a>: <span title="Option[dispatch.Credentials]">Option</span><span class="delimiter">[</span>Credentials<span class="delimiter">]</span>, 
                 <a title="org.apache.http.client.methods.HttpRequestBase" id="25143">req</a>: <span title="org.apache.http.client.methods.HttpRequestBase">HttpRequestBase</span>, 
                 <a title="org.apache.http.HttpResponse =&gt; T" id="25144">block</a>: HttpResponse =&gt; T,
                 <a title="dispatch.package.ExceptionListener" id="25145">listener</a>: <span title="dispatch.package.ExceptionListener">ExceptionListener</span><span class="delimiter">)</span>: <a href="#25106" title="HttpExecutor.this.HttpPackage[T]">HttpPackage</a><span class="delimiter">[</span>T<span class="delimiter">]</span>

  <span class="keyword">def</span> <a title="[T](host: org.apache.http.HttpHost, credsopt: Option[dispatch.Credentials], req: org.apache.http.client.methods.HttpRequestBase, block: dispatch.Callback[T])HttpExecutor.this.HttpPackage[T]" id="25110">executeWithCallback</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="25112">T</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="org.apache.http.HttpHost" id="25227">host</a>: <span title="org.apache.http.HttpHost">HttpHost</span>, <a title="Option[dispatch.Credentials]" id="25228">credsopt</a>: <span title="Option[dispatch.Credentials]">Option</span><span class="delimiter">[</span>Credentials<span class="delimiter">]</span>, 
                             <a title="org.apache.http.client.methods.HttpRequestBase" id="25229">req</a>: <span title="org.apache.http.client.methods.HttpRequestBase">HttpRequestBase</span>, <a title="dispatch.Callback[T]" id="25230">block</a>: <a href="callbacks.scala.html#9455" title="dispatch.Callback[T]">Callback</a><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#25106" title="HttpExecutor.this.HttpPackage[T]">HttpPackage</a><span class="delimiter">[</span>T<span class="delimiter">]</span>

  @deprecated<span class="delimiter">(</span><span class="string">&quot;Use x[T](hand: Handler[T]) instead. Construct a Handler if needed.&quot;</span><span class="delimiter">)</span>
  <span class="keyword">final</span> <span class="keyword">def</span> <a title="[T](req: dispatch.Request)(block: (Int, org.apache.http.HttpResponse, Option[org.apache.http.HttpEntity]) =&gt; T)HttpExecutor.this.HttpPackage[T]" id="25113">x</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="25115">T</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="dispatch.Request" id="25236">req</a>: <a href="requests.scala.html#9510" title="dispatch.Request">Request</a><span class="delimiter">)</span><span class="delimiter">(</span><a title="(Int, org.apache.http.HttpResponse, Option[org.apache.http.HttpEntity]) =&gt; T" id="25237">block</a>: Handler.<span title="(Int, org.apache.http.HttpResponse, Option[org.apache.http.HttpEntity]) =&gt; T">F</span><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#25106" title="HttpExecutor.this.HttpPackage[T]">HttpPackage</a><span class="delimiter">[</span>T<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <a href="#25116" title="(hand: dispatch.Handler[T])HttpExecutor.this.HttpPackage[T]">x</a><span class="delimiter">(</span><a href="handlers.scala.html#25242" title="(req: dispatch.Request, block: (Int, org.apache.http.HttpResponse, Option[org.apache.http.HttpEntity]) =&gt; T)dispatch.Handler[T]">Handler</a><span class="delimiter">(</span><a href="#25236" title="dispatch.Request">req</a>, <a href="#25237" title="(Int, org.apache.http.HttpResponse, Option[org.apache.http.HttpEntity]) =&gt; T">block</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>
  <span class="comment">/** Execute full request-response handler, response in package. */</span>
  <span class="keyword">final</span> <span class="keyword">def</span> <a title="[T](hand: dispatch.Handler[T])HttpExecutor.this.HttpPackage[T]" id="25116">x</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="25118">T</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="dispatch.Handler[T]" id="25289">hand</a>: <a href="handlers.scala.html#9484" title="dispatch.Handler[T]">Handler</a><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#25106" title="HttpExecutor.this.HttpPackage[T]">HttpPackage</a><span class="delimiter">[</span>T<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="dispatch.Request" id="25418">req</a> = <a href="#25289" title="dispatch.Handler[T]">hand</a>.<a href="handlers.scala.html#25256" title="=&gt; dispatch.Request">request</a>
    <span class="keyword">val</span> <a title="org.apache.http.client.methods.HttpRequestBase" id="25419">request</a> = <a href="#25126" title="(req: dispatch.Request)org.apache.http.client.methods.HttpRequestBase">make_message</a><span class="delimiter">(</span><a href="#25289" title="dispatch.Handler[T]">hand</a>.<a href="handlers.scala.html#25256" title="=&gt; dispatch.Request">request</a><span class="delimiter">)</span>
    <a href="#25102" title="=&gt; dispatch.Logger">log</a>.<a href="#25776" title="(msg: String, items: Any*)Unit">info</a><span class="delimiter">(</span><span title="java.lang.String(&quot;%s %s&quot;)" class="string">&quot;%s %s&quot;</span>, <a href="#25418" title="dispatch.Request">req</a>.<a href="requests.scala.html#13129" title="=&gt; org.apache.http.HttpHost">host</a>.<span title="()java.lang.String">getHostName</span>, <a href="#25419" title="org.apache.http.client.methods.HttpRequestBase">request</a>.<span title="()org.apache.http.RequestLine">getRequestLine</span><span class="delimiter">)</span>
    <a href="#25418" title="dispatch.Request">req</a>.<a href="requests.scala.html#13137" title="=&gt; dispatch.Request.Headers">headers</a>.<span title="=&gt; List[(String, String)]">reverse</span>.<span title="(f: (String, String) =&gt; Unit)Unit">foreach</span> <a href="#26016" title="Unit" class="delimiter">{</a>
      <span class="keyword">case</span> <span title="Unit" class="delimiter">(</span><a title="String" id="26019">key</a>, <a title="String" id="26020">value</a><span class="delimiter">)</span> =&gt; <a href="#25419" title="org.apache.http.client.methods.HttpRequestBase">request</a>.<span title="(x$1: java.lang.String, x$2: java.lang.String)Unit">addHeader</span><span class="delimiter">(</span><a href="#26019" title="String">key</a>, <a href="#26020" title="String">value</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
    <a href="#25107" title="(host: org.apache.http.HttpHost, creds: Option[dispatch.Credentials], req: org.apache.http.client.methods.HttpRequestBase, block: org.apache.http.HttpResponse =&gt; T, listener: dispatch.package.ExceptionListener)HttpExecutor.this.HttpPackage[T]">execute</a><span class="delimiter">(</span><a href="#25418" title="dispatch.Request">req</a>.<a href="requests.scala.html#13129" title="=&gt; org.apache.http.HttpHost">host</a>, <a href="#25418" title="dispatch.Request">req</a>.<a href="requests.scala.html#13131" title="=&gt; Option[dispatch.Credentials]">creds</a>, <a href="#25419" title="org.apache.http.client.methods.HttpRequestBase">request</a>, <span class="delimiter">{</span> <a title="org.apache.http.HttpResponse" id="26031">res</a> =&gt;
      <span class="keyword">val</span> <a title="Option[org.apache.http.HttpEntity]" id="26032">ent</a> = <a href="#26031" title="org.apache.http.HttpResponse">res</a>.<span title="()org.apache.http.HttpEntity">getEntity</span> <span title="Option[org.apache.http.HttpEntity]" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <span title="None.type" class="keyword">null</span> =&gt; <span title="object None">None</span>
        <span class="keyword">case</span> <a title="Some[org.apache.http.HttpEntity]" id="26034">ent</a> =&gt; <span title="(x: org.apache.http.HttpEntity)Some[org.apache.http.HttpEntity]">Some</span><span class="delimiter">(</span><a href="#26034" title="org.apache.http.HttpEntity">ent</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
      <span class="keyword">val</span> <a title="T" id="26033">result</a> = <a href="#25289" title="dispatch.Handler[T]">hand</a>.<a href="handlers.scala.html#25258" title="(v1: Int, v2: org.apache.http.HttpResponse, v3: Option[org.apache.http.HttpEntity])T">block</a><span class="delimiter">(</span><a href="#26031" title="org.apache.http.HttpResponse">res</a>.<span title="()org.apache.http.StatusLine">getStatusLine</span>.<span title="()Int">getStatusCode</span>, <a href="#26031" title="org.apache.http.HttpResponse">res</a>, <a href="#26032" title="Option[org.apache.http.HttpEntity]">ent</a><span class="delimiter">)</span>
      <a href="#25119" title="(entity: Option[org.apache.http.HttpEntity])Unit">consumeContent</a><span class="delimiter">(</span><a href="#26032" title="Option[org.apache.http.HttpEntity]">ent</a><span class="delimiter">)</span>
      <a href="#26033" title="T">result</a>
    <span class="delimiter">}</span>, <a href="#25289" title="dispatch.Handler[T]">hand</a>.<a href="handlers.scala.html#25260" title="=&gt; dispatch.package.ExceptionListener">listener</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>
  <span class="comment">/** Allow executor to release any resources for an entity */</span>
  <span class="keyword">def</span> <a title="(entity: Option[org.apache.http.HttpEntity])Unit" id="25119">consumeContent</a><span class="delimiter">(</span><a title="Option[org.apache.http.HttpEntity]" id="26055">entity</a>: <span title="Option[org.apache.http.HttpEntity]">Option</span><span class="delimiter">[</span>HttpEntity<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="Unit">Unit</span>
  <span class="comment">/** Apply Response Handler if reponse code returns true from chk. */</span>
  <span class="keyword">final</span> <span class="keyword">def</span> <a title="[T](chk: Int =&gt; Boolean)(hand: dispatch.Handler[T])HttpExecutor.this.HttpPackage[T]" id="25120">when</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="25122">T</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="Int =&gt; Boolean" id="26062">chk</a>: Int =&gt; Boolean<span class="delimiter">)</span><span class="delimiter">(</span><a title="dispatch.Handler[T]" id="26063">hand</a>: <a href="handlers.scala.html#9484" title="dispatch.Handler[T]">Handler</a><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">)</span> = 
    <a href="#25116" title="(hand: dispatch.Handler[T])HttpExecutor.this.HttpPackage[T]">x</a><span class="delimiter">(</span><a href="#26063" title="dispatch.Handler[T]">hand</a>.<a href="handlers.scala.html#26085" title="dispatch.Request" id="26204">copy</a><span class="delimiter">(</span>block= <a href="#26109" title="(Int, org.apache.http.HttpResponse, Option[org.apache.http.HttpEntity]) =&gt; T" id="26202" class="delimiter">{</a>
      <span class="keyword">case</span> <span title="T" class="delimiter">(</span><a title="Int" id="26140">code</a>, <a title="org.apache.http.HttpResponse" id="26141">res</a>, <a title="Option[org.apache.http.HttpEntity]" id="26142">ent</a><span class="delimiter">)</span> <span class="keyword">if</span> <a href="#26062" title="(v1: Int)Boolean">chk</a><span class="delimiter">(</span><a href="#26140" title="Int">code</a><span class="delimiter">)</span> =&gt; <a href="#26063" title="dispatch.Handler[T]">hand</a>.<a href="handlers.scala.html#25258" title="(v1: Int, v2: org.apache.http.HttpResponse, v3: Option[org.apache.http.HttpEntity])T">block</a><span class="delimiter">(</span><a href="#26140" title="Int">code</a>, <a href="#26141" title="org.apache.http.HttpResponse">res</a>, <a href="#26142" title="Option[org.apache.http.HttpEntity]">ent</a><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="Nothing" class="delimiter">(</span><a title="Int" id="26150">code</a>, _, Some<span class="delimiter">(</span><a title="org.apache.http.HttpEntity" id="26152">ent</a><span class="delimiter">)</span><span class="delimiter">)</span> =&gt; 
        <span title="Nothing" class="keyword">throw</span> <a href="#27031" title="(code: Int, contents: String)dispatch.StatusCode">StatusCode</a><span class="delimiter">(</span><a href="#26150" title="Int">code</a>, <span title="object org.apache.http.util.EntityUtils">EntityUtils</span>.<span title="(x$1: org.apache.http.HttpEntity, x$2: java.lang.String)java.lang.String">toString</span><span class="delimiter">(</span><a href="#26152" title="org.apache.http.HttpEntity">ent</a>, <a href="#26063" title="dispatch.Handler[T]">hand</a>.<a href="handlers.scala.html#25256" title="=&gt; dispatch.Request">request</a>.<a href="requests.scala.html#13141" title="=&gt; String">defaultCharset</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="Nothing" class="delimiter">(</span><a title="Int" id="26197">code</a>, _, _<span class="delimiter">)</span>         =&gt; 
        <span title="Nothing" class="keyword">throw</span> <a href="#27031" title="(code: Int, contents: String)dispatch.StatusCode">StatusCode</a><span class="delimiter">(</span><a href="#26197" title="Int">code</a>, <span title="java.lang.String(&quot;[no entity]&quot;)" class="string">&quot;[no entity]&quot;</span><span class="delimiter">)</span>
    <span class="delimiter">}</span><span class="delimiter">)</span><span class="delimiter">)</span>
  
  <span class="comment">/** Apply handler block when response code is 200 - 204 */</span>
  <span class="keyword">final</span> <span class="keyword">def</span> <a title="[T](hand: dispatch.Handler[T])HttpExecutor.this.HttpPackage[T]" id="25123">apply</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="25125">T</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="dispatch.Handler[T]" id="26214">hand</a>: <a href="handlers.scala.html#9484" title="dispatch.Handler[T]">Handler</a><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#25106" title="HttpExecutor.this.HttpPackage[T]">HttpPackage</a><span class="delimiter">[</span>T<span class="delimiter">]</span> = 
    <span class="delimiter">(</span><a href="#9466" title="HttpExecutor.this.type" class="keyword">this</a> <a href="#25120" title="(chk: Int =&gt; Boolean)(hand: dispatch.Handler[T])HttpExecutor.this.HttpPackage[T]">when</a> <span class="delimiter">{</span><a title="Int" id="26221">code</a> =&gt; <span class="delimiter">(</span><span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">200</span> <span title="(end: Int)scala.collection.immutable.Range.Inclusive">to</span> <span title="Int(204)" class="int">204</span><span class="delimiter">)</span> <span title="(x: Int)Boolean">contains</span> <a href="#26221" title="Int">code</a><span class="delimiter">}</span><span class="delimiter">)</span><span class="delimiter">(</span><a href="#26214" title="dispatch.Handler[T]">hand</a><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(req: dispatch.Request)org.apache.http.client.methods.HttpRequestBase" id="25126">make_message</a><span class="delimiter">(</span><a title="dispatch.Request" id="25420">req</a>: <a href="requests.scala.html#9510" title="dispatch.Request">Request</a><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <a href="#25420" title="dispatch.Request">req</a>.<a href="requests.scala.html#13133" title="=&gt; String">method</a>.<span title="()java.lang.String">toUpperCase</span> <span title="org.apache.http.client.methods.HttpRequestBase" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <span title="org.apache.http.client.methods.HttpGet">HttpGet</span>.<span title="java.lang.String(&quot;GET&quot;)">METHOD_NAME</span> =&gt; <span title="(x$1: java.lang.String)org.apache.http.client.methods.HttpGet" class="keyword">new</span> <span title="org.apache.http.client.methods.HttpGet">HttpGet</span><span class="delimiter">(</span><a href="#25420" title="dispatch.Request">req</a>.<a href="requests.scala.html#13135" title="=&gt; String">path</a><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="org.apache.http.client.methods.HttpHead">HttpHead</span>.<span title="java.lang.String(&quot;HEAD&quot;)">METHOD_NAME</span> =&gt; <span title="(x$1: java.lang.String)org.apache.http.client.methods.HttpHead" class="keyword">new</span> <span title="org.apache.http.client.methods.HttpHead">HttpHead</span><span class="delimiter">(</span><a href="#25420" title="dispatch.Request">req</a>.<a href="requests.scala.html#13135" title="=&gt; String">path</a><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="org.apache.http.client.methods.HttpDelete">HttpDelete</span>.<span title="java.lang.String(&quot;DELETE&quot;)">METHOD_NAME</span> =&gt; <span title="(x$1: java.lang.String)org.apache.http.client.methods.HttpDelete" class="keyword">new</span> <span title="org.apache.http.client.methods.HttpDelete">HttpDelete</span><span class="delimiter">(</span><a href="#25420" title="dispatch.Request">req</a>.<a href="requests.scala.html#13135" title="=&gt; String">path</a><span class="delimiter">)</span>
      <span class="keyword">case</span> <a title="org.apache.http.client.methods.HttpEntityEnclosingRequestBase" id="25698">method</a> =&gt; 
        <span class="keyword">val</span> <a title="org.apache.http.client.methods.HttpEntityEnclosingRequestBase" id="25699">message</a> = <a href="#25698" title="java.lang.String">method</a> <span title="org.apache.http.client.methods.HttpEntityEnclosingRequestBase" class="keyword">match</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> <span title="org.apache.http.client.methods.HttpPost">HttpPost</span>.<span title="java.lang.String(&quot;POST&quot;)">METHOD_NAME</span> =&gt; <span title="(x$1: java.lang.String)org.apache.http.client.methods.HttpPost" class="keyword">new</span> <span title="org.apache.http.client.methods.HttpPost">HttpPost</span><span class="delimiter">(</span><a href="#25420" title="dispatch.Request">req</a>.<a href="requests.scala.html#13135" title="=&gt; String">path</a><span class="delimiter">)</span>
          <span class="keyword">case</span> <span title="org.apache.http.client.methods.HttpPut">HttpPut</span>.<span title="java.lang.String(&quot;PUT&quot;)">METHOD_NAME</span> =&gt; <span title="(x$1: java.lang.String)org.apache.http.client.methods.HttpPut" class="keyword">new</span> <span title="org.apache.http.client.methods.HttpPut">HttpPut</span><span class="delimiter">(</span><a href="#25420" title="dispatch.Request">req</a>.<a href="requests.scala.html#13135" title="=&gt; String">path</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
        <a href="#25420" title="dispatch.Request">req</a>.<a href="requests.scala.html#13139" title="=&gt; Option[org.apache.http.HttpEntity]">body</a>.<span title="(f: org.apache.http.HttpEntity =&gt; Unit)Unit">foreach</span><span class="delimiter">(</span><a href="#25699" title="org.apache.http.client.methods.HttpEntityEnclosingRequestBase">message</a>.<a href="#25754" title="(x$1: org.apache.http.HttpEntity)Unit">setEntity</a><span class="delimiter">)</span>
        <a href="#25699" title="org.apache.http.client.methods.HttpEntityEnclosingRequestBase">message</a>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="comment">/** Apply handler block when response code is 200 - 204 */</span>
  <span class="keyword">final</span> <span class="keyword">def</span> <a title="[T](callback: dispatch.Callback[T])HttpExecutor.this.HttpPackage[T]" id="25127">apply</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="25129">T</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="dispatch.Callback[T]" id="26730">callback</a>: <a href="callbacks.scala.html#9455" title="dispatch.Callback[T]">Callback</a><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="dispatch.Request" id="26733">req</a> = <a href="#26730" title="dispatch.Callback[T]">callback</a>.<a href="callbacks.scala.html#10469" title="=&gt; dispatch.Request">request</a>
    <span class="keyword">val</span> <a title="org.apache.http.client.methods.HttpRequestBase" id="26734">request</a> = <a href="#25126" title="(req: dispatch.Request)org.apache.http.client.methods.HttpRequestBase">make_message</a><span class="delimiter">(</span><a href="#26733" title="dispatch.Request">req</a><span class="delimiter">)</span>
    <a href="#25102" title="=&gt; dispatch.Logger">log</a>.<a href="#25776" title="(msg: String, items: Any*)Unit">info</a><span class="delimiter">(</span><span title="java.lang.String(&quot;%s %s&quot;)" class="string">&quot;%s %s&quot;</span>, <a href="#26733" title="dispatch.Request">req</a>.<a href="requests.scala.html#13129" title="=&gt; org.apache.http.HttpHost">host</a>.<span title="()java.lang.String">getHostName</span>, <a href="#26734" title="org.apache.http.client.methods.HttpRequestBase">request</a>.<span title="()org.apache.http.RequestLine">getRequestLine</span><span class="delimiter">)</span>
    <a href="#26733" title="dispatch.Request">req</a>.<a href="requests.scala.html#13137" title="=&gt; dispatch.Request.Headers">headers</a>.<span title="=&gt; List[(String, String)]">reverse</span>.<span title="(f: (String, String) =&gt; Unit)Unit">foreach</span> <a href="#26756" title="Unit" class="delimiter">{</a>
      <span class="keyword">case</span> <span title="Unit" class="delimiter">(</span><a title="String" id="26759">key</a>, <a title="String" id="26760">value</a><span class="delimiter">)</span> =&gt; <a href="#26734" title="org.apache.http.client.methods.HttpRequestBase">request</a>.<span title="(x$1: java.lang.String, x$2: java.lang.String)Unit">addHeader</span><span class="delimiter">(</span><a href="#26759" title="String">key</a>, <a href="#26760" title="String">value</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
    <a href="#25110" title="(host: org.apache.http.HttpHost, credsopt: Option[dispatch.Credentials], req: org.apache.http.client.methods.HttpRequestBase, block: dispatch.Callback[T])HttpExecutor.this.HttpPackage[T]">executeWithCallback</a><span class="delimiter">(</span><a href="#26733" title="dispatch.Request">req</a>.<a href="requests.scala.html#13129" title="=&gt; org.apache.http.HttpHost">host</a>, <a href="#26733" title="dispatch.Request">req</a>.<a href="requests.scala.html#13131" title="=&gt; Option[dispatch.Credentials]">creds</a>, <a href="#26734" title="org.apache.http.client.methods.HttpRequestBase">request</a>, <a href="#26730" title="dispatch.Callback[T]">callback</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>
  <span class="keyword">private</span> <span class="keyword">var</span> <a title="Boolean" id="25131">isShutdown</a> = <span title="Boolean(false)" class="keyword">false</span>
  <span class="comment">/** Release resources held by the executor. */</span>
  <span class="keyword">def</span> <a title="()Unit" id="25133">shutdown</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <a href="#25134" title="()Unit">shutdownClient</a><span class="delimiter">(</span><span class="delimiter">)</span>;
    <a href="#25131" title="(x$1: Boolean)Unit">isShutdown</a> = <span title="Boolean(true)" class="keyword">true</span>
  <span class="delimiter">}</span>
  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="()Unit" id="25134">shutdownClient</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="Unit">Unit</span>
  <span class="comment">/** Call shutdown if not already shutdown, issue warning */</span>
  <span class="keyword">override</span> <span class="keyword">def</span> <a title="()Unit" id="25135">finalize</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#25131" title="=&gt; Boolean">isShutdown</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#25102" title="=&gt; dispatch.Logger">log</a>.<a href="#25777" title="(msg: String, items: Any*)Unit">warn</a><span class="delimiter">(</span>
        <span class="string">&quot;Shutting down garbage-collected HttpExecutor--&quot;</span> <span title="java.lang.String(&quot;Shutting down garbage-collected HttpExecutor--Call shutdown() explicitly to avoid resource leaks!&quot;)">+</span>
        <span class="string">&quot;Call shutdown() explicitly to avoid resource leaks!&quot;</span>
      <span class="delimiter">)</span>
      <a href="#25133" title="()Unit">shutdown</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
    <a href="#9466" title="dispatch.HttpExecutor" class="keyword">super</a>.<span title="()Unit">finalize</span><span class="delimiter">(</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="keyword">trait</span> <a title="trait BlockingCallback extends java.lang.Object with ScalaObject" id="9467">BlockingCallback</a> <span title="ScalaObject" class="delimiter">{</span> self: HttpExecutor =&gt;
  <span class="keyword">def</span> <a title="[T](host: org.apache.http.HttpHost, credsopt: Option[dispatch.Credentials], req: org.apache.http.client.methods.HttpRequestBase, callback: dispatch.Callback[T])BlockingCallback.this.HttpPackage[T]" id="26784">executeWithCallback</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="26786">T</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="org.apache.http.HttpHost" id="26790">host</a>: <span title="org.apache.http.HttpHost">HttpHost</span>, 
                             <a title="Option[dispatch.Credentials]" id="26791">credsopt</a>: <span title="Option[dispatch.Credentials]">Option</span><span class="delimiter">[</span>Credentials<span class="delimiter">]</span>, 
                             <a title="org.apache.http.client.methods.HttpRequestBase" id="26792">req</a>: <span title="org.apache.http.client.methods.HttpRequestBase">HttpRequestBase</span>, 
                             <a title="dispatch.Callback[T]" id="26793">callback</a>:  <a href="callbacks.scala.html#9455" title="dispatch.Callback[T]">Callback</a><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#25106" title="BlockingCallback.this.HttpPackage[T]">HttpPackage</a><span class="delimiter">[</span>T<span class="delimiter">]</span> =
    <a href="#25107" title="(host: org.apache.http.HttpHost, creds: Option[dispatch.Credentials], req: org.apache.http.client.methods.HttpRequestBase, block: org.apache.http.HttpResponse =&gt; T, listener: dispatch.package.ExceptionListener)BlockingCallback.this.HttpPackage[T]">execute</a><span class="delimiter">(</span><a href="#26790" title="org.apache.http.HttpHost">host</a>, <a href="#26791" title="Option[dispatch.Credentials]">credsopt</a>, <a href="#26792" title="org.apache.http.client.methods.HttpRequestBase">req</a>, <span class="delimiter">{</span> <a title="org.apache.http.HttpResponse" id="26806">res</a> =&gt;
      <a href="#26806" title="org.apache.http.HttpResponse">res</a>.<span title="()org.apache.http.HttpEntity">getEntity</span> <span title="T" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <span title="T" class="keyword">null</span> =&gt; <a href="#26793" title="dispatch.Callback[T]">callback</a>.<a href="callbacks.scala.html#10473" title="(v1: org.apache.http.HttpResponse)T">finish</a><span class="delimiter">(</span><a href="#26806" title="org.apache.http.HttpResponse">res</a><span class="delimiter">)</span>
        <span class="keyword">case</span> <a title="T" id="26808">entity</a> =&gt;
          <span class="keyword">val</span> <a title="java.io.InputStream" id="26809">stm</a> = <a href="#26808" title="org.apache.http.HttpEntity">entity</a>.<span title="()java.io.InputStream">getContent</span>
          <span class="keyword">val</span> <a title="Array[Byte]" id="26810">buf</a> = <span title="Array[Byte]" class="keyword">new</span> <span title="Array[Byte]">Array</span><span class="delimiter">[</span>Byte<span class="delimiter">]</span><span class="delimiter">(</span><span class="int">8</span> <span title="Int(8192)">*</span> <span class="int">1024</span><span class="delimiter">)</span>
          <span class="keyword">var</span> <a title="Int" id="26811">count</a> = <span title="Int(0)" class="int">0</span>
          <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><span class="delimiter">{</span><a href="#26811" title="Int">count</a> = <a href="#26809" title="java.io.InputStream">stm</a>.<span title="(x$1: Array[Byte])Int">read</span><span class="delimiter">(</span><a href="#26810" title="Array[Byte]">buf</a><span class="delimiter">)</span>; <a href="#26811" title="Int">count</a><span class="delimiter">}</span> <span title="(x: Int)Boolean">&gt;</span> -<span title="Int(-1)" class="int">1</span><span class="delimiter">)</span>
            <a href="#26793" title="dispatch.Callback[T]">callback</a>.<a href="callbacks.scala.html#10471" title="(v1: org.apache.http.HttpResponse, v2: Array[Byte], v3: Int)Unit">function</a><a href="#26812" title="()Unit" class="delimiter">(</a><a href="#26806" title="org.apache.http.HttpResponse">res</a>, <a href="#26810" title="Array[Byte]">buf</a>, <a href="#26811" title="Int">count</a><span class="delimiter">)</span>
          <a href="#26809" title="java.io.InputStream">stm</a>.<span title="()Unit">close</span><span class="delimiter">(</span><span class="delimiter">)</span>
          <a href="#26793" title="dispatch.Callback[T]">callback</a>.<a href="callbacks.scala.html#10473" title="(v1: org.apache.http.HttpResponse)T">finish</a><span class="delimiter">(</span><a href="#26806" title="org.apache.http.HttpResponse">res</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>, <a href="#26793" title="dispatch.Callback[T]">callback</a>.<a href="callbacks.scala.html#10475" title="=&gt; dispatch.package.ExceptionListener">listener</a><span class="delimiter">)</span>
<span class="delimiter">}</span>

case <span class="keyword">class</span> <a title="class StatusCode extends java.lang.Exception with ScalaObject with Product with Serializable" id="27031">StatusCode</a><a href="#27031" title="ScalaObject" class="delimiter">(</a><a title="Int" id="26169">code</a>: <span title="Int">Int</span>, <a title="String" id="26170">contents</a>:<span title="String">String</span><span class="delimiter">)</span>
  <span class="keyword">extends</span> <span title="java.lang.Exception">Exception</span><span class="delimiter">(</span><span title="java.lang.String(&quot;Unexpected response code: &quot;)" class="string">&quot;Unexpected response code: &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#26169" title="Int">code</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;\012&quot;)" class="string">&quot;\n&quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#26170" title="String">contents</a><span class="delimiter">)</span>

<span class="comment">/** Simple info and warn logger */</span>
<span class="keyword">trait</span> <a title="trait Logger extends java.lang.Object" id="9471">Logger</a> <span title="java.lang.Object" class="delimiter">{</span>
  <span class="keyword">def</span> <a title="(msg: String, items: Any*)Unit" id="25776">info</a><span class="delimiter">(</span><a title="String" id="25778">msg</a>: <span title="String">String</span>, <a title="Any*" id="25779">items</a>: <span title="Any*">Any</span>*<span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="(msg: String, items: Any*)Unit" id="25777">warn</a><span class="delimiter">(</span><a title="String" id="26777">msg</a>: <span title="String">String</span>, <a title="Any*" id="26778">items</a>: <span title="Any*">Any</span>*<span class="delimiter">)</span>
<span class="delimiter">}</span>

<span class="keyword">trait</span> <a title="trait RequestLogging extends java.lang.Object with ScalaObject" id="9472">RequestLogging</a> <span title="ScalaObject" class="delimiter">{</span>
  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="dispatch.Logger" id="25103">log</a>: <a href="#9471" title="dispatch.Logger">Logger</a> = <a href="#25104" title="=&gt; java.lang.Object with dispatch.Logger">make_logger</a>

  <span class="comment">/** Logger for this executor, logs to console. */</span>
  <span class="keyword">def</span> <a title="=&gt; java.lang.Object with dispatch.Logger" id="25104">make_logger</a> =
    <a href="#26920" title="java.lang.Object with dispatch.Logger" class="keyword">new</a> <a title="anonymous class $anon extends java.lang.Object with dispatch.Logger" id="26920">Logger</a> <span class="delimiter">{</span>
      <span class="keyword">def</span> <a title="(msg: String, items: Any*)Unit" id="26922">info</a><span class="delimiter">(</span><a title="String" id="26924">msg</a>: <span title="String">String</span>, <a title="Any*" id="26925">items</a>: <span title="Any*">Any</span>*<span class="delimiter">)</span> <span class="delimiter">{</span> 
        <span title="(x: Any)Unit">println</span><span class="delimiter">(</span><span title="java.lang.String(&quot;INF: [console logger] dispatch: &quot;)" class="string">&quot;INF: [console logger] dispatch: &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> 
                <a href="#26924" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">msg</a>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#26925" title="Any*">items</a>: _*<span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
      <span class="keyword">def</span> <a title="(msg: String, items: Any*)Unit" id="26923">warn</a><span class="delimiter">(</span><a title="String" id="26927">msg</a>: <span title="String">String</span>, <a title="Any*" id="26928">items</a>: <span title="Any*">Any</span>*<span class="delimiter">)</span> <span class="delimiter">{</span> 
        <span title="(x: Any)Unit">println</span><span class="delimiter">(</span><span title="java.lang.String(&quot;WARN: [console logger] dispatch: &quot;)" class="string">&quot;WARN: [console logger] dispatch: &quot;</span> <span title="(x$1: Any)java.lang.String">+</span>
                <a href="#26927" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">msg</a>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#26928" title="Any*">items</a>: _*<span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>