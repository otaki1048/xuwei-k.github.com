<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>org/scalatest/matchers/BookPropertyMatchers.scala</title>
        <script type="text/javascript" src="../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/*
 * Copyright 2001-2008 Artima, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */</span>
<span class="keyword">package</span> org.scalatest.matchers

<span class="keyword">import</span> org.scalatest.prop.Checkers
<span class="keyword">import</span> org.scalacheck._
<span class="keyword">import</span> <span title="object org.scalacheck.Arbitrary">Arbitrary</span>._
<span class="keyword">import</span> <span title="object org.scalacheck.Prop">Prop</span>._
<span class="keyword">import</span> scala.reflect.BeanProperty

<span class="keyword">trait</span> <a title="trait BookPropertyMatchers extends java.lang.Object with ScalaObject" id="12582">BookPropertyMatchers</a> <span title="ScalaObject" class="delimiter">{</span>

  case <span class="keyword">class</span> <a title="class Book extends java.lang.Object with ScalaObject with Product with Serializable" id="381465">Book</a><a href="#381465" title="ScalaObject" class="delimiter">(</a>
    <span class="keyword">var</span> <a title="String" id="381711">title</a>: <span title="String">String</span>,
    <span class="keyword">val</span> <a title="String" id="381712">author</a>: <span title="String">String</span>,
    <span class="keyword">val</span> <a title="Int" id="381713">pubYear</a>: <span title="Int">Int</span>,
    <span class="keyword">val</span> <a title="Int" id="381714">length</a>: <span title="Int">Int</span>,
    <span class="keyword">val</span> <a title="Boolean" id="381715">isGoodRead</a>: <span title="Boolean">Boolean</span>
  <span class="delimiter">)</span>

<span class="comment">/*
  case class JavaBook(
    @BeanProperty var title: String,
    private val author: String,
    @BeanProperty val pubYear: Int,
    private var length: Int,
    private val goodRead: Boolean
  ) {
    def getAuthor: String = author
    def getLength: Int = length
    def setLength(len: Int) { length = len }
    def isGoodRead: Boolean = goodRead
  }
*/</span>

<span class="comment">/*

The  BookPropertiesMatcher didn't compile in 2.8, and rightly so. There was a type error in it that wasn't caught by the 2.7 compiler.
Since I'd already decided I didn't like the nested syntax because it isn't readable enough, I am not too concerned this doesn't compile.
Probably better that it doesn't.

  case class Bookshelf(
    val book1: Book,
    val book2: Book,
    val book3: Book
  )

  class BookPropertiesMatcher(firstPropertyMatcher: HavePropertyMatcher[Book, _], propertyMatchers: HavePropertyMatcher[Book, _]*)
      extends HavePropertyMatcher[Bookshelf, Book] {

    def apply(bookshelf: Bookshelf) = {
      val propertyMatcherList = firstPropertyMatcher :: propertyMatchers.toList
      val propertyMatchResults = // This is the list of results
        for (propertyMatcher &lt;- propertyMatcherList) yield
          propertyMatcher(bookshelf.book1)

      val firstFailure = propertyMatchResults.find(_.matches == false)
      firstFailure match {
        case Some(failure) =&gt;
          new HavePropertyMatchResult(false, &quot;book1.&quot; + failure.propertyName, failure.expectedValue, failure.actualValue)
        case None =&gt;
          new HavePropertyMatchResult(true, &quot;book1&quot;, null, null) // What to do here?
      }
    }
  }

  def book1(firstPropertyMatcher: HavePropertyMatcher[Book, _], propertyMatchers: HavePropertyMatcher[Book, _]*) =
    new BookPropertiesMatcher(firstPropertyMatcher, propertyMatchers: _*)
*/</span>

  <span class="keyword">class</span> <a title="class TitleMatcher extends java.lang.Object with org.scalatest.matchers.HavePropertyMatcher[BookPropertyMatchers.this.Book,String] with ScalaObject" id="381289">TitleMatcher</a><a href="#381289" title="ScalaObject" class="delimiter">(</a><a title="String" id="381541">expectedValue</a>: <span title="String">String</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="org/scalatest/matchers/HavePropertyMatcher.scala.html#11898" title="org.scalatest.matchers.HavePropertyMatcher[BookPropertyMatchers.this.Book,String]">HavePropertyMatcher</a><span class="delimiter">[</span>Book, String<span class="delimiter">]</span> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="(book: BookPropertyMatchers.this.Book)org.scalatest.matchers.HavePropertyMatchResult[String]" id="381538">apply</a><span class="delimiter">(</span><a title="BookPropertyMatchers.this.Book" id="381542">book</a>: <a href="#381465" title="BookPropertyMatchers.this.Book">Book</a><span class="delimiter">)</span> = <span class="delimiter">{</span>
      <span title="org.scalatest.matchers.HavePropertyMatchResult[String]" class="keyword">new</span> <a href="org/scalatest/matchers/HavePropertyMatchResult.scala.html#80329" title="org.scalatest.matchers.HavePropertyMatchResult[String]">HavePropertyMatchResult</a><span class="delimiter">(</span><a href="#381542" title="BookPropertyMatchers.this.Book">book</a>.<a href="#381711" title="=&gt; String">title</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#381541" title="String">expectedValue</a>, <span title="java.lang.String(&quot;title&quot;)" class="string">&quot;title&quot;</span>, <a href="#381541" title="String">expectedValue</a>, <a href="#381542" title="BookPropertyMatchers.this.Book">book</a>.<a href="#381711" title="=&gt; String">title</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(expectedValue: String)BookPropertyMatchers.this.TitleMatcher" id="381290">title</a><span class="delimiter">(</span><a title="String" id="381565">expectedValue</a>: <span title="String">String</span><span class="delimiter">)</span> = <span title="BookPropertyMatchers.this.TitleMatcher" class="keyword">new</span> <a href="#381289" title="BookPropertyMatchers.this.TitleMatcher">TitleMatcher</a><span class="delimiter">(</span><a href="#381565" title="String">expectedValue</a><span class="delimiter">)</span>

  <span class="keyword">class</span> <a title="class AuthorMatcher extends java.lang.Object with org.scalatest.matchers.HavePropertyMatcher[BookPropertyMatchers.this.Book,String] with ScalaObject" id="381291">AuthorMatcher</a><a href="#381291" title="ScalaObject" class="delimiter">(</a><a title="String" id="381574">expectedValue</a>: <span title="String">String</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="org/scalatest/matchers/HavePropertyMatcher.scala.html#11898" title="org.scalatest.matchers.HavePropertyMatcher[BookPropertyMatchers.this.Book,String]">HavePropertyMatcher</a><span class="delimiter">[</span>Book, String<span class="delimiter">]</span> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="(book: BookPropertyMatchers.this.Book)org.scalatest.matchers.HavePropertyMatchResult[String]" id="381571">apply</a><span class="delimiter">(</span><a title="BookPropertyMatchers.this.Book" id="381575">book</a>: <a href="#381465" title="BookPropertyMatchers.this.Book">Book</a><span class="delimiter">)</span> = <span class="delimiter">{</span>
      <span title="org.scalatest.matchers.HavePropertyMatchResult[String]" class="keyword">new</span> <a href="org/scalatest/matchers/HavePropertyMatchResult.scala.html#80329" title="org.scalatest.matchers.HavePropertyMatchResult[String]">HavePropertyMatchResult</a><span class="delimiter">(</span><a href="#381575" title="BookPropertyMatchers.this.Book">book</a>.<a href="#381712" title="=&gt; String">author</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#381574" title="String">expectedValue</a>, <span title="java.lang.String(&quot;author&quot;)" class="string">&quot;author&quot;</span>, <a href="#381574" title="String">expectedValue</a>, <a href="#381575" title="BookPropertyMatchers.this.Book">book</a>.<a href="#381712" title="=&gt; String">author</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(expectedValue: String)BookPropertyMatchers.this.AuthorMatcher" id="381292">author</a><span class="delimiter">(</span><a title="String" id="381597">expectedValue</a>: <span title="String">String</span><span class="delimiter">)</span> = <span title="BookPropertyMatchers.this.AuthorMatcher" class="keyword">new</span> <a href="#381291" title="BookPropertyMatchers.this.AuthorMatcher">AuthorMatcher</a><span class="delimiter">(</span><a href="#381597" title="String">expectedValue</a><span class="delimiter">)</span>

  <span class="keyword">class</span> <a title="class PubYearMatcher extends java.lang.Object with org.scalatest.matchers.HavePropertyMatcher[BookPropertyMatchers.this.Book,Int] with ScalaObject" id="381293">PubYearMatcher</a><a href="#381293" title="ScalaObject" class="delimiter">(</a><a title="Int" id="381606">expectedValue</a>: <span title="Int">Int</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="org/scalatest/matchers/HavePropertyMatcher.scala.html#11898" title="org.scalatest.matchers.HavePropertyMatcher[BookPropertyMatchers.this.Book,Int]">HavePropertyMatcher</a><span class="delimiter">[</span>Book, Int<span class="delimiter">]</span> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="(book: BookPropertyMatchers.this.Book)org.scalatest.matchers.HavePropertyMatchResult[Int]" id="381603">apply</a><span class="delimiter">(</span><a title="BookPropertyMatchers.this.Book" id="381607">book</a>: <a href="#381465" title="BookPropertyMatchers.this.Book">Book</a><span class="delimiter">)</span> = <span class="delimiter">{</span>
      <span title="org.scalatest.matchers.HavePropertyMatchResult[Int]" class="keyword">new</span> <a href="org/scalatest/matchers/HavePropertyMatchResult.scala.html#80329" title="org.scalatest.matchers.HavePropertyMatchResult[Int]">HavePropertyMatchResult</a><span class="delimiter">(</span><a href="#381607" title="BookPropertyMatchers.this.Book">book</a>.<a href="#381713" title="=&gt; Int">pubYear</a> <span title="(x: Int)Boolean">==</span> <a href="#381606" title="Int">expectedValue</a>, <span title="java.lang.String(&quot;pubYear&quot;)" class="string">&quot;pubYear&quot;</span>, <a href="#381606" title="Int">expectedValue</a>, <a href="#381607" title="BookPropertyMatchers.this.Book">book</a>.<a href="#381713" title="=&gt; Int">pubYear</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(expectedValue: Int)BookPropertyMatchers.this.PubYearMatcher" id="381294">pubYear</a><span class="delimiter">(</span><a title="Int" id="381629">expectedValue</a>: <span title="Int">Int</span><span class="delimiter">)</span> = <span title="BookPropertyMatchers.this.PubYearMatcher" class="keyword">new</span> <a href="#381293" title="BookPropertyMatchers.this.PubYearMatcher">PubYearMatcher</a><span class="delimiter">(</span><a href="#381629" title="Int">expectedValue</a><span class="delimiter">)</span>

  <span class="keyword">class</span> <a title="class GoodReadMatcher extends java.lang.Object with org.scalatest.matchers.HavePropertyMatcher[BookPropertyMatchers.this.Book,Boolean] with ScalaObject" id="381295">GoodReadMatcher</a><a href="#381295" title="ScalaObject" class="delimiter">(</a><a title="Boolean" id="381638">expectedValue</a>: <span title="Boolean">Boolean</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="org/scalatest/matchers/HavePropertyMatcher.scala.html#11898" title="org.scalatest.matchers.HavePropertyMatcher[BookPropertyMatchers.this.Book,Boolean]">HavePropertyMatcher</a><span class="delimiter">[</span>Book, Boolean<span class="delimiter">]</span> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="(book: BookPropertyMatchers.this.Book)org.scalatest.matchers.HavePropertyMatchResult[Boolean]" id="381635">apply</a><span class="delimiter">(</span><a title="BookPropertyMatchers.this.Book" id="381639">book</a>: <a href="#381465" title="BookPropertyMatchers.this.Book">Book</a><span class="delimiter">)</span> = <span class="delimiter">{</span>
      <span title="org.scalatest.matchers.HavePropertyMatchResult[Boolean]" class="keyword">new</span> <a href="org/scalatest/matchers/HavePropertyMatchResult.scala.html#80329" title="org.scalatest.matchers.HavePropertyMatchResult[Boolean]">HavePropertyMatchResult</a><span class="delimiter">(</span><a href="#381639" title="BookPropertyMatchers.this.Book">book</a>.<a href="#381715" title="=&gt; Boolean">isGoodRead</a> <span title="(x: Boolean)Boolean">==</span> <a href="#381638" title="Boolean">expectedValue</a>, <span title="java.lang.String(&quot;goodRead&quot;)" class="string">&quot;goodRead&quot;</span>, <a href="#381638" title="Boolean">expectedValue</a>, <a href="#381639" title="BookPropertyMatchers.this.Book">book</a>.<a href="#381715" title="=&gt; Boolean">isGoodRead</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">class</span> <a title="class GoodReadBePropertyMatcher extends java.lang.Object with org.scalatest.matchers.BePropertyMatcher[BookPropertyMatchers.this.Book] with ScalaObject" id="381296">GoodReadBePropertyMatcher</a> <a href="#381296" title="ScalaObject" class="keyword">extends</a> <a href="org/scalatest/matchers/BePropertyMatcher.scala.html#11709" title="org.scalatest.matchers.BePropertyMatcher[BookPropertyMatchers.this.Book]">BePropertyMatcher</a><span class="delimiter">[</span>Book<span class="delimiter">]</span> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="(book: BookPropertyMatchers.this.Book)org.scalatest.matchers.BePropertyMatchResult" id="381662">apply</a><span class="delimiter">(</span><a title="BookPropertyMatchers.this.Book" id="381664">book</a>: <a href="#381465" title="BookPropertyMatchers.this.Book">Book</a><span class="delimiter">)</span> = <span class="delimiter">{</span>
      <span title="org.scalatest.matchers.BePropertyMatchResult" class="keyword">new</span> <a href="org/scalatest/matchers/BePropertyMatchResult.scala.html#80133" title="org.scalatest.matchers.BePropertyMatchResult">BePropertyMatchResult</a><span class="delimiter">(</span><a href="#381664" title="BookPropertyMatchers.this.Book">book</a>.<a href="#381715" title="=&gt; Boolean">isGoodRead</a>, <span title="java.lang.String(&quot;goodRead&quot;)" class="string">&quot;goodRead&quot;</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(expectedValue: Boolean)BookPropertyMatchers.this.GoodReadMatcher" id="381297">goodRead</a><span class="delimiter">(</span><a title="Boolean" id="381702">expectedValue</a>: <span title="Boolean">Boolean</span><span class="delimiter">)</span> = <span title="BookPropertyMatchers.this.GoodReadMatcher" class="keyword">new</span> <a href="#381295" title="BookPropertyMatchers.this.GoodReadMatcher">GoodReadMatcher</a><span class="delimiter">(</span><a href="#381702" title="Boolean">expectedValue</a><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="=&gt; BookPropertyMatchers.this.GoodReadBePropertyMatcher" id="381298">goodRead</a> = <span title="BookPropertyMatchers.this.GoodReadBePropertyMatcher" class="keyword">new</span> <a href="#381296" title="BookPropertyMatchers.this.GoodReadBePropertyMatcher">GoodReadBePropertyMatcher</a>
<span class="delimiter">}</span>


        </pre>
    </body>
</html>