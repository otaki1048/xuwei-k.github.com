<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>org/specs2/text/EditDistance.scala</title>
        <script type="text/javascript" src="../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> org.specs2
<span class="keyword">package</span> text
<span class="keyword">import</span> <a href="Trim.scala.html#11777" title="object org.specs2.text.Trim">Trim</a>._
<span class="keyword">import</span> <a href="Split.scala.html#11768" title="object org.specs2.text.Split">Split</a>._
<span class="comment">/**
 * The EditDistance trait provides methods to compute and display the shortest distance between 2 strings.&lt;p&gt;
 * Usage:&lt;pre&gt;
 * showDistance(&quot;kitten&quot;, &quot;sitting&quot;) // returns (&quot;(k)itt(e)n&quot;, &quot;(s)itt(i)n(g)&quot;)
 *
 * // with different separators
 * showDistance(&quot;kitten&quot;, &quot;sitting&quot;, &quot;[]&quot;) // returns (&quot;[k]itt[e]n&quot;, &quot;[s]itt[i]n[g]&quot;)
 * &lt;/pre&gt;
 */</span>
<span class="keyword">private</span><span class="delimiter">[</span>specs2<span class="delimiter">]</span>
<span class="keyword">trait</span> <a title="trait EditDistance extends java.lang.Object with ScalaObject" id="11708">EditDistance</a> <span title="ScalaObject" class="delimiter">{</span>
  <span class="comment">/**
   * Class encapsulating the functions related to the edit distance of 2 strings
   */</span>
  case <span class="keyword">class</span> <a title="class EditMatrix extends java.lang.Object with ScalaObject with Product with Serializable" id="251563">EditMatrix</a><a href="#251563" title="ScalaObject" class="delimiter">(</a><a title="String" id="252063">s1</a>: <span title="String">String</span>, <a title="String" id="252064">s2</a>: <span title="String">String</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="comment">/* matrix containing the edit distance for any prefix of s1 and s2: matrix(i)(j) = edit distance(s1[0..i], s[0..j])*/</span>
    <span class="keyword">val</span> <a title="Array[Array[Int]]" id="249416">matrix</a> = <span title="object Array">Array</span>.<span title="[T](n1: Int, n2: Int)(implicit evidence$4: scala.reflect.ClassManifest[T])Array[Array[T]]">ofDim</span><span title="(n1: Int, n2: Int)(implicit evidence$4: scala.reflect.ClassManifest[Int])Array[Array[Int]]" class="delimiter">[</span><span title="Int">Int</span><span class="delimiter">]</span><span title="=&gt; scala.reflect.AnyValManifest[Int]" class="delimiter">(</span><a href="#252063" title="=&gt; String">s1</a>.<span title="()Int">length</span> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span>, <a href="#252064" title="=&gt; String">s2</a>.<span title="()Int">length</span> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>

    <span class="comment">/* initializing the matrix */</span>
    <span class="keyword">for</span> <span class="delimiter">(</span><a title="Int" id="249605">i</a> &lt;- <span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">0</span> <span title="(f: Int =&gt; Unit)Unit">to</span> <a href="#252063" title="=&gt; String">s1</a>.<span title="()Int">length</span>;
         <a title="Int" id="249718">j</a> &lt;- <span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">0</span> <span title="(f: Int =&gt; Unit)Unit">to</span> <a href="#252064" title="=&gt; String">s2</a>.<span title="()Int">length</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#249605" title="Int">i</a> <span title="(x: Int)Boolean">==</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <a href="#249416" title="(i: Int)Array[Int]">matrix</a><span title="(i: Int, x: Int)Unit" class="delimiter">(</span><a href="#249605" title="Int">i</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#249718" title="Int">j</a><span class="delimiter">)</span> = <a href="#249718" title="Int">j</a> <span class="comment">// j insertions</span>
      <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#249718" title="Int">j</a> <span title="(x: Int)Boolean">==</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <a href="#249416" title="(i: Int)Array[Int]">matrix</a><span title="(i: Int, x: Int)Unit" class="delimiter">(</span><a href="#249605" title="Int">i</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#249718" title="Int">j</a><span class="delimiter">)</span> = <a href="#249605" title="Int">i</a>  <span class="comment">// i suppressions</span>
      <span class="keyword">else</span> <a href="#249416" title="(i: Int)Array[Int]">matrix</a><span title="(i: Int, x: Int)Unit" class="delimiter">(</span><a href="#249605" title="Int">i</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#249718" title="Int">j</a><span class="delimiter">)</span> = <a href="#249422" title="(suppr: Int, subst: Int, ins: =&gt; Int)Int">min</a><span class="delimiter">(</span><a href="#249416" title="(i: Int)Array[Int]">matrix</a><span title="(i: Int)Int" class="delimiter">(</span><a href="#249605" title="Int">i</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span><span class="delimiter">(</span><a href="#249718" title="Int">j</a><span class="delimiter">)</span> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span>, <span class="comment">// suppression</span>
                              <a href="#249416" title="(i: Int)Array[Int]">matrix</a><span title="(i: Int)Int" class="delimiter">(</span><a href="#249605" title="Int">i</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span><span class="delimiter">(</span><a href="#249718" title="Int">j</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span> <span title="(x: Int)Int">+</span> <span class="delimiter">(</span><span title="Int" class="keyword">if</span> <span class="delimiter">(</span><a href="#252063" title="(index: Int)Char">s1</a><span class="delimiter">(</span><a href="#249605" title="Int">i</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span> <span title="(x: Char)Boolean">==</span> <a href="#252064" title="(index: Int)Char">s2</a><span class="delimiter">(</span><a href="#249718" title="Int">j</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span><span class="delimiter">)</span> <span title="Int(0)" class="int">0</span> <span class="keyword">else</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>, <span class="comment">// substitution</span>
                              <a href="#249416" title="(i: Int)Array[Int]">matrix</a><span title="(i: Int)Int" class="delimiter">(</span><a href="#249605" title="Int">i</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#249718" title="Int">j</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span> <span class="comment">// insertion</span>

    <span class="delimiter">}</span>
    <span class="comment">/** @return the edit distance between 2 strings */</span>
    <span class="keyword">def</span> <a title="=&gt; Int" id="249418">distance</a> = <a href="#249416" title="(i: Int)Array[Int]">matrix</a><span title="(i: Int)Int" class="delimiter">(</span><a href="#252063" title="=&gt; String">s1</a>.<span title="()Int">length</span><span class="delimiter">)</span><span class="delimiter">(</span><a href="#252064" title="=&gt; String">s2</a>.<span title="()Int">length</span><span class="delimiter">)</span>

    <span class="comment">/** prints the edit matrix of 2 strings */</span>
    <span class="keyword">def</span> <a title="=&gt; EditDistance.this.EditMatrix" id="249419">print</a> = <span class="delimiter">{</span>
      <span class="keyword">for</span> <span class="delimiter">(</span><a title="Int" id="249982">i</a> &lt;- <span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">0</span> <span title="(f: Int =&gt; Unit)Unit">to</span> <a href="#252063" title="=&gt; String">s1</a>.<span title="()Int">length</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="keyword">def</span> <a title="=&gt; scala.collection.immutable.IndexedSeq[Int]" id="249983">row</a> = <span class="keyword">for</span> <span class="delimiter">(</span><a title="Int" id="250083">j</a> &lt;- <span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">0</span> <span title="(f: Int =&gt; Int)(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq[Int],Int,scala.collection.immutable.IndexedSeq[Int]])scala.collection.immutable.IndexedSeq[Int]">to</span> <a href="#252064" title="=&gt; String">s2</a>.<span title="()Int">length</span><span class="delimiter">)</span> <span class="keyword">yield</span> <a href="#249416" title="(i: Int)Array[Int]">matrix</a><span title="(i: Int)Int" class="delimiter">(</span><a href="#249982" title="Int">i</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#250083" title="Int">j</a><span class="delimiter">)</span>
        <span title="(x: Any)Unit">println</span><span class="delimiter">(</span><a href="#249983" title="=&gt; scala.collection.immutable.IndexedSeq[Int]">row</a>.<span title="(sep: String)String">mkString</span><span class="delimiter">(</span><span title="java.lang.String(&quot;|&quot;)" class="string">&quot;|&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
      <a href="#251563" title="EditDistance.this.EditMatrix" class="keyword">this</a>
    <span class="delimiter">}</span>

    <span class="comment">/** @return a (String, String) displaying the differences between each input strings. The used separators are parenthesis: '(' and ')'*/</span>
    <span class="keyword">def</span> <a title="=&gt; (String, String)" id="249420">showDistance</a>: <span title="(String, String)" class="delimiter">(</span>String, String<span class="delimiter">)</span> = <a href="#249421" title="(sep: String, shortenSize: Int)(String, String)">showDistance</a><span class="delimiter">(</span><span title="java.lang.String(&quot;()&quot;)" class="string">&quot;()&quot;</span>, <span title="Int(20)" class="int">20</span><span class="delimiter">)</span>

    <span class="comment">/**
     * @param sep separators used to hightlight differences. If sep is empty, then no separator is used. If sep contains
     * one character, it is taken as the unique separator. If sep contains 2 or more characters, half of them are taken for the opening separator and
     * the rest for the closing separator.
     *
     * @return a (String, String) displaying the differences between each input strings. The used separators are specified by the caller.&lt;p&gt;
     */</span>
    <span class="keyword">def</span> <a title="(sep: String, shortenSize: Int)(String, String)" id="249421">showDistance</a><span class="delimiter">(</span><a title="String" id="250173">sep</a>: <span title="String">String</span>, <a title="Int" id="250174">shortenSize</a>: <span title="Int">Int</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a href="#250178" title="(java.lang.String, java.lang.String)" class="delimiter">(</a><a href="#250177" title="java.lang.String" id="250178">firstSeparator</a>, <a href="#250177" title="java.lang.String" id="250179">secondSeparator</a><span class="delimiter">)</span> = <a href="#109070" title="(s: String)(java.lang.String, java.lang.String)">separators</a><span title="(java.lang.String, java.lang.String) @unchecked" class="delimiter">(</span><a href="#250173" title="String">sep</a><span class="delimiter">)</span>
	    <span class="keyword">def</span> <a title="(s: String, c: Char)String" id="250180">modify</a><span class="delimiter">(</span><a title="String" id="250898">s</a>: <span title="String">String</span>, <a title="Char" id="250899">c</a>: <span title="Char">Char</span><span class="delimiter">)</span>: <span title="String">String</span> = <a href="#250181" title="(s: String, mod: String)String">modifyString</a><span class="delimiter">(</span><a href="#250898" title="String">s</a>, <a href="#250899" title="Char">c</a>.<span title="()java.lang.String">toString</span><span class="delimiter">)</span>
	    <span class="keyword">def</span> <a title="(s: String, mod: String)String" id="250181">modifyString</a><span class="delimiter">(</span><a title="String" id="250900">s</a>: <span title="String">String</span>, <a title="String" id="250901">mod</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="String">String</span> = <span class="delimiter">(</span><a href="#250178" title="java.lang.String">firstSeparator</a> <span title="(x$1: Any)java.lang.String">+</span> <a href="#250901" title="String">mod</a> <span title="(x$1: Any)java.lang.String">+</span> <a href="#250179" title="java.lang.String">secondSeparator</a> <a href="Trim.scala.html#17232" title="implicit org.specs2.text.Trim.trimmed : (s: String)org.specs2.text.Trim.Trimmed">+</a> <a href="#250900" title="String">s</a><span class="delimiter">)</span>.<a href="Trim.scala.html#45010" title="(remove: String)java.lang.String">removeAll</a><span class="delimiter">(</span><a href="#250179" title="java.lang.String">secondSeparator</a> <span title="(x$1: Any)java.lang.String">+</span> <a href="#250178" title="java.lang.String">firstSeparator</a><span class="delimiter">)</span>

      <span class="keyword">def</span> <a title="(dist: Int, i: Int, j: Int, s1mod: String, s2mod: String)(String, String)" id="250182">findOperations</a><span class="delimiter">(</span><a title="Int" id="250904">dist</a>: <span title="Int">Int</span>, <a title="Int" id="250905">i</a>: <span title="Int">Int</span>, <a title="Int" id="250906">j</a>:<span title="Int">Int</span>, <a title="String" id="250907">s1mod</a>: <span title="String">String</span>, <a title="String" id="250908">s2mod</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="(String, String)" class="delimiter">(</span>String, String<span class="delimiter">)</span> = <span class="delimiter">{</span>
        <span title="(String, String)" class="keyword">if</span> <span class="delimiter">(</span><a href="#250905" title="Int">i</a> <span title="(x: Int)Boolean">==</span> <span title="Int(0)" class="int">0</span> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#250906" title="Int">j</a> <span title="(x: Int)Boolean">==</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span class="delimiter">{</span>
  	      <span title="(_1: java.lang.String, _2: java.lang.String)(java.lang.String, java.lang.String)" class="delimiter">(</span><span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span>, <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>
        <span class="keyword">else</span> <span title="(String, String)" class="keyword">if</span> <span class="delimiter">(</span><a href="#250905" title="Int">i</a> <span title="(x: Int)Boolean">==</span> <span title="Int(1)" class="int">1</span> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#250906" title="Int">j</a> <span title="(x: Int)Boolean">==</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span> <span class="delimiter">{</span>
  	      <span title="(String, String)" class="keyword">if</span> <span class="delimiter">(</span><a href="#250904" title="Int">dist</a> <span title="(x: Int)Boolean">==</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span title="(_1: String, _2: String)(String, String)" class="delimiter">(</span><a href="#252063" title="(index: Int)Char">s1</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span title="(x: String)String">+</span> <a href="#250907" title="String">s1mod</a>, <a href="#252064" title="(index: Int)Char">s2</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span title="(x: String)String">+</span> <a href="#250908" title="String">s2mod</a><span class="delimiter">)</span>
          <span class="keyword">else</span> <span title="(_1: String, _2: String)(String, String)" class="delimiter">(</span><a href="#250180" title="(s: String, c: Char)String">modify</a><span class="delimiter">(</span><a href="#250907" title="String">s1mod</a>, <a href="#252063" title="(index: Int)Char">s1</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span><span class="delimiter">)</span>, <a href="#250180" title="(s: String, c: Char)String">modify</a><span class="delimiter">(</span><a href="#250908" title="String">s2mod</a>, <a href="#252064" title="(index: Int)Char">s2</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>
        <span class="keyword">else</span> <span title="(String, String)" class="keyword">if</span> <span class="delimiter">(</span><a href="#250906" title="Int">j</a> <span title="(x: Int)Boolean">&lt;</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span> <span title="(_1: String, _2: String)(String, String)" class="delimiter">(</span><a href="#250181" title="(s: String, mod: String)String">modifyString</a><span class="delimiter">(</span><a href="#250907" title="String">s1mod</a>, <a href="#252063" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">s1</a>.<span title="(from: Int, until: Int)String">slice</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span>, <a href="#250905" title="Int">i</a><span class="delimiter">)</span><span class="delimiter">)</span>, <a href="#250181" title="(s: String, mod: String)String">modifyString</a><span class="delimiter">(</span><a href="#250908" title="String">s2mod</a>, <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="keyword">else</span> <span title="(String, String)" class="keyword">if</span> <span class="delimiter">(</span><a href="#250905" title="Int">i</a> <span title="(x: Int)Boolean">&lt;</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span> <span title="(_1: String, _2: String)(String, String)" class="delimiter">(</span><a href="#250181" title="(s: String, mod: String)String">modifyString</a><span class="delimiter">(</span><a href="#250907" title="String">s1mod</a>, <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span>, <a href="#250181" title="(s: String, mod: String)String">modifyString</a><span class="delimiter">(</span><a href="#250908" title="String">s2mod</a>, <a href="#252064" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">s2</a>.<span title="(from: Int, until: Int)String">slice</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span>, <a href="#250906" title="Int">j</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="keyword">else</span> <span class="delimiter">{</span>
	        <span class="keyword">val</span> <a href="#251280" title="(Int, Int, Int)" class="delimiter">(</a><a href="#251279" title="Int" id="251280">suppr</a>, <a href="#251279" title="Int" id="251281">subst</a>, <a href="#251279" title="Int" id="251282">ins</a><span class="delimiter">)</span> = <span title="(_1: Int, _2: Int, _3: Int)(Int, Int, Int)" class="delimiter">(</span><a href="#249416" title="(i: Int)Array[Int]">matrix</a><span title="(i: Int)Int" class="delimiter">(</span><a href="#250905" title="Int">i</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span><span class="delimiter">(</span><a href="#250906" title="Int">j</a><span class="delimiter">)</span>, <a href="#249416" title="(i: Int)Array[Int]">matrix</a><span title="(i: Int)Int" class="delimiter">(</span><a href="#250905" title="Int">i</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span><span class="delimiter">(</span><a href="#250906" title="Int">j</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>, <a href="#249416" title="(i: Int)Array[Int]">matrix</a><span title="(i: Int)Int" class="delimiter">(</span><a href="#250905" title="Int">i</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#250906" title="Int">j</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span><span class="delimiter">)</span>
	        <span title="(String, String)" class="keyword">if</span> <span class="delimiter">(</span><a href="#251280" title="Int">suppr</a> <span title="(x: Int)Boolean">&lt;</span> <a href="#251281" title="Int">subst</a><span class="delimiter">)</span>
	          <a href="#250182" title="(dist: Int, i: Int, j: Int, s1mod: String, s2mod: String)(String, String)">findOperations</a><span class="delimiter">(</span><a href="#251280" title="Int">suppr</a>, <a href="#250905" title="Int">i</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span>, <a href="#250906" title="Int">j</a>, <a href="#250180" title="(s: String, c: Char)String">modify</a><span class="delimiter">(</span><a href="#250907" title="String">s1mod</a>, <a href="#252063" title="(index: Int)Char">s1</a><span class="delimiter">(</span><a href="#250905" title="Int">i</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span><span class="delimiter">)</span>, <a href="#250181" title="(s: String, mod: String)String">modifyString</a><span class="delimiter">(</span><a href="#250908" title="String">s2mod</a>, <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
	        <span class="keyword">else</span> <span title="(String, String)" class="keyword">if</span> <span class="delimiter">(</span><a href="#251282" title="Int">ins</a> <span title="(x: Int)Boolean">&lt;</span> <a href="#251281" title="Int">subst</a><span class="delimiter">)</span>
	          <a href="#250182" title="(dist: Int, i: Int, j: Int, s1mod: String, s2mod: String)(String, String)">findOperations</a><span class="delimiter">(</span><a href="#251282" title="Int">ins</a>, <a href="#250905" title="Int">i</a>, <a href="#250906" title="Int">j</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span>, <a href="#250181" title="(s: String, mod: String)String">modifyString</a><span class="delimiter">(</span><a href="#250907" title="String">s1mod</a>, <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span>, <a href="#250180" title="(s: String, c: Char)String">modify</a><span class="delimiter">(</span><a href="#250908" title="String">s2mod</a>, <a href="#252064" title="(index: Int)Char">s2</a><span class="delimiter">(</span><a href="#250906" title="Int">j</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
	        <span class="keyword">else</span> <span title="(String, String)" class="keyword">if</span> <span class="delimiter">(</span><a href="#251281" title="Int">subst</a> <span title="(x: Int)Boolean">&lt;</span> <a href="#250904" title="Int">dist</a><span class="delimiter">)</span>
	          <a href="#250182" title="(dist: Int, i: Int, j: Int, s1mod: String, s2mod: String)(String, String)">findOperations</a><span class="delimiter">(</span><a href="#251281" title="Int">subst</a>, <a href="#250905" title="Int">i</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span>, <a href="#250906" title="Int">j</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span>, <a href="#250180" title="(s: String, c: Char)String">modify</a><span class="delimiter">(</span><a href="#250907" title="String">s1mod</a>, <a href="#252063" title="(index: Int)Char">s1</a><span class="delimiter">(</span><a href="#250905" title="Int">i</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span><span class="delimiter">)</span>, <a href="#250180" title="(s: String, c: Char)String">modify</a><span class="delimiter">(</span><a href="#250908" title="String">s2mod</a>, <a href="#252064" title="(index: Int)Char">s2</a><span class="delimiter">(</span><a href="#250906" title="Int">j</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
	        <span class="keyword">else</span>
	          <a href="#250182" title="(dist: Int, i: Int, j: Int, s1mod: String, s2mod: String)(String, String)">findOperations</a><span class="delimiter">(</span><a href="#251281" title="Int">subst</a>, <a href="#250905" title="Int">i</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span>, <a href="#250906" title="Int">j</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span>, <a href="#252063" title="(index: Int)Char">s1</a><span class="delimiter">(</span><a href="#250905" title="Int">i</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span> <span title="(x: String)String">+</span> <a href="#250907" title="String">s1mod</a>, <a href="#252064" title="(index: Int)Char">s2</a><span class="delimiter">(</span><a href="#250906" title="Int">j</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span> <span title="(x: String)String">+</span> <a href="#250908" title="String">s2mod</a><span class="delimiter">)</span>
	      <span class="delimiter">}</span>
      <span class="delimiter">}</span>
      <span class="keyword">val</span> <a href="#250184" title="(String, String)" class="delimiter">(</a><a href="#250183" title="String" id="250184">s1diffs</a>, <a href="#250183" title="String" id="250185">s2diffs</a><span class="delimiter">)</span> = <a href="#250182" title="(dist: Int, i: Int, j: Int, s1mod: String, s2mod: String)(String, String)">findOperations</a><span title="(String, String) @unchecked" class="delimiter">(</span><a href="#249418" title="=&gt; Int">distance</a>, <a href="#252063" title="=&gt; String">s1</a>.<span title="()Int">length</span>, <a href="#252064" title="=&gt; String">s2</a>.<span title="()Int">length</span>, <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span>, <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span>
      <span class="keyword">import</span> <a href="#11709" title="object org.specs2.text.DiffShortener">DiffShortener</a>._
      <span title="(_1: String, _2: String)(String, String)" class="delimiter">(</span><a href="#251530" title="(s: String, firstSep: String, secondSep: String, size: Int)String">shorten</a><span class="delimiter">(</span><a href="#250184" title="String">s1diffs</a>, <a href="#250178" title="java.lang.String">firstSeparator</a>, <a href="#250179" title="java.lang.String">secondSeparator</a>, <a href="#250174" title="Int">shortenSize</a><span class="delimiter">)</span>, <a href="#251530" title="(s: String, firstSep: String, secondSep: String, size: Int)String">shorten</a><span class="delimiter">(</span><a href="#250185" title="String">s2diffs</a>, <a href="#250178" title="java.lang.String">firstSeparator</a>, <a href="#250179" title="java.lang.String">secondSeparator</a>, <a href="#250174" title="Int">shortenSize</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
    <span class="keyword">def</span> <a title="(suppr: Int, subst: Int, ins: =&gt; Int)Int" id="249422">min</a><span class="delimiter">(</span><a title="Int" id="249729">suppr</a>: <span title="Int">Int</span>, <a title="Int" id="249730">subst</a>: <span title="Int">Int</span>, <a title="=&gt; Int" id="249731">ins</a>: =&gt;Int<span class="delimiter">)</span> = <span class="delimiter">{</span>
      <span title="Int" class="keyword">if</span><span class="delimiter">(</span><a href="#249729" title="Int">suppr</a> <span title="(x: Int)Boolean">&lt;</span> <a href="#249730" title="Int">subst</a><span class="delimiter">)</span> <a href="#249729" title="Int">suppr</a>
      <span class="keyword">else</span> <span title="Int" class="keyword">if</span> <span class="delimiter">(</span><a href="#249731" title="=&gt; Int">ins</a> <span title="(x: Int)Boolean">&lt;</span> <a href="#249730" title="Int">subst</a><span class="delimiter">)</span> <a href="#249731" title="=&gt; Int">ins</a>
      <span class="keyword">else</span> <a href="#249730" title="Int">subst</a>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
  <span class="comment">/** @return the edit distance between 2 strings = the minimum number of insertions/suppressions/substitutions to pass from one string to the other */</span>
  <span class="keyword">def</span> <a title="(s1: String, s2: String)Int" id="109063">editDistance</a><span class="delimiter">(</span><a title="String" id="112195">s1</a>: <span title="String">String</span>, <a title="String" id="112196">s2</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="Int">Int</span> = <a href="#109064" title="(s1: String, s2: String, init: Int, f: (Int, String, String) =&gt; Int)Int">foldSplittedStrings</a><span class="delimiter">(</span><a href="#112195" title="String">s1</a>, <a href="#112196" title="String">s2</a>, <span title="Int(0)" class="int">0</span>, <span class="delimiter">{</span>
    <span class="delimiter">(</span>r: <span title="Int">Int</span>, s1: <span title="String">String</span>, s2: <span title="String">String</span><span class="delimiter">)</span> =&gt; <a href="#251621" title="Int">r</a> <span title="(x: Int)Int">+</span> <span title="EditDistance.this.EditMatrix" class="keyword">new</span> <a href="#251563" title="EditDistance.this.EditMatrix">EditMatrix</a><span class="delimiter">(</span><a href="#251622" title="String">s1</a>, <a href="#251623" title="String">s2</a><span class="delimiter">)</span>.<a href="#249418" title="=&gt; Int">distance</a> <span class="delimiter">}</span>
  <span class="delimiter">)</span>

  <span class="comment">/** apply edit distance functions on strings splitted on newlines so that there are no memory issues */</span>
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="[T](s1: String, s2: String, init: T, f: (T, String, String) =&gt; T)T" id="109064">foldSplittedStrings</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="109066">T</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="String" id="251606">s1</a>: <span title="String">String</span>, <a title="String" id="251607">s2</a>: <span title="String">String</span>, <a title="T" id="251608">init</a>: <a href="#109066" title="T">T</a>, <a title="(T, String, String) =&gt; T" id="251609">f</a>: <span class="delimiter">(</span>T, String, String<span class="delimiter">)</span> =&gt; T<span class="delimiter">)</span>: <a href="#109066" title="T">T</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a href="#251633" title="(List[String], List[String])" class="delimiter">(</a><a href="#251632" title="List[String]" id="251633">splitted1</a>, <a href="#251632" title="List[String]" id="251634">splitted2</a><span class="delimiter">)</span> = <a href="#109067" title="(s1: String, s2: String)(List[String], List[String])">split</a><span title="(List[String], List[String]) @unchecked" class="delimiter">(</span><a href="#251606" title="String">s1</a>, <a href="#251607" title="String">s2</a><span class="delimiter">)</span>
    <a href="#251633" title="List[String]">splitted1</a>.<span title="(that: scala.collection.GenIterable[String])(implicit bf: scala.collection.generic.CanBuildFrom[List[String],(String, String),List[(String, String)]])List[(String, String)]">zip</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.List.Coll,(String, String),List[(String, String)]]" class="delimiter">(</span><a href="#251634" title="List[String]">splitted2</a><span class="delimiter">)</span>.<span title="(z: T)(f: (T, (String, String)) =&gt; T)T">foldLeft</span><span class="delimiter">(</span><a href="#251608" title="T">init</a><span class="delimiter">)</span> <span class="delimiter">{</span> <span class="delimiter">(</span><a title="T" id="251716">result</a>, <a title="(String, String)" id="251717">current</a><span class="delimiter">)</span> =&gt;
      <a href="#251609" title="(v1: T, v2: String, v3: String)T">f</a><span class="delimiter">(</span><a href="#251716" title="T">result</a>, <a href="#251717" title="(String, String)">current</a>.<span title="=&gt; String">_1</span>, <a href="#251717" title="(String, String)">current</a>.<span title="=&gt; String">_2</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * In order to avoid CPU and memory issues, split the 2 strings to compare:
   *  - along newlines. This is useful if the 2 strings represent a file content
   *  - otherwise split the strings so that they are less than 200 characters long
   */</span>
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(s1: String, s2: String)(List[String], List[String])" id="109067">split</a><span class="delimiter">(</span><a title="String" id="251635">s1</a>: <span title="String">String</span>, <a title="String" id="251636">s2</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="(List[String], List[String])" class="delimiter">(</span>List<span class="delimiter">[</span>String<span class="delimiter">]</span>, List<span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a href="#251722" title="(List[java.lang.String], List[java.lang.String])" class="delimiter">(</a><a href="#251721" title="List[java.lang.String]" id="251722">splitted1</a>, <a href="#251721" title="List[java.lang.String]" id="251723">splitted2</a><span class="delimiter">)</span> = <span title="(_1: List[java.lang.String], _2: List[java.lang.String])(List[java.lang.String], List[java.lang.String])" class="delimiter">(</span><a href="#251635" title="String">s1</a>.<span title="(x$1: java.lang.String)Array[java.lang.String]">split</span><span title="(xs: Array[java.lang.String])scala.collection.mutable.ArrayOps[java.lang.String]" class="delimiter">(</span><span title="java.lang.String(&quot;\012&quot;)" class="string">&quot;\n&quot;</span><span class="delimiter">)</span>.<span title="=&gt; List[java.lang.String]">toList</span>, <a href="#251636" title="String">s2</a>.<span title="(x$1: java.lang.String)Array[java.lang.String]">split</span><span title="(xs: Array[java.lang.String])scala.collection.mutable.ArrayOps[java.lang.String]" class="delimiter">(</span><span title="java.lang.String(&quot;\012&quot;)" class="string">&quot;\n&quot;</span><span class="delimiter">)</span>.<span title="=&gt; List[java.lang.String]">toList</span><span class="delimiter">)</span>
    <span class="keyword">def</span> <a title="(strings: List[String])List[String]" id="251724">splitToSize</a><span class="delimiter">(</span><a title="List[String]" id="251962">strings</a>: <span title="List[String]">List</span><span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">)</span> = <a href="#251962" title="List[String]">strings</a>.<span title="(f: String =&gt; scala.collection.GenTraversableOnce[String])(implicit bf: scala.collection.generic.CanBuildFrom[List[String],String,List[String]])List[String]">flatMap</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.List.Coll,String,List[String]]" class="delimiter">(</span><a href="Split.scala.html#112198" title="implicit org.specs2.text.Split.split : (s: String)org.specs2.text.Split.Splitted">_</a>.<a href="Split.scala.html#249453" title="(n: Int)List[String]">splitToSize</a><span class="delimiter">(</span><span title="Int(200)" class="int">200</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <span title="(_1: List[String], _2: List[String])(List[String], List[String])" class="delimiter">(</span><a href="#251724" title="(strings: List[String])List[String]">splitToSize</a><span class="delimiter">(</span><a href="#251722" title="List[java.lang.String]">splitted1</a><span class="delimiter">)</span>, <a href="#251724" title="(strings: List[String])List[String]">splitToSize</a><span class="delimiter">(</span><a href="#251723" title="List[java.lang.String]">splitted2</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>
  <span class="comment">/** prints on the console the edit matrix for 2 strings */</span>
  <span class="keyword">def</span> <a title="(s1: String, s2: String)Any" id="109068">showMatrix</a><span class="delimiter">(</span><a title="String" id="252021">s1</a>: <span title="String">String</span>, <a title="String" id="252022">s2</a>: <span title="String">String</span><span class="delimiter">)</span> = <a href="#109064" title="(s1: String, s2: String, init: Any, f: (Any, String, String) =&gt; Any)Any">foldSplittedStrings</a><span class="delimiter">(</span><a href="#252021" title="String">s1</a>, <a href="#252022" title="String">s2</a>, <span title="Unit" class="delimiter">(</span><span class="delimiter">)</span>, <span class="delimiter">{</span>
    <span class="delimiter">(</span>r: <span title="Any">Any</span>, s1: <span title="String">String</span>, s2: <span title="String">String</span><span class="delimiter">)</span> =&gt; <span title="EditDistance.this.EditMatrix" class="keyword">new</span> <a href="#251563" title="EditDistance.this.EditMatrix">EditMatrix</a><span class="delimiter">(</span><a href="#252032" title="String">s1</a>, <a href="#252033" title="String">s2</a><span class="delimiter">)</span>.<a href="#249419" title="=&gt; EditDistance.this.EditMatrix">print</a> <span class="delimiter">}</span>
  <span class="delimiter">)</span>

  <span class="comment">/**
   * @param sep separators used to hightlight differences. If sep is empty, then no separator is used. If sep contains
   * one character, it is taken as the unique separator. If sep contains 2 or more characters, the first half of the characters are taken as
   * opening separator and the second half as closing separator.
   *
   * @return a (String, String) displaying the differences between each input strings.
   * The used separators are specified by the caller. The string is shortened before and after differences if necessary. &lt;p&gt;
   */</span>
  <span class="keyword">def</span> <a title="(s1: String, s2: String, sep: String, shortenSize: Int)(String, String)" id="109069">showDistance</a><span class="delimiter">(</span><a title="String" id="112487">s1</a>: <span title="String">String</span>, <a title="String" id="112488">s2</a>: <span title="String">String</span>, <a title="String" id="112492">sep</a>: <span title="String">String</span> = <span title="java.lang.String(&quot;[]&quot;)" class="string">&quot;[]&quot;</span>, <a title="Int" id="112493">shortenSize</a>: <span title="Int">Int</span> = <span title="Int(20)" class="int">20</span><span class="delimiter">)</span>: <span title="(String, String)" class="delimiter">(</span>String, String<span class="delimiter">)</span> = <span class="delimiter">{</span>
    <a href="#109064" title="(s1: String, s2: String, init: (java.lang.String, java.lang.String), f: ((java.lang.String, java.lang.String), String, String) =&gt; (java.lang.String, java.lang.String))(java.lang.String, java.lang.String)">foldSplittedStrings</a><span class="delimiter">(</span><a href="#112487" title="String">s1</a>, <a href="#112488" title="String">s2</a>, <span title="(_1: java.lang.String, _2: java.lang.String)(java.lang.String, java.lang.String)" class="delimiter">(</span><span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span>, <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span>, <span class="delimiter">{</span> <span class="delimiter">(</span>r: <span title="(String, String)" class="delimiter">(</span>String, String<span class="delimiter">)</span>, s1: <span title="String">String</span>, s2: <span title="String">String</span><span class="delimiter">)</span> =&gt;
        <span class="keyword">val</span> <a title="(String, String)" id="252061">showDistance</a> = <a href="#251563" title="(s1: String, s2: String)EditDistance.this.EditMatrix">EditMatrix</a><span class="delimiter">(</span><a href="#252059" title="String">s1</a>, <a href="#252060" title="String">s2</a><span class="delimiter">)</span>.<a href="#249421" title="(sep: String, shortenSize: Int)(String, String)">showDistance</a><span class="delimiter">(</span><a href="#112492" title="String">sep</a>, <a href="#112493" title="Int">shortenSize</a><span class="delimiter">)</span>
        <span class="keyword">def</span> <a title="(s: String)String" id="252062">skipLine</a><span class="delimiter">(</span><a title="String" id="252072">s</a>: <span title="String">String</span><span class="delimiter">)</span> = <span title="String" class="keyword">if</span> <span class="delimiter">(</span><a href="#252072" title="String">s</a>.<span title="()Boolean">isEmpty</span><span class="delimiter">)</span> <a href="#252072" title="String">s</a> <span class="keyword">else</span> <span class="delimiter">(</span><a href="#252072" title="String">s</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;\012&quot;)" class="string">&quot;\n&quot;</span><span class="delimiter">)</span>
        <span title="(_1: java.lang.String, _2: java.lang.String)(java.lang.String, java.lang.String)" class="delimiter">(</span><a href="#252062" title="(s: String)String">skipLine</a><span class="delimiter">(</span><a href="#252058" title="(String, String)">r</a>.<span title="=&gt; String">_1</span><span class="delimiter">)</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#252061" title="(String, String)">showDistance</a>.<span title="=&gt; String">_1</span>, <a href="#252062" title="(s: String)String">skipLine</a><span class="delimiter">(</span><a href="#252058" title="(String, String)">r</a>.<span title="=&gt; String">_2</span><span class="delimiter">)</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#252061" title="(String, String)">showDistance</a>.<span title="=&gt; String">_2</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(s: String)(java.lang.String, java.lang.String)" id="109070">separators</a><span class="delimiter">(</span><a title="String" id="250187">s</a>: <span title="String">String</span><span class="delimiter">)</span> = <span title="(_1: java.lang.String, _2: java.lang.String)(java.lang.String, java.lang.String)" class="delimiter">(</span><a href="#109071" title="(s: String)java.lang.String">firstSeparator</a><span class="delimiter">(</span><a href="#250187" title="String">s</a><span class="delimiter">)</span>, <a href="#109072" title="(s: String)java.lang.String">secondSeparator</a><span class="delimiter">(</span><a href="#250187" title="String">s</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(s: String)java.lang.String" id="109071">firstSeparator</a><span class="delimiter">(</span><a title="String" id="250194">s</a>: <span title="String">String</span><span class="delimiter">)</span> = <span title="java.lang.String" class="keyword">if</span> <span class="delimiter">(</span><a href="#250194" title="String">s</a>.<span title="()Boolean">isEmpty</span><span class="delimiter">)</span> <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span> <span class="keyword">else</span> <a href="#250194" title="String">s</a>.<span title="(x$1: Int, x$2: Int)java.lang.String">substring</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span>, <a href="#250194" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">s</a>.<span title="=&gt; Int">size</span> <span title="(x: Int)Int">/</span> <span title="Int(2)" class="int">2</span> <span title="(x: Int)Int">+</span> <a href="#250194" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">s</a>.<span title="=&gt; Int">size</span> <span title="(x: Int)Int">%</span> <span title="Int(2)" class="int">2</span><span class="delimiter">)</span>
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(s: String)java.lang.String" id="109072">secondSeparator</a><span class="delimiter">(</span><a title="String" id="250429">s</a>: <span title="String">String</span><span class="delimiter">)</span> = <span title="java.lang.String" class="keyword">if</span> <span class="delimiter">(</span><a href="#250429" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">s</a>.<span title="=&gt; Int">size</span> <span title="(x: Int)Boolean">&lt;</span> <span title="Int(2)" class="int">2</span><span class="delimiter">)</span> <a href="#109071" title="(s: String)java.lang.String">firstSeparator</a><span class="delimiter">(</span><a href="#250429" title="String">s</a><span class="delimiter">)</span> <span class="keyword">else</span> <a href="#250429" title="String">s</a>.<span title="(x$1: Int, x$2: Int)java.lang.String">substring</span><span class="delimiter">(</span><a href="#250429" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">s</a>.<span title="=&gt; Int">size</span> <span title="(x: Int)Int">/</span> <span title="Int(2)" class="int">2</span> <span title="(x: Int)Int">+</span> <a href="#250429" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">s</a>.<span title="=&gt; Int">size</span> <span title="(x: Int)Int">%</span> <span title="Int(2)" class="int">2</span>, <a href="#250429" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">s</a>.<span title="=&gt; Int">size</span><span class="delimiter">)</span>
<span class="delimiter">}</span>

<span class="comment">/**
 * This object help shortening strings between differences when the strings are too long
 */</span>
<span class="keyword">private</span><span class="delimiter">[</span>specs2<span class="delimiter">]</span>
<span class="keyword">object</span> <a title="object org.specs2.text.DiffShortener" id="11709">DiffShortener</a> <span title="ScalaObject" class="delimiter">{</span>
  <span class="keyword">def</span> <a title="(s: String, firstSep: String, secondSep: String, size: Int)String" id="251530">shorten</a><span class="delimiter">(</span><a title="String" id="251536">s</a>: <span title="String">String</span>, <a title="String" id="251541">firstSep</a>: <span title="String">String</span> = <span title="java.lang.String(&quot;[&quot;)" class="string">&quot;[&quot;</span>, <a title="String" id="251542">secondSep</a>: <span title="String">String</span> = <span title="java.lang.String(&quot;]&quot;)" class="string">&quot;]&quot;</span>, <a title="Int" id="251543">size</a>: <span title="Int">Int</span> = <span title="Int(5)" class="int">5</span><span class="delimiter">)</span>: <span title="String">String</span> = <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="(s: String)java.lang.String" id="252091">shortenLeft</a><span class="delimiter">(</span><a title="String" id="252095">s</a>: <span title="String">String</span><span class="delimiter">)</span> = <span title="java.lang.String" class="keyword">if</span> <span class="delimiter">(</span><a href="#252095" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">s</a>.<span title="=&gt; Int">size</span> <span title="(x: Int)Boolean">&gt;</span> <a href="#251543" title="Int">size</a><span class="delimiter">)</span> <span class="delimiter">(</span><span title="java.lang.String(&quot;...&quot;)" class="string">&quot;...&quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#252095" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">s</a>.<span title="(from: Int, until: Int)String">slice</span><span class="delimiter">(</span><a href="#252095" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">s</a>.<span title="=&gt; Int">size</span> <span title="(x: Int)Int">-</span> <a href="#251543" title="Int">size</a>, <a href="#252095" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">s</a>.<span title="=&gt; Int">size</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="keyword">else</span> <a href="#252095" title="String">s</a>
    <span class="keyword">def</span> <a title="(s: String)java.lang.String" id="252092">shortenRight</a><span class="delimiter">(</span><a title="String" id="252540">s</a>: <span title="String">String</span><span class="delimiter">)</span> = <span title="java.lang.String" class="keyword">if</span> <span class="delimiter">(</span><a href="#252540" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">s</a>.<span title="=&gt; Int">size</span> <span title="(x: Int)Boolean">&gt;</span> <a href="#251543" title="Int">size</a><span class="delimiter">)</span> <span class="delimiter">(</span><a href="#252540" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">s</a>.<span title="(from: Int, until: Int)String">slice</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span>, <a href="#251543" title="Int">size</a><span class="delimiter">)</span> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;...&quot;)" class="string">&quot;...&quot;</span><span class="delimiter">)</span> <span class="keyword">else</span> <a href="#252540" title="String">s</a>
    <span class="keyword">def</span> <a title="(s: String)java.lang.String" id="252093">shortenCenter</a><span class="delimiter">(</span><a title="String" id="252763">s</a>: <span title="String">String</span><span class="delimiter">)</span> = <span title="java.lang.String" class="keyword">if</span> <span class="delimiter">(</span><a href="#252763" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">s</a>.<span title="=&gt; Int">size</span> <span title="(x: Int)Boolean">&gt;</span> <a href="#251543" title="Int">size</a><span class="delimiter">)</span> <span class="delimiter">(</span><a href="#252763" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">s</a>.<span title="(from: Int, until: Int)String">slice</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span>, <a href="#251543" title="Int">size</a> <span title="(x: Int)Int">/</span> <span title="Int(2)" class="int">2</span><span class="delimiter">)</span> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;...&quot;)" class="string">&quot;...&quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#252763" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">s</a>.<span title="(from: Int, until: Int)String">slice</span><span class="delimiter">(</span><a href="#252763" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">s</a>.<span title="=&gt; Int">size</span> <span title="(x: Int)Int">-</span> <a href="#251543" title="Int">size</a> <span title="(x: Int)Int">/</span> <span title="Int(2)" class="int">2</span>, <a href="#252763" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">s</a>.<span title="=&gt; Int">size</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="keyword">else</span> <a href="#252763" title="String">s</a>
    <span class="keyword">val</span> <a title="List[String]" id="252094">list</a> = <a href="#251531" title="(s: String, firstSep: String, secondSep: String)List[String]">sepList</a><span class="delimiter">(</span><a href="#251536" title="String">s</a>, <a href="#251541" title="String">firstSep</a>, <a href="#251542" title="String">secondSep</a><span class="delimiter">)</span>
    <a href="#252094" title="List[String]">list</a>.<span title="(z: java.lang.String)(f: (java.lang.String, String) =&gt; java.lang.String)java.lang.String">foldLeft</span><span class="delimiter">(</span><span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span> <span class="delimiter">{</span> <span class="delimiter">(</span><a title="java.lang.String" id="254310">res</a>, <a title="String" id="254311">cur</a><span class="delimiter">)</span> =&gt;
      <span title="java.lang.String" class="keyword">if</span> <span class="delimiter">(</span><a href="#254311" title="String">cur</a>.<span title="(x$1: java.lang.String)Boolean">startsWith</span><span class="delimiter">(</span><a href="#251541" title="String">firstSep</a><span class="delimiter">)</span> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#254311" title="String">cur</a>.<span title="(x$1: java.lang.String)Boolean">endsWith</span><span class="delimiter">(</span><a href="#251542" title="String">secondSep</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <a href="#254310" title="java.lang.String">res</a> <span title="(x$1: Any)java.lang.String">+</span> <a href="#254311" title="String">cur</a>
      <span class="keyword">else</span> <span title="java.lang.String" class="keyword">if</span> <span class="delimiter">(</span><a href="#252094" title="List[String]">list</a>.<span title="=&gt; String">head</span> <span title="(x$1: AnyRef)Boolean">eq</span> <a href="#254311" title="String">cur</a><span class="delimiter">)</span>
        <a href="#254310" title="java.lang.String">res</a> <span title="(x$1: Any)java.lang.String">+</span> <a href="#252091" title="(s: String)java.lang.String">shortenLeft</a><span class="delimiter">(</span><a href="#254311" title="String">cur</a><span class="delimiter">)</span>
      <span class="keyword">else</span> <span title="java.lang.String" class="keyword">if</span> <span class="delimiter">(</span><a href="#252094" title="List[String]">list</a>.<span title="=&gt; String">last</span> <span title="(x$1: AnyRef)Boolean">eq</span> <a href="#254311" title="String">cur</a><span class="delimiter">)</span>
        <a href="#254310" title="java.lang.String">res</a> <span title="(x$1: Any)java.lang.String">+</span> <a href="#252092" title="(s: String)java.lang.String">shortenRight</a><span class="delimiter">(</span><a href="#254311" title="String">cur</a><span class="delimiter">)</span>
      <span class="keyword">else</span>
        <a href="#254310" title="java.lang.String">res</a> <span title="(x$1: Any)java.lang.String">+</span> <a href="#252093" title="(s: String)java.lang.String">shortenCenter</a><span class="delimiter">(</span><a href="#254311" title="String">cur</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
  <span class="keyword">def</span> <a title="(s: String, firstSep: String, secondSep: String)List[String]" id="251531">sepList</a><span class="delimiter">(</span><a title="String" id="253325">s</a>: <span title="String">String</span>, <a title="String" id="253326">firstSep</a>: <span title="String">String</span>, <a title="String" id="253327">secondSep</a>: <span title="String">String</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="(s: String, sep: String)Array[String]" id="253330">split</a><span class="delimiter">(</span><a title="String" id="253332">s</a>: <span title="String">String</span>, <a title="String" id="253333">sep</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="Array[String]">Array</span><span class="delimiter">[</span>String<span class="delimiter">]</span> =
      <span title="Array[String]" class="keyword">if</span> <span class="delimiter">(</span><span title="(xs: java.lang.String*)List[java.lang.String]">List</span><span class="delimiter">(</span><span title="java.lang.String(&quot;[&quot;)" class="string">&quot;[&quot;</span>, <span title="java.lang.String(&quot;]&quot;)" class="string">&quot;]&quot;</span> ,<span title="java.lang.String(&quot;(&quot;)" class="string">&quot;(&quot;</span>, <span title="java.lang.String(&quot;)&quot;)" class="string">&quot;)&quot;</span>, <span title="java.lang.String(&quot;-&quot;)" class="string">&quot;-&quot;</span>, <span title="java.lang.String(&quot;+&quot;)" class="string">&quot;+&quot;</span>, <span title="java.lang.String(&quot;?&quot;)" class="string">&quot;?&quot;</span>, <span title="java.lang.String(&quot;*&quot;)" class="string">&quot;*&quot;</span><span class="delimiter">)</span>.<span title="(elem: Any)Boolean">contains</span><span class="delimiter">(</span><a href="#253333" title="String">sep</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="#253330" title="(s: String, sep: String)Array[String]">split</a><span class="delimiter">(</span><a href="#253332" title="String">s</a>, <span title="java.lang.String(&quot;\\&quot;)" class="string">&quot;\\&quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#253333" title="String">sep</a><span class="delimiter">)</span> <span class="keyword">else</span> <a href="#253332" title="String">s</a>.<span title="(x$1: java.lang.String)Array[java.lang.String]">split</span><span class="delimiter">(</span><a href="#253333" title="String">sep</a><span class="delimiter">)</span>

    <span class="keyword">val</span> <a title="Array[String]" id="253331">splitted</a> = <a href="#253330" title="(s: String, sep: String)Array[String]">split</a><span class="delimiter">(</span><a href="#253325" title="String">s</a>, <a href="#253326" title="String">firstSep</a><span class="delimiter">)</span>
    <span title="List[String]" class="keyword">if</span> <span class="delimiter">(</span><a href="#253331" title="(xs: Array[String])scala.collection.mutable.ArrayOps[String]">splitted</a>.<span title="=&gt; Int">size</span> <span title="(x: Int)Boolean">==</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span> <span title="(xs: String*)List[String]">List</span><span class="delimiter">(</span><a href="#253325" title="String">s</a><span class="delimiter">)</span>
    <span class="keyword">else</span> <span class="delimiter">{</span>
      <a href="#253331" title="(xs: Array[String])scala.collection.mutable.ArrayOps[String]">splitted</a>.<span title="(z: List[String])(op: (List[String], String) =&gt; List[String])List[String]">foldLeft</span><span class="delimiter">(</span>List<span class="delimiter">[</span>String<span class="delimiter">]</span><span title="object Nil" class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span> <span class="delimiter">(</span><a title="List[String]" id="253902">res</a>, <a title="String" id="253903">cur</a><span class="delimiter">)</span> =&gt;
        <span title="List[String]" class="keyword">if</span> <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#253903" title="String">cur</a>.<span title="(x$1: java.lang.CharSequence)Boolean">contains</span><span class="delimiter">(</span><a href="#253327" title="String">secondSep</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="#253902" title="List[String]">res</a> <span title="(elem: String)(implicit bf: scala.collection.generic.CanBuildFrom[List[String],String,List[String]])List[String]">:+</span> <a href="#253903" title="String">cur</a>
        <span class="keyword">else</span> <span class="delimiter">{</span>
          <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="String" id="253949">diff</a> = <a href="#253330" title="(s: String, sep: String)Array[String]">split</a><span title="(i: Int)String" class="delimiter">(</span><a href="#253903" title="String">cur</a>, <a href="#253327" title="String">secondSep</a><span class="delimiter">)</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
          <span title="List[String]" class="keyword">if</span> <span class="delimiter">(</span><a href="#253330" title="(s: String, sep: String)Array[String]">split</a><span title="(xs: Array[String])scala.collection.mutable.ArrayOps[String]" class="delimiter">(</span><a href="#253903" title="String">cur</a>, <a href="#253327" title="String">secondSep</a><span class="delimiter">)</span>.<span title="=&gt; Int">size</span> <span title="(x: Int)Boolean">==</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
            <a href="#253902" title="List[String]">res</a> <span title="(elem: String)(implicit bf: scala.collection.generic.CanBuildFrom[List[String],String,List[String]])List[String]">:+</span> <span class="delimiter">(</span><a href="#253326" title="String">firstSep</a> <span title="(x$1: Any)java.lang.String">+</span> <a href="#253327" title="String">secondSep</a><span class="delimiter">)</span>
          <span class="keyword">else</span> <span title="List[String]" class="keyword">if</span> <span class="delimiter">(</span><a href="#253330" title="(s: String, sep: String)Array[String]">split</a><span title="(xs: Array[String])scala.collection.mutable.ArrayOps[String]" class="delimiter">(</span><a href="#253903" title="String">cur</a>, <a href="#253327" title="String">secondSep</a><span class="delimiter">)</span>.<span title="=&gt; Int">size</span> <span title="(x: Int)Boolean">&gt;</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
            <a href="#253902" title="List[String]">res</a> <span title="(that: scala.collection.GenTraversableOnce[String])(implicit bf: scala.collection.generic.CanBuildFrom[List[String],String,List[String]])List[String]">++</span> <span title="(xs: String*)List[String]">List</span><span class="delimiter">(</span><a href="#253326" title="String">firstSep</a> <span title="(x$1: Any)java.lang.String">+</span> <a href="#253948" title="=&gt; String">diff</a> <span title="(x$1: Any)java.lang.String">+</span> <a href="#253327" title="String">secondSep</a>, <a href="#253330" title="(s: String, sep: String)Array[String]">split</a><span title="(i: Int)String" class="delimiter">(</span><a href="#253903" title="String">cur</a>, <a href="#253327" title="String">secondSep</a><span class="delimiter">)</span><span class="delimiter">(</span><span title="Int(1)" class="int">1</span><span class="delimiter">)</span><span class="delimiter">)</span>
          <span class="keyword">else</span>
            <a href="#253902" title="List[String]">res</a> <span title="(elem: String)(implicit bf: scala.collection.generic.CanBuildFrom[List[String],String,List[String]])List[String]">:+</span> <span class="delimiter">(</span><a href="#253326" title="String">firstSep</a> <span title="(x$1: Any)java.lang.String">+</span> <a href="#253948" title="=&gt; String">diff</a> <span title="(x$1: Any)java.lang.String">+</span> <a href="#253327" title="String">secondSep</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="keyword">private</span><span class="delimiter">[</span>specs2<span class="delimiter">]</span>
<span class="keyword">object</span> <a title="object org.specs2.text.EditDistance" id="11711">EditDistance</a> <span title="ScalaObject" class="keyword">extends</span> <a href="#11708" title="org.specs2.text.EditDistance">EditDistance</a>


        </pre>
    </body>
</html>