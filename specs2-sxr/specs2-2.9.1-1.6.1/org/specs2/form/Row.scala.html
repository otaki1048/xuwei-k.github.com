<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>org/specs2/form/Row.scala</title>
        <script type="text/javascript" src="../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> org.specs2
<span class="keyword">package</span> form

<span class="keyword">import</span> org.specs2.internal.scalaz.<span class="delimiter">{</span> NonEmptyList, Scalaz <span class="delimiter">}</span>
<span class="keyword">import</span> <span title="object org.specs2.internal.scalaz.Scalaz">Scalaz</span>.nel
<span class="keyword">import</span> execute._
<span class="keyword">import</span> <a href="../execute/StandardResults.scala.html#9725" title="object org.specs2.execute.StandardResults">StandardResults</a>._

<span class="comment">/**
 * A Row is a non-empty list of Cells
 * 
 * A Row can be executed by executing each Cell and collecting the results.
 */</span>
case <span class="keyword">class</span> <a title="class Row extends java.lang.Object with org.specs2.execute.Executable with ScalaObject with Product with Serializable" id="74206">Row</a><a href="#74206" title="ScalaObject" class="delimiter">(</a><span class="keyword">private</span> <span class="keyword">val</span> <a title="org.specs2.internal.scalaz.NonEmptyList[org.specs2.form.Cell]" id="82387">cellList</a>: <span title="org.specs2.internal.scalaz.NonEmptyList[org.specs2.form.Cell]">NonEmptyList</span><span class="delimiter">[</span>Cell<span class="delimiter">]</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="../execute/Executable.scala.html#9648" title="org.specs2.execute.Executable">Executable</a> <span class="delimiter">{</span>
  <span class="comment">/** @return all the cells */</span>
  <span class="keyword">def</span> <a title="=&gt; List[org.specs2.form.Cell]" id="74178">cells</a> = <a href="#82387" title="=&gt; org.specs2.internal.scalaz.NonEmptyList[org.specs2.form.Cell]">cellList</a>.<span title="=&gt; List[org.specs2.form.Cell]">list</span>
  
  <span class="comment">/** @return a Row where every cell is executed with a Success */</span>
  <span class="keyword">def</span> <a title="=&gt; org.specs2.form.Row" id="74179">setSuccess</a> = <span title="org.specs2.form.Row" class="keyword">new</span> <a href="#74206" title="org.specs2.form.Row">Row</a><span class="delimiter">(</span><a href="#82387" title="=&gt; org.specs2.internal.scalaz.NonEmptyList[org.specs2.form.Cell]">cellList</a>.<span title="(f: org.specs2.form.Cell =&gt; org.specs2.form.Cell)org.specs2.internal.scalaz.NonEmptyList[org.specs2.form.Cell]">map</span><span class="delimiter">(</span><a href="#82602" title="org.specs2.form.Cell">_</a>.<a href="Cells.scala.html#73631" title="=&gt; org.specs2.form.Cell">setSuccess</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="comment">/** @return a Row where every cell is executed with a Failure */</span>
  <span class="keyword">def</span> <a title="=&gt; org.specs2.form.Row" id="74180">setFailure</a> = <span title="org.specs2.form.Row" class="keyword">new</span> <a href="#74206" title="org.specs2.form.Row">Row</a><span class="delimiter">(</span><a href="#82387" title="=&gt; org.specs2.internal.scalaz.NonEmptyList[org.specs2.form.Cell]">cellList</a>.<span title="(f: org.specs2.form.Cell =&gt; org.specs2.form.Cell)org.specs2.internal.scalaz.NonEmptyList[org.specs2.form.Cell]">map</span><span class="delimiter">(</span><a href="#82660" title="org.specs2.form.Cell">_</a>.<a href="Cells.scala.html#73632" title="=&gt; org.specs2.form.Cell">setFailure</a><span class="delimiter">)</span><span class="delimiter">)</span>
  
  <span class="comment">/** 
   * execute all cells
   * @return a logical `and` on all results
   */</span>
  <span class="keyword">def</span> <a title="=&gt; org.specs2.execute.Result" id="74181">execute</a> = <a href="#82387" title="=&gt; org.specs2.internal.scalaz.NonEmptyList[org.specs2.form.Cell]">cellList</a>.<span title="=&gt; List[org.specs2.form.Cell]">list</span>.<span title="(z: org.specs2.execute.Result)(f: (org.specs2.execute.Result, org.specs2.form.Cell) =&gt; org.specs2.execute.Result)org.specs2.execute.Result">foldLeft</span><span class="delimiter">(</span><a href="../execute/StandardResults.scala.html#55290" title="=&gt; org.specs2.execute.Success">success</a>: <a href="../execute/Result.scala.html#9666" title="org.specs2.execute.Result">Result</a><span class="delimiter">)</span> <span class="delimiter">{</span> <span class="delimiter">(</span><a title="org.specs2.execute.Result" id="82475">res</a>, <a title="org.specs2.form.Cell" id="82476">cur</a><span class="delimiter">)</span> =&gt;  <a href="#82475" title="org.specs2.execute.Result">res</a> <a href="../execute/Result.scala.html#32484" title="(r: =&gt; org.specs2.execute.Result)org.specs2.execute.Result">and</a> <a href="#82476" title="org.specs2.form.Cell">cur</a>.<a href="../execute/Executable.scala.html#32432" title="=&gt; org.specs2.execute.Result">execute</a> <span class="delimiter">}</span>
  <span class="comment">/**
   * execute the row
   * @return a new Row with executed cells
   */</span>
  <span class="keyword">def</span> <a title="=&gt; org.specs2.form.Row" id="74182">executeRow</a> = <a href="#74206" title="(cellList: org.specs2.internal.scalaz.NonEmptyList[org.specs2.form.Cell])org.specs2.form.Row">Row</a><span class="delimiter">(</span><a href="#82387" title="=&gt; org.specs2.internal.scalaz.NonEmptyList[org.specs2.form.Cell]">cellList</a>.<span title="(f: org.specs2.form.Cell =&gt; org.specs2.form.Cell)org.specs2.internal.scalaz.NonEmptyList[org.specs2.form.Cell]">map</span><span class="delimiter">(</span><a href="#82393" title="org.specs2.form.Cell">_</a>.<a href="Cells.scala.html#73633" title="=&gt; org.specs2.form.Cell">executeCell</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="comment">/** @return print the row with a padding space size to use for each cell, given cell by cell */</span>
  <span class="keyword">def</span> <a title="(maxSizes: List[Int])String" id="74183">text</a><span class="delimiter">(</span><a title="List[Int]" id="87197">maxSizes</a>: <span title="List[Int]">List</span><span class="delimiter">[</span>Int<span class="delimiter">]</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="(cells: List[org.specs2.form.Cell], sizes: List[Int], result: List[String])List[String]" id="87200">pad</a><span class="delimiter">(</span><a title="List[org.specs2.form.Cell]" id="87201">cells</a>: <span title="List[org.specs2.form.Cell]">List</span><span class="delimiter">[</span>Cell<span class="delimiter">]</span>, <a title="List[Int]" id="87202">sizes</a>: <span title="List[Int]">List</span><span class="delimiter">[</span>Int<span class="delimiter">]</span>, <a title="List[String]" id="87203">result</a>: <span title="List[String]">List</span><span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="List[String]">List</span><span class="delimiter">[</span>String<span class="delimiter">]</span> = <span class="delimiter">{</span>
      <a href="#87201" title="List[org.specs2.form.Cell]">cells</a> <span title="List[String]" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <span title="List[String]">Nil</span> =&gt; <a href="#87203" title="List[String]">result</a>
        <span class="keyword">case</span> <a title="List[String]" id="87208">c</a> :: <span title="object Nil">Nil</span> =&gt; <span class="delimiter">(</span><a href="#87203" title="List[String]">result</a> <span title="(elem: String)(implicit bf: scala.collection.generic.CanBuildFrom[List[String],String,List[String]])List[String]">:+</span> <a href="#87208" title="org.specs2.form.Cell">c</a>.<a href="Cells.scala.html#73629" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">text</a>.<span title="(len: Int, elem: Char)(implicit bf: scala.collection.generic.CanBuildFrom[String,Char,String])String">padTo</span><span title="=&gt; scala.collection.generic.CanBuildFrom[String,Char,String]" class="delimiter">(</span><a href="#87202" title="List[Int]">sizes</a>.<span title="(implicit num: Numeric[Int])Int">sum</span> <span title="(x: Int)Int">+</span> <span class="delimiter">(</span><a href="#87202" title="List[Int]">sizes</a>.<span title="=&gt; Int">size</span> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span><span title="(x: Int)Int">*</span><span title="Int(3)" class="int">3</span>, <span title="Char(\' \')" class="char">' '</span><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="=&gt; List[String]">toList</span>
        <span class="keyword">case</span> <a title="List[String]" id="87424">c</a> :: <a title="List[org.specs2.form.Cell]" id="87425">rest</a> =&gt; <a href="#87202" title="List[Int]">sizes</a> <span title="List[String]" class="keyword">match</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> <span title="List[String]">Nil</span> =&gt; <span class="delimiter">(</span><a href="#87203" title="List[String]">result</a> <span title="(elem: String)(implicit bf: scala.collection.generic.CanBuildFrom[List[String],String,List[String]])List[String]">:+</span> <a href="#87424" title="org.specs2.form.Cell">c</a>.<a href="Cells.scala.html#73629" title="=&gt; String">text</a><span class="delimiter">)</span>.<span title="=&gt; List[String]">toList</span>
          <span class="keyword">case</span> <a title="List[String]" id="87465">s</a> :: <span title="object Nil">Nil</span> =&gt; <a href="#87200" title="(cells: List[org.specs2.form.Cell], sizes: List[Int], result: List[String])List[String]">pad</a><span class="delimiter">(</span><a href="#87425" title="List[org.specs2.form.Cell]">rest</a>, <span title="object Nil">Nil</span>, <span class="delimiter">(</span><a href="#87203" title="List[String]">result</a> <span title="(elem: String)(implicit bf: scala.collection.generic.CanBuildFrom[List[String],String,List[String]])List[String]">:+</span> <a href="#87424" title="org.specs2.form.Cell">c</a>.<a href="Cells.scala.html#73629" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">text</a>.<span title="(len: Int, elem: Char)(implicit bf: scala.collection.generic.CanBuildFrom[String,Char,String])String">padTo</span><span title="=&gt; scala.collection.generic.CanBuildFrom[String,Char,String]" class="delimiter">(</span><a href="#87465" title="Int">s</a>, <span title="Char(\' \')" class="char">' '</span><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="=&gt; List[String]">toList</span><span class="delimiter">)</span>
          <span class="keyword">case</span> <a title="List[String]" id="87643">s</a> :: <a title="List[Int]" id="87644">ss</a> =&gt; <a href="#87200" title="(cells: List[org.specs2.form.Cell], sizes: List[Int], result: List[String])List[String]">pad</a><span class="delimiter">(</span><a href="#87425" title="List[org.specs2.form.Cell]">rest</a>, <a href="#87644" title="List[Int]">ss</a>, <span class="delimiter">(</span><a href="#87203" title="List[String]">result</a> <span title="(elem: String)(implicit bf: scala.collection.generic.CanBuildFrom[List[String],String,List[String]])List[String]">:+</span> <a href="#87424" title="org.specs2.form.Cell">c</a>.<a href="Cells.scala.html#73629" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">text</a>.<span title="(len: Int, elem: Char)(implicit bf: scala.collection.generic.CanBuildFrom[String,Char,String])String">padTo</span><span title="=&gt; scala.collection.generic.CanBuildFrom[String,Char,String]" class="delimiter">(</span><a href="#87643" title="Int">s</a>, <span title="Char(\' \')" class="char">' '</span><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="=&gt; List[String]">toList</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
    <a href="#87200" title="(cells: List[org.specs2.form.Cell], sizes: List[Int], result: List[String])List[String]">pad</a><span class="delimiter">(</span><a href="#74178" title="=&gt; List[org.specs2.form.Cell]">cells</a>, <a href="#87197" title="List[Int]">maxSizes</a>, <span title="object Nil">Nil</span><span class="delimiter">)</span>.<span title="(start: String, sep: String, end: String)String">mkString</span><span class="delimiter">(</span><span title="java.lang.String(&quot;| &quot;)" class="string">&quot;| &quot;</span>, <span title="java.lang.String(&quot; | &quot;)" class="string">&quot; | &quot;</span>, <span title="java.lang.String(&quot; |&quot;)" class="string">&quot; |&quot;</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/** append a new Cell */</span>
  <span class="keyword">def</span> <a title="(cell: org.specs2.form.Cell)org.specs2.form.Row" id="74184">add</a><span class="delimiter">(</span><a title="org.specs2.form.Cell" id="89103">cell</a>: <a href="Cells.scala.html#9744" title="org.specs2.form.Cell">Cell</a><span class="delimiter">)</span> = <a href="#74206" title="(cellList: org.specs2.internal.scalaz.NonEmptyList[org.specs2.form.Cell])org.specs2.form.Row">copy</a><span class="delimiter">(</span>cellList = <a href="#82387" title="=&gt; org.specs2.internal.scalaz.NonEmptyList[org.specs2.form.Cell]">cellList</a> <span title="(bs: List[org.specs2.form.Cell])org.specs2.internal.scalaz.NonEmptyList[org.specs2.form.Cell]">:::&gt;</span> <span title="(xs: org.specs2.form.Cell*)List[org.specs2.form.Cell]">List</span><span class="delimiter">(</span><a href="#89103" title="org.specs2.form.Cell">cell</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(a: Any)Boolean" id="74185">equals</a><span class="delimiter">(</span><a title="Any" id="93282">a</a>: <span title="Any">Any</span><span class="delimiter">)</span> = <a href="#93282" title="Any">a</a> <span title="Boolean" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <span title="Boolean">Row</span><span class="delimiter">(</span><a title="org.specs2.internal.scalaz.NonEmptyList[org.specs2.form.Cell]" id="93302">c</a><span class="delimiter">)</span> =&gt; <a href="#74178" title="=&gt; List[org.specs2.form.Cell]">cells</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#93302" title="org.specs2.internal.scalaz.NonEmptyList[org.specs2.form.Cell]">c</a>.<span title="=&gt; List[org.specs2.form.Cell]">list</span>
    <span class="keyword">case</span> <a title="Boolean(false)" id="93308">other</a> =&gt; <span title="Boolean(false)" class="keyword">false</span>
  <span class="delimiter">}</span>
  <span class="keyword">override</span> <span class="keyword">def</span> <a title="()Int" id="74186">hashCode</a> = <a href="#74178" title="=&gt; List[org.specs2.form.Cell]">cells</a>.<span title="(f: org.specs2.form.Cell =&gt; Int)(implicit bf: scala.collection.generic.CanBuildFrom[List[org.specs2.form.Cell],Int,List[Int]])List[Int]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.List.Coll,Int,List[Int]]" class="delimiter">(</span><a href="#93331" title="org.specs2.form.Cell">_</a>.<span title="()Int">hashCode</span><span class="delimiter">)</span>.<span title="(implicit num: Numeric[Int])Int">sum</span>
<span class="delimiter">}</span>
<span class="comment">/**
 * Companion object of a Row to create a Row with at least one cell
 */</span>
case <span class="keyword">object</span> <a href="#93402" title="object org.specs2.form.Row" id="93407">Row</a> <span title="ScalaObject" class="delimiter">{</span>
  <span class="comment">/**
   * create a row from cells
   */</span>
  <span class="keyword">def</span> <a title="(c1: org.specs2.form.Cell, cs: org.specs2.form.Cell*)org.specs2.form.Row" id="74205">tr</a><span class="delimiter">(</span><a title="org.specs2.form.Cell" id="86462">c1</a>: <a href="Cells.scala.html#9744" title="org.specs2.form.Cell">Cell</a>, <a title="org.specs2.form.Cell*" id="86463">cs</a>: <span title="org.specs2.form.Cell*">Cell</span>*<span class="delimiter">)</span> = <a href="#74206" title="(cellList: org.specs2.internal.scalaz.NonEmptyList[org.specs2.form.Cell])org.specs2.form.Row">Row</a><span class="delimiter">(</span><span title="(h: org.specs2.form.Cell, t: org.specs2.form.Cell*)org.specs2.internal.scalaz.NonEmptyList[org.specs2.form.Cell]">nel</span><span class="delimiter">(</span><a href="#86462" title="org.specs2.form.Cell">c1</a>, <a href="#86463" title="org.specs2.form.Cell*">cs</a>:_*<span class="delimiter">)</span><span class="delimiter">)</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>