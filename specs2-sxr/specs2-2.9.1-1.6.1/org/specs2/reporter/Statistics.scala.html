<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>org/specs2/reporter/Statistics.scala</title>
        <script type="text/javascript" src="../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> org.specs2
<span class="keyword">package</span> reporter

<span class="keyword">import</span> org.specs2.internal.scalaz.<span class="delimiter">{</span> Scalaz, Monoid, Reducer <span class="delimiter">}</span>
<span class="keyword">import</span> <span title="object org.specs2.internal.scalaz.Scalaz">Scalaz</span>._
<span class="keyword">import</span> collection.<a href="../collection/Iterablex.scala.html#9531" title="object org.specs2.collection.Iterablex">Iterablex</a>._
<span class="keyword">import</span> main.Arguments
<span class="keyword">import</span> execute._
<span class="keyword">import</span> org.specs2.execute.StandardResults
<span class="keyword">import</span> time._
<span class="keyword">import</span> specification._
<span class="keyword">import</span> control.<a href="../control/Exceptions.scala.html#9553" title="object org.specs2.control.Exceptions">Exceptions</a>._
<span class="keyword">import</span> scala.xml.NodeSeq

<span class="comment">/**
 * This trait computes the statistics of a Specification by mapping each ExecutedFragment
 * to a Stats object
 * 
 * Some stats objects embed their corresponding ExecutedSpecStart or ExecutedSpecEnd
 * fragment to be able to determine when the total Stats corresponding to all executed
 * specifications must be displayed
 * 
 * @see Stats.isEnd
 *
 */</span>
<span class="keyword">private</span><span class="delimiter">[</span>specs2<span class="delimiter">]</span>
<span class="keyword">trait</span> <a title="trait Statistics extends java.lang.Object with ScalaObject" id="11099">Statistics</a> <span title="ScalaObject" class="delimiter">{</span>

  <span class="keyword">import</span> <a href="../specification/Stats.scala.html#11658" title="object org.specs2.specification.Stats">Stats</a>._
  <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="=&gt; java.lang.Object with org.specs2.internal.scalaz.Monoid[Statistics.this.SpecsStatistics]" id="193937">SpecsStatisticsMonoid</a>  = <a href="#199114" title="java.lang.Object with org.specs2.internal.scalaz.Monoid[Statistics.this.SpecsStatistics]{}" class="keyword">new</a> <a title="anonymous class $anon extends java.lang.Object with org.specs2.internal.scalaz.Monoid[Statistics.this.SpecsStatistics]" id="199114">Monoid</a><span class="delimiter">[</span>SpecsStatistics<span class="delimiter">]</span> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="(s1: Statistics.this.SpecsStatistics, s2: =&gt; Statistics.this.SpecsStatistics)Statistics.this.SpecsStatistics" id="199116">append</a><span class="delimiter">(</span><a title="Statistics.this.SpecsStatistics" id="199119">s1</a>: <a href="#199126" title="Statistics.this.SpecsStatistics">SpecsStatistics</a>, <a title="=&gt; Statistics.this.SpecsStatistics" id="199120">s2</a>: =&gt;SpecsStatistics<span class="delimiter">)</span>: <a href="#199126" title="Statistics.this.SpecsStatistics">SpecsStatistics</a> = <span class="delimiter">{</span>
      <a href="#199126" title="(fragments: List[org.specs2.specification.ExecutedFragment])Statistics.this.SpecsStatistics">SpecsStatistics</a><span class="delimiter">(</span><a href="#199119" title="Statistics.this.SpecsStatistics">s1</a>.<a href="#199139" title="=&gt; List[org.specs2.specification.ExecutedFragment]">fragments</a> <span title="(that: scala.collection.GenTraversableOnce[org.specs2.specification.ExecutedFragment])(implicit bf: scala.collection.generic.CanBuildFrom[List[org.specs2.specification.ExecutedFragment],org.specs2.specification.ExecutedFragment,List[org.specs2.specification.ExecutedFragment]])List[org.specs2.specification.ExecutedFragment]">++</span> <a href="#199120" title="=&gt; Statistics.this.SpecsStatistics">s2</a>.<a href="#199139" title="=&gt; List[org.specs2.specification.ExecutedFragment]">fragments</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
    <span class="keyword">val</span> <a title="Statistics.this.SpecsStatistics" id="199117">zero</a> = <a href="#199126" title="(fragments: List[org.specs2.specification.ExecutedFragment])Statistics.this.SpecsStatistics">SpecsStatistics</a><span class="delimiter">(</span><span class="delimiter">)</span> 
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(fs: Seq[org.specs2.specification.ExecutedFragment])Statistics.this.SpecsStatistics" id="193938">foldAll</a><span class="delimiter">(</span><a title="Seq[org.specs2.specification.ExecutedFragment]" id="224029">fs</a>: <span title="Seq[org.specs2.specification.ExecutedFragment]">Seq</span><span class="delimiter">[</span>ExecutedFragment<span class="delimiter">]</span><span class="delimiter">)</span> = <a href="#224029" title="(l: Seq[org.specs2.specification.ExecutedFragment])org.specs2.internal.scalaz.MA[Seq,org.specs2.specification.ExecutedFragment]">fs</a>.<span title="(f: org.specs2.specification.ExecutedFragment =&gt; Statistics.this.SpecsStatistics)(implicit r: org.specs2.internal.scalaz.Foldable[Seq], implicit m: org.specs2.internal.scalaz.Monoid[Statistics.this.SpecsStatistics])Statistics.this.SpecsStatistics">foldMap</span><a href="#193937" title="org.specs2.internal.scalaz.Foldable[Seq]" class="delimiter">(</a><a href="#193939" title="object Statistics.this.StatisticsReducer">StatisticsReducer</a>.<a href="#225144" title="(f: org.specs2.specification.ExecutedFragment)Statistics.this.SpecsStatistics">unit</a><span class="delimiter">)</span>
  
  <span class="keyword">object</span> <a title="object Statistics.this.StatisticsReducer" id="193939">StatisticsReducer</a> <a href="#193937" title="ScalaObject" class="keyword">extends</a> <span title="org.specs2.internal.scalaz.Reducer[org.specs2.specification.ExecutedFragment,Statistics.this.SpecsStatistics]">Reducer</span><span class="delimiter">[</span>ExecutedFragment, SpecsStatistics<span class="delimiter">]</span> <span class="delimiter">{</span>
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="(f: org.specs2.specification.ExecutedFragment)Statistics.this.SpecsStatistics" id="225144">unit</a><span class="delimiter">(</span><a title="org.specs2.specification.ExecutedFragment" id="225145">f</a>: <a href="../specification/ExecutedFragment.scala.html#11396" title="org.specs2.specification.ExecutedFragment">ExecutedFragment</a><span class="delimiter">)</span>: <a href="#199126" title="Statistics.this.SpecsStatistics">SpecsStatistics</a> = <a href="#199125" title="(current: org.specs2.specification.ExecutedFragment)Statistics.this.SpecsStatistics">SpecsStatistics</a><span class="delimiter">(</span><a href="#225145" title="org.specs2.specification.ExecutedFragment">f</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * The SpecsStatistics class stores the result of a specification execution, with the
   * a list of 'current' stats for each fragment execution and the total statistics 
   * for the whole specification
   */</span>
  case <span class="keyword">class</span> <a title="class SpecsStatistics extends java.lang.Object with ScalaObject with Product with Serializable" id="199126">SpecsStatistics</a><a href="#199126" title="ScalaObject" class="delimiter">(</a><a title="List[org.specs2.specification.ExecutedFragment]" id="199139">fragments</a>: <span title="List[org.specs2.specification.ExecutedFragment]">List</span><span class="delimiter">[</span>ExecutedFragment<span class="delimiter">]</span> = <span title="object Nil">Nil</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">private</span> <span class="keyword">implicit</span> <span class="keyword">val</span> <a title="org.specs2.specification.Stats.StatsMonoid.type" id="199131">statsMonoid</a> = <a href="../specification/Stats.scala.html#11658" title="object org.specs2.specification.Stats">Stats</a>.<a href="../specification/Stats.scala.html#194554" title="object org.specs2.specification.Stats.StatsMonoid">StatsMonoid</a>
    
    <span class="comment">/** @return the list of all current stats, with the total on each line */</span>
    <span class="keyword">def</span> <a title="=&gt; List[org.specs2.specification.Stats]" id="199133">totals</a>: <span title="List[org.specs2.specification.Stats]">List</span><span class="delimiter">[</span>Stats<span class="delimiter">]</span> = <span class="delimiter">{</span>
      <span class="keyword">import</span> <a href="NestedBlocks.scala.html#10974" title="object org.specs2.reporter.NestedBlocks">NestedBlocks</a>._

      <span class="keyword">def</span> <a title="(f: org.specs2.specification.ExecutedFragment)Product with Serializable with org.specs2.reporter.NestedBlocks.SpecBlock[org.specs2.specification.Stats]" id="225205">toBlock</a><span class="delimiter">(</span><a title="org.specs2.specification.ExecutedFragment" id="225206">f</a>: <a href="../specification/ExecutedFragment.scala.html#11396" title="org.specs2.specification.ExecutedFragment">ExecutedFragment</a><span class="delimiter">)</span> = <a href="#225206" title="org.specs2.specification.ExecutedFragment">f</a> <span title="&lt;none&gt; extends Product with Serializable with org.specs2.reporter.NestedBlocks.SpecBlock[org.specs2.specification.Stats]" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <span title="org.specs2.reporter.NestedBlocks.BlockStart[org.specs2.specification.Stats]">ExecutedSpecStart</span><span class="delimiter">(</span>_,_,<a title="org.specs2.specification.Stats" id="225207">s</a><span class="delimiter">)</span>  =&gt; <a href="NestedBlocks.scala.html#204180" title="(value: org.specs2.specification.Stats)org.specs2.reporter.NestedBlocks.BlockStart[org.specs2.specification.Stats]">BlockStart</a><span class="delimiter">(</span><a href="#225207" title="org.specs2.specification.Stats">s</a><span class="delimiter">)</span>
        <span class="keyword">case</span> <span title="org.specs2.reporter.NestedBlocks.BlockEnd[org.specs2.specification.Stats]">ExecutedSpecEnd</span><span class="delimiter">(</span>_,_,<a title="org.specs2.specification.Stats" id="225211">s</a><span class="delimiter">)</span>    =&gt; <a href="NestedBlocks.scala.html#204376" title="(value: org.specs2.specification.Stats)org.specs2.reporter.NestedBlocks.BlockEnd[org.specs2.specification.Stats]">BlockEnd</a><span class="delimiter">(</span><a href="#225211" title="org.specs2.specification.Stats">s</a><span class="delimiter">)</span>
        <span class="keyword">case</span> <a title="org.specs2.reporter.NestedBlocks.BlockBit[org.specs2.specification.Stats]" id="225215">other</a>                     =&gt; <a href="NestedBlocks.scala.html#204564" title="(value: org.specs2.specification.Stats)org.specs2.reporter.NestedBlocks.BlockBit[org.specs2.specification.Stats]">BlockBit</a><span class="delimiter">(</span><a href="#225206" title="org.specs2.specification.ExecutedFragment">f</a>.<a href="../specification/ExecutedFragment.scala.html#194440" title="=&gt; org.specs2.specification.Stats">stats</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
      <a href="NestedBlocks.scala.html#204124" title="(blocks: Seq[org.specs2.reporter.NestedBlocks.SpecBlock[org.specs2.specification.Stats]])(implicit evidence$3: org.specs2.internal.scalaz.Monoid[org.specs2.specification.Stats])Seq[org.specs2.specification.Stats]">totalContext</a><a href="#199131" title="=&gt; org.specs2.specification.Stats.StatsMonoid.type" class="delimiter">(</a><a href="#199139" title="=&gt; List[org.specs2.specification.ExecutedFragment]">fragments</a>.<span title="(f: org.specs2.specification.ExecutedFragment =&gt; Product with Serializable with org.specs2.reporter.NestedBlocks.SpecBlock[org.specs2.specification.Stats])(implicit bf: scala.collection.generic.CanBuildFrom[List[org.specs2.specification.ExecutedFragment],Product with Serializable with org.specs2.reporter.NestedBlocks.SpecBlock[org.specs2.specification.Stats],List[Product with Serializable with org.specs2.reporter.NestedBlocks.SpecBlock[org.specs2.specification.Stats]]])List[Product with Serializable with org.specs2.reporter.NestedBlocks.SpecBlock[org.specs2.specification.Stats]]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.List.Coll,Product with Serializable with org.specs2.reporter.NestedBlocks.SpecBlock[org.specs2.specification.Stats],List[Product with Serializable with org.specs2.reporter.NestedBlocks.SpecBlock[org.specs2.specification.Stats]]]" class="delimiter">(</span><a href="#225205" title="(f: org.specs2.specification.ExecutedFragment)Product with Serializable with org.specs2.reporter.NestedBlocks.SpecBlock[org.specs2.specification.Stats]">toBlock</a><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="=&gt; List[org.specs2.specification.Stats]">toList</span>
    <span class="delimiter">}</span>
    <span class="keyword">def</span> <a title="=&gt; org.specs2.specification.Stats" id="199134">total</a> = <a href="#199133" title="=&gt; List[org.specs2.specification.Stats]">totals</a>.<span title="=&gt; Option[org.specs2.specification.Stats]">lastOption</span>.<span title="(default: =&gt; org.specs2.specification.Stats)org.specs2.specification.Stats">getOrElse</span><span class="delimiter">(</span><a href="../specification/Stats.scala.html#194558" title="(examples: Int, successes: Int, expectations: Int, failures: Int, errors: Int, pending: Int, skipped: Int, trend: Option[org.specs2.specification.Stats], timer: org.specs2.time.SimpleTimer)org.specs2.specification.Stats">Stats</a><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>
  case <span class="keyword">object</span> <a href="#225446" title="object Statistics.this.SpecsStatistics" id="225449">SpecsStatistics</a> <span title="ScalaObject" class="delimiter">{</span>
    <span class="keyword">def</span> <a title="(current: org.specs2.specification.ExecutedFragment)Statistics.this.SpecsStatistics" id="199125">apply</a><span class="delimiter">(</span><a title="org.specs2.specification.ExecutedFragment" id="199142">current</a>: <a href="../specification/ExecutedFragment.scala.html#11396" title="org.specs2.specification.ExecutedFragment">ExecutedFragment</a><span class="delimiter">)</span> = <span title="Statistics.this.SpecsStatistics" class="keyword">new</span> <a href="#199126" title="Statistics.this.SpecsStatistics">SpecsStatistics</a><span class="delimiter">(</span><span title="(xs: org.specs2.specification.ExecutedFragment*)List[org.specs2.specification.ExecutedFragment]">List</span><span class="delimiter">(</span><a href="#199142" title="org.specs2.specification.ExecutedFragment">current</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * The SpecsStats class just stores a list of stats, each one corresponding to a Fragment
   */</span>
  case <span class="keyword">class</span> <a title="class SpecStats extends java.lang.Object with ScalaObject with Product with Serializable" id="199045">SpecStats</a><a href="#199045" title="ScalaObject" class="delimiter">(</a><a title="List[org.specs2.specification.Stats]" id="199052">stats</a>: <span title="List[org.specs2.specification.Stats]">List</span><span class="delimiter">[</span>Stats<span class="delimiter">]</span> = <span title="object Nil">Nil</span><span class="delimiter">)</span>
  <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="=&gt; java.lang.Object with org.specs2.internal.scalaz.Monoid[Statistics.this.SpecStats]" id="193947">SpecStatsMonoid</a>  = <a href="#199033" title="java.lang.Object with org.specs2.internal.scalaz.Monoid[Statistics.this.SpecStats]{}" class="keyword">new</a> <a title="anonymous class $anon extends java.lang.Object with org.specs2.internal.scalaz.Monoid[Statistics.this.SpecStats]" id="199033">Monoid</a><span class="delimiter">[</span>SpecStats<span class="delimiter">]</span> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="(s1: Statistics.this.SpecStats, s2: =&gt; Statistics.this.SpecStats)Statistics.this.SpecStats" id="199035">append</a><span class="delimiter">(</span><a title="Statistics.this.SpecStats" id="199038">s1</a>: <a href="#199045" title="Statistics.this.SpecStats">SpecStats</a>, <a title="=&gt; Statistics.this.SpecStats" id="199039">s2</a>: =&gt;SpecStats<span class="delimiter">)</span>: <a href="#199045" title="Statistics.this.SpecStats">SpecStats</a> = <span class="delimiter">{</span>
      <a href="#199045" title="(stats: List[org.specs2.specification.Stats])Statistics.this.SpecStats">SpecStats</a><span class="delimiter">(</span><a href="#199038" title="Statistics.this.SpecStats">s1</a>.<a href="#199052" title="=&gt; List[org.specs2.specification.Stats]">stats</a> <span title="(that: scala.collection.GenTraversableOnce[org.specs2.specification.Stats])(implicit bf: scala.collection.generic.CanBuildFrom[List[org.specs2.specification.Stats],org.specs2.specification.Stats,List[org.specs2.specification.Stats]])List[org.specs2.specification.Stats]">++</span> <a href="#199039" title="=&gt; Statistics.this.SpecStats">s2</a>.<a href="#199052" title="=&gt; List[org.specs2.specification.Stats]">stats</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
    <span class="keyword">val</span> <a title="Statistics.this.SpecStats" id="199036">zero</a> = <a href="#199045" title="(stats: List[org.specs2.specification.Stats])Statistics.this.SpecStats">SpecStats</a><span class="delimiter">(</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">object</span> <a title="object Statistics.this.StatsReducer" id="193948">StatsReducer</a> <a href="#193947" title="ScalaObject" class="keyword">extends</a> <span title="org.specs2.internal.scalaz.Reducer[org.specs2.specification.ExecutedFragment,Statistics.this.SpecStats]">Reducer</span><span class="delimiter">[</span>ExecutedFragment, SpecStats<span class="delimiter">]</span> <span class="delimiter">{</span>
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="(f: org.specs2.specification.ExecutedFragment)Statistics.this.SpecStats" id="203561">unit</a><span class="delimiter">(</span><a title="org.specs2.specification.ExecutedFragment" id="225497">f</a>: <a href="../specification/ExecutedFragment.scala.html#11396" title="org.specs2.specification.ExecutedFragment">ExecutedFragment</a><span class="delimiter">)</span>: <a href="#199045" title="Statistics.this.SpecStats">SpecStats</a> = <a href="#199045" title="(stats: List[org.specs2.specification.Stats])Statistics.this.SpecStats">SpecStats</a><span class="delimiter">(</span><span title="(xs: org.specs2.specification.Stats*)List[org.specs2.specification.Stats]">List</span><span class="delimiter">(</span><a href="#225497" title="org.specs2.specification.ExecutedFragment">f</a>.<a href="../specification/ExecutedFragment.scala.html#194440" title="=&gt; org.specs2.specification.Stats">stats</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

<span class="delimiter">}</span>
<span class="keyword">private</span> <span class="delimiter">[</span>specs2<span class="delimiter">]</span>
<span class="keyword">object</span> <a title="object org.specs2.reporter.Statistics" id="11100">Statistics</a> <span title="ScalaObject" class="keyword">extends</span> <a href="#11099" title="org.specs2.reporter.Statistics">Statistics</a>

        </pre>
    </body>
</html>