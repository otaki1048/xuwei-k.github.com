<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>org/specs2/matcher/Expectable.scala</title>
        <script type="text/javascript" src="../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> org.specs2
<span class="keyword">package</span> matcher

<span class="keyword">import</span> org.specs2.internal.scalaz._
<span class="keyword">import</span> reflect.<a href="../reflect/Anyx.scala.html#10724" title="object org.specs2.reflect.Anyx">Anyx</a>._
<span class="keyword">import</span> execute._
<span class="keyword">import</span> text.<a href="../text/Quote.scala.html#11762" title="object org.specs2.text.Quote">Quote</a>._
<span class="keyword">import</span> text.<a href="../text/NullString.scala.html#11749" title="object org.specs2.text.NotNullStrings">NotNullStrings</a>._
<span class="keyword">import</span> <a href="#10186" title="object org.specs2.matcher.Expectable">Expectable</a>._
<span class="comment">/**
 * The Expectable class models anything which can be checked by applying a Matcher
 * 
 * It stores a value which is only evaluated when necessary and an optional additional description for that value.
 * 
 * The Expectable object is responsible for creating its own description, based on the value toString method and
 * and an additional description.
 *
 */</span>
<span class="keyword">class</span> <a title="class Expectable[+T] extends java.lang.Object with ScalaObject" id="10184">Expectable</a><span class="delimiter">[</span>+<a title="&gt;: Nothing &lt;: Any" id="10185">T</a><span class="delimiter">]</span> <a href="#10184" title="ScalaObject" class="keyword">private</a><span class="delimiter">[</span>specs2<span class="delimiter">]</span> <span class="delimiter">(</span><a title="() =&gt; T" id="88500">t</a>: <span class="delimiter">(</span><span class="delimiter">)</span> =&gt; T<span class="delimiter">)</span> <span class="delimiter">{</span> outer =&gt;
  <span class="comment">/** the value is only evaluated if necessary */</span>
  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="T" id="55663">value</a> = <a href="#88500" title="()T">t</a><span class="delimiter">(</span><span class="delimiter">)</span>
  
  <span class="comment">/**
   * optional additional description: it is a function which takes value.toString and returns a String
   */</span>
  <span class="keyword">private</span><span class="delimiter">[</span>specs2<span class="delimiter">]</span> <span class="keyword">val</span> <a title="Option[String =&gt; String]" id="55664">desc</a>: <span title="Option[String =&gt; String]">Option</span><span class="delimiter">[</span>String =&gt; String<span class="delimiter">]</span> = <span title="object None">None</span>
  <span class="comment">/** @return a description of the value */</span>
  <span class="keyword">def</span> <a title="=&gt; java.lang.String" id="55666">description</a> = <a href="#55672" title="(value: =&gt; T)java.lang.String">d</a><span class="delimiter">(</span><a href="#55662" title="=&gt; T">value</a><span class="delimiter">)</span>
  <span class="comment">/** @return the optional description function */</span>
  <span class="keyword">def</span> <a title="=&gt; Option[String =&gt; String]" id="55667">optionalDescription</a>: <span title="Option[String =&gt; String]">Option</span><span class="delimiter">[</span>String =&gt; String<span class="delimiter">]</span> = <a href="#55664" title="=&gt; Option[String =&gt; String]">desc</a>

  <span class="comment">/**
   * apply a matcher on the value and return a MatchResult which can later on be transformed to a simple Result
   */</span>
  <span class="keyword">def</span> <a title="[S &gt;: T](m: =&gt; org.specs2.matcher.Matcher[S])org.specs2.matcher.MatchResult[S]" id="55668">applyMatcher</a><span class="delimiter">[</span><a title="&gt;: T &lt;: Any" id="55670">S</a> &gt;: T<span class="delimiter">]</span><span class="delimiter">(</span><a title="=&gt; org.specs2.matcher.Matcher[S]" id="55755">m</a>: =&gt;Matcher<span class="delimiter">[</span>S<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="MatchResult.scala.html#10266" title="org.specs2.matcher.MatchResult[S]">MatchResult</a><span class="delimiter">[</span>S<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#55755" title="=&gt; org.specs2.matcher.Matcher[S]">m</a> <span title="(x$1: AnyRef)Boolean">==</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <span title="Nothing" class="keyword">throw</span> <span title="(x$1: java.lang.String)java.lang.IllegalArgumentException" class="keyword">new</span> <span title="java.lang.IllegalArgumentException">IllegalArgumentException</span><span class="delimiter">(</span><span title="java.lang.String(&quot;You cannot use a null matcher on &quot;)" class="string">&quot;You cannot use a null matcher on &quot;</span><span title="(x$1: Any)java.lang.String">+</span><a href="#55666" title="=&gt; java.lang.String">description</a><span class="delimiter">)</span>
    <a href="#55755" title="=&gt; org.specs2.matcher.Matcher[S]">m</a>.<a href="Matcher.scala.html#50821" title="(t: org.specs2.matcher.Expectable[T])org.specs2.matcher.MatchResult[T]">apply</a><span class="delimiter">(</span><a href="#10184" title="org.specs2.matcher.Expectable[T]" class="keyword">this</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/** evaluate the value once and return the same expectable */</span>
  <span class="keyword">protected</span><span class="delimiter">[</span>specs2<span class="delimiter">]</span> <span class="keyword">def</span> <a title="=&gt; org.specs2.matcher.Expectable[T]" id="55671">evaluate</a> = <a href="#50696" title="(t: =&gt; T, d1: Option[String =&gt; String])org.specs2.matcher.Expectable[T]">Expectable</a><span class="delimiter">(</span><a href="#88500" title="()T">t</a><span class="delimiter">(</span><span class="delimiter">)</span>, <a href="#55664" title="=&gt; Option[String =&gt; String]">desc</a><span class="delimiter">)</span>

  <span class="comment">/** @return the description of the matched value, quoted. */</span>
  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="[T](value: =&gt; T)java.lang.String" id="55672">d</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="55674">T</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="=&gt; T" id="116447">value</a>: =&gt;T<span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="String" id="116450">valueAsString</a> = <a href="#116447" title="=&gt; T">value</a> <span title="String" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <a title="String" id="116451">ar</a>: <span title="Array[_]">Array</span><span class="delimiter">[</span>_<span class="delimiter">]</span>           =&gt; <a href="../text/NullString.scala.html#55620" title="(a: Array[_])ScalaObject with org.specs2.text.NotNullStrings.NotNullMkString">ar</a>.<a href="../text/NullString.scala.html#58269" title="(sep: String)String">notNullMkString</a><span class="delimiter">(</span><span title="java.lang.String(&quot;, &quot;)" class="string">&quot;, &quot;</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <a title="String" id="116468">it</a>: <span title="TraversableOnce[_]">TraversableOnce</span><span class="delimiter">[</span>_<span class="delimiter">]</span> =&gt; <a href="../text/NullString.scala.html#55624" title="(a: =&gt; TraversableOnce[_])org.specs2.text.NotNullStrings.NotNullTraversableOnce[_]">it</a>.<a href="../text/NullString.scala.html#58273" title="(sep: String)String">notNullMkString</a><span class="delimiter">(</span><span title="java.lang.String(&quot;, &quot;)" class="string">&quot;, &quot;</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="String">_</span>                      =&gt; <a href="../text/NullString.scala.html#55617" title="implicit org.specs2.text.NotNullStrings.anyToNotNull : (a: Any)org.specs2.text.NotNullStrings.NotNullAny">value</a>.<a href="../text/NullString.scala.html#58300" title="=&gt; String">notNull</a>
    <span class="delimiter">}</span>
    <a href="#55664" title="=&gt; Option[String =&gt; String]">desc</a> <span title="java.lang.String" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <span title="java.lang.String">None</span> =&gt; <a href="#116447" title="=&gt; T">value</a> <span title="java.lang.String" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <a title="java.lang.String(&quot;the value&quot;)" id="116493">b</a>: <span title="Boolean">Boolean</span>   =&gt; <span title="java.lang.String(&quot;the value&quot;)" class="string">&quot;the value&quot;</span>
        <span class="keyword">case</span> <span title="java.lang.String">_</span>            =&gt; <a href="../text/Quote.scala.html#50793" title="(a: Any)java.lang.String">q</a><span class="delimiter">(</span><a href="#116450" title="String">valueAsString</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
      <span class="keyword">case</span> <span title="String">Some</span><span class="delimiter">(</span><a title="String =&gt; String" id="116495">de</a><span class="delimiter">)</span> =&gt; <a href="#116495" title="(v1: String)String">de</a><span class="delimiter">(</span><a href="#116450" title="String">valueAsString</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
  <span class="comment">/** @return the description of the matched value, unquoted. */</span>
  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="[T](value: T)String" id="55675">dUnquoted</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="55677">T</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="T" id="131917">value</a>: <a href="#55677" title="T">T</a><span class="delimiter">)</span> = <a href="#55664" title="=&gt; Option[String =&gt; String]">desc</a> <span title="String" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <span title="String">None</span> =&gt; <a href="../text/Quote.scala.html#50794" title="(a: Any)String">unq</a><span class="delimiter">(</span><a href="#131917" title="T">value</a><span class="delimiter">)</span>
    <span class="keyword">case</span> <span title="String">Some</span><span class="delimiter">(</span><a title="String =&gt; String" id="131926">de</a><span class="delimiter">)</span> =&gt; <a href="#131926" title="(v1: String)String">de</a><span class="delimiter">(</span><a href="../text/Quote.scala.html#50794" title="(a: Any)String">unq</a><span class="delimiter">(</span><a href="#131917" title="T">value</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="[S](f: T =&gt; S)org.specs2.matcher.Expectable[S]" id="55678">map</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="55680">S</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="T =&gt; S" id="113085">f</a>: T =&gt; S<span class="delimiter">)</span>: <a href="#10184" title="org.specs2.matcher.Expectable[S]">Expectable</a><span class="delimiter">[</span>S<span class="delimiter">]</span> = <a href="#50696" title="(t: =&gt; S, d1: Option[String =&gt; String])org.specs2.matcher.Expectable[S]">Expectable</a><span class="delimiter">(</span><a href="#113085" title="(v1: T)S">f</a><span class="delimiter">(</span><a href="#55662" title="=&gt; T">value</a><span class="delimiter">)</span>, <a href="#55664" title="=&gt; Option[String =&gt; String]">desc</a><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="[S](other: S)org.specs2.matcher.Expectable[S]" id="55681">map</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="55683">S</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="S" id="113080">other</a>: <a href="#55683" title="S">S</a><span class="delimiter">)</span>: <a href="#10184" title="org.specs2.matcher.Expectable[S]">Expectable</a><span class="delimiter">[</span>S<span class="delimiter">]</span> = <a href="#55678" title="(f: T =&gt; S)org.specs2.matcher.Expectable[S]">map</a><span class="delimiter">(</span><a title="T" id="131970">t</a> =&gt; <a href="#113080" title="S">other</a><span class="delimiter">)</span>
<span class="delimiter">}</span>

<span class="comment">/**
 * Factory methods for creating Expectables
 */</span>
<span class="keyword">object</span> <a title="object org.specs2.matcher.Expectable" id="10186">Expectable</a> <span title="ScalaObject" class="delimiter">{</span>
  <span class="comment">/** @return an Expectable with t as a value */</span>
  <span class="keyword">private</span><span class="delimiter">[</span>specs2<span class="delimiter">]</span> <span class="keyword">def</span> <a title="[T](t: =&gt; T)org.specs2.matcher.Expectable[T]" id="50689">apply</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="50691">T</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="=&gt; T" id="88565">t</a>: =&gt;T<span class="delimiter">)</span> = <span title="org.specs2.matcher.Expectable[T]" class="keyword">new</span> <a href="#10184" title="org.specs2.matcher.Expectable[T]">Expectable</a><span class="delimiter">(</span><span class="delimiter">(</span><span class="delimiter">)</span> =&gt; <a href="#88565" title="=&gt; T">t</a><span class="delimiter">)</span>
  <span class="comment">/** @return an Expectable with t as a value, and a constant string for its description */</span>
  <span class="keyword">private</span><span class="delimiter">[</span>specs2<span class="delimiter">]</span> <span class="keyword">def</span> <a title="[T](t: =&gt; T, d1: String)org.specs2.matcher.Expectable[T]" id="50692">apply</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="50694">T</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="=&gt; T" id="88522">t</a>: =&gt;T, <a title="String" id="88523">d1</a>: <span title="String">String</span><span class="delimiter">)</span> = <a href="#88526" title="org.specs2.matcher.Expectable[T]{}" class="keyword">new</a> <a title="anonymous class $anon extends org.specs2.matcher.Expectable[T]" id="88526">Expectable</a><span class="delimiter">(</span><span class="delimiter">(</span><span class="delimiter">)</span> =&gt; <a href="#88522" title="=&gt; T">t</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">override</span> <span class="keyword">val</span> <a title="Option[String =&gt; String]" id="88532">desc</a>: <span title="Option[String =&gt; String]">Option</span><span class="delimiter">[</span>String =&gt; String<span class="delimiter">]</span> = <span title="(x: String =&gt; java.lang.String)Some[String =&gt; java.lang.String]">Some</span><span class="delimiter">(</span><a href="#50695" title="(d1: String)String =&gt; java.lang.String">aliasDisplay</a><span class="delimiter">(</span><a href="#88523" title="String">d1</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>
  <span class="keyword">private</span><span class="delimiter">[</span>specs2<span class="delimiter">]</span> <span class="keyword">def</span> <a title="(d1: String)String =&gt; java.lang.String" id="50695">aliasDisplay</a><span class="delimiter">(</span><a title="String" id="88544">d1</a>: <span title="String">String</span><span class="delimiter">)</span> = <span class="delimiter">(</span>s: <span title="String">String</span><span class="delimiter">)</span> =&gt; <a href="#88544" title="String">d1</a> <span title="(x$1: Any)java.lang.String">+</span> <span class="delimiter">(</span><span title="Any" class="keyword">if</span> <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#88548" title="String">s</a>.<span title="()Boolean">isEmpty</span> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <span title="=&gt; Boolean">!</span><span title="(elems: java.lang.String*)Seq[java.lang.String]">Seq</span><span class="delimiter">(</span><span title="java.lang.String(&quot;true&quot;)" class="string">&quot;true&quot;</span>, <span title="java.lang.String(&quot;false&quot;)" class="string">&quot;false&quot;</span><span class="delimiter">)</span>.<span title="(elem: Any)Boolean">contains</span><span class="delimiter">(</span><a href="#88548" title="String">s</a><span class="delimiter">)</span><span class="delimiter">)</span> <span title="java.lang.String(&quot; &quot;)" class="string">&quot; &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="../text/Quote.scala.html#50793" title="(a: Any)java.lang.String">q</a><span class="delimiter">(</span><a href="#88548" title="String">s</a><span class="delimiter">)</span> <span class="keyword">else</span> <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span>
  <span class="comment">/** @return an Expectable with t as a value, and a description function */</span>
  <span class="keyword">private</span><span class="delimiter">[</span>specs2<span class="delimiter">]</span> <span class="keyword">def</span> <a title="[T](t: =&gt; T, d1: Option[String =&gt; String])org.specs2.matcher.Expectable[T]" id="50696">apply</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="50698">T</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="=&gt; T" id="88494">t</a>: =&gt;T, <a title="Option[String =&gt; String]" id="88495">d1</a>: <span title="Option[String =&gt; String]">Option</span><span class="delimiter">[</span>String =&gt; String<span class="delimiter">]</span><span class="delimiter">)</span> = <a href="#88498" title="org.specs2.matcher.Expectable[T]{}" class="keyword">new</a> <a title="anonymous class $anon extends org.specs2.matcher.Expectable[T]" id="88498">Expectable</a><span class="delimiter">(</span><span class="delimiter">(</span><span class="delimiter">)</span> =&gt; <a href="#88494" title="=&gt; T">t</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">override</span> <span class="keyword">val</span> <a title="Option[String =&gt; String]" id="88505">desc</a>: <span title="Option[String =&gt; String]">Option</span><span class="delimiter">[</span>String =&gt; String<span class="delimiter">]</span> = <a href="#88495" title="Option[String =&gt; String]">d1</a>
  <span class="delimiter">}</span>
  
  <span class="comment">/** Expectable is a Functor and can use the fmap function to modify its value */</span>
  <span class="keyword">implicit</span> <span class="keyword">val</span> <a title="org.specs2.internal.scalaz.Functor[org.specs2.matcher.Expectable]" id="50699">ExpectableFunctor</a>: <span title="org.specs2.internal.scalaz.Functor[org.specs2.matcher.Expectable]">Functor</span><span class="delimiter">[</span>Expectable<span class="delimiter">]</span> = <a href="#131974" title="java.lang.Object with org.specs2.internal.scalaz.Functor[org.specs2.matcher.Expectable]" class="keyword">new</a> <a title="anonymous class $anon extends java.lang.Object with org.specs2.internal.scalaz.Functor[org.specs2.matcher.Expectable]" id="131974">Functor</a><span class="delimiter">[</span>Expectable<span class="delimiter">]</span> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="[A, B](r: org.specs2.matcher.Expectable[A], f: A =&gt; B)org.specs2.matcher.Expectable[B]" id="131987">fmap</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="131990">A</a>, <a title="&gt;: Nothing &lt;: Any" id="131991">B</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="org.specs2.matcher.Expectable[A]" id="131992">r</a>: <a href="#10184" title="org.specs2.matcher.Expectable[A]">Expectable</a><span class="delimiter">[</span>A<span class="delimiter">]</span>, <a title="A =&gt; B" id="131993">f</a>: A =&gt; B<span class="delimiter">)</span> = <a href="#131992" title="org.specs2.matcher.Expectable[A]">r</a>.<a href="#55678" title="(f: A =&gt; B)org.specs2.matcher.Expectable[B]">map</a><span class="delimiter">(</span><a href="#131993" title="A =&gt; B">f</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

<span class="delimiter">}</span>

        </pre>
    </body>
</html>