<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>org/specs2/specification/RegexStep.scala</title>
        <script type="text/javascript" src="../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> org.specs2
<span class="keyword">package</span> specification

<span class="keyword">import</span> control.<a href="../control/Exceptions.scala.html#9553" title="object org.specs2.control.Exceptions">Exceptions</a>._
<span class="keyword">import</span> execute._
<span class="keyword">import</span> util.matching.Regex
<span class="keyword">import</span> execute.<a href="../execute/Result.scala.html#9683" title="object org.specs2.execute.Error">Error</a>._

<span class="comment">/**
 * A Regular expression step which takes a text and extracts meaningful values according to
 * a regular expression:
 *
 * - either a user-defined expression
 * - or if the used-defined expression is empty, a default regex where values to capture are delimited with `${}`
 *
 * It provides methods to extract either all the groups as a list, or a number of values as a tuple
 *
 */</span>
<span class="keyword">abstract</span> <span class="keyword">class</span> <a title="class RegexStep[P, T] extends java.lang.Object with ScalaObject" id="11566">RegexStep</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="243883">P</a>, <a title="&gt;: Nothing &lt;: Any" id="243884">T</a><span class="delimiter">]</span><a href="#11566" title="ScalaObject" class="delimiter">(</a><a title="String" id="243880">regex</a>: <span title="String">String</span> = <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span>, <a title="String" id="243885">defaultRegex</a>: <span title="String">String</span> = <a href="#11569" title="object org.specs2.specification.RegexStep">RegexStep</a>.<a href="#240258" title="=&gt; java.lang.String">DEFAULT_REGEX</a><span class="delimiter">)</span> <span class="delimiter">{</span>

  <span class="comment">/** @return the regex that must be used */</span>
  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="=&gt; String" id="59351">regexToUse</a> = <span title="String" class="keyword">if</span> <span class="delimiter">(</span><a href="#243880" title="String">regex</a>.<span title="()Boolean">isEmpty</span><span class="delimiter">)</span> <a href="#243885" title="String">defaultRegex</a> <span class="keyword">else</span> <a href="#243880" title="String">regex</a>
  <span class="comment">/** extract all groups and return a list of strings */</span>
  <span class="keyword">def</span> <a title="(text: String)List[String]" id="59352">extractAll</a><span class="delimiter">(</span><a title="String" id="243893">text</a>: <span title="String">String</span><span class="delimiter">)</span> =
    <span title="List[String]" class="keyword">if</span> <span class="delimiter">(</span><a href="#243880" title="String">regex</a>.<span title="()Boolean">isEmpty</span><span class="delimiter">)</span> <a href="#243885" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">defaultRegex</a>.<span title="=&gt; scala.util.matching.Regex">r</span>.<span title="(source: java.lang.CharSequence)scala.util.matching.Regex.MatchIterator">findAllIn</span><span class="delimiter">(</span><a href="#243893" title="String">text</a><span class="delimiter">)</span>.<span title="=&gt; java.lang.Object with Iterator[scala.util.matching.Regex.Match]">matchData</span>.<span title="(pf: PartialFunction[scala.util.matching.Regex.Match,String])Iterator[String]">collect</span> <a href="#243906" title="String" class="delimiter">{</a> <span class="keyword">case</span> <span title="String">Regex</span>.<a href="#243908" title="(m: scala.util.matching.Regex.Match)Option[Seq[String]]">Groups</a><span class="delimiter">(</span><a title="String" id="243910">g</a><span class="delimiter">)</span> =&gt; <a href="#243910" title="String">g</a> <span class="delimiter">}</span>.<span title="=&gt; List[String]">toList</span>
    <span class="keyword">else</span>               <a href="#243880" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">regex</a>.<span title="=&gt; scala.util.matching.Regex">r</span>.<span title="(target: Any)Option[List[String]]">unapplySeq</span><span class="delimiter">(</span><a href="#243893" title="String">text</a><span class="delimiter">)</span>.<span title="=&gt; List[String]">get</span>

  <span class="comment">/** remove value markers `${}` from the text */</span>
  <span class="keyword">def</span> <a title="(text: String)String" id="59353">strip</a><span class="delimiter">(</span><a title="String" id="243455">text</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="String">String</span> =
    <span title="String" class="keyword">if</span> <span class="delimiter">(</span><a href="#243880" title="String">regex</a>.<span title="()Boolean">isEmpty</span><span class="delimiter">)</span> <a href="#11569" title="object org.specs2.specification.RegexStep">RegexStep</a>.<a href="#240260" title="(text: String, regex: String)String">strip</a><span class="delimiter">(</span><a href="#243455" title="String">text</a>, <a href="#243885" title="String">defaultRegex</a><span class="delimiter">)</span>
    <span class="keyword">else</span>               <a href="#243455" title="String">text</a>

  <span class="comment">/** remove value markers `${}` from a Text fragment */</span>
  <span class="keyword">def</span> <a title="(f: org.specs2.specification.Fragment)org.specs2.specification.Fragment" id="59354">strip</a><span class="delimiter">(</span><a title="org.specs2.specification.Fragment" id="243453">f</a>: <a href="Fragment.scala.html#11467" title="org.specs2.specification.Fragment">Fragment</a><span class="delimiter">)</span>: <a href="Fragment.scala.html#11467" title="org.specs2.specification.Fragment">Fragment</a> =
    <a href="#243453" title="org.specs2.specification.Fragment">f</a> <span title="org.specs2.specification.Fragment" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <span title="org.specs2.specification.Text">Text</span><span class="delimiter">(</span><a title="String" id="243916">t</a><span class="delimiter">)</span> =&gt; <a href="Fragment.scala.html#188101" title="(t: String)org.specs2.specification.Text">Text</a><span class="delimiter">(</span><a href="#59353" title="(text: String)String">strip</a><span class="delimiter">(</span><a href="#243916" title="String">t</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <a title="org.specs2.specification.Fragment" id="243923">other</a>   =&gt; <a href="#243923" title="org.specs2.specification.Fragment">other</a>
    <span class="delimiter">}</span>

  <span class="comment">/** extract the value contained in the first group */</span>
  <span class="keyword">def</span> <a title="(t: String)String" id="59355">extract1</a><span class="delimiter">(</span><a title="String" id="243924">t</a>: <span title="String">String</span><span class="delimiter">)</span> = <span class="delimiter">(</span><a href="#59352" title="(text: String)List[String]">extractAll</a><span class="delimiter">(</span><a href="#243924" title="String">t</a><span class="delimiter">)</span>: @<span title="List[String] @unchecked">unchecked</span><span class="delimiter">)</span> <span title="String" class="keyword">match</span> <span class="delimiter">{</span> <span class="keyword">case</span> <a title="String" id="243931">s1</a>::_ =&gt; <a href="#243931" title="String">s1</a> <span class="delimiter">}</span>
  <span class="keyword">def</span> <a title="(t: String)(String, String)" id="59356">extract2</a><span class="delimiter">(</span><a title="String" id="243932">t</a>: <span title="String">String</span><span class="delimiter">)</span> = <span class="delimiter">(</span><a href="#59352" title="(text: String)List[String]">extractAll</a><span class="delimiter">(</span><a href="#243932" title="String">t</a><span class="delimiter">)</span>: @<span title="List[String] @unchecked">unchecked</span><span class="delimiter">)</span> <span title="(String, String)" class="keyword">match</span> <span class="delimiter">{</span> <span class="keyword">case</span> <a title="(String, String)" id="243939">s1</a>::<a title="String" id="243946">s2</a>::_ =&gt; <span title="(_1: String, _2: String)(String, String)" class="delimiter">(</span><a href="#243939" title="String">s1</a>,<a href="#243946" title="String">s2</a><span class="delimiter">)</span> <span class="delimiter">}</span>
  <span class="keyword">def</span> <a title="(t: String)(String, String, String)" id="59357">extract3</a><span class="delimiter">(</span><a title="String" id="243953">t</a>: <span title="String">String</span><span class="delimiter">)</span> = <span class="delimiter">(</span><a href="#59352" title="(text: String)List[String]">extractAll</a><span class="delimiter">(</span><a href="#243953" title="String">t</a><span class="delimiter">)</span>: @<span title="List[String] @unchecked">unchecked</span><span class="delimiter">)</span> <span title="(String, String, String)" class="keyword">match</span> <span class="delimiter">{</span> <span class="keyword">case</span> <a title="(String, String, String)" id="243960">s1</a>::<a title="String" id="243965">s2</a>::<a title="String" id="243970">s3</a>::_ =&gt; <span title="(_1: String, _2: String, _3: String)(String, String, String)" class="delimiter">(</span><a href="#243960" title="String">s1</a>,<a href="#243965" title="String">s2</a>,<a href="#243970" title="String">s3</a><span class="delimiter">)</span> <span class="delimiter">}</span>
  <span class="keyword">def</span> <a title="(t: String)(String, String, String, String)" id="59358">extract4</a><span class="delimiter">(</span><a title="String" id="243980">t</a>: <span title="String">String</span><span class="delimiter">)</span> = <span class="delimiter">(</span><a href="#59352" title="(text: String)List[String]">extractAll</a><span class="delimiter">(</span><a href="#243980" title="String">t</a><span class="delimiter">)</span>: @<span title="List[String] @unchecked">unchecked</span><span class="delimiter">)</span> <span title="(String, String, String, String)" class="keyword">match</span> <span class="delimiter">{</span> <span class="keyword">case</span> <a title="(String, String, String, String)" id="243987">s1</a>::<a title="String" id="243992">s2</a>::<a title="String" id="243997">s3</a>::<a title="String" id="244002">s4</a>::_ =&gt; <span title="(_1: String, _2: String, _3: String, _4: String)(String, String, String, String)" class="delimiter">(</span><a href="#243987" title="String">s1</a>,<a href="#243992" title="String">s2</a>,<a href="#243997" title="String">s3</a>,<a href="#244002" title="String">s4</a><span class="delimiter">)</span> <span class="delimiter">}</span>
  <span class="keyword">def</span> <a title="(t: String)(String, String, String, String, String)" id="59359">extract5</a><span class="delimiter">(</span><a title="String" id="244015">t</a>: <span title="String">String</span><span class="delimiter">)</span> = <span class="delimiter">(</span><a href="#59352" title="(text: String)List[String]">extractAll</a><span class="delimiter">(</span><a href="#244015" title="String">t</a><span class="delimiter">)</span>: @<span title="List[String] @unchecked">unchecked</span><span class="delimiter">)</span> <span title="(String, String, String, String, String)" class="keyword">match</span> <span class="delimiter">{</span> <span class="keyword">case</span> <a title="(String, String, String, String, String)" id="244022">s1</a>::<a title="String" id="244027">s2</a>::<a title="String" id="244032">s3</a>::<a title="String" id="244037">s4</a>::<a title="String" id="244042">s5</a>::_ =&gt; <span title="(_1: String, _2: String, _3: String, _4: String, _5: String)(String, String, String, String, String)" class="delimiter">(</span><a href="#244022" title="String">s1</a>,<a href="#244027" title="String">s2</a>,<a href="#244032" title="String">s3</a>,<a href="#244037" title="String">s4</a>,<a href="#244042" title="String">s5</a><span class="delimiter">)</span> <span class="delimiter">}</span>
  <span class="keyword">def</span> <a title="(t: String)(String, String, String, String, String, String)" id="59360">extract6</a><span class="delimiter">(</span><a title="String" id="244058">t</a>: <span title="String">String</span><span class="delimiter">)</span> = <span class="delimiter">(</span><a href="#59352" title="(text: String)List[String]">extractAll</a><span class="delimiter">(</span><a href="#244058" title="String">t</a><span class="delimiter">)</span>: @<span title="List[String] @unchecked">unchecked</span><span class="delimiter">)</span> <span title="(String, String, String, String, String, String)" class="keyword">match</span> <span class="delimiter">{</span> <span class="keyword">case</span> <a title="(String, String, String, String, String, String)" id="244065">s1</a>::<a title="String" id="244070">s2</a>::<a title="String" id="244075">s3</a>::<a title="String" id="244080">s4</a>::<a title="String" id="244085">s5</a>::<a title="String" id="244090">s6</a>::_ =&gt; <span title="(_1: String, _2: String, _3: String, _4: String, _5: String, _6: String)(String, String, String, String, String, String)" class="delimiter">(</span><a href="#244065" title="String">s1</a>,<a href="#244070" title="String">s2</a>,<a href="#244075" title="String">s3</a>,<a href="#244080" title="String">s4</a>,<a href="#244085" title="String">s5</a>,<a href="#244090" title="String">s6</a><span class="delimiter">)</span> <span class="delimiter">}</span>
  <span class="keyword">def</span> <a title="(t: String)(String, String, String, String, String, String, String)" id="59361">extract7</a><span class="delimiter">(</span><a title="String" id="244109">t</a>: <span title="String">String</span><span class="delimiter">)</span> = <span class="delimiter">(</span><a href="#59352" title="(text: String)List[String]">extractAll</a><span class="delimiter">(</span><a href="#244109" title="String">t</a><span class="delimiter">)</span>: @<span title="List[String] @unchecked">unchecked</span><span class="delimiter">)</span> <span title="(String, String, String, String, String, String, String)" class="keyword">match</span> <span class="delimiter">{</span> <span class="keyword">case</span> <a title="(String, String, String, String, String, String, String)" id="244116">s1</a>::<a title="String" id="244121">s2</a>::<a title="String" id="244126">s3</a>::<a title="String" id="244131">s4</a>::<a title="String" id="244136">s5</a>::<a title="String" id="244141">s6</a>::<a title="String" id="244146">s7</a>::_ =&gt; <span title="(_1: String, _2: String, _3: String, _4: String, _5: String, _6: String, _7: String)(String, String, String, String, String, String, String)" class="delimiter">(</span><a href="#244116" title="String">s1</a>,<a href="#244121" title="String">s2</a>,<a href="#244126" title="String">s3</a>,<a href="#244131" title="String">s4</a>,<a href="#244136" title="String">s5</a>,<a href="#244141" title="String">s6</a>,<a href="#244146" title="String">s7</a><span class="delimiter">)</span> <span class="delimiter">}</span>
  <span class="keyword">def</span> <a title="(t: String)(String, String, String, String, String, String, String, String)" id="59362">extract8</a><span class="delimiter">(</span><a title="String" id="244168">t</a>: <span title="String">String</span><span class="delimiter">)</span> = <span class="delimiter">(</span><a href="#59352" title="(text: String)List[String]">extractAll</a><span class="delimiter">(</span><a href="#244168" title="String">t</a><span class="delimiter">)</span>: @<span title="List[String] @unchecked">unchecked</span><span class="delimiter">)</span> <span title="(String, String, String, String, String, String, String, String)" class="keyword">match</span> <span class="delimiter">{</span> <span class="keyword">case</span> <a title="(String, String, String, String, String, String, String, String)" id="244175">s1</a>::<a title="String" id="244180">s2</a>::<a title="String" id="244185">s3</a>::<a title="String" id="244190">s4</a>::<a title="String" id="244195">s5</a>::<a title="String" id="244200">s6</a>::<a title="String" id="244205">s7</a>::<a title="String" id="244210">s8</a>::_ =&gt; <span title="(_1: String, _2: String, _3: String, _4: String, _5: String, _6: String, _7: String, _8: String)(String, String, String, String, String, String, String, String)" class="delimiter">(</span><a href="#244175" title="String">s1</a>,<a href="#244180" title="String">s2</a>,<a href="#244185" title="String">s3</a>,<a href="#244190" title="String">s4</a>,<a href="#244195" title="String">s5</a>,<a href="#244200" title="String">s6</a>,<a href="#244205" title="String">s7</a>,<a href="#244210" title="String">s8</a><span class="delimiter">)</span> <span class="delimiter">}</span>
  <span class="keyword">def</span> <a title="(t: String)(String, String, String, String, String, String, String, String, String)" id="59363">extract9</a><span class="delimiter">(</span><a title="String" id="244235">t</a>: <span title="String">String</span><span class="delimiter">)</span> = <span class="delimiter">(</span><a href="#59352" title="(text: String)List[String]">extractAll</a><span class="delimiter">(</span><a href="#244235" title="String">t</a><span class="delimiter">)</span>: @<span title="List[String] @unchecked">unchecked</span><span class="delimiter">)</span> <span title="(String, String, String, String, String, String, String, String, String)" class="keyword">match</span> <span class="delimiter">{</span> <span class="keyword">case</span> <a title="(String, String, String, String, String, String, String, String, String)" id="244242">s1</a>::<a title="String" id="244247">s2</a>::<a title="String" id="244252">s3</a>::<a title="String" id="244257">s4</a>::<a title="String" id="244262">s5</a>::<a title="String" id="244267">s6</a>::<a title="String" id="244272">s7</a>::<a title="String" id="244277">s8</a>::<a title="String" id="244282">s9</a>::_ =&gt; <span title="(_1: String, _2: String, _3: String, _4: String, _5: String, _6: String, _7: String, _8: String, _9: String)(String, String, String, String, String, String, String, String, String)" class="delimiter">(</span><a href="#244242" title="String">s1</a>,<a href="#244247" title="String">s2</a>,<a href="#244252" title="String">s3</a>,<a href="#244257" title="String">s4</a>,<a href="#244262" title="String">s5</a>,<a href="#244267" title="String">s6</a>,<a href="#244272" title="String">s7</a>,<a href="#244277" title="String">s8</a>,<a href="#244282" title="String">s9</a><span class="delimiter">)</span> <span class="delimiter">}</span>
  <span class="keyword">def</span> <a title="(t: String)(String, String, String, String, String, String, String, String, String, String)" id="59364">extract10</a><span class="delimiter">(</span><a title="String" id="244310">t</a>: <span title="String">String</span><span class="delimiter">)</span> = <span class="delimiter">(</span><a href="#59352" title="(text: String)List[String]">extractAll</a><span class="delimiter">(</span><a href="#244310" title="String">t</a><span class="delimiter">)</span>: @<span title="List[String] @unchecked">unchecked</span><span class="delimiter">)</span> <span title="(String, String, String, String, String, String, String, String, String, String)" class="keyword">match</span> <span class="delimiter">{</span> <span class="keyword">case</span> <a title="(String, String, String, String, String, String, String, String, String, String)" id="244317">s1</a>::<a title="String" id="244322">s2</a>::<a title="String" id="244327">s3</a>::<a title="String" id="244332">s4</a>::<a title="String" id="244337">s5</a>::<a title="String" id="244342">s6</a>::<a title="String" id="244347">s7</a>::<a title="String" id="244352">s8</a>::<a title="String" id="244357">s9</a>::<a title="String" id="244362">s10</a>::_ =&gt; <span title="(_1: String, _2: String, _3: String, _4: String, _5: String, _6: String, _7: String, _8: String, _9: String, _10: String)(String, String, String, String, String, String, String, String, String, String)" class="delimiter">(</span><a href="#244317" title="String">s1</a>,<a href="#244322" title="String">s2</a>,<a href="#244327" title="String">s3</a>,<a href="#244332" title="String">s4</a>,<a href="#244337" title="String">s5</a>,<a href="#244342" title="String">s6</a>,<a href="#244347" title="String">s7</a>,<a href="#244352" title="String">s8</a>,<a href="#244357" title="String">s9</a>,<a href="#244362" title="String">s10</a><span class="delimiter">)</span> <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="keyword">object</span> <a title="object org.specs2.specification.RegexStep" id="11569">RegexStep</a> <span title="ScalaObject" class="delimiter">{</span>
  <span class="keyword">private</span> <span class="keyword">val</span> <a title="java.lang.String" id="240258">DEFAULT_REGEX</a> = <span title="java.lang.String(&quot;\\$\\{([^}]+)\\}&quot;)" class="string">&quot;&quot;&quot;\$\{([^}]+)\}&quot;&quot;&quot;</span>
  <span class="keyword">def</span> <a title="(text: String, regex: String)String" id="240260">strip</a><span class="delimiter">(</span><a title="String" id="240261">text</a>: <span title="String">String</span>, <a title="String" id="240264">regex</a>: <span title="String">String</span> = <a href="#240258" title="=&gt; java.lang.String">DEFAULT_REGEX</a><span class="delimiter">)</span>: <span title="String">String</span> = <a href="#240264" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">regex</a>.<span title="=&gt; scala.util.matching.Regex">r</span>.<span title="(target: java.lang.CharSequence, replacer: scala.util.matching.Regex.Match =&gt; String)String">replaceAllIn</span><span class="delimiter">(</span><a href="#240261" title="String">text</a>, <span class="delimiter">(</span><a href="#244400" title="scala.util.matching.Regex.Match">_</a>:Regex.<span title="scala.util.matching.Regex.Match">Match</span><span class="delimiter">)</span> <span title="String" class="keyword">match</span> <span class="delimiter">{</span> <span class="keyword">case</span> <span title="String">Regex</span>.<a href="#244402" title="(m: scala.util.matching.Regex.Match)Option[Seq[String]]">Groups</a><span class="delimiter">(</span><a title="String" id="244404">v</a><span class="delimiter">)</span> =&gt; <a href="#244404" title="String">v</a> <span class="delimiter">}</span><span class="delimiter">)</span>
<span class="delimiter">}</span>

<span class="comment">/**
 * This step can start a sequence of Given / When / Then.
 *
 * It must define the extract function creating a value of type T from the extracted values
 */</span>
<span class="keyword">abstract</span> <span class="keyword">class</span> <a title="class Given[T] extends org.specs2.specification.RegexStep[Unit,T] with ScalaObject" id="11573">Given</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="59471">T</a><span class="delimiter">]</span><a href="#11573" title="ScalaObject" class="delimiter">(</a><span class="keyword">val</span> <a title="String" id="59469">regex</a>: <span title="String">String</span> = <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#11566" title="org.specs2.specification.RegexStep[Unit,T]">RegexStep</a><span class="delimiter">[</span>Unit, T<span class="delimiter">]</span><span class="delimiter">(</span><a href="#59469" title="String">regex</a><span class="delimiter">)</span> <span class="delimiter">{</span>
  <span class="comment">/** if the extraction goes wrong, then an Error is propagated */</span>
  <span class="keyword">private</span><span class="delimiter">[</span>specs2<span class="delimiter">]</span> <span class="keyword">def</span> <a title="(text: String)Either[org.specs2.execute.Result,T]" id="59459">extractContext</a><span class="delimiter">(</span><a title="String" id="243448">text</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="Either[org.specs2.execute.Result,T]">Either</span><span class="delimiter">[</span>Result, T<span class="delimiter">]</span> = <a href="../control/Exceptions.scala.html#17214" title="(a: =&gt; T)(implicit f: Exception =&gt; org.specs2.execute.Error)Either[org.specs2.execute.Error,T]">trye</a><span class="delimiter">(</span><a href="#59460" title="(text: String)T">extract</a><span class="delimiter">(</span><a href="#243448" title="String">text</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="delimiter">(</span>e:<span title="Exception">Exception</span><span class="delimiter">)</span> =&gt; <a href="../execute/Result.scala.html#55424" title="(e: Exception)org.specs2.execute.Error">Error</a><span class="delimiter">(</span><a href="#244421" title="Exception">e</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(text: String)T" id="59460">extract</a><span class="delimiter">(</span><a title="String" id="59464">text</a>: <span title="String">String</span><span class="delimiter">)</span>: <a href="#59471" title="T">T</a>
<span class="delimiter">}</span>

<span class="comment">/**
 * This step define conditions in a sequence of Given / When / Then.
 *
 * It must define the extract function taking the previous state of extracted values, P, and creating a new state
 * of type T from the extracted values
 */</span>
<span class="keyword">abstract</span> <span class="keyword">class</span> <a title="class When[P, T] extends org.specs2.specification.RegexStep[P,T] with ScalaObject" id="11578">When</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="59431">P</a>, <a title="&gt;: Nothing &lt;: Any" id="59432">T</a><span class="delimiter">]</span><a href="#11578" title="ScalaObject" class="delimiter">(</a><span class="keyword">val</span> <a title="String" id="59428">regex</a>: <span title="String">String</span> = <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#11566" title="org.specs2.specification.RegexStep[P,T]">RegexStep</a><span class="delimiter">[</span>P, T<span class="delimiter">]</span><span class="delimiter">(</span><a href="#59428" title="String">regex</a><span class="delimiter">)</span> <span class="delimiter">{</span>
  <span class="comment">/**
   * if the previous extraction went wrong, then a Skipped result is propagated.
   * Otherwise if the current extraction goes wrong, then an Error is propagated
   */</span>
  <span class="keyword">private</span><span class="delimiter">[</span>specs2<span class="delimiter">]</span> <span class="keyword">def</span> <a title="(p: Either[org.specs2.execute.Result,P], text: String)Either[org.specs2.execute.Result,T]" id="59414">extractContext</a><span class="delimiter">(</span><a title="Either[org.specs2.execute.Result,P]" id="244436">p</a>: <span title="Either[org.specs2.execute.Result,P]">Either</span><span class="delimiter">[</span>Result, P<span class="delimiter">]</span>, <a title="String" id="244437">text</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="Either[org.specs2.execute.Result,T]">Either</span><span class="delimiter">[</span>Result, T<span class="delimiter">]</span> = <a href="#244436" title="Either[org.specs2.execute.Result,P]">p</a> <span title="Either[org.specs2.execute.Result,T]" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <span title="Left[org.specs2.execute.Skipped,Nothing]">Left</span><span class="delimiter">(</span><a title="org.specs2.execute.Result" id="244440">l</a><span class="delimiter">)</span>  =&gt; <span title="(a: org.specs2.execute.Skipped)Left[org.specs2.execute.Skipped,Nothing]">Left</span><span class="delimiter">(</span><a href="../execute/Result.scala.html#71448" title="(m: String, e: String)org.specs2.execute.Skipped">Skipped</a><span class="delimiter">(</span><a href="#244440" title="org.specs2.execute.Result">l</a>.<a href="../execute/Result.scala.html#32470" title="=&gt; String">message</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="keyword">case</span> <span title="Either[org.specs2.execute.Error,T]">Right</span><span class="delimiter">(</span><a title="P" id="244450">r</a><span class="delimiter">)</span> =&gt; <a href="../control/Exceptions.scala.html#17214" title="(a: =&gt; T)(implicit f: Exception =&gt; org.specs2.execute.Error)Either[org.specs2.execute.Error,T]">trye</a><span class="delimiter">(</span><a href="#59415" title="(p: P, text: String)T">extract</a><span class="delimiter">(</span><a href="#244450" title="P">r</a>, <a href="#244437" title="String">text</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="delimiter">(</span>e:<span title="Exception">Exception</span><span class="delimiter">)</span> =&gt; <a href="../execute/Result.scala.html#55424" title="(e: Exception)org.specs2.execute.Error">Error</a><span class="delimiter">(</span><a href="#244459" title="Exception">e</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>
  <span class="keyword">def</span> <a title="(p: P, text: String)T" id="59415">extract</a><span class="delimiter">(</span><a title="P" id="59420">p</a>: <a href="#59431" title="P">P</a>, <a title="String" id="59421">text</a>: <span title="String">String</span><span class="delimiter">)</span>: <a href="#59432" title="T">T</a>
<span class="delimiter">}</span>

<span class="comment">/**
 * This step define checks in a sequence of Given / When / Then.
 *
 * It must define the extract function taking the state of extracted values, T, and return a `Result`
 */</span>
<span class="keyword">abstract</span> <span class="keyword">class</span> <a title="class Then[T] extends org.specs2.specification.RegexStep[Either[org.specs2.execute.Result,T],(T, org.specs2.execute.Result)] with ScalaObject" id="11582">Then</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="59388">T</a><span class="delimiter">]</span><a href="#11582" title="ScalaObject" class="delimiter">(</a><a title="String" id="59386">regex</a>: <span title="String">String</span> = <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#11566" title="org.specs2.specification.RegexStep[Either[org.specs2.execute.Result,T],(T, org.specs2.execute.Result)]">RegexStep</a><span class="delimiter">[</span>Either<span class="delimiter">[</span>Result, T<span class="delimiter">]</span>, <span class="delimiter">(</span>T, Result<span class="delimiter">)</span><span class="delimiter">]</span><span class="delimiter">(</span><a href="#59386" title="String">regex</a><span class="delimiter">)</span> <span class="delimiter">{</span>
  <span class="comment">/**
   * if the previous extraction went wrong, then a Skipped result is propagated.
   * Otherwise if the current extraction goes wrong, then an Error is propagated
   */</span>
  <span class="keyword">private</span><span class="delimiter">[</span>specs2<span class="delimiter">]</span> <span class="keyword">def</span> <a title="(t: Either[org.specs2.execute.Result,T], text: String)Either[org.specs2.execute.Result,(T, org.specs2.execute.Result)]" id="59368">extractContext</a><span class="delimiter">(</span><a title="Either[org.specs2.execute.Result,T]" id="244474">t</a>: <span title="Either[org.specs2.execute.Result,T]">Either</span><span class="delimiter">[</span>Result, T<span class="delimiter">]</span>, <a title="String" id="244475">text</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="Either[org.specs2.execute.Result,(T, org.specs2.execute.Result)]">Either</span><span class="delimiter">[</span>Result, <span class="delimiter">(</span>T, Result<span class="delimiter">)</span><span class="delimiter">]</span> = <a href="#244474" title="Either[org.specs2.execute.Result,T]">t</a> <span title="Either[org.specs2.execute.Result,(T, org.specs2.execute.Result)]" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <span title="Left[org.specs2.execute.Skipped,Nothing]">Left</span><span class="delimiter">(</span><a title="org.specs2.execute.Result" id="244478">l</a><span class="delimiter">)</span>  =&gt; <span title="(a: org.specs2.execute.Skipped)Left[org.specs2.execute.Skipped,Nothing]">Left</span><span class="delimiter">(</span><a href="../execute/Result.scala.html#71448" title="(m: String, e: String)org.specs2.execute.Skipped">Skipped</a><span class="delimiter">(</span><a href="#244478" title="org.specs2.execute.Result">l</a>.<a href="../execute/Result.scala.html#32470" title="=&gt; String">message</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="keyword">case</span> <span title="Either[org.specs2.execute.Error,(T, org.specs2.execute.Result)]">Right</span><span class="delimiter">(</span><a title="T" id="244488">r</a><span class="delimiter">)</span> =&gt; <a href="../control/Exceptions.scala.html#17214" title="(a: =&gt; (T, org.specs2.execute.Result))(implicit f: Exception =&gt; org.specs2.execute.Error)Either[org.specs2.execute.Error,(T, org.specs2.execute.Result)]">trye</a><span class="delimiter">(</span><span title="(_1: T, _2: org.specs2.execute.Result)(T, org.specs2.execute.Result)" class="delimiter">(</span><a href="#244488" title="T">r</a>, <a href="#59369" title="(t: T, text: String)org.specs2.execute.Result">extract</a><span class="delimiter">(</span><a href="#244488" title="T">r</a>, <a href="#244475" title="String">text</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="delimiter">(</span>e:<span title="Exception">Exception</span><span class="delimiter">)</span> =&gt; <a href="../execute/Result.scala.html#55424" title="(e: Exception)org.specs2.execute.Error">Error</a><span class="delimiter">(</span><a href="#244503" title="Exception">e</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>
  <span class="keyword">def</span> <a title="(t: T, text: String)org.specs2.execute.Result" id="59369">extract</a><span class="delimiter">(</span><a title="T" id="59374">t</a>: <a href="#59388" title="T">T</a>, <a title="String" id="59375">text</a>: <span title="String">String</span><span class="delimiter">)</span>: <a href="../execute/Result.scala.html#9666" title="org.specs2.execute.Result">Result</a>
<span class="delimiter">}</span>

<span class="keyword">abstract</span> <span class="keyword">class</span> <a title="class GivenThen extends org.specs2.specification.RegexStep[String,org.specs2.execute.Result] with ScalaObject" id="11585">GivenThen</a><a href="#11585" title="ScalaObject" class="delimiter">(</a><a title="String" id="244518">regex</a>: <span title="String">String</span>= <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#11566" title="org.specs2.specification.RegexStep[String,org.specs2.execute.Result]">RegexStep</a><span class="delimiter">[</span>String, Result<span class="delimiter">]</span><span class="delimiter">(</span><a href="#244518" title="String">regex</a><span class="delimiter">)</span> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="(text: String)org.specs2.execute.Result" id="187185">extract</a><span class="delimiter">(</span><a title="String" id="240267">text</a>: <span title="String">String</span><span class="delimiter">)</span>: <a href="../execute/Result.scala.html#9666" title="org.specs2.execute.Result">Result</a>
<span class="delimiter">}</span>

<span class="keyword">class</span> <a title="class GivenThenFunction[R] extends org.specs2.specification.GivenThen with ScalaObject" id="11589">GivenThenFunction</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="244539">R</a> &lt;% Result<span class="delimiter">]</span><span class="delimiter">(</span><a title="PartialFunction[Any,R]" id="244533">f</a>: <span title="PartialFunction[Any,R]">PartialFunction</span><span class="delimiter">[</span>Any, R<span class="delimiter">]</span>, <a title="String" id="244537">regex</a>: <span title="String">String</span>= <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#11585" title="org.specs2.specification.GivenThen">GivenThen</a><span class="delimiter">(</span><a href="#244537" title="String">regex</a><span class="delimiter">)</span> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="(text: String)org.specs2.execute.Result" id="244528">extract</a><span class="delimiter">(</span><a title="String" id="244540">text</a>: <span title="String">String</span><span class="delimiter">)</span>: <a href="../execute/Result.scala.html#9666" title="org.specs2.execute.Result">Result</a> = <span class="delimiter">{</span>
    <a href="#59351" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">regexToUse</a>.<span title="=&gt; scala.util.matching.Regex">r</span>.<span title="(source: java.lang.CharSequence)scala.util.matching.Regex.MatchIterator">findAllIn</span><span class="delimiter">(</span><a href="#244540" title="String">text</a><span class="delimiter">)</span>.<span title="=&gt; Int">size</span> <span title="org.specs2.execute.Result" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <span title="org.specs2.execute.Result" class="int">1</span> =&gt; <a href="#244533" title="(v1: Any)R">f</a><a href="#244526" title="(v1: R)org.specs2.execute.Result" class="delimiter">(</a><a href="#59355" title="(t: String)String">extract1</a><span class="delimiter">(</span><a href="#244540" title="String">text</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="org.specs2.execute.Result" class="int">2</span> =&gt; <a href="#244533" title="(v1: Any)R">f</a><a href="#244526" title="(v1: R)org.specs2.execute.Result" class="delimiter">(</a><a href="#59356" title="(t: String)(String, String)">extract2</a><span class="delimiter">(</span><a href="#244540" title="String">text</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="org.specs2.execute.Result" class="int">3</span> =&gt; <a href="#244533" title="(v1: Any)R">f</a><a href="#244526" title="(v1: R)org.specs2.execute.Result" class="delimiter">(</a><a href="#59357" title="(t: String)(String, String, String)">extract3</a><span class="delimiter">(</span><a href="#244540" title="String">text</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="org.specs2.execute.Result" class="int">4</span> =&gt; <a href="#244533" title="(v1: Any)R">f</a><a href="#244526" title="(v1: R)org.specs2.execute.Result" class="delimiter">(</a><a href="#59358" title="(t: String)(String, String, String, String)">extract4</a><span class="delimiter">(</span><a href="#244540" title="String">text</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="org.specs2.execute.Result" class="int">5</span> =&gt; <a href="#244533" title="(v1: Any)R">f</a><a href="#244526" title="(v1: R)org.specs2.execute.Result" class="delimiter">(</a><a href="#59359" title="(t: String)(String, String, String, String, String)">extract5</a><span class="delimiter">(</span><a href="#244540" title="String">text</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="org.specs2.execute.Result" class="int">6</span> =&gt; <a href="#244533" title="(v1: Any)R">f</a><a href="#244526" title="(v1: R)org.specs2.execute.Result" class="delimiter">(</a><a href="#59360" title="(t: String)(String, String, String, String, String, String)">extract6</a><span class="delimiter">(</span><a href="#244540" title="String">text</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="org.specs2.execute.Result" class="int">7</span> =&gt; <a href="#244533" title="(v1: Any)R">f</a><a href="#244526" title="(v1: R)org.specs2.execute.Result" class="delimiter">(</a><a href="#59361" title="(t: String)(String, String, String, String, String, String, String)">extract7</a><span class="delimiter">(</span><a href="#244540" title="String">text</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="org.specs2.execute.Result" class="int">8</span> =&gt; <a href="#244533" title="(v1: Any)R">f</a><a href="#244526" title="(v1: R)org.specs2.execute.Result" class="delimiter">(</a><a href="#59362" title="(t: String)(String, String, String, String, String, String, String, String)">extract8</a><span class="delimiter">(</span><a href="#244540" title="String">text</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="org.specs2.execute.Result" class="int">9</span> =&gt; <a href="#244533" title="(v1: Any)R">f</a><a href="#244526" title="(v1: R)org.specs2.execute.Result" class="delimiter">(</a><a href="#59363" title="(t: String)(String, String, String, String, String, String, String, String, String)">extract9</a><span class="delimiter">(</span><a href="#244540" title="String">text</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="org.specs2.execute.Result" class="int">10</span> =&gt; <a href="#244533" title="(v1: Any)R">f</a><a href="#244526" title="(v1: R)org.specs2.execute.Result" class="delimiter">(</a><a href="#59364" title="(t: String)(String, String, String, String, String, String, String, String, String, String)">extract10</a><span class="delimiter">(</span><a href="#244540" title="String">text</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>
<span class="keyword">object</span> <a title="object org.specs2.specification.so" id="11591">so</a> <span title="ScalaObject" class="delimiter">{</span>
  <span class="keyword">def</span> <a title="[R](f: PartialFunction[Any,R])(implicit evidence$2: R =&gt; org.specs2.execute.Result)org.specs2.specification.GivenThen" id="244572">apply</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="244569">R</a> &lt;% Result<span class="delimiter">]</span><span class="delimiter">(</span><a title="PartialFunction[Any,R]" id="244571">f</a>: <span title="PartialFunction[Any,R]">PartialFunction</span><span class="delimiter">[</span>Any, R<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#11585" title="org.specs2.specification.GivenThen">GivenThen</a> = <a href="#244537" title="org.specs2.specification.GivenThenFunction[R]" class="keyword">new</a> <a href="#11589" title="org.specs2.specification.GivenThenFunction[R]">GivenThenFunction</a><span class="delimiter">(</span><a href="#244571" title="PartialFunction[Any,R]">f</a><span class="delimiter">)</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>