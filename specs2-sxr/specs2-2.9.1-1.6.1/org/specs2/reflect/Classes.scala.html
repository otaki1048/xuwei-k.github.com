<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>org/specs2/reflect/Classes.scala</title>
        <script type="text/javascript" src="../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> org.specs2
<span class="keyword">package</span> reflect

<span class="keyword">import</span> scala.reflect.ClassManifest
<span class="keyword">import</span> <a href="ClassName.scala.html#10733" title="object org.specs2.reflect.ClassName">ClassName</a>._
<span class="keyword">import</span> control.<a href="../control/Exceptions.scala.html#9553" title="object org.specs2.control.Exceptions">Exceptions</a>._
<span class="keyword">import</span> control.<a href="../control/Throwablex.scala.html#9615" title="object org.specs2.control.Throwablex">Throwablex</a>._
<span class="keyword">import</span> io._
<span class="keyword">import</span> sys._
<span class="comment">/**
 * This trait provides utility functions for classes
 */</span>
<span class="keyword">private</span><span class="delimiter">[</span>specs2<span class="delimiter">]</span>
<span class="keyword">trait</span> <a title="trait Classes extends java.lang.Object with org.specs2.io.Output with ScalaObject" id="10744">Classes</a> <span title="ScalaObject" class="keyword">extends</span> <a href="../io/Output.scala.html#9998" title="org.specs2.io.Output">Output</a> <span class="delimiter">{</span>

  <span class="comment">/** @return an instance of a given class, returning either the instance, or an exception */</span>
  <span class="keyword">def</span> <a title="[T &lt;: AnyRef](className: String, classLoader: java.lang.ClassLoader)(implicit m: scala.reflect.ClassManifest[T])Either[Throwable,T]" id="60229">create</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: AnyRef" id="190387">T</a> &lt;: AnyRef<span class="delimiter">]</span><span class="delimiter">(</span><a title="String" id="190385">className</a>: <span title="String">String</span> = <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span>, <a title="java.lang.ClassLoader" id="190388">classLoader</a>: <span title="java.lang.ClassLoader">ClassLoader</span> = <span title="object java.lang.Thread">Thread</span>.<span title="()java.lang.Thread">currentThread</span>.<span title="()java.lang.ClassLoader">getContextClassLoader</span><span class="delimiter">)</span>
                         <span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scala.reflect.ClassManifest[T]" id="190383">m</a>: <span title="scala.reflect.ClassManifest[T]">ClassManifest</span><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="Either[Throwable,T]">Either</span><span class="delimiter">[</span>Throwable, T<span class="delimiter">]</span> =
    <a href="../control/Exceptions.scala.html#17214" title="(a: =&gt; T)(implicit f: Exception =&gt; Throwable)Either[Throwable,T]">trye</a><span title="&lt;:&lt;[Exception,Exception]" class="delimiter">(</span><a href="#60247" title="(klass: Class[T])(implicit m: scala.reflect.ClassManifest[T])T">createInstanceFor</a><a href="#190383" title="scala.reflect.ClassManifest[T]" class="delimiter">(</a><a href="#60253" title="[T &lt;: AnyRef](className: String, loader: java.lang.ClassLoader)Class[T]">loadClassOf</a><span title="(className: String, loader: java.lang.ClassLoader)Class[T]" class="delimiter">[</span><a href="#190387" title="T">T</a><span class="delimiter">]</span><span class="delimiter">(</span><a href="#190385" title="String">className</a>, loader = <a href="#190388" title="java.lang.ClassLoader">classLoader</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="comment">/** @return an instance of a given class */</span>
  <span class="keyword">def</span> <a title="[T &lt;: AnyRef](className: String)(implicit m: scala.reflect.ClassManifest[T])Option[T]" id="60232">createObject</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: AnyRef" id="60234">T</a> &lt;: AnyRef<span class="delimiter">]</span><span class="delimiter">(</span><a title="String" id="190477">className</a>: <span title="String">String</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scala.reflect.ClassManifest[T]" id="190478">m</a>: <span title="scala.reflect.ClassManifest[T]">ClassManifest</span><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="Option[T]">Option</span><span class="delimiter">[</span>T<span class="delimiter">]</span> =
    <a href="#60235" title="[T &lt;: AnyRef](className: String, printMessage: Boolean)(implicit m: scala.reflect.ClassManifest[T])Option[T]">createObject</a><span title="(className: String, printMessage: Boolean)(implicit m: scala.reflect.ClassManifest[T])Option[T]" class="delimiter">[</span><a href="#60234" title="T">T</a><span class="delimiter">]</span><span class="delimiter">(</span><a href="#190477" title="String">className</a>, <span title="Boolean(false)" class="keyword">false</span><span class="delimiter">)</span><span class="delimiter">(</span><a href="#190478" title="scala.reflect.ClassManifest[T]">m</a><span class="delimiter">)</span>
  
  <span class="comment">/** @return an instance of a given class and optionally print message if the class can't be loaded */</span>
  <span class="keyword">def</span> <a title="[T &lt;: AnyRef](className: String, printMessage: Boolean)(implicit m: scala.reflect.ClassManifest[T])Option[T]" id="60235">createObject</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: AnyRef" id="60237">T</a> &lt;: AnyRef<span class="delimiter">]</span><span class="delimiter">(</span><a title="String" id="190494">className</a>: <span title="String">String</span>, <a title="Boolean" id="190495">printMessage</a>: <span title="Boolean">Boolean</span><span class="delimiter">)</span>
                               <span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scala.reflect.ClassManifest[T]" id="190496">m</a>: <span title="scala.reflect.ClassManifest[T]">ClassManifest</span><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="Option[T]">Option</span><span class="delimiter">[</span>T<span class="delimiter">]</span> =
    <a href="#60238" title="(className: String, printMessage: Boolean, printStackTrace: Boolean)(implicit m: scala.reflect.ClassManifest[T])Option[T]">createObject</a><span class="delimiter">(</span><a href="#190494" title="String">className</a>, <a href="#190495" title="Boolean">printMessage</a>, <span title="Boolean(false)" class="keyword">false</span><span class="delimiter">)</span><span class="delimiter">(</span><a href="#190496" title="scala.reflect.ClassManifest[T]">m</a><span class="delimiter">)</span>

  <span class="comment">/**
   * A system property 'debugCreateObject' can be set to override the printMessage and printStackTrace parameters
   * so that the exception message and stacktrace are printed when the object can't be created
   * 
   * @return an instance of a given class and optionally print message and/or the stacktrace if the class can't be loaded.
   */</span>
  <span class="keyword">def</span> <a title="[T &lt;: AnyRef](className: String, printMessage: Boolean, printStackTrace: Boolean)(implicit m: scala.reflect.ClassManifest[T])Option[T]" id="60238">createObject</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: AnyRef" id="60240">T</a> &lt;: AnyRef<span class="delimiter">]</span><span class="delimiter">(</span><a title="String" id="190487">className</a>: <span title="String">String</span>, <a title="Boolean" id="190488">printMessage</a>: <span title="Boolean">Boolean</span>, <a title="Boolean" id="190489">printStackTrace</a>: <span title="Boolean">Boolean</span><span class="delimiter">)</span>
                               <span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scala.reflect.ClassManifest[T]" id="190490">m</a>: <span title="scala.reflect.ClassManifest[T]">ClassManifest</span><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="Option[T]">Option</span><span class="delimiter">[</span>T<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <a href="../control/Exceptions.scala.html#17194" title="(a: =&gt; Option[T])(implicit f: Exception =&gt; Unit)Option[Option[T]]">tryo</a><span class="delimiter">(</span><a href="#60244" title="[T &lt;: AnyRef](c: Option[Class[T]])(implicit m: scala.reflect.ClassManifest[T])Option[T]">createInstanceOf</a><span title="(c: Option[Class[T]])(implicit m: scala.reflect.ClassManifest[T])Option[T]" class="delimiter">[</span><a href="#60240" title="T">T</a><span class="delimiter">]</span><a href="#190490" title="scala.reflect.ClassManifest[T]" class="delimiter">(</a><a href="#60250" title="[T &lt;: AnyRef](className: String, loader: java.lang.ClassLoader)Option[Class[T]]">loadClass</a><a href="#190533" title="(className: String, loader: java.lang.ClassLoader)Option[Class[T]]" class="delimiter">[</a><a href="#60240" title="T">T</a><span class="delimiter">]</span><span class="delimiter">(</span><a href="#190487" title="String">className</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span> <span class="delimiter">(</span>e: <span title="Exception">Exception</span><span class="delimiter">)</span> =&gt;
      <span class="keyword">val</span> <a title="Boolean" id="190541">debugCreateObject</a> = <span title="object java.lang.System">System</span>.<span title="(x$1: java.lang.String)java.lang.String">getProperty</span><span class="delimiter">(</span><span title="java.lang.String(&quot;debugCreateObject&quot;)" class="string">&quot;debugCreateObject&quot;</span><span class="delimiter">)</span> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span>
      <span class="keyword">val</span> <a title="Boolean" id="190542">shouldPrintStackTrace</a> = <a href="#190489" title="Boolean">printStackTrace</a> <span title="(x: Boolean)Boolean">||</span> <a href="#190541" title="Boolean">debugCreateObject</a>
      <span class="keyword">val</span> <a title="Boolean" id="190543">shouldPrintMessage</a> = <a href="#190488" title="Boolean">printMessage</a> <span title="(x: Boolean)Boolean">||</span> <a href="#190541" title="Boolean">debugCreateObject</a>
      <span class="keyword">val</span> <a title="java.lang.String" id="190544">msg</a> = <span title="(_1: Boolean, _2: Boolean)(Boolean, Boolean)" class="delimiter">(</span><a href="#190543" title="Boolean">shouldPrintMessage</a>, <a href="#190542" title="Boolean">shouldPrintStackTrace</a><span class="delimiter">)</span> <span title="java.lang.String" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <span title="java.lang.String" class="delimiter">(</span>_, <span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span> =&gt; <span title="java.lang.String(&quot;Could not instantiate class: &quot;)" class="string">&quot;Could not instantiate class: &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="../control/Throwablex.scala.html#55447" title="(t: Exception)org.specs2.control.Throwablex.ExtendedThrowable[Exception]">e</a>.<a href="../control/Throwablex.scala.html#59651" title="=&gt; String">getFullStackTraceAsString</a>
        <span class="keyword">case</span> <span title="java.lang.String" class="delimiter">(</span><span title="Boolean(true)" class="keyword">true</span>, <span title="Boolean(false)" class="keyword">false</span><span class="delimiter">)</span> =&gt; <span title="java.lang.String(&quot;Could not instantiate class: &quot;)" class="string">&quot;Could not instantiate class: &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#190487" title="String">className</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;: &quot;)" class="string">&quot;: &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#190540" title="Exception">e</a>.<span title="()java.lang.String">getMessage</span>
        <span class="keyword">case</span> <span title="java.lang.String(&quot;&quot;)" class="delimiter">(</span><span title="Boolean(false)" class="keyword">false</span>, <span title="Boolean(false)" class="keyword">false</span><span class="delimiter">)</span> =&gt; <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span>
      <span class="delimiter">}</span>
      <a href="../io/Output.scala.html#14612" title="(m: Any)Unit">println</a><span class="delimiter">(</span><a href="#190544" title="java.lang.String">msg</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>.<span title="(f: Option[T] =&gt; Option[T])Option[T]">flatMap</span><span class="delimiter">(</span><a href="#190585" title="(x: Option[T])Option[T]">identity</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Try to create an instance of a given class by using whatever constructor is available
   * and trying to instantiate the first parameter recursively if there is a parameter for that constructor.
   * 
   * This is useful to instantiate nested classes which are referencing their outer class in their constructor
   */</span>
  <span class="keyword">def</span> <a title="[T &lt;: AnyRef](className: String, printMessage: Boolean, printStackTrace: Boolean, loader: java.lang.ClassLoader)(implicit m: scala.reflect.ClassManifest[T])Option[T]" id="60241">tryToCreateObject</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: AnyRef" id="190597">T</a> &lt;: AnyRef<span class="delimiter">]</span><span class="delimiter">(</span><a title="String" id="190589">className</a>: <span title="String">String</span>, <a title="Boolean" id="190595">printMessage</a>: <span title="Boolean">Boolean</span>= <span title="Boolean(true)" class="keyword">true</span>, <a title="Boolean" id="190598">printStackTrace</a>: <span title="Boolean">Boolean</span> = <span title="Boolean(true)" class="keyword">true</span>,
                                     <a title="java.lang.ClassLoader" id="190601">loader</a>: <span title="java.lang.ClassLoader">ClassLoader</span> = <span title="object java.lang.Thread">Thread</span>.<span title="()java.lang.Thread">currentThread</span>.<span title="()java.lang.ClassLoader">getContextClassLoader</span><span class="delimiter">)</span>
                                    <span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scala.reflect.ClassManifest[T]" id="190593">m</a>: <span title="scala.reflect.ClassManifest[T]">ClassManifest</span><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="Option[T]">Option</span><span class="delimiter">[</span>T<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <a href="#60250" title="(className: String, loader: java.lang.ClassLoader)Option[Class[Nothing]]">loadClass</a><span class="delimiter">(</span><a href="#190589" title="String">className</a><span class="delimiter">)</span> <span title="Option[T]" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <span title="None.type">None</span> =&gt; <span title="object None">None</span>
      <span class="keyword">case</span> <span title="Option[T]">Some</span><span class="delimiter">(</span><a title="java.lang.Class[Nothing]" id="190608">c</a>: <span title="Class[_]">Class</span><span class="delimiter">[</span>_<span class="delimiter">]</span><span class="delimiter">)</span> =&gt; <span class="delimiter">{</span>
        <span class="keyword">try</span> <span class="delimiter">{</span>
          <span class="keyword">val</span> <a title="List[java.lang.reflect.Constructor[_]]" id="190611">constructors</a> = <a href="#190608" title="java.lang.Class[Nothing]">c</a>.<span title="(xs: Array[java.lang.reflect.Constructor[_]])scala.collection.mutable.ArrayOps[java.lang.reflect.Constructor[_]]">getDeclaredConstructors</span>.<span title="=&gt; List[java.lang.reflect.Constructor[_]]">toList</span>
          <span title="Option[T]" class="keyword">if</span> <span class="delimiter">(</span><a href="#190611" title="List[java.lang.reflect.Constructor[_]]">constructors</a>.<span title="=&gt; Boolean">isEmpty</span><span class="delimiter">)</span>
            <span title="object None">None</span>
          <span class="keyword">else</span> <span title="Option[T]" class="keyword">if</span> <span class="delimiter">(</span><a href="#190611" title="List[java.lang.reflect.Constructor[_]]">constructors</a>.<span title="(n: Int)java.lang.reflect.Constructor[_]">toList</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>.<span title="(xs: Array[java.lang.Class[_]])scala.collection.mutable.ArrayOps[java.lang.Class[_]]">getParameterTypes</span>.<span title="=&gt; Boolean">isEmpty</span><span class="delimiter">)</span>
            <a href="#60244" title="[T &lt;: AnyRef](c: Option[Class[T]])(implicit m: scala.reflect.ClassManifest[T])Option[T]">createInstanceOf</a><span title="(c: Option[Class[T]])(implicit m: scala.reflect.ClassManifest[T])Option[T]" class="delimiter">[</span><a href="#190597" title="T">T</a><span class="delimiter">]</span><a href="#190593" title="scala.reflect.ClassManifest[T]" class="delimiter">(</a><span title="[A](x: A)Some[A]">Some</span><span title="(x: Class[T])Some[Class[T]]" class="delimiter">[</span><span title="Class[T]">Class</span><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">(</span><a href="#190608" title="java.lang.Class[Nothing]">c</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="Class[T]" class="delimiter">[</span><span title="Class[T]">Class</span><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">)</span>
          <span class="keyword">else</span> <span title="Option[T]" class="keyword">if</span> <span class="delimiter">(</span><a href="#190611" title="List[java.lang.reflect.Constructor[_]]">constructors</a>.<span title="(n: Int)java.lang.reflect.Constructor[_]">toList</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>.<span title="(xs: Array[java.lang.Class[_]])scala.collection.mutable.ArrayOps[java.lang.Class[_]]">getParameterTypes</span>.<span title="=&gt; Int">size</span> <span title="(x: Int)Boolean">==</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span> <span class="delimiter">{</span>
            <span class="keyword">val</span> <a title="String" id="191201">outerClassName</a> = <a href="ClassName.scala.html#50606" title="(c: Class[_])String">getOuterClassName</a><span class="delimiter">(</span><a href="#190608" title="java.lang.Class[Nothing]">c</a><span class="delimiter">)</span>
            <a href="#60241" title="[T &lt;: AnyRef](className: String, printMessage: Boolean, printStackTrace: Boolean, loader: java.lang.ClassLoader)(implicit m: scala.reflect.ClassManifest[T])Option[T]">tryToCreateObject</a><a href="#190601" title="(className: String, printMessage: Boolean, printStackTrace: Boolean, loader: java.lang.ClassLoader)(implicit m: scala.reflect.ClassManifest[T])Option[T]" class="delimiter">[</a><a href="#190597" title="T">T</a><span class="delimiter">]</span><a href="#190593" title="scala.reflect.ClassManifest[T]" class="delimiter">(</a><a href="#191201" title="String">outerClassName</a>, <a href="#190595" title="Boolean">printMessage</a>, <a href="#190598" title="Boolean">printStackTrace</a><span class="delimiter">)</span>.<span title="(f: T =&gt; T)Option[T]">map</span><span class="delimiter">(</span><a href="#190611" title="(n: Int)java.lang.reflect.Constructor[_]">constructors</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>.<span title="(x$1: &lt;repeated...&gt;[java.lang.Object])?0">newInstance</span><span class="delimiter">(</span><a href="#191210" title="T">_</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="T" class="delimiter">[</span><a href="#190597" title="T">T</a><span class="delimiter">]</span><span class="delimiter">)</span>
          <span class="delimiter">}</span>
          <span class="keyword">else</span>
            <span title="object None">None</span>
        <span class="delimiter">}</span> <span class="keyword">catch</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> <a title="Nothing" id="191220">e</a> =&gt; <span class="delimiter">{</span>
            <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#190595" title="Boolean">printMessage</a> <span title="(x: Boolean)Boolean">||</span> <span title="object java.lang.System">System</span>.<span title="(x$1: java.lang.String)java.lang.String">getProperty</span><span class="delimiter">(</span><span title="java.lang.String(&quot;debugCreateObject&quot;)" class="string">&quot;debugCreateObject&quot;</span><span class="delimiter">)</span> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <a href="../io/Output.scala.html#14612" title="(m: Any)Unit">println</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Could not instantiate class &quot;)" class="string">&quot;Could not instantiate class &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#190589" title="String">className</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;: &quot;)" class="string">&quot;: &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#191220" title="java.lang.Throwable">e</a><span class="delimiter">)</span>
            <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#190598" title="Boolean">printStackTrace</a> <span title="(x: Boolean)Boolean">||</span> <span title="object java.lang.System">System</span>.<span title="(x$1: java.lang.String)java.lang.String">getProperty</span><span class="delimiter">(</span><span title="java.lang.String(&quot;debugCreateObject&quot;)" class="string">&quot;debugCreateObject&quot;</span><span class="delimiter">)</span> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <a href="../control/Throwablex.scala.html#55447" title="(t: java.lang.Throwable)org.specs2.control.Throwablex.ExtendedThrowable[java.lang.Throwable]">e</a>.<a href="../control/Throwablex.scala.html#59650" title="=&gt; List[java.lang.StackTraceElement]">getFullStackTrace</a> <span title="(f: java.lang.StackTraceElement =&gt; Unit)Unit">foreach</span> <span class="delimiter">(</span><a title="java.lang.StackTraceElement" id="191269">s</a> =&gt; <a href="../io/Output.scala.html#14612" title="(m: Any)Unit">println</a><span class="delimiter">(</span><a href="#191269" title="java.lang.StackTraceElement">s</a>.<span title="()java.lang.String">toString</span><span class="delimiter">)</span><span class="delimiter">)</span>
            <span title="Nothing" class="keyword">return</span> <span title="object None">None</span>
          <span class="delimiter">}</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
  <span class="comment">/**
   * @return an instance of a given class, checking that the created instance typechecks as expected
   */</span>
  <span class="keyword">private</span><span class="delimiter">[</span>reflect<span class="delimiter">]</span> <span class="keyword">def</span> <a title="[T &lt;: AnyRef](c: Option[Class[T]])(implicit m: scala.reflect.ClassManifest[T])Option[T]" id="60244">createInstanceOf</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: AnyRef" id="60246">T</a> &lt;: AnyRef<span class="delimiter">]</span><span class="delimiter">(</span><a title="Option[Class[T]]" id="190523">c</a>: <span title="Option[Class[T]]">Option</span><span class="delimiter">[</span>Class<span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scala.reflect.ClassManifest[T]" id="190524">m</a>: <span title="scala.reflect.ClassManifest[T]">ClassManifest</span><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="Option[T]">Option</span><span class="delimiter">[</span>T<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <a href="#190523" title="Option[Class[T]]">c</a>.<span title="(f: Class[T] =&gt; T)Option[T]">map</span><span class="delimiter">(</span><a href="#60247" title="(klass: Class[T])(implicit m: scala.reflect.ClassManifest[T])T">createInstanceFor</a><a href="#190524" title="scala.reflect.ClassManifest[T]" class="delimiter">(</a><a href="#191275" title="Class[T]">_</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>
  <span class="comment">/**
   * @return an instance of a given class, checking that the created instance typechecks as expected
   */</span>
  <span class="keyword">private</span><span class="delimiter">[</span>reflect<span class="delimiter">]</span> <span class="keyword">def</span> <a title="[T &lt;: AnyRef](klass: Class[T])(implicit m: scala.reflect.ClassManifest[T])T" id="60247">createInstanceFor</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: AnyRef" id="60249">T</a> &lt;: AnyRef<span class="delimiter">]</span><span class="delimiter">(</span><a title="Class[T]" id="190397">klass</a>: <span title="Class[T]">Class</span><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scala.reflect.ClassManifest[T]" id="190398">m</a>: <span title="scala.reflect.ClassManifest[T]">ClassManifest</span><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="java.lang.reflect.Constructor[_]" id="190401">constructor</a> = <a href="#190397" title="Class[T]">klass</a>.<span title="()Array[java.lang.reflect.Constructor[_]]">getDeclaredConstructors</span><span title="(i: Int)java.lang.reflect.Constructor[_]" class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
    <a href="#190401" title="java.lang.reflect.Constructor[_]">constructor</a>.<span title="(x$1: Boolean)Unit">setAccessible</span><span class="delimiter">(</span><span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span>
  	<span class="keyword">try</span> <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="AnyRef" id="190404">instance</a>: <span title="AnyRef">AnyRef</span> = <a href="#190401" title="java.lang.reflect.Constructor[_]">constructor</a>.<span title="(x$1: &lt;repeated...&gt;[java.lang.Object])Any">newInstance</span><span class="delimiter">(</span><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="AnyRef" class="delimiter">[</span><span title="AnyRef">AnyRef</span><span class="delimiter">]</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#190398" title="scala.reflect.ClassManifest[T]">m</a>.<span title="=&gt; java.lang.Class[_]">erasure</span>.<span title="(x$1: Any)Boolean">isInstance</span><span class="delimiter">(</span><a href="#190404" title="AnyRef">instance</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span title="(message: String)Nothing">error</span><span class="delimiter">(</span><a href="#190404" title="implicit scala.Predef.any2stringadd : (x: Any)scala.runtime.StringAdd">instance</a> <span title="(other: String)java.lang.String">+</span> <span title="java.lang.String(&quot; is not an instance of &quot;)" class="string">&quot; is not an instance of &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#190398" title="scala.reflect.ClassManifest[T]">m</a>.<span title="=&gt; java.lang.Class[_]">erasure</span>.<span title="()java.lang.String">getName</span><span class="delimiter">)</span>
      <a href="#190404" title="AnyRef">instance</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="T" class="delimiter">[</span><a href="#60249" title="T">T</a><span class="delimiter">]</span>
  	<span class="delimiter">}</span> <span class="keyword">catch</span> <span class="delimiter">{</span>
  	  <span class="keyword">case</span> <a title="Nothing" id="190443">e</a>: java.lang.reflect.<span title="java.lang.reflect.InvocationTargetException">InvocationTargetException</span> =&gt; <span title="Nothing" class="keyword">throw</span> <a href="#190443" title="java.lang.reflect.InvocationTargetException">e</a>.<span title="()java.lang.Throwable">getTargetException</span>
  	<span class="delimiter">}</span>
  <span class="delimiter">}</span>
  <span class="comment">/**
   * Load a class, given the class name
   * 
   * If the 'debugLoadClass' property is set, then an error message is printed out to the Console
   */</span>
  <span class="keyword">private</span><span class="delimiter">[</span>reflect<span class="delimiter">]</span> <span class="keyword">def</span> <a title="[T &lt;: AnyRef](className: String, loader: java.lang.ClassLoader)Option[Class[T]]" id="60250">loadClass</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: AnyRef" id="190535">T</a> &lt;: AnyRef<span class="delimiter">]</span><span class="delimiter">(</span><a title="String" id="190530">className</a>: <span title="String">String</span>, <a title="java.lang.ClassLoader" id="190533">loader</a>: <span title="java.lang.ClassLoader">ClassLoader</span> = <span title="object java.lang.Thread">Thread</span>.<span title="()java.lang.Thread">currentThread</span>.<span title="()java.lang.ClassLoader">getContextClassLoader</span><span class="delimiter">)</span>: <span title="Option[Class[T]]">Option</span><span class="delimiter">[</span>Class<span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">]</span> = <span class="delimiter">{</span>
    <a href="../control/Exceptions.scala.html#17194" title="(a: =&gt; Some[Class[T]])(implicit f: Exception =&gt; Unit)Option[Some[Class[T]]]">tryo</a><span class="delimiter">(</span><span title="(x: Class[T])Some[Class[T]]">Some</span><span class="delimiter">(</span><a href="#60253" title="(className: String, loader: java.lang.ClassLoader)Class[Nothing]">loadClassOf</a><span class="delimiter">(</span><a href="#190530" title="String">className</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="Class[T]" class="delimiter">[</span><span title="Class[T]">Class</span><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span> <span class="delimiter">(</span>e: <span title="Throwable">Throwable</span><span class="delimiter">)</span> =&gt;
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><span title="object java.lang.System">System</span>.<span title="(x$1: java.lang.String)java.lang.String">getProperty</span><span class="delimiter">(</span><span title="java.lang.String(&quot;debugLoadClass&quot;)" class="string">&quot;debugLoadClass&quot;</span><span class="delimiter">)</span> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="../io/Output.scala.html#14612" title="(m: Any)Unit">println</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Could not load class &quot;)" class="string">&quot;Could not load class &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#190530" title="String">className</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;: &quot;)" class="string">&quot;: &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#191387" title="Throwable">e</a>.<span title="()java.lang.String">getMessage</span><span class="delimiter">)</span>
        <a href="#191387" title="Throwable">e</a>.<span title="()Array[java.lang.StackTraceElement]">getStackTrace</span><span title="(xs: Array[java.lang.StackTraceElement])scala.collection.mutable.ArrayOps[java.lang.StackTraceElement]" class="delimiter">(</span><span class="delimiter">)</span> <span title="(f: java.lang.StackTraceElement =&gt; Unit)Unit">foreach</span> <span class="delimiter">(</span><a title="java.lang.StackTraceElement" id="192111">s</a> =&gt; <a href="../io/Output.scala.html#14612" title="(m: Any)Unit">println</a><span class="delimiter">(</span><a href="#192111" title="java.lang.StackTraceElement">s</a>.<span title="()java.lang.String">toString</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>.<span title="(f: Some[Class[T]] =&gt; Option[Class[T]])Option[Class[T]]">flatMap</span><span class="delimiter">(</span><a href="#192119" title="(x: Some[Class[T]])Some[Class[T]]">identity</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>
  <span class="comment">/**
   * Load a class, given the class name, without catching exceptions
   */</span>
  <span class="keyword">private</span><span class="delimiter">[</span>reflect<span class="delimiter">]</span> <span class="keyword">def</span> <a title="[T &lt;: AnyRef](className: String, loader: java.lang.ClassLoader)Class[T]" id="60253">loadClassOf</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: AnyRef" id="190463">T</a> &lt;: AnyRef<span class="delimiter">]</span><span class="delimiter">(</span><a title="String" id="190461">className</a>: <span title="String">String</span> = <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span>, <a title="java.lang.ClassLoader" id="190464">loader</a>: <span title="java.lang.ClassLoader">ClassLoader</span> = <span title="object java.lang.Thread">Thread</span>.<span title="()java.lang.Thread">currentThread</span>.<span title="()java.lang.ClassLoader">getContextClassLoader</span><span class="delimiter">)</span>: <span title="Class[T]">Class</span><span class="delimiter">[</span>T<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <a href="#190464" title="java.lang.ClassLoader">loader</a>.<span title="(x$1: java.lang.String)java.lang.Class[_]">loadClass</span><span class="delimiter">(</span><a href="#190461" title="String">className</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="Class[T]" class="delimiter">[</span><span title="Class[T]">Class</span><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">]</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>
<span class="comment">/**
 * This object provides simple functions to instantiate classes.
 */</span>
<span class="keyword">private</span><span class="delimiter">[</span>specs2<span class="delimiter">]</span>
<span class="keyword">object</span> <a title="object org.specs2.reflect.Classes" id="10745">Classes</a> <span title="ScalaObject" class="keyword">extends</span> <a href="#10744" title="org.specs2.reflect.Classes">Classes</a> <span class="keyword">with</span> <a href="../io/ConsoleOutput.scala.html#9931" title="org.specs2.io.ConsoleOutput">ConsoleOutput</a>

        </pre>
    </body>
</html>