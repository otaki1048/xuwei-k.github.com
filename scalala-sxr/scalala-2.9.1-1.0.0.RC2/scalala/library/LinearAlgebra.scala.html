<?xml version="1.0" encoding="utf-8"?>
			<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <title>scalala/library/LinearAlgebra.scala</title>
        <script type="text/javascript" src="../../jquery-all.js"></script>
        <script type="text/javascript" src="../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/*
 * Distributed as part of Scalala, a linear algebra library.
 *
 * Copyright (C) 2008- Daniel Ramage
 *
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.

 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.

 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110 USA
 */</span>
<span class="keyword">package</span> scalala;
<span class="keyword">package</span> library;

<span class="keyword">import</span> org.netlib.lapack._
<span class="keyword">import</span> org.netlib.util.intW

<span class="keyword">import</span> operators._
<span class="keyword">import</span> scalar.Scalar
<span class="keyword">import</span> generic.collection.CanViewAsVector
<span class="keyword">import</span> tensor.domain.TableDomain
<span class="keyword">import</span> tensor.dense.<span class="delimiter">{</span>DenseVector, DenseMatrix<span class="delimiter">}</span>
<span class="keyword">import</span> tensor.<span class="delimiter">{</span>DiagonalMatrix, MatrixSingularException, Matrix, Vector<span class="delimiter">}</span>


<span class="comment">/**
 * Basic linear algebraic operations.
 *
 * @author dlwh,dramage,retronym,afwlehmann,lancelet
 */</span>
<span class="keyword">trait</span> <a title="trait LinearAlgebra extends java.lang.Object with ScalaObject" id="12709">LinearAlgebra</a> <span title="ScalaObject" class="delimiter">{</span>

  @inline <span class="keyword">private</span> <span class="keyword">def</span> <a title="[V](mat: scalala.tensor.Matrix[V])Unit" id="20667">requireNonEmptyMatrix</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="20669">V</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="scalala.tensor.Matrix[V]" id="204040">mat</a>: <a href="../tensor/Matrix.scala.html#18329" title="scalala.tensor.Matrix[V]">Matrix</a><span class="delimiter">[</span>V<span class="delimiter">]</span><span class="delimiter">)</span> =
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#204040" title="scalala.tensor.Matrix[V]">mat</a>.<a href="../tensor/Matrix.scala.html#49655" title="=&gt; Int">numCols</a> <span title="(x: Int)Boolean">==</span> <span title="Int(0)" class="int">0</span> <span title="(x: Boolean)Boolean">||</span> <a href="#204040" title="scalala.tensor.Matrix[V]">mat</a>.<a href="../tensor/Matrix.scala.html#49654" title="=&gt; Int">numRows</a> <span title="(x: Int)Boolean">==</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
      <span title="Nothing" class="keyword">throw</span> <span title="scalala.library.MatrixEmptyException" class="keyword">new</span> <a href="#12679" title="scalala.library.MatrixEmptyException">MatrixEmptyException</a>

  @inline <span class="keyword">private</span> <span class="keyword">def</span> <a title="[V](mat: scalala.tensor.Matrix[V])Unit" id="20670">requireSquareMatrix</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="20672">V</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="scalala.tensor.Matrix[V]" id="204055">mat</a>: <a href="../tensor/Matrix.scala.html#18329" title="scalala.tensor.Matrix[V]">Matrix</a><span class="delimiter">[</span>V<span class="delimiter">]</span><span class="delimiter">)</span> =
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#204055" title="scalala.tensor.Matrix[V]">mat</a>.<a href="../tensor/Matrix.scala.html#49654" title="=&gt; Int">numRows</a> <span title="(x: Int)Boolean">!=</span> <a href="#204055" title="scalala.tensor.Matrix[V]">mat</a>.<a href="../tensor/Matrix.scala.html#49655" title="=&gt; Int">numCols</a><span class="delimiter">)</span>
      <span title="Nothing" class="keyword">throw</span> <span title="scalala.library.MatrixNotSquareException" class="keyword">new</span> <a href="#12736" title="scalala.library.MatrixNotSquareException">MatrixNotSquareException</a>

  @inline <span class="keyword">private</span> <span class="keyword">def</span> <a title="[V](mat: scalala.tensor.Matrix[V])Unit" id="20673">requireSymmetricMatrix</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="20675">V</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="scalala.tensor.Matrix[V]" id="204065">mat</a>: <a href="../tensor/Matrix.scala.html#18329" title="scalala.tensor.Matrix[V]">Matrix</a><span class="delimiter">[</span>V<span class="delimiter">]</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <a href="#20670" title="(mat: scalala.tensor.Matrix[V])Unit">requireSquareMatrix</a><span class="delimiter">(</span><a href="#204065" title="scalala.tensor.Matrix[V]">mat</a><span class="delimiter">)</span>

    <span class="keyword">for</span> <span class="delimiter">(</span><a title="Int" id="204208">i</a> &lt;- <span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">0</span> <span title="(f: Int =&gt; Unit)Unit">until</span> <a href="#204065" title="scalala.tensor.Matrix[V]">mat</a>.<a href="../tensor/Matrix.scala.html#49654" title="=&gt; Int">numRows</a>; <a title="Int" id="204308">j</a> &lt;- <span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">0</span> <span title="(f: Int =&gt; Unit)Unit">until</span> <a href="#204208" title="Int">i</a><span class="delimiter">)</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../tensor/Tensor2.scala.html#44382" title="(i: Int, j: Int)V">mat</a><span class="delimiter">(</span><a href="#204208" title="Int">i</a>,<a href="#204308" title="Int">j</a><span class="delimiter">)</span> <span title="(x$1: Any)Boolean">!=</span> <a href="../tensor/Tensor2.scala.html#44382" title="(i: Int, j: Int)V">mat</a><span class="delimiter">(</span><a href="#204308" title="Int">j</a>,<a href="#204208" title="Int">i</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span title="Nothing" class="keyword">throw</span> <span title="scalala.library.MatrixNotSymmetricException" class="keyword">new</span> <a href="#12547" title="scalala.library.MatrixNotSymmetricException">MatrixNotSymmetricException</a>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Eigenvalue decomposition (right eigenvectors)
   *
   * This function returns the real and imaginary parts of the eigenvalues,
   * and the corresponding eigenvectors.  For most (?) interesting matrices,
   * the imaginary part of all eigenvalues will be zero (and the corresponding
   * eigenvectors will be real).  Any complex eigenvalues will appear in
   * complex-conjugate pairs, and the real and imaginary components of the
   * eigenvector for each pair will be in the corresponding columns of the
   * eigenvector matrix.  Take the complex conjugate to find the second
   * eigenvector.
   *
   * Based on EVD.java from MTJ 0.9.12
   */</span>
  <span class="keyword">def</span> <a title="(m: scalala.tensor.Matrix[Double])(scalala.tensor.dense.DenseVector[Double], scalala.tensor.dense.DenseVector[Double], scalala.tensor.dense.DenseMatrix[Double])" id="20676">eig</a><span class="delimiter">(</span><a title="scalala.tensor.Matrix[Double]" id="205849">m</a> : <a href="../tensor/Matrix.scala.html#18329" title="scalala.tensor.Matrix[Double]">Matrix</a><span class="delimiter">[</span>Double<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="(scalala.tensor.dense.DenseVector[Double], scalala.tensor.dense.DenseVector[Double], scalala.tensor.dense.DenseMatrix[Double])" class="delimiter">(</span>DenseVector<span class="delimiter">[</span>Double<span class="delimiter">]</span>, DenseVector<span class="delimiter">[</span>Double<span class="delimiter">]</span>, DenseMatrix<span class="delimiter">[</span>Double<span class="delimiter">]</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <a href="#20667" title="(mat: scalala.tensor.Matrix[Double])Unit">requireNonEmptyMatrix</a><span class="delimiter">(</span><a href="#205849" title="scalala.tensor.Matrix[Double]">m</a><span class="delimiter">)</span>
    <a href="#20670" title="(mat: scalala.tensor.Matrix[Double])Unit">requireSquareMatrix</a><span class="delimiter">(</span><a href="#205849" title="scalala.tensor.Matrix[Double]">m</a><span class="delimiter">)</span>

    <span class="keyword">val</span> <a title="Int" id="205851">n</a> = <a href="#205849" title="scalala.tensor.Matrix[Double]">m</a>.<a href="../tensor/Matrix.scala.html#49654" title="=&gt; Int">numRows</a>;

    <span class="comment">// Allocate space for the decomposition</span>
    <span class="keyword">var</span> <a title="scalala.tensor.dense.DenseVectorCol[Double]" id="205852">Wr</a> = <a href="../tensor/dense/DenseVector.scala.html#19050" title="object scalala.tensor.dense.DenseVector">DenseVector</a>.<a href="../tensor/dense/DenseVector.scala.html#43294" title="[V](size: Int)(implicit s: scalala.scalar.Scalar[V])scalala.tensor.dense.DenseVectorCol[V]">zeros</a><span title="(size: Int)(implicit s: scalala.scalar.Scalar[Double])scalala.tensor.dense.DenseVectorCol[Double]" class="delimiter">[</span><span title="Double">Double</span><span class="delimiter">]</span><a href="../scalar/Scalar.scala.html#45343" title="object scalala.scalar.Scalar.scalarD" class="delimiter">(</a><a href="#205851" title="Int">n</a><span class="delimiter">)</span>;
    <span class="keyword">var</span> <a title="scalala.tensor.dense.DenseVectorCol[Double]" id="205853">Wi</a> = <a href="../tensor/dense/DenseVector.scala.html#19050" title="object scalala.tensor.dense.DenseVector">DenseVector</a>.<a href="../tensor/dense/DenseVector.scala.html#43294" title="[V](size: Int)(implicit s: scalala.scalar.Scalar[V])scalala.tensor.dense.DenseVectorCol[V]">zeros</a><span title="(size: Int)(implicit s: scalala.scalar.Scalar[Double])scalala.tensor.dense.DenseVectorCol[Double]" class="delimiter">[</span><span title="Double">Double</span><span class="delimiter">]</span><a href="../scalar/Scalar.scala.html#45343" title="object scalala.scalar.Scalar.scalarD" class="delimiter">(</a><a href="#205851" title="Int">n</a><span class="delimiter">)</span>;

    <span class="keyword">var</span> <a title="scalala.tensor.dense.DenseMatrix[Double]" id="205854">Vr</a> = <a href="../tensor/dense/DenseMatrix.scala.html#19128" title="object scalala.tensor.dense.DenseMatrix">DenseMatrix</a>.<a href="../tensor/dense/DenseMatrix.scala.html#62269" title="[V](rows: Int, cols: Int)(implicit s: scalala.scalar.Scalar[V])scalala.tensor.dense.DenseMatrix[V]">zeros</a><span title="(rows: Int, cols: Int)(implicit s: scalala.scalar.Scalar[Double])scalala.tensor.dense.DenseMatrix[Double]" class="delimiter">[</span><span title="Double">Double</span><span class="delimiter">]</span><a href="../scalar/Scalar.scala.html#45343" title="object scalala.scalar.Scalar.scalarD" class="delimiter">(</a><a href="#205851" title="Int">n</a>,<a href="#205851" title="Int">n</a><span class="delimiter">)</span>;

    <span class="comment">// Find the needed workspace</span>
    <span class="keyword">val</span> <a title="Array[Double]" id="205855">worksize</a> = <span title="object Array">Array</span>.<span title="[T](n1: Int)(implicit evidence$3: scala.reflect.ClassManifest[T])Array[T]">ofDim</span><span title="(n1: Int)(implicit evidence$3: scala.reflect.ClassManifest[Double])Array[Double]" class="delimiter">[</span><span title="Double">Double</span><span class="delimiter">]</span><span title="=&gt; scala.reflect.AnyValManifest[Double]" class="delimiter">(</span><span title="Int(1)" class="int">1</span><span class="delimiter">)</span>;
    <span class="keyword">val</span> <a title="org.netlib.util.intW" id="205856">info</a> = <span title="org.netlib.util.intW" class="keyword">new</span> <span title="org.netlib.util.intW">intW</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>;
    <span title="object org.netlib.lapack.LAPACK">LAPACK</span>.<span title="()org.netlib.lapack.LAPACK">getInstance</span>.<span title="(x$1: java.lang.String, x$2: java.lang.String, x$3: Int, x$4: Array[Double], x$5: Int, x$6: Array[Double], x$7: Array[Double], x$8: Array[Double], x$9: Int, x$10: Array[Double], x$11: Int, x$12: Array[Double], x$13: Int, x$14: org.netlib.util.intW)Unit">dgeev</span><span class="delimiter">(</span>
      <span title="java.lang.String(&quot;N&quot;)" class="string">&quot;N&quot;</span>, <span title="java.lang.String(&quot;V&quot;)" class="string">&quot;V&quot;</span>, <a href="#205851" title="Int">n</a>,
      <span title="object Array">Array</span>.<span title="[T](implicit evidence$1: scala.reflect.ClassManifest[T])Array[T]">empty</span><span title="(implicit evidence$1: scala.reflect.ClassManifest[Double])Array[Double]" class="delimiter">[</span><span title="Double">Double</span><span class="delimiter">]</span>, math.<span title="(x: Int, y: Int)Int">max</span><span class="delimiter">(</span><span title="Int(1)" class="int">1</span>,<a href="#205851" title="Int">n</a><span class="delimiter">)</span>,
      <span title="object Array">Array</span>.<span title="[T](implicit evidence$1: scala.reflect.ClassManifest[T])Array[T]">empty</span><span title="(implicit evidence$1: scala.reflect.ClassManifest[Double])Array[Double]" class="delimiter">[</span><span title="Double">Double</span><span class="delimiter">]</span>, <span title="object Array">Array</span>.<span title="[T](implicit evidence$1: scala.reflect.ClassManifest[T])Array[T]">empty</span><span title="(implicit evidence$1: scala.reflect.ClassManifest[Double])Array[Double]" class="delimiter">[</span><span title="Double">Double</span><span class="delimiter">]</span>,
      <span title="object Array">Array</span>.<span title="[T](implicit evidence$1: scala.reflect.ClassManifest[T])Array[T]">empty</span><span title="(implicit evidence$1: scala.reflect.ClassManifest[Double])Array[Double]" class="delimiter">[</span><span title="Double">Double</span><span class="delimiter">]</span>, math.<span title="(x: Int, y: Int)Int">max</span><span class="delimiter">(</span><span title="Int(1)" class="int">1</span>,<a href="#205851" title="Int">n</a><span class="delimiter">)</span>,
      <span title="object Array">Array</span>.<span title="[T](implicit evidence$1: scala.reflect.ClassManifest[T])Array[T]">empty</span><span title="(implicit evidence$1: scala.reflect.ClassManifest[Double])Array[Double]" class="delimiter">[</span><span title="Double">Double</span><span class="delimiter">]</span>, math.<span title="(x: Int, y: Int)Int">max</span><span class="delimiter">(</span><span title="Int(1)" class="int">1</span>,<a href="#205851" title="Int">n</a><span class="delimiter">)</span>,
      <a href="#205855" title="Array[Double]">worksize</a>, -<span title="Int(-1)" class="int">1</span>, <a href="#205856" title="org.netlib.util.intW">info</a><span class="delimiter">)</span>;

    <span class="comment">// Allocate the workspace</span>
    <span class="keyword">val</span> <a title="Int" id="205857">lwork</a>: <span title="Int">Int</span> = <span title="Int" class="keyword">if</span> <span class="delimiter">(</span><a href="#205856" title="org.netlib.util.intW">info</a>.<span title="Int">`val`</span> <span title="(x: Int)Boolean">!=</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
      math.<span title="(x: Int, y: Int)Int">max</span><span class="delimiter">(</span><span title="Int(1)" class="int">1</span>,<span title="Int(4)" class="int">4</span><span title="(x: Int)Int">*</span><a href="#205851" title="Int">n</a><span class="delimiter">)</span>;
    <span class="keyword">else</span>
      math.<span title="(x: Int, y: Int)Int">max</span><span class="delimiter">(</span><span title="Int(1)" class="int">1</span>,<a href="#205855" title="(i: Int)Double">worksize</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>.<span title="=&gt; Int">toInt</span><span class="delimiter">)</span>;

    <span class="keyword">val</span> <a title="Array[Double]" id="205858">work</a> = <span title="object Array">Array</span>.<span title="[T](n1: Int)(implicit evidence$3: scala.reflect.ClassManifest[T])Array[T]">ofDim</span><span title="(n1: Int)(implicit evidence$3: scala.reflect.ClassManifest[Double])Array[Double]" class="delimiter">[</span><span title="Double">Double</span><span class="delimiter">]</span><span title="=&gt; scala.reflect.AnyValManifest[Double]" class="delimiter">(</span><a href="#205857" title="Int">lwork</a><span class="delimiter">)</span>;

    <span class="comment">// Factor it!</span>

    <span class="keyword">val</span> <a title="scalala.tensor.dense.DenseMatrix[Double]" id="205859">A</a> = <a href="../scalar/Scalar.scala.html#45343" title="scalala.tensor.dense.DenseMatrix[Double]" class="keyword">new</a> <a href="../tensor/dense/DenseMatrix.scala.html#19127" title="scalala.tensor.dense.DenseMatrix[Double]">DenseMatrix</a><span class="delimiter">(</span><a href="#205851" title="Int">n</a>,<a href="#205851" title="Int">n</a>,<span title="object Array">Array</span>.<span title="[T](n1: Int)(implicit evidence$3: scala.reflect.ClassManifest[T])Array[T]">ofDim</span><span title="(n1: Int)(implicit evidence$3: scala.reflect.ClassManifest[Double])Array[Double]" class="delimiter">[</span><span title="Double">Double</span><span class="delimiter">]</span><span title="=&gt; scala.reflect.AnyValManifest[Double]" class="delimiter">(</span><a href="#205851" title="Int">n</a><span title="(x: Int)Int">*</span><a href="#205851" title="Int">n</a><span class="delimiter">)</span><span class="delimiter">)</span>;
    <a href="#205859" title="scalala.tensor.dense.DenseMatrix[Double]">A</a> <a href="../operators/Ops.scala.html#40853" title="(b: scalala.tensor.Matrix[Double])(implicit op: scalala.operators.BinaryUpdateOp[scalala.tensor.dense.DenseMatrix[Double],scalala.tensor.Matrix[Double],scalala.operators.OpSet])scalala.tensor.dense.DenseMatrix[Double]">:=</a> <a href="#205849" title="scalala.tensor.Matrix[Double]">m</a>
    <span title="object org.netlib.lapack.LAPACK">LAPACK</span>.<span title="()org.netlib.lapack.LAPACK">getInstance</span>.<span title="(x$1: java.lang.String, x$2: java.lang.String, x$3: Int, x$4: Array[Double], x$5: Int, x$6: Array[Double], x$7: Array[Double], x$8: Array[Double], x$9: Int, x$10: Array[Double], x$11: Int, x$12: Array[Double], x$13: Int, x$14: org.netlib.util.intW)Unit">dgeev</span><span class="delimiter">(</span>
      <span title="java.lang.String(&quot;N&quot;)" class="string">&quot;N&quot;</span>, <span title="java.lang.String(&quot;V&quot;)" class="string">&quot;V&quot;</span>, <a href="#205851" title="Int">n</a>,
      <a href="#205859" title="scalala.tensor.dense.DenseMatrix[Double]">A</a>.<a href="../tensor/dense/DenseMatrix.scala.html#64812" title="=&gt; Array[Double]">data</a>, math.<span title="(x: Int, y: Int)Int">max</span><span class="delimiter">(</span><span title="Int(1)" class="int">1</span>,<a href="#205851" title="Int">n</a><span class="delimiter">)</span>,
      <a href="#205852" title="scalala.tensor.dense.DenseVectorCol[Double]">Wr</a>.<a href="../tensor/dense/DenseVector.scala.html#43324" title="=&gt; Array[Double]">data</a>, <a href="#205853" title="scalala.tensor.dense.DenseVectorCol[Double]">Wi</a>.<a href="../tensor/dense/DenseVector.scala.html#43324" title="=&gt; Array[Double]">data</a>,
      <span title="object Array">Array</span>.<span title="[T](implicit evidence$1: scala.reflect.ClassManifest[T])Array[T]">empty</span><span title="(implicit evidence$1: scala.reflect.ClassManifest[Double])Array[Double]" class="delimiter">[</span><span title="Double">Double</span><span class="delimiter">]</span>, math.<span title="(x: Int, y: Int)Int">max</span><span class="delimiter">(</span><span title="Int(1)" class="int">1</span>,<a href="#205851" title="Int">n</a><span class="delimiter">)</span>,
      <a href="#205854" title="scalala.tensor.dense.DenseMatrix[Double]">Vr</a>.<a href="../tensor/dense/DenseMatrix.scala.html#64812" title="=&gt; Array[Double]">data</a>, math.<span title="(x: Int, y: Int)Int">max</span><span class="delimiter">(</span><span title="Int(1)" class="int">1</span>,<a href="#205851" title="Int">n</a><span class="delimiter">)</span>,
      <a href="#205858" title="Array[Double]">work</a>, <a href="#205858" title="Array[Double]">work</a>.<span title="=&gt; Int">length</span>, <a href="#205856" title="org.netlib.util.intW">info</a><span class="delimiter">)</span>;

    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#205856" title="org.netlib.util.intW">info</a>.<span title="Int">`val`</span> <span title="(x: Int)Boolean">&gt;</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
      <span title="Nothing" class="keyword">throw</span> <a href="#219315" title="scalala.library.NotConvergedException" class="keyword">new</a> <a href="#12511" title="scalala.library.NotConvergedException">NotConvergedException</a><span class="delimiter">(</span><a href="#366368" title="object scalala.library.NotConvergedException">NotConvergedException</a>.<a href="#219309" title="object scalala.library.NotConvergedException.Iterations">Iterations</a><span class="delimiter">)</span>
    <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#205856" title="org.netlib.util.intW">info</a>.<span title="Int">`val`</span> <span title="(x: Int)Boolean">&lt;</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
      <span title="Nothing" class="keyword">throw</span> <span title="java.lang.IllegalArgumentException" class="keyword">new</span> <span title="java.lang.IllegalArgumentException">IllegalArgumentException</span><span class="delimiter">(</span><span class="delimiter">)</span>

    <span title="(_1: scalala.tensor.dense.DenseVectorCol[Double], _2: scalala.tensor.dense.DenseVectorCol[Double], _3: scalala.tensor.dense.DenseMatrix[Double])(scalala.tensor.dense.DenseVectorCol[Double], scalala.tensor.dense.DenseVectorCol[Double], scalala.tensor.dense.DenseMatrix[Double])" class="delimiter">(</span><a href="#205852" title="scalala.tensor.dense.DenseVectorCol[Double]">Wr</a>, <a href="#205853" title="scalala.tensor.dense.DenseVectorCol[Double]">Wi</a>, <a href="#205854" title="scalala.tensor.dense.DenseMatrix[Double]">Vr</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Computes the SVD of a m by n matrix
   * Returns an m*m matrix U, a vector of singular values, and a n*n matrix V'
   */</span>
  <span class="keyword">def</span> <a title="(mat: scalala.tensor.dense.DenseMatrix[Double])(scalala.tensor.dense.DenseMatrix[Double], scalala.tensor.dense.DenseVector[Double], scalala.tensor.dense.DenseMatrix[Double])" id="20677">svd</a><span class="delimiter">(</span><a title="scalala.tensor.dense.DenseMatrix[Double]" id="219334">mat</a>: <a href="../tensor/dense/DenseMatrix.scala.html#19127" title="scalala.tensor.dense.DenseMatrix[Double]">DenseMatrix</a><span class="delimiter">[</span>Double<span class="delimiter">]</span><span class="delimiter">)</span>:<span title="(scalala.tensor.dense.DenseMatrix[Double], scalala.tensor.dense.DenseVector[Double], scalala.tensor.dense.DenseMatrix[Double])" class="delimiter">(</span>DenseMatrix<span class="delimiter">[</span>Double<span class="delimiter">]</span>,DenseVector<span class="delimiter">[</span>Double<span class="delimiter">]</span>,DenseMatrix<span class="delimiter">[</span>Double<span class="delimiter">]</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <a href="#20667" title="(mat: scalala.tensor.Matrix[Double])Unit">requireNonEmptyMatrix</a><span class="delimiter">(</span><a href="#219334" title="scalala.tensor.dense.DenseMatrix[Double]">mat</a><span class="delimiter">)</span>

    <span class="keyword">val</span> <a title="Int" id="219336">m</a> = <a href="#219334" title="scalala.tensor.dense.DenseMatrix[Double]">mat</a>.<a href="../tensor/dense/DenseMatrix.scala.html#64804" title="=&gt; Int">numRows</a>;
    <span class="keyword">val</span> <a title="Int" id="219337">n</a> = <a href="#219334" title="scalala.tensor.dense.DenseMatrix[Double]">mat</a>.<a href="../tensor/dense/DenseMatrix.scala.html#64806" title="=&gt; Int">numCols</a>;
    <span class="keyword">val</span> <a title="scalala.tensor.dense.DenseVectorCol[Double]" id="219338">S</a> = <a href="../tensor/dense/DenseVector.scala.html#19050" title="object scalala.tensor.dense.DenseVector">DenseVector</a>.<a href="../tensor/dense/DenseVector.scala.html#43294" title="[V](size: Int)(implicit s: scalala.scalar.Scalar[V])scalala.tensor.dense.DenseVectorCol[V]">zeros</a><span title="(size: Int)(implicit s: scalala.scalar.Scalar[Double])scalala.tensor.dense.DenseVectorCol[Double]" class="delimiter">[</span><span title="Double">Double</span><span class="delimiter">]</span><a href="../scalar/Scalar.scala.html#45343" title="object scalala.scalar.Scalar.scalarD" class="delimiter">(</a><a href="#219336" title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt">m</a> <span title="(that: Int)Int">min</span> <a href="#219337" title="Int">n</a><span class="delimiter">)</span>;
    <span class="keyword">val</span> <a title="scalala.tensor.dense.DenseMatrix[Double]" id="219339">U</a> = <a href="../tensor/dense/DenseMatrix.scala.html#19128" title="object scalala.tensor.dense.DenseMatrix">DenseMatrix</a>.<a href="../tensor/dense/DenseMatrix.scala.html#62269" title="[V](rows: Int, cols: Int)(implicit s: scalala.scalar.Scalar[V])scalala.tensor.dense.DenseMatrix[V]">zeros</a><span title="(rows: Int, cols: Int)(implicit s: scalala.scalar.Scalar[Double])scalala.tensor.dense.DenseMatrix[Double]" class="delimiter">[</span><span title="Double">Double</span><span class="delimiter">]</span><a href="../scalar/Scalar.scala.html#45343" title="object scalala.scalar.Scalar.scalarD" class="delimiter">(</a><a href="#219336" title="Int">m</a>,<a href="#219336" title="Int">m</a><span class="delimiter">)</span>;
    <span class="keyword">val</span> <a title="scalala.tensor.dense.DenseMatrix[Double]" id="219340">Vt</a> = <a href="../tensor/dense/DenseMatrix.scala.html#19128" title="object scalala.tensor.dense.DenseMatrix">DenseMatrix</a>.<a href="../tensor/dense/DenseMatrix.scala.html#62269" title="[V](rows: Int, cols: Int)(implicit s: scalala.scalar.Scalar[V])scalala.tensor.dense.DenseMatrix[V]">zeros</a><span title="(rows: Int, cols: Int)(implicit s: scalala.scalar.Scalar[Double])scalala.tensor.dense.DenseMatrix[Double]" class="delimiter">[</span><span title="Double">Double</span><span class="delimiter">]</span><a href="../scalar/Scalar.scala.html#45343" title="object scalala.scalar.Scalar.scalarD" class="delimiter">(</a><a href="#219337" title="Int">n</a>,<a href="#219337" title="Int">n</a><span class="delimiter">)</span>;
    <span class="keyword">val</span> <a title="Array[Int]" id="219341">iwork</a> = <span title="Array[Int]" class="keyword">new</span> <span title="Array[Int]">Array</span><span class="delimiter">[</span>Int<span class="delimiter">]</span><span class="delimiter">(</span><span title="Int(8)" class="int">8</span> <span title="(x: Int)Int">*</span> <span class="delimiter">(</span><a href="#219336" title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt">m</a> <span title="(that: Int)Int">min</span> <a href="#219337" title="Int">n</a><span class="delimiter">)</span> <span class="delimiter">)</span>;
    <span class="keyword">val</span> <a title="Int" id="219342">workSize</a> = <span class="delimiter">(</span> <span title="Int(3)" class="int">3</span>
                    <span title="(x: Int)Int">*</span> math.<span title="(x: Int, y: Int)Int">min</span><span class="delimiter">(</span><a href="#219336" title="Int">m</a>, <a href="#219337" title="Int">n</a><span class="delimiter">)</span>
                    <span title="(x: Int)Int">*</span> math.<span title="(x: Int, y: Int)Int">min</span><span class="delimiter">(</span><a href="#219336" title="Int">m</a>, <a href="#219337" title="Int">n</a><span class="delimiter">)</span>
                    <span title="(x: Int)Int">+</span> math.<span title="(x: Int, y: Int)Int">max</span><span class="delimiter">(</span>math.<span title="(x: Int, y: Int)Int">max</span><span class="delimiter">(</span><a href="#219336" title="Int">m</a>, <a href="#219337" title="Int">n</a><span class="delimiter">)</span>, <span title="Int(4)" class="int">4</span> <span title="(x: Int)Int">*</span> math.<span title="(x: Int, y: Int)Int">min</span><span class="delimiter">(</span><a href="#219336" title="Int">m</a>, <a href="#219337" title="Int">n</a><span class="delimiter">)</span>
                               <span title="(x: Int)Int">*</span> math.<span title="(x: Int, y: Int)Int">min</span><span class="delimiter">(</span><a href="#219336" title="Int">m</a>, <a href="#219337" title="Int">n</a><span class="delimiter">)</span> <span title="(x: Int)Int">+</span> <span title="Int(4)" class="int">4</span> <span title="(x: Int)Int">*</span> math.<span title="(x: Int, y: Int)Int">min</span><span class="delimiter">(</span><a href="#219336" title="Int">m</a>, <a href="#219337" title="Int">n</a><span class="delimiter">)</span><span class="delimiter">)</span>
                   <span class="delimiter">)</span>;
    <span class="keyword">val</span> <a title="Array[Double]" id="219343">work</a> = <span title="Array[Double]" class="keyword">new</span> <span title="Array[Double]">Array</span><span class="delimiter">[</span>Double<span class="delimiter">]</span><span class="delimiter">(</span><a href="#219342" title="Int">workSize</a><span class="delimiter">)</span>;
    <span class="keyword">val</span> <a title="org.netlib.util.intW" id="219344">info</a> = <span title="org.netlib.util.intW" class="keyword">new</span> <span title="org.netlib.util.intW">intW</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>;
    <span title="object org.netlib.lapack.LAPACK">LAPACK</span>.<span title="()org.netlib.lapack.LAPACK">getInstance</span>.<span title="(x$1: java.lang.String, x$2: Int, x$3: Int, x$4: Array[Double], x$5: Int, x$6: Array[Double], x$7: Array[Double], x$8: Int, x$9: Array[Double], x$10: Int, x$11: Array[Double], x$12: Int, x$13: Array[Int], x$14: org.netlib.util.intW)Unit">dgesdd</span><span class="delimiter">(</span>
      <span title="java.lang.String(&quot;A&quot;)" class="string">&quot;A&quot;</span>, <a href="#219336" title="Int">m</a>, <a href="#219337" title="Int">n</a>,
      <a href="#219334" title="scalala.tensor.dense.DenseMatrix[Double]">mat</a>.<a href="../tensor/dense/DenseMatrix.scala.html#64829" title="=&gt; scalala.tensor.dense.DenseMatrix[Double]">copy</a>.<a href="../tensor/dense/DenseMatrix.scala.html#64812" title="=&gt; Array[Double]">data</a>, math.<span title="(x: Int, y: Int)Int">max</span><span class="delimiter">(</span><span title="Int(1)" class="int">1</span>,<a href="#219336" title="Int">m</a><span class="delimiter">)</span>,
      <a href="#219338" title="scalala.tensor.dense.DenseVectorCol[Double]">S</a>.<a href="../tensor/dense/DenseVector.scala.html#43324" title="=&gt; Array[Double]">data</a>, <a href="#219339" title="scalala.tensor.dense.DenseMatrix[Double]">U</a>.<a href="../tensor/dense/DenseMatrix.scala.html#64812" title="=&gt; Array[Double]">data</a>, math.<span title="(x: Int, y: Int)Int">max</span><span class="delimiter">(</span><span title="Int(1)" class="int">1</span>,<a href="#219336" title="Int">m</a><span class="delimiter">)</span>,
      <a href="#219340" title="scalala.tensor.dense.DenseMatrix[Double]">Vt</a>.<a href="../tensor/dense/DenseMatrix.scala.html#64812" title="=&gt; Array[Double]">data</a>, math.<span title="(x: Int, y: Int)Int">max</span><span class="delimiter">(</span><span title="Int(1)" class="int">1</span>,<a href="#219337" title="Int">n</a><span class="delimiter">)</span>,
      <a href="#219343" title="Array[Double]">work</a>,<a href="#219343" title="Array[Double]">work</a>.<span title="=&gt; Int">length</span>,<a href="#219341" title="Array[Int]">iwork</a>, <a href="#219344" title="org.netlib.util.intW">info</a><span class="delimiter">)</span>;

    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#219344" title="org.netlib.util.intW">info</a>.<span title="Int">`val`</span> <span title="(x: Int)Boolean">&gt;</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
      <span title="Nothing" class="keyword">throw</span> <a href="#219315" title="scalala.library.NotConvergedException" class="keyword">new</a> <a href="#12511" title="scalala.library.NotConvergedException">NotConvergedException</a><span class="delimiter">(</span><a href="#366368" title="object scalala.library.NotConvergedException">NotConvergedException</a>.<a href="#219309" title="object scalala.library.NotConvergedException.Iterations">Iterations</a><span class="delimiter">)</span>
    <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#219344" title="org.netlib.util.intW">info</a>.<span title="Int">`val`</span> <span title="(x: Int)Boolean">&lt;</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
      <span title="Nothing" class="keyword">throw</span> <span title="java.lang.IllegalArgumentException" class="keyword">new</span> <span title="java.lang.IllegalArgumentException">IllegalArgumentException</span><span class="delimiter">(</span><span class="delimiter">)</span>

    <span title="(_1: scalala.tensor.dense.DenseMatrix[Double], _2: scalala.tensor.dense.DenseVectorCol[Double], _3: scalala.tensor.dense.DenseMatrix[Double])(scalala.tensor.dense.DenseMatrix[Double], scalala.tensor.dense.DenseVectorCol[Double], scalala.tensor.dense.DenseMatrix[Double])" class="delimiter">(</span><a href="#219339" title="scalala.tensor.dense.DenseMatrix[Double]">U</a>,<a href="#219338" title="scalala.tensor.dense.DenseVectorCol[Double]">S</a>,<a href="#219340" title="scalala.tensor.dense.DenseMatrix[Double]">Vt</a><span class="delimiter">)</span>;
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Returns the Kronecker product of the two matrices a and b,
   * usually denoted a ⊗ b.
   */</span>
  <span class="keyword">def</span> <a title="[V1, V2, RV](a: scalala.tensor.Matrix[V1], b: scalala.tensor.Matrix[V2])(implicit mul: scalala.operators.BinaryOp[V1,V2,scalala.operators.OpMul,RV], implicit s: scalala.scalar.Scalar[RV])scalala.tensor.Matrix[RV]" id="20678">kron</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="20682">V1</a>,<a title="&gt;: Nothing &lt;: Any" id="20683">V2</a>,<a title="&gt;: Nothing &lt;: Any" id="20684">RV</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="scalala.tensor.Matrix[V1]" id="219636">a</a> : <a href="../tensor/Matrix.scala.html#18329" title="scalala.tensor.Matrix[V1]">Matrix</a><span class="delimiter">[</span>V1<span class="delimiter">]</span>, <a title="scalala.tensor.Matrix[V2]" id="219637">b</a> : <a href="../tensor/Matrix.scala.html#18329" title="scalala.tensor.Matrix[V2]">Matrix</a><span class="delimiter">[</span>V2<span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scalala.operators.BinaryOp[V1,V2,scalala.operators.OpMul,RV]" id="219638">mul</a> : <a href="../operators/BinaryOp.scala.html#11910" title="scalala.operators.BinaryOp[V1,V2,scalala.operators.OpMul,RV]">BinaryOp</a><span class="delimiter">[</span>V1,V2,OpMul,RV<span class="delimiter">]</span>, <a title="scalala.scalar.Scalar[RV]" id="219639">s</a> : <a href="../scalar/Scalar.scala.html#17481" title="scalala.scalar.Scalar[RV]">Scalar</a><span class="delimiter">[</span>RV<span class="delimiter">]</span><span class="delimiter">)</span> : <a href="../tensor/Matrix.scala.html#18329" title="scalala.tensor.Matrix[RV]">Matrix</a><span class="delimiter">[</span>RV<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="scalala.tensor.generic.TensorBuilder[(Int, Int),RV,scalala.tensor.Tensor[(Int, Int),RV]]" id="219645">builder</a> = <a href="#219636" title="scalala.tensor.Matrix[V1]">a</a>.<a href="../tensor/Tensor.scala.html#42243" title="[NK, NV](domain: scalala.tensor.domain.IterableDomain[NK])(implicit scalar: scalala.scalar.Scalar[NV])scalala.tensor.generic.TensorBuilder[NK,NV,scalala.tensor.Tensor[NK,NV]]">newBuilder</a><span title="(domain: scalala.tensor.domain.IterableDomain[(Int, Int)])(implicit scalar: scalala.scalar.Scalar[RV])scalala.tensor.generic.TensorBuilder[(Int, Int),RV,scalala.tensor.Tensor[(Int, Int),RV]]" class="delimiter">[</span><span title="(Int, Int)" class="delimiter">(</span>Int,Int<span class="delimiter">)</span>,<a href="#20684" title="RV">RV</a><span class="delimiter">]</span><a href="#219639" title="scalala.scalar.Scalar[RV]" class="delimiter">(</a><a href="../tensor/domain/TableDomain.scala.html#56888" title="(numRows: Int, numCols: Int)scalala.tensor.domain.TableDomain">TableDomain</a><span class="delimiter">(</span><a href="#219636" title="scalala.tensor.Matrix[V1]">a</a>.<a href="../tensor/Matrix.scala.html#49654" title="=&gt; Int">numRows</a> <span title="(x: Int)Int">*</span> <a href="#219637" title="scalala.tensor.Matrix[V2]">b</a>.<a href="../tensor/Matrix.scala.html#49654" title="=&gt; Int">numRows</a>, <a href="#219636" title="scalala.tensor.Matrix[V1]">a</a>.<a href="../tensor/Matrix.scala.html#49655" title="=&gt; Int">numCols</a> <span title="(x: Int)Int">*</span> <a href="#219637" title="scalala.tensor.Matrix[V2]">b</a>.<a href="../tensor/Matrix.scala.html#49655" title="=&gt; Int">numCols</a><span class="delimiter">)</span><span class="delimiter">)</span>;
    <a href="#219636" title="scalala.tensor.Matrix[V1]">a</a>.<a href="../tensor/Tensor2.scala.html#44428" title="(fn: (Int, Int, V1) =&gt; Boolean)Boolean">foreachNonZeroTriple</a><span class="delimiter">(</span><span class="delimiter">(</span><a title="Int" id="219667">ai</a>,<a title="Int" id="219668">aj</a>,<a title="V1" id="219669">av</a><span class="delimiter">)</span> =&gt; <a href="#219637" title="scalala.tensor.Matrix[V2]">b</a>.<a href="../tensor/Tensor2.scala.html#44428" title="(fn: (Int, Int, V2) =&gt; Unit)Boolean">foreachNonZeroTriple</a><span class="delimiter">(</span><span class="delimiter">(</span><a title="Int" id="219674">bi</a>,<a title="Int" id="219675">bj</a>,<a title="V2" id="219676">bv</a><span class="delimiter">)</span> =&gt;
      <a href="../tensor/generic/TensorBuilder.scala.html#42139" title="(key: (Int, Int), value: RV)Unit">builder</a><span class="delimiter">(</span><span title="(_1: Int, _2: Int)(Int, Int)" class="delimiter">(</span><a href="#219667" title="Int">ai</a> <span title="(x: Int)Int">*</span> <a href="#219637" title="scalala.tensor.Matrix[V2]">b</a>.<a href="../tensor/Matrix.scala.html#49654" title="=&gt; Int">numRows</a> <span title="(x: Int)Int">+</span> <a href="#219674" title="Int">bi</a>, <a href="#219668" title="Int">aj</a> <span title="(x: Int)Int">*</span> <a href="#219637" title="scalala.tensor.Matrix[V2]">b</a>.<a href="../tensor/Matrix.scala.html#49655" title="=&gt; Int">numCols</a> <span title="(x: Int)Int">+</span> <a href="#219675" title="Int">bj</a><span class="delimiter">)</span><span class="delimiter">)</span> = <a href="#219638" title="(v1: V1, v2: V2)RV">mul</a><span class="delimiter">(</span><a href="#219669" title="V1">av</a>, <a href="#219676" title="V2">bv</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>;
    <a href="#219645" title="scalala.tensor.generic.TensorBuilder[(Int, Int),RV,scalala.tensor.Tensor[(Int, Int),RV]]">builder</a>.<a href="../tensor/generic/TensorBuilder.scala.html#42140" title="=&gt; scalala.tensor.Tensor[(Int, Int),RV]">result</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="scalala.tensor.Matrix[RV]" class="delimiter">[</span><a href="../tensor/Matrix.scala.html#18329" title="scalala.tensor.Matrix[RV]">Matrix</a><span class="delimiter">[</span>RV<span class="delimiter">]</span><span class="delimiter">]</span>;
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Returns the rank of each element in the given vector, adjusting for
   * ties.
   */</span>
  <span class="keyword">def</span> <a title="[X, V](x: X)(implicit xvt: scalala.generic.collection.CanViewAsVector[X,V], implicit ord: Ordering[V])Array[Double]" id="20685">ranks</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="20688">X</a>,<a title="&gt;: Nothing &lt;: Any" id="20689">V</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="X" id="219705">x</a> : <a href="#20688" title="X">X</a><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scalala.generic.collection.CanViewAsVector[X,V]" id="219706">xvt</a> : <a href="../generic/collection/CanViewAsVector.scala.html#9879" title="scalala.generic.collection.CanViewAsVector[X,V]">CanViewAsVector</a><span class="delimiter">[</span>X,V<span class="delimiter">]</span>, <a title="Ordering[V]" id="219707">ord</a> : <span title="Ordering[V]">Ordering</span><span class="delimiter">[</span>V<span class="delimiter">]</span><span class="delimiter">)</span> : <span title="Array[Double]">Array</span><span class="delimiter">[</span>Double<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="scalala.tensor.Vector[V]" id="219712">a</a> = <a href="../generic/collection/CanViewAsVector.scala.html#50505" title="(from: X)scalala.tensor.Vector[V]">xvt</a><span class="delimiter">(</span><a href="#219705" title="X">x</a><span class="delimiter">)</span>;
    <span class="keyword">val</span> <a title="List[Int]" id="219713">as</a> = <a href="#219712" title="scalala.tensor.Vector[V]">a</a>.<a href="../tensor/Tensor.scala.html#42367" title="(implicit ord: Ordering[V])List[Int]">argsort</a>;
    <span class="keyword">val</span> <a title="Array[Double]" id="219714">rv</a> = <span title="Array[Double]" class="keyword">new</span> <span title="Array[Double]">Array</span><span class="delimiter">[</span>Double<span class="delimiter">]</span><span class="delimiter">(</span><a href="#219713" title="List[Int]">as</a>.<span title="=&gt; Int">length</span><span class="delimiter">)</span>;
    <span class="keyword">var</span> <a title="Int" id="219715">i</a> = <span title="Int(0)" class="int">0</span>;
    <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><a href="#219715" title="Int">i</a> <span title="(x: Int)Boolean">&lt;</span> <a href="#219713" title="List[Int]">as</a>.<span title="=&gt; Int">length</span><span class="delimiter">)</span> <a href="#219716" title="()Unit" class="delimiter">{</a>
      <span class="comment">// count number of tied values at rank i</span>
      <span class="keyword">var</span> <a title="Int" id="219727">numTiedValuesAtI</a> = <span title="Int(1)" class="int">1</span>;
      <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><a href="#219715" title="Int">i</a> <span title="(x: Int)Int">+</span> <a href="#219727" title="Int">numTiedValuesAtI</a> <span title="(x: Int)Boolean">&lt;</span> <a href="#219713" title="List[Int]">as</a>.<span title="=&gt; Int">length</span> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="../tensor/Tensor.scala.html#42342" title="(key: Int)V">a</a><span class="delimiter">(</span><a href="#219713" title="(n: Int)Int">as</a><span class="delimiter">(</span><a href="#219715" title="Int">i</a> <span title="(x: Int)Int">+</span> <a href="#219727" title="Int">numTiedValuesAtI</a><span class="delimiter">)</span><span class="delimiter">)</span> <span title="(x$1: Any)Boolean">==</span> <a href="../tensor/Tensor.scala.html#42342" title="(key: Int)V">a</a><span class="delimiter">(</span><a href="#219713" title="(n: Int)Int">as</a><span class="delimiter">(</span><a href="#219715" title="Int">i</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#219727" title="Int">numTiedValuesAtI</a> <a href="#219730" title="(x: Int)Int">+=</a> <span title="Int(1)" class="int">1</span>;
      <span class="delimiter">}</span>

      <span class="comment">// set return value for next numTiedValuesAtI indexes in as</span>
      <span class="keyword">val</span> <a title="Double" id="219728">rank</a> = <span title="Int(1)" class="int">1</span> <span title="(x: Int)Int">+</span> <a href="#219715" title="Int">i</a> <span title="(x: Double)Double">+</span> <span class="delimiter">(</span><a href="#219727" title="Int">numTiedValuesAtI</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span> <span title="(x: Double)Double">/</span> <span title="Double(2.0)" class="double">2.0</span>;
      <span class="keyword">var</span> <a title="Int" id="219729">j</a> = <span title="Int(0)" class="int">0</span>;
      <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><a href="#219729" title="Int">j</a> <span title="(x: Int)Boolean">&lt;</span> <a href="#219727" title="Int">numTiedValuesAtI</a><span class="delimiter">)</span> <a href="#219731" title="()Unit" class="delimiter">{</a>
        <a href="#219714" title="(i: Int, x: Double)Unit">rv</a><span class="delimiter">(</span><a href="#219713" title="(n: Int)Int">as</a><span class="delimiter">(</span><a href="#219715" title="Int">i</a> <span title="(x: Int)Int">+</span> <a href="#219729" title="Int">j</a><span class="delimiter">)</span><span class="delimiter">)</span> = <a href="#219728" title="Double">rank</a>;
        <a href="#219729" title="Int">j</a> <span title="(x: Int)Int">+=</span> <span title="Int(1)" class="int">1</span>;
      <span class="delimiter">}</span>

      <a href="#219715" title="Int">i</a> <span title="(x: Int)Int">+=</span> <a href="#219727" title="Int">numTiedValuesAtI</a>;
    <span class="delimiter">}</span>

    <a href="#219714" title="Array[Double]">rv</a>;
  <span class="delimiter">}</span>

  <span class="comment">/**
   * The lower triangular portion of the given real quadratic matrix X. Note
   * that no check will be performed regarding the symmetry of X.
   */</span>
  <span class="keyword">def</span> <a title="[T](X: scalala.tensor.Matrix[T])(implicit evidence$1: scalala.scalar.Scalar[T])scalala.tensor.dense.DenseMatrix[T]" id="220024">lowerTriangular</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="20692">T</a>: Scalar<span class="delimiter">]</span><span class="delimiter">(</span><a title="scalala.tensor.Matrix[T]" id="220023">X</a>: <a href="../tensor/Matrix.scala.html#18329" title="scalala.tensor.Matrix[T]">Matrix</a><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../tensor/dense/DenseMatrix.scala.html#19127" title="scalala.tensor.dense.DenseMatrix[T]">DenseMatrix</a><span class="delimiter">[</span>T<span class="delimiter">]</span> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="Int" id="220028">N</a> = <a href="#220023" title="scalala.tensor.Matrix[T]">X</a>.<a href="../tensor/Matrix.scala.html#49654" title="=&gt; Int">numRows</a>
      <span class="keyword">val</span> <a title="scalala.tensor.generic.TensorBuilder[(Int, Int),T,scalala.tensor.Tensor[(Int, Int),T]]" id="220029">builder</a> = <a href="#220023" title="scalala.tensor.Matrix[T]">X</a>.<a href="../tensor/Tensor.scala.html#42243" title="[NK, NV](domain: scalala.tensor.domain.IterableDomain[NK])(implicit scalar: scalala.scalar.Scalar[NV])scalala.tensor.generic.TensorBuilder[NK,NV,scalala.tensor.Tensor[NK,NV]]">newBuilder</a><span title="(domain: scalala.tensor.domain.IterableDomain[(Int, Int)])(implicit scalar: scalala.scalar.Scalar[T])scalala.tensor.generic.TensorBuilder[(Int, Int),T,scalala.tensor.Tensor[(Int, Int),T]]" class="delimiter">[</span><span title="(Int, Int)" class="delimiter">(</span>Int, Int<span class="delimiter">)</span>, <a href="#20692" title="T">T</a><span class="delimiter">]</span><a href="#220024" title="scalala.scalar.Scalar[T]" class="delimiter">(</a><a href="../tensor/domain/TableDomain.scala.html#56888" title="(numRows: Int, numCols: Int)scalala.tensor.domain.TableDomain">TableDomain</a><span class="delimiter">(</span><a href="#220028" title="Int">N</a>, <a href="#220028" title="Int">N</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">for</span> <span class="delimiter">(</span><a title="Int" id="220135">i</a> &lt;- <span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">0</span> <span title="(f: Int =&gt; Unit)Unit">until</span> <a href="#220028" title="Int">N</a>; <a title="Int" id="220272">j</a> &lt;- <span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">0</span> <span title="(f: Int =&gt; Unit)Unit">to</span> <a href="#220135" title="Int">i</a><span class="delimiter">)</span>
        <a href="../tensor/generic/TensorBuilder.scala.html#42139" title="(key: (Int, Int), value: T)Unit">builder</a><span class="delimiter">(</span><span title="(_1: Int, _2: Int)(Int, Int)" class="delimiter">(</span><a href="#220135" title="Int">i</a>,<a href="#220272" title="Int">j</a><span class="delimiter">)</span><span class="delimiter">)</span> = <a href="../tensor/Tensor2.scala.html#44382" title="(i: Int, j: Int)T">X</a><span class="delimiter">(</span><a href="#220135" title="Int">i</a>,<a href="#220272" title="Int">j</a><span class="delimiter">)</span>
      <a href="#220029" title="scalala.tensor.generic.TensorBuilder[(Int, Int),T,scalala.tensor.Tensor[(Int, Int),T]]">builder</a>.<a href="../tensor/generic/TensorBuilder.scala.html#42140" title="=&gt; scalala.tensor.Tensor[(Int, Int),T]">result</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="scalala.tensor.dense.DenseMatrix[T]" class="delimiter">[</span><a href="../tensor/dense/DenseMatrix.scala.html#19127" title="scalala.tensor.dense.DenseMatrix[T]">DenseMatrix</a><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">]</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * The upper triangular portion of the given real quadratic matrix X. Note
   * that no check will be performed regarding the symmetry of X.
   */</span>
  <span class="keyword">def</span> <a title="[T](X: scalala.tensor.Matrix[T])(implicit evidence$2: scalala.scalar.Scalar[T])scalala.tensor.dense.DenseMatrix[T]" id="221055">upperTriangular</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="20695">T</a>: Scalar<span class="delimiter">]</span><span class="delimiter">(</span><a title="scalala.tensor.Matrix[T]" id="221054">X</a>: <a href="../tensor/Matrix.scala.html#18329" title="scalala.tensor.Matrix[T]">Matrix</a><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../tensor/dense/DenseMatrix.scala.html#19127" title="scalala.tensor.dense.DenseMatrix[T]">DenseMatrix</a><span class="delimiter">[</span>T<span class="delimiter">]</span> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="Int" id="221059">N</a> = <a href="#221054" title="scalala.tensor.Matrix[T]">X</a>.<a href="../tensor/Matrix.scala.html#49654" title="=&gt; Int">numRows</a>
      <span class="keyword">val</span> <a title="scalala.tensor.generic.TensorBuilder[(Int, Int),T,scalala.tensor.Tensor[(Int, Int),T]]" id="221060">builder</a> = <a href="#221054" title="scalala.tensor.Matrix[T]">X</a>.<a href="../tensor/Tensor.scala.html#42243" title="[NK, NV](domain: scalala.tensor.domain.IterableDomain[NK])(implicit scalar: scalala.scalar.Scalar[NV])scalala.tensor.generic.TensorBuilder[NK,NV,scalala.tensor.Tensor[NK,NV]]">newBuilder</a><span title="(domain: scalala.tensor.domain.IterableDomain[(Int, Int)])(implicit scalar: scalala.scalar.Scalar[T])scalala.tensor.generic.TensorBuilder[(Int, Int),T,scalala.tensor.Tensor[(Int, Int),T]]" class="delimiter">[</span><span title="(Int, Int)" class="delimiter">(</span>Int, Int<span class="delimiter">)</span>, <a href="#20695" title="T">T</a><span class="delimiter">]</span><a href="#221055" title="scalala.scalar.Scalar[T]" class="delimiter">(</a><a href="../tensor/domain/TableDomain.scala.html#56888" title="(numRows: Int, numCols: Int)scalala.tensor.domain.TableDomain">TableDomain</a><span class="delimiter">(</span><a href="#221059" title="Int">N</a>, <a href="#221059" title="Int">N</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">for</span> <span class="delimiter">(</span><a title="Int" id="221166">i</a> &lt;- <span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">0</span> <span title="(f: Int =&gt; Unit)Unit">until</span> <a href="#221059" title="Int">N</a>; <a title="Int" id="221233">j</a> &lt;- <a href="#221166" title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt">i</a> <span title="(f: Int =&gt; Unit)Unit">until</span> <a href="#221059" title="Int">N</a><span class="delimiter">)</span>
        <a href="../tensor/generic/TensorBuilder.scala.html#42139" title="(key: (Int, Int), value: T)Unit">builder</a><span class="delimiter">(</span><span title="(_1: Int, _2: Int)(Int, Int)" class="delimiter">(</span><a href="#221166" title="Int">i</a>,<a href="#221233" title="Int">j</a><span class="delimiter">)</span><span class="delimiter">)</span> = <a href="../tensor/Tensor2.scala.html#44382" title="(i: Int, j: Int)T">X</a><span class="delimiter">(</span><a href="#221166" title="Int">i</a>,<a href="#221233" title="Int">j</a><span class="delimiter">)</span>
      <a href="#221060" title="scalala.tensor.generic.TensorBuilder[(Int, Int),T,scalala.tensor.Tensor[(Int, Int),T]]">builder</a>.<a href="../tensor/generic/TensorBuilder.scala.html#42140" title="=&gt; scalala.tensor.Tensor[(Int, Int),T]">result</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="scalala.tensor.dense.DenseMatrix[T]" class="delimiter">[</span><a href="../tensor/dense/DenseMatrix.scala.html#19127" title="scalala.tensor.dense.DenseMatrix[T]">DenseMatrix</a><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">]</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Computes the cholesky decomposition A of the given real symmetric
   * positive definite matrix X such that X = A A^T.
   *
   * XXX: For higher dimensionalities, the return value really should be a
   *      sparse matrix due to its inherent lower triangular nature.
   */</span>
  <span class="keyword">def</span> <a title="(X: scalala.tensor.Matrix[Double])scalala.tensor.dense.DenseMatrix[Double]" id="20696">cholesky</a><span class="delimiter">(</span><a title="scalala.tensor.Matrix[Double]" id="222015">X</a>: <a href="../tensor/Matrix.scala.html#18329" title="scalala.tensor.Matrix[Double]">Matrix</a><span class="delimiter">[</span>Double<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../tensor/dense/DenseMatrix.scala.html#19127" title="scalala.tensor.dense.DenseMatrix[Double]">DenseMatrix</a><span class="delimiter">[</span>Double<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <a href="#20667" title="(mat: scalala.tensor.Matrix[Double])Unit">requireNonEmptyMatrix</a><span class="delimiter">(</span><a href="#222015" title="scalala.tensor.Matrix[Double]">X</a><span class="delimiter">)</span>

    <span class="comment">// As LAPACK doesn't check if the given matrix is in fact symmetric,</span>
    <span class="comment">// we have to do it here (or get rid of this time-waster as long as</span>
    <span class="comment">// the caller of this function is clearly aware that only the lower</span>
    <span class="comment">// triangular portion of the given matrix is used and there is no</span>
    <span class="comment">// check for symmetry).</span>
    <a href="#20673" title="(mat: scalala.tensor.Matrix[Double])Unit">requireSymmetricMatrix</a><span class="delimiter">(</span><a href="#222015" title="scalala.tensor.Matrix[Double]">X</a><span class="delimiter">)</span>

    <span class="comment">// Copy the lower triangular part of X. LAPACK will store the result in A</span>
    <span class="keyword">val</span> <a title="scalala.tensor.dense.DenseMatrix[Double]" id="222017">A</a>: <a href="../tensor/dense/DenseMatrix.scala.html#19127" title="scalala.tensor.dense.DenseMatrix[Double]">DenseMatrix</a><span class="delimiter">[</span>Double<span class="delimiter">]</span> = <a href="#220024" title="(X: scalala.tensor.Matrix[Double])(implicit evidence$1: scalala.scalar.Scalar[Double])scalala.tensor.dense.DenseMatrix[Double]">lowerTriangular</a><a href="../scalar/Scalar.scala.html#45343" title="object scalala.scalar.Scalar.scalarD" class="delimiter">(</a><a href="#222015" title="scalala.tensor.Matrix[Double]">X</a><span class="delimiter">)</span>

    <span class="keyword">val</span> <a title="Int" id="222018">N</a> = <a href="#222015" title="scalala.tensor.Matrix[Double]">X</a>.<a href="../tensor/Matrix.scala.html#49654" title="=&gt; Int">numRows</a>
    <span class="keyword">val</span> <a title="org.netlib.util.intW" id="222019">info</a> = <span title="org.netlib.util.intW" class="keyword">new</span> <span title="org.netlib.util.intW">intW</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
    <span title="object org.netlib.lapack.LAPACK">LAPACK</span>.<span title="()org.netlib.lapack.LAPACK">getInstance</span>.<span title="(x$1: java.lang.String, x$2: Int, x$3: Array[Double], x$4: Int, x$5: org.netlib.util.intW)Unit">dpotrf</span><span class="delimiter">(</span>
      <span title="java.lang.String(&quot;L&quot;)" class="string">&quot;L&quot;</span> <span class="comment">/* lower triangular */</span>,
      <a href="#222018" title="Int">N</a> <span class="comment">/* number of rows */</span>, <a href="#222017" title="scalala.tensor.dense.DenseMatrix[Double]">A</a>.<a href="../tensor/dense/DenseMatrix.scala.html#64812" title="=&gt; Array[Double]">data</a>, math.<span title="(x: Int, y: Int)Int">max</span><span class="delimiter">(</span><span title="Int(1)" class="int">1</span>, <a href="#222018" title="Int">N</a><span class="delimiter">)</span> <span class="comment">/* LDA */</span>,
      <a href="#222019" title="org.netlib.util.intW">info</a>
    <span class="delimiter">)</span>
    <span class="comment">// A value of info.`val` &lt; 0 would tell us that the i-th argument</span>
    <span class="comment">// of the call to dpotrf was erroneous (where i == |info.`val`|).</span>
    <span title="(assertion: Boolean)Unit">assert</span><span class="delimiter">(</span><a href="#222019" title="org.netlib.util.intW">info</a>.<span title="Int">`val`</span> <span title="(x: Int)Boolean">&gt;=</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>

    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#222019" title="org.netlib.util.intW">info</a>.<span title="Int">`val`</span> <span title="(x: Int)Boolean">&gt;</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
      <span title="Nothing" class="keyword">throw</span> <a href="#219315" title="scalala.library.NotConvergedException" class="keyword">new</a> <a href="#12511" title="scalala.library.NotConvergedException">NotConvergedException</a><span class="delimiter">(</span><a href="#366368" title="object scalala.library.NotConvergedException">NotConvergedException</a>.<a href="#219309" title="object scalala.library.NotConvergedException.Iterations">Iterations</a><span class="delimiter">)</span>

    <a href="#222017" title="scalala.tensor.dense.DenseMatrix[Double]">A</a>
  <span class="delimiter">}</span>

 <span class="comment">/**
  * QR Factorization with pivoting
  *
  * input: A m x n matrix
  * output: (Q,R,P,pvt) where AP = QR
  *   Q: m x m
  *   R: m x n
  *   P: n x n : permutation matrix (P(pvt(i),i) = 1)
  *   pvt : pivot indices
  */</span>
  <span class="keyword">def</span> <a title="(A: scalala.tensor.dense.DenseMatrix[Double])(scalala.tensor.dense.DenseMatrix[Double], scalala.tensor.dense.DenseMatrix[Double], scalala.tensor.dense.DenseMatrix[Int], Array[Int])" id="20697">qrp</a><span class="delimiter">(</span><a title="scalala.tensor.dense.DenseMatrix[Double]" id="222055">A</a>: <a href="../tensor/dense/DenseMatrix.scala.html#19127" title="scalala.tensor.dense.DenseMatrix[Double]">DenseMatrix</a><span class="delimiter">[</span>Double<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="(scalala.tensor.dense.DenseMatrix[Double], scalala.tensor.dense.DenseMatrix[Double], scalala.tensor.dense.DenseMatrix[Int], Array[Int])" class="delimiter">(</span>DenseMatrix<span class="delimiter">[</span>Double<span class="delimiter">]</span>, DenseMatrix<span class="delimiter">[</span>Double<span class="delimiter">]</span>, DenseMatrix<span class="delimiter">[</span>Int<span class="delimiter">]</span>, Array<span class="delimiter">[</span>Int<span class="delimiter">]</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Int" id="222057">m</a> = <a href="#222055" title="scalala.tensor.dense.DenseMatrix[Double]">A</a>.<a href="../tensor/dense/DenseMatrix.scala.html#64804" title="=&gt; Int">numRows</a>
    <span class="keyword">val</span> <a title="Int" id="222058">n</a> = <a href="#222055" title="scalala.tensor.dense.DenseMatrix[Double]">A</a>.<a href="../tensor/dense/DenseMatrix.scala.html#64806" title="=&gt; Int">numCols</a>
    <span class="keyword">val</span> <a title="org.netlib.lapack.LAPACK" id="222059">lapack</a> = <span title="object org.netlib.lapack.LAPACK">LAPACK</span>.<span title="()org.netlib.lapack.LAPACK">getInstance</span><span class="delimiter">(</span><span class="delimiter">)</span>;

    <span class="comment">//Get optimal workspace size</span>
    <span class="comment">// we do this by sending -1 as lwork to the lapack function</span>
    <span class="keyword">val</span> <a title="Array[Double]" id="222060">work</a> = <span title="Array[Double]" class="keyword">new</span> <span title="Array[Double]">Array</span><span class="delimiter">[</span>Double<span class="delimiter">]</span><span class="delimiter">(</span><span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
    <span class="keyword">var</span> <a title="org.netlib.util.intW" id="222061">info</a> = <span title="org.netlib.util.intW" class="keyword">new</span> <span title="org.netlib.util.intW">intW</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
    <a href="#222059" title="org.netlib.lapack.LAPACK">lapack</a>.<span title="(x$1: Int, x$2: Int, x$3: Array[Double], x$4: Int, x$5: Array[Double], x$6: Array[Double], x$7: Int, x$8: org.netlib.util.intW)Unit">dgeqrf</span><span class="delimiter">(</span><a href="#222057" title="Int">m</a>, <a href="#222058" title="Int">n</a>, <span title="Null(null)" class="keyword">null</span>, <a href="#222057" title="Int">m</a>, <span title="Null(null)" class="keyword">null</span>, <a href="#222060" title="Array[Double]">work</a>, -<span title="Int(-1)" class="int">1</span>, <a href="#222061" title="org.netlib.util.intW">info</a><span class="delimiter">)</span>;
    <span class="keyword">val</span> <a title="Int" id="222062">lwork1</a> = <span title="Int" class="keyword">if</span><span class="delimiter">(</span><a href="#222061" title="org.netlib.util.intW">info</a>.<span title="Int">`val`</span> <span title="(x: Int)Boolean">!=</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <a href="#222058" title="Int">n</a> <span class="keyword">else</span> <a href="#222060" title="(i: Int)Double">work</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>.<span title="=&gt; Int">toInt</span>
    <a href="#222059" title="org.netlib.lapack.LAPACK">lapack</a>.<span title="(x$1: Int, x$2: Int, x$3: Int, x$4: Array[Double], x$5: Int, x$6: Array[Double], x$7: Array[Double], x$8: Int, x$9: org.netlib.util.intW)Unit">dorgqr</span><span class="delimiter">(</span><a href="#222057" title="Int">m</a>, <a href="#222057" title="Int">m</a>, math.<span title="(x: Int, y: Int)Int">min</span><span class="delimiter">(</span><a href="#222057" title="Int">m</a>,<a href="#222058" title="Int">n</a><span class="delimiter">)</span>, <span title="Null(null)" class="keyword">null</span>, <a href="#222057" title="Int">m</a>, <span title="Null(null)" class="keyword">null</span>, <a href="#222060" title="Array[Double]">work</a>, -<span title="Int(-1)" class="int">1</span>, <a href="#222061" title="org.netlib.util.intW">info</a><span class="delimiter">)</span>;
    <span class="keyword">val</span> <a title="Int" id="222063">lwork2</a> = <span title="Int" class="keyword">if</span><span class="delimiter">(</span><a href="#222061" title="org.netlib.util.intW">info</a>.<span title="Int">`val`</span> <span title="(x: Int)Boolean">!=</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <a href="#222058" title="Int">n</a> <span class="keyword">else</span> <a href="#222060" title="(i: Int)Double">work</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>.<span title="=&gt; Int">toInt</span>;
    <span class="comment">//allocate workspace mem. as max of lwork1 and lwork3</span>
    <span class="keyword">val</span> <a title="Array[Double]" id="222064">workspace</a> = <span title="Array[Double]" class="keyword">new</span> <span title="Array[Double]">Array</span><span class="delimiter">[</span>Double<span class="delimiter">]</span><span class="delimiter">(</span>math.<span title="(x: Int, y: Int)Int">max</span><span class="delimiter">(</span><a href="#222062" title="Int">lwork1</a>, <a href="#222063" title="Int">lwork2</a><span class="delimiter">)</span><span class="delimiter">)</span>;

    <span class="comment">//Perform the QR factorization with dgep3</span>
    <span class="keyword">val</span> <a title="Int" id="222065">maxd</a> = math.<span title="(x: Int, y: Int)Int">max</span><span class="delimiter">(</span><a href="#222057" title="Int">m</a>,<a href="#222058" title="Int">n</a><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="scalala.tensor.dense.DenseMatrix[Double]" id="222066">AFact</a> = <a href="../tensor/dense/DenseMatrix.scala.html#19128" title="object scalala.tensor.dense.DenseMatrix">DenseMatrix</a>.<a href="../tensor/dense/DenseMatrix.scala.html#62269" title="[V](rows: Int, cols: Int)(implicit s: scalala.scalar.Scalar[V])scalala.tensor.dense.DenseMatrix[V]">zeros</a><span title="(rows: Int, cols: Int)(implicit s: scalala.scalar.Scalar[Double])scalala.tensor.dense.DenseMatrix[Double]" class="delimiter">[</span><span title="Double">Double</span><span class="delimiter">]</span><a href="../scalar/Scalar.scala.html#45343" title="object scalala.scalar.Scalar.scalarD" class="delimiter">(</a><a href="#222057" title="Int">m</a>,<a href="#222065" title="Int">maxd</a><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="Array[Int]" id="222067">pvt</a> = <span title="Array[Int]" class="keyword">new</span> <span title="Array[Int]">Array</span><span class="delimiter">[</span>Int<span class="delimiter">]</span><span class="delimiter">(</span><a href="#222058" title="Int">n</a><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="Array[Double]" id="222068">tau</a> = <span title="Array[Double]" class="keyword">new</span> <span title="Array[Double]">Array</span><span class="delimiter">[</span>Double<span class="delimiter">]</span><span class="delimiter">(</span>math.<span title="(x: Int, y: Int)Int">min</span><span class="delimiter">(</span><a href="#222057" title="Int">m</a>,<a href="#222058" title="Int">n</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="keyword">for</span><span class="delimiter">(</span><a title="Int" id="222216">r</a> &lt;- <span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">0</span> <span title="(f: Int =&gt; Unit)Unit">until</span> <a href="#222057" title="Int">m</a>; <a title="Int" id="222316">c</a> &lt;- <span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">0</span> <span title="(f: Int =&gt; Unit)Unit">until</span> <a href="#222058" title="Int">n</a><span class="delimiter">)</span> <a href="../tensor/dense/DenseMatrix.scala.html#64820" title="(row: Int, col: Int, value: Double)Unit">AFact</a><span class="delimiter">(</span><a href="#222216" title="Int">r</a>,<a href="#222316" title="Int">c</a><span class="delimiter">)</span> = <a href="../tensor/dense/DenseMatrix.scala.html#64819" title="(row: Int, col: Int)Double">A</a><span class="delimiter">(</span><a href="#222216" title="Int">r</a>,<a href="#222316" title="Int">c</a><span class="delimiter">)</span>
      <a href="#222059" title="org.netlib.lapack.LAPACK">lapack</a>.<span title="(x$1: Int, x$2: Int, x$3: Array[Double], x$4: Int, x$5: Array[Int], x$6: Array[Double], x$7: Array[Double], x$8: Int, x$9: org.netlib.util.intW)Unit">dgeqp3</span><span class="delimiter">(</span><a href="#222057" title="Int">m</a>, <a href="#222058" title="Int">n</a>, <a href="#222066" title="scalala.tensor.dense.DenseMatrix[Double]">AFact</a>.<a href="../tensor/dense/DenseMatrix.scala.html#64812" title="=&gt; Array[Double]">data</a>, <a href="#222057" title="Int">m</a>, <a href="#222067" title="Array[Int]">pvt</a>, <a href="#222068" title="Array[Double]">tau</a>, <a href="#222064" title="Array[Double]">workspace</a>, <a href="#222064" title="Array[Double]">workspace</a>.<span title="=&gt; Int">length</span>, <a href="#222061" title="org.netlib.util.intW">info</a><span class="delimiter">)</span>;

    <span class="comment">//Error check</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#222061" title="org.netlib.util.intW">info</a>.<span title="Int">`val`</span> <span title="(x: Int)Boolean">&gt;</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
      <span title="Nothing" class="keyword">throw</span> <a href="#219315" title="scalala.library.NotConvergedException" class="keyword">new</a> <a href="#12511" title="scalala.library.NotConvergedException">NotConvergedException</a><span class="delimiter">(</span><a href="#366368" title="object scalala.library.NotConvergedException">NotConvergedException</a>.<a href="#219309" title="object scalala.library.NotConvergedException.Iterations">Iterations</a><span class="delimiter">)</span>
    <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#222061" title="org.netlib.util.intW">info</a>.<span title="Int">`val`</span> <span title="(x: Int)Boolean">&lt;</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
      <span title="Nothing" class="keyword">throw</span> <span title="java.lang.IllegalArgumentException" class="keyword">new</span> <span title="java.lang.IllegalArgumentException">IllegalArgumentException</span><span class="delimiter">(</span><span class="delimiter">)</span>

    <span class="comment">//Get R</span>
    <span class="keyword">val</span> <a title="scalala.tensor.dense.DenseMatrix[Double]" id="222069">R</a> = <a href="../tensor/dense/DenseMatrix.scala.html#19128" title="object scalala.tensor.dense.DenseMatrix">DenseMatrix</a>.<a href="../tensor/dense/DenseMatrix.scala.html#62269" title="[V](rows: Int, cols: Int)(implicit s: scalala.scalar.Scalar[V])scalala.tensor.dense.DenseMatrix[V]">zeros</a><span title="(rows: Int, cols: Int)(implicit s: scalala.scalar.Scalar[Double])scalala.tensor.dense.DenseMatrix[Double]" class="delimiter">[</span><span title="Double">Double</span><span class="delimiter">]</span><a href="../scalar/Scalar.scala.html#45343" title="object scalala.scalar.Scalar.scalarD" class="delimiter">(</a><a href="#222057" title="Int">m</a>,<a href="#222058" title="Int">n</a><span class="delimiter">)</span>

    <span class="keyword">for</span><span class="delimiter">(</span><a title="Int" id="223602">c</a> &lt;- <span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">0</span> <span title="(f: Int =&gt; Unit)Unit">until</span> <a href="#222065" title="Int">maxd</a> <span class="keyword">if</span><span class="delimiter">(</span><a href="#223602" title="Int">c</a> <span title="(x: Int)Boolean">&lt;</span> <a href="#222058" title="Int">n</a><span class="delimiter">)</span>;
        <a title="Int" id="223696">r</a> &lt;- <span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">0</span> <span title="(f: Int =&gt; Unit)Unit">until</span> <a href="#222057" title="Int">m</a> <span class="keyword">if</span><span class="delimiter">(</span><a href="#223696" title="Int">r</a> <span title="(x: Int)Boolean">&lt;=</span> <a href="#223602" title="Int">c</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <a href="../tensor/dense/DenseMatrix.scala.html#64820" title="(row: Int, col: Int, value: Double)Unit">R</a><span class="delimiter">(</span><a href="#223696" title="Int">r</a>,<a href="#223602" title="Int">c</a><span class="delimiter">)</span> = <a href="../tensor/dense/DenseMatrix.scala.html#64819" title="(row: Int, col: Int)Double">AFact</a><span class="delimiter">(</span><a href="#223696" title="Int">r</a>,<a href="#223602" title="Int">c</a><span class="delimiter">)</span>

    <span class="comment">//Get Q from the matrix returned by dgep3</span>
    <span class="keyword">val</span> <a title="scalala.tensor.dense.DenseMatrix[Double]" id="222070">Q</a> = <a href="../tensor/dense/DenseMatrix.scala.html#19128" title="object scalala.tensor.dense.DenseMatrix">DenseMatrix</a>.<a href="../tensor/dense/DenseMatrix.scala.html#62269" title="[V](rows: Int, cols: Int)(implicit s: scalala.scalar.Scalar[V])scalala.tensor.dense.DenseMatrix[V]">zeros</a><span title="(rows: Int, cols: Int)(implicit s: scalala.scalar.Scalar[Double])scalala.tensor.dense.DenseMatrix[Double]" class="delimiter">[</span><span title="Double">Double</span><span class="delimiter">]</span><a href="../scalar/Scalar.scala.html#45343" title="object scalala.scalar.Scalar.scalarD" class="delimiter">(</a><a href="#222057" title="Int">m</a>,<a href="#222057" title="Int">m</a><span class="delimiter">)</span>
    <a href="#222059" title="org.netlib.lapack.LAPACK">lapack</a>.<span title="(x$1: Int, x$2: Int, x$3: Int, x$4: Array[Double], x$5: Int, x$6: Array[Double], x$7: Array[Double], x$8: Int, x$9: org.netlib.util.intW)Unit">dorgqr</span><span class="delimiter">(</span><a href="#222057" title="Int">m</a>, <a href="#222057" title="Int">m</a>, math.<span title="(x: Int, y: Int)Int">min</span><span class="delimiter">(</span><a href="#222057" title="Int">m</a>,<a href="#222058" title="Int">n</a><span class="delimiter">)</span>, <a href="#222066" title="scalala.tensor.dense.DenseMatrix[Double]">AFact</a>.<a href="../tensor/dense/DenseMatrix.scala.html#64812" title="=&gt; Array[Double]">data</a>, <a href="#222057" title="Int">m</a>, <a href="#222068" title="Array[Double]">tau</a>, <a href="#222064" title="Array[Double]">workspace</a>, <a href="#222064" title="Array[Double]">workspace</a>.<span title="=&gt; Int">length</span>, <a href="#222061" title="org.netlib.util.intW">info</a><span class="delimiter">)</span>;
    <span class="keyword">for</span><span class="delimiter">(</span><a title="Int" id="224584">r</a> &lt;- <span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">0</span> <span title="(f: Int =&gt; Unit)Unit">until</span> <a href="#222057" title="Int">m</a>;
        <a title="Int" id="224679">c</a> &lt;- <span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">0</span> <span title="(f: Int =&gt; Unit)Unit">until</span> <a href="#222065" title="Int">maxd</a> <span class="keyword">if</span><span class="delimiter">(</span><a href="#224679" title="Int">c</a> <span title="(x: Int)Boolean">&lt;</span> <a href="#222057" title="Int">m</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <a href="../tensor/dense/DenseMatrix.scala.html#64820" title="(row: Int, col: Int, value: Double)Unit">Q</a><span class="delimiter">(</span><a href="#224584" title="Int">r</a>,<a href="#224679" title="Int">c</a><span class="delimiter">)</span> = <a href="../tensor/dense/DenseMatrix.scala.html#64819" title="(row: Int, col: Int)Double">AFact</a><span class="delimiter">(</span><a href="#224584" title="Int">r</a>,<a href="#224679" title="Int">c</a><span class="delimiter">)</span>

    <span class="comment">//Error check</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#222061" title="org.netlib.util.intW">info</a>.<span title="Int">`val`</span> <span title="(x: Int)Boolean">&gt;</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
      <span title="Nothing" class="keyword">throw</span> <a href="#219315" title="scalala.library.NotConvergedException" class="keyword">new</a> <a href="#12511" title="scalala.library.NotConvergedException">NotConvergedException</a><span class="delimiter">(</span><a href="#366368" title="object scalala.library.NotConvergedException">NotConvergedException</a>.<a href="#219309" title="object scalala.library.NotConvergedException.Iterations">Iterations</a><span class="delimiter">)</span>
    <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#222061" title="org.netlib.util.intW">info</a>.<span title="Int">`val`</span> <span title="(x: Int)Boolean">&lt;</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
      <span title="Nothing" class="keyword">throw</span> <span title="java.lang.IllegalArgumentException" class="keyword">new</span> <span title="java.lang.IllegalArgumentException">IllegalArgumentException</span><span class="delimiter">(</span><span class="delimiter">)</span>

    <span class="comment">//Get P</span>
    <span class="keyword">for</span><span class="delimiter">(</span><a title="Int" id="225570">i</a> &lt;- <span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">0</span> <span title="(f: Int =&gt; Unit)Unit">until</span> <a href="#222067" title="Array[Int]">pvt</a>.<span title="=&gt; Int">length</span><span class="delimiter">)</span> <a href="#222067" title="(i: Int, x: Int)Unit">pvt</a><span class="delimiter">(</span><a href="#225570" title="Int">i</a><span class="delimiter">)</span><span title="(x: Int)Int">-=</span><span title="Int(1)" class="int">1</span>
    <span class="keyword">val</span> <a title="scalala.tensor.dense.DenseMatrix[Int]" id="222071">P</a> = <a href="../tensor/dense/DenseMatrix.scala.html#19128" title="object scalala.tensor.dense.DenseMatrix">DenseMatrix</a>.<a href="../tensor/dense/DenseMatrix.scala.html#62269" title="[V](rows: Int, cols: Int)(implicit s: scalala.scalar.Scalar[V])scalala.tensor.dense.DenseMatrix[V]">zeros</a><span title="(rows: Int, cols: Int)(implicit s: scalala.scalar.Scalar[Int])scalala.tensor.dense.DenseMatrix[Int]" class="delimiter">[</span><span title="Int">Int</span><span class="delimiter">]</span><a href="../scalar/Scalar.scala.html#45335" title="object scalala.scalar.Scalar.ScalarI" class="delimiter">(</a><a href="#222058" title="Int">n</a>,<a href="#222058" title="Int">n</a><span class="delimiter">)</span>
    <span class="keyword">for</span><span class="delimiter">(</span><a title="Int" id="225678">i</a> &lt;- <span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">0</span> <span title="(f: Int =&gt; Unit)Unit">until</span> <a href="#222058" title="Int">n</a><span class="delimiter">)</span>
      <a href="../tensor/dense/DenseMatrix.scala.html#64820" title="(row: Int, col: Int, value: Int)Unit">P</a><span class="delimiter">(</span><a href="#222067" title="(i: Int)Int">pvt</a><span class="delimiter">(</span><a href="#225678" title="Int">i</a><span class="delimiter">)</span>, <a href="#225678" title="Int">i</a><span class="delimiter">)</span> = <span title="Int(1)" class="int">1</span>

    <span title="(_1: scalala.tensor.dense.DenseMatrix[Double], _2: scalala.tensor.dense.DenseMatrix[Double], _3: scalala.tensor.dense.DenseMatrix[Int], _4: Array[Int])(scalala.tensor.dense.DenseMatrix[Double], scalala.tensor.dense.DenseMatrix[Double], scalala.tensor.dense.DenseMatrix[Int], Array[Int])" class="delimiter">(</span><a href="#222070" title="scalala.tensor.dense.DenseMatrix[Double]">Q</a>,<a href="#222069" title="scalala.tensor.dense.DenseMatrix[Double]">R</a>,<a href="#222071" title="scalala.tensor.dense.DenseMatrix[Int]">P</a>,<a href="#222067" title="Array[Int]">pvt</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
  * QR Factorization
  *
  * input: A m x n matrix
  * optional: skipQ - if true, don't reconstruct orthogonal matrix Q (instead returns (null,R))
  * output: (Q,R)
  *   Q: m x m
  *   R: m x n
  */</span>
  <span class="keyword">def</span> <a title="(A: scalala.tensor.dense.DenseMatrix[Double], skipQ: Boolean)(scalala.tensor.dense.DenseMatrix[Double], scalala.tensor.dense.DenseMatrix[Double])" id="20698">qr</a><span class="delimiter">(</span><a title="scalala.tensor.dense.DenseMatrix[Double]" id="225707">A</a>: <a href="../tensor/dense/DenseMatrix.scala.html#19127" title="scalala.tensor.dense.DenseMatrix[Double]">DenseMatrix</a><span class="delimiter">[</span>Double<span class="delimiter">]</span>, <a title="Boolean" id="225710">skipQ</a> : <span title="Boolean">Boolean</span> = <span title="Boolean(false)" class="keyword">false</span><span class="delimiter">)</span>: <span title="(scalala.tensor.dense.DenseMatrix[Double], scalala.tensor.dense.DenseMatrix[Double])" class="delimiter">(</span>DenseMatrix<span class="delimiter">[</span>Double<span class="delimiter">]</span>, DenseMatrix<span class="delimiter">[</span>Double<span class="delimiter">]</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Int" id="225711">m</a> = <a href="#225707" title="scalala.tensor.dense.DenseMatrix[Double]">A</a>.<a href="../tensor/dense/DenseMatrix.scala.html#64804" title="=&gt; Int">numRows</a>
    <span class="keyword">val</span> <a title="Int" id="225712">n</a> = <a href="#225707" title="scalala.tensor.dense.DenseMatrix[Double]">A</a>.<a href="../tensor/dense/DenseMatrix.scala.html#64806" title="=&gt; Int">numCols</a>
    <span class="keyword">val</span> <a title="org.netlib.lapack.LAPACK" id="225713">lapack</a> = <span title="object org.netlib.lapack.LAPACK">LAPACK</span>.<span title="()org.netlib.lapack.LAPACK">getInstance</span><span class="delimiter">(</span><span class="delimiter">)</span>;

    <span class="comment">//Get optimal workspace size</span>
    <span class="comment">// we do this by sending -1 as lwork to the lapack function</span>
    <span class="keyword">val</span> <a title="Array[Double]" id="225714">work</a> = <span title="Array[Double]" class="keyword">new</span> <span title="Array[Double]">Array</span><span class="delimiter">[</span>Double<span class="delimiter">]</span><span class="delimiter">(</span><span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
    <span class="keyword">var</span> <a title="org.netlib.util.intW" id="225715">info</a> = <span title="org.netlib.util.intW" class="keyword">new</span> <span title="org.netlib.util.intW">intW</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
    <a href="#225713" title="org.netlib.lapack.LAPACK">lapack</a>.<span title="(x$1: Int, x$2: Int, x$3: Array[Double], x$4: Int, x$5: Array[Double], x$6: Array[Double], x$7: Int, x$8: org.netlib.util.intW)Unit">dgeqrf</span><span class="delimiter">(</span><a href="#225711" title="Int">m</a>, <a href="#225712" title="Int">n</a>, <span title="Null(null)" class="keyword">null</span>, <a href="#225711" title="Int">m</a>, <span title="Null(null)" class="keyword">null</span>, <a href="#225714" title="Array[Double]">work</a>, -<span title="Int(-1)" class="int">1</span>, <a href="#225715" title="org.netlib.util.intW">info</a><span class="delimiter">)</span>;
    <span class="keyword">val</span> <a title="Int" id="225716">lwork1</a> = <span title="Int" class="keyword">if</span><span class="delimiter">(</span><a href="#225715" title="org.netlib.util.intW">info</a>.<span title="Int">`val`</span> <span title="(x: Int)Boolean">!=</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <a href="#225712" title="Int">n</a> <span class="keyword">else</span> <a href="#225714" title="(i: Int)Double">work</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>.<span title="=&gt; Int">toInt</span>
    <a href="#225713" title="org.netlib.lapack.LAPACK">lapack</a>.<span title="(x$1: Int, x$2: Int, x$3: Int, x$4: Array[Double], x$5: Int, x$6: Array[Double], x$7: Array[Double], x$8: Int, x$9: org.netlib.util.intW)Unit">dorgqr</span><span class="delimiter">(</span><a href="#225711" title="Int">m</a>, <a href="#225711" title="Int">m</a>, math.<span title="(x: Int, y: Int)Int">min</span><span class="delimiter">(</span><a href="#225711" title="Int">m</a>,<a href="#225712" title="Int">n</a><span class="delimiter">)</span>, <span title="Null(null)" class="keyword">null</span>, <a href="#225711" title="Int">m</a>, <span title="Null(null)" class="keyword">null</span>, <a href="#225714" title="Array[Double]">work</a>, -<span title="Int(-1)" class="int">1</span>, <a href="#225715" title="org.netlib.util.intW">info</a><span class="delimiter">)</span>;
    <span class="keyword">val</span> <a title="Int" id="225717">lwork2</a> = <span title="Int" class="keyword">if</span><span class="delimiter">(</span><a href="#225715" title="org.netlib.util.intW">info</a>.<span title="Int">`val`</span> <span title="(x: Int)Boolean">!=</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <a href="#225712" title="Int">n</a> <span class="keyword">else</span> <a href="#225714" title="(i: Int)Double">work</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>.<span title="=&gt; Int">toInt</span>;
    <span class="comment">//allocate workspace mem. as max of lwork1 and lwork3</span>
    <span class="keyword">val</span> <a title="Array[Double]" id="225718">workspace</a> = <span title="Array[Double]" class="keyword">new</span> <span title="Array[Double]">Array</span><span class="delimiter">[</span>Double<span class="delimiter">]</span><span class="delimiter">(</span>math.<span title="(x: Int, y: Int)Int">max</span><span class="delimiter">(</span><a href="#225716" title="Int">lwork1</a>, <a href="#225717" title="Int">lwork2</a><span class="delimiter">)</span><span class="delimiter">)</span>;

    <span class="comment">//Perform the QR factorization with dgeqrf</span>
    <span class="keyword">val</span> <a title="Int" id="225719">maxd</a> = math.<span title="(x: Int, y: Int)Int">max</span><span class="delimiter">(</span><a href="#225711" title="Int">m</a>,<a href="#225712" title="Int">n</a><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="Int" id="225720">mind</a> = math.<span title="(x: Int, y: Int)Int">max</span><span class="delimiter">(</span><a href="#225711" title="Int">m</a>,<a href="#225712" title="Int">n</a><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="scalala.tensor.dense.DenseMatrix[Double]" id="225721">outputMat</a> = <a href="../tensor/dense/DenseMatrix.scala.html#19128" title="object scalala.tensor.dense.DenseMatrix">DenseMatrix</a>.<a href="../tensor/dense/DenseMatrix.scala.html#62269" title="[V](rows: Int, cols: Int)(implicit s: scalala.scalar.Scalar[V])scalala.tensor.dense.DenseMatrix[V]">zeros</a><span title="(rows: Int, cols: Int)(implicit s: scalala.scalar.Scalar[Double])scalala.tensor.dense.DenseMatrix[Double]" class="delimiter">[</span><span title="Double">Double</span><span class="delimiter">]</span><a href="../scalar/Scalar.scala.html#45343" title="object scalala.scalar.Scalar.scalarD" class="delimiter">(</a><a href="#225711" title="Int">m</a>,<a href="#225719" title="Int">maxd</a><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="Array[Double]" id="225722">tau</a> = <span title="Array[Double]" class="keyword">new</span> <span title="Array[Double]">Array</span><span class="delimiter">[</span>Double<span class="delimiter">]</span><span class="delimiter">(</span>math.<span title="(x: Int, y: Int)Int">min</span><span class="delimiter">(</span><a href="#225711" title="Int">m</a>,<a href="#225712" title="Int">n</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="keyword">for</span><span class="delimiter">(</span><a title="Int" id="225874">r</a> &lt;- <span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">0</span> <span title="(f: Int =&gt; Unit)Unit">until</span> <a href="#225711" title="Int">m</a>; <a title="Int" id="225974">c</a> &lt;- <span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">0</span> <span title="(f: Int =&gt; Unit)Unit">until</span> <a href="#225712" title="Int">n</a><span class="delimiter">)</span> <a href="../tensor/dense/DenseMatrix.scala.html#64820" title="(row: Int, col: Int, value: Double)Unit">outputMat</a><span class="delimiter">(</span><a href="#225874" title="Int">r</a>,<a href="#225974" title="Int">c</a><span class="delimiter">)</span> = <a href="../tensor/dense/DenseMatrix.scala.html#64819" title="(row: Int, col: Int)Double">A</a><span class="delimiter">(</span><a href="#225874" title="Int">r</a>,<a href="#225974" title="Int">c</a><span class="delimiter">)</span>
    <a href="#225713" title="org.netlib.lapack.LAPACK">lapack</a>.<span title="(x$1: Int, x$2: Int, x$3: Array[Double], x$4: Int, x$5: Array[Double], x$6: Array[Double], x$7: Int, x$8: org.netlib.util.intW)Unit">dgeqrf</span><span class="delimiter">(</span><a href="#225711" title="Int">m</a>, <a href="#225712" title="Int">n</a>, <a href="#225721" title="scalala.tensor.dense.DenseMatrix[Double]">outputMat</a>.<a href="../tensor/dense/DenseMatrix.scala.html#64812" title="=&gt; Array[Double]">data</a>, <a href="#225711" title="Int">m</a>, <a href="#225718" title="Array[Double]">workspace</a>, <a href="#225722" title="Array[Double]">tau</a>, <a href="#225718" title="Array[Double]">workspace</a>.<span title="=&gt; Int">length</span>, <a href="#225715" title="org.netlib.util.intW">info</a><span class="delimiter">)</span>;

    <span class="comment">//Error check</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#225715" title="org.netlib.util.intW">info</a>.<span title="Int">`val`</span> <span title="(x: Int)Boolean">&gt;</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
      <span title="Nothing" class="keyword">throw</span> <a href="#219315" title="scalala.library.NotConvergedException" class="keyword">new</a> <a href="#12511" title="scalala.library.NotConvergedException">NotConvergedException</a><span class="delimiter">(</span><a href="#366368" title="object scalala.library.NotConvergedException">NotConvergedException</a>.<a href="#219309" title="object scalala.library.NotConvergedException.Iterations">Iterations</a><span class="delimiter">)</span>
    <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#225715" title="org.netlib.util.intW">info</a>.<span title="Int">`val`</span> <span title="(x: Int)Boolean">&lt;</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
      <span title="Nothing" class="keyword">throw</span> <span title="java.lang.IllegalArgumentException" class="keyword">new</span> <span title="java.lang.IllegalArgumentException">IllegalArgumentException</span><span class="delimiter">(</span><span class="delimiter">)</span>

    <span class="comment">//Get R</span>
    <span class="keyword">val</span> <a title="scalala.tensor.dense.DenseMatrix[Double]" id="225723">R</a> = <a href="../tensor/dense/DenseMatrix.scala.html#19128" title="object scalala.tensor.dense.DenseMatrix">DenseMatrix</a>.<a href="../tensor/dense/DenseMatrix.scala.html#62269" title="[V](rows: Int, cols: Int)(implicit s: scalala.scalar.Scalar[V])scalala.tensor.dense.DenseMatrix[V]">zeros</a><span title="(rows: Int, cols: Int)(implicit s: scalala.scalar.Scalar[Double])scalala.tensor.dense.DenseMatrix[Double]" class="delimiter">[</span><span title="Double">Double</span><span class="delimiter">]</span><a href="../scalar/Scalar.scala.html#45343" title="object scalala.scalar.Scalar.scalarD" class="delimiter">(</a><a href="#225711" title="Int">m</a>,<a href="#225712" title="Int">n</a><span class="delimiter">)</span>
    <span class="keyword">for</span><span class="delimiter">(</span><a title="Int" id="226861">c</a> &lt;- <span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">0</span> <span title="(f: Int =&gt; Unit)Unit">until</span> <a href="#225719" title="Int">maxd</a> <span class="keyword">if</span><span class="delimiter">(</span><a href="#226861" title="Int">c</a> <span title="(x: Int)Boolean">&lt;</span> <a href="#225712" title="Int">n</a><span class="delimiter">)</span>;
        <a title="Int" id="226955">r</a> &lt;- <span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">0</span> <span title="(f: Int =&gt; Unit)Unit">until</span> <a href="#225711" title="Int">m</a> <span class="keyword">if</span><span class="delimiter">(</span><a href="#226955" title="Int">r</a> <span title="(x: Int)Boolean">&lt;=</span> <a href="#226861" title="Int">c</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="../tensor/dense/DenseMatrix.scala.html#64820" title="(row: Int, col: Int, value: Double)Unit">R</a><span class="delimiter">(</span><a href="#226955" title="Int">r</a>,<a href="#226861" title="Int">c</a><span class="delimiter">)</span> = <a href="../tensor/dense/DenseMatrix.scala.html#64819" title="(row: Int, col: Int)Double">outputMat</a><span class="delimiter">(</span><a href="#226955" title="Int">r</a>,<a href="#226861" title="Int">c</a><span class="delimiter">)</span>

    <span class="comment">//unless the skipq flag is set</span>
    <span title="(scalala.tensor.dense.DenseMatrix[Double], scalala.tensor.dense.DenseMatrix[Double])" class="keyword">if</span><span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#225710" title="Boolean">skipQ</a><span class="delimiter">)</span><span class="delimiter">{</span>
      <span class="comment">//Get Q from the matrix returned by dgep3</span>
      <span class="keyword">val</span> <a title="scalala.tensor.dense.DenseMatrix[Double]" id="227737">Q</a> = <a href="../tensor/dense/DenseMatrix.scala.html#19128" title="object scalala.tensor.dense.DenseMatrix">DenseMatrix</a>.<a href="../tensor/dense/DenseMatrix.scala.html#62269" title="[V](rows: Int, cols: Int)(implicit s: scalala.scalar.Scalar[V])scalala.tensor.dense.DenseMatrix[V]">zeros</a><span title="(rows: Int, cols: Int)(implicit s: scalala.scalar.Scalar[Double])scalala.tensor.dense.DenseMatrix[Double]" class="delimiter">[</span><span title="Double">Double</span><span class="delimiter">]</span><a href="../scalar/Scalar.scala.html#45343" title="object scalala.scalar.Scalar.scalarD" class="delimiter">(</a><a href="#225711" title="Int">m</a>,<a href="#225711" title="Int">m</a><span class="delimiter">)</span>
      <a href="#225713" title="org.netlib.lapack.LAPACK">lapack</a>.<span title="(x$1: Int, x$2: Int, x$3: Int, x$4: Array[Double], x$5: Int, x$6: Array[Double], x$7: Array[Double], x$8: Int, x$9: org.netlib.util.intW)Unit">dorgqr</span><span class="delimiter">(</span><a href="#225711" title="Int">m</a>, <a href="#225711" title="Int">m</a>, math.<span title="(x: Int, y: Int)Int">min</span><span class="delimiter">(</span><a href="#225711" title="Int">m</a>,<a href="#225712" title="Int">n</a><span class="delimiter">)</span>, <a href="#225721" title="scalala.tensor.dense.DenseMatrix[Double]">outputMat</a>.<a href="../tensor/dense/DenseMatrix.scala.html#64812" title="=&gt; Array[Double]">data</a>, <a href="#225711" title="Int">m</a>, <a href="#225722" title="Array[Double]">tau</a>, <a href="#225718" title="Array[Double]">workspace</a>, <a href="#225718" title="Array[Double]">workspace</a>.<span title="=&gt; Int">length</span>, <a href="#225715" title="org.netlib.util.intW">info</a><span class="delimiter">)</span>;
      <span class="keyword">for</span><span class="delimiter">(</span><a title="Int" id="227844">r</a> &lt;- <span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">0</span> <span title="(f: Int =&gt; Unit)Unit">until</span> <a href="#225711" title="Int">m</a>;
          <a title="Int" id="227939">c</a> &lt;- <span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">0</span> <span title="(f: Int =&gt; Unit)Unit">until</span> <a href="#225719" title="Int">maxd</a> <span class="keyword">if</span><span class="delimiter">(</span><a href="#227939" title="Int">c</a> <span title="(x: Int)Boolean">&lt;</span> <a href="#225711" title="Int">m</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <a href="../tensor/dense/DenseMatrix.scala.html#64820" title="(row: Int, col: Int, value: Double)Unit">Q</a><span class="delimiter">(</span><a href="#227844" title="Int">r</a>,<a href="#227939" title="Int">c</a><span class="delimiter">)</span> = <a href="../tensor/dense/DenseMatrix.scala.html#64819" title="(row: Int, col: Int)Double">outputMat</a><span class="delimiter">(</span><a href="#227844" title="Int">r</a>,<a href="#227939" title="Int">c</a><span class="delimiter">)</span>

      <span class="comment">//Error check</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#225715" title="org.netlib.util.intW">info</a>.<span title="Int">`val`</span> <span title="(x: Int)Boolean">&gt;</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
        <span title="Nothing" class="keyword">throw</span> <a href="#219315" title="scalala.library.NotConvergedException" class="keyword">new</a> <a href="#12511" title="scalala.library.NotConvergedException">NotConvergedException</a><span class="delimiter">(</span><a href="#366368" title="object scalala.library.NotConvergedException">NotConvergedException</a>.<a href="#219309" title="object scalala.library.NotConvergedException.Iterations">Iterations</a><span class="delimiter">)</span>
      <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#225715" title="org.netlib.util.intW">info</a>.<span title="Int">`val`</span> <span title="(x: Int)Boolean">&lt;</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
        <span title="Nothing" class="keyword">throw</span> <span title="java.lang.IllegalArgumentException" class="keyword">new</span> <span title="java.lang.IllegalArgumentException">IllegalArgumentException</span><span class="delimiter">(</span><span class="delimiter">)</span>
      <span title="(_1: scalala.tensor.dense.DenseMatrix[Double], _2: scalala.tensor.dense.DenseMatrix[Double])(scalala.tensor.dense.DenseMatrix[Double], scalala.tensor.dense.DenseMatrix[Double])" class="delimiter">(</span><a href="#227737" title="scalala.tensor.dense.DenseMatrix[Double]">Q</a>,<a href="#225723" title="scalala.tensor.dense.DenseMatrix[Double]">R</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
    <span class="comment">//skip Q and just return R</span>
    <span class="keyword">else</span> <span title="(_1: Null, _2: scalala.tensor.dense.DenseMatrix[Double])(Null, scalala.tensor.dense.DenseMatrix[Double])" class="delimiter">(</span><span title="Null(null)" class="keyword">null</span>,<a href="#225723" title="scalala.tensor.dense.DenseMatrix[Double]">R</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  
  

  <span class="comment">/**
   * Computes all eigenvalues (and optionally right eigenvectors) of the given
   * real symmetric matrix X.
   */</span>
  <span class="keyword">def</span> <a title="(X: scalala.tensor.Matrix[Double], rightEigenvectors: Boolean)(scalala.tensor.dense.DenseVector[Double], Option[scalala.tensor.dense.DenseMatrix[Double]])" id="20699">eigSym</a><span class="delimiter">(</span><a title="scalala.tensor.Matrix[Double]" id="228743">X</a>: <a href="../tensor/Matrix.scala.html#18329" title="scalala.tensor.Matrix[Double]">Matrix</a><span class="delimiter">[</span>Double<span class="delimiter">]</span>, <a title="Boolean" id="228744">rightEigenvectors</a>: <span title="Boolean">Boolean</span><span class="delimiter">)</span>:
    <span title="(scalala.tensor.dense.DenseVector[Double], Option[scalala.tensor.dense.DenseMatrix[Double]])" class="delimiter">(</span>DenseVector<span class="delimiter">[</span>Double<span class="delimiter">]</span>, Option<span class="delimiter">[</span>DenseMatrix<span class="delimiter">[</span>Double<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span> =
  <span class="delimiter">{</span>
    <a href="#20667" title="(mat: scalala.tensor.Matrix[Double])Unit">requireNonEmptyMatrix</a><span class="delimiter">(</span><a href="#228743" title="scalala.tensor.Matrix[Double]">X</a><span class="delimiter">)</span>

    <span class="comment">// As LAPACK doesn't check if the given matrix is in fact symmetric,</span>
    <span class="comment">// we have to do it here (or get rid of this time-waster as long as</span>
    <span class="comment">// the caller of this function is clearly aware that only the lower</span>
    <span class="comment">// triangular portion of the given matrix is used and there is no</span>
    <span class="comment">// check for symmetry).</span>
    <a href="#20673" title="(mat: scalala.tensor.Matrix[Double])Unit">requireSymmetricMatrix</a><span class="delimiter">(</span><a href="#228743" title="scalala.tensor.Matrix[Double]">X</a><span class="delimiter">)</span>

    <span class="comment">// Copy the lower triangular part of X. LAPACK will store the result in A.</span>
    <span class="keyword">val</span> <a title="scalala.tensor.dense.DenseMatrix[Double]" id="228746">A</a>     = <a href="#220024" title="(X: scalala.tensor.Matrix[Double])(implicit evidence$1: scalala.scalar.Scalar[Double])scalala.tensor.dense.DenseMatrix[Double]">lowerTriangular</a><a href="../scalar/Scalar.scala.html#45343" title="object scalala.scalar.Scalar.scalarD" class="delimiter">(</a><a href="#228743" title="scalala.tensor.Matrix[Double]">X</a><span class="delimiter">)</span>

    <span class="keyword">val</span> <a title="Int" id="228747">N</a>     = <a href="#228743" title="scalala.tensor.Matrix[Double]">X</a>.<a href="../tensor/Matrix.scala.html#49654" title="=&gt; Int">numRows</a>
    <span class="keyword">val</span> <a title="scalala.tensor.dense.DenseVectorCol[Double]" id="228748">evs</a>   = <a href="../tensor/dense/DenseVector.scala.html#19050" title="object scalala.tensor.dense.DenseVector">DenseVector</a>.<a href="../tensor/dense/DenseVector.scala.html#43294" title="[V](size: Int)(implicit s: scalala.scalar.Scalar[V])scalala.tensor.dense.DenseVectorCol[V]">zeros</a><span title="(size: Int)(implicit s: scalala.scalar.Scalar[Double])scalala.tensor.dense.DenseVectorCol[Double]" class="delimiter">[</span><span title="Double">Double</span><span class="delimiter">]</span><a href="../scalar/Scalar.scala.html#45343" title="object scalala.scalar.Scalar.scalarD" class="delimiter">(</a><a href="#228747" title="Int">N</a><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="Int" id="228749">lwork</a> = math.<span title="(x: Int, y: Int)Int">max</span><span class="delimiter">(</span><span title="Int(1)" class="int">1</span>, <span title="Int(3)" class="int">3</span><span title="(x: Int)Int">*</span><a href="#228747" title="Int">N</a><span title="(x: Int)Int">-</span><span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="Array[Double]" id="228750">work</a>  = <span title="object Array">Array</span>.<span title="[T](n1: Int)(implicit evidence$3: scala.reflect.ClassManifest[T])Array[T]">ofDim</span><span title="(n1: Int)(implicit evidence$3: scala.reflect.ClassManifest[Double])Array[Double]" class="delimiter">[</span><span title="Double">Double</span><span class="delimiter">]</span><span title="=&gt; scala.reflect.AnyValManifest[Double]" class="delimiter">(</span><a href="#228749" title="Int">lwork</a><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="org.netlib.util.intW" id="228751">info</a>  = <span title="org.netlib.util.intW" class="keyword">new</span> <span title="org.netlib.util.intW">intW</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
    <span title="object org.netlib.lapack.LAPACK">LAPACK</span>.<span title="()org.netlib.lapack.LAPACK">getInstance</span>.<span title="(x$1: java.lang.String, x$2: java.lang.String, x$3: Int, x$4: Array[Double], x$5: Int, x$6: Array[Double], x$7: Array[Double], x$8: Int, x$9: org.netlib.util.intW)Unit">dsyev</span><span class="delimiter">(</span>
      <span title="java.lang.String" class="keyword">if</span> <span class="delimiter">(</span><a href="#228744" title="Boolean">rightEigenvectors</a><span class="delimiter">)</span> <span title="java.lang.String(&quot;V&quot;)" class="string">&quot;V&quot;</span> <span class="keyword">else</span> <span title="java.lang.String(&quot;N&quot;)" class="string">&quot;N&quot;</span> <span class="comment">/* eigenvalues N, eigenvalues &amp; eigenvectors &quot;V&quot; */</span>,
      <span title="java.lang.String(&quot;L&quot;)" class="string">&quot;L&quot;</span> <span class="comment">/* lower triangular */</span>,
      <a href="#228747" title="Int">N</a> <span class="comment">/* number of rows */</span>, <a href="#228746" title="scalala.tensor.dense.DenseMatrix[Double]">A</a>.<a href="../tensor/dense/DenseMatrix.scala.html#64812" title="=&gt; Array[Double]">data</a>, math.<span title="(x: Int, y: Int)Int">max</span><span class="delimiter">(</span><span title="Int(1)" class="int">1</span>, <a href="#228747" title="Int">N</a><span class="delimiter">)</span> <span class="comment">/* LDA */</span>,
      <a href="#228748" title="scalala.tensor.dense.DenseVectorCol[Double]">evs</a>.<a href="../tensor/dense/DenseVector.scala.html#43324" title="=&gt; Array[Double]">data</a>,
      <a href="#228750" title="Array[Double]">work</a> <span class="comment">/* workspace */</span>, <a href="#228749" title="Int">lwork</a> <span class="comment">/* workspace size */</span>,
      <a href="#228751" title="org.netlib.util.intW">info</a>
    <span class="delimiter">)</span>
    <span class="comment">// A value of info.`val` &lt; 0 would tell us that the i-th argument</span>
    <span class="comment">// of the call to dsyev was erroneous (where i == |info.`val`|).</span>
    <span title="(assertion: Boolean)Unit">assert</span><span class="delimiter">(</span><a href="#228751" title="org.netlib.util.intW">info</a>.<span title="Int">`val`</span> <span title="(x: Int)Boolean">&gt;=</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>

    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#228751" title="org.netlib.util.intW">info</a>.<span title="Int">`val`</span> <span title="(x: Int)Boolean">&gt;</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
      <span title="Nothing" class="keyword">throw</span> <a href="#219315" title="scalala.library.NotConvergedException" class="keyword">new</a> <a href="#12511" title="scalala.library.NotConvergedException">NotConvergedException</a><span class="delimiter">(</span><a href="#366368" title="object scalala.library.NotConvergedException">NotConvergedException</a>.<a href="#219309" title="object scalala.library.NotConvergedException.Iterations">Iterations</a><span class="delimiter">)</span>

    <span title="(_1: scalala.tensor.dense.DenseVectorCol[Double], _2: Option[scalala.tensor.dense.DenseMatrix[Double]])(scalala.tensor.dense.DenseVectorCol[Double], Option[scalala.tensor.dense.DenseMatrix[Double]])" class="delimiter">(</span><a href="#228748" title="scalala.tensor.dense.DenseVectorCol[Double]">evs</a>, <span title="Option[scalala.tensor.dense.DenseMatrix[Double]]" class="keyword">if</span> <span class="delimiter">(</span><a href="#228744" title="Boolean">rightEigenvectors</a><span class="delimiter">)</span> <span title="(x: scalala.tensor.dense.DenseMatrix[Double])Some[scalala.tensor.dense.DenseMatrix[Double]]">Some</span><span class="delimiter">(</span><a href="#228746" title="scalala.tensor.dense.DenseMatrix[Double]">A</a><span class="delimiter">)</span> <span class="keyword">else</span> <span title="object None">None</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Computes the LU factorization of the given real M-by-N matrix X such that
   * X = P * L * U where P is a permutation matrix (row exchanges).
   *
   * Upon completion, a tuple consisting of a matrix A and an integer array P.
   *
   * The upper triangular portion of A resembles U whereas the lower triangular portion of
   * A resembles L up to but not including the diagonal elements of L which are
   * all equal to 1.
   *
   * For 0 &lt;= i &lt; M, each element P(i) denotes whether row i of the matrix X
   * was exchanged with row P(i-1) during computation (the offset is caused by
   * the internal call to LAPACK).
   */</span>
  <span class="keyword">def</span> <a title="[T](X: scalala.tensor.Matrix[T])(implicit td: T =&gt; Double)(scalala.tensor.dense.DenseMatrix[Double], Array[Int])" id="20700">LU</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="20702">T</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="scalala.tensor.Matrix[T]" id="228823">X</a>: <a href="../tensor/Matrix.scala.html#18329" title="scalala.tensor.Matrix[T]">Matrix</a><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="T =&gt; Double" id="228824">td</a>: T =&gt; Double<span class="delimiter">)</span>: <span title="(scalala.tensor.dense.DenseMatrix[Double], Array[Int])" class="delimiter">(</span>DenseMatrix<span class="delimiter">[</span>Double<span class="delimiter">]</span>, Array<span class="delimiter">[</span>Int<span class="delimiter">]</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <a href="#20667" title="(mat: scalala.tensor.Matrix[T])Unit">requireNonEmptyMatrix</a><span class="delimiter">(</span><a href="#228823" title="scalala.tensor.Matrix[T]">X</a><span class="delimiter">)</span>

    <span class="keyword">val</span> <a title="Int" id="228828">M</a>    = <a href="#228823" title="scalala.tensor.Matrix[T]">X</a>.<a href="../tensor/Matrix.scala.html#49654" title="=&gt; Int">numRows</a>
    <span class="keyword">val</span> <a title="Int" id="228829">N</a>    = <a href="#228823" title="scalala.tensor.Matrix[T]">X</a>.<a href="../tensor/Matrix.scala.html#49655" title="=&gt; Int">numCols</a>
    <span class="keyword">val</span> <a title="scalala.tensor.dense.DenseMatrix[Double]" id="228830">Y</a>    = <a href="../tensor/dense/DenseMatrix.scala.html#19128" title="object scalala.tensor.dense.DenseMatrix">DenseMatrix</a>.<a href="../tensor/dense/DenseMatrix.scala.html#62281" title="[V](rows: Int, cols: Int)(fn: (Int, Int) =&gt; V)(implicit evidence$16: scalala.scalar.Scalar[V])scalala.tensor.dense.DenseMatrix[V]">tabulate</a><span title="(rows: Int, cols: Int)(fn: (Int, Int) =&gt; Double)(implicit evidence$16: scalala.scalar.Scalar[Double])scalala.tensor.dense.DenseMatrix[Double]" class="delimiter">[</span><span title="Double">Double</span><span class="delimiter">]</span><span class="delimiter">(</span><a href="#228828" title="Int">M</a>,<a href="#228829" title="Int">N</a><span class="delimiter">)</span><a href="../scalar/Scalar.scala.html#45343" title="object scalala.scalar.Scalar.scalarD" class="delimiter">(</a><a href="../tensor/Tensor2.scala.html#44382" title="(i: Int, j: Int)T">X</a><a href="#228824" title="(v1: T)Double" class="delimiter">(</a><a href="#228914" title="Int">_</a>,<a href="#228915" title="Int">_</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="Array[Int]" id="228831">ipiv</a> = <span title="object Array">Array</span>.<span title="[T](n1: Int)(implicit evidence$3: scala.reflect.ClassManifest[T])Array[T]">ofDim</span><span title="(n1: Int)(implicit evidence$3: scala.reflect.ClassManifest[Int])Array[Int]" class="delimiter">[</span><span title="Int">Int</span><span class="delimiter">]</span><span title="=&gt; scala.reflect.AnyValManifest[Int]" class="delimiter">(</span>math.<span title="(x: Int, y: Int)Int">min</span><span class="delimiter">(</span><a href="#228828" title="Int">M</a>,<a href="#228829" title="Int">N</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="org.netlib.util.intW" id="228832">info</a> = <span title="org.netlib.util.intW" class="keyword">new</span> <span title="org.netlib.util.intW">intW</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
    <span title="object org.netlib.lapack.LAPACK">LAPACK</span>.<span title="()org.netlib.lapack.LAPACK">getInstance</span>.<span title="(x$1: Int, x$2: Int, x$3: Array[Double], x$4: Int, x$5: Array[Int], x$6: org.netlib.util.intW)Unit">dgetrf</span><span class="delimiter">(</span>
      <a href="#228828" title="Int">M</a> <span class="comment">/* numRows */</span>, <a href="#228829" title="Int">N</a> <span class="comment">/* numCols */</span>,
      <a href="#228830" title="scalala.tensor.dense.DenseMatrix[Double]">Y</a>.<a href="../tensor/dense/DenseMatrix.scala.html#64812" title="=&gt; Array[Double]">data</a>, math.<span title="(x: Int, y: Int)Int">max</span><span class="delimiter">(</span><span title="Int(1)" class="int">1</span>,<a href="#228828" title="Int">M</a><span class="delimiter">)</span> <span class="comment">/* LDA */</span>,
      <a href="#228831" title="Array[Int]">ipiv</a> <span class="comment">/* pivot indices */</span>,
      <a href="#228832" title="org.netlib.util.intW">info</a>
    <span class="delimiter">)</span>
    <span class="comment">// A value of info.`val` &lt; 0 would tell us that the i-th argument</span>
    <span class="comment">// of the call to dsyev was erroneous (where i == |info.`val`|).</span>
    <span title="(assertion: Boolean)Unit">assert</span><span class="delimiter">(</span><a href="#228832" title="org.netlib.util.intW">info</a>.<span title="Int">`val`</span> <span title="(x: Int)Boolean">&gt;=</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>

    <span title="(_1: scalala.tensor.dense.DenseMatrix[Double], _2: Array[Int])(scalala.tensor.dense.DenseMatrix[Double], Array[Int])" class="delimiter">(</span><a href="#228830" title="scalala.tensor.dense.DenseMatrix[Double]">Y</a>, <a href="#228831" title="Array[Int]">ipiv</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Computes the determinant of the given real matrix.
   */</span>
  <span class="keyword">def</span> <a title="[T](X: scalala.tensor.Matrix[T])(implicit td: T =&gt; Double)Double" id="20703">det</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="20705">T</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="scalala.tensor.Matrix[T]" id="229764">X</a>: <a href="../tensor/Matrix.scala.html#18329" title="scalala.tensor.Matrix[T]">Matrix</a><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="T =&gt; Double" id="229765">td</a>: T =&gt; Double<span class="delimiter">)</span>: <span title="Double">Double</span> = <span class="delimiter">{</span>
    <a href="#20670" title="(mat: scalala.tensor.Matrix[T])Unit">requireSquareMatrix</a><span class="delimiter">(</span><a href="#229764" title="scalala.tensor.Matrix[T]">X</a><span class="delimiter">)</span>

    <span class="comment">// For triangular N-by-N matrices X, the determinant of X equals the product</span>
    <span class="comment">// of the diagonal elements X(i,i) where 0 &lt;= i &lt; N.</span>
    <span class="comment">// Since det(AB) = det(A) * det(B), the LU factorization is well-suited for</span>
    <span class="comment">// the computation of the determinant of general N-by-N matrices.</span>
    <span class="keyword">val</span> <a href="#229770" title="(scalala.tensor.dense.DenseMatrix[Double], Array[Int])" class="delimiter">(</a><a href="#229769" title="scalala.tensor.dense.DenseMatrix[Double]" id="229770">m</a>, <a href="#229769" title="Array[Int]" id="229771">ipiv</a><span class="delimiter">)</span> = <a href="#20700" title="(X: scalala.tensor.Matrix[T])(implicit td: T =&gt; Double)(scalala.tensor.dense.DenseMatrix[Double], Array[Int])">LU</a><a href="#229765" title="T =&gt; Double" class="delimiter">(</a><a href="#229764" title="scalala.tensor.Matrix[T]">X</a><span class="delimiter">)</span>

    <span class="comment">// Count the number of exchanged rows.  ipiv contains an array of swapped indices,</span>
    <span class="comment">//  but it also contains indices that weren't swapped.  To count the swapped</span>
    <span class="comment">//  indices, we have to compare them against their position within the array.  A</span>
    <span class="comment">//  final complication is that the array indices are 1-based, due to the LU call</span>
    <span class="comment">//  into LAPACK.</span>
    <span class="keyword">val</span> <a title="Int" id="229772">numExchangedRows</a> = <a href="#229771" title="implicit scala.Predef.intArrayOps : (xs: Array[Int])scala.collection.mutable.ArrayOps[Int]">ipiv</a>.<span title="(f: Int =&gt; Int)(implicit bf: scala.collection.generic.CanBuildFrom[Array[Int],Int,Array[Int]])Array[Int]">map</span><span title="implicit scala.Predef.intArrayOps : (xs: Array[Int])scala.collection.mutable.ArrayOps[Int]" class="delimiter">(</span><a href="#230288" title="Int">_</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>.<span title="(xs: Array[(Int, Int)])scala.collection.mutable.ArrayOps[(Int, Int)]">zipWithIndex</span>.<span title="(p: (Int, Int) =&gt; Boolean)Int">count</span> <span class="delimiter">{</span> <a title="(Int, Int)" id="231126">piv</a> =&gt; <a href="#231126" title="(Int, Int)">piv</a>.<span title="=&gt; Int">_1</span> <span title="(x: Int)Boolean">!=</span> <a href="#231126" title="(Int, Int)">piv</a>.<span title="=&gt; Int">_2</span> <span class="delimiter">}</span>

    <span class="keyword">var</span> <a title="Double" id="229773">acc</a> = <span title="Double" class="keyword">if</span> <span class="delimiter">(</span><a href="#229772" title="Int">numExchangedRows</a> <span title="(x: Int)Int">%</span> <span title="Int(2)" class="int">2</span> <span title="(x: Int)Boolean">==</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span> -<span title="Double(-1.0)" class="double">1.0</span> <span class="keyword">else</span> <span title="Double(1.0)" class="double">1.0</span>
    <span class="keyword">for</span> <span class="delimiter">(</span><a title="Int" id="231239">i</a> &lt;- <span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">0</span> <span title="(f: Int =&gt; Unit)Unit">until</span> <a href="#229770" title="scalala.tensor.dense.DenseMatrix[Double]">m</a>.<a href="../tensor/dense/DenseMatrix.scala.html#64804" title="=&gt; Int">numRows</a><span class="delimiter">)</span>
      <a href="#229773" title="Double">acc</a> <span title="(x: Double)Double">*=</span> <a href="../tensor/dense/DenseMatrix.scala.html#64819" title="(row: Int, col: Int)Double">m</a><span class="delimiter">(</span><a href="#231239" title="Int">i</a>,<a href="#231239" title="Int">i</a><span class="delimiter">)</span>

    <a href="#229773" title="Double">acc</a>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Computes the inverse of a given real matrix.
   */</span>
  <span class="keyword">def</span> <a title="[T](X: scalala.tensor.Matrix[T])(implicit td: T =&gt; Double)scalala.tensor.dense.DenseMatrix[Double]" id="20706">inv</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="20708">T</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="scalala.tensor.Matrix[T]" id="232014">X</a>: <a href="../tensor/Matrix.scala.html#18329" title="scalala.tensor.Matrix[T]">Matrix</a><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="T =&gt; Double" id="232015">td</a>: T =&gt; Double<span class="delimiter">)</span>: <a href="../tensor/dense/DenseMatrix.scala.html#19127" title="scalala.tensor.dense.DenseMatrix[Double]">DenseMatrix</a><span class="delimiter">[</span>Double<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <a href="#20670" title="(mat: scalala.tensor.Matrix[T])Unit">requireSquareMatrix</a><span class="delimiter">(</span><a href="#232014" title="scalala.tensor.Matrix[T]">X</a><span class="delimiter">)</span>

    <span class="keyword">val</span> <a href="#232020" title="(scalala.tensor.dense.DenseMatrix[Double], Array[Int])" class="delimiter">(</a><a href="#232019" title="scalala.tensor.dense.DenseMatrix[Double]" id="232020">m</a>, <a href="#232019" title="Array[Int]" id="232021">ipiv</a><span class="delimiter">)</span> = <a href="#20700" title="(X: scalala.tensor.Matrix[T])(implicit td: T =&gt; Double)(scalala.tensor.dense.DenseMatrix[Double], Array[Int])">LU</a><a href="#232015" title="T =&gt; Double" class="delimiter">(</a><a href="#232014" title="scalala.tensor.Matrix[T]">X</a><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="Int" id="232022">N</a>         = <a href="#232020" title="scalala.tensor.dense.DenseMatrix[Double]">m</a>.<a href="../tensor/dense/DenseMatrix.scala.html#64804" title="=&gt; Int">numRows</a>
    <span class="keyword">val</span> <a title="Int" id="232023">lwork</a>     = math.<span title="(x: Int, y: Int)Int">max</span><span class="delimiter">(</span><span title="Int(1)" class="int">1</span>, <a href="#232022" title="Int">N</a><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="Array[Double]" id="232024">work</a>      = <span title="object Array">Array</span>.<span title="[T](n1: Int)(implicit evidence$3: scala.reflect.ClassManifest[T])Array[T]">ofDim</span><span title="(n1: Int)(implicit evidence$3: scala.reflect.ClassManifest[Double])Array[Double]" class="delimiter">[</span><span title="Double">Double</span><span class="delimiter">]</span><span title="=&gt; scala.reflect.AnyValManifest[Double]" class="delimiter">(</span><a href="#232023" title="Int">lwork</a><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="org.netlib.util.intW" id="232025">info</a>      = <span title="org.netlib.util.intW" class="keyword">new</span> <span title="org.netlib.util.intW">intW</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
    <span title="object org.netlib.lapack.LAPACK">LAPACK</span>.<span title="()org.netlib.lapack.LAPACK">getInstance</span>.<span title="(x$1: Int, x$2: Array[Double], x$3: Int, x$4: Array[Int], x$5: Array[Double], x$6: Int, x$7: org.netlib.util.intW)Unit">dgetri</span><span class="delimiter">(</span>
      <a href="#232022" title="Int">N</a>, <a href="#232020" title="scalala.tensor.dense.DenseMatrix[Double]">m</a>.<a href="../tensor/dense/DenseMatrix.scala.html#64812" title="=&gt; Array[Double]">data</a>, math.<span title="(x: Int, y: Int)Int">max</span><span class="delimiter">(</span><span title="Int(1)" class="int">1</span>, <a href="#232022" title="Int">N</a><span class="delimiter">)</span> <span class="comment">/* LDA */</span>,
      <a href="#232021" title="Array[Int]">ipiv</a>,
      <a href="#232024" title="Array[Double]">work</a> <span class="comment">/* workspace */</span>, <a href="#232023" title="Int">lwork</a> <span class="comment">/* workspace size */</span>,
      <a href="#232025" title="org.netlib.util.intW">info</a>
    <span class="delimiter">)</span>
    <span title="(assertion: Boolean, message: =&gt; Any)Unit">assert</span><span class="delimiter">(</span><a href="#232025" title="org.netlib.util.intW">info</a>.<span title="Int">`val`</span> <span title="(x: Int)Boolean">&gt;=</span> <span title="Int(0)" class="int">0</span>, <span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;Malformed argument %d (LAPACK)&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><span title="=&gt; Int">-</span><a href="#232025" title="org.netlib.util.intW">info</a>.<span title="Int">`val`</span><span class="delimiter">)</span><span class="delimiter">)</span>

    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#232025" title="org.netlib.util.intW">info</a>.<span title="Int">`val`</span> <span title="(x: Int)Boolean">&gt;</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
      <span title="Nothing" class="keyword">throw</span> <a href="../tensor/MatrixSingularException.scala.html#232095" title="()scalala.tensor.MatrixSingularException" class="keyword">new</a> <a href="../tensor/MatrixSingularException.scala.html#17909" title="scalala.tensor.MatrixSingularException">MatrixSingularException</a>

    <a href="#232020" title="scalala.tensor.dense.DenseMatrix[Double]">m</a>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Computes the Moore-Penrose pseudo inverse of the given real matrix X.
   */</span>
  <span class="keyword">def</span> <a title="(X: scalala.tensor.dense.DenseMatrix[Double])scalala.tensor.dense.DenseMatrix[Double]" id="20709">pinv</a><span class="delimiter">(</span><a title="scalala.tensor.dense.DenseMatrix[Double]" id="232099">X</a>: <a href="../tensor/dense/DenseMatrix.scala.html#19127" title="scalala.tensor.dense.DenseMatrix[Double]">DenseMatrix</a><span class="delimiter">[</span>Double<span class="delimiter">]</span><span class="delimiter">)</span> : <a href="../tensor/dense/DenseMatrix.scala.html#19127" title="scalala.tensor.dense.DenseMatrix[Double]">DenseMatrix</a><span class="delimiter">[</span>Double<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <a href="#20667" title="(mat: scalala.tensor.Matrix[Double])Unit">requireNonEmptyMatrix</a><span class="delimiter">(</span><a href="#232099" title="scalala.tensor.dense.DenseMatrix[Double]">X</a><span class="delimiter">)</span>

    <span class="comment">// The pseudo inverse is nothing but the least-squares solution to AX=B,</span>
    <span class="comment">// hence:</span>
    <span class="comment">//       d/dX 1/2 (AX-B)^2 = A^T (AX-B)</span>
    <span class="comment">// Solving A^T (AX-B) = 0 for X yields</span>
    <span class="comment">//       A^T AX = A^T B</span>
    <span class="comment">//    =&gt;      X = (A^T A)^(-1) A^T B</span>

    <a href="#20706" title="(X: scalala.tensor.Matrix[Double])(implicit td: Double =&gt; Double)scalala.tensor.dense.DenseMatrix[Double]">inv</a><span title="&lt;:&lt;[Double,Double]" class="delimiter">(</span><a href="#232099" title="scalala.tensor.dense.DenseMatrix[Double]">X</a>.<a href="../tensor/mutable/Matrix.scala.html#49816" title="=&gt; scalala.tensor.mutable.Matrix[Double]">t</a> <a href="../operators/Ops.scala.html#44449" title="(b: scalala.tensor.dense.DenseMatrix[Double])(implicit op: scalala.operators.BinaryOp[scalala.tensor.mutable.Matrix[Double],scalala.tensor.dense.DenseMatrix[Double],scalala.operators.OpMulMatrixBy,scalala.tensor.mutable.Matrix[Double]])scalala.tensor.mutable.Matrix[Double]">*</a> <a href="#232099" title="scalala.tensor.dense.DenseMatrix[Double]">X</a><span class="delimiter">)</span> <a href="../operators/Ops.scala.html#44449" title="(b: scalala.tensor.mutable.Matrix[Double])(implicit op: scalala.operators.BinaryOp[scalala.tensor.dense.DenseMatrix[Double],scalala.tensor.mutable.Matrix[Double],scalala.operators.OpMulMatrixBy,scalala.tensor.dense.DenseMatrix[Double]])scalala.tensor.dense.DenseMatrix[Double]">*</a> <a href="#232099" title="scalala.tensor.dense.DenseMatrix[Double]">X</a>.<a href="../tensor/mutable/Matrix.scala.html#49816" title="=&gt; scalala.tensor.mutable.Matrix[Double]">t</a>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Computes the Moore-Penrose pseudo inverse of the given real matrix X.
   */</span>
  <span class="keyword">def</span> <a title="[V](X: scalala.tensor.dense.DenseMatrix[V])(implicit cast: V =&gt; Double)scalala.tensor.dense.DenseMatrix[Double]" id="20710">pinv</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="20712">V</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="scalala.tensor.dense.DenseMatrix[V]" id="363693">X</a>: <a href="../tensor/dense/DenseMatrix.scala.html#19127" title="scalala.tensor.dense.DenseMatrix[V]">DenseMatrix</a><span class="delimiter">[</span>V<span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="V =&gt; Double" id="363694">cast</a> : V=&gt;Double<span class="delimiter">)</span> : <a href="../tensor/dense/DenseMatrix.scala.html#19127" title="scalala.tensor.dense.DenseMatrix[Double]">DenseMatrix</a><span class="delimiter">[</span>Double<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <a href="#20667" title="(mat: scalala.tensor.Matrix[V])Unit">requireNonEmptyMatrix</a><span class="delimiter">(</span><a href="#363693" title="scalala.tensor.dense.DenseMatrix[V]">X</a><span class="delimiter">)</span>

    <span class="comment">// The pseudo inverse is nothing but the least-squares solution to AX=B,</span>
    <span class="comment">// hence:</span>
    <span class="comment">//       d/dX 1/2 (AX-B)^2 = A^T (AX-B)</span>
    <span class="comment">// Solving A^T (AX-B) = 0 for X yields</span>
    <span class="comment">//       A^T AX = A^T B</span>
    <span class="comment">//    =&gt;      X = (A^T A)^(-1) A^T B</span>

    <a href="#20709" title="(X: scalala.tensor.dense.DenseMatrix[Double])scalala.tensor.dense.DenseMatrix[Double]">pinv</a><span class="delimiter">(</span><a href="#363693" title="scalala.tensor.dense.DenseMatrix[V]">X</a>.<a href="../tensor/Tensor.scala.html#42290" title="(f: V =&gt; Double)(implicit bf: scalala.generic.collection.CanMapValues[scalala.tensor.dense.DenseMatrix[V],V,Double,scalala.tensor.dense.DenseMatrix[Double]])scalala.tensor.dense.DenseMatrix[Double]">mapValues</a><a href="../tensor/dense/DenseMatrix.scala.html#62320" title="(implicit evidence$9: ClassManifest[Double], implicit evidence$10: scalala.scalar.Scalar[Double])scalala.tensor.dense.DenseMatrix.DenseMatrixCanMapValues[V,Double]" class="delimiter">(</a><a href="#363694" title="V =&gt; Double">cast</a><span class="delimiter">)</span><span class="delimiter">)</span>;
  <span class="delimiter">}</span>

  <span class="comment">/**
   * A diagonal matrix whose elements are specified by the given vector.
   */</span>
  <span class="keyword">def</span> <a title="[S](v: scalala.tensor.Vector[S])(implicit s: scalala.scalar.Scalar[S])scalala.tensor.DiagonalMatrix[scalala.tensor.Vector[S],S]" id="20713">diag</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="20715">S</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="scalala.tensor.Vector[S]" id="364304">v</a>: scalala.tensor.<a href="../tensor/Vector.scala.html#17738" title="scalala.tensor.Vector[S]">Vector</a><span class="delimiter">[</span>S<span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scalala.scalar.Scalar[S]" id="364305">s</a>: <a href="../scalar/Scalar.scala.html#17481" title="scalala.scalar.Scalar[S]">Scalar</a><span class="delimiter">[</span>S<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../tensor/DiagonalMatrix.scala.html#17834" title="scalala.tensor.DiagonalMatrix[scalala.tensor.Vector[S],S]">DiagonalMatrix</a><span class="delimiter">[</span>Vector<span class="delimiter">[</span>S<span class="delimiter">]</span>, S<span class="delimiter">]</span> =
    <a href="#364305" title="scalala.tensor.DiagonalMatrix[scalala.tensor.Vector[S],S]" class="keyword">new</a> <a href="../tensor/DiagonalMatrix.scala.html#17834" title="scalala.tensor.DiagonalMatrix[scalala.tensor.Vector[S],S]">DiagonalMatrix</a><span class="delimiter">(</span><a href="#364304" title="scalala.tensor.Vector[S]">v</a><span class="delimiter">)</span>

  <span class="comment">/**
   * Vector cross product of 3D vectors a and b.
   */</span>
  <span class="keyword">def</span> <a title="[V1, V2, RV](a: scalala.tensor.dense.DenseVector[V1], b: scalala.tensor.dense.DenseVector[V2])(implicit mul: scalala.operators.BinaryOp[V1,V2,scalala.operators.OpMul,RV], implicit sub: scalala.operators.BinaryOp[RV,RV,scalala.operators.OpSub,RV], implicit s: scalala.scalar.Scalar[RV])scalala.tensor.dense.DenseVector[RV]" id="20716">cross</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="20720">V1</a>, <a title="&gt;: Nothing &lt;: Any" id="20721">V2</a>, <a title="&gt;: Nothing &lt;: Any" id="20722">RV</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="scalala.tensor.dense.DenseVector[V1]" id="364365">a</a>: <a href="../tensor/dense/DenseVector.scala.html#19049" title="scalala.tensor.dense.DenseVector[V1]">DenseVector</a><span class="delimiter">[</span>V1<span class="delimiter">]</span>, <a title="scalala.tensor.dense.DenseVector[V2]" id="364366">b</a>: <a href="../tensor/dense/DenseVector.scala.html#19049" title="scalala.tensor.dense.DenseVector[V2]">DenseVector</a><span class="delimiter">[</span>V2<span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">(</span>
    <span class="keyword">implicit</span> <a title="scalala.operators.BinaryOp[V1,V2,scalala.operators.OpMul,RV]" id="364367">mul</a>: <a href="../operators/BinaryOp.scala.html#11910" title="scalala.operators.BinaryOp[V1,V2,scalala.operators.OpMul,RV]">BinaryOp</a><span class="delimiter">[</span>V1, V2, OpMul, RV<span class="delimiter">]</span>,
    <a title="scalala.operators.BinaryOp[RV,RV,scalala.operators.OpSub,RV]" id="364368">sub</a>: <a href="../operators/BinaryOp.scala.html#11910" title="scalala.operators.BinaryOp[RV,RV,scalala.operators.OpSub,RV]">BinaryOp</a><span class="delimiter">[</span>RV, RV, OpSub, RV<span class="delimiter">]</span>,
    <a title="scalala.scalar.Scalar[RV]" id="364369">s</a>: <a href="../scalar/Scalar.scala.html#17481" title="scalala.scalar.Scalar[RV]">Scalar</a><span class="delimiter">[</span>RV<span class="delimiter">]</span>
  <span class="delimiter">)</span>: <a href="../tensor/dense/DenseVector.scala.html#19049" title="scalala.tensor.dense.DenseVector[RV]">DenseVector</a><span class="delimiter">[</span>RV<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span title="(requirement: Boolean)Unit">require</span><span class="delimiter">(</span><a href="#364365" title="scalala.tensor.dense.DenseVector[V1]">a</a>.<a href="../tensor/Vector.scala.html#42813" title="=&gt; Int">length</a> <span title="(x: Int)Boolean">==</span> <span title="Int(3)" class="int">3</span><span class="delimiter">)</span>
    <span title="(requirement: Boolean)Unit">require</span><span class="delimiter">(</span><a href="#364366" title="scalala.tensor.dense.DenseVector[V2]">b</a>.<a href="../tensor/Vector.scala.html#42813" title="=&gt; Int">length</a> <span title="(x: Int)Boolean">==</span> <span title="Int(3)" class="int">3</span><span class="delimiter">)</span>
    <a href="../tensor/dense/DenseVector.scala.html#43288" title="[V](values: V*)(implicit evidence$40: scalala.scalar.Scalar[V])scalala.tensor.dense.DenseVectorCol[V]">DenseVector</a><span title="(values: RV*)(implicit evidence$40: scalala.scalar.Scalar[RV])scalala.tensor.dense.DenseVectorCol[RV]" class="delimiter">[</span><a href="#20722" title="RV">RV</a><span class="delimiter">]</span><a href="#364369" title="scalala.scalar.Scalar[RV]" class="delimiter">(</a>
      <a href="#364368" title="(v1: RV, v2: RV)RV">sub</a><span class="delimiter">(</span><a href="#364367" title="(v1: V1, v2: V2)RV">mul</a><span class="delimiter">(</span><a href="../tensor/dense/DenseVector.scala.html#42769" title="(key: Int)V1">a</a><span class="delimiter">(</span><span title="Int(1)" class="int">1</span><span class="delimiter">)</span>, <a href="../tensor/dense/DenseVector.scala.html#42769" title="(key: Int)V2">b</a><span class="delimiter">(</span><span title="Int(2)" class="int">2</span><span class="delimiter">)</span><span class="delimiter">)</span>, <a href="#364367" title="(v1: V1, v2: V2)RV">mul</a><span class="delimiter">(</span><a href="../tensor/dense/DenseVector.scala.html#42769" title="(key: Int)V1">a</a><span class="delimiter">(</span><span title="Int(2)" class="int">2</span><span class="delimiter">)</span>, <a href="../tensor/dense/DenseVector.scala.html#42769" title="(key: Int)V2">b</a><span class="delimiter">(</span><span title="Int(1)" class="int">1</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>,
      <a href="#364368" title="(v1: RV, v2: RV)RV">sub</a><span class="delimiter">(</span><a href="#364367" title="(v1: V1, v2: V2)RV">mul</a><span class="delimiter">(</span><a href="../tensor/dense/DenseVector.scala.html#42769" title="(key: Int)V1">a</a><span class="delimiter">(</span><span title="Int(2)" class="int">2</span><span class="delimiter">)</span>, <a href="../tensor/dense/DenseVector.scala.html#42769" title="(key: Int)V2">b</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span><span class="delimiter">)</span>, <a href="#364367" title="(v1: V1, v2: V2)RV">mul</a><span class="delimiter">(</span><a href="../tensor/dense/DenseVector.scala.html#42769" title="(key: Int)V1">a</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>, <a href="../tensor/dense/DenseVector.scala.html#42769" title="(key: Int)V2">b</a><span class="delimiter">(</span><span title="Int(2)" class="int">2</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>,
      <a href="#364368" title="(v1: RV, v2: RV)RV">sub</a><span class="delimiter">(</span><a href="#364367" title="(v1: V1, v2: V2)RV">mul</a><span class="delimiter">(</span><a href="../tensor/dense/DenseVector.scala.html#42769" title="(key: Int)V1">a</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>, <a href="../tensor/dense/DenseVector.scala.html#42769" title="(key: Int)V2">b</a><span class="delimiter">(</span><span title="Int(1)" class="int">1</span><span class="delimiter">)</span><span class="delimiter">)</span>, <a href="#364367" title="(v1: V1, v2: V2)RV">mul</a><span class="delimiter">(</span><a href="../tensor/dense/DenseVector.scala.html#42769" title="(key: Int)V1">a</a><span class="delimiter">(</span><span title="Int(1)" class="int">1</span><span class="delimiter">)</span>, <a href="../tensor/dense/DenseVector.scala.html#42769" title="(key: Int)V2">b</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Computes the rank of a DenseMatrix[Double].
   *
   * The rank of the matrix is computed using the SVD method.  The singular values of the SVD
   * which are greater than a specified tolerance are counted.
   *
   * @param m matrix for which to compute the rank
   * @param tol optional tolerance for singular values.  If not supplied, the default
   *   tolerance is: max(m.numCols, m.numRows) * eps * sigma_max, where
   *   eps is the machine epsilon and sigma_max is the largest singular value of m.
   * @return the rank of the matrix (number of singular values)
   */</span>
  <span class="keyword">def</span> <a title="(m: scalala.tensor.dense.DenseMatrix[Double], tol: Option[Double])Int" id="20723">rank</a><span class="delimiter">(</span><a title="scalala.tensor.dense.DenseMatrix[Double]" id="366111">m</a>: <a href="../tensor/dense/DenseMatrix.scala.html#19127" title="scalala.tensor.dense.DenseMatrix[Double]">DenseMatrix</a><span class="delimiter">[</span>Double<span class="delimiter">]</span>, <a title="Option[Double]" id="366114">tol</a>: <span title="Option[Double]">Option</span><span class="delimiter">[</span>Double<span class="delimiter">]</span> = <span title="object None">None</span><span class="delimiter">)</span>: <span title="Int">Int</span> = <span class="delimiter">{</span>    
    <span class="keyword">val</span> <a href="#366116" title="(scalala.tensor.dense.DenseMatrix[Double], scalala.tensor.dense.DenseVector[Double], scalala.tensor.dense.DenseMatrix[Double])" class="delimiter">(</a><a href="#366115" title="scalala.tensor.dense.DenseMatrix[Double]" id="366116">u</a>, <a href="#366115" title="scalala.tensor.dense.DenseVector[Double]" id="366117">s</a>, <a href="#366115" title="scalala.tensor.dense.DenseMatrix[Double]" id="366118">vt</a><span class="delimiter">)</span> = <a href="#20677" title="(mat: scalala.tensor.dense.DenseMatrix[Double])(scalala.tensor.dense.DenseMatrix[Double], scalala.tensor.dense.DenseVector[Double], scalala.tensor.dense.DenseMatrix[Double])">svd</a><span title="(scalala.tensor.dense.DenseMatrix[Double], scalala.tensor.dense.DenseVector[Double], scalala.tensor.dense.DenseMatrix[Double]) @unchecked" class="delimiter">(</span><a href="#366111" title="scalala.tensor.dense.DenseMatrix[Double]">m</a><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="Double" id="366119">useTol</a> = <a href="#366114" title="Option[Double]">tol</a>.<span title="(default: =&gt; Double)Double">getOrElse</span> <span class="delimiter">{</span>
      <span class="comment">// we called LAPACK for the SVD method, so this is the LAPACK definition of eps.</span>
      <span class="keyword">val</span> <a title="Double" id="366139">eps</a>: <span title="Double">Double</span> = <span title="Double(2.0)" class="double">2.0</span> <span title="(x: Double)Double">*</span> <span title="object org.netlib.lapack.LAPACK">LAPACK</span>.<span title="()org.netlib.lapack.LAPACK">getInstance</span>.<span title="(x$1: java.lang.String)Double">dlamch</span><span class="delimiter">(</span><span title="java.lang.String(&quot;e&quot;)" class="string">&quot;e&quot;</span><span class="delimiter">)</span>
      math.<span title="(x: Int, y: Int)Int">max</span><span class="delimiter">(</span><a href="#366111" title="scalala.tensor.dense.DenseMatrix[Double]">m</a>.<a href="../tensor/dense/DenseMatrix.scala.html#64806" title="=&gt; Int">numCols</a>, <a href="#366111" title="scalala.tensor.dense.DenseMatrix[Double]">m</a>.<a href="../tensor/dense/DenseMatrix.scala.html#64804" title="=&gt; Int">numRows</a><span class="delimiter">)</span> <span title="(x: Double)Double">*</span> <a href="#366139" title="Double">eps</a> <span title="(x: Double)Double">*</span> <a href="#366117" title="scalala.tensor.dense.DenseVector[Double]">s</a>.<a href="../tensor/Tensor.scala.html#42373" title="=&gt; Double">max</a>
    <span class="delimiter">}</span>
    <a href="#366117" title="scalala.tensor.dense.DenseVector[Double]">s</a>.<a href="../tensor/dense/DenseArrayTensor.scala.html#42908" title="implicit scala.Predef.doubleArrayOps : (xs: Array[Double])scala.collection.mutable.ArrayOps[Double]">data</a>.<span title="(p: Double =&gt; Boolean)Int">count</span><span class="delimiter">(</span><a href="#366343" title="Double">_</a> <span title="(x: Double)Boolean">&gt;</span> <a href="#366119" title="Double">useTol</a><span class="delimiter">)</span>  <span class="comment">// TODO: Use DenseVector[_].count() if/when that is implemented</span>
  <span class="delimiter">}</span>

<span class="delimiter">}</span>

<span class="keyword">object</span> <a title="object scalala.library.LinearAlgebra" id="12710">LinearAlgebra</a> <span title="ScalaObject" class="keyword">extends</span> <a href="#12709" title="scalala.library.LinearAlgebra">LinearAlgebra</a>;


<span class="comment">/**
 * Exception thrown if a routine has not converged.
 */</span>
<span class="keyword">class</span> <a title="class NotConvergedException extends java.lang.RuntimeException with ScalaObject" id="12511">NotConvergedException</a><a href="#12511" title="ScalaObject" class="delimiter">(</a><span class="keyword">val</span> <a title="scalala.library.NotConvergedException.Reason" id="219305">reason</a>: NotConvergedException.<a href="#219308" title="scalala.library.NotConvergedException.Reason">Reason</a>, <a title="String" id="219315">msg</a>: <span title="String">String</span> = <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span>
<span class="keyword">extends</span> <span title="java.lang.RuntimeException">RuntimeException</span><span class="delimiter">(</span><a href="#219315" title="String">msg</a><span class="delimiter">)</span>

<span class="keyword">object</span> <a title="object scalala.library.NotConvergedException" id="366368">NotConvergedException</a> <span title="ScalaObject" class="delimiter">{</span>
  <span class="keyword">trait</span> <a title="trait Reason extends java.lang.Object" id="219308">Reason</a>;
  <span class="keyword">object</span> <a title="object scalala.library.NotConvergedException.Iterations" id="219309">Iterations</a> <span title="ScalaObject" class="keyword">extends</span> <a href="#219308" title="scalala.library.NotConvergedException.Reason">Reason</a>;
  <span class="keyword">object</span> <a title="object scalala.library.NotConvergedException.Divergence" id="219311">Divergence</a> <span title="ScalaObject" class="keyword">extends</span> <a href="#219308" title="scalala.library.NotConvergedException.Reason">Reason</a>;
  <span class="keyword">object</span> <a title="object scalala.library.NotConvergedException.Breakdown" id="219313">Breakdown</a> <span title="ScalaObject" class="keyword">extends</span> <a href="#219308" title="scalala.library.NotConvergedException.Reason">Reason</a>;
<span class="delimiter">}</span>

<span class="keyword">class</span> <a title="class MatrixNotSymmetricException extends java.lang.IllegalArgumentException with ScalaObject" id="12547">MatrixNotSymmetricException</a>
<a href="#12547" title="ScalaObject" class="keyword">extends</a> <span title="java.lang.IllegalArgumentException">IllegalArgumentException</span><span class="delimiter">(</span><span title="java.lang.String(&quot;Matrix is not symmetric&quot;)" class="string">&quot;Matrix is not symmetric&quot;</span><span class="delimiter">)</span>;

<span class="keyword">class</span> <a title="class MatrixNotSquareException extends java.lang.IllegalArgumentException with ScalaObject" id="12736">MatrixNotSquareException</a>
<a href="#12736" title="ScalaObject" class="keyword">extends</a> <span title="java.lang.IllegalArgumentException">IllegalArgumentException</span><span class="delimiter">(</span><span title="java.lang.String(&quot;Matrix is not square&quot;)" class="string">&quot;Matrix is not square&quot;</span><span class="delimiter">)</span>;

<span class="keyword">class</span> <a title="class MatrixEmptyException extends java.lang.IllegalArgumentException with ScalaObject" id="12679">MatrixEmptyException</a>
<a href="#12679" title="ScalaObject" class="keyword">extends</a> <span title="java.lang.IllegalArgumentException">IllegalArgumentException</span><span class="delimiter">(</span><span title="java.lang.String(&quot;Matrix is empty&quot;)" class="string">&quot;Matrix is empty&quot;</span><span class="delimiter">)</span>;


        </pre>
    </body>
</html>