<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>play/play/api/controllers/Assets.scala</title>
        <script type="text/javascript" src="../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> controllers

<span class="keyword">import</span> play.api._
<span class="keyword">import</span> play.api.mvc._
<span class="keyword">import</span> play.api.libs._
<span class="keyword">import</span> play.api.libs.iteratee._

<span class="keyword">import</span> <a href="../Play.scala.html#10578" title="object play.api.Play">Play</a>.current

<span class="keyword">import</span> java.io._
<span class="keyword">import</span> scalax.io.<span class="delimiter">{</span> Resource <span class="delimiter">}</span>
<span class="keyword">import</span> java.text.SimpleDateFormat
<span class="keyword">import</span> collection.<span title="object scala.collection.JavaConverters">JavaConverters</span>._

<span class="comment">/**
 * Controller that serves static resources.
 *
 * Resources are searched in the classpath.
 *
 * It handles Last-Modified and ETag header automatically.
 * If a gzipped version of a resource is found (Same resource name with the .gz suffix), it is served instead.
 *
 * You can set a custom Cache directive for a particular resource if needed. For example in your application.conf file:
 *
 * {{{
 * &quot;assets.cache./public/images/logo.png&quot; = &quot;max-age=3600&quot;
 * }}}
 *
 * You can use this controller in any application, just by declaring the appropriate route. For example:
 * {{{
 * GET     /assets/\uFEFF*file               controllers.Assets.at(path=&quot;/public&quot;, file)
 * }}}
 */</span>
<span class="keyword">object</span> <a title="object controllers.Assets" id="11009">Assets</a> <span title="ScalaObject" class="keyword">extends</span> <a href="../mvc/Controller.scala.html#16579" title="play.api.mvc.Controller">Controller</a> <span class="delimiter">{</span>

  <span class="comment">/**
   * Generates an `Action` that serves a static resource.
   *
   * @param path the root folder for searching the static resource files, such as `&quot;/public&quot;`
   * @param file the file part extracted from the URL
   */</span>
  <span class="keyword">def</span> <a title="(path: String, file: String)play.api.mvc.Action[play.api.mvc.AnyContent]" id="98176">at</a><span class="delimiter">(</span><a title="String" id="99001">path</a>: <span title="String">String</span>, <a title="String" id="99002">file</a>: <span title="String">String</span><span class="delimiter">)</span>: <a href="../mvc/Action.scala.html#15772" title="play.api.mvc.Action[play.api.mvc.AnyContent]">Action</a><span class="delimiter">[</span>AnyContent<span class="delimiter">]</span> = <a href="../mvc/Action.scala.html#99008" title="(block: play.api.mvc.Request[play.api.mvc.AnyContent] =&gt; play.api.mvc.Result)play.api.mvc.Action[play.api.mvc.AnyContent]">Action</a> <span class="delimiter">{</span> <a title="play.api.mvc.Request[play.api.mvc.AnyContent]" id="99040">request</a> =&gt;

    <span class="keyword">val</span> <a title="java.lang.String" id="99041">resourceName</a> = <span title="(x: java.lang.String)Option[java.lang.String]">Option</span><span class="delimiter">(</span><a href="#99001" title="String">path</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;/&quot;)" class="string">&quot;/&quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#99002" title="String">file</a><span class="delimiter">)</span>.<span title="(f: java.lang.String =&gt; java.lang.String)Option[java.lang.String]">map</span><span class="delimiter">(</span><a title="java.lang.String" id="99049">name</a> =&gt; <span title="java.lang.String" class="keyword">if</span> <span class="delimiter">(</span><a href="#99049" title="java.lang.String">name</a>.<span title="(x$1: java.lang.String)Boolean">startsWith</span><span class="delimiter">(</span><span title="java.lang.String(&quot;/&quot;)" class="string">&quot;/&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span> <a href="#99049" title="java.lang.String">name</a> <span class="keyword">else</span> <span class="delimiter">(</span><span title="java.lang.String(&quot;/&quot;)" class="string">&quot;/&quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#99049" title="java.lang.String">name</a><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="=&gt; java.lang.String">get</span>

    <span title="play.api.mvc.Result" class="keyword">if</span> <span class="delimiter">(</span><span title="java.io.File" class="keyword">new</span> <span title="java.io.File">File</span><span class="delimiter">(</span><a href="#99041" title="java.lang.String">resourceName</a><span class="delimiter">)</span>.<span title="()Boolean">isDirectory</span> <span title="(x: Boolean)Boolean">||</span> <span title="=&gt; Boolean">!</span><span title="java.io.File" class="keyword">new</span> <span title="java.io.File">File</span><span class="delimiter">(</span><a href="#99041" title="java.lang.String">resourceName</a><span class="delimiter">)</span>.<span title="()java.lang.String">getCanonicalPath</span>.<span title="(x$1: java.lang.String)Boolean">startsWith</span><span class="delimiter">(</span><span title="java.io.File" class="keyword">new</span> <span title="java.io.File">File</span><span class="delimiter">(</span><a href="#99001" title="String">path</a><span class="delimiter">)</span>.<span title="()java.lang.String">getCanonicalPath</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="../mvc/Results.scala.html#64426" title="=&gt; controllers.Assets.Status">NotFound</a>
    <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>

      <span class="keyword">val</span> <a title="Option[(java.net.URL, Boolean)]" id="99067">resource</a> = <span class="delimiter">{</span>
        <a href="../Play.scala.html#10578" title="object play.api.Play">Play</a>.<a href="../Play.scala.html#70664" title="(name: String)(implicit app: play.api.Application)Option[java.net.URL]">resource</a><a href="../Play.scala.html#70657" title="=&gt; play.api.Application" class="delimiter">(</a><a href="#99041" title="java.lang.String">resourceName</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;.gz&quot;)" class="string">&quot;.gz&quot;</span><span class="delimiter">)</span>.<span title="(f: java.net.URL =&gt; (java.net.URL, Boolean))Option[(java.net.URL, Boolean)]">map</span><span class="delimiter">(</span><a href="#99072" title="(x: java.net.URL)ArrowAssoc[java.net.URL]">_</a> <span title="(y: Boolean)(java.net.URL, Boolean)">-&gt;</span> <span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span>
          .<span title="(p: (java.net.URL, Boolean) =&gt; Boolean)Option[(java.net.URL, Boolean)]">filter</span><span class="delimiter">(</span><a title="(java.net.URL, Boolean)" id="99092">_</a> =&gt; <a href="#99040" title="play.api.mvc.Request[play.api.mvc.AnyContent]">request</a>.<a href="../mvc/Http.scala.html#63785" title="=&gt; play.api.mvc.Headers">headers</a>.<a href="../mvc/Http.scala.html#63533" title="(key: String)Option[String]">get</a><span class="delimiter">(</span><a href="../http/StandardValues.scala.html#68348" title="=&gt; java.lang.String">ACCEPT_ENCODING</a><span class="delimiter">)</span>.<span title="(f: String =&gt; Boolean)Option[Boolean]">map</span><span class="delimiter">(</span><a href="#99099" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">_</a>.<span title="(separator: Char)Array[String]">split</span><span title="(xs: Array[String])scala.collection.mutable.ArrayOps[String]" class="delimiter">(</span><span title="Char(\',\')" class="char">','</span><span class="delimiter">)</span>.<span title="(p: String =&gt; Boolean)Boolean">exists</span><span class="delimiter">(</span><a href="#99393" title="String">_</a> <span title="(x$1: AnyRef)Boolean">==</span> <span title="java.lang.String(&quot;gzip&quot;)" class="string">&quot;gzip&quot;</span> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="../Play.scala.html#10578" title="object play.api.Play">Play</a>.<a href="../Play.scala.html#70674" title="(implicit app: play.api.Application)Boolean">isProd</a><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="(default: =&gt; Boolean)Boolean">getOrElse</span><span class="delimiter">(</span><span title="Boolean(false)" class="keyword">false</span><span class="delimiter">)</span><span class="delimiter">)</span>
          .<span title="(alternative: =&gt; Option[(java.net.URL, Boolean)])Option[(java.net.URL, Boolean)]">orElse</span><span class="delimiter">(</span><a href="../Play.scala.html#10578" title="object play.api.Play">Play</a>.<a href="../Play.scala.html#70664" title="(name: String)(implicit app: play.api.Application)Option[java.net.URL]">resource</a><a href="../Play.scala.html#70657" title="=&gt; play.api.Application" class="delimiter">(</a><a href="#99041" title="java.lang.String">resourceName</a><span class="delimiter">)</span>.<span title="(f: java.net.URL =&gt; (java.net.URL, Boolean))Option[(java.net.URL, Boolean)]">map</span><span class="delimiter">(</span><a href="#99412" title="(x: java.net.URL)ArrowAssoc[java.net.URL]">_</a> <span title="(y: Boolean)(java.net.URL, Boolean)">-&gt;</span> <span title="Boolean(false)" class="keyword">false</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>

      <a href="#99067" title="Option[(java.net.URL, Boolean)]">resource</a>.<span title="(f: (java.net.URL, Boolean) =&gt; play.api.mvc.SimpleResult[_ &gt;: play.api.mvc.Results.EmptyContent with _13 &lt;: java.io.Serializable])Option[play.api.mvc.SimpleResult[_ &gt;: play.api.mvc.Results.EmptyContent with _13 &lt;: java.io.Serializable]]">map</span> <a href="#99435" title="play.api.mvc.SimpleResult[_14]" class="delimiter">{</a>

        <span class="keyword">case</span> <span title="controllers.Assets.Status" class="delimiter">(</span><a title="java.net.URL" id="99438">url</a>, _<span class="delimiter">)</span> <span class="keyword">if</span> <span title="java.io.File" class="keyword">new</span> <span title="java.io.File">File</span><span class="delimiter">(</span><a href="#99438" title="java.net.URL">url</a>.<span title="()java.lang.String">getFile</span><span class="delimiter">)</span>.<span title="()Boolean">isDirectory</span> =&gt; <a href="../mvc/Results.scala.html#64426" title="=&gt; controllers.Assets.Status">NotFound</a>

        <span class="keyword">case</span> <span title="play.api.mvc.SimpleResult[_13]" class="delimiter">(</span><a title="java.net.URL" id="99445">url</a>, <a title="Boolean" id="99446">isGzipped</a><span class="delimiter">)</span> =&gt; <span class="delimiter">{</span>

          <span class="keyword">lazy</span> <span class="keyword">val</span> <a href="#99450" title="(Int, java.lang.Object with play.api.libs.iteratee.Enumerator[Array[Byte]])" class="delimiter">(</a><a href="#99447" title="Int" id="99450">length</a>, <a href="#99447" title="fromCallback extends java.lang.Object with play.api.libs.iteratee.Enumerator[Array[Byte]]" id="99452">resourceData</a><span class="delimiter">)</span> = <span title="(Int, java.lang.Object with play.api.libs.iteratee.Enumerator[Array[Byte]]) @unchecked" class="delimiter">{</span>
            <span class="keyword">val</span> <a title="java.io.InputStream" id="99453">stream</a> = <a href="#99445" title="java.net.URL">url</a>.<span title="()java.io.InputStream">openStream</span><span class="delimiter">(</span><span class="delimiter">)</span>
            <span class="keyword">try</span> <span class="delimiter">{</span>
              <span title="(_1: Int, _2: java.lang.Object with play.api.libs.iteratee.Enumerator[Array[Byte]])(Int, java.lang.Object with play.api.libs.iteratee.Enumerator[Array[Byte]])" class="delimiter">(</span><a href="#99453" title="java.io.InputStream">stream</a>.<span title="()Int">available</span>, <a href="../libs/iteratee/Iteratee.scala.html#13947" title="object play.api.libs.iteratee.Enumerator">Enumerator</a>.<a href="../libs/iteratee/Iteratee.scala.html#99485" title="(input: java.io.InputStream, chunkSize: Int)java.lang.Object with play.api.libs.iteratee.Enumerator[Array[Byte]]">fromStream</a><span class="delimiter">(</span><a href="#99453" title="java.io.InputStream">stream</a><span class="delimiter">)</span><span class="delimiter">)</span>
            <span class="delimiter">}</span> <span class="keyword">catch</span> <span class="delimiter">{</span>
              <span class="keyword">case</span> <span title="(Int, play.api.libs.iteratee.Enumerator[Array[Byte]])">_</span> =&gt; <span title="(_1: Int, _2: play.api.libs.iteratee.Enumerator[Array[Byte]])(Int, play.api.libs.iteratee.Enumerator[Array[Byte]])" class="delimiter">(</span><span title="Int(0)" class="int">0</span>, <a href="../libs/iteratee/Iteratee.scala.html#99490" title="[E](in: E*)play.api.libs.iteratee.Enumerator[E]">Enumerator</a><span title="(in: Array[Byte]*)play.api.libs.iteratee.Enumerator[Array[Byte]]" class="delimiter">[</span><span title="Array[Byte]">Array</span><span class="delimiter">[</span>Byte<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
            <span class="delimiter">}</span>
          <span class="delimiter">}</span>
          
          <span title="play.api.mvc.SimpleResult[_13]" class="keyword">if</span><span class="delimiter">(</span><a href="#99449" title="=&gt; Int">length</a> <span title="(x: Int)Boolean">==</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span class="delimiter">{</span>
            <a href="../mvc/Results.scala.html#64426" title="=&gt; controllers.Assets.Status">NotFound</a>
          <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
            
            <a href="#99040" title="play.api.mvc.Request[play.api.mvc.AnyContent]">request</a>.<a href="../mvc/Http.scala.html#63785" title="=&gt; play.api.mvc.Headers">headers</a>.<a href="../mvc/Http.scala.html#63533" title="(key: String)Option[String]">get</a><span class="delimiter">(</span><a href="../http/StandardValues.scala.html#68400" title="=&gt; java.lang.String">IF_NONE_MATCH</a><span class="delimiter">)</span>.<span title="(p: String =&gt; Boolean)Option[String]">filter</span><span class="delimiter">(</span><span title="(x: String)Some[String]">Some</span><span class="delimiter">(</span><a href="#99753" title="String">_</a><span class="delimiter">)</span> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#98184" title="(resource: java.net.URL)Option[String]">etagFor</a><span class="delimiter">(</span><a href="#99445" title="java.net.URL">url</a><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="(f: String =&gt; play.api.mvc.SimpleResult[play.api.mvc.Results.EmptyContent])Option[play.api.mvc.SimpleResult[play.api.mvc.Results.EmptyContent]]">map</span><span class="delimiter">(</span><a title="String" id="99768">_</a> =&gt; <a href="../mvc/Results.scala.html#64417" title="=&gt; play.api.mvc.SimpleResult[play.api.mvc.Results.EmptyContent]">NotModified</a><span class="delimiter">)</span>.<span title="(default: =&gt; play.api.mvc.SimpleResult[_ &gt;: play.api.mvc.Results.EmptyContent with Array[Byte] &lt;: java.io.Serializable])play.api.mvc.SimpleResult[_ &gt;: play.api.mvc.Results.EmptyContent with Array[Byte] &lt;: java.io.Serializable]">getOrElse</span> <span class="delimiter">{</span>

              <span class="comment">// Prepare a streamed response</span>
              <span class="keyword">val</span> <a title="play.api.mvc.SimpleResult[Array[Byte]]" id="99817">response</a> = <a href="../mvc/Results.scala.html#72574" title="(header: play.api.mvc.ResponseHeader, body: play.api.libs.iteratee.Enumerator[Array[Byte]])(implicit writeable: play.api.http.Writeable[Array[Byte]])play.api.mvc.SimpleResult[Array[Byte]]">SimpleResult</a><a href="../http/Writeable.scala.html#90329" title="=&gt; play.api.http.Writeable[Array[Byte]]" class="delimiter">(</a>
                header = <a href="../mvc/Results.scala.html#99783" title="(status: Int, headers: Map[String,String])play.api.mvc.ResponseHeader">ResponseHeader</a><span class="delimiter">(</span><a href="../http/StandardValues.scala.html#68209" title="=&gt; Int">OK</a>, <span title="(elems: (java.lang.String, String)*)scala.collection.immutable.Map[java.lang.String,String]">Map</span><span class="delimiter">(</span>
                  <a href="../http/StandardValues.scala.html#68370" title="(x: java.lang.String)ArrowAssoc[java.lang.String]">CONTENT_LENGTH</a> <span title="(y: java.lang.String)(java.lang.String, java.lang.String)">-&gt;</span> <a href="#99449" title="=&gt; Int">length</a>.<span title="()java.lang.String">toString</span>,
                  <a href="../http/StandardValues.scala.html#68380" title="(x: java.lang.String)ArrowAssoc[java.lang.String]">CONTENT_TYPE</a> <span title="(y: String)(java.lang.String, String)">-&gt;</span> <a href="../libs/MimeTypes.scala.html#13010" title="object play.api.libs.MimeTypes">MimeTypes</a>.<a href="../libs/MimeTypes.scala.html#99864" title="(name: String)Option[String]">forFileName</a><span class="delimiter">(</span><a href="#99002" title="String">file</a><span class="delimiter">)</span>.<span title="(default: =&gt; String)String">getOrElse</span><span class="delimiter">(</span><a href="../http/StandardValues.scala.html#98199" title="=&gt; java.lang.String">BINARY</a><span class="delimiter">)</span>
                <span class="delimiter">)</span><span class="delimiter">)</span>,
                <a href="#99451" title="=&gt; java.lang.Object with play.api.libs.iteratee.Enumerator[Array[Byte]]">resourceData</a>
              <span class="delimiter">)</span>

              <span class="comment">// Is Gzipped?</span>
              <span class="keyword">val</span> <a title="play.api.mvc.SimpleResult[Array[Byte]]" id="99818">gzippedResponse</a> = <span title="play.api.mvc.SimpleResult[Array[Byte]]" class="keyword">if</span> <span class="delimiter">(</span><a href="#99446" title="Boolean">isGzipped</a><span class="delimiter">)</span> <span class="delimiter">{</span>
                <a href="#99817" title="play.api.mvc.SimpleResult[Array[Byte]]">response</a>.<a href="../mvc/Results.scala.html#72599" title="(headers: (String, String)*)play.api.mvc.SimpleResult[Array[Byte]]">withHeaders</a><span class="delimiter">(</span><a href="../http/StandardValues.scala.html#68366" title="(x: java.lang.String)ArrowAssoc[java.lang.String]">CONTENT_ENCODING</a> <span title="(y: java.lang.String)(java.lang.String, java.lang.String)">-&gt;</span> <span title="java.lang.String(&quot;gzip&quot;)" class="string">&quot;gzip&quot;</span><span class="delimiter">)</span>
              <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
                <a href="#99817" title="play.api.mvc.SimpleResult[Array[Byte]]">response</a>
              <span class="delimiter">}</span>

              <span class="comment">// Add Etag if we are able to compute it</span>
              <span class="keyword">val</span> <a title="play.api.mvc.SimpleResult[Array[Byte]]" id="99819">taggedResponse</a> = <a href="#98184" title="(resource: java.net.URL)Option[String]">etagFor</a><span class="delimiter">(</span><a href="#99445" title="java.net.URL">url</a><span class="delimiter">)</span>.<span title="(f: String =&gt; play.api.mvc.SimpleResult[Array[Byte]])Option[play.api.mvc.SimpleResult[Array[Byte]]]">map</span><span class="delimiter">(</span><a title="String" id="100183">etag</a> =&gt; <a href="#99818" title="play.api.mvc.SimpleResult[Array[Byte]]">gzippedResponse</a>.<a href="../mvc/Results.scala.html#72599" title="(headers: (String, String)*)play.api.mvc.SimpleResult[Array[Byte]]">withHeaders</a><span class="delimiter">(</span><a href="../http/StandardValues.scala.html#68386" title="(x: java.lang.String)ArrowAssoc[java.lang.String]">ETAG</a> <span title="(y: String)(java.lang.String, String)">-&gt;</span> <a href="#100183" title="String">etag</a><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="(default: =&gt; play.api.mvc.SimpleResult[Array[Byte]])play.api.mvc.SimpleResult[Array[Byte]]">getOrElse</span><span class="delimiter">(</span><a href="#99818" title="play.api.mvc.SimpleResult[Array[Byte]]">gzippedResponse</a><span class="delimiter">)</span>

              <span class="comment">// Add Cache directive if configured</span>
              <span class="keyword">val</span> <a title="play.api.mvc.SimpleResult[Array[Byte]]" id="99820">cachedResponse</a> = <a href="#99819" title="play.api.mvc.SimpleResult[Array[Byte]]">taggedResponse</a>.<a href="../mvc/Results.scala.html#72599" title="(headers: (String, String)*)play.api.mvc.SimpleResult[Array[Byte]]">withHeaders</a><span class="delimiter">(</span><a href="../http/StandardValues.scala.html#68360" title="(x: java.lang.String)ArrowAssoc[java.lang.String]">CACHE_CONTROL</a> <span title="(y: String)(java.lang.String, String)">-&gt;</span> <span class="delimiter">{</span>
                <a href="../Play.scala.html#10578" title="object play.api.Play">Play</a>.<a href="../Play.scala.html#70669" title="play.api.Configuration" id="100221">configuration</a>.<a href="../Configuration.scala.html#79477" title="Option[Set[String]]" id="100223">getString</a><span class="delimiter">(</span><span title="java.lang.String(&quot;\&quot;assets.cache.&quot;)" class="string">&quot;\&quot;assets.cache.&quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#99041" title="java.lang.String">resourceName</a> <a title="java.lang.String" id="100222">+</a> <span title="java.lang.String(&quot;\&quot;&quot;)" class="string">&quot;\&quot;&quot;</span><span class="delimiter">)</span>.<span title="(default: =&gt; String)String">getOrElse</span><span class="delimiter">(</span><a href="../Play.scala.html#10578" title="object play.api.Play">Play</a>.<a href="../Play.scala.html#70672" title="(implicit app: play.api.Application)play.api.Mode.Mode">mode</a> <span title="String" class="keyword">match</span> <span class="delimiter">{</span>
                  <span class="keyword">case</span> <a href="../Play.scala.html#10533" title="String">Mode</a>.<a href="../Play.scala.html#65466" title="=&gt; play.api.Mode.Value">Prod</a> =&gt; <a href="../Play.scala.html#10578" title="object play.api.Play">Play</a>.<a href="../Play.scala.html#70669" title="play.api.Configuration" id="100228">configuration</a>.<a href="../Configuration.scala.html#79477" title="Option[Set[String]]" id="100230">getString</a><span class="delimiter">(</span><a title="java.lang.String(&quot;assets.defaultCache&quot;)" id="100229" class="string">&quot;assets.defaultCache&quot;</a><span class="delimiter">)</span>.<span title="(default: =&gt; String)String">getOrElse</span><span class="delimiter">(</span><span title="java.lang.String(&quot;max-age=3600&quot;)" class="string">&quot;max-age=3600&quot;</span><span class="delimiter">)</span>
                  <span class="keyword">case</span> <span title="java.lang.String(&quot;no-cache&quot;)">_</span> =&gt; <span title="java.lang.String(&quot;no-cache&quot;)" class="string">&quot;no-cache&quot;</span>
                <span class="delimiter">}</span><span class="delimiter">)</span>
              <span class="delimiter">}</span><span class="delimiter">)</span>

              <a href="#99820" title="play.api.mvc.SimpleResult[Array[Byte]]">cachedResponse</a>

            <span class="delimiter">}</span>

          <span class="delimiter">}</span>
            
        <span class="delimiter">}</span>  

      <span class="delimiter">}</span>.<span title="(default: =&gt; play.api.mvc.SimpleResult[_ &gt;: play.api.mvc.Results.EmptyContent with _13 &lt;: java.io.Serializable])play.api.mvc.SimpleResult[_ &gt;: play.api.mvc.Results.EmptyContent with _13 &lt;: java.io.Serializable]">getOrElse</span><span class="delimiter">(</span><a href="../mvc/Results.scala.html#64426" title="=&gt; controllers.Assets.Status">NotFound</a><span class="delimiter">)</span>

    <span class="delimiter">}</span>

  <span class="delimiter">}</span>

  <span class="comment">// -- LastModified handling</span>

  <span class="keyword">private</span> <span class="keyword">val</span> <a title="java.text.SimpleDateFormat" id="98177">dateFormatter</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="java.text.SimpleDateFormat" id="98201">formatter</a> = <span title="(x$1: java.lang.String)java.text.SimpleDateFormat" class="keyword">new</span> <span title="java.text.SimpleDateFormat">SimpleDateFormat</span><span class="delimiter">(</span><span title="java.lang.String(&quot;EEE, dd MMM yyyy HH:mm:ss zzz&quot;)" class="string">&quot;EEE, dd MMM yyyy HH:mm:ss zzz&quot;</span><span class="delimiter">)</span>
    <a href="#98201" title="java.text.SimpleDateFormat">formatter</a>.<span title="(x$1: java.util.TimeZone)Unit">setTimeZone</span><span class="delimiter">(</span>java.util.<span title="object java.util.TimeZone">TimeZone</span>.<span title="(x$1: java.lang.String)java.util.TimeZone">getTimeZone</span><span class="delimiter">(</span><span title="java.lang.String(&quot;UTC&quot;)" class="string">&quot;UTC&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="#98201" title="java.text.SimpleDateFormat">formatter</a>
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">val</span> <a title="scala.collection.mutable.ConcurrentMap[String,String]" id="98179">lastModifieds</a> = <span class="delimiter">(</span><span title="(m: java.util.concurrent.ConcurrentMap[String,String])collection.JavaConverters.AsScala[scala.collection.mutable.ConcurrentMap[String,String]]" class="keyword">new</span> java.util.concurrent.<span title="java.util.concurrent.ConcurrentHashMap[String,String]">ConcurrentHashMap</span><span class="delimiter">[</span>String,String<span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="=&gt; scala.collection.mutable.ConcurrentMap[String,String]">asScala</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(resource: java.net.URL)Option[String]" id="98181">lastModifiedFor</a><span class="delimiter">(</span><a title="java.net.URL" id="100441">resource</a>: java.net.<span title="java.net.URL">URL</span><span class="delimiter">)</span>: <span title="Option[String]">Option</span><span class="delimiter">[</span>String<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <a href="#98179" title="=&gt; scala.collection.mutable.ConcurrentMap[String,String]">lastModifieds</a>.<span title="(key: String)Option[String]">get</span><span class="delimiter">(</span><a href="#100441" title="java.net.URL">resource</a>.<span title="()java.lang.String">toExternalForm</span><span class="delimiter">)</span>.<span title="(p: String =&gt; Boolean)Option[String]">filter</span><span class="delimiter">(</span><a title="String" id="100451">_</a> =&gt; <a href="../Play.scala.html#10578" title="object play.api.Play">Play</a>.<a href="../Play.scala.html#70674" title="(implicit app: play.api.Application)Boolean">isProd</a><span class="delimiter">)</span>.<span title="(alternative: =&gt; Option[String])Option[String]">orElse</span> <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="Option[java.lang.String]" id="100456">maybeLastModified</a> = <a href="#100441" title="java.net.URL">resource</a>.<span title="()java.lang.String">getProtocol</span> <span title="Option[java.lang.String]" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <span title="Some[java.lang.String]" class="string">&quot;file&quot;</span> =&gt; <span title="(x: java.lang.String)Some[java.lang.String]">Some</span><span class="delimiter">(</span><a href="#98177" title="=&gt; java.text.SimpleDateFormat">dateFormatter</a>.<span title="(x$1: java.util.Date)java.lang.String">format</span><span class="delimiter">(</span><span title="(x$1: Long)java.util.Date" class="keyword">new</span> java.util.<span title="java.util.Date">Date</span><span class="delimiter">(</span><span title="java.io.File" class="keyword">new</span> java.io.<span title="java.io.File">File</span><span class="delimiter">(</span><a href="#100441" title="java.net.URL">resource</a>.<span title="()java.lang.String">getPath</span><span class="delimiter">)</span>.<span title="()Long">lastModified</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="keyword">case</span> <span title="Option[java.lang.String]" class="string">&quot;jar&quot;</span> =&gt; <span title="(x$1: java.lang.String)java.net.URL" class="keyword">new</span> java.net.<span title="java.net.URL">URL</span><span class="delimiter">(</span><a href="#100441" title="java.net.URL">resource</a>.<span title="()java.lang.String">getPath</span><span class="delimiter">)</span> <span title="Option[java.lang.String]" class="keyword">match</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> <a title="Some[java.lang.String]" id="100507">url</a> <span class="keyword">if</span> <a href="#100507" title="java.net.URL">url</a>.<span title="()java.lang.String">getProtocol</span> <span title="(x$1: AnyRef)Boolean">==</span> <span title="java.lang.String(&quot;file&quot;)" class="string">&quot;file&quot;</span> =&gt; <span title="(x: java.lang.String)Some[java.lang.String]">Some</span><span class="delimiter">(</span>
            <a href="#98177" title="=&gt; java.text.SimpleDateFormat">dateFormatter</a>.<span title="(x$1: java.util.Date)java.lang.String">format</span><span class="delimiter">(</span><span title="(x$1: Long)java.util.Date" class="keyword">new</span> java.util.<span title="java.util.Date">Date</span><span class="delimiter">(</span><span title="java.io.File" class="keyword">new</span> java.io.<span title="java.io.File">File</span><span class="delimiter">(</span><a href="#100507" title="java.net.URL">url</a>.<span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">getPath</span>.<span title="(p: Char =&gt; Boolean)String">takeWhile</span><span class="delimiter">(</span><a title="Char" id="100605">c</a> =&gt; <span title="=&gt; Boolean">!</span><span class="delimiter">(</span><a href="#100605" title="Char">c</a> <span title="(x: Char)Boolean">==</span> <span title="Char(\'!\')" class="char">'!'</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="()Long">lastModified</span><span class="delimiter">)</span><span class="delimiter">)</span>
          <span class="delimiter">)</span>
          <span class="keyword">case</span> <span title="None.type">_</span> =&gt; <span title="object None">None</span>
        <span class="delimiter">}</span>
        <span class="keyword">case</span> <span title="None.type">_</span> =&gt; <span title="object None">None</span>
      <span class="delimiter">}</span>
      <a href="#100456" title="Option[java.lang.String]">maybeLastModified</a>.<span title="(f: java.lang.String =&gt; Option[String])Unit">foreach</span><span class="delimiter">(</span><a href="#98179" title="=&gt; scala.collection.mutable.ConcurrentMap[String,String]">lastModifieds</a>.<span title="(key: String, value: String)Option[String]">put</span><span class="delimiter">(</span><a href="#100441" title="java.net.URL">resource</a>.<span title="()java.lang.String">toExternalForm</span>, <a href="#100626" title="java.lang.String">_</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="#100456" title="Option[java.lang.String]">maybeLastModified</a>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="comment">// -- ETags handling</span>

  <span class="keyword">private</span> <span class="keyword">val</span> <a title="scala.collection.mutable.ConcurrentMap[String,String]" id="98182">etags</a> = <span class="delimiter">(</span><span title="(m: java.util.concurrent.ConcurrentMap[String,String])collection.JavaConverters.AsScala[scala.collection.mutable.ConcurrentMap[String,String]]" class="keyword">new</span> java.util.concurrent.<span title="java.util.concurrent.ConcurrentHashMap[String,String]">ConcurrentHashMap</span><span class="delimiter">[</span>String,String<span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="=&gt; scala.collection.mutable.ConcurrentMap[String,String]">asScala</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(resource: java.net.URL)Option[String]" id="98184">etagFor</a><span class="delimiter">(</span><a title="java.net.URL" id="99762">resource</a>: java.net.<span title="java.net.URL">URL</span><span class="delimiter">)</span>: <span title="Option[String]">Option</span><span class="delimiter">[</span>String<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <a href="#98182" title="=&gt; scala.collection.mutable.ConcurrentMap[String,String]">etags</a>.<span title="(key: String)Option[String]">get</span><span class="delimiter">(</span><a href="#99762" title="java.net.URL">resource</a>.<span title="()java.lang.String">toExternalForm</span><span class="delimiter">)</span>.<span title="(p: String =&gt; Boolean)Option[String]">filter</span><span class="delimiter">(</span><a title="String" id="100634">_</a> =&gt; <a href="../Play.scala.html#10578" title="object play.api.Play">Play</a>.<a href="../Play.scala.html#70674" title="(implicit app: play.api.Application)Boolean">isProd</a><span class="delimiter">)</span>.<span title="(alternative: =&gt; Option[String])Option[String]">orElse</span> <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="Option[String]" id="100637">maybeEtag</a> = <a href="#98181" title="(resource: java.net.URL)Option[String]">lastModifiedFor</a><span class="delimiter">(</span><a href="#99762" title="java.net.URL">resource</a><span class="delimiter">)</span>.<span title="(f: String =&gt; java.lang.String)Option[java.lang.String]">map</span><span class="delimiter">(</span><a href="#100641" title="String">_</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot; -&gt; &quot;)" class="string">&quot; -&gt; &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#99762" title="java.net.URL">resource</a>.<span title="()java.lang.String">toExternalForm</span><span class="delimiter">)</span>.<span title="(f: java.lang.String =&gt; String)Option[String]">map</span><span class="delimiter">(</span><a href="../libs/Codecs.scala.html#12902" title="object play.api.libs.Codecs">Codecs</a>.<a href="../libs/Codecs.scala.html#71348" title="(text: String)String">sha1</a><span class="delimiter">)</span>
      <a href="#100637" title="Option[String]">maybeEtag</a>.<span title="(f: String =&gt; Option[String])Unit">foreach</span><span class="delimiter">(</span><a href="#98182" title="=&gt; scala.collection.mutable.ConcurrentMap[String,String]">etags</a>.<span title="(key: String, value: String)Option[String]">put</span><span class="delimiter">(</span><a href="#99762" title="java.net.URL">resource</a>.<span title="()java.lang.String">toExternalForm</span>, <a href="#100663" title="String">_</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="#100637" title="Option[String]">maybeEtag</a>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

<span class="delimiter">}</span>


        </pre>
    </body>
</html>