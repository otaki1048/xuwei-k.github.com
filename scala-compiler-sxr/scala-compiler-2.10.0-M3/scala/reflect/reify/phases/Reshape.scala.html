<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>scala/reflect/reify/phases/Reshape.scala</title>
        <script type="text/javascript" src="../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> scala.reflect.reify
<span class="keyword">package</span> phases

<span class="keyword">import</span> scala.tools.nsc.symtab.<a href="../../../tools/nsc/symtab/package.scala.html#57302" title="=&gt; reflect.internal.Flags.type">Flags</a>._

<span class="keyword">trait</span> <a title="trait Reshape extends Object" id="24527">Reshape</a> <a href="../../../Unit.scala.html#2389" title="Unit" class="delimiter">{</a>
  self: Reifier =&gt;

  <span class="keyword">import</span> <a href="../Reifier.scala.html#563316" title="=&gt; scala.tools.nsc.Global">mirror</a>._
  <span class="keyword">import</span> <a href="../../internal/Definitions.scala.html#441641" title="Reshape.this.mirror.definitions.type">definitions</a>._
  <span class="keyword">import</span> <a href="../../../tools/nsc/ast/Trees.scala.html#559838" title="Reshape.this.mirror.treeInfo.type">treeInfo</a>._

  /**
   *  Rolls back certain changes that were introduced during typechecking of the reifee.
   *
   *  These include:
   *    * Replacing type trees with TypeTree(tpe)
   *    * Transforming Modifiers.annotations into Symbol.annotations
   *    * Transforming Annotated annotations into AnnotatedType annotations
   *    * Transforming Annotated(annot, expr) into Typed(expr, TypeTree(Annotated(annot, _))
   *    * Non-idempotencies of the typechecker: https://issues.scala-lang.org/browse/SI-5464
   */
  <span class="keyword">val</span> <a title="reshape extends Reshape.this.mirror.Transformer" id="563332">reshape</a> = <a href="#565111" title="Reshape.this.mirror.Transformer{def currentSymbol: Reshape.this.mirror.Symbol; def currentSymbol_=(x$1: Reshape.this.mirror.Symbol): Unit}" class="keyword">new</a> <a href="../../../tools/nsc/ast/Trees.scala.html#559848" title="anonymous class $anon extends Reshape.this.mirror.Transformer" id="565111">Transformer</a> <span class="delimiter">{</span>
    <span class="keyword">var</span> <a title="Reshape.this.mirror.Symbol" id="565114">currentSymbol</a>: <a href="../../internal/Symbols.scala.html#441132" title="Reshape.this.mirror.Symbol">Symbol</a> = <a href="../../internal/Symbols.scala.html#441152" title="=&gt; Reshape.this.mirror.NoSymbol">NoSymbol</a>

    <span class="keyword">override</span> <span class="keyword">def</span> <a title="(tree: Reshape.this.mirror.Tree)Reshape.this.mirror.Tree" id="565116">transform</a><span class="delimiter">(</span><a title="Reshape.this.mirror.Tree" id="565127">tree</a>: <a href="../../api/Trees.scala.html#23570" title="Reshape.this.mirror.Tree">Tree</a><span class="delimiter">)</span> = <span class="delimiter">{</span>
      <a href="#565114" title="(x$1: Reshape.this.mirror.Symbol)Unit">currentSymbol</a> = <a href="#565127" title="Reshape.this.mirror.Tree">tree</a>.<a href="../../api/Trees.scala.html#425064" title="=&gt; Reshape.this.mirror.Symbol">symbol</a>

      <span class="keyword">val</span> <a title="Reshape.this.mirror.Tree" id="565129">preTyper</a> = <a href="#565127" title="Reshape.this.mirror.Tree">tree</a> <span class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> tree <span class="keyword">if</span> <a href="../../internal/Trees.scala.html#441814" title="implicit scala.reflect.internal.Trees.TreeOps : (tree: Reshape.this.mirror.Tree)Reshape.this.mirror.TreeOps">tree</a>.<a href="../../internal/Trees.scala.html#443953" title="=&gt; Boolean">isErroneous</a> =&gt;
          <a href="#565898" title="(x: Reshape.this.mirror.Tree)Reshape.this.mirror.Tree">tree</a>
        <span class="keyword">case</span> tt @ TypeTree<a href="#565879" title="Reshape.this.mirror.Tree" id="565881" class="delimiter">(</a><span class="delimiter">)</span> =&gt;
          <a href="#565120" title="(tt: Reshape.this.mirror.TypeTree)Reshape.this.mirror.Tree">toPreTyperTypeTree</a><a href="#565898" title="(x: Reshape.this.mirror.Tree)Reshape.this.mirror.Tree" class="delimiter">(</a>tt<span class="delimiter">)</span>
        <span class="keyword">case</span> toa @ <a href="../../internal/TreeInfo.scala.html#504131" title="Option[Reshape.this.mirror.treeInfo.global.Tree]" id="565904">TypedOrAnnotated</a><span class="delimiter">(</span>_<span class="delimiter">)</span> =&gt;
          <a href="#565121" title="(tree: Reshape.this.mirror.Tree)Reshape.this.mirror.Tree">toPreTyperTypedOrAnnotated</a><a href="#565898" title="(x: Reshape.this.mirror.Tree)Reshape.this.mirror.Tree" class="delimiter">(</a>toa<span class="delimiter">)</span>
        <span class="keyword">case</span> ta @ TypeApply<a href="#565879" title="Reshape.this.mirror.Tree" id="565885" class="delimiter">(</a>hk, ts<span class="delimiter">)</span> =&gt;
          <span class="keyword">val</span> <a title="Boolean" id="565155">discard</a> = ts <a href="../../../collection/TraversableLike.scala.html#58983" title="(pf: PartialFunction[Reshape.this.mirror.Tree,Reshape.this.mirror.TypeTree])(implicit bf: scala.collection.generic.CanBuildFrom[List[Reshape.this.mirror.Tree],Reshape.this.mirror.TypeTree,List[Reshape.this.mirror.TypeTree]])List[Reshape.this.mirror.TypeTree]">collect</a> <a title="anonymous class $anonfun extends scala.runtime.AbstractPartialFunction[Reshape.this.mirror.Tree,Reshape.this.mirror.TypeTree] with Serializable" id="565184" class="delimiter">{</a> <span class="keyword">case</span> <a href="#565175" title="B1" id="565190">tt</a>: TypeTree =&gt; <a href="#565180" title="(x: B1)B1">tt</a> <span class="delimiter">}</span> <a href="../../../collection/LinearSeqOptimized.scala.html#76170" title="(p: Reshape.this.mirror.TypeTree =&gt; Boolean)Boolean">exists</a> <a href="#565119" title="(tt: Reshape.this.mirror.TypeTree)Boolean">isDiscarded</a>
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../codegen/Util.scala.html#563438" title="=&gt; Boolean">reifyDebug</a> <a href="../../../Boolean.scala.html#58725" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#565155" title="Boolean">discard</a><span class="delimiter">)</span> <a href="../../../Predef.scala.html#8489" title="(x: Any)Unit">println</a><span class="delimiter">(</span><span title="String(&quot;discarding TypeApply: &quot;)" class="string">&quot;discarding TypeApply: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#565127" title="Reshape.this.mirror.Tree">tree</a><span class="delimiter">)</span>
          <span title="Reshape.this.mirror.Tree" class="keyword">if</span> <span class="delimiter">(</span><a href="#565155" title="Boolean">discard</a><span class="delimiter">)</span> hk <span class="keyword">else</span> ta
        <span class="keyword">case</span> classDef @ ClassDef<a href="#565879" title="Reshape.this.mirror.Tree" id="565887" class="delimiter">(</a>mods, name, params, impl<span class="delimiter">)</span> =&gt;
          <span class="keyword">val</span> Template<a href="#565369" title="(x: (List[Reshape.this.mirror.Tree], Reshape.this.mirror.ValDef, List[Reshape.this.mirror.Tree]))(List[Reshape.this.mirror.Tree], Reshape.this.mirror.ValDef, List[Reshape.this.mirror.Tree])" class="delimiter">(</a><a href="../../../Tuple3.scala.html#61402" title="List[Reshape.this.mirror.Tree]" id="565325">parents</a>, <a href="../../../Tuple3.scala.html#61404" title="Reshape.this.mirror.ValDef" id="565326">self</a>, <a href="../../../Tuple3.scala.html#61406" title="List[Reshape.this.mirror.Tree]" id="565327">body</a><span class="delimiter">)</span> = <a href="../../api/Trees.scala.html#23621" title="Reshape.this.mirror.Template @unchecked">impl</a>
          <span class="keyword">var</span> <a title="List[Reshape.this.mirror.Tree]" id="565328">body1</a> = <a href="#565123" title="(deff: Reshape.this.mirror.Tree, stats: List[Reshape.this.mirror.Tree])List[Reshape.this.mirror.Tree]">trimAccessors</a><span class="delimiter">(</span>classDef, <a href="#565327" title="List[Reshape.this.mirror.Tree]">body</a><span class="delimiter">)</span>
          <a href="#565328" title="List[Reshape.this.mirror.Tree]">body1</a> = <a href="#565124" title="(deff: Reshape.this.mirror.Tree, stats: List[Reshape.this.mirror.Tree])List[Reshape.this.mirror.Tree]">trimSyntheticCaseClassMembers</a><span class="delimiter">(</span>classDef, <a href="#565328" title="List[Reshape.this.mirror.Tree]">body1</a><span class="delimiter">)</span>
          <span class="keyword">var</span> <a title="Reshape.this.mirror.Template" id="565329">impl1</a> = <a href="../../api/Trees.scala.html#427447" title="(parents: List[Reshape.this.mirror.Tree], self: Reshape.this.mirror.ValDef, body: List[Reshape.this.mirror.Tree])Reshape.this.mirror.Template">Template</a><span class="delimiter">(</span><a href="#565325" title="List[Reshape.this.mirror.Tree]">parents</a>, <a href="#565326" title="Reshape.this.mirror.ValDef">self</a>, <a href="#565328" title="List[Reshape.this.mirror.Tree]">body1</a><span class="delimiter">)</span>.<a href="../../api/Trees.scala.html#425087" title="(tree: Reshape.this.mirror.Tree)Reshape.this.mirror.Template">copyAttrs</a><span class="delimiter">(</span>impl<span class="delimiter">)</span>
          <a href="../../api/Trees.scala.html#427365" title="(mods: Reshape.this.mirror.Modifiers, name: Reshape.this.mirror.TypeName, tparams: List[Reshape.this.mirror.TypeDef], impl: Reshape.this.mirror.Template)Reshape.this.mirror.ClassDef">ClassDef</a><span class="delimiter">(</span>mods, name, params, <a href="#565329" title="Reshape.this.mirror.Template">impl1</a><span class="delimiter">)</span>.<a href="../../api/Trees.scala.html#425087" title="(tree: Reshape.this.mirror.Tree)Reshape.this.mirror.ClassDef">copyAttrs</a><span class="delimiter">(</span>classDef<span class="delimiter">)</span>
        <span class="keyword">case</span> moduledef @ ModuleDef<a href="#565879" title="Reshape.this.mirror.Tree" id="565889" class="delimiter">(</a>mods, name, impl<span class="delimiter">)</span> =&gt;
          <span class="keyword">val</span> Template<a href="#565453" title="(x: (List[Reshape.this.mirror.Tree], Reshape.this.mirror.ValDef, List[Reshape.this.mirror.Tree]))(List[Reshape.this.mirror.Tree], Reshape.this.mirror.ValDef, List[Reshape.this.mirror.Tree])" class="delimiter">(</a><a href="../../../Tuple3.scala.html#61402" title="List[Reshape.this.mirror.Tree]" id="565429">parents</a>, <a href="../../../Tuple3.scala.html#61404" title="Reshape.this.mirror.ValDef" id="565430">self</a>, <a href="../../../Tuple3.scala.html#61406" title="List[Reshape.this.mirror.Tree]" id="565431">body</a><span class="delimiter">)</span> = <a href="../../api/Trees.scala.html#23621" title="Reshape.this.mirror.Template @unchecked">impl</a>
          <span class="keyword">var</span> <a title="List[Reshape.this.mirror.Tree]" id="565432">body1</a> = <a href="#565123" title="(deff: Reshape.this.mirror.Tree, stats: List[Reshape.this.mirror.Tree])List[Reshape.this.mirror.Tree]">trimAccessors</a><span class="delimiter">(</span>moduledef, <a href="#565431" title="List[Reshape.this.mirror.Tree]">body</a><span class="delimiter">)</span>
          <a href="#565432" title="List[Reshape.this.mirror.Tree]">body1</a> = <a href="#565124" title="(deff: Reshape.this.mirror.Tree, stats: List[Reshape.this.mirror.Tree])List[Reshape.this.mirror.Tree]">trimSyntheticCaseClassMembers</a><span class="delimiter">(</span>moduledef, <a href="#565432" title="List[Reshape.this.mirror.Tree]">body1</a><span class="delimiter">)</span>
          <span class="keyword">var</span> <a title="Reshape.this.mirror.Template" id="565433">impl1</a> = <a href="../../api/Trees.scala.html#427447" title="(parents: List[Reshape.this.mirror.Tree], self: Reshape.this.mirror.ValDef, body: List[Reshape.this.mirror.Tree])Reshape.this.mirror.Template">Template</a><span class="delimiter">(</span><a href="#565429" title="List[Reshape.this.mirror.Tree]">parents</a>, <a href="#565430" title="Reshape.this.mirror.ValDef">self</a>, <a href="#565432" title="List[Reshape.this.mirror.Tree]">body1</a><span class="delimiter">)</span>.<a href="../../api/Trees.scala.html#425087" title="(tree: Reshape.this.mirror.Tree)Reshape.this.mirror.Template">copyAttrs</a><span class="delimiter">(</span>impl<span class="delimiter">)</span>
          <a href="../../api/Trees.scala.html#427802" title="(mods: Reshape.this.mirror.Modifiers, name: Reshape.this.mirror.TermName, impl: Reshape.this.mirror.Template)Reshape.this.mirror.ModuleDef">ModuleDef</a><span class="delimiter">(</span>mods, name, <a href="#565433" title="Reshape.this.mirror.Template">impl1</a><span class="delimiter">)</span>.<a href="../../api/Trees.scala.html#425087" title="(tree: Reshape.this.mirror.Tree)Reshape.this.mirror.ModuleDef">copyAttrs</a><span class="delimiter">(</span>moduledef<span class="delimiter">)</span>
        <span class="keyword">case</span> template @ Template<a href="#565879" title="Reshape.this.mirror.Tree" id="565891" class="delimiter">(</a>parents, self, body<span class="delimiter">)</span> =&gt;
          <span class="keyword">val</span> <a title="List[Reshape.this.mirror.TypeTree]" id="565494">discardedParents</a> = parents <a href="../../../collection/TraversableLike.scala.html#58983" title="(pf: PartialFunction[Reshape.this.mirror.Tree,Reshape.this.mirror.TypeTree])(implicit bf: scala.collection.generic.CanBuildFrom[List[Reshape.this.mirror.Tree],Reshape.this.mirror.TypeTree,List[Reshape.this.mirror.TypeTree]])List[Reshape.this.mirror.TypeTree]">collect</a> <a title="anonymous class $anonfun extends scala.runtime.AbstractPartialFunction[Reshape.this.mirror.Tree,Reshape.this.mirror.TypeTree] with Serializable" id="565525" class="delimiter">{</a> <span class="keyword">case</span> <a href="#565516" title="B1" id="565531">tt</a>: TypeTree =&gt; <a href="#565521" title="(x: B1)B1">tt</a> <span class="delimiter">}</span> <a href="../../../collection/TraversableLike.scala.html#58981" title="(p: Reshape.this.mirror.TypeTree =&gt; Boolean)List[Reshape.this.mirror.TypeTree]">filter</a> <a href="#565119" title="(tt: Reshape.this.mirror.TypeTree)Boolean">isDiscarded</a>
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../codegen/Util.scala.html#563438" title="=&gt; Boolean">reifyDebug</a> <a href="../../../Boolean.scala.html#58725" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#565494" title="List[Reshape.this.mirror.TypeTree]">discardedParents</a>.<a href="../../../collection/LinearSeqOptimized.scala.html#76164" title="=&gt; Int">length</a> <a href="../../../Int.scala.html#57919" title="(x: Int)Boolean">&gt;</a> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <a href="../../../Predef.scala.html#8489" title="(x: Any)Unit">println</a><span class="delimiter">(</span><span title="String(&quot;discarding parents in Template: &quot;)" class="string">&quot;discarding parents in Template: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#565494" title="List[Reshape.this.mirror.TypeTree]">discardedParents</a>.<a href="../../../collection/TraversableOnce.scala.html#59190" title="(sep: String)String">mkString</a><span class="delimiter">(</span><span title="String(&quot;, &quot;)" class="string">&quot;, &quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="List[Reshape.this.mirror.Tree]" id="565495">parents1</a> = parents <a href="../../../collection/SeqLike.scala.html#59774" title="(that: scala.collection.GenSeq[Reshape.this.mirror.Tree])List[Reshape.this.mirror.Tree]">diff</a> <a href="#565494" title="List[Reshape.this.mirror.TypeTree]">discardedParents</a>
          <span class="keyword">val</span> <a title="List[Reshape.this.mirror.Tree]" id="565496">body1</a> = <a href="#565125" title="(stats: List[Reshape.this.mirror.Tree])List[Reshape.this.mirror.Tree]">trimSyntheticCaseClassCompanions</a><span class="delimiter">(</span>body<span class="delimiter">)</span>
          <a href="../../api/Trees.scala.html#427447" title="(parents: List[Reshape.this.mirror.Tree], self: Reshape.this.mirror.ValDef, body: List[Reshape.this.mirror.Tree])Reshape.this.mirror.Template">Template</a><span class="delimiter">(</span><a href="#565495" title="List[Reshape.this.mirror.Tree]">parents1</a>, self, <a href="#565496" title="List[Reshape.this.mirror.Tree]">body1</a><span class="delimiter">)</span>.<a href="../../api/Trees.scala.html#425087" title="(tree: Reshape.this.mirror.Tree)Reshape.this.mirror.Template">copyAttrs</a><span class="delimiter">(</span>template<span class="delimiter">)</span>
        <span class="keyword">case</span> block @ Block<a href="#565879" title="Reshape.this.mirror.Tree" id="565893" class="delimiter">(</a>stats, expr<span class="delimiter">)</span> =&gt;
          <span class="keyword">val</span> <a title="List[Reshape.this.mirror.Tree]" id="565654">stats1</a> = <a href="#565125" title="(stats: List[Reshape.this.mirror.Tree])List[Reshape.this.mirror.Tree]">trimSyntheticCaseClassCompanions</a><span class="delimiter">(</span>stats<span class="delimiter">)</span>
          <a href="../../api/Trees.scala.html#427284" title="(stats: List[Reshape.this.mirror.Tree], expr: Reshape.this.mirror.Tree)Reshape.this.mirror.Block">Block</a><span class="delimiter">(</span><a href="#565654" title="List[Reshape.this.mirror.Tree]">stats1</a>, expr<span class="delimiter">)</span>.<a href="../../api/Trees.scala.html#425087" title="(tree: Reshape.this.mirror.Tree)Reshape.this.mirror.Block">copyAttrs</a><span class="delimiter">(</span>block<span class="delimiter">)</span>
        <span class="keyword">case</span> valdef @ ValDef<a href="#565879" title="Reshape.this.mirror.Tree" id="565895" class="delimiter">(</a>mods, name, tpt, rhs<span class="delimiter">)</span> <span class="keyword">if</span> valdef.<a href="../../api/Trees.scala.html#427232" title="=&gt; Reshape.this.mirror.Symbol">symbol</a>.<a href="../../internal/HasFlags.scala.html#443593" title="=&gt; Boolean">isLazy</a> =&gt;
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../codegen/Util.scala.html#563438" title="=&gt; Boolean">reifyDebug</a><span class="delimiter">)</span> <a href="../../../Predef.scala.html#8489" title="(x: Any)Unit">println</a><span class="delimiter">(</span><span title="String(&quot;dropping $lzy in lazy val\'s name: &quot;)" class="string">&quot;dropping $lzy in lazy val's name: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#565127" title="Reshape.this.mirror.Tree">tree</a><span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="name.ThisNameType" id="565695">name1</a> = <span title="name.ThisNameType" class="keyword">if</span> <span class="delimiter">(</span>name <a href="../../internal/Names.scala.html#444149" title="(suffix: Reshape.this.mirror.Name)Boolean">endsWith</a> <a href="../../internal/StdNames.scala.html#441764" title="Reshape.this.mirror.nme.type">nme</a>.<a href="../../internal/StdNames.scala.html#446183" title="=&gt; Reshape.this.mirror.nme.NameType">LAZY_LOCAL</a><span class="delimiter">)</span> name <a href="../../internal/Names.scala.html#444160" title="(n: Int)Reshape.this.mirror.TermName">dropRight</a> <a href="../../internal/StdNames.scala.html#441764" title="Reshape.this.mirror.nme.type">nme</a>.<a href="../../internal/StdNames.scala.html#446183" title="=&gt; Reshape.this.mirror.nme.NameType">LAZY_LOCAL</a>.<a href="../../internal/Names.scala.html#444120" title="=&gt; Int">length</a> <span class="keyword">else</span> name
          <a href="../../api/Trees.scala.html#428215" title="(mods: Reshape.this.mirror.Modifiers, name: Reshape.this.mirror.TermName, tpt: Reshape.this.mirror.Tree, rhs: Reshape.this.mirror.Tree)Reshape.this.mirror.ValDef">ValDef</a><span class="delimiter">(</span>mods, <a href="#565695" title="name.ThisNameType">name1</a>, tpt, rhs<span class="delimiter">)</span>.<a href="../../api/Trees.scala.html#425087" title="(tree: Reshape.this.mirror.Tree)Reshape.this.mirror.ValDef">copyAttrs</a><span class="delimiter">(</span>valdef<span class="delimiter">)</span>
        <span class="keyword">case</span> unapply @ UnApply<a href="#565879" title="Reshape.this.mirror.Tree" id="565897" class="delimiter">(</a>fun, args<span class="delimiter">)</span> =&gt;
          <span class="keyword">def</span> <a title="(tree: Reshape.this.mirror.Tree)Reshape.this.mirror.Tree" id="565731">extractExtractor</a><span class="delimiter">(</span><a title="Reshape.this.mirror.Tree" id="565733">tree</a>: <a href="../../api/Trees.scala.html#23570" title="Reshape.this.mirror.Tree">Tree</a><span class="delimiter">)</span>: <a href="../../api/Trees.scala.html#23570" title="Reshape.this.mirror.Tree">Tree</a> = <span class="delimiter">{</span>
            <span class="keyword">val</span> Apply<a href="#565754" title="(Reshape.this.mirror.Tree, List[Reshape.this.mirror.Tree])" id="565756" class="delimiter">(</a><a href="../../../Tuple2.scala.html#61506" title="Reshape.this.mirror.Tree" id="565735">fun</a>, <a href="../../../Tuple2.scala.html#61508" title="List[Reshape.this.mirror.Tree]" id="565736">args</a><span class="delimiter">)</span> = <a href="#565733" title="Reshape.this.mirror.Tree">tree</a>
            <a href="#565736" title="List[Reshape.this.mirror.Tree]">args</a> <span class="keyword">match</span> <span class="delimiter">{</span>
              <span class="keyword">case</span> <a href="../../../collection/generic/SeqFactory.scala.html#60838" title="Option[List[Reshape.this.mirror.Tree]]" id="565848">List</a><span class="delimiter">(</span>Ident<a title="Reshape.this.mirror.Tree" id="565832" class="delimiter">(</a>special<span class="delimiter">)</span><span class="delimiter">)</span> <span class="keyword">if</span> special <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../internal/StdNames.scala.html#441764" title="Reshape.this.mirror.nme.type">nme</a>.<a href="../../internal/StdNames.scala.html#446209" title="=&gt; Reshape.this.mirror.nme.NameType">SELECTOR_DUMMY</a> =&gt;
                <span class="keyword">val</span> Select<a href="#565807" title="(Reshape.this.mirror.Tree, Reshape.this.mirror.Name)" id="565809" class="delimiter">(</a><a href="../../../Tuple2.scala.html#61506" title="Reshape.this.mirror.Tree" id="565784">extractor</a>, <a href="../../../Tuple2.scala.html#61508" title="Reshape.this.mirror.Name" id="565785">flavor</a><span class="delimiter">)</span> = <a href="#565735" title="Reshape.this.mirror.Tree">fun</a>
                <a href="../../../tools/nsc/Global.scala.html#559534" title="(assertion: Boolean)Unit">assert</a><span class="delimiter">(</span><a href="#565785" title="Reshape.this.mirror.Name">flavor</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../internal/StdNames.scala.html#441764" title="Reshape.this.mirror.nme.type">nme</a>.<a href="../../internal/StdNames.scala.html#446711" title="=&gt; Reshape.this.mirror.nme.NameType">unapply</a> <a href="../../../Boolean.scala.html#58724" title="(x: Boolean)Boolean">||</a> <a href="#565785" title="Reshape.this.mirror.Name">flavor</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../internal/StdNames.scala.html#441764" title="Reshape.this.mirror.nme.type">nme</a>.<a href="../../internal/StdNames.scala.html#446713" title="=&gt; Reshape.this.mirror.nme.NameType">unapplySeq</a><span class="delimiter">)</span>
                <a href="#565784" title="Reshape.this.mirror.Tree">extractor</a>
              <span class="keyword">case</span> _ =&gt;
                <a href="#565731" title="(tree: Reshape.this.mirror.Tree)Reshape.this.mirror.Tree">extractExtractor</a><a href="#565833" title="(x: Reshape.this.mirror.Tree)Reshape.this.mirror.Tree" class="delimiter">(</a><a href="#565735" title="Reshape.this.mirror.Tree">fun</a><span class="delimiter">)</span>
            <span class="delimiter">}</span>
          <span class="delimiter">}</span>

          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../codegen/Util.scala.html#563438" title="=&gt; Boolean">reifyDebug</a><span class="delimiter">)</span> <a href="../../../Predef.scala.html#8489" title="(x: Any)Unit">println</a><span class="delimiter">(</span><span title="String(&quot;unapplying unapply: &quot;)" class="string">&quot;unapplying unapply: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#565127" title="Reshape.this.mirror.Tree">tree</a><span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="Reshape.this.mirror.Tree" id="565732">fun1</a> = <a href="#565731" title="(tree: Reshape.this.mirror.Tree)Reshape.this.mirror.Tree">extractExtractor</a><span class="delimiter">(</span>fun<span class="delimiter">)</span>
          <a href="../../api/Trees.scala.html#427174" title="(fun: Reshape.this.mirror.Tree, args: List[Reshape.this.mirror.Tree])Reshape.this.mirror.Apply">Apply</a><span class="delimiter">(</span><a href="#565732" title="Reshape.this.mirror.Tree">fun1</a>, args<span class="delimiter">)</span>.<a href="../../api/Trees.scala.html#425087" title="(tree: Reshape.this.mirror.Tree)Reshape.this.mirror.Apply">copyAttrs</a><span class="delimiter">(</span>unapply<span class="delimiter">)</span>
        <span class="keyword">case</span> _ =&gt;
          <a href="#565898" title="(x: Reshape.this.mirror.Tree)Reshape.this.mirror.Tree">tree</a>
      <span class="delimiter">}</span>

      <a href="#565111" title="Reshape.this.mirror.Transformer{def currentSymbol: Reshape.this.mirror.Symbol; def currentSymbol_=(x$1: Reshape.this.mirror.Symbol): Unit}" class="keyword">super</a>.<a href="../../api/Trees.scala.html#438847" title="(tree: Reshape.this.mirror.Tree)Reshape.this.mirror.Tree">transform</a><span class="delimiter">(</span><a href="#565129" title="Reshape.this.mirror.Tree">preTyper</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="keyword">override</span> <span class="keyword">def</span> <a title="(mods: Reshape.this.mirror.Modifiers)Reshape.this.mirror.Modifiers" id="565117">transformModifiers</a><span class="delimiter">(</span><a title="Reshape.this.mirror.Modifiers" id="565915">mods</a>: <a href="../../internal/Trees.scala.html#441805" title="Reshape.this.mirror.Modifiers">Modifiers</a><span class="delimiter">)</span> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="Reshape.this.mirror.Modifiers" id="565917">mods1</a> = <a href="#565118" title="(mods: Reshape.this.mirror.Modifiers, sym: Reshape.this.mirror.Symbol)Reshape.this.mirror.Modifiers">toPreTyperModifiers</a><span class="delimiter">(</span><a href="#565915" title="Reshape.this.mirror.Modifiers">mods</a>, <a href="#565114" title="=&gt; Reshape.this.mirror.Symbol">currentSymbol</a><span class="delimiter">)</span>
      <a href="#565111" title="Reshape.this.mirror.Transformer{def currentSymbol: Reshape.this.mirror.Symbol; def currentSymbol_=(x$1: Reshape.this.mirror.Symbol): Unit}" class="keyword">super</a>.<a href="../../api/Trees.scala.html#438857" title="(mods: Reshape.this.mirror.Modifiers)Reshape.this.mirror.Modifiers">transformModifiers</a><span class="delimiter">(</span><a href="#565917" title="Reshape.this.mirror.Modifiers">mods1</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(mods: Reshape.this.mirror.Modifiers, sym: Reshape.this.mirror.Symbol)Reshape.this.mirror.Modifiers" id="565118">toPreTyperModifiers</a><span class="delimiter">(</span><a title="Reshape.this.mirror.Modifiers" id="565918">mods</a>: <a href="../../internal/Trees.scala.html#441805" title="Reshape.this.mirror.Modifiers">Modifiers</a>, <a title="Reshape.this.mirror.Symbol" id="565919">sym</a>: <a href="../../internal/Symbols.scala.html#441132" title="Reshape.this.mirror.Symbol">Symbol</a><span class="delimiter">)</span> = <span class="delimiter">{</span>
      <span title="Reshape.this.mirror.Modifiers" class="keyword">if</span> <span class="delimiter">(</span><a href="../../../Boolean.scala.html#58721" title="=&gt; Boolean">!</a><a href="#565919" title="Reshape.this.mirror.Symbol">sym</a>.<a href="../../internal/Symbols.scala.html#443459" title="=&gt; List[Reshape.this.mirror.AnnotationInfo]">annotations</a>.<a href="../../../collection/IterableLike.scala.html#59464" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> Modifiers<a href="#565954" title="(x: (Long, Reshape.this.mirror.Name, List[Reshape.this.mirror.Tree]))(Long, Reshape.this.mirror.Name, List[Reshape.this.mirror.Tree])" class="delimiter">(</a><a href="../../../Tuple3.scala.html#61402" title="Long" id="565922">flags</a>, <a href="../../../Tuple3.scala.html#61404" title="Reshape.this.mirror.Name" id="565923">privateWithin</a>, <a href="../../../Tuple3.scala.html#61406" title="List[Reshape.this.mirror.Tree]" id="565924">annotations</a><span class="delimiter">)</span> = <a href="#565918" title="Reshape.this.mirror.Modifiers">mods</a>
        <span class="keyword">val</span> <a title="List[Reshape.this.mirror.AnnotationInfo]" id="565925">postTyper</a> = <a href="#565919" title="Reshape.this.mirror.Symbol">sym</a>.<a href="../../internal/Symbols.scala.html#443459" title="=&gt; List[Reshape.this.mirror.AnnotationInfo]">annotations</a> <a href="../../../collection/TraversableLike.scala.html#58981" title="(p: Reshape.this.mirror.AnnotationInfo =&gt; Boolean)List[Reshape.this.mirror.AnnotationInfo]">filter</a> <span class="delimiter">(</span><a href="#565967" title="Reshape.this.mirror.AnnotationInfo">_</a>.<a href="../../internal/AnnotationInfos.scala.html#443794" title="=&gt; Reshape.this.mirror.Tree">original</a> <span title="(x$1: AnyRef)Boolean">!=</span> <a href="../../api/Trees.scala.html#23577" title="Reshape.this.mirror.EmptyTree.type">EmptyTree</a><span class="delimiter">)</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../codegen/Util.scala.html#563438" title="=&gt; Boolean">reifyDebug</a> <a href="../../../Boolean.scala.html#58725" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../../Boolean.scala.html#58721" title="=&gt; Boolean">!</a><a href="#565925" title="List[Reshape.this.mirror.AnnotationInfo]">postTyper</a>.<a href="../../../collection/IterableLike.scala.html#59464" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <a href="../../../Predef.scala.html#8489" title="(x: Any)Unit">println</a><span class="delimiter">(</span><span title="String(&quot;reify symbol annotations for: &quot;)" class="string">&quot;reify symbol annotations for: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#565919" title="Reshape.this.mirror.Symbol">sym</a><span class="delimiter">)</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../codegen/Util.scala.html#563438" title="=&gt; Boolean">reifyDebug</a> <a href="../../../Boolean.scala.html#58725" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../../Boolean.scala.html#58721" title="=&gt; Boolean">!</a><a href="#565925" title="List[Reshape.this.mirror.AnnotationInfo]">postTyper</a>.<a href="../../../collection/IterableLike.scala.html#59464" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <a href="../../../Predef.scala.html#8489" title="(x: Any)Unit">println</a><span class="delimiter">(</span><span title="String(&quot;originals are: &quot;)" class="string">&quot;originals are: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#565919" title="Reshape.this.mirror.Symbol">sym</a>.<a href="../../internal/Symbols.scala.html#443459" title="=&gt; List[Reshape.this.mirror.AnnotationInfo]">annotations</a><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="List[Reshape.this.mirror.Tree]" id="565926">preTyper</a> = <a href="#565925" title="List[Reshape.this.mirror.AnnotationInfo]">postTyper</a> <a href="../../../collection/TraversableLike.scala.html#58971" title="(f: Reshape.this.mirror.AnnotationInfo =&gt; Reshape.this.mirror.Tree)(implicit bf: scala.collection.generic.CanBuildFrom[List[Reshape.this.mirror.AnnotationInfo],Reshape.this.mirror.Tree,List[Reshape.this.mirror.Tree]])List[Reshape.this.mirror.Tree]">map</a> <a href="#565122" title="(ann: Reshape.this.mirror.AnnotationInfo)Reshape.this.mirror.Tree">toPreTyperAnnotation</a>
        <a href="#565918" title="Reshape.this.mirror.Modifiers">mods</a>.<a href="../../internal/Trees.scala.html#471517" title="(annots: List[Reshape.this.mirror.Tree])Reshape.this.mirror.Modifiers">withAnnotations</a><span class="delimiter">(</span><a href="#565926" title="List[Reshape.this.mirror.Tree]">preTyper</a><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
        <a href="#565918" title="Reshape.this.mirror.Modifiers">mods</a>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    /** Restore pre-typer representation of a type.
     *
     *  NB: This is the trickiest part of reification!
     *
     *  In most cases, we're perfectly fine to reify a Type itself (see ``reifyType'').
     *  However if the type involves a symbol declared inside the quasiquote (i.e. registered in ``boundSyms''),
     *  then we cannot reify it, or otherwise subsequent reflective compilation will fail.
     *
     *  Why will it fail? Because reified deftrees (e.g. ClassDef(...)) will generate fresh symbols during that compilation,
     *  so naively reified symbols will become out of sync, which brings really funny compilation errors and/or crashes, e.g.:
     *  https://issues.scala-lang.org/browse/SI-5230
     *
     *  To deal with this unpleasant fact, we need to fall back from types to equivalent trees (after all, parser trees don't contain any types, just trees, so it should be possible).
     *  Luckily, these original trees get preserved for us in the ``original'' field when Trees get transformed into TypeTrees.
     *  And if an original of a type tree is empty, we can safely assume that this type is non-essential (e.g. was inferred/generated by the compiler).
     *  In that case the type can be omitted (e.g. reified as an empty TypeTree), since it will be inferred again later on.
     *
     *  An important property of the original is that it isn't just a pre-typer tree.
     *  It's actually kind of a post-typer tree with symbols assigned to its Idents (e.g. Ident(&quot;List&quot;) will contain a symbol that points to immutable.this.List).
     *  This is very important, since subsequent reflective compilation won't have to resolve these symbols.
     *  In general case, such resolution cannot be performed, since reification doesn't preserve lexical context,
     *  which means that reflective compilation won't be aware of, say, imports that were provided when the reifee has been compiled.
     *
     *  This workaround worked surprisingly well and allowed me to fix several important reification bugs, until the abstraction has leaked.
     *  Suddenly I found out that in certain contexts original trees do not contain symbols, but are just parser trees.
     *  To the moment I know only one such situation: typedAnnotations does not typecheck the annotation in-place, but rather creates new trees and typechecks them, so the original remains symless.
     *  Thus we apply a workaround for that in typedAnnotated. I hope this will be the only workaround in this department.
     *
     *  upd. Recently I went ahead and started using original for all TypeTrees, regardless of whether they refer to local symbols or not.
     *  As a result, ``reifyType'' is never called directly by tree reification (and, wow, it seems to work great!).
     *  The only usage of ``reifyType'' now is for servicing typetags, however, I have some ideas how to get rid of that as well.
     */
    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(tt: Reshape.this.mirror.TypeTree)Boolean" id="565119">isDiscarded</a><span class="delimiter">(</span><a title="Reshape.this.mirror.TypeTree" id="565277">tt</a>: <a href="../../api/Trees.scala.html#23743" title="Reshape.this.mirror.TypeTree">TypeTree</a><span class="delimiter">)</span> = <a href="#565277" title="Reshape.this.mirror.TypeTree">tt</a>.<a href="../../api/Trees.scala.html#428890" title="=&gt; Reshape.this.mirror.Tree">original</a> <span title="(x$1: AnyRef)Boolean">==</span> <span title="Null(null)" class="keyword">null</span>
    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(tt: Reshape.this.mirror.TypeTree)Reshape.this.mirror.Tree" id="565120">toPreTyperTypeTree</a><span class="delimiter">(</span><a title="Reshape.this.mirror.TypeTree" id="565144">tt</a>: <a href="../../api/Trees.scala.html#23743" title="Reshape.this.mirror.TypeTree">TypeTree</a><span class="delimiter">)</span>: <a href="../../api/Trees.scala.html#23570" title="Reshape.this.mirror.Tree">Tree</a> = <span class="delimiter">{</span>
      <span title="Reshape.this.mirror.Tree" class="keyword">if</span> <span class="delimiter">(</span><a href="#565144" title="Reshape.this.mirror.TypeTree">tt</a>.<a href="../../api/Trees.scala.html#428890" title="=&gt; Reshape.this.mirror.Tree">original</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        // here we rely on the fact that the originals that reach this point
        // have all necessary symbols attached to them (i.e. that they can be recompiled in any lexical context)
        // if this assumption fails, please, don't be quick to add postprocessing here (like I did before)
        // but rather try to fix this in Typer, so that it produces quality originals (like it's done for typedAnnotated)
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../codegen/Util.scala.html#563438" title="=&gt; Boolean">reifyDebug</a><span class="delimiter">)</span> <a href="../../../Predef.scala.html#8489" title="(x: Any)Unit">println</a><span class="delimiter">(</span><a href="../../../Predef.scala.html#8578" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;TypeTree, essential: %s (%s)&quot;</a>.<a href="../../../collection/immutable/StringLike.scala.html#60730" title="(args: Any*)String">format</a><span class="delimiter">(</span><a href="#565144" title="Reshape.this.mirror.TypeTree">tt</a>.<a href="../../api/Trees.scala.html#425060" title="=&gt; Reshape.this.mirror.Type">tpe</a>, <a href="#565144" title="Reshape.this.mirror.TypeTree">tt</a>.<a href="../../api/Trees.scala.html#425060" title="=&gt; Reshape.this.mirror.Type">tpe</a>.<a href="../../internal/Types.scala.html#442093" title="=&gt; String">kind</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../codegen/Util.scala.html#563438" title="=&gt; Boolean">reifyDebug</a><span class="delimiter">)</span> <a href="../../../Predef.scala.html#8489" title="(x: Any)Unit">println</a><span class="delimiter">(</span><a href="../../../Predef.scala.html#8578" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;verdict: rolled back to original %s&quot;</a>.<a href="../../../collection/immutable/StringLike.scala.html#60730" title="(args: Any*)String">format</a><span class="delimiter">(</span><a href="#565144" title="Reshape.this.mirror.TypeTree">tt</a>.<a href="../../api/Trees.scala.html#428890" title="=&gt; Reshape.this.mirror.Tree">original</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <a href="#565116" title="(tree: Reshape.this.mirror.Tree)Reshape.this.mirror.Tree">transform</a><span class="delimiter">(</span><a href="#565144" title="Reshape.this.mirror.TypeTree">tt</a>.<a href="../../api/Trees.scala.html#428890" title="=&gt; Reshape.this.mirror.Tree">original</a><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
        // type is deemed to be non-essential
        // erase it and hope that subsequent reflective compilation will be able to recreate it again
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../codegen/Util.scala.html#563438" title="=&gt; Boolean">reifyDebug</a><span class="delimiter">)</span> <a href="../../../Predef.scala.html#8489" title="(x: Any)Unit">println</a><span class="delimiter">(</span><a href="../../../Predef.scala.html#8578" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;TypeTree, non-essential: %s (%s)&quot;</a>.<a href="../../../collection/immutable/StringLike.scala.html#60730" title="(args: Any*)String">format</a><span class="delimiter">(</span><a href="#565144" title="Reshape.this.mirror.TypeTree">tt</a>.<a href="../../api/Trees.scala.html#425060" title="=&gt; Reshape.this.mirror.Type">tpe</a>, <a href="#565144" title="Reshape.this.mirror.TypeTree">tt</a>.<a href="../../api/Trees.scala.html#425060" title="=&gt; Reshape.this.mirror.Type">tpe</a>.<a href="../../internal/Types.scala.html#442093" title="=&gt; String">kind</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../codegen/Util.scala.html#563438" title="=&gt; Boolean">reifyDebug</a><span class="delimiter">)</span> <a href="../../../Predef.scala.html#8489" title="(x: Any)Unit">println</a><span class="delimiter">(</span><span title="String(&quot;verdict: discarded&quot;)" class="string">&quot;verdict: discarded&quot;</span><span class="delimiter">)</span>
        <a href="../../api/Trees.scala.html#429772" title="()Reshape.this.mirror.TypeTree">TypeTree</a><span class="delimiter">(</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(tree: Reshape.this.mirror.Tree)Reshape.this.mirror.Tree" id="565121">toPreTyperTypedOrAnnotated</a><span class="delimiter">(</span><a title="Reshape.this.mirror.Tree" id="565149">tree</a>: <a href="../../api/Trees.scala.html#23570" title="Reshape.this.mirror.Tree">Tree</a><span class="delimiter">)</span>: <a href="../../api/Trees.scala.html#23570" title="Reshape.this.mirror.Tree">Tree</a> = <a href="#565149" title="Reshape.this.mirror.Tree">tree</a> <span class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> ty @ Typed<a href="#566138" title="Reshape.this.mirror.Tree" id="566140" class="delimiter">(</a>expr1, tt @ TypeTree<a title="Reshape.this.mirror.Tree" id="566142" class="delimiter">(</a><span class="delimiter">)</span><span class="delimiter">)</span> =&gt;
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../codegen/Util.scala.html#563438" title="=&gt; Boolean">reifyDebug</a><span class="delimiter">)</span> <a href="../../../Predef.scala.html#8489" title="(x: Any)Unit">println</a><span class="delimiter">(</span><span title="String(&quot;reify typed: &quot;)" class="string">&quot;reify typed: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#565149" title="Reshape.this.mirror.Tree">tree</a><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="Reshape.this.mirror.Tree" id="566060">annotatedArg</a> = <span class="delimiter">{</span>
          <span class="keyword">def</span> <a title="(tree: Reshape.this.mirror.Tree)Reshape.this.mirror.Tree" id="566063">loop</a><span class="delimiter">(</span><a title="Reshape.this.mirror.Tree" id="566064">tree</a>: <a href="../../api/Trees.scala.html#23570" title="Reshape.this.mirror.Tree">Tree</a><span class="delimiter">)</span>: <a href="../../api/Trees.scala.html#23570" title="Reshape.this.mirror.Tree">Tree</a> = <a href="#566064" title="Reshape.this.mirror.Tree">tree</a> <span class="keyword">match</span> <span class="delimiter">{</span>
            <span class="keyword">case</span> annotated1 @ Annotated<a href="#566078" title="Boolean" id="566080" class="delimiter">(</a>ann, annotated2 @ Annotated<a title="Reshape.this.mirror.Tree" id="566084" class="delimiter">(</a>_, _<span class="delimiter">)</span><span class="delimiter">)</span> =&gt; <a href="#566063" title="(tree: Reshape.this.mirror.Tree)Reshape.this.mirror.Tree">loop</a><a href="#566088" title="(x: Reshape.this.mirror.Tree)Reshape.this.mirror.Tree" class="delimiter">(</a>annotated2<span class="delimiter">)</span>
            <span class="keyword">case</span> annotated1 @ Annotated<span class="delimiter">(</span>ann, arg<span class="delimiter">)</span> =&gt; <a href="#566088" title="(x: Reshape.this.mirror.Tree)Reshape.this.mirror.Tree">arg</a>
            <span class="keyword">case</span> _ =&gt; <a href="#566088" title="(x: Reshape.this.mirror.Tree)Reshape.this.mirror.Tree">EmptyTree</a>
          <span class="delimiter">}</span>

          <a href="#566063" title="(tree: Reshape.this.mirror.Tree)Reshape.this.mirror.Tree">loop</a><span class="delimiter">(</span>tt.<a href="../../api/Trees.scala.html#428890" title="=&gt; Reshape.this.mirror.Tree">original</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
        <span title="Reshape.this.mirror.Tree" class="keyword">if</span> <span class="delimiter">(</span><a href="#566060" title="Reshape.this.mirror.Tree">annotatedArg</a> <span title="(x$1: AnyRef)Boolean">!=</span> <a href="../../api/Trees.scala.html#23577" title="Reshape.this.mirror.EmptyTree.type">EmptyTree</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <span title="Reshape.this.mirror.Tree" class="keyword">if</span> <span class="delimiter">(</span><a href="#566060" title="Reshape.this.mirror.Tree">annotatedArg</a>.<a href="../../api/Trees.scala.html#425073" title="=&gt; Boolean">isType</a><span class="delimiter">)</span> <span class="delimiter">{</span>
            <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../codegen/Util.scala.html#563438" title="=&gt; Boolean">reifyDebug</a><span class="delimiter">)</span> <a href="../../../Predef.scala.html#8489" title="(x: Any)Unit">println</a><span class="delimiter">(</span><span title="String(&quot;verdict: was an annotated type, reify as usual&quot;)" class="string">&quot;verdict: was an annotated type, reify as usual&quot;</span><span class="delimiter">)</span>
            ty
          <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
            <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../codegen/Util.scala.html#563438" title="=&gt; Boolean">reifyDebug</a><span class="delimiter">)</span> <a href="../../../Predef.scala.html#8489" title="(x: Any)Unit">println</a><span class="delimiter">(</span><span title="String(&quot;verdict: was an annotated value, equivalent is &quot;)" class="string">&quot;verdict: was an annotated value, equivalent is &quot;</span> <span title="(x$1: Any)String">+</span> tt.<a href="../../api/Trees.scala.html#428890" title="=&gt; Reshape.this.mirror.Tree">original</a><span class="delimiter">)</span>
            <a href="#565121" title="(tree: Reshape.this.mirror.Tree)Reshape.this.mirror.Tree">toPreTyperTypedOrAnnotated</a><span class="delimiter">(</span>tt.<a href="../../api/Trees.scala.html#428890" title="=&gt; Reshape.this.mirror.Tree">original</a><span class="delimiter">)</span>
          <span class="delimiter">}</span>
        <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../codegen/Util.scala.html#563438" title="=&gt; Boolean">reifyDebug</a><span class="delimiter">)</span> <a href="../../../Predef.scala.html#8489" title="(x: Any)Unit">println</a><span class="delimiter">(</span><span title="String(&quot;verdict: wasn\'t annotated, reify as usual&quot;)" class="string">&quot;verdict: wasn't annotated, reify as usual&quot;</span><span class="delimiter">)</span>
          ty
        <span class="delimiter">}</span>
      <span class="keyword">case</span> at @ Annotated<a href="#566138" title="Reshape.this.mirror.Tree" id="566144" class="delimiter">(</a>annot, arg<span class="delimiter">)</span> =&gt;
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../codegen/Util.scala.html#563438" title="=&gt; Boolean">reifyDebug</a><span class="delimiter">)</span> <a href="../../../Predef.scala.html#8489" title="(x: Any)Unit">println</a><span class="delimiter">(</span><span title="String(&quot;reify type annotations for: &quot;)" class="string">&quot;reify type annotations for: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#565149" title="Reshape.this.mirror.Tree">tree</a><span class="delimiter">)</span>
        <a href="../../../tools/nsc/Global.scala.html#559533" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a><span class="delimiter">(</span>at.<a href="../../api/Trees.scala.html#425060" title="=&gt; Reshape.this.mirror.Type">tpe</a>.<span title="[T0]=&gt; Boolean">isInstanceOf</span><span title="Boolean" class="delimiter">[</span><a href="../../internal/Types.scala.html#441346" title="Reshape.this.mirror.AnnotatedType">AnnotatedType</a><span class="delimiter">]</span>, <a href="../../../Predef.scala.html#8578" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;%s (%s)&quot;</a>.<a href="../../../collection/immutable/StringLike.scala.html#60730" title="(args: Any*)String">format</a><span class="delimiter">(</span>at.<a href="../../api/Trees.scala.html#425060" title="=&gt; Reshape.this.mirror.Type">tpe</a>, at.<a href="../../api/Trees.scala.html#425060" title="=&gt; Reshape.this.mirror.Type">tpe</a>.<a href="../../internal/Types.scala.html#442093" title="=&gt; String">kind</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="Reshape.this.mirror.Tree" id="566109">annot1</a> = <a href="#565122" title="(ann: Reshape.this.mirror.AnnotationInfo)Reshape.this.mirror.Tree">toPreTyperAnnotation</a><span class="delimiter">(</span>at.<a href="../../api/Trees.scala.html#425060" title="=&gt; Reshape.this.mirror.Type">tpe</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="Reshape.this.mirror.AnnotatedType" class="delimiter">[</span><a href="../../internal/Types.scala.html#441346" title="Reshape.this.mirror.AnnotatedType">AnnotatedType</a><span class="delimiter">]</span>.<a href="../../../collection/LinearSeqOptimized.scala.html#76165" title="(n: Int)Reshape.this.mirror.AnnotationInfo">annotations</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span><span class="delimiter">)</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../codegen/Util.scala.html#563438" title="=&gt; Boolean">reifyDebug</a><span class="delimiter">)</span> <a href="../../../Predef.scala.html#8489" title="(x: Any)Unit">println</a><span class="delimiter">(</span><span title="String(&quot;originals are: &quot;)" class="string">&quot;originals are: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#566109" title="Reshape.this.mirror.Tree">annot1</a><span class="delimiter">)</span>
        <a href="../../api/Trees.scala.html#433446" title="(annot: Reshape.this.mirror.Tree, arg: Reshape.this.mirror.Tree)Reshape.this.mirror.Annotated">Annotated</a><span class="delimiter">(</span><a href="#566109" title="Reshape.this.mirror.Tree">annot1</a>, arg<span class="delimiter">)</span>.<a href="../../api/Trees.scala.html#425087" title="(tree: Reshape.this.mirror.Tree)Reshape.this.mirror.Annotated">copyAttrs</a><span class="delimiter">(</span>at<span class="delimiter">)</span>
    <span class="delimiter">}</span>

    /** Restore pre-typer representation of an annotation.
     *  The trick here is to retain the symbols that have been populated during typechecking of the annotation.
     *  If we do not do that, subsequent reflective compilation will fail.
     */
    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(ann: Reshape.this.mirror.AnnotationInfo)Reshape.this.mirror.Tree" id="565122">toPreTyperAnnotation</a><span class="delimiter">(</span><a title="Reshape.this.mirror.AnnotationInfo" id="565992">ann</a>: <a href="../../internal/AnnotationInfos.scala.html#441795" title="Reshape.this.mirror.AnnotationInfo">AnnotationInfo</a><span class="delimiter">)</span>: <a href="../../api/Trees.scala.html#23570" title="Reshape.this.mirror.Tree">Tree</a> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="List[Reshape.this.mirror.Tree]" id="566150">args</a> = <span title="List[Reshape.this.mirror.Tree]" class="keyword">if</span> <span class="delimiter">(</span><a href="#565992" title="Reshape.this.mirror.AnnotationInfo">ann</a>.<a href="../../internal/AnnotationInfos.scala.html#443793" title="=&gt; List[(Reshape.this.mirror.Name, Reshape.this.mirror.ClassfileAnnotArg)]">assocs</a>.<a href="../../../collection/IterableLike.scala.html#59464" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#565992" title="Reshape.this.mirror.AnnotationInfo">ann</a>.<a href="../../internal/AnnotationInfos.scala.html#443792" title="=&gt; List[Reshape.this.mirror.Tree]">args</a>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
        <span class="keyword">def</span> <a title="(jann: Reshape.this.mirror.ClassfileAnnotArg)Reshape.this.mirror.Tree" id="566153">toScalaAnnotation</a><span class="delimiter">(</span><a title="Reshape.this.mirror.ClassfileAnnotArg" id="566154">jann</a>: <a href="../../internal/AnnotationInfos.scala.html#441778" title="Reshape.this.mirror.ClassfileAnnotArg">ClassfileAnnotArg</a><span class="delimiter">)</span>: <a href="../../api/Trees.scala.html#23570" title="Reshape.this.mirror.Tree">Tree</a> = <a href="#566154" title="Reshape.this.mirror.ClassfileAnnotArg">jann</a> <span class="keyword">match</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> LiteralAnnotArg<a href="#566359" title="Reshape.this.mirror.Tree" id="566361" class="delimiter">(</a>const<span class="delimiter">)</span> =&gt;
            <a href="../../api/Trees.scala.html#432792" title="(value: Reshape.this.mirror.Constant)Reshape.this.mirror.Literal">Literal</a><a href="#566366" title="(x: Reshape.this.mirror.Tree)Reshape.this.mirror.Tree" class="delimiter">(</a>const<span class="delimiter">)</span>
          <span class="keyword">case</span> ArrayAnnotArg<a href="#566359" title="Reshape.this.mirror.Tree" id="566363" class="delimiter">(</a>arr<span class="delimiter">)</span> =&gt;
            <a href="../../api/Trees.scala.html#427174" title="(fun: Reshape.this.mirror.Tree, args: List[Reshape.this.mirror.Tree])Reshape.this.mirror.Apply">Apply</a><a href="#566366" title="(x: Reshape.this.mirror.Tree)Reshape.this.mirror.Tree" class="delimiter">(</a><a href="../../internal/Trees.scala.html#441842" title="(sym: Reshape.this.mirror.Symbol)Reshape.this.mirror.Ident">Ident</a><span class="delimiter">(</span><a href="../../internal/Definitions.scala.html#441641" title="Reshape.this.mirror.definitions.type">definitions</a>.<a href="../../internal/Definitions.scala.html#442348" title="=&gt; Reshape.this.mirror.ModuleSymbol">ArrayModule</a><span class="delimiter">)</span>, <a href="../../../Predef.scala.html#8521" title="(xs: Array[Reshape.this.mirror.ClassfileAnnotArg])scala.collection.mutable.ArrayOps[Reshape.this.mirror.ClassfileAnnotArg]">arr</a>.<a href="../../../collection/TraversableOnce.scala.html#59174" title="=&gt; List[Reshape.this.mirror.ClassfileAnnotArg]">toList</a> <a href="../../../collection/TraversableLike.scala.html#58971" title="(f: Reshape.this.mirror.ClassfileAnnotArg =&gt; Reshape.this.mirror.Tree)(implicit bf: scala.collection.generic.CanBuildFrom[List[Reshape.this.mirror.ClassfileAnnotArg],Reshape.this.mirror.Tree,List[Reshape.this.mirror.Tree]])List[Reshape.this.mirror.Tree]">map</a> <a href="#566153" title="(jann: Reshape.this.mirror.ClassfileAnnotArg)Reshape.this.mirror.Tree">toScalaAnnotation</a><span class="delimiter">)</span>
          <span class="keyword">case</span> NestedAnnotArg<a href="#566359" title="Reshape.this.mirror.Tree" id="566365" class="delimiter">(</a>ann<span class="delimiter">)</span> =&gt;
            <a href="#565122" title="(ann: Reshape.this.mirror.AnnotationInfo)Reshape.this.mirror.Tree">toPreTyperAnnotation</a><a href="#566366" title="(x: Reshape.this.mirror.Tree)Reshape.this.mirror.Tree" class="delimiter">(</a>ann<span class="delimiter">)</span>
        <span class="delimiter">}</span>

        <a href="#565992" title="Reshape.this.mirror.AnnotationInfo">ann</a>.<a href="../../internal/AnnotationInfos.scala.html#443793" title="=&gt; List[(Reshape.this.mirror.Name, Reshape.this.mirror.ClassfileAnnotArg)]">assocs</a> <a href="../../../collection/TraversableLike.scala.html#58971" title="(f: ((Reshape.this.mirror.Name, Reshape.this.mirror.ClassfileAnnotArg)) =&gt; Reshape.this.mirror.AssignOrNamedArg)(implicit bf: scala.collection.generic.CanBuildFrom[List[(Reshape.this.mirror.Name, Reshape.this.mirror.ClassfileAnnotArg)],Reshape.this.mirror.AssignOrNamedArg,List[Reshape.this.mirror.AssignOrNamedArg]])List[Reshape.this.mirror.AssignOrNamedArg]">map</a> <a title="anonymous class $anonfun extends scala.runtime.AbstractFunction1[(Reshape.this.mirror.Name, Reshape.this.mirror.ClassfileAnnotArg),Reshape.this.mirror.AssignOrNamedArg] with Serializable" id="566395" class="delimiter">{</a> <span class="keyword">case</span> <span class="delimiter">(</span>nme, arg<span class="delimiter">)</span> =&gt; <a href="../../api/Trees.scala.html#429833" title="(lhs: Reshape.this.mirror.Tree, rhs: Reshape.this.mirror.Tree)Reshape.this.mirror.AssignOrNamedArg">AssignOrNamedArg</a><a href="#566418" title="(x: Reshape.this.mirror.AssignOrNamedArg)Reshape.this.mirror.AssignOrNamedArg" class="delimiter">(</a><a href="../../api/Trees.scala.html#427669" title="(name: Reshape.this.mirror.Name)Reshape.this.mirror.Ident">Ident</a><span class="delimiter">(</span>nme<span class="delimiter">)</span>, <a href="#566153" title="(jann: Reshape.this.mirror.ClassfileAnnotArg)Reshape.this.mirror.Tree">toScalaAnnotation</a><span class="delimiter">(</span>arg<span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">}</span>
      <span class="delimiter">}</span>

      <span class="keyword">def</span> <a title="=&gt; PartialFunction[Reshape.this.mirror.Tree,Reshape.this.mirror.Tree]" id="566151">extractOriginal</a>: <a href="../../../PartialFunction.scala.html#217" title="PartialFunction[Reshape.this.mirror.Tree,Reshape.this.mirror.Tree]">PartialFunction</a><span class="delimiter">[</span>Tree, Tree<span class="delimiter">]</span> = <a title="anonymous class $anonfun extends scala.runtime.AbstractPartialFunction[Reshape.this.mirror.Tree,Reshape.this.mirror.Tree] with Serializable" id="566508" class="delimiter">{</a> <span class="keyword">case</span> Apply<a href="#566493" title="B1" id="566527" class="delimiter">(</a>Select<a title="B1" id="566531" class="delimiter">(</a>New<a title="B1" id="566533" class="delimiter">(</a>tpt<span class="delimiter">)</span>, _<span class="delimiter">)</span>, _<span class="delimiter">)</span> =&gt; <a href="#566504" title="(x: B1)B1">tpt</a> <span class="delimiter">}</span>
      <a href="../../../tools/nsc/Global.scala.html#559533" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a><span class="delimiter">(</span><a href="#566151" title="=&gt; PartialFunction[Reshape.this.mirror.Tree,Reshape.this.mirror.Tree]">extractOriginal</a>.<a href="../../../PartialFunction.scala.html#59566" title="(x: Reshape.this.mirror.Tree)Boolean">isDefinedAt</a><span class="delimiter">(</span><a href="#565992" title="Reshape.this.mirror.AnnotationInfo">ann</a>.<a href="../../internal/AnnotationInfos.scala.html#443794" title="=&gt; Reshape.this.mirror.Tree">original</a><span class="delimiter">)</span>, <a href="../../api/TreePrinters.scala.html#23837" title="(tree: Reshape.this.mirror.Tree)String">showRaw</a><span class="delimiter">(</span><a href="#565992" title="Reshape.this.mirror.AnnotationInfo">ann</a>.<a href="../../internal/AnnotationInfos.scala.html#443794" title="=&gt; Reshape.this.mirror.Tree">original</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="../../internal/Trees.scala.html#441834" title="(tpt: Reshape.this.mirror.Tree, argss: List[List[Reshape.this.mirror.Tree]])Reshape.this.mirror.Tree">New</a><span class="delimiter">(</span><a href="../../api/Trees.scala.html#23746" title="(tp: Reshape.this.mirror.Type)Reshape.this.mirror.TypeTree">TypeTree</a><span class="delimiter">(</span><a href="#565992" title="Reshape.this.mirror.AnnotationInfo">ann</a>.<a href="../../internal/AnnotationInfos.scala.html#443791" title="=&gt; Reshape.this.mirror.Type">atp</a><span class="delimiter">)</span> <a href="../../api/Trees.scala.html#428891" title="(tree: Reshape.this.mirror.Tree)Reshape.this.mirror.TypeTree">setOriginal</a> <a href="../../../Function1.scala.html#59555" title="(v1: Reshape.this.mirror.Tree)Reshape.this.mirror.Tree">extractOriginal</a><span class="delimiter">(</span><a href="#565992" title="Reshape.this.mirror.AnnotationInfo">ann</a>.<a href="../../internal/AnnotationInfos.scala.html#443794" title="=&gt; Reshape.this.mirror.Tree">original</a><span class="delimiter">)</span>, <a href="../../../collection/immutable/List.scala.html#63291" title="(xs: List[Reshape.this.mirror.Tree]*)List[List[Reshape.this.mirror.Tree]]">List</a><span class="delimiter">(</span><a href="#566150" title="List[Reshape.this.mirror.Tree]">args</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    // [Eugene] is this implemented correctly?
    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(deff: Reshape.this.mirror.Tree, stats: List[Reshape.this.mirror.Tree])List[Reshape.this.mirror.Tree]" id="565123">trimAccessors</a><span class="delimiter">(</span><a title="Reshape.this.mirror.Tree" id="565373">deff</a>: <a href="../../api/Trees.scala.html#23570" title="Reshape.this.mirror.Tree">Tree</a>, <a title="List[Reshape.this.mirror.Tree]" id="565374">stats</a>: <a href="../../../collection/immutable/List.scala.html#12322" title="List[Reshape.this.mirror.Tree]">List</a><span class="delimiter">[</span>Tree<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../../collection/immutable/List.scala.html#12322" title="List[Reshape.this.mirror.Tree]">List</a><span class="delimiter">[</span>Tree<span class="delimiter">]</span> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="scala.collection.immutable.Map[Reshape.this.mirror.Symbol,Reshape.this.mirror.ValOrDefDef]" id="566588">symdefs</a> = <a href="#565374" title="List[Reshape.this.mirror.Tree]">stats</a> <a href="../../../collection/TraversableLike.scala.html#58983" title="(pf: PartialFunction[Reshape.this.mirror.Tree,Reshape.this.mirror.ValOrDefDef])(implicit bf: scala.collection.generic.CanBuildFrom[List[Reshape.this.mirror.Tree],Reshape.this.mirror.ValOrDefDef,List[Reshape.this.mirror.ValOrDefDef]])List[Reshape.this.mirror.ValOrDefDef]">collect</a> <a title="anonymous class $anonfun extends scala.runtime.AbstractPartialFunction[Reshape.this.mirror.Tree,Reshape.this.mirror.ValOrDefDef] with Serializable" id="566619" class="delimiter">{</a> <span class="keyword">case</span> <a href="#566610" title="B1" id="566625">vodef</a>: ValOrDefDef =&gt; <a href="#566615" title="(x: B1)B1">vodef</a> <span class="delimiter">}</span> <a href="../../../collection/TraversableLike.scala.html#58971" title="(f: Reshape.this.mirror.ValOrDefDef =&gt; (Reshape.this.mirror.Symbol, Reshape.this.mirror.ValOrDefDef))(implicit bf: scala.collection.generic.CanBuildFrom[List[Reshape.this.mirror.ValOrDefDef],(Reshape.this.mirror.Symbol, Reshape.this.mirror.ValOrDefDef),List[(Reshape.this.mirror.Symbol, Reshape.this.mirror.ValOrDefDef)]])List[(Reshape.this.mirror.Symbol, Reshape.this.mirror.ValOrDefDef)]">map</a> <span class="delimiter">(</span><a title="Reshape.this.mirror.ValOrDefDef" id="566724">vodeff</a> =&gt; <a href="#566724" title="Reshape.this.mirror.ValOrDefDef">vodeff</a>.<a href="../../../Predef.scala.html#8484" title="(x: Reshape.this.mirror.Symbol)ArrowAssoc[Reshape.this.mirror.Symbol]">symbol</a> <a href="../../../Predef.scala.html#63591" title="(y: Reshape.this.mirror.ValOrDefDef)(Reshape.this.mirror.Symbol, Reshape.this.mirror.ValOrDefDef)">-&gt;</a> <a href="#566724" title="Reshape.this.mirror.ValOrDefDef">vodeff</a><span class="delimiter">)</span> <a href="../../../collection/TraversableOnce.scala.html#59184" title="(implicit ev: &lt;:&lt;[(Reshape.this.mirror.Symbol, Reshape.this.mirror.ValOrDefDef),(Reshape.this.mirror.Symbol, Reshape.this.mirror.ValOrDefDef)])scala.collection.immutable.Map[Reshape.this.mirror.Symbol,Reshape.this.mirror.ValOrDefDef]">toMap</a>
      <span class="keyword">val</span> <a title="scala.collection.mutable.Map[Reshape.this.mirror.ValDef,List[Reshape.this.mirror.DefDef]]" id="566589">accessors</a> = collection.mutable.<a href="../../../collection/generic/GenMapFactory.scala.html#61654" title="[A, B](elems: (A, B)*)scala.collection.mutable.Map[A,B]">Map</a><span title="(elems: (Reshape.this.mirror.ValDef, List[Reshape.this.mirror.DefDef])*)scala.collection.mutable.Map[Reshape.this.mirror.ValDef,List[Reshape.this.mirror.DefDef]]" class="delimiter">[</span><a href="../../api/Trees.scala.html#23593" title="Reshape.this.mirror.ValDef">ValDef</a>, <a href="../../../collection/immutable/List.scala.html#12322" title="List[Reshape.this.mirror.DefDef]">List</a><span class="delimiter">[</span>DefDef<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>
      <a href="#565374" title="List[Reshape.this.mirror.Tree]">stats</a> <a href="../../../collection/TraversableLike.scala.html#58983" title="(pf: PartialFunction[Reshape.this.mirror.Tree,Reshape.this.mirror.DefDef])(implicit bf: scala.collection.generic.CanBuildFrom[List[Reshape.this.mirror.Tree],Reshape.this.mirror.DefDef,List[Reshape.this.mirror.DefDef]])List[Reshape.this.mirror.DefDef]">collect</a> <a title="anonymous class $anonfun extends scala.runtime.AbstractPartialFunction[Reshape.this.mirror.Tree,Reshape.this.mirror.DefDef] with Serializable" id="566808" class="delimiter">{</a> <span class="keyword">case</span> <a href="#566799" title="B1" id="566814">ddef</a>: DefDef =&gt; <a href="#566804" title="(x: B1)B1">ddef</a> <span class="delimiter">}</span> <a href="../../../collection/LinearSeqOptimized.scala.html#76166" title="(f: Reshape.this.mirror.DefDef =&gt; Unit)Unit">foreach</a> <span class="delimiter">(</span><a title="Reshape.this.mirror.DefDef" id="566916">defdef</a> =&gt; <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="Reshape.this.mirror.ValDef" id="566917">valdef</a> = <a href="#566588" title="scala.collection.immutable.Map[Reshape.this.mirror.Symbol,Reshape.this.mirror.ValOrDefDef]">symdefs</a> <a href="../../../collection/MapLike.scala.html#78410" title="(key: Reshape.this.mirror.Symbol)Option[Reshape.this.mirror.ValOrDefDef]">get</a> <a href="#566916" title="Reshape.this.mirror.DefDef">defdef</a>.<a href="../../api/Trees.scala.html#427232" title="=&gt; Reshape.this.mirror.Symbol">symbol</a>.<a href="../../internal/Symbols.scala.html#443496" title="=&gt; Reshape.this.mirror.Symbol">accessedOrSelf</a> <a href="../../../Option.scala.html#63842" title="(pf: PartialFunction[Reshape.this.mirror.ValOrDefDef,Reshape.this.mirror.ValDef])Option[Reshape.this.mirror.ValDef]">collect</a> <a title="anonymous class $anonfun extends scala.runtime.AbstractPartialFunction[Reshape.this.mirror.ValOrDefDef,Reshape.this.mirror.ValDef] with Serializable" id="566941" class="delimiter">{</a> <span class="keyword">case</span> <a href="#566932" title="B1" id="566947">vdef</a>: ValDef =&gt; <a href="#566937" title="(x: B1)B1">vdef</a> <span class="delimiter">}</span> <a href="../../../Option.scala.html#63814" title="(default: =&gt; Reshape.this.mirror.ValDef)Reshape.this.mirror.ValDef">getOrElse</a> <span title="Null(null)" class="keyword">null</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#566917" title="Reshape.this.mirror.ValDef">valdef</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <a href="../../../collection/mutable/MapLike.scala.html#78496" title="(key: Reshape.this.mirror.ValDef, value: List[Reshape.this.mirror.DefDef])Unit">accessors</a><span class="delimiter">(</span><a href="#566917" title="Reshape.this.mirror.ValDef">valdef</a><span class="delimiter">)</span> = <a href="#566589" title="scala.collection.mutable.Map[Reshape.this.mirror.ValDef,List[Reshape.this.mirror.DefDef]]">accessors</a>.<a href="../../../collection/MapLike.scala.html#78417" title="(key: Reshape.this.mirror.ValDef, default: =&gt; List[Reshape.this.mirror.DefDef])List[Reshape.this.mirror.DefDef]">getOrElse</a><span class="delimiter">(</span><a href="#566917" title="Reshape.this.mirror.ValDef">valdef</a>, <a href="../../../collection/immutable/List.scala.html#11552" title="scala.collection.immutable.Nil.type">Nil</a><span class="delimiter">)</span> <a href="../../../collection/SeqLike.scala.html#59810" title="(elem: Reshape.this.mirror.DefDef)(implicit bf: scala.collection.generic.CanBuildFrom[List[Reshape.this.mirror.DefDef],Reshape.this.mirror.DefDef,List[Reshape.this.mirror.DefDef]])List[Reshape.this.mirror.DefDef]">:+</a> <a href="#566916" title="Reshape.this.mirror.DefDef">defdef</a>

        <span class="keyword">def</span> <a title="(prefix: String)Unit" id="566918">detectBeanAccessors</a><span class="delimiter">(</span><a title="String" id="567076">prefix</a>: <span title="String">String</span><span class="delimiter">)</span>: <a href="../../../Unit.scala.html#2389" title="Unit">Unit</a> = <span class="delimiter">{</span>
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#566916" title="Reshape.this.mirror.DefDef">defdef</a>.<a href="../../api/Trees.scala.html#427498" title="=&gt; Reshape.this.mirror.Name">name</a>.<a href="../../internal/Names.scala.html#444157" title="(name: String)Boolean">startsWith</a><span class="delimiter">(</span><a href="#567076" title="String">prefix</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
            <span class="keyword">var</span> <a title="String" id="567084">name</a> = <a href="#566916" title="Reshape.this.mirror.DefDef">defdef</a>.<a href="../../api/Trees.scala.html#427498" title="=&gt; Reshape.this.mirror.Name">name</a>.<a href="../../../Function1.scala.html#59562" title="()String">toString</a>.<span title="(x$1: Int)String">substring</span><span class="delimiter">(</span><a href="#567076" title="String">prefix</a>.<span title="()Int">length</span><span class="delimiter">)</span>
            <span class="keyword">def</span> <a title="(s: String)String" id="567085">uncapitalize</a><span class="delimiter">(</span><a title="String" id="567090">s</a>: <span title="String">String</span><span class="delimiter">)</span> = <span title="String" class="keyword">if</span> <span class="delimiter">(</span><a href="#567090" title="String">s</a>.<span title="()Int">length</span> <a href="../../../Int.scala.html#57891" title="(x: Int)Boolean">==</a> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span> <span class="keyword">else</span> <span class="delimiter">{</span> <span class="keyword">val</span> <a title="Array[Char]" id="567096">chars</a> = <a href="#567090" title="String">s</a>.<span title="()Array[Char]">toCharArray</span>; <a href="../../../Array.scala.html#57451" title="(i: Int, x: Char)Unit">chars</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span> = <a href="../../../Array.scala.html#57450" title="(i: Int)Char">chars</a><a href="../../../LowPriorityImplicits.scala.html#8334" title="implicit scala.LowPriorityImplicits.charWrapper : (c: Char)scala.runtime.RichChar" class="delimiter">(</a><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>.<a href="../../../runtime/RichChar.scala.html#58013" title="=&gt; Char">toLower</a>; <span title="(x$1: Array[Char])String" class="keyword">new</span> <a href="../../../Predef.scala.html#8371" title="String">String</a><span class="delimiter">(</span><a href="#567096" title="Array[Char]">chars</a><span class="delimiter">)</span> <span class="delimiter">}</span>
            <span class="keyword">def</span> <a title="(name: String)Option[Reshape.this.mirror.ValDef]" id="567086">findValDef</a><span class="delimiter">(</span><a title="String" id="567107">name</a>: <span title="String">String</span><span class="delimiter">)</span> = <a href="#566588" title="scala.collection.immutable.Map[Reshape.this.mirror.Symbol,Reshape.this.mirror.ValOrDefDef]">symdefs</a>.<a href="../../../collection/MapLike.scala.html#78427" title="=&gt; Iterable[Reshape.this.mirror.ValOrDefDef]">values</a> <a href="../../../collection/TraversableLike.scala.html#58983" title="(pf: PartialFunction[Reshape.this.mirror.ValOrDefDef,Reshape.this.mirror.ValDef])(implicit bf: scala.collection.generic.CanBuildFrom[Iterable[Reshape.this.mirror.ValOrDefDef],Reshape.this.mirror.ValDef,Iterable[Reshape.this.mirror.ValDef]])Iterable[Reshape.this.mirror.ValDef]">collect</a> <a title="anonymous class $anonfun extends scala.runtime.AbstractPartialFunction[Reshape.this.mirror.ValOrDefDef,Reshape.this.mirror.ValDef] with Serializable" id="567153" class="delimiter">{</a> <span class="keyword">case</span> <a href="#567144" title="B1" id="567165">vdef</a>: ValDef <span class="keyword">if</span> <a href="../../internal/StdNames.scala.html#441764" title="Reshape.this.mirror.nme.type">nme</a>.<a href="../../internal/StdNames.scala.html#446246" title="(name: Reshape.this.mirror.Name)Reshape.this.mirror.Name">dropLocalSuffix</a><span class="delimiter">(</span>vdef.<a href="../../api/Trees.scala.html#427471" title="=&gt; Reshape.this.mirror.TermName">name</a><span class="delimiter">)</span>.<a href="../../../Function1.scala.html#59562" title="()String">toString</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#567107" title="String">name</a> =&gt; <a href="#567149" title="(x: B1)B1">vdef</a> <span class="delimiter">}</span> <a href="../../../collection/TraversableLike.scala.html#59011" title="=&gt; Option[Reshape.this.mirror.ValDef]">headOption</a>;
            <span class="keyword">val</span> <a title="Reshape.this.mirror.ValDef" id="567087">valdef</a> = <a href="#567086" title="(name: String)Option[Reshape.this.mirror.ValDef]">findValDef</a><span class="delimiter">(</span><a href="#567084" title="String">name</a><span class="delimiter">)</span> <a href="../../../Option.scala.html#63845" title="(alternative: =&gt; Option[Reshape.this.mirror.ValDef])Option[Reshape.this.mirror.ValDef]">orElse</a> <a href="#567086" title="(name: String)Option[Reshape.this.mirror.ValDef]">findValDef</a><span class="delimiter">(</span><a href="#567085" title="(s: String)String">uncapitalize</a><span class="delimiter">(</span><a href="#567084" title="String">name</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../../Option.scala.html#63817" title="(implicit ev: &lt;:&lt;[Null,Reshape.this.mirror.ValDef])Reshape.this.mirror.ValDef">orNull</a>;
            <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#567087" title="Reshape.this.mirror.ValDef">valdef</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <a href="../../../collection/mutable/MapLike.scala.html#78496" title="(key: Reshape.this.mirror.ValDef, value: List[Reshape.this.mirror.DefDef])Unit">accessors</a><span class="delimiter">(</span><a href="#567087" title="Reshape.this.mirror.ValDef">valdef</a><span class="delimiter">)</span> = <a href="#566589" title="scala.collection.mutable.Map[Reshape.this.mirror.ValDef,List[Reshape.this.mirror.DefDef]]">accessors</a>.<a href="../../../collection/MapLike.scala.html#78417" title="(key: Reshape.this.mirror.ValDef, default: =&gt; List[Reshape.this.mirror.DefDef])List[Reshape.this.mirror.DefDef]">getOrElse</a><span class="delimiter">(</span><a href="#567087" title="Reshape.this.mirror.ValDef">valdef</a>, <a href="../../../collection/immutable/List.scala.html#11552" title="scala.collection.immutable.Nil.type">Nil</a><span class="delimiter">)</span> <a href="../../../collection/SeqLike.scala.html#59810" title="(elem: Reshape.this.mirror.DefDef)(implicit bf: scala.collection.generic.CanBuildFrom[List[Reshape.this.mirror.DefDef],Reshape.this.mirror.DefDef,List[Reshape.this.mirror.DefDef]])List[Reshape.this.mirror.DefDef]">:+</a> <a href="#566916" title="Reshape.this.mirror.DefDef">defdef</a>
          <span class="delimiter">}</span>
        <span class="delimiter">}</span>
        <a href="#566918" title="(prefix: String)Unit">detectBeanAccessors</a><span class="delimiter">(</span><span title="String(&quot;get&quot;)" class="string">&quot;get&quot;</span><span class="delimiter">)</span>
        <a href="#566918" title="(prefix: String)Unit">detectBeanAccessors</a><span class="delimiter">(</span><span title="String(&quot;set&quot;)" class="string">&quot;set&quot;</span><span class="delimiter">)</span>
        <a href="#566918" title="(prefix: String)Unit">detectBeanAccessors</a><span class="delimiter">(</span><span title="String(&quot;is&quot;)" class="string">&quot;is&quot;</span><span class="delimiter">)</span>
      <span class="delimiter">}</span><span class="delimiter">)</span>;

      <span class="keyword">var</span> <a title="List[Reshape.this.mirror.Tree]" id="566590">stats1</a> = <a href="#565374" title="List[Reshape.this.mirror.Tree]">stats</a> <a href="../../../collection/TraversableLike.scala.html#58976" title="(f: Reshape.this.mirror.Tree =&gt; scala.collection.GenTraversableOnce[Reshape.this.mirror.Tree])(implicit bf: scala.collection.generic.CanBuildFrom[List[Reshape.this.mirror.Tree],Reshape.this.mirror.Tree,List[Reshape.this.mirror.Tree]])List[Reshape.this.mirror.Tree]">flatMap</a> <a title="anonymous class $anonfun extends scala.runtime.AbstractFunction1[Reshape.this.mirror.Tree,Iterable[Reshape.this.mirror.Tree]] with Serializable" id="567321" class="delimiter">{</a>
        <span class="keyword">case</span> vdef @ ValDef<a href="#567852" title="Iterable[Reshape.this.mirror.Tree]" id="567854" class="delimiter">(</a>mods, name, tpt, rhs<span class="delimiter">)</span> =&gt;
          <span class="keyword">val</span> <a title="Reshape.this.mirror.Modifiers" id="567334">mods1</a> = <span title="Reshape.this.mirror.Modifiers" class="keyword">if</span> <span class="delimiter">(</span><a href="#566589" title="scala.collection.mutable.Map[Reshape.this.mirror.ValDef,List[Reshape.this.mirror.DefDef]]">accessors</a>.<a href="../../../collection/MapLike.scala.html#78421" title="(key: Reshape.this.mirror.ValDef)Boolean">contains</a><span class="delimiter">(</span>vdef<span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
            <span class="keyword">val</span> <a title="Reshape.this.mirror.DefDef" id="567340">ddef</a> = <a href="../../../collection/MapLike.scala.html#78420" title="(key: Reshape.this.mirror.ValDef)List[Reshape.this.mirror.DefDef]">accessors</a><a href="../../../collection/LinearSeqOptimized.scala.html#76165" title="(n: Int)Reshape.this.mirror.DefDef" class="delimiter">(</a>vdef<span class="delimiter">)</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span> // any accessor will do
            <span class="keyword">val</span> Modifiers<a href="#567396" title="(x: (Long, Reshape.this.mirror.Name, List[Reshape.this.mirror.Tree]))(Long, Reshape.this.mirror.Name, List[Reshape.this.mirror.Tree])" class="delimiter">(</a><a href="../../../Tuple3.scala.html#61402" title="Long" id="567342">flags</a>, <a href="../../../Tuple3.scala.html#61404" title="Reshape.this.mirror.Name" id="567343">privateWithin</a>, <a href="../../../Tuple3.scala.html#61406" title="List[Reshape.this.mirror.Tree]" id="567344">annotations</a><span class="delimiter">)</span> = <a href="../../internal/Trees.scala.html#441805" title="Reshape.this.mirror.Modifiers @unchecked">mods</a>
            <span class="keyword">var</span> <a title="Long" id="567345">flags1</a> = <a href="#567342" title="Long">flags</a> <a href="../../../Long.scala.html#58300" title="(x: Int)Long">&amp;</a> <a href="../../../Int.scala.html#57878" title="=&gt; Int">~</a><span title="Int(524288)">LOCAL</span>
            <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../../Boolean.scala.html#58721" title="=&gt; Boolean">!</a><a href="#567340" title="Reshape.this.mirror.DefDef">ddef</a>.<a href="../../api/Trees.scala.html#427232" title="=&gt; Reshape.this.mirror.Symbol">symbol</a>.<a href="../../internal/HasFlags.scala.html#443596" title="=&gt; Boolean">isPrivate</a><span class="delimiter">)</span> <a href="#567345" title="Long">flags1</a> = <a href="#567345" title="Long">flags1</a> <a href="../../../Long.scala.html#58300" title="(x: Int)Long">&amp;</a> <a href="../../../Int.scala.html#57878" title="=&gt; Int">~</a><span title="Int(4)">PRIVATE</span>
            <span class="keyword">val</span> <a title="Reshape.this.mirror.Name" id="567346">privateWithin1</a> = <a href="#567340" title="Reshape.this.mirror.DefDef">ddef</a>.<a href="../../api/Trees.scala.html#427496" title="=&gt; Reshape.this.mirror.Modifiers">mods</a>.<a href="../../internal/Trees.scala.html#471499" title="=&gt; Reshape.this.mirror.Name">privateWithin</a>
            <span class="keyword">val</span> <a title="List[Reshape.this.mirror.Tree]" id="567347">annotations1</a> = <a href="../../../collection/MapLike.scala.html#78420" title="(key: Reshape.this.mirror.ValDef)List[Reshape.this.mirror.DefDef]">accessors</a><span class="delimiter">(</span>vdef<span class="delimiter">)</span>.<a href="../../../collection/LinearSeqOptimized.scala.html#76173" title="(z: List[Reshape.this.mirror.Tree])(f: (List[Reshape.this.mirror.Tree], Reshape.this.mirror.DefDef) =&gt; List[Reshape.this.mirror.Tree])List[Reshape.this.mirror.Tree]">foldLeft</a><span class="delimiter">(</span><a href="#567344" title="List[Reshape.this.mirror.Tree]">annotations</a><span class="delimiter">)</span><span class="delimiter">(</span><span class="delimiter">(</span><a title="List[Reshape.this.mirror.Tree]" id="567442">curr</a>, <a title="Reshape.this.mirror.DefDef" id="567443">acc</a><span class="delimiter">)</span> =&gt; <a href="#567442" title="List[Reshape.this.mirror.Tree]">curr</a> <a href="../../../collection/immutable/List.scala.html#63655" title="(that: scala.collection.GenTraversableOnce[Reshape.this.mirror.Tree])(implicit bf: scala.collection.generic.CanBuildFrom[List[Reshape.this.mirror.Tree],Reshape.this.mirror.Tree,List[Reshape.this.mirror.Tree]])List[Reshape.this.mirror.Tree]">++</a> <span class="delimiter">(</span><a href="#567443" title="Reshape.this.mirror.DefDef">acc</a>.<a href="../../api/Trees.scala.html#427232" title="=&gt; Reshape.this.mirror.Symbol">symbol</a>.<a href="../../internal/Symbols.scala.html#443459" title="=&gt; List[Reshape.this.mirror.AnnotationInfo]">annotations</a> <a href="../../../collection/TraversableLike.scala.html#58971" title="(f: Reshape.this.mirror.AnnotationInfo =&gt; Reshape.this.mirror.Tree)(implicit bf: scala.collection.generic.CanBuildFrom[List[Reshape.this.mirror.AnnotationInfo],Reshape.this.mirror.Tree,List[Reshape.this.mirror.Tree]])List[Reshape.this.mirror.Tree]">map</a> <a href="#565122" title="(ann: Reshape.this.mirror.AnnotationInfo)Reshape.this.mirror.Tree">toPreTyperAnnotation</a><span class="delimiter">)</span><span class="delimiter">)</span>
            <a href="../../internal/Trees.scala.html#499941" title="(flags: Long, privateWithin: Reshape.this.mirror.Name, annotations: List[Reshape.this.mirror.Tree])Reshape.this.mirror.Modifiers">Modifiers</a><span class="delimiter">(</span><a href="#567345" title="Long">flags1</a>, <a href="#567346" title="Reshape.this.mirror.Name">privateWithin1</a>, <a href="#567347" title="List[Reshape.this.mirror.Tree]">annotations1</a><span class="delimiter">)</span> <a href="../../internal/Trees.scala.html#471507" title="(poss: scala.collection.immutable.Map[Long,scala.tools.nsc.util.Position])Reshape.this.mirror.Modifiers">setPositions</a> mods.<a href="../../internal/Trees.scala.html#471504" title="=&gt; Map[Long,Reshape.this.mirror.Position]">positions</a>
          <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
            mods
          <span class="delimiter">}</span>
          <span class="keyword">val</span> <a title="Reshape.this.mirror.Modifiers" id="567335">mods2</a> = <a href="#565118" title="(mods: Reshape.this.mirror.Modifiers, sym: Reshape.this.mirror.Symbol)Reshape.this.mirror.Modifiers">toPreTyperModifiers</a><span class="delimiter">(</span><a href="#567334" title="Reshape.this.mirror.Modifiers">mods1</a>, vdef.<a href="../../api/Trees.scala.html#427232" title="=&gt; Reshape.this.mirror.Symbol">symbol</a><span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="Reshape.this.mirror.Name" id="567336">name1</a> = <a href="../../internal/StdNames.scala.html#441764" title="Reshape.this.mirror.nme.type">nme</a>.<a href="../../internal/StdNames.scala.html#446246" title="(name: Reshape.this.mirror.Name)Reshape.this.mirror.Name">dropLocalSuffix</a><span class="delimiter">(</span>name<span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="Reshape.this.mirror.ValDef" id="567337">vdef1</a> = <a href="../../api/Trees.scala.html#428215" title="(mods: Reshape.this.mirror.Modifiers, name: Reshape.this.mirror.TermName, tpt: Reshape.this.mirror.Tree, rhs: Reshape.this.mirror.Tree)Reshape.this.mirror.ValDef">ValDef</a><span class="delimiter">(</span><a href="#567335" title="Reshape.this.mirror.Modifiers">mods2</a>, <a href="../../internal/Names.scala.html#440756" title="implicit scala.reflect.internal.Names.promoteTermNamesAsNecessary : (name: Reshape.this.mirror.Name)Reshape.this.mirror.TermName">name1</a>, tpt, rhs<span class="delimiter">)</span>
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../codegen/Util.scala.html#563438" title="=&gt; Boolean">reifyDebug</a><span class="delimiter">)</span> <a href="../../../Predef.scala.html#8489" title="(x: Any)Unit">println</a><span class="delimiter">(</span><a href="../../../Predef.scala.html#8578" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;resetting visibility of field: %s =&gt; %s&quot;</a>.<a href="../../../collection/immutable/StringLike.scala.html#60730" title="(args: Any*)String">format</a><span class="delimiter">(</span>vdef, <a href="#567337" title="Reshape.this.mirror.ValDef">vdef1</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <a href="../../../Option.scala.html#64111" title="(x: Reshape.this.mirror.ValDef)Some[Reshape.this.mirror.ValDef]">Some</a><a href="../../../Option.scala.html#88859" title="(xo: Option[Reshape.this.mirror.ValDef])Iterable[Reshape.this.mirror.ValDef]" class="delimiter">(</a><a href="#567337" title="Reshape.this.mirror.ValDef">vdef1</a><span class="delimiter">)</span> // no copyAttrs here, because new ValDef and old symbols are not out of sync
        <span class="keyword">case</span> ddef @ DefDef<a href="#567852" title="Iterable[Reshape.this.mirror.Tree]" id="567856" class="delimiter">(</a>mods, name, tparams, vparamss, tpt, rhs<span class="delimiter">)</span> =&gt;
          <a href="#567857" title="(x: Iterable[Reshape.this.mirror.Tree])Iterable[Reshape.this.mirror.Tree]" class="keyword">if</a> <span class="delimiter">(</span><a href="#566589" title="scala.collection.mutable.Map[Reshape.this.mirror.ValDef,List[Reshape.this.mirror.DefDef]]">accessors</a>.<a href="../../../collection/MapLike.scala.html#78427" title="=&gt; Iterable[List[Reshape.this.mirror.DefDef]]">values</a>.<a href="../../../collection/IterableLike.scala.html#59462" title="(p: List[Reshape.this.mirror.DefDef] =&gt; Boolean)Boolean">exists</a><span class="delimiter">(</span><a href="#567689" title="List[Reshape.this.mirror.DefDef]">_</a>.<a href="../../../collection/SeqLike.scala.html#59768" title="(elem: Any)Boolean">contains</a><span class="delimiter">(</span>ddef<span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
            <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../codegen/Util.scala.html#563438" title="=&gt; Boolean">reifyDebug</a><span class="delimiter">)</span> <a href="../../../Predef.scala.html#8489" title="(x: Any)Unit">println</a><span class="delimiter">(</span><span title="String(&quot;discarding accessor method: &quot;)" class="string">&quot;discarding accessor method: &quot;</span> <span title="(x$1: Any)String">+</span> ddef<span class="delimiter">)</span>
            <a href="../../../Option.scala.html#88859" title="(xo: Option[Nothing])Iterable[Nothing]">None</a>
          <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
            <a href="../../../Option.scala.html#64111" title="(x: Reshape.this.mirror.DefDef)Some[Reshape.this.mirror.DefDef]">Some</a><a href="../../../Option.scala.html#88859" title="(xo: Option[Reshape.this.mirror.DefDef])Iterable[Reshape.this.mirror.DefDef]" class="delimiter">(</a>ddef<span class="delimiter">)</span>
          <span class="delimiter">}</span>
        <span class="keyword">case</span> tree =&gt;
          <a href="../../../Option.scala.html#64111" title="(x: Reshape.this.mirror.Tree)Some[Reshape.this.mirror.Tree]">Some</a><a href="#567857" title="(x: Iterable[Reshape.this.mirror.Tree])Iterable[Reshape.this.mirror.Tree]" class="delimiter">(</a>tree<span class="delimiter">)</span>
      <span class="delimiter">}</span>

      <a href="#566590" title="List[Reshape.this.mirror.Tree]">stats1</a>
    <span class="delimiter">}</span>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(deff: Reshape.this.mirror.Tree, stats: List[Reshape.this.mirror.Tree])List[Reshape.this.mirror.Tree]" id="565124">trimSyntheticCaseClassMembers</a><span class="delimiter">(</span><a title="Reshape.this.mirror.Tree" id="565375">deff</a>: <a href="../../api/Trees.scala.html#23570" title="Reshape.this.mirror.Tree">Tree</a>, <a title="List[Reshape.this.mirror.Tree]" id="565376">stats</a>: <a href="../../../collection/immutable/List.scala.html#12322" title="List[Reshape.this.mirror.Tree]">List</a><span class="delimiter">[</span>Tree<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../../collection/immutable/List.scala.html#12322" title="List[Reshape.this.mirror.Tree]">List</a><span class="delimiter">[</span>Tree<span class="delimiter">]</span> =
      <a href="#565376" title="List[Reshape.this.mirror.Tree]">stats</a> <a href="../../../collection/TraversableLike.scala.html#58982" title="(p: Reshape.this.mirror.Tree =&gt; Boolean)List[Reshape.this.mirror.Tree]">filterNot</a> <span class="delimiter">(</span><a title="Reshape.this.mirror.Tree" id="567903">memberDef</a> =&gt; <a href="#567903" title="Reshape.this.mirror.Tree">memberDef</a>.<a href="../../api/Trees.scala.html#425068" title="=&gt; Boolean">isDef</a> <a href="../../../Boolean.scala.html#58725" title="(x: Boolean)Boolean">&amp;&amp;</a> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="Boolean" id="567904">isSynthetic</a> = <a href="#567903" title="Reshape.this.mirror.Tree">memberDef</a>.<a href="../../api/Trees.scala.html#425064" title="=&gt; Reshape.this.mirror.Symbol">symbol</a>.<a href="../../internal/HasFlags.scala.html#443598" title="=&gt; Boolean">isSynthetic</a>
        // this doesn't work for local classes, e.g. for ones that are top-level to a quasiquote (see comments to companionClass)
        // that's why I replace the check with an assumption that all synthetic members are, in fact, generated of case classes
        // val isCaseMember = deff.symbol.isCaseClass || deff.symbol.companionClass.isCaseClass
        <span class="keyword">val</span> <a title="Boolean" id="567905">isCaseMember</a> = <span title="Boolean(true)" class="keyword">true</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#567904" title="Boolean">isSynthetic</a> <a href="../../../Boolean.scala.html#58725" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#567905" title="Boolean">isCaseMember</a> <a href="../../../Boolean.scala.html#58725" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../codegen/Util.scala.html#563438" title="=&gt; Boolean">reifyDebug</a><span class="delimiter">)</span> <a href="../../../Predef.scala.html#8489" title="(x: Any)Unit">println</a><span class="delimiter">(</span><span title="String(&quot;discarding case class synthetic def: &quot;)" class="string">&quot;discarding case class synthetic def: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#567903" title="Reshape.this.mirror.Tree">memberDef</a><span class="delimiter">)</span>
        <a href="#567904" title="Boolean">isSynthetic</a> <a href="../../../Boolean.scala.html#58725" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#567905" title="Boolean">isCaseMember</a>
      <span class="delimiter">}</span><span class="delimiter">)</span>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(stats: List[Reshape.this.mirror.Tree])List[Reshape.this.mirror.Tree]" id="565125">trimSyntheticCaseClassCompanions</a><span class="delimiter">(</span><a title="List[Reshape.this.mirror.Tree]" id="565630">stats</a>: <a href="../../../collection/immutable/List.scala.html#12322" title="List[Reshape.this.mirror.Tree]">List</a><span class="delimiter">[</span>Tree<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../../collection/immutable/List.scala.html#12322" title="List[Reshape.this.mirror.Tree]">List</a><span class="delimiter">[</span>Tree<span class="delimiter">]</span> =
      <a href="#565630" title="List[Reshape.this.mirror.Tree]">stats</a> <a href="../../../collection/SeqLike.scala.html#59774" title="(that: scala.collection.GenSeq[Reshape.this.mirror.Tree])List[Reshape.this.mirror.Tree]">diff</a> <span class="delimiter">(</span><a href="#565630" title="List[Reshape.this.mirror.Tree]">stats</a> <a href="../../../collection/TraversableLike.scala.html#58983" title="(pf: PartialFunction[Reshape.this.mirror.Tree,Reshape.this.mirror.ModuleDef])(implicit bf: scala.collection.generic.CanBuildFrom[List[Reshape.this.mirror.Tree],Reshape.this.mirror.ModuleDef,List[Reshape.this.mirror.ModuleDef]])List[Reshape.this.mirror.ModuleDef]">collect</a> <a title="anonymous class $anonfun extends scala.runtime.AbstractPartialFunction[Reshape.this.mirror.Tree,Reshape.this.mirror.ModuleDef] with Serializable" id="567943" class="delimiter">{</a> <span class="keyword">case</span> <a href="#567934" title="B1" id="567949">moddef</a>: ModuleDef =&gt; <a href="#567939" title="(x: B1)B1">moddef</a> <span class="delimiter">}</span> <a href="../../../collection/TraversableLike.scala.html#58981" title="(p: Reshape.this.mirror.ModuleDef =&gt; Boolean)List[Reshape.this.mirror.ModuleDef]">filter</a> <span class="delimiter">(</span><a title="Reshape.this.mirror.ModuleDef" id="568035">moddef</a> =&gt; <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="Boolean" id="568036">isSynthetic</a> = <a href="#568035" title="Reshape.this.mirror.ModuleDef">moddef</a>.<a href="../../api/Trees.scala.html#427232" title="=&gt; Reshape.this.mirror.Symbol">symbol</a>.<a href="../../internal/HasFlags.scala.html#443598" title="=&gt; Boolean">isSynthetic</a>
        // this doesn't work for local classes, e.g. for ones that are top-level to a quasiquote (see comments to companionClass)
        // that's why I replace the check with an assumption that all synthetic modules are, in fact, companions of case classes
        // val isCaseCompanion = moddef.symbol.companionClass.isCaseClass
        <span class="keyword">val</span> <a title="Boolean" id="568037">isCaseCompanion</a> = <span title="Boolean(true)" class="keyword">true</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#568036" title="Boolean">isSynthetic</a> <a href="../../../Boolean.scala.html#58725" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#568037" title="Boolean">isCaseCompanion</a> <a href="../../../Boolean.scala.html#58725" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../codegen/Util.scala.html#563438" title="=&gt; Boolean">reifyDebug</a><span class="delimiter">)</span> <a href="../../../Predef.scala.html#8489" title="(x: Any)Unit">println</a><span class="delimiter">(</span><span title="String(&quot;discarding synthetic case class companion: &quot;)" class="string">&quot;discarding synthetic case class companion: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#568035" title="Reshape.this.mirror.ModuleDef">moddef</a><span class="delimiter">)</span>
        <a href="#568036" title="Boolean">isSynthetic</a> <a href="../../../Boolean.scala.html#58725" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#568037" title="Boolean">isCaseCompanion</a>
      <span class="delimiter">}</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>
<span title="Object" class="delimiter">}</span>
        </pre>
    </body>
</html>