<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>scala/tools/nsc/interpreter/ExprTyper.scala</title>
        <script type="text/javascript" src="../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
/* NSC -- new Scala compiler
 * Copyright 2005-2011 LAMP/EPFL
 * @author  Paul Phillips
 */

<span class="keyword">package</span> scala.tools.nsc
<span class="keyword">package</span> interpreter

<span class="keyword">import</span> util.BatchSourceFile
<span class="keyword">import</span> scala.tools.nsc.ast.parser.<a href="../ast/parser/Tokens.scala.html#29651" title="scala.tools.nsc.ast.parser.Tokens.type">Tokens</a>.EOF

<span class="keyword">trait</span> <a title="trait ExprTyper extends Object" id="37485">ExprTyper</a> <a href="../../../Unit.scala.html#2389" title="Unit" class="delimiter">{</a>
  <span class="keyword">val</span> <a title="=&gt; scala.tools.nsc.interpreter.IMain" id="904644">repl</a>: <a href="IMain.scala.html#39660" title="scala.tools.nsc.interpreter.IMain">IMain</a>

  <span class="keyword">import</span> <a href="#904644" title="=&gt; scala.tools.nsc.interpreter.IMain">repl</a>._
  <span class="keyword">import</span> <a href="IMain.scala.html#662494" title="ExprTyper.this.repl.replTokens.type">replTokens</a>.<span class="delimiter">{</span> Tokenizer <span class="delimiter">}</span>
  <span class="keyword">import</span> <a href="IMain.scala.html#662386" title="=&gt; scala.tools.nsc.Global">global</a>.<span class="delimiter">{</span> reporter =&gt; _, Import =&gt; _, _ <span class="delimiter">}</span>
  <span class="keyword">import</span> <a href="../../../reflect/internal/Definitions.scala.html#441641" title="ExprTyper.this.repl.global.definitions.type">definitions</a>._
  <span class="keyword">import</span> <a href="../Global.scala.html#559583" title="ExprTyper.this.repl.global.syntaxAnalyzer.type">syntaxAnalyzer</a>.<span class="delimiter">{</span> UnitParser, UnitScanner, token2name <span class="delimiter">}</span>
  <span class="keyword">import</span> <a href="IMain.scala.html#662395" title="ExprTyper.this.repl.naming.type">naming</a>.freshInternalVarName

  <span class="keyword">object</span> <a title="ExprTyper.this.codeParser.type" id="904651">codeParser</a> <a href="#904652" title="ExprTyper.this.codeParser.type" class="keyword">extends</a> <span class="delimiter">{</span> <span class="keyword">val</span> <a title="ExprTyper.this.repl.global.type" id="904852">global</a>: repl.global.<span class="keyword">type</span> = <a href="#904644" title="=&gt; scala.tools.nsc.interpreter.IMain">repl</a>.<a href="IMain.scala.html#662386" title="=&gt; scala.tools.nsc.Global">global</a> <span class="delimiter">}</span> <span class="keyword">with</span> <a href="CodeHandlers.scala.html#39540" title="scala.tools.nsc.interpreter.CodeHandlers[ExprTyper.this.repl.global.Tree]">CodeHandlers</a><span class="delimiter">[</span>Tree<span class="delimiter">]</span> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="[T](code: String, rule: ExprTyper.this.repl.global.syntaxAnalyzer.UnitParser =&gt; T)T" id="904839">applyRule</a><span class="delimiter">[</span><a title="" id="904841">T</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="String" id="904853">code</a>: <span title="String">String</span>, <a title="ExprTyper.this.repl.global.syntaxAnalyzer.UnitParser =&gt; T" id="904854">rule</a>: UnitParser =&gt; T<span class="delimiter">)</span>: <a href="#904841" title="T">T</a> = <span class="delimiter">{</span>
      <a href="IMain.scala.html#662375" title="=&gt; scala.tools.nsc.interpreter.ReplReporter">reporter</a>.<a href="../reporters/AbstractReporter.scala.html#467886" title="()Unit">reset</a><span class="delimiter">(</span><span class="delimiter">)</span>
      <span class="keyword">val</span> <a title="ExprTyper.this.repl.global.syntaxAnalyzer.UnitParser" id="904858">scanner</a> = <a href="../Global.scala.html#559764" title="(code: String)ExprTyper.this.repl.global.syntaxAnalyzer.UnitParser">newUnitParser</a><span class="delimiter">(</span><a href="#904853" title="String">code</a><span class="delimiter">)</span>
      <span class="keyword">val</span> <a title="T" id="904859">result</a>  = <a href="../../../Function1.scala.html#59555" title="(v1: ExprTyper.this.repl.global.syntaxAnalyzer.UnitParser)T">rule</a><span class="delimiter">(</span><a href="#904858" title="ExprTyper.this.repl.global.syntaxAnalyzer.UnitParser">scanner</a><span class="delimiter">)</span>

      <span title="AnyVal" class="keyword">if</span> <span class="delimiter">(</span><a href="../../../Boolean.scala.html#58721" title="=&gt; Boolean">!</a><a href="IMain.scala.html#662375" title="=&gt; scala.tools.nsc.interpreter.ReplReporter">reporter</a>.<a href="../reporters/Reporter.scala.html#467867" title="=&gt; Boolean">hasErrors</a><span class="delimiter">)</span>
        <a href="#904858" title="ExprTyper.this.repl.global.syntaxAnalyzer.UnitParser">scanner</a>.<a href="../ast/parser/Parsers.scala.html#655643" title="(token: Int)Int">accept</a><span class="delimiter">(</span><span title="Int(0)">EOF</span><span class="delimiter">)</span>

      <a href="#904859" title="T">result</a>
    <span class="delimiter">}</span>
    <span class="keyword">def</span> <a title="(code: String)Iterator[ExprTyper.this.repl.replTokens.ReplToken]" id="904842">tokens</a><span class="delimiter">(</span><a title="String" id="904874">code</a>: <span title="String">String</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
      <a href="IMain.scala.html#662375" title="=&gt; scala.tools.nsc.interpreter.ReplReporter">reporter</a>.<a href="../reporters/AbstractReporter.scala.html#467886" title="()Unit">reset</a><span class="delimiter">(</span><span class="delimiter">)</span>
      <span class="keyword">val</span> <a title="ExprTyper.this.repl.global.syntaxAnalyzer.UnitScanner" id="904877">in</a> = <a href="../Global.scala.html#559765" title="(code: String)ExprTyper.this.repl.global.syntaxAnalyzer.UnitScanner">newUnitScanner</a><span class="delimiter">(</span><a href="#904874" title="String">code</a><span class="delimiter">)</span>
      <a href="#904877" title="ExprTyper.this.repl.global.syntaxAnalyzer.UnitScanner">in</a>.<a href="../ast/parser/Scanners.scala.html#642220" title="()Unit">init</a><span class="delimiter">(</span><span class="delimiter">)</span>
      <span title="ExprTyper.this.repl.replTokens.Tokenizer" class="keyword">new</span> <a href="ReplTokens.scala.html#904825" title="ExprTyper.this.repl.replTokens.Tokenizer">Tokenizer</a><span class="delimiter">(</span><a href="#904877" title="ExprTyper.this.repl.global.syntaxAnalyzer.UnitScanner">in</a><span class="delimiter">)</span> <a href="ReplTokens.scala.html#904882" title="=&gt; Iterator[ExprTyper.this.repl.replTokens.ReplToken]">tokenIterator</a>
    <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="(code: String)List[ExprTyper.this.repl.global.DefTree]" id="904843">defns</a><span class="delimiter">(</span><a title="String" id="904885">code</a>: <span title="String">String</span><span class="delimiter">)</span> = <a href="#904847" title="(code: String)List[ExprTyper.this.repl.global.syntaxAnalyzer.global.Tree]">stmts</a><span class="delimiter">(</span><a href="#904885" title="String">code</a><span class="delimiter">)</span> <a href="../../../collection/TraversableLike.scala.html#58983" title="(pf: PartialFunction[ExprTyper.this.repl.global.syntaxAnalyzer.global.Tree,ExprTyper.this.repl.global.DefTree])(implicit bf: scala.collection.generic.CanBuildFrom[List[ExprTyper.this.repl.global.syntaxAnalyzer.global.Tree],ExprTyper.this.repl.global.DefTree,List[ExprTyper.this.repl.global.DefTree]])List[ExprTyper.this.repl.global.DefTree]">collect</a> <a title="anonymous class $anonfun extends scala.runtime.AbstractPartialFunction[ExprTyper.this.repl.global.syntaxAnalyzer.global.Tree,ExprTyper.this.repl.global.DefTree] with Serializable" id="904933" class="delimiter">{</a> <span class="keyword">case</span> <a href="#904924" title="B1" id="904939">x</a>: DefTree =&gt; <a href="#904929" title="(x: B1)B1">x</a> <span class="delimiter">}</span>
    <span class="keyword">def</span> <a title="(code: String)ExprTyper.this.repl.global.syntaxAnalyzer.global.Tree" id="904844">expr</a><span class="delimiter">(</span><a title="String" id="905023">code</a>: <span title="String">String</span><span class="delimiter">)</span>  = <a href="#904839" title="(code: String, rule: ExprTyper.this.repl.global.syntaxAnalyzer.UnitParser =&gt; ExprTyper.this.repl.global.syntaxAnalyzer.global.Tree)ExprTyper.this.repl.global.syntaxAnalyzer.global.Tree">applyRule</a><span class="delimiter">(</span><a href="#905023" title="String">code</a>, <a href="#905030" title="ExprTyper.this.repl.global.syntaxAnalyzer.UnitParser">_</a>.<a href="../ast/parser/Parsers.scala.html#655734" title="()ExprTyper.this.repl.global.syntaxAnalyzer.global.Tree">expr</a><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="keyword">def</span> <a title="(code: String)ExprTyper.this.repl.global.syntaxAnalyzer.global.Tree" id="904845">impt</a><span class="delimiter">(</span><a title="String" id="905035">code</a>: <span title="String">String</span><span class="delimiter">)</span>  = <a href="#904839" title="(code: String, rule: ExprTyper.this.repl.global.syntaxAnalyzer.UnitParser =&gt; ExprTyper.this.repl.global.syntaxAnalyzer.global.Tree)ExprTyper.this.repl.global.syntaxAnalyzer.global.Tree">applyRule</a><span class="delimiter">(</span><a href="#905035" title="String">code</a>, <a href="#905042" title="ExprTyper.this.repl.global.syntaxAnalyzer.UnitParser">_</a>.<a href="../ast/parser/Parsers.scala.html#655792" title="()ExprTyper.this.repl.global.syntaxAnalyzer.global.Tree">importExpr</a><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="keyword">def</span> <a title="(code: String)List[ExprTyper.this.repl.global.syntaxAnalyzer.global.Tree]" id="904846">impts</a><span class="delimiter">(</span><a title="String" id="905045">code</a>: <span title="String">String</span><span class="delimiter">)</span> = <a href="#904839" title="(code: String, rule: ExprTyper.this.repl.global.syntaxAnalyzer.UnitParser =&gt; List[ExprTyper.this.repl.global.syntaxAnalyzer.global.Tree])List[ExprTyper.this.repl.global.syntaxAnalyzer.global.Tree]">applyRule</a><span class="delimiter">(</span><a href="#905045" title="String">code</a>, <a href="#905052" title="ExprTyper.this.repl.global.syntaxAnalyzer.UnitParser">_</a>.<a href="../ast/parser/Parsers.scala.html#655791" title="()List[ExprTyper.this.repl.global.syntaxAnalyzer.global.Tree]">importClause</a><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="keyword">def</span> <a title="(code: String)List[ExprTyper.this.repl.global.syntaxAnalyzer.global.Tree]" id="904847">stmts</a><span class="delimiter">(</span><a title="String" id="904888">code</a>: <span title="String">String</span><span class="delimiter">)</span> = <a href="#904839" title="(code: String, rule: ExprTyper.this.repl.global.syntaxAnalyzer.UnitParser =&gt; List[ExprTyper.this.repl.global.syntaxAnalyzer.global.Tree])List[ExprTyper.this.repl.global.syntaxAnalyzer.global.Tree]">applyRule</a><span class="delimiter">(</span><a href="#904888" title="String">code</a>, <a href="#904895" title="ExprTyper.this.repl.global.syntaxAnalyzer.UnitParser">_</a>.<a href="../ast/parser/Parsers.scala.html#655821" title="()List[ExprTyper.this.repl.global.syntaxAnalyzer.global.Tree]">templateStats</a><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="keyword">def</span> <a title="(code: String)ExprTyper.this.repl.global.syntaxAnalyzer.global.Tree" id="904848">stmt</a><span class="delimiter">(</span><a title="String" id="905055">code</a>: <span title="String">String</span><span class="delimiter">)</span>  = <a href="#904847" title="(code: String)List[ExprTyper.this.repl.global.syntaxAnalyzer.global.Tree]">stmts</a><span class="delimiter">(</span><a href="#905055" title="String">code</a><span class="delimiter">)</span>.<a href="../../../collection/LinearSeqOptimized.scala.html#76185" title="=&gt; ExprTyper.this.repl.global.syntaxAnalyzer.global.Tree">last</a>  // guaranteed nonempty
  <span class="delimiter">}</span>

  /** Parse a line into a sequence of trees. Returns None if the input is incomplete. */
  <span class="keyword">def</span> <a title="(line: String)Option[List[ExprTyper.this.repl.global.Tree]]" id="904653">parse</a><span class="delimiter">(</span><a title="String" id="905059">line</a>: <span title="String">String</span><span class="delimiter">)</span>: <a href="../../../Option.scala.html#1510" title="Option[List[ExprTyper.this.repl.global.Tree]]">Option</a><span class="delimiter">[</span>List<span class="delimiter">[</span>Tree<span class="delimiter">]</span><span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">var</span> <a title="Boolean" id="905060">isIncomplete</a> = <span title="Boolean(false)" class="keyword">false</span>
    <a href="IMain.scala.html#662375" title="=&gt; scala.tools.nsc.interpreter.ReplReporter">reporter</a>.<a href="../reporters/Reporter.scala.html#467861" title="(handler: (scala.tools.nsc.util.Position, String) =&gt; Unit)(thunk: =&gt; Option[List[ExprTyper.this.repl.global.Tree]])Option[List[ExprTyper.this.repl.global.Tree]]">withIncompleteHandler</a><span class="delimiter">(</span><span class="delimiter">(</span><a title="scala.tools.nsc.util.Position" id="905071">_</a>, <a title="String" id="905072">_</a><span class="delimiter">)</span> =&gt; <a href="#905060" title="Boolean">isIncomplete</a> = <span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="List[ExprTyper.this.repl.global.syntaxAnalyzer.global.Tree]" id="905074">trees</a> = <a href="#904651" title="ExprTyper.this.codeParser.type">codeParser</a>.<a href="#904847" title="(code: String)List[ExprTyper.this.repl.global.syntaxAnalyzer.global.Tree]">stmts</a><span class="delimiter">(</span><a href="#905059" title="String">line</a><span class="delimiter">)</span>
      <span title="Option[List[ExprTyper.this.repl.global.Tree]]" class="keyword">if</span> <span class="delimiter">(</span><a href="IMain.scala.html#662375" title="=&gt; scala.tools.nsc.interpreter.ReplReporter">reporter</a>.<a href="../reporters/Reporter.scala.html#467867" title="=&gt; Boolean">hasErrors</a><span class="delimiter">)</span> <a href="../../../Option.scala.html#64111" title="(x: scala.collection.immutable.Nil.type)Some[scala.collection.immutable.Nil.type]">Some</a><span class="delimiter">(</span><a href="../../../collection/immutable/List.scala.html#11552" title="scala.collection.immutable.Nil.type">Nil</a><span class="delimiter">)</span>
      <span class="keyword">else</span> <span title="Option[List[ExprTyper.this.repl.global.Tree]]" class="keyword">if</span> <span class="delimiter">(</span><a href="#905060" title="Boolean">isIncomplete</a><span class="delimiter">)</span> <a href="../../../Option.scala.html#2498" title="None.type">None</a>
      <span class="keyword">else</span> <a href="../../../Option.scala.html#64111" title="(x: List[ExprTyper.this.repl.global.syntaxAnalyzer.global.Tree])Some[List[ExprTyper.this.repl.global.syntaxAnalyzer.global.Tree]]">Some</a><span class="delimiter">(</span><a href="#905074" title="List[ExprTyper.this.repl.global.syntaxAnalyzer.global.Tree]">trees</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
  // def parsesAsExpr(line: String) = {
  //   import codeParser._
  //   (opt expr line).isDefined
  // }

  <span class="keyword">def</span> <a title="(code: String)ExprTyper.this.repl.global.Symbol" id="904654">symbolOfLine</a><span class="delimiter">(</span><a title="String" id="905088">code</a>: <span title="String">String</span><span class="delimiter">)</span>: <a href="../../../reflect/internal/Symbols.scala.html#441132" title="ExprTyper.this.repl.global.Symbol">Symbol</a> = <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="()ExprTyper.this.repl.global.Symbol" id="905089">asExpr</a><span class="delimiter">(</span><span class="delimiter">)</span>: <a href="../../../reflect/internal/Symbols.scala.html#441132" title="ExprTyper.this.repl.global.Symbol">Symbol</a> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="String" id="905091">name</a>  = <a href="Naming.scala.html#904684" title="()String">freshInternalVarName</a><span class="delimiter">(</span><span class="delimiter">)</span>
      // Typing it with a lazy val would give us the right type, but runs
      // into compiler bugs with things like existentials, so we compile it
      // behind a def and strip the NullaryMethodType which wraps the expr.
      <span class="keyword">val</span> <a title="String" id="905092">line</a> = <span title="String(&quot;def &quot;)" class="string">&quot;def &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#905091" title="String">name</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; = {\n&quot;)" class="string">&quot; = {\n&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#905088" title="String">code</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;\n}&quot;)" class="string">&quot;\n}&quot;</span>

      <a href="IMain.scala.html#662455" title="(line: String)scala.tools.nsc.interpreter.IR.Result">interpretSynthetic</a><span title="ExprTyper.this.repl.global.Symbol" class="delimiter">(</span><a href="#905092" title="String">line</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <a href="package.scala.html#57226" title="=&gt; scala.tools.nsc.interpreter.Results.type">IR</a>.<a href="Results.scala.html#905126" title="ExprTyper.this.repl.global.Symbol" id="905179">Success</a> =&gt;
          <span class="keyword">val</span> <a title="ExprTyper.this.repl.global.Symbol" id="905135">sym0</a> = <a href="IMain.scala.html#662490" title="(id: String)ExprTyper.this.repl.global.Symbol">symbolOfTerm</a><span class="delimiter">(</span><a href="#905091" title="String">name</a><span class="delimiter">)</span>
          // drop NullaryMethodType
          <span class="keyword">val</span> <a title="sym0.TypeOfClonedSymbol" id="905136">sym</a> = <a href="#905135" title="ExprTyper.this.repl.global.Symbol">sym0</a>.<a href="../../../reflect/internal/Symbols.scala.html#443475" title="=&gt; sym0.TypeOfClonedSymbol">cloneSymbol</a> <a href="../../../reflect/internal/Symbols.scala.html#443429" title="(info: ExprTyper.this.repl.global.Type)sym0.TypeOfClonedSymbol">setInfo</a> <a href="../Global.scala.html#559724" title="(op: =&gt; ExprTyper.this.repl.global.Type)ExprTyper.this.repl.global.Type">afterTyper</a><span class="delimiter">(</span><a href="#905135" title="ExprTyper.this.repl.global.Symbol">sym0</a>.<a href="../../../reflect/internal/Symbols.scala.html#443427" title="=&gt; ExprTyper.this.repl.global.Type">info</a>.<a href="../../../reflect/internal/Types.scala.html#442006" title="=&gt; ExprTyper.this.repl.global.Type">finalResultType</a><span class="delimiter">)</span>
          <span title="ExprTyper.this.repl.global.Symbol" class="keyword">if</span> <span class="delimiter">(</span><a href="#905136" title="sym0.TypeOfClonedSymbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#443427" title="=&gt; ExprTyper.this.repl.global.Type">info</a>.<a href="../../../reflect/internal/Types.scala.html#441986" title="=&gt; ExprTyper.this.repl.global.Symbol">typeSymbol</a> <span title="(x$1: AnyRef)Boolean">eq</span> <a href="../../../reflect/internal/Definitions.scala.html#442841" title="=&gt; ExprTyper.this.repl.global.ClassSymbol">UnitClass</a><span class="delimiter">)</span> <a href="../../../reflect/internal/Symbols.scala.html#441152" title="=&gt; ExprTyper.this.repl.global.NoSymbol">NoSymbol</a>
          <span class="keyword">else</span> <a href="#905136" title="sym0.TypeOfClonedSymbol">sym</a>
        <span class="keyword">case</span> _          =&gt; <a href="#905180" title="(x: ExprTyper.this.repl.global.Symbol)ExprTyper.this.repl.global.Symbol">NoSymbol</a>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
    <span class="keyword">def</span> <a title="()ExprTyper.this.repl.global.Symbol" id="905090">asDefn</a><span class="delimiter">(</span><span class="delimiter">)</span>: <a href="../../../reflect/internal/Symbols.scala.html#441132" title="ExprTyper.this.repl.global.Symbol">Symbol</a> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="scala.collection.immutable.Set[ExprTyper.this.repl.memberHandlers.intp.global.Symbol]" id="905188">old</a> = <a href="#904644" title="=&gt; scala.tools.nsc.interpreter.IMain">repl</a>.<a href="IMain.scala.html#662507" title="=&gt; List[ExprTyper.this.repl.memberHandlers.intp.global.Symbol]">definedSymbolList</a>.<a href="../../../collection/TraversableOnce.scala.html#59181" title="scala.collection.immutable.Set[ExprTyper.this.repl.memberHandlers.intp.global.Symbol]">toSet</a>

      <a href="IMain.scala.html#662455" title="(line: String)scala.tools.nsc.interpreter.IR.Result">interpretSynthetic</a><span title="ExprTyper.this.repl.global.Symbol" class="delimiter">(</span><a href="#905088" title="String">code</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <a href="package.scala.html#57226" title="=&gt; scala.tools.nsc.interpreter.Results.type">IR</a>.<a href="Results.scala.html#905126" title="ExprTyper.this.repl.global.Symbol" id="905844">Success</a> =&gt;
          <a href="#904644" title="=&gt; scala.tools.nsc.interpreter.IMain">repl</a>.<a href="IMain.scala.html#662507" title="=&gt; List[ExprTyper.this.repl.memberHandlers.intp.global.Symbol]">definedSymbolList</a> <a href="#905845" title="(x: ExprTyper.this.repl.global.Symbol)ExprTyper.this.repl.global.Symbol">filterNot</a> <a href="#905188" title="scala.collection.immutable.Set[ExprTyper.this.repl.memberHandlers.intp.global.Symbol]">old</a> <span class="keyword">match</span> <span class="delimiter">{</span>
            <span class="keyword">case</span> <a href="../../../collection/immutable/List.scala.html#11552" title="ExprTyper.this.repl.global.Symbol" id="905827">Nil</a>        =&gt; <a href="#905829" title="(x: ExprTyper.this.repl.global.Symbol)ExprTyper.this.repl.global.Symbol">NoSymbol</a>
            <span class="keyword">case</span> sym <a href="#905822" title="ExprTyper.this.repl.global.Symbol" id="905825">::</a> <a href="../../../collection/immutable/List.scala.html#11552" title="ExprTyper.this.repl.global.Symbol" id="905828">Nil</a> =&gt; <a href="#905829" title="(x: ExprTyper.this.repl.global.Symbol)ExprTyper.this.repl.global.Symbol">sym</a>
            <span class="keyword">case</span> syms       =&gt; <a href="../../../reflect/internal/Symbols.scala.html#441152" title="=&gt; ExprTyper.this.repl.global.NoSymbol">NoSymbol</a>.<a href="../../../reflect/internal/Symbols.scala.html#443190" title="(pre: ExprTyper.this.repl.global.Type, alternatives: List[ExprTyper.this.repl.global.Symbol])ExprTyper.this.repl.global.TermSymbol">newOverloaded</a><a href="#905829" title="(x: ExprTyper.this.repl.global.Symbol)ExprTyper.this.repl.global.Symbol" class="delimiter">(</a><a href="../../../reflect/internal/Types.scala.html#441258" title="ExprTyper.this.repl.global.NoPrefix.type">NoPrefix</a>, syms<span class="delimiter">)</span>
          <span class="delimiter">}</span>
        <span class="keyword">case</span> _ =&gt; <a href="#905845" title="(x: ExprTyper.this.repl.global.Symbol)ExprTyper.this.repl.global.Symbol">NoSymbol</a>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
    <a href="IMain.scala.html#662403" title="(body: =&gt; ExprTyper.this.repl.global.Symbol)ExprTyper.this.repl.global.Symbol">beQuietDuring</a><span class="delimiter">(</span><a href="#905089" title="()ExprTyper.this.repl.global.Symbol">asExpr</a><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../../reflect/internal/Symbols.scala.html#443540" title="(alt: =&gt; ExprTyper.this.repl.global.Symbol)ExprTyper.this.repl.global.Symbol">orElse</a> <a href="IMain.scala.html#662403" title="(body: =&gt; ExprTyper.this.repl.global.Symbol)ExprTyper.this.repl.global.Symbol">beQuietDuring</a><span class="delimiter">(</span><a href="#905090" title="()ExprTyper.this.repl.global.Symbol">asDefn</a><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">var</span> <a title="Int" id="904656">typeOfExpressionDepth</a> = <span title="Int(0)" class="int">0</span>
  <span class="keyword">def</span> <a title="(expr: String, silent: Boolean)ExprTyper.this.repl.global.Type" id="904658">typeOfExpression</a><span class="delimiter">(</span><a title="String" id="905867">expr</a>: <span title="String">String</span>, <a title="Boolean" id="905869">silent</a>: <a href="../../../Boolean.scala.html#2218" title="Boolean">Boolean</a> = <span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span>: <a href="../../../reflect/internal/Types.scala.html#441242" title="ExprTyper.this.repl.global.Type">Type</a> = <span class="delimiter">{</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#904656" title="=&gt; Int">typeOfExpressionDepth</a> <a href="../../../Int.scala.html#57919" title="(x: Int)Boolean">&gt;</a> <span title="Int(2)" class="int">2</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="ReplConfig.scala.html#57199" title="(msg: =&gt; String)Unit">repldbg</a><span class="delimiter">(</span><span title="String(&quot;Terminating typeOfExpression recursion for expression: &quot;)" class="string">&quot;Terminating typeOfExpression recursion for expression: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#905867" title="String">expr</a><span class="delimiter">)</span>
      <span title="Nothing" class="keyword">return</span> <a href="../../../reflect/internal/Types.scala.html#441256" title="ExprTyper.this.repl.global.NoType.type">NoType</a>
    <span class="delimiter">}</span>
    <a href="#904656" title="(x$1: Int)Unit">typeOfExpressionDepth</a> <a href="../../../Int.scala.html#57948" title="(x: Int)Int">+=</a> <span title="Int(1)" class="int">1</span>
    // Don't presently have a good way to suppress undesirable success output
    // while letting errors through, so it is first trying it silently: if there
    // is an error, and errors are desired, then it re-evaluates non-silently
    // to induce the error message.
    <span class="keyword">try</span> <a href="IMain.scala.html#662406" title="(operation: =&gt; ExprTyper.this.repl.global.Type)ExprTyper.this.repl.global.Type">beSilentDuring</a><span title="ExprTyper.this.repl.global.Type" class="delimiter">(</span><a href="#904654" title="(code: String)ExprTyper.this.repl.global.Symbol">symbolOfLine</a><span class="delimiter">(</span><a href="#905867" title="String">expr</a><span class="delimiter">)</span>.<a href="../../../reflect/internal/Symbols.scala.html#443425" title="=&gt; ExprTyper.this.repl.global.Type">tpe</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <a href="../../../reflect/internal/Types.scala.html#441256" title="ExprTyper.this.repl.global.Type" id="905906">NoType</a> <span class="keyword">if</span> <a href="../../../Boolean.scala.html#58721" title="=&gt; Boolean">!</a><a href="#905869" title="Boolean">silent</a> =&gt; <a href="#904654" title="(code: String)ExprTyper.this.repl.global.Symbol">symbolOfLine</a><span class="delimiter">(</span><a href="#905867" title="String">expr</a><span class="delimiter">)</span>.<a href="#905907" title="(x: ExprTyper.this.repl.global.Type)ExprTyper.this.repl.global.Type">tpe</a> // generate error
      <span class="keyword">case</span> tpe               =&gt; <a href="#905907" title="(x: ExprTyper.this.repl.global.Type)ExprTyper.this.repl.global.Type">tpe</a>
    <span class="delimiter">}</span>
    <span class="keyword">finally</span> <a href="#904656" title="(x$1: Int)Unit">typeOfExpressionDepth</a> <a href="../../../Int.scala.html#57955" title="(x: Int)Int">-=</a> <span title="Int(1)" class="int">1</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(line: String)Iterator[ExprTyper.this.repl.replTokens.ReplToken]" id="904659">tokens</a><span class="delimiter">(</span><a title="String" id="905922">line</a>: <span title="String">String</span><span class="delimiter">)</span> = <a href="IMain.scala.html#662403" title="(body: =&gt; Iterator[ExprTyper.this.repl.replTokens.ReplToken])Iterator[ExprTyper.this.repl.replTokens.ReplToken]">beQuietDuring</a><span class="delimiter">(</span><a href="#904651" title="ExprTyper.this.codeParser.type">codeParser</a>.<a href="#904842" title="(code: String)Iterator[ExprTyper.this.repl.replTokens.ReplToken]">tokens</a><span class="delimiter">(</span><a href="#905922" title="String">line</a><span class="delimiter">)</span><span class="delimiter">)</span>

  // In the todo column
  //
  // def compileAndTypeExpr(expr: String): Option[Typer] = {
  //   class TyperRun extends Run {
  //     override def stopPhase(name: String) = name == &quot;superaccessors&quot;
  //   }
<span class="delimiter">}</span>

        </pre>
    </body>
</html>