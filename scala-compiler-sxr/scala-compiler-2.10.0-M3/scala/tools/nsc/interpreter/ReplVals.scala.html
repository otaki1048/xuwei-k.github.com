<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>scala/tools/nsc/interpreter/ReplVals.scala</title>
        <script type="text/javascript" src="../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
/* NSC -- new Scala compiler
 * Copyright 2005-2011 LAMP/EPFL
 * @author Paul Phillips
 */

<span class="keyword">package</span> scala.tools.nsc
<span class="keyword">package</span> interpreter

<span class="keyword">import</span> scala.reflect.<span class="delimiter">{</span>mirror =&gt; rm<span class="delimiter">}</span>
<span class="keyword">import</span> <a href="../../../language.scala.html#2216" title="language.type">language</a>.implicitConversions

/** A class which the repl utilizes to expose predefined objects.
 *  The base implementation is empty; the standard repl implementation
 *  is StdReplVals.
 */
<span class="keyword">abstract</span> <span class="keyword">class</span> <a title="class ReplVals extends Object" id="38088">ReplVals</a> <a href="#38088" title="scala.tools.nsc.interpreter.ReplVals" class="delimiter">{</a> <span class="delimiter">}</span>

<span title="Object" class="keyword">class</span> <a title="class StdReplVals extends scala.tools.nsc.interpreter.ReplVals" id="39927">StdReplVals</a><a href="#39927" title="scala.tools.nsc.interpreter.StdReplVals" class="delimiter">(</a><span class="keyword">final</span> <span class="keyword">val</span> <a title="scala.tools.nsc.interpreter.ILoop" id="907359">r</a>: <a href="ILoop.scala.html#37422" title="scala.tools.nsc.interpreter.ILoop">ILoop</a><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#38088" title="scala.tools.nsc.interpreter.ReplVals">ReplVals</a> <span class="delimiter">{</span>
  <span class="keyword">final</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="scala.tools.nsc.interpreter.ILoop" id="907327">repl</a>                     = <a href="#907359" title="=&gt; scala.tools.nsc.interpreter.ILoop">r</a>
  <span class="keyword">final</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="scala.tools.nsc.interpreter.IMain" id="907329">intp</a>                     = <a href="#907359" title="=&gt; scala.tools.nsc.interpreter.ILoop">r</a>.<a href="ILoop.scala.html#662711" title="=&gt; scala.tools.nsc.interpreter.IMain">intp</a>
  <span class="keyword">final</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="scala.tools.nsc.interpreter.Power[scala.tools.nsc.interpreter.StdReplVals]" id="907331">power</a>                    = <a href="#907359" title="=&gt; scala.tools.nsc.interpreter.ILoop">r</a>.<a href="ILoop.scala.html#662723" title="=&gt; scala.tools.nsc.interpreter.Power[scala.tools.nsc.interpreter.StdReplVals]">power</a>
  <span class="keyword">final</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="scala.tools.nsc.interpreter.InteractiveReader" id="907333">reader</a>                   = <a href="#907359" title="=&gt; scala.tools.nsc.interpreter.ILoop">r</a>.<a href="ILoop.scala.html#662705" title="=&gt; scala.tools.nsc.interpreter.InteractiveReader">in</a>
  <span class="keyword">final</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="scala.tools.nsc.interpreter.StdReplVals" id="907335">vals</a>                     = <a href="#39927" title="scala.tools.nsc.interpreter.StdReplVals" class="keyword">this</a>
  <span class="keyword">final</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="StdReplVals.this.intp.global.type" id="907337">global</a>: intp.global.<span class="keyword">type</span> = <a href="#907328" title="=&gt; scala.tools.nsc.interpreter.IMain">intp</a>.<a href="IMain.scala.html#662386" title="=&gt; scala.tools.nsc.Global">global</a>
  <span class="keyword">final</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="scala.tools.nsc.interpreter.ISettings" id="907339">isettings</a>                = <a href="#907328" title="=&gt; scala.tools.nsc.interpreter.IMain">intp</a>.<a href="IMain.scala.html#662419" title="=&gt; scala.tools.nsc.interpreter.ISettings">isettings</a>
  <span class="keyword">final</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="scala.tools.nsc.interpreter.Completion" id="907341">completion</a>               = <a href="#907332" title="=&gt; scala.tools.nsc.interpreter.InteractiveReader">reader</a>.<a href="InteractiveReader.scala.html#907086" title="=&gt; scala.tools.nsc.interpreter.Completion">completion</a>
  <span class="keyword">final</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="scala.tools.nsc.interpreter.session.History" id="907343">history</a>                  = <a href="#907332" title="=&gt; scala.tools.nsc.interpreter.InteractiveReader">reader</a>.<a href="InteractiveReader.scala.html#907085" title="=&gt; scala.tools.nsc.interpreter.session.History">history</a>
  <span class="keyword">final</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="scala.tools.nsc.interpreter.Phased" id="907345">phased</a>                   = <a href="#907330" title="=&gt; scala.tools.nsc.interpreter.Power[scala.tools.nsc.interpreter.StdReplVals]">power</a>.<a href="Power.scala.html#907305" title="=&gt; scala.tools.nsc.interpreter.Phased">phased</a>
  <span class="keyword">final</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="analyzer extends Object with scala.tools.nsc.typechecker.Analyzer" id="907347">analyzer</a>                 = <a href="#907336" title="=&gt; StdReplVals.this.intp.global.type">global</a>.<a href="../Global.scala.html#559585" title="=&gt; scala.tools.nsc.typechecker.Analyzer{val global: StdReplVals.this.global.type}">analyzer</a>

  <span class="keyword">object</span> <a title="StdReplVals.this.treedsl.type" id="907348">treedsl</a> <a href="#907349" title="StdReplVals.this.treedsl.type" class="keyword">extends</a> <span class="delimiter">{</span> <span class="keyword">val</span> <a title="StdReplVals.this.intp.global.type" id="958763">global</a>: intp.global.<span class="keyword">type</span> = <a href="#907328" title="=&gt; scala.tools.nsc.interpreter.IMain">intp</a>.<a href="IMain.scala.html#662386" title="=&gt; scala.tools.nsc.Global">global</a> <span class="delimiter">}</span> <span class="keyword">with</span> ast.<a href="../ast/TreeDSL.scala.html#29480" title="scala.tools.nsc.ast.TreeDSL">TreeDSL</a> <span class="delimiter">{</span> <span class="delimiter">}</span>

  <span class="keyword">final</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="StdReplVals.this.analyzer.Typer" id="907351">typer</a> = <a href="#907346" title="=&gt; scala.tools.nsc.typechecker.Analyzer{val global: StdReplVals.this.global.type}">analyzer</a>.<a href="../typechecker/Typers.scala.html#560201" title="(context: StdReplVals.this.analyzer.Context)StdReplVals.this.analyzer.Typer">newTyper</a><span class="delimiter">(</span>
    <a href="#907346" title="=&gt; scala.tools.nsc.typechecker.Analyzer{val global: StdReplVals.this.global.type}">analyzer</a>.<a href="../typechecker/Contexts.scala.html#560080" title="(unit: StdReplVals.this.analyzer.global.CompilationUnit)StdReplVals.this.analyzer.Context">rootContext</a><span class="delimiter">(</span>
      <a href="#907330" title="=&gt; scala.tools.nsc.interpreter.Power[scala.tools.nsc.interpreter.StdReplVals]">power</a>.<a href="Power.scala.html#907309" title="(code: String)StdReplVals.this.power.intp.global.CompilationUnit">unit</a><span class="delimiter">(</span><span title="String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="StdReplVals.this.analyzer.global.CompilationUnit" class="delimiter">[</span>analyzer.global.<a href="../CompilationUnits.scala.html#559797" title="StdReplVals.this.analyzer.global.CompilationUnit">CompilationUnit</a><span class="delimiter">]</span>
    <span class="delimiter">)</span>
  <span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="=&gt; StdReplVals.this.intp.Request" id="907352">lastRequest</a> = <a href="#907328" title="=&gt; scala.tools.nsc.interpreter.IMain">intp</a>.<a href="IMain.scala.html#662538" title="=&gt; StdReplVals.this.intp.Request">lastRequest</a>

  <span class="keyword">class</span> <a title="class ReplImplicits extends Object with StdReplVals.this.power.Implicits2" id="907353">ReplImplicits</a> <a href="#907353" title="StdReplVals.this.ReplImplicits" class="keyword">extends</a> power.<a href="Power.scala.html#907301" title="StdReplVals.this.power.Implicits2">Implicits2</a> <span class="delimiter">{</span>
    <span class="keyword">import</span> <a href="#907328" title="=&gt; scala.tools.nsc.interpreter.IMain">intp</a>.<a href="IMain.scala.html#662386" title="=&gt; scala.tools.nsc.Global">global</a>._

    <span class="keyword">private</span> <span class="keyword">val</span> <a title="StdReplVals.this.global.Symbol =&gt; Object{def apply[M](implicit m1: reflect.mirror.TypeTag[M]): StdReplVals.this.global.Type; def apply[M1, M2](implicit m1: reflect.mirror.TypeTag[M1],implicit m2: reflect.mirror.TypeTag[M2]): StdReplVals.this.global.Type}" id="958775">tagFn</a> = <a href="#38089" title="scala.tools.nsc.interpreter.ReplVals.type">ReplVals</a>.<a href="#958780" title="[T &lt;: scala.tools.nsc.Global](global: T)global.Symbol =&gt; Object{def apply[M](implicit m1: reflect.mirror.TypeTag[M]): global.Type; def apply[M1, M2](implicit m1: reflect.mirror.TypeTag[M1],implicit m2: reflect.mirror.TypeTag[M2]): global.Type}">mkCompilerTypeFromTag</a><span title="(global: StdReplVals.this.intp.global.type)global.Symbol =&gt; Object{def apply[M](implicit m1: reflect.mirror.TypeTag[M]): global.Type; def apply[M1, M2](implicit m1: reflect.mirror.TypeTag[M1],implicit m2: reflect.mirror.TypeTag[M2]): global.Type}" class="delimiter">[</span>intp.global.<span class="keyword">type</span><span class="delimiter">]</span><span class="delimiter">(</span><a href="#907336" title="=&gt; StdReplVals.this.intp.global.type">global</a><span class="delimiter">)</span>
    <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="implicit scala.tools.nsc.interpreter.StdReplVals.ReplImplicits.mkCompilerTypeFromTag : (sym: StdReplVals.this.intp.global.Symbol)Object{def apply[M](implicit m1: reflect.mirror.TypeTag[M]): StdReplVals.this.global.Type; def apply[M1, M2](implicit m1: reflect.mirror.TypeTag[M1],implicit m2: reflect.mirror.TypeTag[M2]): StdReplVals.this.global.Type}" id="958777">mkCompilerTypeFromTag</a><span class="delimiter">(</span><a title="StdReplVals.this.intp.global.Symbol" id="959006">sym</a>: <a href="../../../reflect/internal/Symbols.scala.html#441132" title="StdReplVals.this.intp.global.Symbol">Symbol</a><span class="delimiter">)</span> = <a href="../../../Function1.scala.html#59555" title="(v1: StdReplVals.this.global.Symbol)Object{def apply[M](implicit m1: reflect.mirror.TypeTag[M]): StdReplVals.this.global.Type; def apply[M1, M2](implicit m1: reflect.mirror.TypeTag[M1],implicit m2: reflect.mirror.TypeTag[M2]): StdReplVals.this.global.Type}">tagFn</a><span class="delimiter">(</span><a href="#959006" title="StdReplVals.this.intp.global.Symbol">sym</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">final</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="StdReplVals.this.ReplImplicits" id="907355">replImplicits</a> = <span title="StdReplVals.this.ReplImplicits" class="keyword">new</span> <a href="#907353" title="StdReplVals.this.ReplImplicits">ReplImplicits</a>

  <span class="keyword">def</span> <a title="[T &lt;: StdReplVals.this.analyzer.global.Tree](tree: T)T" id="907356">typed</a><span class="delimiter">[</span><a title=" &lt;: StdReplVals.this.analyzer.global.Tree" id="907358">T</a> &lt;: analyzer.global.Tree<span class="delimiter">]</span><span class="delimiter">(</span><a title="T" id="959033">tree</a>: <a href="#907358" title="T">T</a><span class="delimiter">)</span>: <a href="#907358" title="T">T</a> = <a href="#907350" title="=&gt; StdReplVals.this.analyzer.Typer">typer</a>.<a href="../typechecker/Typers.scala.html#560768" title="(tree: StdReplVals.this.analyzer.global.Tree)StdReplVals.this.analyzer.global.Tree">typed</a><span class="delimiter">(</span><a href="#959033" title="T">tree</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="T" class="delimiter">[</span><a href="#907358" title="T">T</a><span class="delimiter">]</span>
<span class="delimiter">}</span>

<span class="keyword">object</span> <a title="scala.tools.nsc.interpreter.ReplVals.type" id="38089">ReplVals</a> <a href="#38090" title="scala.tools.nsc.interpreter.ReplVals.type" class="delimiter">{</a>
  /** Latest attempt to work around the challenge of foo.global.Type
   *  not being seen as the same type as bar.global.Type even though
   *  the globals are the same.  Dependent method types to the rescue.
   */
  <span class="keyword">def</span> <a title="[T &lt;: scala.tools.nsc.Global](global: T)global.Symbol =&gt; Object{def apply[M](implicit m1: reflect.mirror.TypeTag[M]): global.Type; def apply[M1, M2](implicit m1: reflect.mirror.TypeTag[M1],implicit m2: reflect.mirror.TypeTag[M2]): global.Type}" id="958780">mkCompilerTypeFromTag</a><span class="delimiter">[</span><a title=" &lt;: scala.tools.nsc.Global" id="958782">T</a> &lt;: Global<span class="delimiter">]</span><span class="delimiter">(</span><a title="T" id="958783">global</a>: <a href="#958782" title="T">T</a><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span class="keyword">import</span> <a href="#958783" title="T">global</a>._
    <span class="keyword">import</span> <a href="../../../reflect/internal/Definitions.scala.html#441641" title="global.definitions.type">definitions</a>._

    /** We can't use definitions.compilerTypeFromTag directly because we're passing
     *  it to map and the compiler refuses to perform eta expansion on a method
     *  with a dependent return type.  (Can this be relaxed?) To get around this
     *  I have this forwarder which widens the type and then cast the result back
     *  to the dependent type.
     */
    <span class="keyword">def</span> <a title="(t: reflect.mirror.TypeTag[_])scala.tools.nsc.Global#Type" id="958786">compilerTypeFromTag</a><span class="delimiter">(</span><a title="reflect.mirror.TypeTag[_]" id="958788">t</a>: rm.<a href="../../../reflect/api/TypeTags.scala.html#23825" title="reflect.mirror.TypeTag[_]">TypeTag</a><span class="delimiter">[</span>_<span class="delimiter">]</span><span class="delimiter">)</span>: Global#<a href="../../../reflect/internal/Types.scala.html#441242" title="scala.tools.nsc.Global#Type">Type</a> =
      <a href="../../../reflect/internal/Definitions.scala.html#441641" title="global.definitions.type">definitions</a>.<a href="../../../reflect/internal/Definitions.scala.html#442453" title="(t: reflect.mirror.TypeTag[_])global.Type">compilerTypeFromTag</a><span class="delimiter">(</span><a href="#958788" title="reflect.mirror.TypeTag[_]">t</a><span class="delimiter">)</span>

    <span class="keyword">class</span> <a title="class AppliedTypeFromTags extends Object" id="958787">AppliedTypeFromTags</a><a href="#958787" title="AppliedTypeFromTags" class="delimiter">(</a><a title="global.Symbol" id="958813">sym</a>: <a href="../../../reflect/internal/Symbols.scala.html#441132" title="global.Symbol">Symbol</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="keyword">def</span> <a title="[M](implicit m1: reflect.mirror.TypeTag[M])global.Type" id="958803">apply</a><span class="delimiter">[</span><a title="" id="958805">M</a><span class="delimiter">]</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="reflect.mirror.TypeTag[M]" id="958814">m1</a>: rm.<a href="../../../reflect/api/TypeTags.scala.html#23825" title="reflect.mirror.TypeTag[M]">TypeTag</a><span class="delimiter">[</span>M<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../../reflect/internal/Types.scala.html#441242" title="global.Type">Type</a> =
        <span title="global.Type" class="keyword">if</span> <span class="delimiter">(</span><a href="#958813" title="global.Symbol">sym</a> <span title="(x$1: AnyRef)Boolean">eq</span> <a href="../../../reflect/internal/Symbols.scala.html#441152" title="=&gt; global.NoSymbol">NoSymbol</a><span class="delimiter">)</span> <a href="../../../reflect/internal/Types.scala.html#441256" title="global.NoType.type">NoType</a>
        <span class="keyword">else</span> <a href="../../../reflect/internal/Types.scala.html#441378" title="(tyconSym: global.Symbol, args: global.Type*)global.Type">appliedType</a><span class="delimiter">(</span><a href="#958813" title="global.Symbol">sym</a>, <a href="#958786" title="(t: reflect.mirror.TypeTag[_])scala.tools.nsc.Global#Type">compilerTypeFromTag</a><span class="delimiter">(</span><a href="#958814" title="reflect.mirror.TypeTag[M]">m1</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="global.Type" class="delimiter">[</span><a href="../../../reflect/internal/Types.scala.html#441242" title="global.Type">Type</a><span class="delimiter">]</span><span class="delimiter">)</span>

      <span class="keyword">def</span> <a title="[M1, M2](implicit m1: reflect.mirror.TypeTag[M1], implicit m2: reflect.mirror.TypeTag[M2])global.Type" id="958806">apply</a><span class="delimiter">[</span><a title="" id="958809">M1</a>, <a title="" id="958810">M2</a><span class="delimiter">]</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="reflect.mirror.TypeTag[M1]" id="958827">m1</a>: rm.<a href="../../../reflect/api/TypeTags.scala.html#23825" title="reflect.mirror.TypeTag[M1]">TypeTag</a><span class="delimiter">[</span>M1<span class="delimiter">]</span>, <a title="reflect.mirror.TypeTag[M2]" id="958828">m2</a>: rm.<a href="../../../reflect/api/TypeTags.scala.html#23825" title="reflect.mirror.TypeTag[M2]">TypeTag</a><span class="delimiter">[</span>M2<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../../reflect/internal/Types.scala.html#441242" title="global.Type">Type</a> =
        <span title="global.Type" class="keyword">if</span> <span class="delimiter">(</span><a href="#958813" title="global.Symbol">sym</a> <span title="(x$1: AnyRef)Boolean">eq</span> <a href="../../../reflect/internal/Symbols.scala.html#441152" title="=&gt; global.NoSymbol">NoSymbol</a><span class="delimiter">)</span> <a href="../../../reflect/internal/Types.scala.html#441256" title="global.NoType.type">NoType</a>
        <span class="keyword">else</span> <a href="../../../reflect/internal/Types.scala.html#441378" title="(tyconSym: global.Symbol, args: global.Type*)global.Type">appliedType</a><span class="delimiter">(</span><a href="#958813" title="global.Symbol">sym</a>, <a href="#958786" title="(t: reflect.mirror.TypeTag[_])scala.tools.nsc.Global#Type">compilerTypeFromTag</a><span class="delimiter">(</span><a href="#958827" title="reflect.mirror.TypeTag[M1]">m1</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="global.Type" class="delimiter">[</span><a href="../../../reflect/internal/Types.scala.html#441242" title="global.Type">Type</a><span class="delimiter">]</span>, <a href="#958786" title="(t: reflect.mirror.TypeTag[_])scala.tools.nsc.Global#Type">compilerTypeFromTag</a><span class="delimiter">(</span><a href="#958828" title="reflect.mirror.TypeTag[M2]">m2</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="global.Type" class="delimiter">[</span><a href="../../../reflect/internal/Types.scala.html#441242" title="global.Type">Type</a><span class="delimiter">]</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="delimiter">(</span>sym: <a href="../../../reflect/internal/Symbols.scala.html#441132" title="global.Symbol">Symbol</a><span class="delimiter">)</span> =&gt; <span title="AppliedTypeFromTags" class="keyword">new</span> <a href="#958787" title="AppliedTypeFromTags">AppliedTypeFromTags</a><span class="delimiter">(</span><a href="#958836" title="global.Symbol">sym</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>