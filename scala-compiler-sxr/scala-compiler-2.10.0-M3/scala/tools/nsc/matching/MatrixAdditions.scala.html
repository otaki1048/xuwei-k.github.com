<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>scala/tools/nsc/matching/MatrixAdditions.scala</title>
        <script type="text/javascript" src="../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
/* NSC -- new Scala compiler
 * Copyright 2005-2011 LAMP/EPFL
 * Author: Paul Phillips
 */

<span class="keyword">package</span> scala.tools.nsc
<span class="keyword">package</span> matching

<span class="keyword">import</span> transform.ExplicitOuter
<span class="keyword">import</span> <a href="../../../PartialFunction.scala.html#218" title="PartialFunction.type">PartialFunction</a>._

/** Traits which are mixed into MatchMatrix, but separated out as
 *  (somewhat) independent components to keep them on the sidelines.
 */
<span class="keyword">trait</span> <a title="trait MatrixAdditions extends Object with scala.tools.nsc.ast.TreeDSL" id="42277">MatrixAdditions</a> <a href="../../../Unit.scala.html#2389" title="Unit" class="keyword">extends</a> ast.<a href="../ast/TreeDSL.scala.html#29480" title="scala.tools.nsc.ast.TreeDSL">TreeDSL</a> <span class="delimiter">{</span>
  self: ExplicitOuter <span class="keyword">with</span> ParallelMatching =&gt;

  <span class="keyword">import</span> <a href="../transform/TypingTransformers.scala.html#650650" title="=&gt; scala.tools.nsc.Global">global</a>.<span class="delimiter">{</span> typer =&gt; _, _ <span class="delimiter">}</span>
  <span class="keyword">import</span> symtab.Flags
  <span class="keyword">import</span> <a href="../ast/TreeDSL.scala.html#560223" title="MatrixAdditions.this.CODE.type">CODE</a>._
  <span class="keyword">import</span> <a href="MatchSupport.scala.html#651113" title="MatrixAdditions.this.Debug.type">Debug</a>._
  <span class="keyword">import</span> <a href="../ast/Trees.scala.html#559838" title="MatrixAdditions.this.global.treeInfo.type">treeInfo</a>._
  <span class="keyword">import</span> <a href="../../../reflect/internal/Definitions.scala.html#441641" title="MatrixAdditions.this.global.definitions.type">definitions</a>.<span class="delimiter">{</span> isPrimitiveValueClass <span class="delimiter">}</span>

  /** The Squeezer, responsible for all the squeezing.
   */
  <span class="keyword">private</span><span class="delimiter">[</span>matching<span class="delimiter">]</span> <span class="keyword">trait</span> <a title="trait Squeezer extends Object" id="651129">Squeezer</a> <a href="../../../Unit.scala.html#2389" title="Unit" class="delimiter">{</a>
    self: MatrixContext =&gt;

    <span class="keyword">private</span> <span class="keyword">val</span> <a title="Boolean" id="984989">settings_squeeze</a> = <a href="../../../Boolean.scala.html#58721" title="=&gt; Boolean">!</a><a href="../Global.scala.html#559485" title="=&gt; scala.tools.nsc.Settings">settings</a>.<a href="../settings/ScalaSettings.scala.html#467550" title="=&gt; scala.tools.nsc.Settings#BooleanSetting">Ynosqueeze</a>.<a href="../settings/MutableSettings.scala.html#467820" title="=&gt; Boolean">value</a>

    <span class="keyword">class</span> <a title="class RefTraverser extends MatrixAdditions.this.global.Traverser" id="984991">RefTraverser</a><a href="#984991" title="Squeezer.this.RefTraverser" class="delimiter">(</a><a title="MatrixAdditions.this.global.ValDef" id="987094">vd</a>: <a href="../../../reflect/api/Trees.scala.html#23593" title="MatrixAdditions.this.global.ValDef">ValDef</a><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="../../../reflect/api/Trees.scala.html#23760" title="MatrixAdditions.this.global.Traverser">Traverser</a> <span class="delimiter">{</span>
      <span class="keyword">private</span> <span class="keyword">val</span> <a title="MatrixAdditions.this.global.Symbol" id="987079">targetSymbol</a> = <a href="#987094" title="MatrixAdditions.this.global.ValDef">vd</a>.<a href="../../../reflect/api/Trees.scala.html#427232" title="=&gt; MatrixAdditions.this.global.Symbol">symbol</a>
      <span class="keyword">private</span> <span class="keyword">var</span> <a title="Int" id="987082">safeRefs</a>     = <span title="Int(0)" class="int">0</span>
      <span class="keyword">private</span> <span class="keyword">var</span> <a title="Boolean" id="987085">isSafe</a>       = <span title="Boolean(true)" class="keyword">true</span>

      <span class="keyword">def</span> <a title="=&gt; Boolean" id="987087">canDrop</a>   = <a href="#987085" title="=&gt; Boolean">isSafe</a> <a href="../../../Boolean.scala.html#58725" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#987082" title="=&gt; Int">safeRefs</a> <a href="../../../Int.scala.html#57891" title="(x: Int)Boolean">==</a> <span title="Int(0)" class="int">0</span>
      <span class="keyword">def</span> <a title="=&gt; Boolean" id="987088">canInline</a> = <a href="#987085" title="=&gt; Boolean">isSafe</a> <a href="../../../Boolean.scala.html#58725" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#987082" title="=&gt; Int">safeRefs</a> <a href="../../../Int.scala.html#57891" title="(x: Int)Boolean">==</a> <span title="Int(1)" class="int">1</span>

      <span class="keyword">override</span> <span class="keyword">def</span> <a title="(tree: MatrixAdditions.this.global.Tree)Unit" id="987089">traverse</a><span class="delimiter">(</span><a title="MatrixAdditions.this.global.Tree" id="987105">tree</a>: <a href="../../../reflect/api/Trees.scala.html#23570" title="MatrixAdditions.this.global.Tree">Tree</a><span class="delimiter">)</span>: <a href="../../../Unit.scala.html#2389" title="Unit">Unit</a> = <a href="#987105" title="MatrixAdditions.this.global.Tree">tree</a> <span class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <a href="#987157" title="Unit" id="987162">t</a>: Ident <span class="keyword">if</span> t.<a href="../../../reflect/api/Trees.scala.html#427232" title="=&gt; MatrixAdditions.this.global.Symbol">symbol</a> <span title="(x$1: AnyRef)Boolean">eq</span> <a href="#987079" title="=&gt; MatrixAdditions.this.global.Symbol">targetSymbol</a> =&gt;
          // target symbol's owner should match currentOwner
          <a href="#987163" title="(x: Unit)Unit" class="keyword">if</a> <span class="delimiter">(</span><a href="#987079" title="=&gt; MatrixAdditions.this.global.Symbol">targetSymbol</a>.<a href="../../../reflect/internal/Symbols.scala.html#443379" title="=&gt; MatrixAdditions.this.global.Symbol">owner</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../../reflect/api/Trees.scala.html#433532" title="=&gt; MatrixAdditions.this.global.Symbol">currentOwner</a><span class="delimiter">)</span> <a href="#987082" title="(x$1: Int)Unit">safeRefs</a> <a href="../../../Int.scala.html#57948" title="(x: Int)Int">+=</a> <span title="Int(1)" class="int">1</span>
          <span class="keyword">else</span> <a href="#987085" title="(x$1: Boolean)Unit">isSafe</a> = <span title="Boolean(false)" class="keyword">false</span>

        <span class="keyword">case</span> LabelDef<a href="#987157" title="Unit" id="987161" class="delimiter">(</a>_, params, rhs<span class="delimiter">)</span> =&gt;
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span>params <a href="../../../collection/LinearSeqOptimized.scala.html#76170" title="(p: MatrixAdditions.this.global.Ident =&gt; Boolean)Boolean">exists</a> <span class="delimiter">(</span><a href="#987150" title="MatrixAdditions.this.global.Ident">_</a>.<a href="../../../reflect/api/Trees.scala.html#427232" title="=&gt; MatrixAdditions.this.global.Symbol">symbol</a> <span title="(x$1: AnyRef)Boolean">eq</span> <a href="#987079" title="=&gt; MatrixAdditions.this.global.Symbol">targetSymbol</a><span class="delimiter">)</span><span class="delimiter">)</span>  // cannot substitute this one
            <a href="#987085" title="(x$1: Boolean)Unit">isSafe</a> = <span title="Boolean(false)" class="keyword">false</span>

          <a href="#987089" title="(tree: MatrixAdditions.this.global.Tree)Unit">traverse</a><span class="delimiter">(</span>rhs<span class="delimiter">)</span>
        <span class="keyword">case</span> _ <span class="keyword">if</span> <a href="#987082" title="=&gt; Int">safeRefs</a> <a href="../../../Int.scala.html#57919" title="(x: Int)Boolean">&gt;</a> <span title="Int(1)" class="int">1</span> =&gt; <a href="#987163" title="(x: Unit)Unit" class="delimiter">(</a><span class="delimiter">)</span>
        <span class="keyword">case</span> _ =&gt;
          <a href="#984991" title="Squeezer.this.RefTraverser" class="keyword">super</a>.<a href="../../../reflect/api/Trees.scala.html#433535" title="(tree: MatrixAdditions.this.global.Tree)Unit">traverse</a><a href="#987163" title="(x: Unit)Unit" class="delimiter">(</a><a href="#987105" title="MatrixAdditions.this.global.Tree">tree</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    /** Compresses multiple Blocks. */
    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(stats: List[MatrixAdditions.this.global.Tree], expr: MatrixAdditions.this.global.Tree)MatrixAdditions.this.global.Tree" id="984992">combineBlocks</a><span class="delimiter">(</span><a title="List[MatrixAdditions.this.global.Tree]" id="987170">stats</a>: <a href="../../../collection/immutable/List.scala.html#12322" title="List[MatrixAdditions.this.global.Tree]">List</a><span class="delimiter">[</span>Tree<span class="delimiter">]</span>, <a title="MatrixAdditions.this.global.Tree" id="987171">expr</a>: <a href="../../../reflect/api/Trees.scala.html#23570" title="MatrixAdditions.this.global.Tree">Tree</a><span class="delimiter">)</span>: <a href="../../../reflect/api/Trees.scala.html#23570" title="MatrixAdditions.this.global.Tree">Tree</a> = <a href="#987171" title="MatrixAdditions.this.global.Tree">expr</a> <span class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> Block<a href="#987201" title="MatrixAdditions.this.global.Tree" id="987203" class="delimiter">(</a>stats1, expr1<span class="delimiter">)</span> <span class="keyword">if</span> <a href="#987170" title="List[MatrixAdditions.this.global.Tree]">stats</a>.<a href="../../../collection/IterableLike.scala.html#59464" title="=&gt; Boolean">isEmpty</a> =&gt; <a href="#984992" title="(stats: List[MatrixAdditions.this.global.Tree], expr: MatrixAdditions.this.global.Tree)MatrixAdditions.this.global.Tree">combineBlocks</a><a href="#987204" title="(x: MatrixAdditions.this.global.Tree)MatrixAdditions.this.global.Tree" class="delimiter">(</a>stats1, expr1<span class="delimiter">)</span>
      <span class="keyword">case</span> _                                     =&gt; <a href="../../../reflect/api/Trees.scala.html#427284" title="(stats: List[MatrixAdditions.this.global.Tree], expr: MatrixAdditions.this.global.Tree)MatrixAdditions.this.global.Block">Block</a><a href="#987204" title="(x: MatrixAdditions.this.global.Tree)MatrixAdditions.this.global.Tree" class="delimiter">(</a><a href="#987170" title="List[MatrixAdditions.this.global.Tree]">stats</a>, <a href="#987171" title="MatrixAdditions.this.global.Tree">expr</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
    <span class="keyword">def</span> <a title="(vds: List[MatrixAdditions.this.global.Tree], exp: MatrixAdditions.this.global.Tree)MatrixAdditions.this.global.Tree" id="984993">squeezedBlock</a><span class="delimiter">(</span><a title="List[MatrixAdditions.this.global.Tree]" id="987209">vds</a>: <a href="../../../collection/immutable/List.scala.html#12322" title="List[MatrixAdditions.this.global.Tree]">List</a><span class="delimiter">[</span>Tree<span class="delimiter">]</span>, <a title="MatrixAdditions.this.global.Tree" id="987210">exp</a>: <a href="../../../reflect/api/Trees.scala.html#23570" title="MatrixAdditions.this.global.Tree">Tree</a><span class="delimiter">)</span>: <a href="../../../reflect/api/Trees.scala.html#23570" title="MatrixAdditions.this.global.Tree">Tree</a> =
      <span title="MatrixAdditions.this.global.Tree" class="keyword">if</span> <span class="delimiter">(</span><a href="#984989" title="=&gt; Boolean">settings_squeeze</a><span class="delimiter">)</span> <a href="#984992" title="(stats: List[MatrixAdditions.this.global.Tree], expr: MatrixAdditions.this.global.Tree)MatrixAdditions.this.global.Tree">combineBlocks</a><span class="delimiter">(</span><a href="../../../collection/immutable/List.scala.html#11552" title="scala.collection.immutable.Nil.type">Nil</a>, <a href="#984994" title="(vds: List[MatrixAdditions.this.global.Tree], exp: MatrixAdditions.this.global.Tree)MatrixAdditions.this.global.Tree">squeezedBlock1</a><span class="delimiter">(</span><a href="#987209" title="List[MatrixAdditions.this.global.Tree]">vds</a>, <a href="#987210" title="MatrixAdditions.this.global.Tree">exp</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">else</span>                  <a href="#984992" title="(stats: List[MatrixAdditions.this.global.Tree], expr: MatrixAdditions.this.global.Tree)MatrixAdditions.this.global.Tree">combineBlocks</a><span class="delimiter">(</span><a href="#987209" title="List[MatrixAdditions.this.global.Tree]">vds</a>, <a href="#987210" title="MatrixAdditions.this.global.Tree">exp</a><span class="delimiter">)</span>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(vds: List[MatrixAdditions.this.global.Tree], exp: MatrixAdditions.this.global.Tree)MatrixAdditions.this.global.Tree" id="984994">squeezedBlock1</a><span class="delimiter">(</span><a title="List[MatrixAdditions.this.global.Tree]" id="987211">vds</a>: <a href="../../../collection/immutable/List.scala.html#12322" title="List[MatrixAdditions.this.global.Tree]">List</a><span class="delimiter">[</span>Tree<span class="delimiter">]</span>, <a title="MatrixAdditions.this.global.Tree" id="987212">exp</a>: <a href="../../../reflect/api/Trees.scala.html#23570" title="MatrixAdditions.this.global.Tree">Tree</a><span class="delimiter">)</span>: <a href="../../../reflect/api/Trees.scala.html#23570" title="MatrixAdditions.this.global.Tree">Tree</a> = <span class="delimiter">{</span>
      <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="MatrixAdditions.this.global.Tree" id="987214">squeezedTail</a> = <a href="#984993" title="(vds: List[MatrixAdditions.this.global.Tree], exp: MatrixAdditions.this.global.Tree)MatrixAdditions.this.global.Tree">squeezedBlock</a><span class="delimiter">(</span><a href="#987211" title="List[MatrixAdditions.this.global.Tree]">vds</a>.<a href="../../../collection/TraversableLike.scala.html#59012" title="=&gt; List[MatrixAdditions.this.global.Tree]">tail</a>, <a href="#987212" title="MatrixAdditions.this.global.Tree">exp</a><span class="delimiter">)</span>
      <span class="keyword">def</span> <a title="=&gt; MatrixAdditions.this.global.Block" id="987215">default</a> = <a href="#987213" title="=&gt; MatrixAdditions.this.global.Tree">squeezedTail</a> <span class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> Block<a href="#987268" title="MatrixAdditions.this.global.Block" id="987270" class="delimiter">(</a>vds2, exp2<span class="delimiter">)</span> =&gt; <a href="../../../reflect/api/Trees.scala.html#427284" title="(stats: List[MatrixAdditions.this.global.Tree], expr: MatrixAdditions.this.global.Tree)MatrixAdditions.this.global.Block">Block</a><a href="#987271" title="(x: MatrixAdditions.this.global.Block)MatrixAdditions.this.global.Block" class="delimiter">(</a><a href="#987211" title="List[MatrixAdditions.this.global.Tree]">vds</a>.<a href="../../../collection/IterableLike.scala.html#59473" title="=&gt; MatrixAdditions.this.global.Tree">head</a> <a href="../../../collection/immutable/List.scala.html#63643" title="(x: MatrixAdditions.this.global.Tree)List[MatrixAdditions.this.global.Tree]">::</a> vds2, exp2<span class="delimiter">)</span>
        <span class="keyword">case</span> exp2              =&gt; <a href="../../../reflect/api/Trees.scala.html#427284" title="(stats: List[MatrixAdditions.this.global.Tree], expr: MatrixAdditions.this.global.Tree)MatrixAdditions.this.global.Block">Block</a><a href="#987271" title="(x: MatrixAdditions.this.global.Block)MatrixAdditions.this.global.Block" class="delimiter">(</a><a href="#987211" title="List[MatrixAdditions.this.global.Tree]">vds</a>.<a href="../../../collection/IterableLike.scala.html#59473" title="=&gt; MatrixAdditions.this.global.Tree">head</a> <a href="../../../collection/immutable/List.scala.html#63643" title="(x: MatrixAdditions.this.global.Tree)List[MatrixAdditions.this.global.Tree]">::</a> <a href="../../../collection/immutable/List.scala.html#11552" title="scala.collection.immutable.Nil.type">Nil</a>,  exp2<span class="delimiter">)</span>
      <span class="delimiter">}</span>

      <span title="MatrixAdditions.this.global.Tree" class="keyword">if</span> <span class="delimiter">(</span><a href="#987211" title="List[MatrixAdditions.this.global.Tree]">vds</a>.<a href="../../../collection/IterableLike.scala.html#59464" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <a href="#987212" title="MatrixAdditions.this.global.Tree">exp</a>
      <span class="keyword">else</span> <a href="#987211" title="List[MatrixAdditions.this.global.Tree]">vds</a>.<a href="../../../collection/IterableLike.scala.html#59473" title="=&gt; MatrixAdditions.this.global.Tree">head</a> <span class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <a href="#987302" title="MatrixAdditions.this.global.Tree" id="987304">vd</a>: ValDef =&gt;
          <span class="keyword">val</span> <a title="Squeezer.this.RefTraverser" id="987277">rt</a> = <span title="Squeezer.this.RefTraverser" class="keyword">new</span> <a href="#984991" title="Squeezer.this.RefTraverser">RefTraverser</a><span class="delimiter">(</span>vd<span class="delimiter">)</span>
          <a href="#987277" title="Squeezer.this.RefTraverser">rt</a>.<a href="../../../reflect/api/Trees.scala.html#433539" title="(owner: MatrixAdditions.this.global.Symbol)(traverse: =&gt; Unit)Unit">atOwner</a><span class="delimiter">(</span><a href="Matrix.scala.html#985006" title="=&gt; MatrixAdditions.this.global.Symbol">owner</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#987277" title="Squeezer.this.RefTraverser">rt</a> <a href="#987089" title="(tree: MatrixAdditions.this.global.Tree)Unit">traverse</a> <a href="#987213" title="=&gt; MatrixAdditions.this.global.Tree">squeezedTail</a><span class="delimiter">)</span>

          <span title="MatrixAdditions.this.global.Tree" class="keyword">if</span> <span class="delimiter">(</span><a href="#987277" title="Squeezer.this.RefTraverser">rt</a>.<a href="#987087" title="=&gt; Boolean">canDrop</a><span class="delimiter">)</span>
            <a href="#987213" title="=&gt; MatrixAdditions.this.global.Tree">squeezedTail</a>
          <span class="keyword">else</span> <span title="MatrixAdditions.this.global.Tree" class="keyword">if</span> <span class="delimiter">(</span><a href="../../../reflect/internal/Types.scala.html#441518" title="(tp: MatrixAdditions.this.global.Type)Boolean">isConstantType</a><span class="delimiter">(</span>vd.<a href="../../../reflect/api/Trees.scala.html#427232" title="=&gt; MatrixAdditions.this.global.Symbol">symbol</a>.<a href="../../../reflect/internal/Symbols.scala.html#443425" title="=&gt; MatrixAdditions.this.global.Type">tpe</a><span class="delimiter">)</span> <a href="../../../Boolean.scala.html#58724" title="(x: Boolean)Boolean">||</a> <a href="#987277" title="Squeezer.this.RefTraverser">rt</a>.<a href="#987088" title="=&gt; Boolean">canInline</a><span class="delimiter">)</span>
            <span title="MatrixAdditions.this.global.TreeSubstituter" class="keyword">new</span> <a href="../../../reflect/internal/Trees.scala.html#441851" title="MatrixAdditions.this.global.TreeSubstituter">TreeSubstituter</a><span class="delimiter">(</span><a href="../../../collection/immutable/List.scala.html#63291" title="(xs: MatrixAdditions.this.global.Symbol*)List[MatrixAdditions.this.global.Symbol]">List</a><span class="delimiter">(</span>vd.<a href="../../../reflect/api/Trees.scala.html#427232" title="=&gt; MatrixAdditions.this.global.Symbol">symbol</a><span class="delimiter">)</span>, <a href="../../../collection/immutable/List.scala.html#63291" title="(xs: MatrixAdditions.this.global.Tree*)List[MatrixAdditions.this.global.Tree]">List</a><span class="delimiter">(</span>vd.<a href="../../../reflect/api/Trees.scala.html#427475" title="=&gt; MatrixAdditions.this.global.Tree">rhs</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../../reflect/internal/Trees.scala.html#513445" title="(tree: MatrixAdditions.this.global.Tree)MatrixAdditions.this.global.Tree">transform</a> <a href="#987213" title="=&gt; MatrixAdditions.this.global.Tree">squeezedTail</a>
          <span class="keyword">else</span>
            <a href="#987215" title="=&gt; MatrixAdditions.this.global.Block">default</a>
        <span class="keyword">case</span> _ =&gt; <a href="#987305" title="(x: MatrixAdditions.this.global.Tree)MatrixAdditions.this.global.Tree">default</a>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  /** The Optimizer, responsible for some of the optimizing.
   */
  <span class="keyword">private</span><span class="delimiter">[</span>matching<span class="delimiter">]</span> <span class="keyword">trait</span> <a title="trait MatchMatrixOptimizer extends Object" id="651130">MatchMatrixOptimizer</a> <a href="../../../Unit.scala.html#2389" title="Unit" class="delimiter">{</a>
    self: MatchMatrix =&gt;

    <span class="keyword">import</span> <a href="#651130" title="MatchMatrixOptimizer.this.type">self</a>.<a href="ParallelMatching.scala.html#985142" title="=&gt; MatrixAdditions.this.MatrixContext">context</a>._

    <span class="keyword">final</span> <span class="keyword">def</span> <a title="(tree: MatrixAdditions.this.global.Tree)MatrixAdditions.this.global.Tree" id="985140">optimize</a><span class="delimiter">(</span><a title="MatrixAdditions.this.global.Tree" id="986028">tree</a>: <a href="../../../reflect/api/Trees.scala.html#23570" title="MatrixAdditions.this.global.Tree">Tree</a><span class="delimiter">)</span>: <a href="../../../reflect/api/Trees.scala.html#23570" title="MatrixAdditions.this.global.Tree">Tree</a> = <span class="delimiter">{</span>
      // Uses treeInfo extractors rather than looking at trees directly
      // because the many Blocks obscure our vision.
      <span class="keyword">object</span> <a title="lxtt.type" id="987311">lxtt</a> <a href="#987312" title="lxtt.type" class="keyword">extends</a> <a href="../ast/Trees.scala.html#559848" title="MatrixAdditions.this.global.Transformer">Transformer</a> <span class="delimiter">{</span>
        <span class="keyword">override</span> <span class="keyword">def</span> <a title="(tree: MatrixAdditions.this.global.Tree)MatrixAdditions.this.global.Tree" id="987314">transform</a><span class="delimiter">(</span><a title="MatrixAdditions.this.global.Tree" id="987316">tree</a>: <a href="../../../reflect/api/Trees.scala.html#23570" title="MatrixAdditions.this.global.Tree">Tree</a><span class="delimiter">)</span>: <a href="../../../reflect/api/Trees.scala.html#23570" title="MatrixAdditions.this.global.Tree">Tree</a> = <a href="#987316" title="MatrixAdditions.this.global.Tree">tree</a> <span class="keyword">match</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> Block<a href="#987425" title="MatrixAdditions.this.global.Tree" id="987427" class="delimiter">(</a>stats, ld @ LabelDef<a title="MatrixAdditions.this.global.Tree" id="987431" class="delimiter">(</a>_, _, body<span class="delimiter">)</span><span class="delimiter">)</span> <span class="keyword">if</span> <a href="ParallelMatching.scala.html#985159" title="=&gt; List[Product with Serializable with MatchMatrixOptimizer.this.State]">targets</a> <a href="../../../collection/LinearSeqOptimized.scala.html#76170" title="(p: Product with Serializable with MatchMatrixOptimizer.this.State =&gt; Boolean)Boolean">exists</a> <span class="delimiter">(</span><a href="#987337" title="MatchMatrix extends Product with Serializable with MatchMatrixOptimizer.this.State">_</a> <a href="ParallelMatching.scala.html#985667" title="(sym: MatrixAdditions.this.global.Symbol)Boolean">shouldInline</a> ld.<a href="../../../reflect/api/Trees.scala.html#427232" title="=&gt; MatrixAdditions.this.global.Symbol">symbol</a><span class="delimiter">)</span> =&gt;
            <a href="#984993" title="(vds: List[MatrixAdditions.this.global.Tree], exp: MatrixAdditions.this.global.Tree)MatrixAdditions.this.global.Tree">squeezedBlock</a><a href="#987452" title="(x: MatrixAdditions.this.global.Tree)MatrixAdditions.this.global.Tree" class="delimiter">(</a><a href="../../../reflect/api/Trees.scala.html#438856" title="(stats: List[MatrixAdditions.this.global.Tree], exprOwner: MatrixAdditions.this.global.Symbol)List[MatrixAdditions.this.global.Tree]">transformStats</a><span class="delimiter">(</span>stats, <a href="../../../reflect/api/Trees.scala.html#438841" title="=&gt; MatrixAdditions.this.global.Symbol">currentOwner</a><span class="delimiter">)</span>, body<span class="delimiter">)</span>
          <span class="keyword">case</span> <a href="../../../reflect/internal/TreeInfo.scala.html#503779" title="Option[(MatrixAdditions.this.global.treeInfo.global.Tree, MatrixAdditions.this.global.treeInfo.global.Tree, MatrixAdditions.this.global.treeInfo.global.Tree)]" id="987460">IsIf</a><span class="delimiter">(</span>cond, <a href="../../../reflect/internal/TreeInfo.scala.html#503779" title="MatrixAdditions.this.global.Tree">IsTrue</a><a title="Unit" id="987435" class="delimiter">(</a><span class="delimiter">)</span>, <a href="../../../reflect/internal/TreeInfo.scala.html#503779" title="MatrixAdditions.this.global.Tree">IsFalse</a><a title="Unit" id="987436" class="delimiter">(</a><span class="delimiter">)</span><span class="delimiter">)</span> =&gt;
            <a href="#987314" title="(tree: MatrixAdditions.this.global.Tree)MatrixAdditions.this.global.Tree">transform</a><a href="#987452" title="(x: MatrixAdditions.this.global.Tree)MatrixAdditions.this.global.Tree" class="delimiter">(</a>cond<span class="delimiter">)</span>
          <span class="keyword">case</span> <a href="../../../reflect/internal/TreeInfo.scala.html#503779" title="Option[(MatrixAdditions.this.global.treeInfo.global.Tree, MatrixAdditions.this.global.treeInfo.global.Tree, MatrixAdditions.this.global.treeInfo.global.Tree)]" id="987470">IsIf</a><span class="delimiter">(</span>cond1, <a href="../../../reflect/internal/TreeInfo.scala.html#503779" title="Option[(MatrixAdditions.this.global.treeInfo.global.Tree, MatrixAdditions.this.global.treeInfo.global.Tree, MatrixAdditions.this.global.treeInfo.global.Tree)]" id="987468">IsIf</a><span class="delimiter">(</span>cond2, thenp, elsep1<span class="delimiter">)</span>, elsep2<span class="delimiter">)</span> <span class="keyword">if</span> elsep1 <a href="../../../reflect/api/Trees.scala.html#425083" title="(that: MatrixAdditions.this.global.treeInfo.global.Tree)Boolean">equalsStructure</a> elsep2 =&gt;
            <a href="#987314" title="(tree: MatrixAdditions.this.global.Tree)MatrixAdditions.this.global.Tree">transform</a><a href="#987452" title="(x: MatrixAdditions.this.global.Tree)MatrixAdditions.this.global.Tree" class="delimiter">(</a><a href="Matrix.scala.html#985004" title="=&gt; MatrixAdditions.this.global.analyzer.Typer">typer</a> <a href="../typechecker/Typers.scala.html#560768" title="(tree: MatrixAdditions.this.global.analyzer.global.Tree)MatrixAdditions.this.global.analyzer.global.Tree">typed</a> <a href="../../../reflect/api/Trees.scala.html#436640" title="(cond: MatrixAdditions.this.global.Tree, thenp: MatrixAdditions.this.global.Tree, elsep: MatrixAdditions.this.global.Tree)MatrixAdditions.this.global.If">If</a><span class="delimiter">(</span><a href="../Global.scala.html#559498" title="MatrixAdditions.this.global.gen.type">gen</a>.<a href="../../../reflect/internal/TreeGen.scala.html#500059" title="(tree1: MatrixAdditions.this.global.gen.global.Tree, tree2: MatrixAdditions.this.global.gen.global.Tree)MatrixAdditions.this.global.gen.global.Tree">mkAnd</a><span class="delimiter">(</span>cond1, cond2<span class="delimiter">)</span>, thenp, elsep2<span class="delimiter">)</span><span class="delimiter">)</span>
          <span class="keyword">case</span> If<a href="#987425" title="MatrixAdditions.this.global.Tree" id="987442" class="delimiter">(</a>cond1, <a href="../../../reflect/internal/TreeInfo.scala.html#503779" title="Option[(MatrixAdditions.this.global.treeInfo.global.Tree, MatrixAdditions.this.global.treeInfo.global.Tree, MatrixAdditions.this.global.treeInfo.global.Tree)]" id="987476">IsIf</a><span class="delimiter">(</span>cond2, thenp, Apply<a title="MatrixAdditions.this.global.Tree" id="987447" class="delimiter">(</a>jmp, <a href="../../../collection/immutable/List.scala.html#11552" title="MatrixAdditions.this.global.Tree" id="987450">Nil</a><span class="delimiter">)</span><span class="delimiter">)</span>, ld: LabelDef<span class="delimiter">)</span> <span class="keyword">if</span> jmp.<a href="../../../reflect/api/Trees.scala.html#425064" title="=&gt; MatrixAdditions.this.global.Symbol">symbol</a> <span title="(x$1: AnyRef)Boolean">eq</span> ld.<a href="../../../reflect/api/Trees.scala.html#427232" title="=&gt; MatrixAdditions.this.global.Symbol">symbol</a> =&gt;
            <a href="#987314" title="(tree: MatrixAdditions.this.global.Tree)MatrixAdditions.this.global.Tree">transform</a><a href="#987452" title="(x: MatrixAdditions.this.global.Tree)MatrixAdditions.this.global.Tree" class="delimiter">(</a><a href="Matrix.scala.html#985004" title="=&gt; MatrixAdditions.this.global.analyzer.Typer">typer</a> <a href="../typechecker/Typers.scala.html#560768" title="(tree: MatrixAdditions.this.global.analyzer.global.Tree)MatrixAdditions.this.global.analyzer.global.Tree">typed</a> <a href="../../../reflect/api/Trees.scala.html#436640" title="(cond: MatrixAdditions.this.global.Tree, thenp: MatrixAdditions.this.global.Tree, elsep: MatrixAdditions.this.global.Tree)MatrixAdditions.this.global.If">If</a><span class="delimiter">(</span><a href="../Global.scala.html#559498" title="MatrixAdditions.this.global.gen.type">gen</a>.<a href="../../../reflect/internal/TreeGen.scala.html#500059" title="(tree1: MatrixAdditions.this.global.gen.global.Tree, tree2: MatrixAdditions.this.global.gen.global.Tree)MatrixAdditions.this.global.gen.global.Tree">mkAnd</a><span class="delimiter">(</span>cond1, cond2<span class="delimiter">)</span>, thenp, ld<span class="delimiter">)</span><span class="delimiter">)</span>
          <span class="keyword">case</span> _ =&gt;
            <span class="keyword">super</span>.<a href="../../../reflect/api/Trees.scala.html#438847" title="(tree: MatrixAdditions.this.global.Tree)MatrixAdditions.this.global.Tree">transform</a><a href="#987452" title="(x: MatrixAdditions.this.global.Tree)MatrixAdditions.this.global.Tree" class="delimiter">(</a><a href="#987316" title="MatrixAdditions.this.global.Tree">tree</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>
      <span class="keyword">try</span> <a href="#987311" title="lxtt.type">lxtt</a> <a href="#987314" title="(tree: MatrixAdditions.this.global.Tree)MatrixAdditions.this.global.Tree">transform</a> <a href="#986028" title="MatrixAdditions.this.global.Tree">tree</a>
      <span class="keyword">finally</span> <a href="Matrix.scala.html#985017" title="()Unit">clearSyntheticSyms</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  /** The Exhauster.
   */
  <span class="keyword">private</span><span class="delimiter">[</span>matching<span class="delimiter">]</span> <span class="keyword">trait</span> <a title="trait MatrixExhaustiveness extends Object" id="651131">MatrixExhaustiveness</a> <a href="../../../Unit.scala.html#2389" title="Unit" class="delimiter">{</a>
    self: MatchMatrix =&gt;

    <span class="keyword">import</span> <a href="#651131" title="MatrixExhaustiveness.this.type">self</a>.<a href="ParallelMatching.scala.html#985142" title="=&gt; MatrixAdditions.this.MatrixContext">context</a>._

    /** Exhaustiveness checking requires looking for sealed classes
     *  and if found, making sure all children are covered by a pattern.
     */
    <span class="keyword">class</span> <a title="class ExhaustivenessChecker extends Object" id="985207">ExhaustivenessChecker</a><a href="#985207" title="MatrixExhaustiveness.this.ExhaustivenessChecker" class="delimiter">(</a><a title="MatrixExhaustiveness.this.Rep" id="987561">rep</a>: <a href="ParallelMatching.scala.html#985194" title="MatrixExhaustiveness.this.Rep">Rep</a>, <a title="MatrixAdditions.this.global.Position" id="987562">matchPos</a>: <a href="../util/Position.scala.html#52230" title="MatrixAdditions.this.global.Position">Position</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="keyword">val</span> Rep<a href="#987557" title="(x: (MatrixExhaustiveness.this.context.PatternVarGroup, List[MatrixExhaustiveness.this.Row]))(MatrixExhaustiveness.this.context.PatternVarGroup, List[MatrixExhaustiveness.this.Row])" class="delimiter">(</a><a href="../../../Tuple2.scala.html#61506" title="MatrixExhaustiveness.this.context.PatternVarGroup" id="987490">tvars</a>, <a href="../../../Tuple2.scala.html#61508" title="List[MatrixExhaustiveness.this.Row]" id="987492">rows</a><span class="delimiter">)</span> = <a href="#987561" title="MatrixExhaustiveness.this.Rep">rep</a>

      <span class="keyword">import</span> <a href="../symtab/package.scala.html#57302" title="=&gt; reflect.internal.Flags.type">Flags</a>.<span class="delimiter">{</span> MUTABLE, ABSTRACT, SEALED <span class="delimiter">}</span>

      <span class="keyword">private</span> case <span class="keyword">class</span> <a title="class Combo extends AnyRef with Product with Serializable" id="988305">Combo</a><a href="../../../Product.scala.html#304" title="Product" class="delimiter">(</a><a title="Int" id="987982">index</a>: <a href="../../../Int.scala.html#508" title="Int">Int</a>, <a title="MatrixAdditions.this.global.Symbol" id="987983">sym</a>: <a href="../../../reflect/internal/Symbols.scala.html#441132" title="MatrixAdditions.this.global.Symbol">Symbol</a><span class="delimiter">)</span> <span class="delimiter">{</span> <span class="delimiter">}</span>

      /* True if the patterns in 'row' cover the given type symbol combination, and has no guard. */
      <span class="keyword">private</span> <span class="keyword">def</span> <a title="(row: MatrixExhaustiveness.this.Row, combos: List[ExhaustivenessChecker.this.Combo])Boolean" id="987498">rowCoversCombo</a><span class="delimiter">(</span><a title="MatrixExhaustiveness.this.Row" id="987622">row</a>: <a href="ParallelMatching.scala.html#985184" title="MatrixExhaustiveness.this.Row">Row</a>, <a title="List[ExhaustivenessChecker.this.Combo]" id="987623">combos</a>: <a href="../../../collection/immutable/List.scala.html#12322" title="List[ExhaustivenessChecker.this.Combo]">List</a><span class="delimiter">[</span>Combo<span class="delimiter">]</span><span class="delimiter">)</span> =
        <a href="#987622" title="MatrixExhaustiveness.this.Row">row</a>.<a href="ParallelMatching.scala.html#985620" title="=&gt; MatrixAdditions.this.global.Tree">guard</a>.<a href="../../../reflect/api/Trees.scala.html#425069" title="=&gt; Boolean">isEmpty</a> <a href="../../../Boolean.scala.html#58725" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#987623" title="List[ExhaustivenessChecker.this.Combo]">combos</a>.<a href="../../../collection/LinearSeqOptimized.scala.html#76169" title="(p: ExhaustivenessChecker.this.Combo =&gt; Boolean)Boolean">forall</a><span class="delimiter">(</span><a title="ExhaustivenessChecker.this.Combo" id="987630">c</a> =&gt; <a href="#987622" title="MatrixExhaustiveness.this.Row">row</a>.<a href="../../../collection/LinearSeqOptimized.scala.html#76165" title="(n: Int)MatrixAdditions.this.Pattern">pats</a><span class="delimiter">(</span><a href="#987630" title="ExhaustivenessChecker.this.Combo">c</a>.<a href="#987982" title="=&gt; Int">index</a><span class="delimiter">)</span> <a href="Patterns.scala.html#987667" title="(sym: MatrixAdditions.this.global.Symbol)Boolean">covers</a> <a href="#987630" title="ExhaustivenessChecker.this.Combo">c</a>.<a href="#987983" title="=&gt; MatrixAdditions.this.global.Symbol">sym</a><span class="delimiter">)</span>

      <span class="keyword">private</span> <span class="keyword">def</span> <a title="(sym: MatrixAdditions.this.global.Symbol)Boolean" id="987499">requiresExhaustive</a><span class="delimiter">(</span><a title="MatrixAdditions.this.global.Symbol" id="987687">sym</a>: <a href="../../../reflect/internal/Symbols.scala.html#441132" title="MatrixAdditions.this.global.Symbol">Symbol</a><span class="delimiter">)</span> = <span class="delimiter">{</span>
         <span class="delimiter">(</span><a href="#987687" title="MatrixAdditions.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/HasFlags.scala.html#443594" title="=&gt; Boolean">isMutable</a><span class="delimiter">)</span> <a href="../../../Boolean.scala.html#58725" title="(x: Boolean)Boolean">&amp;&amp;</a>                 // indicates that have not yet checked exhaustivity
        <a href="../../../Boolean.scala.html#58721" title="=&gt; Boolean">!</a><span class="delimiter">(</span><a href="#987687" title="MatrixAdditions.this.global.Symbol">sym</a> <a href="../../../reflect/internal/Symbols.scala.html#443303" title="(mask: Long)Boolean">hasFlag</a> <a href="Matrix.scala.html#651139" title="=&gt; Long">NO_EXHAUSTIVE</a><span class="delimiter">)</span> <a href="../../../Boolean.scala.html#58725" title="(x: Boolean)Boolean">&amp;&amp;</a>     // indicates @unchecked
         <span class="delimiter">(</span><a href="#987687" title="MatrixAdditions.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#443425" title="=&gt; MatrixAdditions.this.global.Type">tpe</a>.<a href="../../../reflect/internal/Types.scala.html#441986" title="=&gt; MatrixAdditions.this.global.Symbol">typeSymbol</a>.<a href="../../../reflect/internal/HasFlags.scala.html#443607" title="=&gt; Boolean">isSealed</a><span class="delimiter">)</span> <a href="../../../Boolean.scala.html#58725" title="(x: Boolean)Boolean">&amp;&amp;</a>
        <a href="../../../Boolean.scala.html#58721" title="=&gt; Boolean">!</a><a href="../../../reflect/internal/Definitions.scala.html#442785" title="(sym: MatrixAdditions.this.global.Symbol)Boolean">isPrimitiveValueClass</a><span class="delimiter">(</span><a href="#987687" title="MatrixAdditions.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#443425" title="=&gt; MatrixAdditions.this.global.Type">tpe</a>.<a href="../../../reflect/internal/Types.scala.html#441986" title="=&gt; MatrixAdditions.this.global.Symbol">typeSymbol</a><span class="delimiter">)</span>   // make sure it's not a primitive, else (5: Byte) match { case 5 =&gt; ... } sees no Byte
      <span class="delimiter">}</span>

      <span class="keyword">private</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="List[List[ExhaustivenessChecker.this.Combo]]" id="987501">inexhaustives</a>: <a href="../../../collection/immutable/List.scala.html#12322" title="List[List[ExhaustivenessChecker.this.Combo]]">List</a><span class="delimiter">[</span>List<span class="delimiter">[</span>Combo<span class="delimiter">]</span><span class="delimiter">]</span> = <span class="delimiter">{</span>
        // let's please not get too clever side-effecting the mutable flag.
        <span class="keyword">val</span> <a title="List[(MatrixExhaustiveness.this.context.PatternVar, Int)]" id="987690">toCollect</a> = <a href="#987490" title="=&gt; MatrixExhaustiveness.this.context.PatternVarGroup">tvars</a>.<a href="Matrix.scala.html#986061" title="=&gt; List[(MatrixExhaustiveness.this.context.PatternVar, Int)]">zipWithIndex</a> <a href="../../../collection/TraversableLike.scala.html#58981" title="(p: ((MatrixExhaustiveness.this.context.PatternVar, Int)) =&gt; Boolean)List[(MatrixExhaustiveness.this.context.PatternVar, Int)]">filter</a> <a title="anonymous class $anonfun extends scala.runtime.AbstractFunction1[(MatrixExhaustiveness.this.context.PatternVar, Int),Boolean] with Serializable" id="987702" class="delimiter">{</a> <span class="keyword">case</span> <span class="delimiter">(</span>pv, i<span class="delimiter">)</span> =&gt; <a href="#987499" title="(sym: MatrixAdditions.this.global.Symbol)Boolean">requiresExhaustive</a><a href="#987710" title="(x: Boolean)Boolean" class="delimiter">(</a>pv.<a href="Matrix.scala.html#985071" title="=&gt; MatrixAdditions.this.global.Symbol">sym</a><span class="delimiter">)</span> <span class="delimiter">}</span>
        <span class="keyword">val</span> <a title="List[(Int, List[MatrixAdditions.this.global.Symbol])]" id="987691">collected</a> = <a href="#987690" title="List[(MatrixExhaustiveness.this.context.PatternVar, Int)]">toCollect</a> <a href="../../../collection/TraversableLike.scala.html#58971" title="(f: ((MatrixExhaustiveness.this.context.PatternVar, Int)) =&gt; (Int, List[MatrixAdditions.this.global.Symbol]))(implicit bf: scala.collection.generic.CanBuildFrom[List[(MatrixExhaustiveness.this.context.PatternVar, Int)],(Int, List[MatrixAdditions.this.global.Symbol]),List[(Int, List[MatrixAdditions.this.global.Symbol])]])List[(Int, List[MatrixAdditions.this.global.Symbol])]">map</a> <a title="anonymous class $anonfun extends scala.runtime.AbstractFunction1[(MatrixExhaustiveness.this.context.PatternVar, Int),(Int, List[MatrixAdditions.this.global.Symbol])] with Serializable" id="987736" class="delimiter">{</a> <span class="keyword">case</span> <span class="delimiter">(</span>pv, i<span class="delimiter">)</span> =&gt;
          // okay, now reset the flag
          pv.<a href="Matrix.scala.html#985071" title="=&gt; MatrixAdditions.this.global.Symbol">sym</a> <a href="../../../reflect/internal/Symbols.scala.html#443306" title="(mask: Long)MatrixAdditions.this.global.Symbol">resetFlag</a> <span title="Long(4096L)">MUTABLE</span>

          <a href="../../../Predef.scala.html#8484" title="(x: Int)ArrowAssoc[Int]">i</a> <a href="../../../Predef.scala.html#63591" title="(y: List[MatrixAdditions.this.global.Symbol])(Int, List[MatrixAdditions.this.global.Symbol])">-&gt;</a> <span class="delimiter">(</span>
            pv.<a href="Matrix.scala.html#985072" title="=&gt; MatrixAdditions.this.global.Type">tpe</a>.<a href="../../../reflect/internal/Types.scala.html#441986" title="=&gt; MatrixAdditions.this.global.Symbol">typeSymbol</a>.<a href="../../../reflect/internal/Symbols.scala.html#443539" title="=&gt; Set[MatrixAdditions.this.global.Symbol]">sealedDescendants</a>.<a href="../../../collection/TraversableOnce.scala.html#59174" title="=&gt; List[MatrixAdditions.this.global.Symbol]">toList</a> <a href="../../../collection/SeqLike.scala.html#59827" title="(f: MatrixAdditions.this.global.Symbol =&gt; String)(implicit ord: scala.math.Ordering[String])List[MatrixAdditions.this.global.Symbol]">sortBy</a> <span class="delimiter">(</span><a href="#987771" title="MatrixAdditions.this.global.Symbol">_</a>.<a href="../../../reflect/internal/Symbols.scala.html#443545" title="=&gt; String">sealedSortName</a><span class="delimiter">)</span>
            // symbols which are both sealed and abstract need not be covered themselves, because
            // all of their children must be and they cannot otherwise be created.
            <a href="../../../collection/TraversableLike.scala.html#58982" title="(p: MatrixAdditions.this.global.Symbol =&gt; Boolean)List[MatrixAdditions.this.global.Symbol]">filterNot</a> <span class="delimiter">(</span><a title="MatrixAdditions.this.global.Symbol" id="987837">x</a> =&gt; <a href="#987837" title="MatrixAdditions.this.global.Symbol">x</a>.<a href="../../../reflect/internal/HasFlags.scala.html#443607" title="=&gt; Boolean">isSealed</a> <a href="../../../Boolean.scala.html#58725" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#987837" title="MatrixAdditions.this.global.Symbol">x</a>.<a href="../../../reflect/internal/Symbols.scala.html#443238" title="=&gt; Boolean">isAbstractClass</a> <a href="../../../Boolean.scala.html#58725" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../../Boolean.scala.html#58721" title="=&gt; Boolean">!</a><a href="../../../reflect/internal/Definitions.scala.html#442785" title="(sym: MatrixAdditions.this.global.Symbol)Boolean">isPrimitiveValueClass</a><span class="delimiter">(</span><a href="#987837" title="MatrixAdditions.this.global.Symbol">x</a><span class="delimiter">)</span><span class="delimiter">)</span>
            // have to filter out children which cannot match: see ticket #3683 for an example
            <a href="../../../collection/TraversableLike.scala.html#58981" title="(p: MatrixAdditions.this.global.Symbol =&gt; Boolean)List[MatrixAdditions.this.global.Symbol]">filter</a> <span class="delimiter">(</span><a href="#987843" title="MatrixAdditions.this.global.Symbol">_</a>.<a href="../../../reflect/internal/Symbols.scala.html#443425" title="=&gt; MatrixAdditions.this.global.Type">tpe</a> <a href="../../../reflect/internal/Types.scala.html#442059" title="(that: MatrixAdditions.this.global.Type)Boolean">matchesPattern</a> pv.<a href="Matrix.scala.html#985072" title="=&gt; MatrixAdditions.this.global.Type">tpe</a><span class="delimiter">)</span>
          <span class="delimiter">)</span>
        <span class="delimiter">}</span>

        <span class="keyword">val</span> <a title="List[List[ExhaustivenessChecker.this.Combo]]" id="987692">folded</a> =
          <a href="#987691" title="List[(Int, List[MatrixAdditions.this.global.Symbol])]">collected</a>.<a href="../../../collection/LinearSeqOptimized.scala.html#76176" title="(z: List[List[ExhaustivenessChecker.this.Combo]])(f: ((Int, List[MatrixAdditions.this.global.Symbol]), List[List[ExhaustivenessChecker.this.Combo]]) =&gt; List[List[ExhaustivenessChecker.this.Combo]])List[List[ExhaustivenessChecker.this.Combo]]">foldRight</a><span class="delimiter">(</span>List<span class="delimiter">[</span>List<span class="delimiter">[</span>Combo<span class="delimiter">]</span><span class="delimiter">]</span><a href="../../../collection/immutable/List.scala.html#11552" title="scala.collection.immutable.Nil.type" class="delimiter">(</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="delimiter">(</span><a title="(Int, List[MatrixAdditions.this.global.Symbol])" id="987918">c</a>, <a title="List[List[ExhaustivenessChecker.this.Combo]]" id="987919">xs</a><span class="delimiter">)</span> =&gt; <span class="delimiter">{</span>
            <span class="keyword">val</span> <a href="#987951" title="(x: (Int, List[MatrixAdditions.this.global.Symbol]))(Int, List[MatrixAdditions.this.global.Symbol])" class="delimiter">(</a><a href="../../../Tuple2.scala.html#61506" title="Int" id="987921">i</a>, <a href="../../../Tuple2.scala.html#61508" title="List[MatrixAdditions.this.global.Symbol]" id="987922">syms</a><span class="delimiter">)</span> = <a href="#987918" title="(Int, List[MatrixAdditions.this.global.Symbol])">c</a> <a href="../../../Tuple2.scala.html#1222" title="(Int, List[MatrixAdditions.this.global.Symbol]) @unchecked" class="keyword">match</a> <span class="delimiter">{</span> <span class="keyword">case</span> <span class="delimiter">(</span>i, set<span class="delimiter">)</span> =&gt; <a href="#987935" title="(x: (Int, List[MatrixAdditions.this.global.Symbol]))(Int, List[MatrixAdditions.this.global.Symbol])" class="delimiter">(</a>i, set.<a href="../../../collection/immutable/List.scala.html#63665" title="=&gt; List[MatrixAdditions.this.global.Symbol]">toList</a><span class="delimiter">)</span> <span class="delimiter">}</span>
            <a href="#987919" title="List[List[ExhaustivenessChecker.this.Combo]]">xs</a> <span class="keyword">match</span> <span class="delimiter">{</span>
              <span class="keyword">case</span> <a href="../../../collection/immutable/List.scala.html#11552" title="List[List[ExhaustivenessChecker.this.Combo]]" id="988113">Nil</a>  =&gt; <a href="#987922" title="List[MatrixAdditions.this.global.Symbol]">syms</a> <a href="#988114" title="(x: List[List[ExhaustivenessChecker.this.Combo]])List[List[ExhaustivenessChecker.this.Combo]]">map</a> <span class="delimiter">(</span><a title="MatrixAdditions.this.global.Symbol" id="987971">s</a> =&gt; <a href="../../../collection/immutable/List.scala.html#63291" title="(xs: ExhaustivenessChecker.this.Combo*)List[ExhaustivenessChecker.this.Combo]">List</a><span class="delimiter">(</span><a href="#988305" title="(index: Int, sym: MatrixAdditions.this.global.Symbol)ExhaustivenessChecker.this.Combo">Combo</a><span class="delimiter">(</span><a href="#987921" title="Int">i</a>, <a href="#987971" title="MatrixAdditions.this.global.Symbol">s</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
              <span class="keyword">case</span> _    =&gt; <span class="keyword">for</span> <span class="delimiter">(</span><a title="MatrixAdditions.this.global.Symbol" id="988032">s</a> &lt;- <a href="../../../collection/TraversableLike.scala.html#58976" title="(f: MatrixAdditions.this.global.Symbol =&gt; scala.collection.GenTraversableOnce[List[ExhaustivenessChecker.this.Combo]])(implicit bf: scala.collection.generic.CanBuildFrom[List[MatrixAdditions.this.global.Symbol],List[ExhaustivenessChecker.this.Combo],List[List[ExhaustivenessChecker.this.Combo]]])List[List[ExhaustivenessChecker.this.Combo]]">syms</a> ; <a title="List[ExhaustivenessChecker.this.Combo]" id="988049">rest</a> &lt;- <a href="../../../collection/TraversableLike.scala.html#58971" title="(f: List[ExhaustivenessChecker.this.Combo] =&gt; List[ExhaustivenessChecker.this.Combo])(implicit bf: scala.collection.generic.CanBuildFrom[List[List[ExhaustivenessChecker.this.Combo]],List[ExhaustivenessChecker.this.Combo],List[List[ExhaustivenessChecker.this.Combo]]])List[List[ExhaustivenessChecker.this.Combo]]">xs</a><span class="delimiter">)</span> <span class="keyword">yield</span> <a href="#988305" title="(index: Int, sym: MatrixAdditions.this.global.Symbol)ExhaustivenessChecker.this.Combo">Combo</a><span class="delimiter">(</span><a href="#987921" title="Int">i</a>, <a href="#988032" title="MatrixAdditions.this.global.Symbol">s</a><span class="delimiter">)</span> <a href="../../../collection/immutable/List.scala.html#63643" title="(x: ExhaustivenessChecker.this.Combo)List[ExhaustivenessChecker.this.Combo]">::</a> <a href="#988049" title="List[ExhaustivenessChecker.this.Combo]">rest</a>
            <span class="delimiter">}</span>
          <span class="delimiter">}</span><span class="delimiter">)</span>

        <a href="#987692" title="List[List[ExhaustivenessChecker.this.Combo]]">folded</a> <a href="../../../collection/TraversableLike.scala.html#58982" title="(p: List[ExhaustivenessChecker.this.Combo] =&gt; Boolean)List[List[ExhaustivenessChecker.this.Combo]]">filterNot</a> <span class="delimiter">(</span><a title="List[ExhaustivenessChecker.this.Combo]" id="988125">combo</a> =&gt; <a href="#987492" title="=&gt; List[MatrixExhaustiveness.this.Row]">rows</a> <a href="../../../collection/LinearSeqOptimized.scala.html#76170" title="(p: MatrixExhaustiveness.this.Row =&gt; Boolean)Boolean">exists</a> <span class="delimiter">(</span><a title="MatrixExhaustiveness.this.Row" id="988132">r</a> =&gt; <a href="#987498" title="(row: MatrixExhaustiveness.this.Row, combos: List[ExhaustivenessChecker.this.Combo])Boolean">rowCoversCombo</a><span class="delimiter">(</span><a href="#988132" title="MatrixExhaustiveness.this.Row">r</a>, <a href="#988125" title="List[ExhaustivenessChecker.this.Combo]">combo</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>

      <span class="keyword">private</span> <span class="keyword">def</span> <a title="(xs: List[ExhaustivenessChecker.this.Combo], i: Int)String" id="987502">mkPad</a><span class="delimiter">(</span><a title="List[ExhaustivenessChecker.this.Combo]" id="988133">xs</a>: <a href="../../../collection/immutable/List.scala.html#12322" title="List[ExhaustivenessChecker.this.Combo]">List</a><span class="delimiter">[</span>Combo<span class="delimiter">]</span>, <a title="Int" id="988134">i</a>: <a href="../../../Int.scala.html#508" title="Int">Int</a><span class="delimiter">)</span>: <span title="String">String</span> = <a href="#988133" title="List[ExhaustivenessChecker.this.Combo]">xs</a> <span class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <a href="../../../collection/immutable/List.scala.html#11552" title="String" id="988183">Nil</a>                    =&gt; <a href="MatchSupport.scala.html#983805" title="(s: String)String">pad</a><a href="#988184" title="(x: String)String" class="delimiter">(</a><span title="String(&quot;*&quot;)" class="string">&quot;*&quot;</span><span class="delimiter">)</span>
        <span class="keyword">case</span> Combo<span class="delimiter">(</span>j, sym<span class="delimiter">)</span> <a href="#988179" title="String" id="988182">::</a> rest  =&gt; <a href="#988184" title="(x: String)String" class="keyword">if</a> <span class="delimiter">(</span>j <a href="../../../Int.scala.html#57891" title="(x: Int)Boolean">==</a> <a href="#988134" title="Int">i</a><span class="delimiter">)</span> <a href="MatchSupport.scala.html#983805" title="(s: String)String">pad</a><span class="delimiter">(</span>sym.<a href="../../../reflect/internal/Symbols.scala.html#443152" title="=&gt; MatrixAdditions.this.global.Symbol#NameType">name</a>.<a href="../../../Function1.scala.html#59562" title="()String">toString</a><span class="delimiter">)</span> <span class="keyword">else</span> <a href="#987502" title="(xs: List[ExhaustivenessChecker.this.Combo], i: Int)String">mkPad</a><span class="delimiter">(</span>rest, <a href="#988134" title="Int">i</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
      <span class="keyword">private</span> <span class="keyword">def</span> <a title="(open: List[ExhaustivenessChecker.this.Combo])String" id="987503">mkMissingStr</a><span class="delimiter">(</span><a title="List[ExhaustivenessChecker.this.Combo]" id="988192">open</a>: <a href="../../../collection/immutable/List.scala.html#12322" title="List[ExhaustivenessChecker.this.Combo]">List</a><span class="delimiter">[</span>Combo<span class="delimiter">]</span><span class="delimiter">)</span> =
        <a href="../../../Predef.scala.html#8578" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;missing combination %s\n&quot;</a> <a href="../../../collection/immutable/StringLike.scala.html#60730" title="(args: Any*)String">format</a> <a href="#987490" title="=&gt; MatrixExhaustiveness.this.context.PatternVarGroup">tvars</a>.<a href="Matrix.scala.html#986062" title="=&gt; scala.collection.immutable.Range">indices</a>.<a href="../../../collection/TraversableLike.scala.html#58971" title="(f: Int =&gt; String)(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq[Int],String,scala.collection.immutable.IndexedSeq[String]])scala.collection.immutable.IndexedSeq[String]">map</a><a href="../../../collection/immutable/IndexedSeq.scala.html#60844" title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.IndexedSeq.Coll,String,scala.collection.immutable.IndexedSeq[String]]" class="delimiter">(</a><a href="#987502" title="(xs: List[ExhaustivenessChecker.this.Combo], i: Int)String">mkPad</a><span class="delimiter">(</span><a href="#988192" title="List[ExhaustivenessChecker.this.Combo]">open</a>, <a href="#988218" title="Int">_</a><span class="delimiter">)</span><span class="delimiter">)</span>.<a href="../../../collection/TraversableOnce.scala.html#59191" title="=&gt; String">mkString</a>

      /** The only public method. */
      <span class="keyword">def</span> <a title="=&gt; MatrixExhaustiveness.this.Rep" id="987504">check</a> = <span class="delimiter">{</span>
        <span class="keyword">def</span> <a title="=&gt; String" id="988252">errMsg</a> = <span class="delimiter">(</span><a href="#987500" title="=&gt; List[List[ExhaustivenessChecker.this.Combo]]">inexhaustives</a> <a href="../../../collection/TraversableLike.scala.html#58971" title="(f: List[ExhaustivenessChecker.this.Combo] =&gt; String)(implicit bf: scala.collection.generic.CanBuildFrom[List[List[ExhaustivenessChecker.this.Combo]],String,List[String]])List[String]">map</a> <a href="#987503" title="(open: List[ExhaustivenessChecker.this.Combo])String">mkMissingStr</a><span class="delimiter">)</span>.<a href="../../../collection/TraversableOnce.scala.html#59191" title="=&gt; String">mkString</a>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#987500" title="=&gt; List[List[ExhaustivenessChecker.this.Combo]]">inexhaustives</a>.<a href="../../../collection/TraversableOnce.scala.html#59102" title="=&gt; Boolean">nonEmpty</a><span class="delimiter">)</span>
          <a href="Matrix.scala.html#985000" title="=&gt; MatrixAdditions.this.global.CompilationUnit">cunit</a>.<a href="../CompilationUnits.scala.html#560821" title="(pos: MatrixAdditions.this.global.Position, msg: String)Unit">warning</a><span class="delimiter">(</span><a href="#987562" title="MatrixAdditions.this.global.Position">matchPos</a>, <span title="String(&quot;match is not exhaustive!\n&quot;)" class="string">&quot;match is not exhaustive!\n&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#988252" title="=&gt; String">errMsg</a><span class="delimiter">)</span>

        <a href="#987561" title="MatrixExhaustiveness.this.Rep">rep</a>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span title="Object" class="delimiter">}</span>
<span title="Object" class="delimiter">}</span>
        </pre>
    </body>
</html>