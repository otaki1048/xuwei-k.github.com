<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>scala/tools/nsc/backend/msil/GenMSIL.scala</title>
        <script type="text/javascript" src="../../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
/* NSC -- new scala compiler
 * Copyright 2005-2011 LAMP/EPFL
 * @author Nikolay Mihaylov
 */


<span class="keyword">package</span> scala.tools.nsc
<span class="keyword">package</span> backend.msil

<span class="keyword">import</span> java.io.<span class="delimiter">{</span>File, IOException<span class="delimiter">}</span>
<span class="keyword">import</span> java.nio.<span class="delimiter">{</span>ByteBuffer, ByteOrder<span class="delimiter">}</span>
<span class="keyword">import</span> scala.collection.<span class="delimiter">{</span> mutable, immutable <span class="delimiter">}</span>
<span class="keyword">import</span> scala.tools.nsc.symtab._

<span class="keyword">import</span> ch.epfl.lamp.compiler.msil.<span class="delimiter">{</span>Type =&gt; MsilType, _<span class="delimiter">}</span>
<span class="keyword">import</span> ch.epfl.lamp.compiler.msil.emit._
<span class="keyword">import</span> ch.epfl.lamp.compiler.msil.util.PECustomMod
<span class="keyword">import</span> <a href="../../../../language.scala.html#2216" title="language.type">language</a>.postfixOps

<span class="keyword">abstract</span> <span class="keyword">class</span> <a title="class GenMSIL extends scala.tools.nsc.SubComponent" id="33075">GenMSIL</a> <a href="#33075" title="scala.tools.nsc.backend.msil.GenMSIL" class="keyword">extends</a> <a href="../../SubComponent.scala.html#27616" title="scala.tools.nsc.SubComponent">SubComponent</a> <span class="delimiter">{</span>
  <span class="keyword">import</span> <a href="../../SubComponent.scala.html#641784" title="=&gt; scala.tools.nsc.Global">global</a>._
  <span class="keyword">import</span> <a href="../../Global.scala.html#559567" title="=&gt; scala.tools.nsc.symtab.SymbolLoaders{val global: GenMSIL.this.global.type}">loaders</a>.clrTypes
  <span class="keyword">import</span> <a href="../../symtab/SymbolLoaders.scala.html#650372" title="GenMSIL.this.global.loaders.clrTypes.type">clrTypes</a>.<span class="delimiter">{</span>types, constructors, methods, fields<span class="delimiter">}</span>
  <span class="keyword">import</span> <a href="../../Global.scala.html#559502" title="GenMSIL.this.global.icodes.type">icodes</a>._
  <span class="keyword">import</span> <a href="../../Global.scala.html#559502" title="GenMSIL.this.global.icodes.type">icodes</a>.<a href="../icode/Opcodes.scala.html#642694" title="GenMSIL.this.global.icodes.opcodes.type">opcodes</a>._

  <span class="keyword">val</span> <a title="loaders extends scala.tools.nsc.symtab.SymbolLoaders" id="730486">x</a> = <a href="../../Global.scala.html#559567" title="=&gt; scala.tools.nsc.symtab.SymbolLoaders{val global: GenMSIL.this.global.type}">loaders</a>

  /** Create a new phase */
  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(p: scala.tools.nsc.Phase)GenMSIL.this.MsilPhase" id="730488">newPhase</a><span class="delimiter">(</span><a title="scala.tools.nsc.Phase" id="785460">p</a>: <a href="../../../../reflect/internal/Phase.scala.html#20058" title="scala.tools.nsc.Phase">Phase</a><span class="delimiter">)</span> = <span title="GenMSIL.this.MsilPhase" class="keyword">new</span> <a href="#730491" title="GenMSIL.this.MsilPhase">MsilPhase</a><span class="delimiter">(</span><a href="#785460" title="scala.tools.nsc.Phase">p</a><span class="delimiter">)</span>

  <span class="keyword">val</span> <a title="String" id="730489">phaseName</a> = <span title="String(&quot;msil&quot;)" class="string">&quot;msil&quot;</span>
  /** MSIL code generation phase
   */
  <span class="keyword">class</span> <a title="class MsilPhase extends GenMSIL.this.global.GlobalPhase" id="730491">MsilPhase</a><a href="#730491" title="GenMSIL.this.MsilPhase" class="delimiter">(</a><a title="scala.tools.nsc.Phase" id="785469">prev</a>: <a href="../../../../reflect/internal/Phase.scala.html#20058" title="scala.tools.nsc.Phase">Phase</a><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="../../Global.scala.html#559576" title="GenMSIL.this.global.GlobalPhase">GlobalPhase</a><span class="delimiter">(</span><a href="#785469" title="scala.tools.nsc.Phase">prev</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="=&gt; String" id="785464">name</a> = <a href="#730489" title="=&gt; String">phaseName</a>
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; Long" id="785465">newFlags</a> = <a href="../../SubComponent.scala.html#641793" title="=&gt; Long">phaseNewFlags</a>

    <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; Boolean" id="785466">erasedTypes</a> = <span title="Boolean(true)" class="keyword">true</span>

    <span class="keyword">override</span> <span class="keyword">def</span> <a title="()Unit" id="785467">run</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../Global.scala.html#559485" title="=&gt; scala.tools.nsc.Settings">settings</a>.<a href="../../settings/ScalaSettings.scala.html#467500" title="=&gt; scala.tools.nsc.Settings#BooleanSetting">debug</a>.<a href="../../settings/MutableSettings.scala.html#467820" title="=&gt; Boolean">value</a><span class="delimiter">)</span> <a href="../../Global.scala.html#559531" title="(msg: String)Unit">inform</a><span class="delimiter">(</span><span title="String(&quot;[running phase &quot;)" class="string">&quot;[running phase &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#785464" title="=&gt; String">name</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; on icode]&quot;)" class="string">&quot; on icode]&quot;</span><span class="delimiter">)</span>

      <span class="keyword">val</span> <a title="GenMSIL.this.BytecodeGenerator" id="785476">codeGenerator</a> = <span title="GenMSIL.this.BytecodeGenerator" class="keyword">new</span> <a href="#730492" title="GenMSIL.this.BytecodeGenerator">BytecodeGenerator</a>

      //classes is ICodes.classes, a HashMap[Symbol, IClass]
      <a href="../icode/ICodes.scala.html#642629" title="=&gt; scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.global.Symbol,GenMSIL.this.global.icodes.IClass]">classes</a>.<a href="../../../../collection/mutable/HashMap.scala.html#79218" title="=&gt; Iterable[GenMSIL.this.global.icodes.IClass]">values</a> <a href="../../../../collection/IterableLike.scala.html#59458" title="(f: GenMSIL.this.global.icodes.IClass =&gt; Unit)Unit">foreach</a> <a href="#785476" title="GenMSIL.this.BytecodeGenerator">codeGenerator</a>.<a href="#785644" title="(cls: GenMSIL.this.global.icodes.IClass)Unit">findEntryPoint</a>
      <span title="Unit" class="keyword">if</span><span class="delimiter">(</span> <a href="../../Global.scala.html#559558" title="GenMSIL.this.global.opt.type">opt</a>.<a href="../../Global.scala.html#561531" title="=&gt; Option[GenMSIL.this.global.Name]">showClass</a>.<a href="../../../../Option.scala.html#63812" title="=&gt; Boolean">isDefined</a> <a href="../../../../Boolean.scala.html#58725" title="(x: Boolean)Boolean">&amp;&amp;</a> <span class="delimiter">(</span><a href="#785476" title="GenMSIL.this.BytecodeGenerator">codeGenerator</a>.<a href="#785638" title="=&gt; GenMSIL.this.global.Symbol">entryPoint</a> <span title="(x$1: AnyRef)Boolean">==</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <span class="delimiter">)</span> <span class="delimiter">{</span> // TODO introduce dedicated setting instead
        <span class="keyword">val</span> <a title="String" id="785714">entryclass</a> = <a href="../../Global.scala.html#559558" title="GenMSIL.this.global.opt.type">opt</a>.<a href="../../Global.scala.html#561531" title="=&gt; Option[GenMSIL.this.global.Name]">showClass</a>.<a href="../../../../Option.scala.html#63813" title="=&gt; GenMSIL.this.global.Name">get</a>.<a href="../../../../Function1.scala.html#59562" title="()String">toString</a>
        <a href="../../Global.scala.html#559532" title="(msg: String)Unit">warning</a><span class="delimiter">(</span><span title="String(&quot;Couldn\'t find entry class &quot;)" class="string">&quot;Couldn't find entry class &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#785714" title="String">entryclass</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>

      <a href="#785476" title="GenMSIL.this.BytecodeGenerator">codeGenerator</a>.<a href="#785580" title="()Unit">initAssembly</a>

      <span class="keyword">val</span> <a title="List[GenMSIL.this.global.icodes.IClass]" id="785477">classesSorted</a> = <a href="../icode/ICodes.scala.html#642629" title="=&gt; scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.global.Symbol,GenMSIL.this.global.icodes.IClass]">classes</a>.<a href="../../../../collection/mutable/HashMap.scala.html#79218" title="=&gt; Iterable[GenMSIL.this.global.icodes.IClass]">values</a>.<a href="../../../../collection/TraversableOnce.scala.html#59174" title="=&gt; List[GenMSIL.this.global.icodes.IClass]">toList</a>.<a href="../../../../collection/SeqLike.scala.html#59827" title="(f: GenMSIL.this.global.icodes.IClass =&gt; Int)(implicit ord: scala.math.Ordering[Int])List[GenMSIL.this.global.icodes.IClass]">sortBy</a><a href="../../../../math/Ordering.scala.html#72458" title="scala.math.Ordering.Int.type" class="delimiter">(</a><a title="GenMSIL.this.global.icodes.IClass" id="785723">c</a> =&gt; <a href="#785723" title="GenMSIL.this.global.icodes.IClass">c</a>.<a href="../icode/Members.scala.html#642912" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443162" title="=&gt; Int">id</a><span class="delimiter">)</span> // simplifies comparing cross-compiler vs. .exe output
      <a href="#785477" title="List[GenMSIL.this.global.icodes.IClass]">classesSorted</a> <a href="../../../../collection/LinearSeqOptimized.scala.html#76166" title="(f: GenMSIL.this.global.icodes.IClass =&gt; Unit)Unit">foreach</a> <a href="#785476" title="GenMSIL.this.BytecodeGenerator">codeGenerator</a>.<a href="#785651" title="(iclass: GenMSIL.this.global.icodes.IClass)Unit">createTypeBuilder</a>
      <a href="#785477" title="List[GenMSIL.this.global.icodes.IClass]">classesSorted</a> <a href="../../../../collection/LinearSeqOptimized.scala.html#76166" title="(f: GenMSIL.this.global.icodes.IClass =&gt; Unit)Unit">foreach</a> <a href="#785476" title="GenMSIL.this.BytecodeGenerator">codeGenerator</a>.<a href="#785652" title="(iclass: GenMSIL.this.global.icodes.IClass)Unit">createClassMembers</a>

      <span class="keyword">try</span> <span class="delimiter">{</span>
        <a href="#785477" title="List[GenMSIL.this.global.icodes.IClass]">classesSorted</a> <a href="../../../../collection/LinearSeqOptimized.scala.html#76166" title="(f: GenMSIL.this.global.icodes.IClass =&gt; Unit)Unit">foreach</a> <a href="#785476" title="GenMSIL.this.BytecodeGenerator">codeGenerator</a>.<a href="#785587" title="(iclass: GenMSIL.this.global.icodes.IClass)Unit">genClass</a>
      <span class="delimiter">}</span> <span class="keyword">finally</span> <span class="delimiter">{</span>
        <a href="#785476" title="GenMSIL.this.BytecodeGenerator">codeGenerator</a>.<a href="#785584" title="()Unit">writeAssembly</a>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <span class="keyword">override</span> <span class="keyword">def</span> <a title="(unit: GenMSIL.this.global.CompilationUnit)Unit" id="785468">apply</a><span class="delimiter">(</span><a title="GenMSIL.this.global.CompilationUnit" id="785836">unit</a>: <a href="../../CompilationUnits.scala.html#559797" title="GenMSIL.this.global.CompilationUnit">CompilationUnit</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="../../Global.scala.html#559537" title="(msg: String)Nothing">abort</a><span class="delimiter">(</span><span title="String(&quot;MSIL works on icode classes, not on compilation units!&quot;)" class="string">&quot;MSIL works on icode classes, not on compilation units!&quot;</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  /**
   * MSIL bytecode generator.
   *
   */
  <span class="keyword">class</span> <a title="class BytecodeGenerator extends Object" id="730492">BytecodeGenerator</a> <a href="#730492" title="GenMSIL.this.BytecodeGenerator" class="delimiter">{</a>

    <span class="keyword">val</span> <a title="String" id="785488">MODULE_INSTANCE_NAME</a> = <span title="String(&quot;MODULE$&quot;)" class="string">&quot;MODULE$&quot;</span>

    <span class="keyword">import</span> <a href="../../symtab/SymbolLoaders.scala.html#650372" title="GenMSIL.this.global.loaders.clrTypes.type">clrTypes</a>.<span class="delimiter">{</span>VOID =&gt; MVOID, BOOLEAN =&gt; MBOOL, BYTE =&gt; MBYTE, SHORT =&gt; MSHORT,
                   CHAR =&gt; MCHAR, INT =&gt; MINT, LONG =&gt; MLONG, FLOAT =&gt; MFLOAT,
                   DOUBLE =&gt; MDOUBLE, OBJECT =&gt; MOBJECT, STRING =&gt; MSTRING,
                   STRING_ARRAY =&gt; MSTRING_ARRAY,
                   SYMTAB_CONSTR =&gt; SYMTAB_ATTRIBUTE_CONSTRUCTOR,
                   SYMTAB_DEFAULT_CONSTR =&gt; SYMTAB_ATTRIBUTE_EMPTY_CONSTRUCTOR<span class="delimiter">}</span>

    <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.Type" id="785491">EXCEPTION</a> = <a href="../../symtab/SymbolLoaders.scala.html#650372" title="GenMSIL.this.global.loaders.clrTypes.type">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#730911" title="(name: String)ch.epfl.lamp.compiler.msil.Type">getType</a><span class="delimiter">(</span><span title="String(&quot;System.Exception&quot;)" class="string">&quot;System.Exception&quot;</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.Type" id="785493">MBYTE_ARRAY</a> = <a href="../../symtab/SymbolLoaders.scala.html#650372" title="GenMSIL.this.global.loaders.clrTypes.type">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#730913" title="(elemType: ch.epfl.lamp.compiler.msil.Type)ch.epfl.lamp.compiler.msil.Type">mkArrayType</a><span class="delimiter">(</span><a href="../../symtab/clr/CLRTypes.scala.html#730821" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MBYTE</a><span class="delimiter">)</span>

    <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.Type" id="785495">ICLONEABLE</a> = <a href="../../symtab/SymbolLoaders.scala.html#650372" title="GenMSIL.this.global.loaders.clrTypes.type">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#730911" title="(name: String)ch.epfl.lamp.compiler.msil.Type">getType</a><span class="delimiter">(</span><span title="String(&quot;System.ICloneable&quot;)" class="string">&quot;System.ICloneable&quot;</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.MethodInfo" id="785497">MEMBERWISE_CLONE</a> = <a href="../../symtab/clr/CLRTypes.scala.html#730866" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MOBJECT</a>.<span title="(x$1: String, x$2: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.MethodInfo">GetMethod</span><span class="delimiter">(</span><span title="String(&quot;MemberwiseClone&quot;)" class="string">&quot;MemberwiseClone&quot;</span>, <span title="ch.epfl.lamp.compiler.msil.Type.type">MsilType</span>.<span title="Array[ch.epfl.lamp.compiler.msil.Type]">EmptyTypes</span><span class="delimiter">)</span>

    <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.Type" id="785499">MMONITOR</a>       = <a href="../../symtab/SymbolLoaders.scala.html#650372" title="GenMSIL.this.global.loaders.clrTypes.type">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#730911" title="(name: String)ch.epfl.lamp.compiler.msil.Type">getType</a><span class="delimiter">(</span><span title="String(&quot;System.Threading.Monitor&quot;)" class="string">&quot;System.Threading.Monitor&quot;</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.MethodInfo" id="785501">MMONITOR_ENTER</a> = <a href="#785499" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MMONITOR</a>.<span title="(x$1: String, x$2: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.MethodInfo">GetMethod</span><span class="delimiter">(</span><span title="String(&quot;Enter&quot;)" class="string">&quot;Enter&quot;</span>, <a href="../../../../Array.scala.html#68728" title="(xs: ch.epfl.lamp.compiler.msil.Type*)(implicit evidence$2: scala.reflect.ArrayTag[ch.epfl.lamp.compiler.msil.Type])Array[ch.epfl.lamp.compiler.msil.Type]">Array</a><a href="../../../../reflect/ClassTag.scala.html#61898" title="(erasure1: Class[_])scala.reflect.ClassTag[ch.epfl.lamp.compiler.msil.Type]" class="delimiter">(</a><a href="../../symtab/clr/CLRTypes.scala.html#730866" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MOBJECT</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.MethodInfo" id="785503">MMONITOR_EXIT</a>  = <a href="#785499" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MMONITOR</a>.<span title="(x$1: String, x$2: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.MethodInfo">GetMethod</span><span class="delimiter">(</span><span title="String(&quot;Exit&quot;)" class="string">&quot;Exit&quot;</span>, <a href="../../../../Array.scala.html#68728" title="(xs: ch.epfl.lamp.compiler.msil.Type*)(implicit evidence$2: scala.reflect.ArrayTag[ch.epfl.lamp.compiler.msil.Type])Array[ch.epfl.lamp.compiler.msil.Type]">Array</a><a href="../../../../reflect/ClassTag.scala.html#61898" title="(erasure1: Class[_])scala.reflect.ClassTag[ch.epfl.lamp.compiler.msil.Type]" class="delimiter">(</a><a href="../../symtab/clr/CLRTypes.scala.html#730866" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MOBJECT</a><span class="delimiter">)</span><span class="delimiter">)</span>

    <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.Type" id="785505">MSTRING_BUILDER</a> = <a href="../../symtab/SymbolLoaders.scala.html#650372" title="GenMSIL.this.global.loaders.clrTypes.type">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#730911" title="(name: String)ch.epfl.lamp.compiler.msil.Type">getType</a><span class="delimiter">(</span><span title="String(&quot;System.Text.StringBuilder&quot;)" class="string">&quot;System.Text.StringBuilder&quot;</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.ConstructorInfo" id="785507">MSTRING_BUILDER_CONSTR</a> = <a href="#785505" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MSTRING_BUILDER</a>.<span title="(x$1: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.ConstructorInfo">GetConstructor</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.Type.type">MsilType</span>.<span title="Array[ch.epfl.lamp.compiler.msil.Type]">EmptyTypes</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.MethodInfo" id="785509">MSTRING_BUILDER_TOSTRING</a> = <a href="#785505" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MSTRING_BUILDER</a>.<span title="(x$1: String, x$2: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.MethodInfo">GetMethod</span><span class="delimiter">(</span><span title="String(&quot;ToString&quot;)" class="string">&quot;ToString&quot;</span>,
                                                             <span title="ch.epfl.lamp.compiler.msil.Type.type">MsilType</span>.<span title="Array[ch.epfl.lamp.compiler.msil.Type]">EmptyTypes</span><span class="delimiter">)</span>

    <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.MethodInfo" id="785511">TYPE_FROM_HANDLE</a> =
      <a href="../../symtab/SymbolLoaders.scala.html#650372" title="GenMSIL.this.global.loaders.clrTypes.type">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#730911" title="(name: String)ch.epfl.lamp.compiler.msil.Type">getType</a><span class="delimiter">(</span><span title="String(&quot;System.Type&quot;)" class="string">&quot;System.Type&quot;</span><span class="delimiter">)</span>.<span title="(x$1: String, x$2: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.MethodInfo">GetMethod</span><span class="delimiter">(</span><span title="String(&quot;GetTypeFromHandle&quot;)" class="string">&quot;GetTypeFromHandle&quot;</span>, <a href="../../../../Array.scala.html#68728" title="(xs: ch.epfl.lamp.compiler.msil.Type*)(implicit evidence$2: scala.reflect.ArrayTag[ch.epfl.lamp.compiler.msil.Type])Array[ch.epfl.lamp.compiler.msil.Type]">Array</a><a href="../../../../reflect/ClassTag.scala.html#61898" title="(erasure1: Class[_])scala.reflect.ClassTag[ch.epfl.lamp.compiler.msil.Type]" class="delimiter">(</a><a href="../../symtab/SymbolLoaders.scala.html#650372" title="GenMSIL.this.global.loaders.clrTypes.type">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#730911" title="(name: String)ch.epfl.lamp.compiler.msil.Type">getType</a><span class="delimiter">(</span><span title="String(&quot;System.RuntimeTypeHandle&quot;)" class="string">&quot;System.RuntimeTypeHandle&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>

    <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.Type" id="785513">INT_PTR</a> = <a href="../../symtab/SymbolLoaders.scala.html#650372" title="GenMSIL.this.global.loaders.clrTypes.type">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#730911" title="(name: String)ch.epfl.lamp.compiler.msil.Type">getType</a><span class="delimiter">(</span><span title="String(&quot;System.IntPtr&quot;)" class="string">&quot;System.IntPtr&quot;</span><span class="delimiter">)</span>

    <span class="keyword">val</span> <a title="GenMSIL.this.global.ClassSymbol" id="785515">JOBJECT</a> = <a href="../../../../reflect/internal/Definitions.scala.html#441641" title="GenMSIL.this.global.definitions.type">definitions</a>.<a href="../../../../reflect/internal/Definitions.scala.html#442179" title="=&gt; GenMSIL.this.global.ClassSymbol">ObjectClass</a>
    <span class="keyword">val</span> <a title="GenMSIL.this.global.ClassSymbol" id="785517">JSTRING</a> = <a href="../../../../reflect/internal/Definitions.scala.html#441641" title="GenMSIL.this.global.definitions.type">definitions</a>.<a href="../../../../reflect/internal/Definitions.scala.html#442219" title="=&gt; GenMSIL.this.global.ClassSymbol">StringClass</a>

    <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.Type" id="785519">SystemConvert</a> = <a href="../../symtab/SymbolLoaders.scala.html#650372" title="GenMSIL.this.global.loaders.clrTypes.type">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#730911" title="(name: String)ch.epfl.lamp.compiler.msil.Type">getType</a><span class="delimiter">(</span><span title="String(&quot;System.Convert&quot;)" class="string">&quot;System.Convert&quot;</span><span class="delimiter">)</span>

    <span class="keyword">val</span> <a title="Array[ch.epfl.lamp.compiler.msil.Type]" id="785521">objParam</a> = <a href="../../../../Array.scala.html#68728" title="(xs: ch.epfl.lamp.compiler.msil.Type*)(implicit evidence$2: scala.reflect.ArrayTag[ch.epfl.lamp.compiler.msil.Type])Array[ch.epfl.lamp.compiler.msil.Type]">Array</a><a href="../../../../reflect/ClassTag.scala.html#61898" title="(erasure1: Class[_])scala.reflect.ClassTag[ch.epfl.lamp.compiler.msil.Type]" class="delimiter">(</a><a href="../../symtab/clr/CLRTypes.scala.html#730866" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MOBJECT</a><span class="delimiter">)</span>

    <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.MethodInfo" id="785523">toBool</a>:   <span title="ch.epfl.lamp.compiler.msil.MethodInfo">MethodInfo</span> = <a href="#785519" title="=&gt; ch.epfl.lamp.compiler.msil.Type">SystemConvert</a>.<span title="(x$1: String, x$2: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.MethodInfo">GetMethod</span><span class="delimiter">(</span><span title="String(&quot;ToBoolean&quot;)" class="string">&quot;ToBoolean&quot;</span>, <a href="#785521" title="=&gt; Array[ch.epfl.lamp.compiler.msil.Type]">objParam</a><span class="delimiter">)</span> // see comment in emitUnbox
    <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.MethodInfo" id="785525">toSByte</a>:  <span title="ch.epfl.lamp.compiler.msil.MethodInfo">MethodInfo</span> = <a href="#785519" title="=&gt; ch.epfl.lamp.compiler.msil.Type">SystemConvert</a>.<span title="(x$1: String, x$2: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.MethodInfo">GetMethod</span><span class="delimiter">(</span><span title="String(&quot;ToSByte&quot;)" class="string">&quot;ToSByte&quot;</span>,   <a href="#785521" title="=&gt; Array[ch.epfl.lamp.compiler.msil.Type]">objParam</a><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.MethodInfo" id="785527">toShort</a>:  <span title="ch.epfl.lamp.compiler.msil.MethodInfo">MethodInfo</span> = <a href="#785519" title="=&gt; ch.epfl.lamp.compiler.msil.Type">SystemConvert</a>.<span title="(x$1: String, x$2: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.MethodInfo">GetMethod</span><span class="delimiter">(</span><span title="String(&quot;ToInt16&quot;)" class="string">&quot;ToInt16&quot;</span>,   <a href="#785521" title="=&gt; Array[ch.epfl.lamp.compiler.msil.Type]">objParam</a><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.MethodInfo" id="785529">toChar</a>:   <span title="ch.epfl.lamp.compiler.msil.MethodInfo">MethodInfo</span> = <a href="#785519" title="=&gt; ch.epfl.lamp.compiler.msil.Type">SystemConvert</a>.<span title="(x$1: String, x$2: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.MethodInfo">GetMethod</span><span class="delimiter">(</span><span title="String(&quot;ToChar&quot;)" class="string">&quot;ToChar&quot;</span>,    <a href="#785521" title="=&gt; Array[ch.epfl.lamp.compiler.msil.Type]">objParam</a><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.MethodInfo" id="785531">toInt</a>:    <span title="ch.epfl.lamp.compiler.msil.MethodInfo">MethodInfo</span> = <a href="#785519" title="=&gt; ch.epfl.lamp.compiler.msil.Type">SystemConvert</a>.<span title="(x$1: String, x$2: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.MethodInfo">GetMethod</span><span class="delimiter">(</span><span title="String(&quot;ToInt32&quot;)" class="string">&quot;ToInt32&quot;</span>,   <a href="#785521" title="=&gt; Array[ch.epfl.lamp.compiler.msil.Type]">objParam</a><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.MethodInfo" id="785533">toLong</a>:   <span title="ch.epfl.lamp.compiler.msil.MethodInfo">MethodInfo</span> = <a href="#785519" title="=&gt; ch.epfl.lamp.compiler.msil.Type">SystemConvert</a>.<span title="(x$1: String, x$2: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.MethodInfo">GetMethod</span><span class="delimiter">(</span><span title="String(&quot;ToInt64&quot;)" class="string">&quot;ToInt64&quot;</span>,   <a href="#785521" title="=&gt; Array[ch.epfl.lamp.compiler.msil.Type]">objParam</a><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.MethodInfo" id="785535">toFloat</a>:  <span title="ch.epfl.lamp.compiler.msil.MethodInfo">MethodInfo</span> = <a href="#785519" title="=&gt; ch.epfl.lamp.compiler.msil.Type">SystemConvert</a>.<span title="(x$1: String, x$2: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.MethodInfo">GetMethod</span><span class="delimiter">(</span><span title="String(&quot;ToSingle&quot;)" class="string">&quot;ToSingle&quot;</span>,  <a href="#785521" title="=&gt; Array[ch.epfl.lamp.compiler.msil.Type]">objParam</a><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.MethodInfo" id="785537">toDouble</a>: <span title="ch.epfl.lamp.compiler.msil.MethodInfo">MethodInfo</span> = <a href="#785519" title="=&gt; ch.epfl.lamp.compiler.msil.Type">SystemConvert</a>.<span title="(x$1: String, x$2: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.MethodInfo">GetMethod</span><span class="delimiter">(</span><span title="String(&quot;ToDouble&quot;)" class="string">&quot;ToDouble&quot;</span>,  <a href="#785521" title="=&gt; Array[ch.epfl.lamp.compiler.msil.Type]">objParam</a><span class="delimiter">)</span>

    //val boxedUnit: FieldInfo = msilType(definitions.BoxedUnitModule.info).GetField(&quot;UNIT&quot;)
    <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.FieldInfo" id="785539">boxedUnit</a>: <span title="ch.epfl.lamp.compiler.msil.FieldInfo">FieldInfo</span> = <a href="../../../../collection/MapLike.scala.html#78420" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol)ch.epfl.lamp.compiler.msil.FieldInfo">fields</a><span class="delimiter">(</span><a href="../../../../reflect/internal/Definitions.scala.html#441641" title="GenMSIL.this.global.definitions.type">definitions</a>.<a href="../../../../reflect/internal/Definitions.scala.html#442627" title="=&gt; GenMSIL.this.global.Symbol">BoxedUnit_UNIT</a><span class="delimiter">)</span>

    // Scala attributes
    // symtab.Definitions -&gt; object (singleton..)
    <span class="keyword">val</span> <a title="GenMSIL.this.global.Type" id="785541">SerializableAttr</a> = <a href="../../../../reflect/internal/Definitions.scala.html#441641" title="GenMSIL.this.global.definitions.type">definitions</a>.<a href="../../../../reflect/internal/Definitions.scala.html#442645" title="=&gt; GenMSIL.this.global.ClassSymbol">SerializableAttr</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443721" title="=&gt; GenMSIL.this.global.Type">tpe</a>
    <span class="keyword">val</span> <a title="GenMSIL.this.global.Type" id="785543">CloneableAttr</a>    = <a href="../../../../reflect/internal/Definitions.scala.html#441641" title="GenMSIL.this.global.definitions.type">definitions</a>.<a href="../../../../reflect/internal/Definitions.scala.html#442661" title="=&gt; GenMSIL.this.global.ClassSymbol">CloneableAttr</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443721" title="=&gt; GenMSIL.this.global.Type">tpe</a>
    <span class="keyword">val</span> <a title="GenMSIL.this.global.Type" id="785545">TransientAtt</a>     = <a href="../../../../reflect/internal/Definitions.scala.html#441641" title="GenMSIL.this.global.definitions.type">definitions</a>.<a href="../../../../reflect/internal/Definitions.scala.html#442681" title="=&gt; GenMSIL.this.global.ClassSymbol">TransientAttr</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443721" title="=&gt; GenMSIL.this.global.Type">tpe</a>
    // remoting: the architectures are too different, no mapping (no portable code
    // possible)

    // java instance methods that are mapped to static methods in .net
    // these will need to be called with OpCodes.Call (not Callvirt)
    <span class="keyword">val</span> <a title="scala.collection.mutable.HashSet[GenMSIL.this.global.Symbol]" id="785547">dynToStatMapped</a> = mutable.<a href="../../../../collection/generic/GenericCompanion.scala.html#60782" title="[A](elems: A*)scala.collection.mutable.HashSet[A]">HashSet</a><span title="(elems: GenMSIL.this.global.Symbol*)scala.collection.mutable.HashSet[GenMSIL.this.global.Symbol]" class="delimiter">[</span><a href="../../../../reflect/internal/Symbols.scala.html#441132" title="GenMSIL.this.global.Symbol">Symbol</a><span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>

    <a href="#785549" title="()Unit">initMappings</a><span class="delimiter">(</span><span class="delimiter">)</span>

    /** Create the mappings between java and .net classes and methods */
    <span class="keyword">private</span> <span class="keyword">def</span> <a title="()Unit" id="785549">initMappings</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#785650" title="(sym: GenMSIL.this.global.Symbol, mType: ch.epfl.lamp.compiler.msil.Type)Unit">mapType</a><span class="delimiter">(</span><a href="../../../../reflect/internal/Definitions.scala.html#441641" title="GenMSIL.this.global.definitions.type">definitions</a>.<a href="../../../../reflect/internal/Definitions.scala.html#442175" title="=&gt; GenMSIL.this.global.ClassSymbol">AnyClass</a>, <a href="../../symtab/clr/CLRTypes.scala.html#730866" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MOBJECT</a><span class="delimiter">)</span>
      <a href="#785650" title="(sym: GenMSIL.this.global.Symbol, mType: ch.epfl.lamp.compiler.msil.Type)Unit">mapType</a><span class="delimiter">(</span><a href="../../../../reflect/internal/Definitions.scala.html#441641" title="GenMSIL.this.global.definitions.type">definitions</a>.<a href="../../../../reflect/internal/Definitions.scala.html#442177" title="=&gt; GenMSIL.this.global.AliasTypeSymbol">AnyRefClass</a>, <a href="../../symtab/clr/CLRTypes.scala.html#730866" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MOBJECT</a><span class="delimiter">)</span>
      //mapType(definitions.NullClass, clrTypes.getType(&quot;scala.AllRef$&quot;))
      //mapType(definitions.NothingClass, clrTypes.getType(&quot;scala.All$&quot;))
      // FIXME: for some reason the upper two lines map to null
      <a href="#785650" title="(sym: GenMSIL.this.global.Symbol, mType: ch.epfl.lamp.compiler.msil.Type)Unit">mapType</a><span class="delimiter">(</span><a href="../../../../reflect/internal/Definitions.scala.html#441641" title="GenMSIL.this.global.definitions.type">definitions</a>.<a href="../../../../reflect/internal/Definitions.scala.html#442195" title="GenMSIL.this.global.definitions.NullClass.type">NullClass</a>, <a href="#785491" title="=&gt; ch.epfl.lamp.compiler.msil.Type">EXCEPTION</a><span class="delimiter">)</span>
      <a href="#785650" title="(sym: GenMSIL.this.global.Symbol, mType: ch.epfl.lamp.compiler.msil.Type)Unit">mapType</a><span class="delimiter">(</span><a href="../../../../reflect/internal/Definitions.scala.html#441641" title="GenMSIL.this.global.definitions.type">definitions</a>.<a href="../../../../reflect/internal/Definitions.scala.html#442193" title="GenMSIL.this.global.definitions.NothingClass.type">NothingClass</a>, <a href="#785491" title="=&gt; ch.epfl.lamp.compiler.msil.Type">EXCEPTION</a><span class="delimiter">)</span>

      <a href="#785650" title="(sym: GenMSIL.this.global.Symbol, mType: ch.epfl.lamp.compiler.msil.Type)Unit">mapType</a><span class="delimiter">(</span><a href="../../../../reflect/internal/Definitions.scala.html#441641" title="GenMSIL.this.global.definitions.type">definitions</a>.<a href="../../../../reflect/internal/Definitions.scala.html#442857" title="=&gt; GenMSIL.this.global.ClassSymbol">BooleanClass</a>, <a href="../../symtab/clr/CLRTypes.scala.html#730854" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MBOOL</a><span class="delimiter">)</span>
      <a href="#785650" title="(sym: GenMSIL.this.global.Symbol, mType: ch.epfl.lamp.compiler.msil.Type)Unit">mapType</a><span class="delimiter">(</span><a href="../../../../reflect/internal/Definitions.scala.html#441641" title="GenMSIL.this.global.definitions.type">definitions</a>.<a href="../../../../reflect/internal/Definitions.scala.html#442843" title="=&gt; GenMSIL.this.global.ClassSymbol">ByteClass</a>, <a href="../../symtab/clr/CLRTypes.scala.html#730821" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MBYTE</a><span class="delimiter">)</span>
      <a href="#785650" title="(sym: GenMSIL.this.global.Symbol, mType: ch.epfl.lamp.compiler.msil.Type)Unit">mapType</a><span class="delimiter">(</span><a href="../../../../reflect/internal/Definitions.scala.html#441641" title="GenMSIL.this.global.definitions.type">definitions</a>.<a href="../../../../reflect/internal/Definitions.scala.html#442845" title="=&gt; GenMSIL.this.global.ClassSymbol">ShortClass</a>, <a href="../../symtab/clr/CLRTypes.scala.html#730827" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MSHORT</a><span class="delimiter">)</span>
      <a href="#785650" title="(sym: GenMSIL.this.global.Symbol, mType: ch.epfl.lamp.compiler.msil.Type)Unit">mapType</a><span class="delimiter">(</span><a href="../../../../reflect/internal/Definitions.scala.html#441641" title="GenMSIL.this.global.definitions.type">definitions</a>.<a href="../../../../reflect/internal/Definitions.scala.html#442847" title="=&gt; GenMSIL.this.global.ClassSymbol">CharClass</a>, <a href="../../symtab/clr/CLRTypes.scala.html#730833" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MCHAR</a><span class="delimiter">)</span>
      <a href="#785650" title="(sym: GenMSIL.this.global.Symbol, mType: ch.epfl.lamp.compiler.msil.Type)Unit">mapType</a><span class="delimiter">(</span><a href="../../../../reflect/internal/Definitions.scala.html#441641" title="GenMSIL.this.global.definitions.type">definitions</a>.<a href="../../../../reflect/internal/Definitions.scala.html#442849" title="=&gt; GenMSIL.this.global.ClassSymbol">IntClass</a>, <a href="../../symtab/clr/CLRTypes.scala.html#730836" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MINT</a><span class="delimiter">)</span>
      <a href="#785650" title="(sym: GenMSIL.this.global.Symbol, mType: ch.epfl.lamp.compiler.msil.Type)Unit">mapType</a><span class="delimiter">(</span><a href="../../../../reflect/internal/Definitions.scala.html#441641" title="GenMSIL.this.global.definitions.type">definitions</a>.<a href="../../../../reflect/internal/Definitions.scala.html#442851" title="=&gt; GenMSIL.this.global.ClassSymbol">LongClass</a>, <a href="../../symtab/clr/CLRTypes.scala.html#730842" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MLONG</a><span class="delimiter">)</span>
      <a href="#785650" title="(sym: GenMSIL.this.global.Symbol, mType: ch.epfl.lamp.compiler.msil.Type)Unit">mapType</a><span class="delimiter">(</span><a href="../../../../reflect/internal/Definitions.scala.html#441641" title="GenMSIL.this.global.definitions.type">definitions</a>.<a href="../../../../reflect/internal/Definitions.scala.html#442853" title="=&gt; GenMSIL.this.global.ClassSymbol">FloatClass</a>, <a href="../../symtab/clr/CLRTypes.scala.html#730848" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MFLOAT</a><span class="delimiter">)</span>
      <a href="#785650" title="(sym: GenMSIL.this.global.Symbol, mType: ch.epfl.lamp.compiler.msil.Type)Unit">mapType</a><span class="delimiter">(</span><a href="../../../../reflect/internal/Definitions.scala.html#441641" title="GenMSIL.this.global.definitions.type">definitions</a>.<a href="../../../../reflect/internal/Definitions.scala.html#442855" title="=&gt; GenMSIL.this.global.ClassSymbol">DoubleClass</a>, <a href="../../symtab/clr/CLRTypes.scala.html#730851" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MDOUBLE</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="keyword">var</span> <a title="GenMSIL.this.global.icodes.IClass" id="785551">clasz</a>: <a href="../icode/Members.scala.html#642676" title="GenMSIL.this.global.icodes.IClass">IClass</a> = _
    <span class="keyword">var</span> <a title="GenMSIL.this.global.icodes.IMethod" id="785554">method</a>: <a href="../icode/Members.scala.html#642680" title="GenMSIL.this.global.icodes.IMethod">IMethod</a> = _

    <span class="keyword">var</span> <a title="ch.epfl.lamp.compiler.msil.emit.AssemblyBuilder" id="785557">massembly</a>: <span title="ch.epfl.lamp.compiler.msil.emit.AssemblyBuilder">AssemblyBuilder</span> = _
    <span class="keyword">var</span> <a title="ch.epfl.lamp.compiler.msil.emit.ModuleBuilder" id="785560">mmodule</a>: <span title="ch.epfl.lamp.compiler.msil.emit.ModuleBuilder">ModuleBuilder</span> = _
    <span class="keyword">var</span> <a title="ch.epfl.lamp.compiler.msil.emit.ILGenerator" id="785563">mcode</a>: <span title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">ILGenerator</span> = _

    <span class="keyword">var</span> <a title="String" id="785566">assemName</a>: <span title="String">String</span> = _
    <span class="keyword">var</span> <a title="String" id="785569">firstSourceName</a> = <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span>
    <span class="keyword">var</span> <a title="java.io.File" id="785572">outDir</a>: <span title="java.io.File">File</span> = _
    <span class="keyword">var</span> <a title="java.io.File" id="785575">srcPath</a>: <span title="java.io.File">File</span> = _
    <span class="keyword">var</span> <a title="String" id="785578">moduleName</a>: <span title="String">String</span> = _

    <span class="keyword">def</span> <a title="()Unit" id="785580">initAssembly</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>

      <a href="#785566" title="(x$1: String)Unit">assemName</a> = <a href="../../Global.scala.html#559485" title="=&gt; scala.tools.nsc.Settings">settings</a>.<a href="../../settings/ScalaSettings.scala.html#467398" title="=&gt; scala.tools.nsc.Settings#StringSetting">assemname</a>.<a href="../../../../reflect/internal/settings/MutableSettings.scala.html#456449" title="=&gt; String">value</a>

      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#785566" title="=&gt; String">assemName</a> <span title="(x$1: AnyRef)Boolean">==</span> <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#785638" title="=&gt; GenMSIL.this.global.Symbol">entryPoint</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="#785566" title="(x$1: String)Unit">assemName</a> = <a href="#785633" title="(sym: GenMSIL.this.global.Symbol)String">msilName</a><span class="delimiter">(</span><a href="#785638" title="=&gt; GenMSIL.this.global.Symbol">entryPoint</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443480" title="=&gt; GenMSIL.this.global.Symbol">enclClass</a><span class="delimiter">)</span>
          // remove the $ at the end (from module-name)
          <a href="#785566" title="(x$1: String)Unit">assemName</a> = <a href="#785566" title="=&gt; String">assemName</a>.<span title="(x$1: Int, x$2: Int)String">substring</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span>, <a href="#785566" title="=&gt; String">assemName</a>.<span title="()Int">length</span><span class="delimiter">(</span><span class="delimiter">)</span> <a href="../../../../Int.scala.html#57955" title="(x: Int)Int">-</a> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
        <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
          // assuming filename of first source file
          <a href="../../Global.scala.html#559533" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a><span class="delimiter">(</span><a href="#785569" title="=&gt; String">firstSourceName</a>.<span title="(x$1: String)Boolean">endsWith</span><span class="delimiter">(</span><span title="String(&quot;.scala&quot;)" class="string">&quot;.scala&quot;</span><span class="delimiter">)</span>, <a href="#785569" title="=&gt; String">firstSourceName</a><span class="delimiter">)</span>
          <a href="#785566" title="(x$1: String)Unit">assemName</a> = <a href="#785569" title="=&gt; String">firstSourceName</a>.<span title="(x$1: Int, x$2: Int)String">substring</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span>, <a href="#785569" title="=&gt; String">firstSourceName</a>.<span title="()Int">length</span><span class="delimiter">(</span><span class="delimiter">)</span> <a href="../../../../Int.scala.html#57955" title="(x: Int)Int">-</a> <span title="Int(6)" class="int">6</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#785566" title="=&gt; String">assemName</a>.<span title="(x$1: String)Boolean">endsWith</span><span class="delimiter">(</span><span title="String(&quot;.msil&quot;)" class="string">&quot;.msil&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
          <a href="#785566" title="(x$1: String)Unit">assemName</a> = <a href="#785566" title="=&gt; String">assemName</a>.<span title="(x$1: Int, x$2: Int)String">substring</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span>, <a href="#785566" title="=&gt; String">assemName</a>.<span title="()Int">length</span><span class="delimiter">(</span><span class="delimiter">)</span><a href="../../../../Int.scala.html#57955" title="(x: Int)Int">-</a><span title="Int(5)" class="int">5</span><span class="delimiter">)</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#785566" title="=&gt; String">assemName</a>.<span title="(x$1: String)Boolean">endsWith</span><span class="delimiter">(</span><span title="String(&quot;.il&quot;)" class="string">&quot;.il&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
          <a href="#785566" title="(x$1: String)Unit">assemName</a> = <a href="#785566" title="=&gt; String">assemName</a>.<span title="(x$1: Int, x$2: Int)String">substring</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span>, <a href="#785566" title="=&gt; String">assemName</a>.<span title="()Int">length</span><span class="delimiter">(</span><span class="delimiter">)</span><a href="../../../../Int.scala.html#57955" title="(x: Int)Int">-</a><span title="Int(3)" class="int">3</span><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="java.io.File" id="786545">f</a>: <span title="java.io.File">File</span> = <span title="java.io.File" class="keyword">new</span> <span title="java.io.File">File</span><span class="delimiter">(</span><a href="#785566" title="=&gt; String">assemName</a><span class="delimiter">)</span>
        <a href="#785566" title="(x$1: String)Unit">assemName</a> = <a href="#786545" title="java.io.File">f</a>.<span title="()String">getName</span><span class="delimiter">(</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>

      <a href="#785572" title="(x$1: java.io.File)Unit">outDir</a> = <span title="java.io.File" class="keyword">new</span> <span title="java.io.File">File</span><span class="delimiter">(</span><a href="../../Global.scala.html#559485" title="=&gt; scala.tools.nsc.Settings">settings</a>.<a href="../../settings/ScalaSettings.scala.html#467478" title="=&gt; scala.tools.nsc.Settings#OutputSetting">outdir</a>.<a href="../../../../reflect/internal/settings/MutableSettings.scala.html#456449" title="=&gt; String">value</a><span class="delimiter">)</span>

      <a href="#785575" title="(x$1: java.io.File)Unit">srcPath</a> = <span title="java.io.File" class="keyword">new</span> <span title="java.io.File">File</span><span class="delimiter">(</span><a href="../../Global.scala.html#559485" title="=&gt; scala.tools.nsc.Settings">settings</a>.<a href="../../settings/ScalaSettings.scala.html#467404" title="=&gt; scala.tools.nsc.Settings#StringSetting">sourcedir</a>.<a href="../../../../reflect/internal/settings/MutableSettings.scala.html#456449" title="=&gt; String">value</a><span class="delimiter">)</span>

      <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.AssemblyName" id="786511">assemblyName</a> = <span title="ch.epfl.lamp.compiler.msil.AssemblyName" class="keyword">new</span> <span title="ch.epfl.lamp.compiler.msil.AssemblyName">AssemblyName</span><span class="delimiter">(</span><span class="delimiter">)</span>
      <a href="#786511" title="ch.epfl.lamp.compiler.msil.AssemblyName">assemblyName</a>.<span title="String">Name</span> = <a href="#785566" title="=&gt; String">assemName</a>
      <a href="#785557" title="(x$1: ch.epfl.lamp.compiler.msil.emit.AssemblyBuilder)Unit">massembly</a> = <span title="ch.epfl.lamp.compiler.msil.emit.AssemblyBuilderFactory.type">AssemblyBuilderFactory</span>.<span title="(name: ch.epfl.lamp.compiler.msil.AssemblyName)ch.epfl.lamp.compiler.msil.emit.AssemblyBuilder">DefineDynamicAssembly</span><span class="delimiter">(</span><a href="#786511" title="ch.epfl.lamp.compiler.msil.AssemblyName">assemblyName</a><span class="delimiter">)</span>

      <a href="#785578" title="(x$1: String)Unit">moduleName</a> = <a href="#785566" title="=&gt; String">assemName</a> // + (if (entryPoint == null) &quot;.dll&quot; else &quot;.exe&quot;)
      // filename here: .dll or .exe (in both parameters), second: give absolute-path
      <a href="#785560" title="(x$1: ch.epfl.lamp.compiler.msil.emit.ModuleBuilder)Unit">mmodule</a> = <a href="#785557" title="=&gt; ch.epfl.lamp.compiler.msil.emit.AssemblyBuilder">massembly</a>.<span title="(name: String, fileName: String)ch.epfl.lamp.compiler.msil.emit.ModuleBuilder">DefineDynamicModule</span><span class="delimiter">(</span><a href="#785578" title="=&gt; String">moduleName</a>,
                                              <span title="(x$1: java.io.File, x$2: String)java.io.File" class="keyword">new</span> <span title="java.io.File">File</span><span class="delimiter">(</span><a href="#785572" title="=&gt; java.io.File">outDir</a>, <a href="#785578" title="=&gt; String">moduleName</a><span class="delimiter">)</span>.<span title="()String">getAbsolutePath</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="../../Global.scala.html#559534" title="(assertion: Boolean)Unit">assert</a> <span class="delimiter">(</span><a href="#785560" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ModuleBuilder">mmodule</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>


    /**
     * Form of the custom Attribute parameter (Ecma-335.pdf)
     *      - p. 163 for CustomAttrib Form,
     *      - p. 164 for FixedArg Form (Array and Element) (if array or not is known!)
     *  !! least significant byte first if values longer than one byte !!
     *
     * 1: Prolog (unsigned int16, value 0x0001) -&gt; symtab[0] = 0x01, symtab[1] = 0x00
     * 2: FixedArgs (directly the data, get number and types from related constructor)
     *  2.1: length of the array (unsigned int32, 4 bytes, least significant first)
     *  2.2: the byte array data
     * 3: NumNamed (unsigned int16, number of named fields and properties, 0x0000)
     */
    <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol, tBuilder: ch.epfl.lamp.compiler.msil.emit.TypeBuilder)Unit" id="785581">addSymtabAttribute</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="786702">sym</a>: <a href="../../../../reflect/internal/Symbols.scala.html#441132" title="GenMSIL.this.global.Symbol">Symbol</a>, <a title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder" id="786703">tBuilder</a>: <span title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">TypeBuilder</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="keyword">def</span> <a title="()Unit" id="786704">addMarker</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="Array[Byte]" id="786705">markerSymtab</a> = <span title="Array[Byte]" class="keyword">new</span> <a href="../../../../Array.scala.html#292" title="Array[Byte]">Array</a><span class="delimiter">[</span>Byte<span class="delimiter">]</span><span class="delimiter">(</span><span title="Int(4)" class="int">4</span><span class="delimiter">)</span>
        <a href="../../../../Array.scala.html#57451" title="(i: Int, x: Byte)Unit">markerSymtab</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span> = <span title="Int(1)" class="int">1</span>.<a href="../../../../Int.scala.html#57871" title="=&gt; Byte">toByte</a>
        <a href="#786703" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">tBuilder</a>.<span title="(constr: ch.epfl.lamp.compiler.msil.ConstructorInfo, value: Array[Byte])Unit">SetCustomAttribute</span><span class="delimiter">(</span><a href="../../symtab/clr/CLRTypes.scala.html#730884" title="=&gt; ch.epfl.lamp.compiler.msil.ConstructorInfo">SYMTAB_ATTRIBUTE_EMPTY_CONSTRUCTOR</a>, <a href="#786705" title="Array[Byte]">markerSymtab</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>

      // both conditions are needed (why exactly..?)
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#786703" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">tBuilder</a>.<span title="String">Name</span>.<span title="(x$1: String)Boolean">endsWith</span><span class="delimiter">(</span><span title="String(&quot;$&quot;)" class="string">&quot;$&quot;</span><span class="delimiter">)</span> <a href="../../../../Boolean.scala.html#58724" title="(x: Boolean)Boolean">||</a> <a href="#786702" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443245" title="=&gt; Boolean">isModuleClass</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#786704" title="()Unit">addMarker</a><span class="delimiter">(</span><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
        <a href="../../Global.scala.html#559697" title="=&gt; GenMSIL.this.global.Run">currentRun</a>.<a href="../../Global.scala.html#561286" title="=&gt; scala.collection.mutable.HashMap[GenMSIL.this.global.Symbol,scala.reflect.internal.pickling.PickleBuffer]">symData</a>.<a href="../../../../collection/mutable/HashMap.scala.html#79207" title="(key: GenMSIL.this.global.Symbol)Option[scala.reflect.internal.pickling.PickleBuffer]">get</a><a href="../../../../Option.scala.html#64115" title="=&gt; scala.reflect.internal.pickling.PickleBuffer" class="delimiter">(</a><a href="#786702" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> Some<a href="#786910" title="Unit" id="786911" class="delimiter">(</a>pickle<span class="delimiter">)</span> =&gt;
            <span class="keyword">var</span> <a title="Int" id="786725">size</a> = pickle.<a href="../../../../reflect/internal/pickling/PickleBuffer.scala.html#537682" title="=&gt; Int">writeIndex</a>
            <span class="keyword">val</span> <a title="Array[Byte]" id="786726">symtab</a> = <span title="Array[Byte]" class="keyword">new</span> <a href="../../../../Array.scala.html#292" title="Array[Byte]">Array</a><span class="delimiter">[</span>Byte<span class="delimiter">]</span><span class="delimiter">(</span><a href="#786725" title="Int">size</a> <a href="../../../../Int.scala.html#57948" title="(x: Int)Int">+</a> <span title="Int(8)" class="int">8</span><span class="delimiter">)</span>
            <a href="../../../../Array.scala.html#57451" title="(i: Int, x: Byte)Unit">symtab</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span> = <span title="Int(1)" class="int">1</span>.<a href="../../../../Int.scala.html#57871" title="=&gt; Byte">toByte</a>
            <span class="keyword">for</span> <span class="delimiter">(</span><a title="Int" id="786865">i</a> &lt;- <a href="../../../../LowPriorityImplicits.scala.html#8333" title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">2</a> <a href="../../../../collection/immutable/Range.scala.html#69665" title="(f: Int =&gt; Unit)Unit">until</a> <span title="Int(6)" class="int">6</span><span class="delimiter">)</span> <span class="delimiter">{</span>
              <a href="../../../../Array.scala.html#57451" title="(i: Int, x: Byte)Unit">symtab</a><span class="delimiter">(</span><a href="#786865" title="Int">i</a><span class="delimiter">)</span> = <span class="delimiter">(</span><a href="#786725" title="Int">size</a> <a href="../../../../Int.scala.html#57938" title="(x: Int)Int">&amp;</a> <span title="Int(255)" class="int">0xff</span><span class="delimiter">)</span>.<a href="../../../../Int.scala.html#57871" title="=&gt; Byte">toByte</a>
              <a href="#786725" title="Int">size</a> = <a href="#786725" title="Int">size</a> <a href="../../../../Int.scala.html#57886" title="(x: Int)Int">&gt;&gt;</a> <span title="Int(8)" class="int">8</span>
            <span class="delimiter">}</span>
            java.lang.<span title="System.type">System</span>.<span title="(x$1: Any, x$2: Int, x$3: Any, x$4: Int, x$5: Int)Unit">arraycopy</span><span class="delimiter">(</span>pickle.<a href="../../../../reflect/internal/pickling/PickleBuffer.scala.html#537676" title="=&gt; Array[Byte]">bytes</a>, <span title="Int(0)" class="int">0</span>, <a href="#786726" title="Array[Byte]">symtab</a>, <span title="Int(6)" class="int">6</span>, pickle.<a href="../../../../reflect/internal/pickling/PickleBuffer.scala.html#537682" title="=&gt; Int">writeIndex</a><span class="delimiter">)</span>

            <a href="#786703" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">tBuilder</a>.<span title="(constr: ch.epfl.lamp.compiler.msil.ConstructorInfo, value: Array[Byte])Unit">SetCustomAttribute</span><span class="delimiter">(</span><a href="../../symtab/clr/CLRTypes.scala.html#730881" title="=&gt; ch.epfl.lamp.compiler.msil.ConstructorInfo">SYMTAB_ATTRIBUTE_CONSTRUCTOR</a>, <a href="#786726" title="Array[Byte]">symtab</a><span class="delimiter">)</span>

            <a href="../../Global.scala.html#559697" title="=&gt; GenMSIL.this.global.Run">currentRun</a>.<a href="../../Global.scala.html#561286" title="=&gt; scala.collection.mutable.HashMap[GenMSIL.this.global.Symbol,scala.reflect.internal.pickling.PickleBuffer]">symData</a> <a href="../../../../collection/mutable/HashMap.scala.html#79212" title="(key: GenMSIL.this.global.Symbol)scala.collection.mutable.HashMap[GenMSIL.this.global.Symbol,scala.reflect.internal.pickling.PickleBuffer]">-=</a> <a href="#786702" title="GenMSIL.this.global.Symbol">sym</a>
            <a href="../../Global.scala.html#559697" title="=&gt; GenMSIL.this.global.Run">currentRun</a>.<a href="../../Global.scala.html#561286" title="=&gt; scala.collection.mutable.HashMap[GenMSIL.this.global.Symbol,scala.reflect.internal.pickling.PickleBuffer]">symData</a> <a href="../../../../collection/mutable/HashMap.scala.html#79212" title="(key: GenMSIL.this.global.Symbol)scala.collection.mutable.HashMap[GenMSIL.this.global.Symbol,scala.reflect.internal.pickling.PickleBuffer]">-=</a> <a href="#786702" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443511" title="=&gt; GenMSIL.this.global.Symbol">companionSymbol</a>

          <span class="keyword">case</span> _ =&gt;
            <a href="#786704" title="()Unit">addMarker</a><a href="#786912" title="(x: Unit)Unit" class="delimiter">(</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    /**
     * Mutates `member` adding CLR attributes (if any) based on sym.annotations.
     * Please notice that CLR custom modifiers are a different beast (see customModifiers below)
     * and thus shouldn't be added by this method.
     */
    <span class="keyword">def</span> <a title="(member: ch.epfl.lamp.compiler.msil.emit.ICustomAttributeSetter, annotations: List[GenMSIL.this.global.AnnotationInfo])Unit" id="785582">addAttributes</a><span class="delimiter">(</span><a title="ch.epfl.lamp.compiler.msil.emit.ICustomAttributeSetter" id="786917">member</a>: <span title="ch.epfl.lamp.compiler.msil.emit.ICustomAttributeSetter">ICustomAttributeSetter</span>, <a title="List[GenMSIL.this.global.AnnotationInfo]" id="786918">annotations</a>: <a href="../../../../collection/immutable/List.scala.html#12322" title="List[GenMSIL.this.global.AnnotationInfo]">List</a><span class="delimiter">[</span>AnnotationInfo<span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="List[Null]" id="786919">attributes</a> = <a href="#786918" title="List[GenMSIL.this.global.AnnotationInfo]">annotations</a>.<a href="../../../../collection/TraversableLike.scala.html#58971" title="(f: GenMSIL.this.global.AnnotationInfo =&gt; GenMSIL.this.global.Symbol)(implicit bf: scala.collection.generic.CanBuildFrom[List[GenMSIL.this.global.AnnotationInfo],GenMSIL.this.global.Symbol,List[GenMSIL.this.global.Symbol]])List[GenMSIL.this.global.Symbol]">map</a><a href="../../../../collection/immutable/List.scala.html#63282" title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.List.Coll,GenMSIL.this.global.Symbol,List[GenMSIL.this.global.Symbol]]" class="delimiter">(</a><a href="#786936" title="GenMSIL.this.global.AnnotationInfo">_</a>.<a href="../../../../reflect/internal/AnnotationInfos.scala.html#443791" title="=&gt; GenMSIL.this.global.Type">atp</a>.<a href="../../../../reflect/internal/Types.scala.html#441986" title="=&gt; GenMSIL.this.global.Symbol">typeSymbol</a><span class="delimiter">)</span>.<a href="../../../../collection/TraversableLike.scala.html#58983" title="(pf: PartialFunction[GenMSIL.this.global.Symbol,Null])(implicit bf: scala.collection.generic.CanBuildFrom[List[GenMSIL.this.global.Symbol],Null,List[Null]])List[Null]">collect</a> <a title="anonymous class $anonfun extends scala.runtime.AbstractPartialFunction[GenMSIL.this.global.Symbol,Null] with Serializable" id="786998" class="delimiter">{</a>
        <span class="keyword">case</span> <a href="../../../../reflect/internal/Definitions.scala.html#441641" title="GenMSIL.this.global.definitions.type">definitions</a>.<a href="../../../../reflect/internal/Definitions.scala.html#442681" title="B1" id="787004">TransientAttr</a> =&gt; <a href="#786994" title="(x: B1)B1" class="keyword">null</a> // TODO this is just an example
      <span class="delimiter">}</span>
      <span title="Nothing" class="keyword">return</span> // TODO: implement at some point
    <span class="delimiter">}</span>

    /**
     * What's a CLR custom modifier? Intro available as source comments in compiler.msil.CustomModifier.
     * It's basically a marker associated with a location (think of FieldInfo, ParameterInfo, and PropertyInfo)
     * and thus that marker (be it optional or required) becomes part of the signature of that location.
     * Some annotations will become CLR attributes (see addAttributes above), others custom modifiers (this method).
     */
    <span class="keyword">def</span> <a title="(annotations: List[GenMSIL.this.global.AnnotationInfo])Array[ch.epfl.lamp.compiler.msil.CustomModifier]" id="785583">customModifiers</a><span class="delimiter">(</span><a title="List[GenMSIL.this.global.AnnotationInfo]" id="787084">annotations</a>: <a href="../../../../collection/immutable/List.scala.html#12322" title="List[GenMSIL.this.global.AnnotationInfo]">List</a><span class="delimiter">[</span>AnnotationInfo<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../../../Array.scala.html#292" title="Array[ch.epfl.lamp.compiler.msil.CustomModifier]">Array</a><span class="delimiter">[</span>CustomModifier<span class="delimiter">]</span> = <span class="delimiter">{</span>
      <a href="#787084" title="List[GenMSIL.this.global.AnnotationInfo]">annotations</a>.<a href="../../../../collection/TraversableLike.scala.html#58971" title="(f: GenMSIL.this.global.AnnotationInfo =&gt; GenMSIL.this.global.Symbol)(implicit bf: scala.collection.generic.CanBuildFrom[List[GenMSIL.this.global.AnnotationInfo],GenMSIL.this.global.Symbol,List[GenMSIL.this.global.Symbol]])List[GenMSIL.this.global.Symbol]">map</a><a href="../../../../collection/immutable/List.scala.html#63282" title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.List.Coll,GenMSIL.this.global.Symbol,List[GenMSIL.this.global.Symbol]]" class="delimiter">(</a><a href="#787111" title="GenMSIL.this.global.AnnotationInfo">_</a>.<a href="../../../../reflect/internal/AnnotationInfos.scala.html#443791" title="=&gt; GenMSIL.this.global.Type">atp</a>.<a href="../../../../reflect/internal/Types.scala.html#441986" title="=&gt; GenMSIL.this.global.Symbol">typeSymbol</a><span class="delimiter">)</span>.<a href="../../../../collection/TraversableLike.scala.html#58983" title="(pf: PartialFunction[GenMSIL.this.global.Symbol,ch.epfl.lamp.compiler.msil.CustomModifier])(implicit bf: scala.collection.generic.CanBuildFrom[List[GenMSIL.this.global.Symbol],ch.epfl.lamp.compiler.msil.CustomModifier,List[ch.epfl.lamp.compiler.msil.CustomModifier]])List[ch.epfl.lamp.compiler.msil.CustomModifier]">collect</a> <a title="anonymous class $anonfun extends scala.runtime.AbstractPartialFunction[GenMSIL.this.global.Symbol,ch.epfl.lamp.compiler.msil.CustomModifier] with Serializable" id="787169" class="delimiter">{</a>
        <span class="keyword">case</span> <a href="../../../../reflect/internal/Definitions.scala.html#441641" title="GenMSIL.this.global.definitions.type">definitions</a>.<a href="../../../../reflect/internal/Definitions.scala.html#442685" title="B1" id="787175">VolatileAttr</a>  =&gt; <a href="#787165" title="(x: B1)B1" class="keyword">new</a> <span title="ch.epfl.lamp.compiler.msil.CustomModifier">CustomModifier</span><span class="delimiter">(</span><span title="Boolean(true)" class="keyword">true</span>, <span title="ch.epfl.lamp.compiler.msil.CustomModifier.type">CustomModifier</span>.<span title="()ch.epfl.lamp.compiler.msil.Type">VolatileMarker</span><span class="delimiter">)</span>
      <span class="delimiter">}</span> <a href="../../../../collection/TraversableOnce.scala.html#59170" title="(implicit evidence$1: ArrayTag[ch.epfl.lamp.compiler.msil.CustomModifier])Array[ch.epfl.lamp.compiler.msil.CustomModifier]">toArray</a>
    <span class="delimiter">}</span>



    /*
      debuglog(&quot;creating annotations: &quot; + annotations + &quot; for member : &quot; + member)
      for (annot@ AnnotationInfo(typ, annArgs, nvPairs) &lt;- annotations ;
           if annot.isConstant)
           //!typ.typeSymbol.isJavaDefined
      {
//        assert(consts.length &lt;= 1,
//               &quot;too many constant arguments for annotations; &quot;+consts.toString())

        // Problem / TODO having the symbol of the annotations type would be nicer
        // (i hope that type.typeSymbol is the same as the one in types2create)
        // AND: this will crash if the annotations Type is already compiled (-&gt; not a typeBuilder)
        // when this is solved, types2create will be the same as icodes.classes, thus superfluous
        val annType: TypeBuilder = getType(typ.typeSymbol).asInstanceOf[TypeBuilder]
//        val annType: MsilType = getType(typ.typeSymbol)

        // Problem / TODO: i have no idea which constructor is used. This
        // information should be available in AnnotationInfo.
        annType.CreateType() // else, GetConstructors can't be used
        val constr: ConstructorInfo = annType.GetConstructors()(0)
        // prevent a second call of CreateType, only needed because there's no
        // other way than GetConstructors()(0) to get the constructor, if there's
        // no constructor symbol available.

        val args: Array[Byte] =
          getAttributeArgs(
            annArgs map (_.constant.get),
            (for((n,v) &lt;- nvPairs) yield (n, v.constant.get)))
        member.SetCustomAttribute(constr, args)
      }
    } */

/*    def getAttributeArgs(consts: List[Constant], nvPairs: List[(Name, Constant)]): Array[Byte] = {
      val buf = ByteBuffer.allocate(2048) // FIXME: this may be not enough!
      buf.order(ByteOrder.LITTLE_ENDIAN)
      buf.putShort(1.toShort) // signature

      def emitSerString(str: String) = {
          // this is wrong, it has to be the length of the UTF-8 byte array, which
          // may be longer (see clr-book on page 302)
//          val length: Int = str.length
            val strBytes: Array[Byte] = try {
              str.getBytes(&quot;UTF-8&quot;)
            } catch {
              case _: Error =&gt; abort(&quot;could not get byte-array for string: &quot; + str)
            }
            val length: Int = strBytes.length //this length is stored big-endian
            if (length &lt; 128)
              buf.put(length.toByte)
            else if (length &lt; (1&lt;&lt;14)) {
              buf.put(((length &gt;&gt; 8) | 0x80).toByte) // the bits 14 and 15 of length are '0'
              buf.put((length | 0xff).toByte)
            } else if (length &lt; (1 &lt;&lt; 29)) {
              buf.put(((length &gt;&gt; 24) | 0xc0).toByte)
              buf.put(((length &gt;&gt; 16) &amp; 0xff).toByte)
              buf.put(((length &gt;&gt;  8) &amp; 0xff).toByte)
              buf.put(((length      ) &amp; 0xff).toByte)
            } else
              abort(&quot;string too long for attribute parameter: &quot; + length)
            buf.put(strBytes)
      }

      def emitConst(const: Constant): Unit = const.tag match {
        case BooleanTag =&gt; buf.put((if (const.booleanValue) 1 else 0).toByte)
        case ByteTag =&gt; buf.put(const.byteValue)
        case ShortTag =&gt; buf.putShort(const.shortValue)
        case CharTag =&gt; buf.putChar(const.charValue)
        case IntTag =&gt; buf.putInt(const.intValue)
        case LongTag =&gt; buf.putLong(const.longValue)
        case FloatTag =&gt; buf.putFloat(const.floatValue)
        case DoubleTag =&gt; buf.putDouble(const.doubleValue)
        case StringTag =&gt;
          val str: String = const.stringValue
          if (str == null) {
            buf.put(0xff.toByte)
          } else {
            emitSerString(str)
          }
        case ArrayTag =&gt;
          val arr: Array[Constant] = const.arrayValue
          if (arr == null) {
            buf.putInt(0xffffffff)
          } else {
            buf.putInt(arr.length)
            arr.foreach(emitConst)
          }

        // TODO: other Tags: NoTag, UnitTag, ClazzTag, EnumTag, ArrayTag ???

        case _ =&gt; abort(&quot;could not handle attribute argument: &quot; + const)
      }

      consts foreach emitConst
      buf.putShort(nvPairs.length.toShort)
      def emitNamedArg(nvPair: (Name, Constant)) {
        // the named argument is a property of the attribute (it can't be a field, since
        //  all fields in scala are private)
        buf.put(0x54.toByte)

        def emitType(c: Constant) = c.tag match { // type of the constant, Ecma-335.pdf, page 151
          case BooleanTag =&gt; buf.put(0x02.toByte)
          case ByteTag =&gt;    buf.put(0x05.toByte)
          case ShortTag =&gt;   buf.put(0x06.toByte)
          case CharTag =&gt;    buf.put(0x07.toByte)
          case IntTag =&gt;     buf.put(0x08.toByte)
          case LongTag =&gt;    buf.put(0x0a.toByte)
          case FloatTag =&gt;   buf.put(0x0c.toByte)
          case DoubleTag =&gt;  buf.put(0x0d.toByte)
          case StringTag =&gt;  buf.put(0x0e.toByte)

          // TODO: other Tags: NoTag, UnitTag, ClazzTag, EnumTag ???

          // ArrayTag falls in here
          case _ =&gt; abort(&quot;could not handle attribute argument: &quot; + c)
        }

        val cnst: Constant = nvPair._2
        if (cnst.tag == ArrayTag) {
          buf.put(0x1d.toByte)
          emitType(cnst.arrayValue(0)) // FIXME: will crash if array length = 0
        } else if (cnst.tag == EnumTag) {
          buf.put(0x55.toByte)
          // TODO: put a SerString (don't know what exactly, names of the enums somehow..)
              } else {
          buf.put(0x51.toByte)
          emitType(cnst)
        }

        emitSerString(nvPair._1.toString)
        emitConst(nvPair._2)
      }

      val length = buf.position()
      buf.array().slice(0, length)
    } */

    <span class="keyword">def</span> <a title="()Unit" id="785584">writeAssembly</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#785638" title="=&gt; GenMSIL.this.global.Symbol">entryPoint</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="../../Global.scala.html#559533" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a><span class="delimiter">(</span><a href="#785638" title="=&gt; GenMSIL.this.global.Symbol">entryPoint</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443480" title="=&gt; GenMSIL.this.global.Symbol">enclClass</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443245" title="=&gt; Boolean">isModuleClass</a>, <a href="#785638" title="=&gt; GenMSIL.this.global.Symbol">entryPoint</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443480" title="=&gt; GenMSIL.this.global.Symbol">enclClass</a><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.MethodInfo" id="787288">mainMethod</a> = <a href="../../../../collection/MapLike.scala.html#78420" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol)ch.epfl.lamp.compiler.msil.MethodInfo">methods</a><span class="delimiter">(</span><a href="#785638" title="=&gt; GenMSIL.this.global.Symbol">entryPoint</a><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="Array[ch.epfl.lamp.compiler.msil.Type]" id="787289">stringArrayTypes</a>: <a href="../../../../Array.scala.html#292" title="Array[ch.epfl.lamp.compiler.msil.Type]">Array</a><span class="delimiter">[</span>MsilType<span class="delimiter">]</span> = <a href="../../../../Array.scala.html#68728" title="(xs: ch.epfl.lamp.compiler.msil.Type*)(implicit evidence$2: scala.reflect.ArrayTag[ch.epfl.lamp.compiler.msil.Type])Array[ch.epfl.lamp.compiler.msil.Type]">Array</a><a href="../../../../reflect/ClassTag.scala.html#61898" title="(erasure1: Class[_])scala.reflect.ClassTag[ch.epfl.lamp.compiler.msil.Type]" class="delimiter">(</a><a href="../../symtab/clr/CLRTypes.scala.html#730872" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MSTRING_ARRAY</a><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder" id="787290">globalMain</a> = <a href="#785560" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ModuleBuilder">mmodule</a>.<span title="(name: String, attributes: Int, returnType: ch.epfl.lamp.compiler.msil.Type, paramTypes: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.emit.MethodBuilder">DefineGlobalMethod</span><span class="delimiter">(</span>
          <span title="String(&quot;Main&quot;)" class="string">&quot;Main&quot;</span>, MethodAttributes.Public <span title="Int(22)">|</span> MethodAttributes.Static,
          <a href="../../symtab/clr/CLRTypes.scala.html#730857" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MVOID</a>, <a href="#787289" title="Array[ch.epfl.lamp.compiler.msil.Type]">stringArrayTypes</a><span class="delimiter">)</span>
        <a href="#787290" title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder">globalMain</a>.<span title="(pos: Int, attr: Int, name: String)ch.epfl.lamp.compiler.msil.emit.ParameterBuilder">DefineParameter</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span>, ParameterAttributes.<span title="Int(0)">None</span>, <span title="String(&quot;args&quot;)" class="string">&quot;args&quot;</span><span class="delimiter">)</span>
        <a href="#785557" title="=&gt; ch.epfl.lamp.compiler.msil.emit.AssemblyBuilder">massembly</a>.<span title="(entryMethod: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">SetEntryPoint</span><span class="delimiter">(</span><a href="#787290" title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder">globalMain</a><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.ILGenerator" id="787291">code</a> = <a href="#787290" title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder">globalMain</a>.<span title="()ch.epfl.lamp.compiler.msil.emit.ILGenerator">GetILGenerator</span><span class="delimiter">(</span><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.FieldInfo" id="787292">moduleField</a> = <a href="#785658" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.FieldInfo">getModuleInstanceField</a><span class="delimiter">(</span><a href="#785638" title="=&gt; GenMSIL.this.global.Symbol">entryPoint</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443480" title="=&gt; GenMSIL.this.global.Symbol">enclClass</a><span class="delimiter">)</span>
        <a href="#787291" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.FieldInfo)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldsfld</span>, <a href="#787292" title="ch.epfl.lamp.compiler.msil.FieldInfo">moduleField</a><span class="delimiter">)</span>
        <a href="#787291" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldarg_0</span><span class="delimiter">)</span>
        <a href="#787291" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Callvirt</span>, <a href="#787288" title="ch.epfl.lamp.compiler.msil.MethodInfo">mainMethod</a><span class="delimiter">)</span>
        <a href="#787291" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ret</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
      <a href="#785585" title="()Unit">createTypes</a><span class="delimiter">(</span><span class="delimiter">)</span>
      <span class="keyword">var</span> <a title="String" id="787282">outDirName</a>: <span title="String">String</span> = <span title="Null(null)" class="keyword">null</span>
      <span class="keyword">try</span> <span class="delimiter">{</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../Global.scala.html#559485" title="=&gt; scala.tools.nsc.Settings">settings</a>.<a href="../../settings/ScalaSettings.scala.html#467546" title="=&gt; scala.tools.nsc.Settings#StringSetting">Ygenjavap</a>.<a href="../../../../reflect/internal/settings/MutableSettings.scala.html#456447" title="=&gt; Boolean">isDefault</a><span class="delimiter">)</span> <span class="delimiter">{</span> // we reuse the JVM-sounding setting because it's conceptually similar
          <a href="#787282" title="String">outDirName</a> = <a href="#785572" title="=&gt; java.io.File">outDir</a>.<span title="()String">getPath</span><span class="delimiter">(</span><span class="delimiter">)</span>
          <a href="#785557" title="=&gt; ch.epfl.lamp.compiler.msil.emit.AssemblyBuilder">massembly</a>.<span title="(fileName: String)Unit">Save</span><span class="delimiter">(</span><a href="#787282" title="String">outDirName</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;\\&quot;)" class="string">&quot;\\&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#785566" title="=&gt; String">assemName</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;.msil&quot;)" class="string">&quot;.msil&quot;</span><span class="delimiter">)</span> /* use SingleFileILPrinterVisitor */
        <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
          <a href="#787282" title="String">outDirName</a> = <a href="#785575" title="=&gt; java.io.File">srcPath</a>.<span title="()String">getPath</span><span class="delimiter">(</span><span class="delimiter">)</span>
          <a href="#785557" title="=&gt; ch.epfl.lamp.compiler.msil.emit.AssemblyBuilder">massembly</a>.<span title="(destPath: String, sourceFilesPath: String)Unit">Save</span><span class="delimiter">(</span><a href="../../Global.scala.html#559485" title="=&gt; scala.tools.nsc.Settings">settings</a>.<a href="../../settings/ScalaSettings.scala.html#467546" title="=&gt; scala.tools.nsc.Settings#StringSetting">Ygenjavap</a>.<a href="../../../../reflect/internal/settings/MutableSettings.scala.html#456449" title="=&gt; String">value</a>, <a href="#787282" title="String">outDirName</a><span class="delimiter">)</span>  /* use MultipleFilesILPrinterVisitor */
        <span class="delimiter">}</span>
      <span class="delimiter">}</span> <span class="keyword">catch</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <a title="Nothing" id="789108">e</a>:<span title="java.io.IOException">IOException</span> =&gt; <a href="../../Global.scala.html#559537" title="(msg: String)Nothing">abort</a><span class="delimiter">(</span><span title="String(&quot;Could not write to &quot;)" class="string">&quot;Could not write to &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#787282" title="String">outDirName</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;: &quot;)" class="string">&quot;: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#789108" title="java.io.IOException">e</a>.<span title="()String">getMessage</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="()Unit" id="785585">createTypes</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="keyword">for</span> <span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.global.Symbol" id="789136">sym</a> &lt;- <a href="../icode/ICodes.scala.html#642629" title="=&gt; scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.global.Symbol,GenMSIL.this.global.icodes.IClass]">classes</a>.<a href="../../../../collection/IterableLike.scala.html#59458" title="(f: GenMSIL.this.global.icodes.global.Symbol =&gt; Unit)Unit">keys</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="GenMSIL.this.global.icodes.IClass" id="789137">iclass</a>   = <a href="../../../../collection/mutable/HashMap.scala.html#79206" title="(key: GenMSIL.this.global.icodes.global.Symbol)GenMSIL.this.global.icodes.IClass">classes</a><span class="delimiter">(</span><a href="#789136" title="GenMSIL.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder" id="789138">tBuilder</a> = <a href="../../../../collection/MapLike.scala.html#78420" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol)ch.epfl.lamp.compiler.msil.Type">types</a><span class="delimiter">(</span><a href="#789136" title="GenMSIL.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder" class="delimiter">[</span><span title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">TypeBuilder</span><span class="delimiter">]</span>

        <a href="../../Global.scala.html#559553" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><span title="String(&quot;Calling CreatType for &quot;)" class="string">&quot;Calling CreatType for &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#789136" title="GenMSIL.this.global.icodes.global.Symbol">sym</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;, &quot;)" class="string">&quot;, &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#789138" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">tBuilder</a>.<span title="()String">toString</span><span class="delimiter">)</span>

        <a href="#789138" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">tBuilder</a>.<span title="()ch.epfl.lamp.compiler.msil.Type">CreateType</span><span class="delimiter">(</span><span class="delimiter">)</span>
        <a href="#789138" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">tBuilder</a>.<span title="(sourceFilepath: String)Unit">setSourceFilepath</span><span class="delimiter">(</span><a href="#789137" title="GenMSIL.this.global.icodes.IClass">iclass</a>.<a href="../icode/Members.scala.html#642921" title="=&gt; GenMSIL.this.global.icodes.global.CompilationUnit">cunit</a>.<a href="../../CompilationUnits.scala.html#560792" title="=&gt; scala.tools.nsc.util.SourceFile">source</a>.<a href="../../util/SourceFile.scala.html#561659" title="=&gt; scala.tools.nsc.io.AbstractFile">file</a>.<a href="../../io/AbstractFile.scala.html#561677" title="=&gt; String">path</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <span class="keyword">private</span><span class="delimiter">[</span>GenMSIL<span class="delimiter">]</span> <span class="keyword">def</span> <a title="(iclass: GenMSIL.this.global.icodes.IClass)String" id="785586">ilasmFileName</a><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.IClass" id="789190">iclass</a>: <a href="../icode/Members.scala.html#642676" title="GenMSIL.this.global.icodes.IClass">IClass</a><span class="delimiter">)</span> : <span title="String">String</span> = <span class="delimiter">{</span>
      // method.sourceFile contains just the filename
      <a href="#789190" title="GenMSIL.this.global.icodes.IClass">iclass</a>.<a href="../icode/Members.scala.html#642921" title="=&gt; GenMSIL.this.global.icodes.global.CompilationUnit">cunit</a>.<a href="../../CompilationUnits.scala.html#560792" title="=&gt; scala.tools.nsc.util.SourceFile">source</a>.<a href="../../util/SourceFile.scala.html#561659" title="=&gt; scala.tools.nsc.io.AbstractFile">file</a>.<a href="../../io/AbstractFile.scala.html#561710" title="()String">toString</a>.<span title="(x$1: CharSequence, x$2: CharSequence)String">replace</span><span class="delimiter">(</span><span title="String(&quot;\\&quot;)" class="string">&quot;\\&quot;</span>, <span title="String(&quot;\\\\&quot;)" class="string">&quot;\\\\&quot;</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="keyword">private</span><span class="delimiter">[</span>GenMSIL<span class="delimiter">]</span> <span class="keyword">def</span> <a title="(iclass: GenMSIL.this.global.icodes.IClass)Unit" id="785587">genClass</a><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.IClass" id="785831">iclass</a>: <a href="../icode/Members.scala.html#642676" title="GenMSIL.this.global.icodes.IClass">IClass</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="GenMSIL.this.global.icodes.global.Symbol" id="789198">sym</a> = <a href="#785831" title="GenMSIL.this.global.icodes.IClass">iclass</a>.<a href="../icode/Members.scala.html#642912" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a>
      <a href="../../Global.scala.html#559553" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><span title="String(&quot;Generating class &quot;)" class="string">&quot;Generating class &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#789198" title="GenMSIL.this.global.icodes.global.Symbol">sym</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; flags: &quot;)" class="string">&quot; flags: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="../../symtab/package.scala.html#57302" title="=&gt; reflect.internal.Flags.type">Flags</a>.<a href="../../../../reflect/internal/Flags.scala.html#441022" title="(flags: Long)String">flagsToString</a><span class="delimiter">(</span><a href="#789198" title="GenMSIL.this.global.icodes.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443310" title="=&gt; Long">flags</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="#785551" title="(x$1: GenMSIL.this.global.icodes.IClass)Unit">clasz</a> = <a href="#785831" title="GenMSIL.this.global.icodes.IClass">iclass</a>

      <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder" id="789199">tBuilder</a> = <a href="#785648" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.Type">getType</a><span class="delimiter">(</span><a href="#789198" title="GenMSIL.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder" class="delimiter">[</span><span title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">TypeBuilder</span><span class="delimiter">]</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#785656" title="(sym: GenMSIL.this.global.Symbol)Boolean">isCloneable</a><span class="delimiter">(</span><a href="#789198" title="GenMSIL.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        // FIXME: why there's no nme.clone_ ?
        // &quot;Clone&quot;: if the code is non-portable, &quot;Clone&quot; is defined, not &quot;clone&quot;
        // TODO: improve condition (should override AnyRef.clone)
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#785831" title="GenMSIL.this.global.icodes.IClass">iclass</a>.<a href="../icode/Members.scala.html#642918" title="=&gt; List[GenMSIL.this.global.icodes.IMethod]">methods</a>.<a href="../../../../collection/LinearSeqOptimized.scala.html#76169" title="(p: GenMSIL.this.global.icodes.IMethod =&gt; Boolean)Boolean">forall</a><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.IMethod" id="789226">m</a> =&gt; <span class="delimiter">{</span>
          <a href="../../../../Boolean.scala.html#58721" title="=&gt; Boolean">!</a><span class="delimiter">(</span><span class="delimiter">(</span><a href="#789226" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#733826" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443152" title="=&gt; m.symbol.NameType">name</a>.<a href="../../../../Function1.scala.html#59562" title="()String">toString</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="String(&quot;clone&quot;)" class="string">&quot;clone&quot;</span> <a href="../../../../Boolean.scala.html#58724" title="(x: Boolean)Boolean">||</a> <a href="#789226" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#733826" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443152" title="=&gt; m.symbol.NameType">name</a>.<a href="../../../../Function1.scala.html#59562" title="()String">toString</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="String(&quot;Clone&quot;)" class="string">&quot;Clone&quot;</span><span class="delimiter">)</span> <a href="../../../../Boolean.scala.html#58725" title="(x: Boolean)Boolean">&amp;&amp;</a>
            <a href="#789226" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#733826" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443425" title="=&gt; GenMSIL.this.global.icodes.global.Type">tpe</a>.<a href="../../../../reflect/internal/Types.scala.html#442010" title="=&gt; List[GenMSIL.this.global.icodes.global.Type]">paramTypes</a>.<a href="../../../../collection/LinearSeqOptimized.scala.html#76164" title="=&gt; Int">length</a> <a href="../../../../Int.scala.html#57898" title="(x: Int)Boolean">!=</a> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
        <span class="delimiter">}</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="../../Global.scala.html#559553" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><span title="String(&quot;auto-generating cloneable method for &quot;)" class="string">&quot;auto-generating cloneable method for &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#789198" title="GenMSIL.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="Short" id="789245">attrs</a>: <a href="../../../../Short.scala.html#1258" title="Short">Short</a> = <span class="delimiter">(</span>MethodAttributes.Public | MethodAttributes.Virtual <span title="Int(198)">|</span>
                              MethodAttributes.HideBySig<span class="delimiter">)</span>.<a href="../../../../Int.scala.html#57872" title="=&gt; Short">toShort</a>
          <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder" id="789246">cloneMethod</a> = <a href="#789199" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">tBuilder</a>.<span title="(name: String, attrs: Short, returnType: ch.epfl.lamp.compiler.msil.Type, paramTypes: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.emit.MethodBuilder">DefineMethod</span><span class="delimiter">(</span><span title="String(&quot;Clone&quot;)" class="string">&quot;Clone&quot;</span>, <a href="#789245" title="Short">attrs</a>, <a href="../../symtab/clr/CLRTypes.scala.html#730866" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MOBJECT</a>,
                                                  <span title="ch.epfl.lamp.compiler.msil.Type.type">MsilType</span>.<span title="Array[ch.epfl.lamp.compiler.msil.Type]">EmptyTypes</span><span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.ILGenerator" id="789247">clCode</a> = <a href="#789246" title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder">cloneMethod</a>.<span title="()ch.epfl.lamp.compiler.msil.emit.ILGenerator">GetILGenerator</span><span class="delimiter">(</span><span class="delimiter">)</span>
          <a href="#789247" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">clCode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldarg_0</span><span class="delimiter">)</span>
          <a href="#789247" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">clCode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Call</span>, <a href="#785497" title="=&gt; ch.epfl.lamp.compiler.msil.MethodInfo">MEMBERWISE_CLONE</a><span class="delimiter">)</span>
          <a href="#789247" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">clCode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ret</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>

      <span class="keyword">val</span> <a title="Int" id="789200">line</a> = <a href="#789198" title="GenMSIL.this.global.icodes.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443167" title="=&gt; GenMSIL.this.global.icodes.global.Position">pos</a>.<a href="../../util/Position.scala.html#445379" title="=&gt; Int">line</a>
      <a href="#789199" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">tBuilder</a>.<span title="(sourceLine: Int, sourceFilename: String)Unit">setPosition</span><span class="delimiter">(</span><a href="#789200" title="Int">line</a>, <a href="#785586" title="(iclass: GenMSIL.this.global.icodes.IClass)String">ilasmFileName</a><span class="delimiter">(</span><a href="#785831" title="GenMSIL.this.global.icodes.IClass">iclass</a><span class="delimiter">)</span><span class="delimiter">)</span>

      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#785654" title="(sym: GenMSIL.this.global.Symbol)Boolean">isTopLevelModule</a><span class="delimiter">(</span><a href="#789198" title="GenMSIL.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#789198" title="GenMSIL.this.global.icodes.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443509" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">companionClass</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../../../reflect/internal/Symbols.scala.html#441152" title="=&gt; GenMSIL.this.global.NoSymbol">NoSymbol</a><span class="delimiter">)</span>
          <a href="#785661" title="(sym: GenMSIL.this.global.Symbol)Unit">generateMirrorClass</a><span class="delimiter">(</span><a href="#789198" title="GenMSIL.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span>
        <span class="keyword">else</span>
          <a href="../../Global.scala.html#559552" title="(msg: =&gt; AnyRef)Unit">log</a><span class="delimiter">(</span><span title="String(&quot;No mirror class for module with linked class: &quot;)" class="string">&quot;No mirror class for module with linked class: &quot;</span> <span title="(x$1: Any)String">+</span>
              <a href="#789198" title="GenMSIL.this.global.icodes.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443398" title="=&gt; String">fullName</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>

      <a href="#785581" title="(sym: GenMSIL.this.global.Symbol, tBuilder: ch.epfl.lamp.compiler.msil.emit.TypeBuilder)Unit">addSymtabAttribute</a><span class="delimiter">(</span><a href="#789198" title="GenMSIL.this.global.icodes.global.Symbol">sym</a>, <a href="#789199" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">tBuilder</a><span class="delimiter">)</span>
      <a href="#785582" title="(member: ch.epfl.lamp.compiler.msil.emit.ICustomAttributeSetter, annotations: List[GenMSIL.this.global.AnnotationInfo])Unit">addAttributes</a><span class="delimiter">(</span><a href="#789199" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">tBuilder</a>, <a href="#789198" title="GenMSIL.this.global.icodes.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443459" title="=&gt; List[GenMSIL.this.global.icodes.global.AnnotationInfo]">annotations</a><span class="delimiter">)</span>

      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#785831" title="GenMSIL.this.global.icodes.IClass">iclass</a>.<a href="../icode/Members.scala.html#642912" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a> <span title="(x$1: AnyRef)Boolean">!=</span> <a href="../../../../reflect/internal/Definitions.scala.html#441641" title="GenMSIL.this.global.definitions.type">definitions</a>.<a href="../../../../reflect/internal/Definitions.scala.html#442352" title="=&gt; GenMSIL.this.global.ClassSymbol">ArrayClass</a><span class="delimiter">)</span>
        <a href="#785831" title="GenMSIL.this.global.icodes.IClass">iclass</a>.<a href="../icode/Members.scala.html#642918" title="=&gt; List[GenMSIL.this.global.icodes.IMethod]">methods</a> <a href="../../../../collection/LinearSeqOptimized.scala.html#76166" title="(f: GenMSIL.this.global.icodes.IMethod =&gt; Unit)Unit">foreach</a> <a href="#785588" title="(m: GenMSIL.this.global.icodes.IMethod)Unit">genMethod</a>

    <span class="delimiter">}</span> //genClass


    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(m: GenMSIL.this.global.icodes.IMethod)Unit" id="785588">genMethod</a><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.IMethod" id="789298">m</a>: <a href="../icode/Members.scala.html#642680" title="GenMSIL.this.global.icodes.IMethod">IMethod</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="../../Global.scala.html#559553" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><span title="String(&quot;Generating method &quot;)" class="string">&quot;Generating method &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#789298" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#733826" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; flags: &quot;)" class="string">&quot; flags: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="../../symtab/package.scala.html#57302" title="=&gt; reflect.internal.Flags.type">Flags</a>.<a href="../../../../reflect/internal/Flags.scala.html#441022" title="(flags: Long)String">flagsToString</a><span class="delimiter">(</span><a href="#789298" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#733826" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443310" title="=&gt; Long">flags</a><span class="delimiter">)</span> <span title="(x$1: Any)String">+</span>
            <span title="String(&quot; owner: &quot;)" class="string">&quot; owner: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#789298" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#733826" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443379" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">owner</a><span class="delimiter">)</span>
      <a href="#785554" title="(x$1: GenMSIL.this.global.icodes.IMethod)Unit">method</a> = <a href="#789298" title="GenMSIL.this.global.icodes.IMethod">m</a>
      <a href="#785642" title="=&gt; scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.Local,ch.epfl.lamp.compiler.msil.emit.LocalBuilder]">localBuilders</a>.<a href="../../../../collection/mutable/HashMap.scala.html#79201" title="()Unit">clear</a>
      <a href="#785632" title="(m: GenMSIL.this.global.icodes.IMethod)Unit">computeLocalVarsIndex</a><span class="delimiter">(</span><a href="#789298" title="GenMSIL.this.global.icodes.IMethod">m</a><span class="delimiter">)</span>

      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#789298" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#733826" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443264" title="=&gt; Boolean">isClassConstructor</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#785563" title="(x$1: ch.epfl.lamp.compiler.msil.emit.ILGenerator)Unit">mcode</a> = <a href="../../../../collection/MapLike.scala.html#78420" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol)ch.epfl.lamp.compiler.msil.ConstructorInfo">constructors</a><span class="delimiter">(</span><a href="#789298" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#733826" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="ch.epfl.lamp.compiler.msil.emit.ConstructorBuilder" class="delimiter">[</span><span title="ch.epfl.lamp.compiler.msil.emit.ConstructorBuilder">ConstructorBuilder</span><span class="delimiter">]</span>.<span title="()ch.epfl.lamp.compiler.msil.emit.ILGenerator">GetILGenerator</span><span class="delimiter">(</span><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder" id="789347">mBuilder</a> = <a href="../../../../collection/MapLike.scala.html#78420" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol)ch.epfl.lamp.compiler.msil.MethodInfo">methods</a><span class="delimiter">(</span><a href="#789298" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#733826" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder" class="delimiter">[</span><span title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder">MethodBuilder</span><span class="delimiter">]</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../../../Boolean.scala.html#58721" title="=&gt; Boolean">!</a><a href="#789347" title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder">mBuilder</a>.<span title="()Boolean">IsAbstract</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
          <span class="keyword">try</span> <span class="delimiter">{</span>
            <a href="#785563" title="(x$1: ch.epfl.lamp.compiler.msil.emit.ILGenerator)Unit">mcode</a> = <a href="#789347" title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder">mBuilder</a>.<span title="()ch.epfl.lamp.compiler.msil.emit.ILGenerator">GetILGenerator</span><span class="delimiter">(</span><span class="delimiter">)</span>
          <span class="delimiter">}</span> <span class="keyword">catch</span> <span class="delimiter">{</span>
            <span class="keyword">case</span> <a title="Nothing" id="789363">e</a>: <span title="Exception">Exception</span> =&gt;
              java.lang.<span title="System.type">System</span>.<span title="java.io.PrintStream">out</span>.<span title="(x$1: String)Unit">println</span><span class="delimiter">(</span><span title="String(&quot;m.symbol       = &quot;)" class="string">&quot;m.symbol       = &quot;</span> <span title="(x$1: Any)String">+</span> <a href="../../symtab/package.scala.html#57302" title="=&gt; reflect.internal.Flags.type">Flags</a>.<a href="../../../../reflect/internal/Flags.scala.html#441022" title="(flags: Long)String">flagsToString</a><span class="delimiter">(</span><a href="#789298" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#733826" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443310" title="=&gt; Long">flags</a><span class="delimiter">)</span> <span title="(x$1: Any)String">+</span> <span title="String(&quot; &quot;)" class="string">&quot; &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#789298" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#733826" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a><span class="delimiter">)</span>
              java.lang.<span title="System.type">System</span>.<span title="java.io.PrintStream">out</span>.<span title="(x$1: String)Unit">println</span><span class="delimiter">(</span><span title="String(&quot;m.symbol.owner = &quot;)" class="string">&quot;m.symbol.owner = &quot;</span> <span title="(x$1: Any)String">+</span> <a href="../../symtab/package.scala.html#57302" title="=&gt; reflect.internal.Flags.type">Flags</a>.<a href="../../../../reflect/internal/Flags.scala.html#441022" title="(flags: Long)String">flagsToString</a><span class="delimiter">(</span><a href="#789298" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#733826" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443379" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">owner</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443310" title="=&gt; Long">flags</a><span class="delimiter">)</span> <span title="(x$1: Any)String">+</span> <span title="String(&quot; &quot;)" class="string">&quot; &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#789298" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#733826" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443379" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">owner</a><span class="delimiter">)</span>
              java.lang.<span title="System.type">System</span>.<span title="java.io.PrintStream">out</span>.<span title="(x$1: String)Unit">println</span><span class="delimiter">(</span><span title="String(&quot;mBuilder       = &quot;)" class="string">&quot;mBuilder       = &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#789347" title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder">mBuilder</a><span class="delimiter">)</span>
              java.lang.<span title="System.type">System</span>.<span title="java.io.PrintStream">out</span>.<span title="(x$1: String)Unit">println</span><span class="delimiter">(</span><span title="String(&quot;mBuilder.DeclaringType = &quot;)" class="string">&quot;mBuilder.DeclaringType = &quot;</span> <span title="(x$1: Any)String">+</span>
                                 <span title="ch.epfl.lamp.compiler.msil.TypeAttributes.type">TypeAttributes</span>.<span title="(x$1: Int)String">toString</span><span class="delimiter">(</span><a href="#789347" title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder">mBuilder</a>.<span title="ch.epfl.lamp.compiler.msil.Type">DeclaringType</span>.<span title="Int">Attributes</span><span class="delimiter">)</span> <span title="(x$1: Any)String">+</span>
                                 <span title="String(&quot;::&quot;)" class="string">&quot;::&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#789347" title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder">mBuilder</a>.<span title="ch.epfl.lamp.compiler.msil.Type">DeclaringType</span><span class="delimiter">)</span>
              <span title="Nothing" class="keyword">throw</span> <a href="#789363" title="Exception">e</a>
          <span class="delimiter">}</span>
          <span class="keyword">else</span>
            <a href="#785563" title="(x$1: ch.epfl.lamp.compiler.msil.emit.ILGenerator)Unit">mcode</a> = <span title="Null(null)" class="keyword">null</span>
      <span class="delimiter">}</span>

      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="keyword">for</span> <span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.Local" id="789439">local</a> &lt;- <a href="#789298" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../../../../collection/generic/FilterMonadic.scala.html#59082" title="(f: GenMSIL.this.global.icodes.Local =&gt; Unit)Unit">locals</a> ; <span class="keyword">if</span> <a href="../../../../Boolean.scala.html#58721" title="=&gt; Boolean">!</a><span class="delimiter">(</span><a href="#789298" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#733861" title="=&gt; List[GenMSIL.this.global.icodes.Local]">params</a> <a href="../../../../collection/SeqLike.scala.html#59768" title="(elem: Any)Boolean">contains</a> <a href="#789439" title="GenMSIL.this.global.icodes.Local">local</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="../../Global.scala.html#559553" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><span title="String(&quot;add local var: &quot;)" class="string">&quot;add local var: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#789439" title="GenMSIL.this.global.icodes.Local">local</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;, of kind &quot;)" class="string">&quot;, of kind &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#789439" title="GenMSIL.this.global.icodes.Local">local</a>.<a href="../icode/Members.scala.html#734265" title="=&gt; GenMSIL.this.global.icodes.TypeKind">kind</a><span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.Type" id="789440">t</a>: <span title="ch.epfl.lamp.compiler.msil.Type">MsilType</span> = <a href="#785645" title="(t: GenMSIL.this.global.icodes.TypeKind)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">(</span><a href="#789439" title="GenMSIL.this.global.icodes.Local">local</a>.<a href="../icode/Members.scala.html#734265" title="=&gt; GenMSIL.this.global.icodes.TypeKind">kind</a><span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.LocalBuilder" id="789441">localBuilder</a> = <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(localType: ch.epfl.lamp.compiler.msil.Type)ch.epfl.lamp.compiler.msil.emit.LocalBuilder">DeclareLocal</span><span class="delimiter">(</span><a href="#789440" title="ch.epfl.lamp.compiler.msil.Type">t</a><span class="delimiter">)</span>
          <a href="#789441" title="ch.epfl.lamp.compiler.msil.emit.LocalBuilder">localBuilder</a>.<span title="(name: String)Unit">SetLocalSymInfo</span><span class="delimiter">(</span><a href="#785633" title="(sym: GenMSIL.this.global.Symbol)String">msilName</a><span class="delimiter">(</span><a href="#789439" title="GenMSIL.this.global.icodes.Local">local</a>.<a href="../icode/Members.scala.html#734263" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <a href="../../../../collection/mutable/HashMap.scala.html#79209" title="(key: GenMSIL.this.global.icodes.Local, value: ch.epfl.lamp.compiler.msil.emit.LocalBuilder)Unit">localBuilders</a><span class="delimiter">(</span><a href="#789439" title="GenMSIL.this.global.icodes.Local">local</a><span class="delimiter">)</span> = <a href="#789441" title="ch.epfl.lamp.compiler.msil.emit.LocalBuilder">localBuilder</a>
        <span class="delimiter">}</span>
        <a href="#785596" title="(m: GenMSIL.this.global.icodes.IMethod)Unit">genCode</a><span class="delimiter">(</span><a href="#789298" title="GenMSIL.this.global.icodes.IMethod">m</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>

    <span class="delimiter">}</span>

    /** Special linearizer for methods with at least one exception handler. This
     *  linearizer brings all basic blocks in the right order so that nested
     *  try-catch and try-finally blocks can be emitted.
     */
    <span class="keyword">val</span> <a title="GenMSIL.this.global.icodes.MSILLinearizer" id="785589">msilLinearizer</a> = <span title="GenMSIL.this.global.icodes.MSILLinearizer" class="keyword">new</span> <a href="../icode/Linearizers.scala.html#642852" title="GenMSIL.this.global.icodes.MSILLinearizer">MSILLinearizer</a><span class="delimiter">(</span><span class="delimiter">)</span>

    <span class="keyword">val</span> <a title="scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.BasicBlock,ch.epfl.lamp.compiler.msil.emit.Label]" id="785591">labels</a> = mutable.<a href="../../../../collection/generic/GenMapFactory.scala.html#61654" title="[A, B](elems: (A, B)*)scala.collection.mutable.HashMap[A,B]">HashMap</a><span title="(elems: (GenMSIL.this.global.icodes.BasicBlock, ch.epfl.lamp.compiler.msil.emit.Label)*)scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.BasicBlock,ch.epfl.lamp.compiler.msil.emit.Label]" class="delimiter">[</span><a href="../icode/BasicBlocks.scala.html#642689" title="GenMSIL.this.global.icodes.BasicBlock">BasicBlock</a>, <span title="ch.epfl.lamp.compiler.msil.emit.Label">Label</span><span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>

    /* when emitting .line, it's enough to include the full filename just once per method, thus reducing filesize.
     * this scheme relies on the fact that the entry block is emitted first. */
    <span class="keyword">var</span> <a title="Boolean" id="785594">dbFilenameSeen</a> = <span title="Boolean(false)" class="keyword">false</span>

    <span class="keyword">def</span> <a title="(m: GenMSIL.this.global.icodes.IMethod)Unit" id="785596">genCode</a><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.IMethod" id="789455">m</a>: <a href="../icode/Members.scala.html#642680" title="GenMSIL.this.global.icodes.IMethod">IMethod</a><span class="delimiter">)</span> <span class="delimiter">{</span>

      <span class="keyword">def</span> <a title="(blocks: List[GenMSIL.this.global.icodes.BasicBlock])Unit" id="789456">makeLabels</a><span class="delimiter">(</span><a title="List[GenMSIL.this.global.icodes.BasicBlock]" id="789458">blocks</a>: <a href="../../../../collection/immutable/List.scala.html#12322" title="List[GenMSIL.this.global.icodes.BasicBlock]">List</a><span class="delimiter">[</span>BasicBlock<span class="delimiter">]</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
        <a href="../../Global.scala.html#559553" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><span title="String(&quot;Making labels for: &quot;)" class="string">&quot;Making labels for: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#785554" title="=&gt; GenMSIL.this.global.icodes.IMethod">method</a><span class="delimiter">)</span>
        <span class="keyword">for</span> <span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.BasicBlock" id="789478">bb</a> &lt;- <a href="../../../../collection/LinearSeqOptimized.scala.html#76166" title="(f: GenMSIL.this.global.icodes.BasicBlock =&gt; Unit)Unit">blocks</a><span class="delimiter">)</span> <a href="../../../../collection/mutable/HashMap.scala.html#79209" title="(key: GenMSIL.this.global.icodes.BasicBlock, value: ch.epfl.lamp.compiler.msil.emit.Label)Unit">labels</a><span class="delimiter">(</span><a href="#789478" title="GenMSIL.this.global.icodes.BasicBlock">bb</a><span class="delimiter">)</span> = <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="()ch.epfl.lamp.compiler.msil.emit.Label">DefineLabel</span><span class="delimiter">(</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>

      <a href="#785591" title="=&gt; scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.BasicBlock,ch.epfl.lamp.compiler.msil.emit.Label]">labels</a>.<a href="../../../../collection/mutable/HashMap.scala.html#79201" title="()Unit">clear</a>

      <span class="keyword">var</span> <a title="List[GenMSIL.this.global.icodes.BasicBlock]" id="789457">linearization</a> = <span title="List[GenMSIL.this.global.icodes.BasicBlock]" class="keyword">if</span><span class="delimiter">(</span><a href="../../../../Boolean.scala.html#58721" title="=&gt; Boolean">!</a><a href="#789455" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#733846" title="=&gt; List[GenMSIL.this.global.icodes.ExceptionHandler]">exh</a>.<a href="../../../../collection/IterableLike.scala.html#59464" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <a href="#785589" title="=&gt; GenMSIL.this.global.icodes.MSILLinearizer">msilLinearizer</a>.<a href="../icode/Linearizers.scala.html#753390" title="(m: GenMSIL.this.global.icodes.IMethod)List[GenMSIL.this.global.icodes.BasicBlock]">linearize</a><span class="delimiter">(</span><a href="#789455" title="GenMSIL.this.global.icodes.IMethod">m</a><span class="delimiter">)</span>
                          <span class="keyword">else</span> <a href="../icode/ICodes.scala.html#642633" title="=&gt; GenMSIL.this.global.icodes.Linearizer">linearizer</a>.<a href="../icode/Linearizers.scala.html#752597" title="(c: GenMSIL.this.global.icodes.IMethod)List[GenMSIL.this.global.icodes.BasicBlock]">linearize</a><span class="delimiter">(</span><a href="#789455" title="GenMSIL.this.global.icodes.IMethod">m</a><span class="delimiter">)</span>

      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../../../Boolean.scala.html#58721" title="=&gt; Boolean">!</a><a href="#789455" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#733846" title="=&gt; List[GenMSIL.this.global.icodes.ExceptionHandler]">exh</a>.<a href="../../../../collection/IterableLike.scala.html#59464" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span>
        <a href="#789457" title="List[GenMSIL.this.global.icodes.BasicBlock]">linearization</a> = <a href="#785622" title="(blocks: List[GenMSIL.this.global.icodes.BasicBlock], m: GenMSIL.this.global.icodes.IMethod)List[GenMSIL.this.global.icodes.BasicBlock]">computeExceptionMaps</a><span class="delimiter">(</span><a href="#789457" title="List[GenMSIL.this.global.icodes.BasicBlock]">linearization</a>, <a href="#789455" title="GenMSIL.this.global.icodes.IMethod">m</a><span class="delimiter">)</span>

      <a href="#789456" title="(blocks: List[GenMSIL.this.global.icodes.BasicBlock])Unit">makeLabels</a><span class="delimiter">(</span><a href="#789457" title="List[GenMSIL.this.global.icodes.BasicBlock]">linearization</a><span class="delimiter">)</span>

      // debug val blocksInM = m.code.blocks.toList.sortBy(bb =&gt; bb.label)
      // debug val blocksInL = linearization.sortBy(bb =&gt; bb.label)
      // debug val MButNotL  = (blocksInM.toSet) diff (blocksInL.toSet) // if non-empty, a jump to B fails to find a label for B (case CJUMP, case CZJUMP)
      // debug if(!MButNotL.isEmpty) { }

      <a href="#785594" title="(x$1: Boolean)Unit">dbFilenameSeen</a> = <span title="Boolean(false)" class="keyword">false</span>
      <a href="#785597" title="(blocks: List[GenMSIL.this.global.icodes.BasicBlock], previous: GenMSIL.this.global.icodes.BasicBlock)Unit">genBlocks</a><span class="delimiter">(</span><a href="#789457" title="List[GenMSIL.this.global.icodes.BasicBlock]">linearization</a><span class="delimiter">)</span>

      // RETURN inside exception blocks are replaced by Leave. The target of the
      // leave is a `Ret` outside any exception block (generated here).
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#785608" title="=&gt; GenMSIL.this.global.icodes.IMethod">handlerReturnMethod</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#789455" title="GenMSIL.this.global.icodes.IMethod">m</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(label: ch.epfl.lamp.compiler.msil.emit.Label)Unit">MarkLabel</span><span class="delimiter">(</span><a href="#785614" title="=&gt; ch.epfl.lamp.compiler.msil.emit.Label">handlerReturnLabel</a><span class="delimiter">)</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#785617" title="=&gt; GenMSIL.this.global.icodes.TypeKind">handlerReturnKind</a> <span title="(x$1: AnyRef)Boolean">!=</span> <a href="../icode/TypeKinds.scala.html#642717" title="GenMSIL.this.global.icodes.UNIT.type">UNIT</a><span class="delimiter">)</span>
          <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.emit.LocalBuilder)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldloc</span>, <a href="#785611" title="=&gt; ch.epfl.lamp.compiler.msil.emit.LocalBuilder">handlerReturnLocal</a><span class="delimiter">)</span>
        <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ret</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>

      <a href="#785598" title="=&gt; scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.BasicBlock,List[GenMSIL.this.global.icodes.ExceptionHandler]]">beginExBlock</a>.<a href="../../../../collection/mutable/HashMap.scala.html#79201" title="()Unit">clear</a><span class="delimiter">(</span><span class="delimiter">)</span>
      <a href="#785600" title="=&gt; scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.BasicBlock,GenMSIL.this.global.icodes.ExceptionHandler]">beginCatchBlock</a>.<a href="../../../../collection/mutable/HashMap.scala.html#79201" title="()Unit">clear</a><span class="delimiter">(</span><span class="delimiter">)</span>
      <a href="#785602" title="=&gt; scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.BasicBlock,List[GenMSIL.this.global.icodes.ExceptionHandler]]">endExBlock</a>.<a href="../../../../collection/mutable/HashMap.scala.html#79201" title="()Unit">clear</a><span class="delimiter">(</span><span class="delimiter">)</span>
      <a href="#785620" title="=&gt; scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.ExceptionHandler,ch.epfl.lamp.compiler.msil.emit.Label]">endFinallyLabels</a>.<a href="../../../../collection/mutable/HashMap.scala.html#79201" title="()Unit">clear</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="(blocks: List[GenMSIL.this.global.icodes.BasicBlock], previous: GenMSIL.this.global.icodes.BasicBlock)Unit" id="785597">genBlocks</a><span class="delimiter">(</span><a title="List[GenMSIL.this.global.icodes.BasicBlock]" id="789491">blocks</a>: <a href="../../../../collection/immutable/List.scala.html#12322" title="List[GenMSIL.this.global.icodes.BasicBlock]">List</a><span class="delimiter">[</span>BasicBlock<span class="delimiter">]</span>, <a title="GenMSIL.this.global.icodes.BasicBlock" id="789493">previous</a>: <a href="../icode/BasicBlocks.scala.html#642689" title="GenMSIL.this.global.icodes.BasicBlock">BasicBlock</a> = <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#789491" title="List[GenMSIL.this.global.icodes.BasicBlock]">blocks</a> <span class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <a href="../../../../collection/immutable/List.scala.html#11552" title="Unit" id="789549">Nil</a> =&gt; <a href="#789552" title="(x: Unit)Unit" class="delimiter">(</a><span class="delimiter">)</span>
        <span class="keyword">case</span> x <a href="#789541" title="Boolean" id="789544">::</a> <a href="../../../../collection/immutable/List.scala.html#11552" title="Unit" id="789550">Nil</a> =&gt; <a href="#785623" title="(block: GenMSIL.this.global.icodes.BasicBlock, prev: GenMSIL.this.global.icodes.BasicBlock, next: GenMSIL.this.global.icodes.BasicBlock)Unit">genBlock</a><a href="#789552" title="(x: Unit)Unit" class="delimiter">(</a>x, prev = <a href="#789493" title="GenMSIL.this.global.icodes.BasicBlock">previous</a>, next = <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span>
        <span class="keyword">case</span> x :: y <a title="Unit" id="789548">::</a> ys =&gt; <a href="#785623" title="(block: GenMSIL.this.global.icodes.BasicBlock, prev: GenMSIL.this.global.icodes.BasicBlock, next: GenMSIL.this.global.icodes.BasicBlock)Unit">genBlock</a><span class="delimiter">(</span>x, prev = <a href="#789493" title="GenMSIL.this.global.icodes.BasicBlock">previous</a>, next = y<span class="delimiter">)</span>; <a href="#785597" title="(blocks: List[GenMSIL.this.global.icodes.BasicBlock], previous: GenMSIL.this.global.icodes.BasicBlock)Unit">genBlocks</a><span class="delimiter">(</span>y <a href="../../../../collection/immutable/List.scala.html#63643" title="(x: GenMSIL.this.global.icodes.BasicBlock)List[GenMSIL.this.global.icodes.BasicBlock]">::</a> ys, previous = x<span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    // the try blocks starting at a certain BasicBlock
    <span class="keyword">val</span> <a title="scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.BasicBlock,List[GenMSIL.this.global.icodes.ExceptionHandler]]" id="785598">beginExBlock</a> = mutable.<a href="../../../../collection/generic/GenMapFactory.scala.html#61654" title="[A, B](elems: (A, B)*)scala.collection.mutable.HashMap[A,B]">HashMap</a><span title="(elems: (GenMSIL.this.global.icodes.BasicBlock, List[GenMSIL.this.global.icodes.ExceptionHandler])*)scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.BasicBlock,List[GenMSIL.this.global.icodes.ExceptionHandler]]" class="delimiter">[</span><a href="../icode/BasicBlocks.scala.html#642689" title="GenMSIL.this.global.icodes.BasicBlock">BasicBlock</a>, <a href="../../../../collection/immutable/List.scala.html#12322" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">List</a><span class="delimiter">[</span>ExceptionHandler<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>

    // the catch blocks starting / endling at a certain BasicBlock
    <span class="keyword">val</span> <a title="scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.BasicBlock,GenMSIL.this.global.icodes.ExceptionHandler]" id="785600">beginCatchBlock</a> = mutable.<a href="../../../../collection/generic/GenMapFactory.scala.html#61654" title="[A, B](elems: (A, B)*)scala.collection.mutable.HashMap[A,B]">HashMap</a><span title="(elems: (GenMSIL.this.global.icodes.BasicBlock, GenMSIL.this.global.icodes.ExceptionHandler)*)scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.BasicBlock,GenMSIL.this.global.icodes.ExceptionHandler]" class="delimiter">[</span><a href="../icode/BasicBlocks.scala.html#642689" title="GenMSIL.this.global.icodes.BasicBlock">BasicBlock</a>, <a href="../icode/ExceptionHandlers.scala.html#642757" title="GenMSIL.this.global.icodes.ExceptionHandler">ExceptionHandler</a><span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.BasicBlock,List[GenMSIL.this.global.icodes.ExceptionHandler]]" id="785602">endExBlock</a> = mutable.<a href="../../../../collection/generic/GenMapFactory.scala.html#61654" title="[A, B](elems: (A, B)*)scala.collection.mutable.HashMap[A,B]">HashMap</a><span title="(elems: (GenMSIL.this.global.icodes.BasicBlock, List[GenMSIL.this.global.icodes.ExceptionHandler])*)scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.BasicBlock,List[GenMSIL.this.global.icodes.ExceptionHandler]]" class="delimiter">[</span><a href="../icode/BasicBlocks.scala.html#642689" title="GenMSIL.this.global.icodes.BasicBlock">BasicBlock</a>, <a href="../../../../collection/immutable/List.scala.html#12322" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">List</a><span class="delimiter">[</span>ExceptionHandler<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>

    /** When emitting the code (genBlock), the number of currently active try / catch
     *  blocks. When seeing a `RETURN` inside a try / catch, we need to
     *   - store the result in a local (if it's not UNIT)
     *   - emit `Leave handlerReturnLabel` instead of the Return
     *   - emit code at the end: load the local and return its value
     */
    <span class="keyword">var</span> <a title="scala.collection.mutable.Stack[GenMSIL.this.global.icodes.ExceptionHandler]" id="785605">currentHandlers</a> = <a href="../../../../collection/mutable/Stack.scala.html#307326" title="()scala.collection.mutable.Stack[GenMSIL.this.global.icodes.ExceptionHandler]" class="keyword">new</a> mutable.<a href="../../../../collection/mutable/Stack.scala.html#13687" title="scala.collection.mutable.Stack[GenMSIL.this.global.icodes.ExceptionHandler]">Stack</a><span class="delimiter">[</span>ExceptionHandler<span class="delimiter">]</span>
    // The IMethod the Local/Label/Kind below belong to
    <span class="keyword">var</span> <a title="GenMSIL.this.global.icodes.IMethod" id="785608">handlerReturnMethod</a>: <a href="../icode/Members.scala.html#642680" title="GenMSIL.this.global.icodes.IMethod">IMethod</a> = _
    // Stores the result when returning inside an exception block
    <span class="keyword">var</span> <a title="ch.epfl.lamp.compiler.msil.emit.LocalBuilder" id="785611">handlerReturnLocal</a>: <span title="ch.epfl.lamp.compiler.msil.emit.LocalBuilder">LocalBuilder</span> = _
    // Label for a return instruction outside any exception block
    <span class="keyword">var</span> <a title="ch.epfl.lamp.compiler.msil.emit.Label" id="785614">handlerReturnLabel</a>: <span title="ch.epfl.lamp.compiler.msil.emit.Label">Label</span> = _
    // The result kind.
    <span class="keyword">var</span> <a title="GenMSIL.this.global.icodes.TypeKind" id="785617">handlerReturnKind</a>: <a href="../icode/TypeKinds.scala.html#642711" title="GenMSIL.this.global.icodes.TypeKind">TypeKind</a> = _
    <span class="keyword">def</span> <a title="(kind: GenMSIL.this.global.icodes.TypeKind)(ch.epfl.lamp.compiler.msil.emit.LocalBuilder, ch.epfl.lamp.compiler.msil.emit.Label)" id="785619">returnFromHandler</a><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.TypeKind" id="789564">kind</a>: <a href="../icode/TypeKinds.scala.html#642711" title="GenMSIL.this.global.icodes.TypeKind">TypeKind</a><span class="delimiter">)</span>: <a href="../../../../Tuple2.scala.html#1222" title="(ch.epfl.lamp.compiler.msil.emit.LocalBuilder, ch.epfl.lamp.compiler.msil.emit.Label)" class="delimiter">(</a>LocalBuilder, Label<span class="delimiter">)</span> = <span class="delimiter">{</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#785608" title="=&gt; GenMSIL.this.global.icodes.IMethod">handlerReturnMethod</a> <span title="(x$1: AnyRef)Boolean">!=</span> <a href="#785554" title="=&gt; GenMSIL.this.global.icodes.IMethod">method</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#785608" title="(x$1: GenMSIL.this.global.icodes.IMethod)Unit">handlerReturnMethod</a> = <a href="#785554" title="=&gt; GenMSIL.this.global.icodes.IMethod">method</a>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#789564" title="GenMSIL.this.global.icodes.TypeKind">kind</a> <span title="(x$1: AnyRef)Boolean">!=</span> <a href="../icode/TypeKinds.scala.html#642717" title="GenMSIL.this.global.icodes.UNIT.type">UNIT</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="#785611" title="(x$1: ch.epfl.lamp.compiler.msil.emit.LocalBuilder)Unit">handlerReturnLocal</a> = <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(localType: ch.epfl.lamp.compiler.msil.Type)ch.epfl.lamp.compiler.msil.emit.LocalBuilder">DeclareLocal</span><span class="delimiter">(</span><a href="#785645" title="(t: GenMSIL.this.global.icodes.TypeKind)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">(</span><a href="#789564" title="GenMSIL.this.global.icodes.TypeKind">kind</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <a href="#785611" title="=&gt; ch.epfl.lamp.compiler.msil.emit.LocalBuilder">handlerReturnLocal</a>.<span title="(name: String)Unit">SetLocalSymInfo</span><span class="delimiter">(</span><span title="String(&quot;$handlerReturn&quot;)" class="string">&quot;$handlerReturn&quot;</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>
        <a href="#785614" title="(x$1: ch.epfl.lamp.compiler.msil.emit.Label)Unit">handlerReturnLabel</a> = <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="()ch.epfl.lamp.compiler.msil.emit.Label">DefineLabel</span><span class="delimiter">(</span><span class="delimiter">)</span>
        <a href="#785617" title="(x$1: GenMSIL.this.global.icodes.TypeKind)Unit">handlerReturnKind</a> = <a href="#789564" title="GenMSIL.this.global.icodes.TypeKind">kind</a>
      <span class="delimiter">}</span>
      <a href="../../../../Tuple2.scala.html#63804" title="(_1: ch.epfl.lamp.compiler.msil.emit.LocalBuilder, _2: ch.epfl.lamp.compiler.msil.emit.Label)(ch.epfl.lamp.compiler.msil.emit.LocalBuilder, ch.epfl.lamp.compiler.msil.emit.Label)" class="delimiter">(</a><a href="#785611" title="=&gt; ch.epfl.lamp.compiler.msil.emit.LocalBuilder">handlerReturnLocal</a>, <a href="#785614" title="=&gt; ch.epfl.lamp.compiler.msil.emit.Label">handlerReturnLabel</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    /** For try/catch nested inside a finally, we can't use `Leave OutsideFinally`, the
     *  Leave target has to be inside the finally (and it has to be the `endfinally` instruction).
     *  So for every finalizer, we have a label which marks the place of the `endfinally`,
     *  nested try/catch blocks will leave there.
     */
    <span class="keyword">val</span> <a title="scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.ExceptionHandler,ch.epfl.lamp.compiler.msil.emit.Label]" id="785620">endFinallyLabels</a> = mutable.<a href="../../../../collection/generic/GenMapFactory.scala.html#61654" title="[A, B](elems: (A, B)*)scala.collection.mutable.HashMap[A,B]">HashMap</a><span title="(elems: (GenMSIL.this.global.icodes.ExceptionHandler, ch.epfl.lamp.compiler.msil.emit.Label)*)scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.ExceptionHandler,ch.epfl.lamp.compiler.msil.emit.Label]" class="delimiter">[</span><a href="../icode/ExceptionHandlers.scala.html#642757" title="GenMSIL.this.global.icodes.ExceptionHandler">ExceptionHandler</a>, <span title="ch.epfl.lamp.compiler.msil.emit.Label">Label</span><span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>

    /** Computes which blocks are the beginning / end of a try or catch block */
    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(blocks: List[GenMSIL.this.global.icodes.BasicBlock], m: GenMSIL.this.global.icodes.IMethod)List[GenMSIL.this.global.icodes.BasicBlock]" id="785622">computeExceptionMaps</a><span class="delimiter">(</span><a title="List[GenMSIL.this.global.icodes.BasicBlock]" id="789489">blocks</a>: <a href="../../../../collection/immutable/List.scala.html#12322" title="List[GenMSIL.this.global.icodes.BasicBlock]">List</a><span class="delimiter">[</span>BasicBlock<span class="delimiter">]</span>, <a title="GenMSIL.this.global.icodes.IMethod" id="789490">m</a>: <a href="../icode/Members.scala.html#642680" title="GenMSIL.this.global.icodes.IMethod">IMethod</a><span class="delimiter">)</span>: <a href="../../../../collection/immutable/List.scala.html#12322" title="List[GenMSIL.this.global.icodes.BasicBlock]">List</a><span class="delimiter">[</span>BasicBlock<span class="delimiter">]</span> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="scala.collection.mutable.HashSet[GenMSIL.this.global.icodes.BasicBlock]" id="789586">visitedBlocks</a> = <a href="../../../../collection/mutable/HashSet.scala.html#141566" title="()scala.collection.mutable.HashSet[GenMSIL.this.global.icodes.BasicBlock]" class="keyword">new</a> mutable.<a href="../../../../collection/mutable/HashSet.scala.html#13456" title="scala.collection.mutable.HashSet[GenMSIL.this.global.icodes.BasicBlock]">HashSet</a><span class="delimiter">[</span>BasicBlock<span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>

      // handlers which have not been introduced so far
      <span class="keyword">var</span> <a title="List[GenMSIL.this.global.icodes.ExceptionHandler]" id="789587">openHandlers</a> = <a href="#789490" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#733846" title="=&gt; List[GenMSIL.this.global.icodes.ExceptionHandler]">exh</a>


      /** Example
       *   try {
       *     try {
       *         // *1*
       *     } catch {
       *       case h1 =&gt;
       *     }
       *   } catch {
       *     case h2 =&gt;
       *     case h3 =&gt;
       *       try {
       *
       *       } catch {
       *         case h4 =&gt;  // *2*
       *         case h5 =&gt;
       *       }
       *   }
       */

      // Stack of nested try blocks. Each bloc has a List of ExceptionHandler (multiple
      // catch statements). Example *1*: Stack(List(h2, h3), List(h1))
      <span class="keyword">val</span> <a title="scala.collection.mutable.Stack[List[GenMSIL.this.global.icodes.ExceptionHandler]]" id="789588">currentTryHandlers</a> = <a href="../../../../collection/mutable/Stack.scala.html#307326" title="()scala.collection.mutable.Stack[List[GenMSIL.this.global.icodes.ExceptionHandler]]" class="keyword">new</a> mutable.<a href="../../../../collection/mutable/Stack.scala.html#13687" title="scala.collection.mutable.Stack[List[GenMSIL.this.global.icodes.ExceptionHandler]]">Stack</a><span class="delimiter">[</span>List<span class="delimiter">[</span>ExceptionHandler<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>

      // Stack of nested catch blocks. The head of the list is the current catch block. The
      // tail is all following catch blocks. Example *2*: Stack(List(h3), List(h4, h5))
      <span class="keyword">val</span> <a title="scala.collection.mutable.Stack[List[GenMSIL.this.global.icodes.ExceptionHandler]]" id="789589">currentCatchHandlers</a> = <a href="../../../../collection/mutable/Stack.scala.html#307326" title="()scala.collection.mutable.Stack[List[GenMSIL.this.global.icodes.ExceptionHandler]]" class="keyword">new</a> mutable.<a href="../../../../collection/mutable/Stack.scala.html#13687" title="scala.collection.mutable.Stack[List[GenMSIL.this.global.icodes.ExceptionHandler]]">Stack</a><span class="delimiter">[</span>List<span class="delimiter">[</span>ExceptionHandler<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>

      <span class="keyword">for</span> <span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.BasicBlock" id="789614">b</a> &lt;- <a href="../../../../collection/LinearSeqOptimized.scala.html#76166" title="(f: GenMSIL.this.global.icodes.BasicBlock =&gt; scala.collection.mutable.HashSet[GenMSIL.this.global.icodes.BasicBlock])Unit">blocks</a><span class="delimiter">)</span> <span class="delimiter">{</span>

        // are we past the current catch blocks?
        <span class="keyword">def</span> <a title="()List[GenMSIL.this.global.icodes.ExceptionHandler]" id="789615">endHandlers</a><span class="delimiter">(</span><span class="delimiter">)</span>: <a href="../../../../collection/immutable/List.scala.html#12322" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">List</a><span class="delimiter">[</span>ExceptionHandler<span class="delimiter">]</span> = <span class="delimiter">{</span>
          <span class="keyword">var</span> <a title="List[GenMSIL.this.global.icodes.ExceptionHandler]" id="789623">res</a>: <a href="../../../../collection/immutable/List.scala.html#12322" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">List</a><span class="delimiter">[</span>ExceptionHandler<span class="delimiter">]</span> = <a href="../../../../collection/immutable/List.scala.html#11552" title="scala.collection.immutable.Nil.type">Nil</a>
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../../../Boolean.scala.html#58721" title="=&gt; Boolean">!</a><a href="#789589" title="scala.collection.mutable.Stack[List[GenMSIL.this.global.icodes.ExceptionHandler]]">currentCatchHandlers</a>.<a href="../../../../collection/mutable/Stack.scala.html#307328" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <span class="delimiter">{</span>
            <span class="keyword">val</span> <a title="GenMSIL.this.global.icodes.ExceptionHandler" id="789624">handler</a> = <a href="#789589" title="scala.collection.mutable.Stack[List[GenMSIL.this.global.icodes.ExceptionHandler]]">currentCatchHandlers</a>.<a href="../../../../collection/mutable/Stack.scala.html#307335" title="=&gt; List[GenMSIL.this.global.icodes.ExceptionHandler]">top</a>.<a href="../../../../collection/IterableLike.scala.html#59473" title="=&gt; GenMSIL.this.global.icodes.ExceptionHandler">head</a>
            <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../../../Boolean.scala.html#58721" title="=&gt; Boolean">!</a><a href="#789624" title="GenMSIL.this.global.icodes.ExceptionHandler">handler</a>.<a href="../icode/ExceptionHandlers.scala.html#734077" title="=&gt; List[GenMSIL.this.global.icodes.BasicBlock]">blocks</a>.<a href="../../../../collection/SeqLike.scala.html#59768" title="(elem: Any)Boolean">contains</a><span class="delimiter">(</span><a href="#789614" title="GenMSIL.this.global.icodes.BasicBlock">b</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
              // all blocks of the handler are either visited, or not part of the linearization (i.e. dead)
              <a href="../../Global.scala.html#559533" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a><span class="delimiter">(</span><a href="#789624" title="GenMSIL.this.global.icodes.ExceptionHandler">handler</a>.<a href="../icode/ExceptionHandlers.scala.html#734077" title="=&gt; List[GenMSIL.this.global.icodes.BasicBlock]">blocks</a>.<a href="../../../../collection/LinearSeqOptimized.scala.html#76169" title="(p: GenMSIL.this.global.icodes.BasicBlock =&gt; Boolean)Boolean">forall</a><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.BasicBlock" id="789644">b</a> =&gt; <a href="#789586" title="scala.collection.mutable.HashSet[GenMSIL.this.global.icodes.BasicBlock]">visitedBlocks</a>.<a href="../../../../collection/mutable/HashSet.scala.html#141569" title="(elem: GenMSIL.this.global.icodes.BasicBlock)Boolean">contains</a><span class="delimiter">(</span><a href="#789644" title="GenMSIL.this.global.icodes.BasicBlock">b</a><span class="delimiter">)</span> <a href="../../../../Boolean.scala.html#58724" title="(x: Boolean)Boolean">||</a> <a href="../../../../Boolean.scala.html#58721" title="=&gt; Boolean">!</a><a href="#789489" title="List[GenMSIL.this.global.icodes.BasicBlock]">blocks</a>.<a href="../../../../collection/SeqLike.scala.html#59768" title="(elem: Any)Boolean">contains</a><span class="delimiter">(</span><a href="#789644" title="GenMSIL.this.global.icodes.BasicBlock">b</a><span class="delimiter">)</span><span class="delimiter">)</span>,
                     <span title="String(&quot;Bad linearization of basic blocks inside catch. Found block not part of the handler\n&quot;)" class="string">&quot;Bad linearization of basic blocks inside catch. Found block not part of the handler\n&quot;</span><span title="(x$1: Any)String">+</span>
                     <a href="#789614" title="GenMSIL.this.global.icodes.BasicBlock">b</a>.<a href="../icode/BasicBlocks.scala.html#733819" title="=&gt; String">fullString</a> <span title="(x$1: Any)String">+</span><span title="String(&quot;\nwhile in catch-part of\n&quot;)" class="string">&quot;\nwhile in catch-part of\n&quot;</span><span title="(x$1: Any)String">+</span> <a href="#789624" title="GenMSIL.this.global.icodes.ExceptionHandler">handler</a><span class="delimiter">)</span>

              <span class="keyword">val</span> <a title="List[GenMSIL.this.global.icodes.ExceptionHandler]" id="789630">rest</a> = <a href="#789589" title="scala.collection.mutable.Stack[List[GenMSIL.this.global.icodes.ExceptionHandler]]">currentCatchHandlers</a>.<a href="../../../../collection/mutable/Stack.scala.html#307336" title="()List[GenMSIL.this.global.icodes.ExceptionHandler]">pop</a>.<a href="../../../../collection/TraversableLike.scala.html#59012" title="=&gt; List[GenMSIL.this.global.icodes.ExceptionHandler]">tail</a>
              <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#789630" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">rest</a>.<a href="../../../../collection/IterableLike.scala.html#59464" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <span class="delimiter">{</span>
                // all catch blocks of that exception handler are covered
                <a href="#789623" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">res</a> = <a href="#789624" title="GenMSIL.this.global.icodes.ExceptionHandler">handler</a> <a href="../../../../collection/immutable/List.scala.html#63643" title="(x: GenMSIL.this.global.icodes.ExceptionHandler)List[GenMSIL.this.global.icodes.ExceptionHandler]">::</a> <a href="#789615" title="()List[GenMSIL.this.global.icodes.ExceptionHandler]">endHandlers</a><span class="delimiter">(</span><span class="delimiter">)</span>
              <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
                // there are more catch blocks for that try (handlers covering the same)
                <a href="#789589" title="scala.collection.mutable.Stack[List[GenMSIL.this.global.icodes.ExceptionHandler]]">currentCatchHandlers</a>.<a href="../../../../collection/mutable/Stack.scala.html#307332" title="(elem: List[GenMSIL.this.global.icodes.ExceptionHandler])currentCatchHandlers.type">push</a><span class="delimiter">(</span><a href="#789630" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">rest</a><span class="delimiter">)</span>
                <a href="../../../../collection/mutable/HashMap.scala.html#79209" title="(key: GenMSIL.this.global.icodes.BasicBlock, value: GenMSIL.this.global.icodes.ExceptionHandler)Unit">beginCatchBlock</a><span class="delimiter">(</span><a href="#789614" title="GenMSIL.this.global.icodes.BasicBlock">b</a><span class="delimiter">)</span> = <a href="#789630" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">rest</a>.<a href="../../../../collection/IterableLike.scala.html#59473" title="=&gt; GenMSIL.this.global.icodes.ExceptionHandler">head</a>
              <span class="delimiter">}</span>
            <span class="delimiter">}</span>
          <span class="delimiter">}</span>
          <a href="#789623" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">res</a>
        <span class="delimiter">}</span>
        <span class="keyword">val</span> <a title="List[GenMSIL.this.global.icodes.ExceptionHandler]" id="789616">end</a> = <a href="#789615" title="()List[GenMSIL.this.global.icodes.ExceptionHandler]">endHandlers</a><span class="delimiter">(</span><span class="delimiter">)</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../../../Boolean.scala.html#58721" title="=&gt; Boolean">!</a><a href="#789616" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">end</a>.<a href="../../../../collection/IterableLike.scala.html#59464" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <a href="../../../../collection/mutable/HashMap.scala.html#79209" title="(key: GenMSIL.this.global.icodes.BasicBlock, value: List[GenMSIL.this.global.icodes.ExceptionHandler])Unit">endExBlock</a><span class="delimiter">(</span><a href="#789614" title="GenMSIL.this.global.icodes.BasicBlock">b</a><span class="delimiter">)</span> = <a href="#789616" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">end</a>

        // are we past the current try block?
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../../../Boolean.scala.html#58721" title="=&gt; Boolean">!</a><a href="#789588" title="scala.collection.mutable.Stack[List[GenMSIL.this.global.icodes.ExceptionHandler]]">currentTryHandlers</a>.<a href="../../../../collection/mutable/Stack.scala.html#307328" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <span class="keyword">val</span> <a title="GenMSIL.this.global.icodes.ExceptionHandler" id="789669">handler</a> = <a href="#789588" title="scala.collection.mutable.Stack[List[GenMSIL.this.global.icodes.ExceptionHandler]]">currentTryHandlers</a>.<a href="../../../../collection/mutable/Stack.scala.html#307335" title="=&gt; List[GenMSIL.this.global.icodes.ExceptionHandler]">top</a>.<a href="../../../../collection/IterableLike.scala.html#59473" title="=&gt; GenMSIL.this.global.icodes.ExceptionHandler">head</a>
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../../../Boolean.scala.html#58721" title="=&gt; Boolean">!</a><a href="#789669" title="GenMSIL.this.global.icodes.ExceptionHandler">handler</a>.<a href="../icode/ExceptionHandlers.scala.html#734076" title="(b: GenMSIL.this.global.icodes.BasicBlock)Boolean">covers</a><span class="delimiter">(</span><a href="#789614" title="GenMSIL.this.global.icodes.BasicBlock">b</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
            // all of the covered blocks are visited, or not part of the linearization
            <a href="../../Global.scala.html#559533" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a><span class="delimiter">(</span><a href="#789669" title="GenMSIL.this.global.icodes.ExceptionHandler">handler</a>.<a href="../icode/ExceptionHandlers.scala.html#734072" title="=&gt; scala.collection.immutable.Set[GenMSIL.this.global.icodes.BasicBlock]">covered</a>.<a href="../../../../collection/IterableLike.scala.html#59461" title="(p: GenMSIL.this.global.icodes.BasicBlock =&gt; Boolean)Boolean">forall</a><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.BasicBlock" id="789685">b</a> =&gt; <a href="#789586" title="scala.collection.mutable.HashSet[GenMSIL.this.global.icodes.BasicBlock]">visitedBlocks</a>.<a href="../../../../collection/mutable/HashSet.scala.html#141569" title="(elem: GenMSIL.this.global.icodes.BasicBlock)Boolean">contains</a><span class="delimiter">(</span><a href="#789685" title="GenMSIL.this.global.icodes.BasicBlock">b</a><span class="delimiter">)</span> <a href="../../../../Boolean.scala.html#58724" title="(x: Boolean)Boolean">||</a> <a href="../../../../Boolean.scala.html#58721" title="=&gt; Boolean">!</a><a href="#789489" title="List[GenMSIL.this.global.icodes.BasicBlock]">blocks</a>.<a href="../../../../collection/SeqLike.scala.html#59768" title="(elem: Any)Boolean">contains</a><span class="delimiter">(</span><a href="#789685" title="GenMSIL.this.global.icodes.BasicBlock">b</a><span class="delimiter">)</span><span class="delimiter">)</span>,
                   <span title="String(&quot;Bad linearization of basic blocks inside try. Found non-covered block\n&quot;)" class="string">&quot;Bad linearization of basic blocks inside try. Found non-covered block\n&quot;</span><span title="(x$1: Any)String">+</span>
                   <a href="#789614" title="GenMSIL.this.global.icodes.BasicBlock">b</a>.<a href="../icode/BasicBlocks.scala.html#733819" title="=&gt; String">fullString</a> <span title="(x$1: Any)String">+</span><span title="String(&quot;\nwhile in try-part of\n&quot;)" class="string">&quot;\nwhile in try-part of\n&quot;</span><span title="(x$1: Any)String">+</span> <a href="#789669" title="GenMSIL.this.global.icodes.ExceptionHandler">handler</a><span class="delimiter">)</span>

            <a href="../../Global.scala.html#559533" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a><span class="delimiter">(</span><a href="#789669" title="GenMSIL.this.global.icodes.ExceptionHandler">handler</a>.<a href="../icode/ExceptionHandlers.scala.html#734071" title="=&gt; GenMSIL.this.global.icodes.BasicBlock">startBlock</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#789614" title="GenMSIL.this.global.icodes.BasicBlock">b</a>,
                   <span title="String(&quot;Bad linearization of basic blocks. The entry block of a catch does not directly follow the try\n&quot;)" class="string">&quot;Bad linearization of basic blocks. The entry block of a catch does not directly follow the try\n&quot;</span><span title="(x$1: Any)String">+</span>
                   <a href="#789614" title="GenMSIL.this.global.icodes.BasicBlock">b</a>.<a href="../icode/BasicBlocks.scala.html#733819" title="=&gt; String">fullString</a> <span title="(x$1: Any)String">+</span><span title="String(&quot;\n&quot;)" class="string">&quot;\n&quot;</span><span title="(x$1: Any)String">+</span> <a href="#789669" title="GenMSIL.this.global.icodes.ExceptionHandler">handler</a><span class="delimiter">)</span>

            <span class="keyword">val</span> <a title="List[GenMSIL.this.global.icodes.ExceptionHandler]" id="789672">handlers</a> = <a href="#789588" title="scala.collection.mutable.Stack[List[GenMSIL.this.global.icodes.ExceptionHandler]]">currentTryHandlers</a>.<a href="../../../../collection/mutable/Stack.scala.html#307336" title="()List[GenMSIL.this.global.icodes.ExceptionHandler]">pop</a>
            <a href="#789589" title="scala.collection.mutable.Stack[List[GenMSIL.this.global.icodes.ExceptionHandler]]">currentCatchHandlers</a>.<a href="../../../../collection/mutable/Stack.scala.html#307332" title="(elem: List[GenMSIL.this.global.icodes.ExceptionHandler])currentCatchHandlers.type">push</a><span class="delimiter">(</span><a href="#789672" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">handlers</a><span class="delimiter">)</span>
            <a href="../../../../collection/mutable/HashMap.scala.html#79209" title="(key: GenMSIL.this.global.icodes.BasicBlock, value: GenMSIL.this.global.icodes.ExceptionHandler)Unit">beginCatchBlock</a><span class="delimiter">(</span><a href="#789614" title="GenMSIL.this.global.icodes.BasicBlock">b</a><span class="delimiter">)</span> = <a href="#789669" title="GenMSIL.this.global.icodes.ExceptionHandler">handler</a>
          <span class="delimiter">}</span>
        <span class="delimiter">}</span>

        // are there try blocks starting at b?
        <span class="keyword">val</span> <a href="#789719" title="(x: (List[GenMSIL.this.global.icodes.ExceptionHandler], List[GenMSIL.this.global.icodes.ExceptionHandler]))(List[GenMSIL.this.global.icodes.ExceptionHandler], List[GenMSIL.this.global.icodes.ExceptionHandler])" class="delimiter">(</a><a href="../../../../Tuple2.scala.html#61506" title="List[GenMSIL.this.global.icodes.ExceptionHandler]" id="789618">newHandlers</a>, <a href="../../../../Tuple2.scala.html#61508" title="List[GenMSIL.this.global.icodes.ExceptionHandler]" id="789619">stillOpen</a><span class="delimiter">)</span> = <a href="#789587" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">openHandlers</a>.<a href="../../../../collection/TraversableLike.scala.html#58988" title="(p: GenMSIL.this.global.icodes.ExceptionHandler =&gt; Boolean)(List[GenMSIL.this.global.icodes.ExceptionHandler], List[GenMSIL.this.global.icodes.ExceptionHandler])">partition</a><a href="../../../../Tuple2.scala.html#1222" title="(List[GenMSIL.this.global.icodes.ExceptionHandler], List[GenMSIL.this.global.icodes.ExceptionHandler]) @unchecked" class="delimiter">(</a><a href="#789705" title="GenMSIL.this.global.icodes.ExceptionHandler">_</a>.<a href="../icode/ExceptionHandlers.scala.html#734076" title="(b: GenMSIL.this.global.icodes.BasicBlock)Boolean">covers</a><span class="delimiter">(</span><a href="#789614" title="GenMSIL.this.global.icodes.BasicBlock">b</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <a href="#789587" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">openHandlers</a> = <a href="#789619" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">stillOpen</a>

        <span class="keyword">val</span> <a title="scala.collection.immutable.Map[Int,List[GenMSIL.this.global.icodes.ExceptionHandler]]" id="789620">newHandlersBySize</a> = <a href="#789618" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">newHandlers</a>.<a href="../../../../collection/TraversableLike.scala.html#58989" title="(f: GenMSIL.this.global.icodes.ExceptionHandler =&gt; Int)scala.collection.immutable.Map[Int,List[GenMSIL.this.global.icodes.ExceptionHandler]]">groupBy</a><span class="delimiter">(</span><a href="#789729" title="GenMSIL.this.global.icodes.ExceptionHandler">_</a>.<a href="../icode/ExceptionHandlers.scala.html#734072" title="=&gt; scala.collection.immutable.Set[GenMSIL.this.global.icodes.BasicBlock]">covered</a>.<a href="../../../../collection/TraversableOnce.scala.html#59101" title="=&gt; Int">size</a><span class="delimiter">)</span>
        // big handlers first, smaller ones are nested inside the try of the big one
        // (checked by the assertions below)
        <span class="keyword">val</span> <a title="List[Int]" id="789621">sizes</a> = <a href="#789620" title="scala.collection.immutable.Map[Int,List[GenMSIL.this.global.icodes.ExceptionHandler]]">newHandlersBySize</a>.<a href="../../../../collection/MapLike.scala.html#78426" title="=&gt; Iterable[Int]">keys</a>.<a href="../../../../collection/TraversableOnce.scala.html#59174" title="=&gt; List[Int]">toList</a>.<a href="../../../../collection/SeqLike.scala.html#59826" title="(lt: (Int, Int) =&gt; Boolean)List[Int]">sortWith</a><span class="delimiter">(</span><a href="#789735" title="Int">_</a> <a href="../../../../Int.scala.html#57919" title="(x: Int)Boolean">&gt;</a> <a href="#789736" title="Int">_</a><span class="delimiter">)</span>

        <span class="keyword">val</span> <a title="scala.collection.mutable.ListBuffer[GenMSIL.this.global.icodes.ExceptionHandler]" id="789622">beginHandlers</a> = <span title="scala.collection.mutable.ListBuffer[GenMSIL.this.global.icodes.ExceptionHandler]" class="keyword">new</span> mutable.<a href="../../../../collection/mutable/ListBuffer.scala.html#13747" title="scala.collection.mutable.ListBuffer[GenMSIL.this.global.icodes.ExceptionHandler]">ListBuffer</a><span class="delimiter">[</span>ExceptionHandler<span class="delimiter">]</span>
        <span class="keyword">for</span> <span class="delimiter">(</span><a title="Int" id="789760">s</a> &lt;- <a href="../../../../collection/LinearSeqOptimized.scala.html#76166" title="(f: Int =&gt; scala.collection.mutable.Stack[List[GenMSIL.this.global.icodes.ExceptionHandler]])Unit">sizes</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <span class="keyword">val</span> <a title="List[GenMSIL.this.global.icodes.ExceptionHandler]" id="789761">sHandlers</a> = <a href="../../../../collection/MapLike.scala.html#78420" title="(key: Int)List[GenMSIL.this.global.icodes.ExceptionHandler]">newHandlersBySize</a><span class="delimiter">(</span><a href="#789760" title="Int">s</a><span class="delimiter">)</span>
          <span class="keyword">for</span> <span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.ExceptionHandler" id="789806">h</a> &lt;- <a href="../../../../collection/LinearSeqOptimized.scala.html#76166" title="(f: GenMSIL.this.global.icodes.ExceptionHandler =&gt; Unit)Unit">sHandlers</a><span class="delimiter">)</span> <span class="delimiter">{</span>
            <a href="../../Global.scala.html#559533" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a><span class="delimiter">(</span><a href="#789806" title="GenMSIL.this.global.icodes.ExceptionHandler">h</a>.<a href="../icode/ExceptionHandlers.scala.html#734072" title="=&gt; scala.collection.immutable.Set[GenMSIL.this.global.icodes.BasicBlock]">covered</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#789761" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">sHandlers</a>.<a href="../../../../collection/IterableLike.scala.html#59473" title="=&gt; GenMSIL.this.global.icodes.ExceptionHandler">head</a>.<a href="../icode/ExceptionHandlers.scala.html#734072" title="=&gt; scala.collection.immutable.Set[GenMSIL.this.global.icodes.BasicBlock]">covered</a>,
                   <span title="String(&quot;bad nesting of exception handlers. same size, but not covering same blocks\n&quot;)" class="string">&quot;bad nesting of exception handlers. same size, but not covering same blocks\n&quot;</span><span title="(x$1: Any)String">+</span>
                   <a href="#789806" title="GenMSIL.this.global.icodes.ExceptionHandler">h</a> <span title="(x$1: Any)String">+</span><span title="String(&quot;\n&quot;)" class="string">&quot;\n&quot;</span><span title="(x$1: Any)String">+</span> <a href="#789761" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">sHandlers</a>.<a href="../../../../collection/IterableLike.scala.html#59473" title="=&gt; GenMSIL.this.global.icodes.ExceptionHandler">head</a><span class="delimiter">)</span>
            <a href="../../Global.scala.html#559533" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a><span class="delimiter">(</span><a href="#789806" title="GenMSIL.this.global.icodes.ExceptionHandler">h</a>.<a href="../icode/ExceptionHandlers.scala.html#734067" title="=&gt; GenMSIL.this.global.icodes.TypeKind">resultKind</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#789761" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">sHandlers</a>.<a href="../../../../collection/IterableLike.scala.html#59473" title="=&gt; GenMSIL.this.global.icodes.ExceptionHandler">head</a>.<a href="../icode/ExceptionHandlers.scala.html#734067" title="=&gt; GenMSIL.this.global.icodes.TypeKind">resultKind</a>,
                   <span title="String(&quot;bad nesting of exception handlers. same size, but the same resultKind\n&quot;)" class="string">&quot;bad nesting of exception handlers. same size, but the same resultKind\n&quot;</span><span title="(x$1: Any)String">+</span>
                   <a href="#789806" title="GenMSIL.this.global.icodes.ExceptionHandler">h</a> <span title="(x$1: Any)String">+</span><span title="String(&quot;\n&quot;)" class="string">&quot;\n&quot;</span><span title="(x$1: Any)String">+</span> <a href="#789761" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">sHandlers</a>.<a href="../../../../collection/IterableLike.scala.html#59473" title="=&gt; GenMSIL.this.global.icodes.ExceptionHandler">head</a><span class="delimiter">)</span>
          <span class="delimiter">}</span>
          <span class="keyword">for</span> <span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.ExceptionHandler" id="789843">bigger</a> &lt;- <a href="../../../../collection/generic/TraversableForwarder.scala.html#68048" title="(f: GenMSIL.this.global.icodes.ExceptionHandler =&gt; Unit)Unit">beginHandlers</a>; <a title="GenMSIL.this.global.icodes.ExceptionHandler" id="789862">h</a> &lt;- <a href="../../../../collection/LinearSeqOptimized.scala.html#76166" title="(f: GenMSIL.this.global.icodes.ExceptionHandler =&gt; Unit)Unit">sHandlers</a><span class="delimiter">)</span> <span class="delimiter">{</span>
            <a href="../../Global.scala.html#559533" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a><span class="delimiter">(</span><a href="#789862" title="GenMSIL.this.global.icodes.ExceptionHandler">h</a>.<a href="../icode/ExceptionHandlers.scala.html#734072" title="=&gt; scala.collection.immutable.Set[GenMSIL.this.global.icodes.BasicBlock]">covered</a>.<a href="../../../../collection/GenSetLike.scala.html#65167" title="(that: scala.collection.GenSet[GenMSIL.this.global.icodes.BasicBlock])Boolean">subsetOf</a><span class="delimiter">(</span><a href="#789843" title="GenMSIL.this.global.icodes.ExceptionHandler">bigger</a>.<a href="../icode/ExceptionHandlers.scala.html#734072" title="=&gt; scala.collection.immutable.Set[GenMSIL.this.global.icodes.BasicBlock]">covered</a><span class="delimiter">)</span>,
                   <span title="String(&quot;bad nesting of exception handlers. try blocks of smaller handler are not nested in bigger one.\n&quot;)" class="string">&quot;bad nesting of exception handlers. try blocks of smaller handler are not nested in bigger one.\n&quot;</span><span title="(x$1: Any)String">+</span>
                   <a href="#789862" title="GenMSIL.this.global.icodes.ExceptionHandler">h</a> <span title="(x$1: Any)String">+</span><span title="String(&quot;\n&quot;)" class="string">&quot;\n&quot;</span><span title="(x$1: Any)String">+</span> <a href="#789843" title="GenMSIL.this.global.icodes.ExceptionHandler">bigger</a><span class="delimiter">)</span>
            <a href="../../Global.scala.html#559533" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a><span class="delimiter">(</span><a href="#789862" title="GenMSIL.this.global.icodes.ExceptionHandler">h</a>.<a href="../icode/ExceptionHandlers.scala.html#734077" title="=&gt; List[GenMSIL.this.global.icodes.BasicBlock]">blocks</a>.<a href="../../../../collection/TraversableOnce.scala.html#59181" title="scala.collection.immutable.Set[GenMSIL.this.global.icodes.BasicBlock]">toSet</a>.<a href="../../../../collection/GenSetLike.scala.html#65167" title="(that: scala.collection.GenSet[GenMSIL.this.global.icodes.BasicBlock])Boolean">subsetOf</a><span class="delimiter">(</span><a href="#789843" title="GenMSIL.this.global.icodes.ExceptionHandler">bigger</a>.<a href="../icode/ExceptionHandlers.scala.html#734072" title="=&gt; scala.collection.immutable.Set[GenMSIL.this.global.icodes.BasicBlock]">covered</a><span class="delimiter">)</span>,
                   <span title="String(&quot;bad nesting of exception handlers. catch blocks of smaller handler are not nested in bigger one.\n&quot;)" class="string">&quot;bad nesting of exception handlers. catch blocks of smaller handler are not nested in bigger one.\n&quot;</span><span title="(x$1: Any)String">+</span>
                   <a href="#789862" title="GenMSIL.this.global.icodes.ExceptionHandler">h</a> <span title="(x$1: Any)String">+</span><span title="String(&quot;\n&quot;)" class="string">&quot;\n&quot;</span><span title="(x$1: Any)String">+</span> <a href="#789843" title="GenMSIL.this.global.icodes.ExceptionHandler">bigger</a><span class="delimiter">)</span>
          <span class="delimiter">}</span>
          <a href="#789622" title="scala.collection.mutable.ListBuffer[GenMSIL.this.global.icodes.ExceptionHandler]">beginHandlers</a> <a href="../../../../collection/mutable/ListBuffer.scala.html#67856" title="(x: GenMSIL.this.global.icodes.ExceptionHandler)beginHandlers.type">+=</a> <a href="#789761" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">sHandlers</a>.<a href="../../../../collection/IterableLike.scala.html#59473" title="=&gt; GenMSIL.this.global.icodes.ExceptionHandler">head</a>
          <a href="#789588" title="scala.collection.mutable.Stack[List[GenMSIL.this.global.icodes.ExceptionHandler]]">currentTryHandlers</a>.<a href="../../../../collection/mutable/Stack.scala.html#307332" title="(elem: List[GenMSIL.this.global.icodes.ExceptionHandler])currentTryHandlers.type">push</a><span class="delimiter">(</span><a href="#789761" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">sHandlers</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
        <a href="../../../../collection/mutable/HashMap.scala.html#79209" title="(key: GenMSIL.this.global.icodes.BasicBlock, value: List[GenMSIL.this.global.icodes.ExceptionHandler])Unit">beginExBlock</a><span class="delimiter">(</span><a href="#789614" title="GenMSIL.this.global.icodes.BasicBlock">b</a><span class="delimiter">)</span> = <a href="#789622" title="scala.collection.mutable.ListBuffer[GenMSIL.this.global.icodes.ExceptionHandler]">beginHandlers</a>.<a href="../../../../collection/mutable/ListBuffer.scala.html#67864" title="=&gt; List[GenMSIL.this.global.icodes.ExceptionHandler]">toList</a>
        <a href="#789586" title="scala.collection.mutable.HashSet[GenMSIL.this.global.icodes.BasicBlock]">visitedBlocks</a> <a href="../../../../collection/mutable/HashSet.scala.html#141570" title="(elem: GenMSIL.this.global.icodes.BasicBlock)visitedBlocks.type">+=</a> <a href="#789614" title="GenMSIL.this.global.icodes.BasicBlock">b</a>
      <span class="delimiter">}</span>

      // if there handlers left (i.e. handlers covering nothing, or a
      // non-existent (dead) block), remove their catch-blocks.
      <span class="keyword">val</span> <a title="List[GenMSIL.this.global.icodes.BasicBlock]" id="789590">liveBlocks</a> = <span title="List[GenMSIL.this.global.icodes.BasicBlock]" class="keyword">if</span> <span class="delimiter">(</span><a href="#789587" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">openHandlers</a>.<a href="../../../../collection/IterableLike.scala.html#59464" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <a href="#789489" title="List[GenMSIL.this.global.icodes.BasicBlock]">blocks</a> <span class="keyword">else</span> <span class="delimiter">{</span>
        <a href="#789489" title="List[GenMSIL.this.global.icodes.BasicBlock]">blocks</a>.<a href="../../../../collection/TraversableLike.scala.html#58981" title="(p: GenMSIL.this.global.icodes.BasicBlock =&gt; Boolean)List[GenMSIL.this.global.icodes.BasicBlock]">filter</a><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.BasicBlock" id="789918">b</a> =&gt; <a href="#789587" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">openHandlers</a>.<a href="../../../../collection/LinearSeqOptimized.scala.html#76169" title="(p: GenMSIL.this.global.icodes.ExceptionHandler =&gt; Boolean)Boolean">forall</a><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.ExceptionHandler" id="789927">h</a> =&gt; <a href="../../../../Boolean.scala.html#58721" title="=&gt; Boolean">!</a><a href="#789927" title="GenMSIL.this.global.icodes.ExceptionHandler">h</a>.<a href="../icode/ExceptionHandlers.scala.html#734077" title="=&gt; List[GenMSIL.this.global.icodes.BasicBlock]">blocks</a>.<a href="../../../../collection/SeqLike.scala.html#59768" title="(elem: Any)Boolean">contains</a><span class="delimiter">(</span><a href="#789918" title="GenMSIL.this.global.icodes.BasicBlock">b</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>

      /** There might be open handlers, but no more blocks. happens when try/catch end
       *  with `throw` or `return`
       *     def foo() { try { .. throw } catch { _ =&gt; .. throw } }
       *
       *  In this case we need some code after the catch block for the auto-generated
       *  `leave` instruction. So we're adding a (dead) `throw new Exception`.
       */
      <span class="keyword">val</span> <a title="List[GenMSIL.this.global.icodes.ExceptionHandler]" id="789591">rest</a> = <a href="#789589" title="scala.collection.mutable.Stack[List[GenMSIL.this.global.icodes.ExceptionHandler]]">currentCatchHandlers</a>.<a href="../../../../collection/TraversableLike.scala.html#58971" title="(f: List[GenMSIL.this.global.icodes.ExceptionHandler] =&gt; GenMSIL.this.global.icodes.ExceptionHandler)(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.mutable.Stack[List[GenMSIL.this.global.icodes.ExceptionHandler]],GenMSIL.this.global.icodes.ExceptionHandler,scala.collection.mutable.Stack[GenMSIL.this.global.icodes.ExceptionHandler]])scala.collection.mutable.Stack[GenMSIL.this.global.icodes.ExceptionHandler]">map</a><a href="../../../../collection/mutable/Stack.scala.html#307313" title="scala.collection.generic.CanBuildFrom[scala.collection.mutable.Stack.Coll,GenMSIL.this.global.icodes.ExceptionHandler,scala.collection.mutable.Stack[GenMSIL.this.global.icodes.ExceptionHandler]]" class="delimiter">(</a><a title="List[GenMSIL.this.global.icodes.ExceptionHandler]" id="789944">handlers</a> =&gt; <span class="delimiter">{</span>
        <a href="../../Global.scala.html#559533" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a><span class="delimiter">(</span><a href="#789944" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">handlers</a>.<a href="../../../../collection/LinearSeqOptimized.scala.html#76164" title="=&gt; Int">length</a> <a href="../../../../Int.scala.html#57891" title="(x: Int)Boolean">==</a> <span title="Int(1)" class="int">1</span>, <a href="#789944" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">handlers</a><span class="delimiter">)</span>
        <a href="#789944" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">handlers</a>.<a href="../../../../collection/IterableLike.scala.html#59473" title="=&gt; GenMSIL.this.global.icodes.ExceptionHandler">head</a>
      <span class="delimiter">}</span><span class="delimiter">)</span>.<a href="../../../../collection/mutable/Stack.scala.html#307339" title="=&gt; List[GenMSIL.this.global.icodes.ExceptionHandler]">toList</a>

      <span title="List[GenMSIL.this.global.icodes.BasicBlock]" class="keyword">if</span> <span class="delimiter">(</span><a href="#789591" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">rest</a>.<a href="../../../../collection/IterableLike.scala.html#59464" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#789590" title="List[GenMSIL.this.global.icodes.BasicBlock]">liveBlocks</a>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="GenMSIL.this.global.icodes.BasicBlock" id="790051">b</a> = <a href="#789490" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#733829" title="=&gt; GenMSIL.this.global.icodes.Code">code</a>.<a href="../icode/Members.scala.html#733940" title="()GenMSIL.this.global.icodes.BasicBlock">newBlock</a>
        <a href="#790051" title="GenMSIL.this.global.icodes.BasicBlock">b</a>.<a href="../icode/BasicBlocks.scala.html#733789" title="(is: Seq[GenMSIL.this.global.icodes.Instruction])Unit">emit</a><span class="delimiter">(</span><a href="../../../../collection/generic/GenericCompanion.scala.html#60782" title="(elems: GenMSIL.this.global.icodes.Instruction with Product with Serializable*)Seq[GenMSIL.this.global.icodes.Instruction with Product with Serializable]">Seq</a><span class="delimiter">(</span>
          <a href="../icode/Opcodes.scala.html#744422" title="(kind: GenMSIL.this.global.icodes.REFERENCE)GenMSIL.this.global.icodes.opcodes.NEW">NEW</a><span class="delimiter">(</span><a href="../icode/TypeKinds.scala.html#731504" title="(cls: GenMSIL.this.global.icodes.global.Symbol)GenMSIL.this.global.icodes.REFERENCE">REFERENCE</a><span class="delimiter">(</span><a href="../../../../reflect/internal/Definitions.scala.html#441641" title="GenMSIL.this.global.definitions.type">definitions</a>.<a href="../../../../reflect/internal/Definitions.scala.html#442209" title="=&gt; GenMSIL.this.global.Symbol">ThrowableClass</a><span class="delimiter">)</span><span class="delimiter">)</span>,
          <a href="../icode/Opcodes.scala.html#742153" title="(typ: GenMSIL.this.global.icodes.TypeKind)GenMSIL.this.global.icodes.opcodes.DUP">DUP</a><span class="delimiter">(</span><a href="../icode/TypeKinds.scala.html#731504" title="(cls: GenMSIL.this.global.icodes.global.Symbol)GenMSIL.this.global.icodes.REFERENCE">REFERENCE</a><span class="delimiter">(</span><a href="../../../../reflect/internal/Definitions.scala.html#441641" title="GenMSIL.this.global.definitions.type">definitions</a>.<a href="../../../../reflect/internal/Definitions.scala.html#442179" title="=&gt; GenMSIL.this.global.ClassSymbol">ObjectClass</a><span class="delimiter">)</span><span class="delimiter">)</span>,
          <a href="../icode/Opcodes.scala.html#744645" title="(method: GenMSIL.this.global.icodes.global.Symbol, style: GenMSIL.this.global.icodes.opcodes.InvokeStyle)GenMSIL.this.global.icodes.opcodes.CALL_METHOD">CALL_METHOD</a><span class="delimiter">(</span><a href="../../../../reflect/internal/Definitions.scala.html#441641" title="GenMSIL.this.global.definitions.type">definitions</a>.<a href="../../../../reflect/internal/Definitions.scala.html#442209" title="=&gt; GenMSIL.this.global.Symbol">ThrowableClass</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443482" title="=&gt; GenMSIL.this.global.Symbol">primaryConstructor</a>, <a href="../icode/Opcodes.scala.html#744942" title="(onInstance: Boolean)GenMSIL.this.global.icodes.opcodes.Static">Static</a><span class="delimiter">(</span><span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span><span class="delimiter">)</span>,
          <a href="../icode/Opcodes.scala.html#739202" title="(clasz: GenMSIL.this.global.icodes.global.Symbol)GenMSIL.this.global.icodes.opcodes.THROW">THROW</a><span class="delimiter">(</span><a href="../../../../reflect/internal/Definitions.scala.html#441641" title="GenMSIL.this.global.definitions.type">definitions</a>.<a href="../../../../reflect/internal/Definitions.scala.html#442209" title="=&gt; GenMSIL.this.global.Symbol">ThrowableClass</a><span class="delimiter">)</span>
        <span class="delimiter">)</span><span class="delimiter">)</span>
        <a href="#790051" title="GenMSIL.this.global.icodes.BasicBlock">b</a>.<a href="../icode/BasicBlocks.scala.html#733793" title="()Unit">close</a>
        <a href="../../../../collection/mutable/HashMap.scala.html#79209" title="(key: GenMSIL.this.global.icodes.BasicBlock, value: List[GenMSIL.this.global.icodes.ExceptionHandler])Unit">endExBlock</a><span class="delimiter">(</span><a href="#790051" title="GenMSIL.this.global.icodes.BasicBlock">b</a><span class="delimiter">)</span> = <a href="#789591" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">rest</a>
        <a href="#789590" title="List[GenMSIL.this.global.icodes.BasicBlock]">liveBlocks</a> <a href="../../../../collection/immutable/List.scala.html#63646" title="(prefix: List[GenMSIL.this.global.icodes.BasicBlock])List[GenMSIL.this.global.icodes.BasicBlock]">:::</a> <a href="../../../../collection/immutable/List.scala.html#63291" title="(xs: GenMSIL.this.global.icodes.BasicBlock*)List[GenMSIL.this.global.icodes.BasicBlock]">List</a><span class="delimiter">(</span><a href="#790051" title="GenMSIL.this.global.icodes.BasicBlock">b</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    /**
     *  @param block the BasicBlock to emit code for
     *  @param next  the following BasicBlock, `null` if `block` is the last one
     */
    <span class="keyword">def</span> <a title="(block: GenMSIL.this.global.icodes.BasicBlock, prev: GenMSIL.this.global.icodes.BasicBlock, next: GenMSIL.this.global.icodes.BasicBlock)Unit" id="785623">genBlock</a><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.BasicBlock" id="789517">block</a>: <a href="../icode/BasicBlocks.scala.html#642689" title="GenMSIL.this.global.icodes.BasicBlock">BasicBlock</a>, <a title="GenMSIL.this.global.icodes.BasicBlock" id="789518">prev</a>: <a href="../icode/BasicBlocks.scala.html#642689" title="GenMSIL.this.global.icodes.BasicBlock">BasicBlock</a>, <a title="GenMSIL.this.global.icodes.BasicBlock" id="789519">next</a>: <a href="../icode/BasicBlocks.scala.html#642689" title="GenMSIL.this.global.icodes.BasicBlock">BasicBlock</a><span class="delimiter">)</span> <span class="delimiter">{</span>

      <span class="keyword">def</span> <a title="(local: GenMSIL.this.global.icodes.Local, msg: String, loadAddr: Boolean)Unit" id="790115">loadLocalOrAddress</a><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.Local" id="790120">local</a>: <a href="../icode/Members.scala.html#642681" title="GenMSIL.this.global.icodes.Local">Local</a>, <a title="String" id="790121">msg</a> : <span title="String">String</span> , <a title="Boolean" id="790122">loadAddr</a> : <a href="../../../../Boolean.scala.html#2218" title="Boolean">Boolean</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="../../Global.scala.html#559553" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><a href="#790121" title="String">msg</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; for &quot;)" class="string">&quot; for &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#790120" title="GenMSIL.this.global.icodes.Local">local</a><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="Boolean" id="790123">isArg</a> = <a href="#790120" title="GenMSIL.this.global.icodes.Local">local</a>.<a href="../icode/Members.scala.html#734267" title="=&gt; Boolean">arg</a>
        <span class="keyword">val</span> <a title="Int" id="790124">i</a> = <a href="#790120" title="GenMSIL.this.global.icodes.Local">local</a>.<a href="../icode/Members.scala.html#734270" title="=&gt; Int">index</a>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#790123" title="Boolean">isArg</a><span class="delimiter">)</span>
          <a href="#785626" title="(code: ch.epfl.lamp.compiler.msil.emit.ILGenerator, loadAddr: Boolean)(i: Int)Unit">loadArg</a><span class="delimiter">(</span><a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>, <a href="#790122" title="Boolean">loadAddr</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#790124" title="Int">i</a><span class="delimiter">)</span>
        <span class="keyword">else</span>
          <a href="#785627" title="(i: Int, local: GenMSIL.this.global.icodes.Local, code: ch.epfl.lamp.compiler.msil.emit.ILGenerator, loadAddr: Boolean)Unit">loadLocal</a><span class="delimiter">(</span><a href="#790124" title="Int">i</a>, <a href="#790120" title="GenMSIL.this.global.icodes.Local">local</a>, <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>, <a href="#790122" title="Boolean">loadAddr</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>

      <span class="keyword">def</span> <a title="(field: GenMSIL.this.global.Symbol, isStatic: Boolean, msg: String, loadAddr: Boolean)Unit" id="790116">loadFieldOrAddress</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="790326">field</a>: <a href="../../../../reflect/internal/Symbols.scala.html#441132" title="GenMSIL.this.global.Symbol">Symbol</a>, <a title="Boolean" id="790327">isStatic</a>: <a href="../../../../Boolean.scala.html#2218" title="Boolean">Boolean</a>, <a title="String" id="790328">msg</a>: <span title="String">String</span>, <a title="Boolean" id="790329">loadAddr</a> : <a href="../../../../Boolean.scala.html#2218" title="Boolean">Boolean</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="../../Global.scala.html#559553" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><a href="#790328" title="String">msg</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; with owner: &quot;)" class="string">&quot; with owner: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#790326" title="GenMSIL.this.global.Symbol">field</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443379" title="=&gt; GenMSIL.this.global.Symbol">owner</a> <span title="(x$1: Any)String">+</span>
              <span title="String(&quot; flags: &quot;)" class="string">&quot; flags: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="../../symtab/package.scala.html#57302" title="=&gt; reflect.internal.Flags.type">Flags</a>.<a href="../../../../reflect/internal/Flags.scala.html#441022" title="(flags: Long)String">flagsToString</a><span class="delimiter">(</span><a href="#790326" title="GenMSIL.this.global.Symbol">field</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443379" title="=&gt; GenMSIL.this.global.Symbol">owner</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443310" title="=&gt; Long">flags</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="keyword">var</span> <a title="ch.epfl.lamp.compiler.msil.FieldInfo" id="790330">fieldInfo</a> = <a href="../../symtab/clr/CLRTypes.scala.html#730899" title="=&gt; scala.collection.mutable.Map[GenMSIL.this.global.loaders.clrTypes.global.Symbol,ch.epfl.lamp.compiler.msil.FieldInfo]">fields</a>.<a href="../../../../collection/MapLike.scala.html#78410" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol)Option[ch.epfl.lamp.compiler.msil.FieldInfo]">get</a><a href="#790348" title="(x: ch.epfl.lamp.compiler.msil.FieldInfo)ch.epfl.lamp.compiler.msil.FieldInfo" class="delimiter">(</a><a href="#790326" title="GenMSIL.this.global.Symbol">field</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> Some<a href="#790344" title="ch.epfl.lamp.compiler.msil.FieldInfo" id="790345" class="delimiter">(</a>fInfo<span class="delimiter">)</span> =&gt; <a href="#790348" title="(x: ch.epfl.lamp.compiler.msil.FieldInfo)ch.epfl.lamp.compiler.msil.FieldInfo">fInfo</a>
          <span class="keyword">case</span> <a href="../../../../Option.scala.html#2498" title="ch.epfl.lamp.compiler.msil.FieldInfo" id="790347">None</a> =&gt;
            <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.FieldInfo" id="790338">fInfo</a> = <a href="#785648" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.Type">getType</a><span class="delimiter">(</span><a href="#790326" title="GenMSIL.this.global.Symbol">field</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443379" title="=&gt; GenMSIL.this.global.Symbol">owner</a><span class="delimiter">)</span>.<span title="(x$1: String)ch.epfl.lamp.compiler.msil.FieldInfo">GetField</span><span class="delimiter">(</span><a href="#785633" title="(sym: GenMSIL.this.global.Symbol)String">msilName</a><span class="delimiter">(</span><a href="#790326" title="GenMSIL.this.global.Symbol">field</a><span class="delimiter">)</span><span class="delimiter">)</span>
            <a href="../../../../collection/mutable/MapLike.scala.html#78496" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol, value: ch.epfl.lamp.compiler.msil.FieldInfo)Unit">fields</a><span class="delimiter">(</span><a href="#790326" title="GenMSIL.this.global.Symbol">field</a><span class="delimiter">)</span> = <a href="#790338" title="ch.epfl.lamp.compiler.msil.FieldInfo">fInfo</a>
            <a href="#790338" title="ch.epfl.lamp.compiler.msil.FieldInfo">fInfo</a>
        <span class="delimiter">}</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#790330" title="ch.epfl.lamp.compiler.msil.FieldInfo">fieldInfo</a>.<span title="()Boolean">IsVolatile</span><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Volatile</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../../../Boolean.scala.html#58721" title="=&gt; Boolean">!</a><a href="#790330" title="ch.epfl.lamp.compiler.msil.FieldInfo">fieldInfo</a>.<span title="()Boolean">IsLiteral</span><span class="delimiter">)</span> <span class="delimiter">{</span>
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#790329" title="Boolean">loadAddr</a><span class="delimiter">)</span> <span class="delimiter">{</span>
            <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.FieldInfo)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCode" class="keyword">if</span> <span class="delimiter">(</span><a href="#790327" title="Boolean">isStatic</a><span class="delimiter">)</span> <span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldsflda</span> <span class="keyword">else</span> <span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldflda</span>, <a href="#790330" title="ch.epfl.lamp.compiler.msil.FieldInfo">fieldInfo</a><span class="delimiter">)</span>
          <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
            <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.FieldInfo)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCode" class="keyword">if</span> <span class="delimiter">(</span><a href="#790327" title="Boolean">isStatic</a><span class="delimiter">)</span> <span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldsfld</span> <span class="keyword">else</span> <span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldfld</span>, <a href="#790330" title="ch.epfl.lamp.compiler.msil.FieldInfo">fieldInfo</a><span class="delimiter">)</span>
          <span class="delimiter">}</span>
        <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
          <a href="../../Global.scala.html#559533" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a><span class="delimiter">(</span><a href="../../../../Boolean.scala.html#58721" title="=&gt; Boolean">!</a><a href="#790329" title="Boolean">loadAddr</a>, <span title="String(&quot;can\'t take AddressOf a literal field (not even with readonly. prefix) because no memory was allocated to such field ...&quot;)" class="string">&quot;can't take AddressOf a literal field (not even with readonly. prefix) because no memory was allocated to such field ...&quot;</span><span class="delimiter">)</span>
          // TODO the above can be overcome by loading the value, boxing, and finally unboxing. An address to a copy of the raw value will be on the stack.
         /*  We perform `field inlining' as required by CLR.
          *  Emit as for a CONSTANT ICode stmt, with the twist that the constant value is available
          *  as a java.lang.Object and its .NET type allows constant initialization in CLR, i.e. that type
          *  is one of I1, I2, I4, I8, R4, R8, CHAR, BOOLEAN, STRING, or CLASS (in this last case,
          *  only accepting nullref as value). See Table 9-1 in Lidin's book on ILAsm. */
          <span class="keyword">val</span> <a title="Object" id="790366">value</a> = <a href="#790330" title="ch.epfl.lamp.compiler.msil.FieldInfo">fieldInfo</a>.<span title="()Object">getValue</span><span class="delimiter">(</span><span class="delimiter">)</span>
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#790366" title="Object">value</a> <span title="(x$1: AnyRef)Boolean">==</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <span class="delimiter">{</span>
            <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldnull</span><span class="delimiter">)</span>
          <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
            <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.Type" id="790376">typ</a> = <span title="ch.epfl.lamp.compiler.msil.Type" class="keyword">if</span> <span class="delimiter">(</span><a href="#790330" title="ch.epfl.lamp.compiler.msil.FieldInfo">fieldInfo</a>.<span title="ch.epfl.lamp.compiler.msil.Type">FieldType</span>.<span title="()Boolean">IsEnum</span><span class="delimiter">)</span> <a href="#790330" title="ch.epfl.lamp.compiler.msil.FieldInfo">fieldInfo</a>.<span title="ch.epfl.lamp.compiler.msil.Type">FieldType</span>.<span title="()ch.epfl.lamp.compiler.msil.Type">getUnderlyingType</span>
                      <span class="keyword">else</span> <a href="#790330" title="ch.epfl.lamp.compiler.msil.FieldInfo">fieldInfo</a>.<span title="ch.epfl.lamp.compiler.msil.Type">FieldType</span>
            <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#790376" title="ch.epfl.lamp.compiler.msil.Type">typ</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../symtab/SymbolLoaders.scala.html#650372" title="GenMSIL.this.global.loaders.clrTypes.type">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#730869" title="=&gt; ch.epfl.lamp.compiler.msil.Type">STRING</a><span class="delimiter">)</span> <span class="delimiter">{</span>
              <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: String)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldstr</span>, <a href="#790366" title="Object">value</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="String" class="delimiter">[</span><span title="String">String</span><span class="delimiter">]</span><span class="delimiter">)</span>
            <span class="delimiter">}</span> <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#790376" title="ch.epfl.lamp.compiler.msil.Type">typ</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../symtab/SymbolLoaders.scala.html#650372" title="GenMSIL.this.global.loaders.clrTypes.type">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#730854" title="=&gt; ch.epfl.lamp.compiler.msil.Type">BOOLEAN</a><span class="delimiter">)</span> <span class="delimiter">{</span>
                <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCode" class="keyword">if</span> <span class="delimiter">(</span><a href="#790366" title="Object">value</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="Boolean" class="delimiter">[</span><a href="../../../../Boolean.scala.html#2218" title="Boolean">Boolean</a><span class="delimiter">]</span><span class="delimiter">)</span> <span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldc_I4_1</span>
                           <span class="keyword">else</span> <span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldc_I4_0</span><span class="delimiter">)</span>
            <span class="delimiter">}</span> <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#790376" title="ch.epfl.lamp.compiler.msil.Type">typ</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../symtab/SymbolLoaders.scala.html#650372" title="GenMSIL.this.global.loaders.clrTypes.type">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#730821" title="=&gt; ch.epfl.lamp.compiler.msil.Type">BYTE</a> <a href="../../../../Boolean.scala.html#58724" title="(x: Boolean)Boolean">||</a> <a href="#790376" title="ch.epfl.lamp.compiler.msil.Type">typ</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../symtab/SymbolLoaders.scala.html#650372" title="GenMSIL.this.global.loaders.clrTypes.type">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#730824" title="=&gt; ch.epfl.lamp.compiler.msil.Type">UBYTE</a><span class="delimiter">)</span> <span class="delimiter">{</span>
              <a href="#785625" title="(value: Int, code: ch.epfl.lamp.compiler.msil.emit.ILGenerator)Unit">loadI4</a><span class="delimiter">(</span><a href="#790366" title="Object">value</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><a href="../../../../Byte.scala.html#57570" title="=&gt; Int" class="delimiter">[</a><a href="../../../../Byte.scala.html#2119" title="Byte">Byte</a><span class="delimiter">]</span>, <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a><span class="delimiter">)</span>
            <span class="delimiter">}</span> <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#790376" title="ch.epfl.lamp.compiler.msil.Type">typ</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../symtab/SymbolLoaders.scala.html#650372" title="GenMSIL.this.global.loaders.clrTypes.type">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#730827" title="=&gt; ch.epfl.lamp.compiler.msil.Type">SHORT</a> <a href="../../../../Boolean.scala.html#58724" title="(x: Boolean)Boolean">||</a> <a href="#790376" title="ch.epfl.lamp.compiler.msil.Type">typ</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../symtab/SymbolLoaders.scala.html#650372" title="GenMSIL.this.global.loaders.clrTypes.type">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#730830" title="=&gt; ch.epfl.lamp.compiler.msil.Type">USHORT</a><span class="delimiter">)</span> <span class="delimiter">{</span>
              <a href="#785625" title="(value: Int, code: ch.epfl.lamp.compiler.msil.emit.ILGenerator)Unit">loadI4</a><span class="delimiter">(</span><a href="#790366" title="Object">value</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="Int" class="delimiter">[</span><a href="../../../../Int.scala.html#508" title="Int">Int</a><span class="delimiter">]</span>, <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a><span class="delimiter">)</span>
            <span class="delimiter">}</span> <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#790376" title="ch.epfl.lamp.compiler.msil.Type">typ</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../symtab/SymbolLoaders.scala.html#650372" title="GenMSIL.this.global.loaders.clrTypes.type">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#730833" title="=&gt; ch.epfl.lamp.compiler.msil.Type">CHAR</a><span class="delimiter">)</span> <span class="delimiter">{</span>
              <a href="#785625" title="(value: Int, code: ch.epfl.lamp.compiler.msil.emit.ILGenerator)Unit">loadI4</a><span class="delimiter">(</span><a href="#790366" title="Object">value</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><a href="../../../../Char.scala.html#58025" title="=&gt; Int" class="delimiter">[</a><a href="../../../../Char.scala.html#1273" title="Char">Char</a><span class="delimiter">]</span>, <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a><span class="delimiter">)</span>
            <span class="delimiter">}</span> <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#790376" title="ch.epfl.lamp.compiler.msil.Type">typ</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../symtab/SymbolLoaders.scala.html#650372" title="GenMSIL.this.global.loaders.clrTypes.type">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#730836" title="=&gt; ch.epfl.lamp.compiler.msil.Type">INT</a> <a href="../../../../Boolean.scala.html#58724" title="(x: Boolean)Boolean">||</a> <a href="#790376" title="ch.epfl.lamp.compiler.msil.Type">typ</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../symtab/SymbolLoaders.scala.html#650372" title="GenMSIL.this.global.loaders.clrTypes.type">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#730839" title="=&gt; ch.epfl.lamp.compiler.msil.Type">UINT</a><span class="delimiter">)</span> <span class="delimiter">{</span>
              <a href="#785625" title="(value: Int, code: ch.epfl.lamp.compiler.msil.emit.ILGenerator)Unit">loadI4</a><span class="delimiter">(</span><a href="#790366" title="Object">value</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="Int" class="delimiter">[</span><a href="../../../../Int.scala.html#508" title="Int">Int</a><span class="delimiter">]</span>, <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a><span class="delimiter">)</span>
            <span class="delimiter">}</span> <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#790376" title="ch.epfl.lamp.compiler.msil.Type">typ</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../symtab/SymbolLoaders.scala.html#650372" title="GenMSIL.this.global.loaders.clrTypes.type">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#730842" title="=&gt; ch.epfl.lamp.compiler.msil.Type">LONG</a> <a href="../../../../Boolean.scala.html#58724" title="(x: Boolean)Boolean">||</a> <a href="#790376" title="ch.epfl.lamp.compiler.msil.Type">typ</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../symtab/SymbolLoaders.scala.html#650372" title="GenMSIL.this.global.loaders.clrTypes.type">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#730845" title="=&gt; ch.epfl.lamp.compiler.msil.Type">ULONG</a><span class="delimiter">)</span> <span class="delimiter">{</span>
              <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: Long)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldc_I8</span>, <a href="#790366" title="Object">value</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="Long" class="delimiter">[</span><a href="../../../../Long.scala.html#1993" title="Long">Long</a><span class="delimiter">]</span><span class="delimiter">)</span>
            <span class="delimiter">}</span> <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#790376" title="ch.epfl.lamp.compiler.msil.Type">typ</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../symtab/SymbolLoaders.scala.html#650372" title="GenMSIL.this.global.loaders.clrTypes.type">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#730848" title="=&gt; ch.epfl.lamp.compiler.msil.Type">FLOAT</a><span class="delimiter">)</span> <span class="delimiter">{</span>
              <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: Float)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldc_R4</span>, <a href="#790366" title="Object">value</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="Float" class="delimiter">[</span><a href="../../../../Float.scala.html#1720" title="Float">Float</a><span class="delimiter">]</span><span class="delimiter">)</span>
            <span class="delimiter">}</span> <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#790376" title="ch.epfl.lamp.compiler.msil.Type">typ</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../symtab/SymbolLoaders.scala.html#650372" title="GenMSIL.this.global.loaders.clrTypes.type">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#730851" title="=&gt; ch.epfl.lamp.compiler.msil.Type">DOUBLE</a><span class="delimiter">)</span> <span class="delimiter">{</span>
              <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: Double)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldc_R8</span>, <a href="#790366" title="Object">value</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="Double" class="delimiter">[</span><a href="../../../../Double.scala.html#1120" title="Double">Double</a><span class="delimiter">]</span><span class="delimiter">)</span>
            <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
              /* TODO one more case is described in Partition II, 16.2: bytearray(...) */
              <a href="../../Global.scala.html#559537" title="(msg: String)Nothing">abort</a><span class="delimiter">(</span><span title="String(&quot;Unknown type for static literal field: &quot;)" class="string">&quot;Unknown type for static literal field: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#790330" title="ch.epfl.lamp.compiler.msil.FieldInfo">fieldInfo</a><span class="delimiter">)</span>
            <span class="delimiter">}</span>
          <span class="delimiter">}</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>

      /** Creating objects works differently on .NET. On the JVM
       *  - NEW(type) =&gt; reference on Stack
       *  - DUP, load arguments, CALL_METHOD(constructor)
       *
       * On .NET, the NEW and DUP are ignored, but we emit a special method call
       *  - load arguments
       *  - NewObj(constructor) =&gt; reference on stack
       *
       * This variable tells whether the previous instruction was a NEW,
       * we expect a DUP which is not emitted. */
      <span class="keyword">var</span> <a title="Boolean" id="790117">previousWasNEW</a> = <span title="Boolean(false)" class="keyword">false</span>

      <span class="keyword">var</span> <a title="Int" id="790118">lastLineNr</a>: <a href="../../../../Int.scala.html#508" title="Int">Int</a> = <span title="Int(0)" class="int">0</span>
      <span class="keyword">var</span> <a title="GenMSIL.this.global.Position" id="790119">lastPos</a>: <a href="../../util/Position.scala.html#52230" title="GenMSIL.this.global.Position">Position</a> = <a href="../../../../reflect/internal/Positions.scala.html#441880" title="=&gt; tools.nsc.util.NoPosition.type">NoPosition</a>


      // EndExceptionBlock must happen before MarkLabel because it adds the
      // Leave instruction. Otherwise, labels(block) points to the Leave
      // (inside the catch) instead of the instruction afterwards.
      <span class="keyword">for</span> <span class="delimiter">(</span><a title="List[GenMSIL.this.global.icodes.ExceptionHandler]" id="790458">handlers</a> &lt;- <a href="#785602" title="=&gt; scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.BasicBlock,List[GenMSIL.this.global.icodes.ExceptionHandler]]">endExBlock</a>.<a href="../../../../collection/mutable/HashMap.scala.html#79207" title="(key: GenMSIL.this.global.icodes.BasicBlock)Option[List[GenMSIL.this.global.icodes.ExceptionHandler]]">get</a><a href="../../../../Option.scala.html#63839" title="(f: List[GenMSIL.this.global.icodes.ExceptionHandler] =&gt; Unit)Unit" class="delimiter">(</a><a href="#789517" title="GenMSIL.this.global.icodes.BasicBlock">block</a><span class="delimiter">)</span>; <a title="GenMSIL.this.global.icodes.ExceptionHandler" id="790478">exh</a> &lt;- <a href="../../../../collection/LinearSeqOptimized.scala.html#76166" title="(f: GenMSIL.this.global.icodes.ExceptionHandler =&gt; Unit)Unit">handlers</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#785605" title="=&gt; scala.collection.mutable.Stack[GenMSIL.this.global.icodes.ExceptionHandler]">currentHandlers</a>.<a href="../../../../collection/mutable/Stack.scala.html#307336" title="()GenMSIL.this.global.icodes.ExceptionHandler">pop</a><span class="delimiter">(</span><span class="delimiter">)</span>
        <span class="keyword">for</span> <span class="delimiter">(</span><a title="ch.epfl.lamp.compiler.msil.emit.Label" id="790486">l</a> &lt;- <a href="#785620" title="=&gt; scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.ExceptionHandler,ch.epfl.lamp.compiler.msil.emit.Label]">endFinallyLabels</a>.<a href="../../../../collection/mutable/HashMap.scala.html#79207" title="(key: GenMSIL.this.global.icodes.ExceptionHandler)Option[ch.epfl.lamp.compiler.msil.emit.Label]">get</a><a href="../../../../Option.scala.html#63839" title="(f: ch.epfl.lamp.compiler.msil.emit.Label =&gt; Unit)Unit" class="delimiter">(</a><a href="#790478" title="GenMSIL.this.global.icodes.ExceptionHandler">exh</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(label: ch.epfl.lamp.compiler.msil.emit.Label)Unit">MarkLabel</span><span class="delimiter">(</span><a href="#790486" title="ch.epfl.lamp.compiler.msil.emit.Label">l</a><span class="delimiter">)</span>
        <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="()Unit">EndExceptionBlock</span><span class="delimiter">(</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>

      <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(label: ch.epfl.lamp.compiler.msil.emit.Label)Unit">MarkLabel</span><span class="delimiter">(</span><a href="../../../../collection/mutable/HashMap.scala.html#79206" title="(key: GenMSIL.this.global.icodes.BasicBlock)ch.epfl.lamp.compiler.msil.emit.Label">labels</a><span class="delimiter">(</span><a href="#789517" title="GenMSIL.this.global.icodes.BasicBlock">block</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="../../Global.scala.html#559553" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><span title="String(&quot;Generating code for block: &quot;)" class="string">&quot;Generating code for block: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#789517" title="GenMSIL.this.global.icodes.BasicBlock">block</a><span class="delimiter">)</span>

      <span class="keyword">for</span> <span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.ExceptionHandler" id="790526">handler</a> &lt;- <a href="#785600" title="=&gt; scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.BasicBlock,GenMSIL.this.global.icodes.ExceptionHandler]">beginCatchBlock</a>.<a href="../../../../collection/mutable/HashMap.scala.html#79207" title="(key: GenMSIL.this.global.icodes.BasicBlock)Option[GenMSIL.this.global.icodes.ExceptionHandler]">get</a><a href="../../../../Option.scala.html#63839" title="(f: GenMSIL.this.global.icodes.ExceptionHandler =&gt; Unit)Unit" class="delimiter">(</a><a href="#789517" title="GenMSIL.this.global.icodes.BasicBlock">block</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span title="Any" class="keyword">if</span> <span class="delimiter">(</span><a href="../../../../Boolean.scala.html#58721" title="=&gt; Boolean">!</a><a href="#785605" title="=&gt; scala.collection.mutable.Stack[GenMSIL.this.global.icodes.ExceptionHandler]">currentHandlers</a>.<a href="../../../../collection/mutable/Stack.scala.html#307328" title="=&gt; Boolean">isEmpty</a> <a href="../../../../Boolean.scala.html#58725" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#785605" title="=&gt; scala.collection.mutable.Stack[GenMSIL.this.global.icodes.ExceptionHandler]">currentHandlers</a>.<a href="../../../../collection/mutable/Stack.scala.html#307335" title="=&gt; GenMSIL.this.global.icodes.ExceptionHandler">top</a>.<a href="../icode/ExceptionHandlers.scala.html#734072" title="=&gt; scala.collection.immutable.Set[GenMSIL.this.global.icodes.BasicBlock]">covered</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#790526" title="GenMSIL.this.global.icodes.ExceptionHandler">handler</a>.<a href="../icode/ExceptionHandlers.scala.html#734072" title="=&gt; scala.collection.immutable.Set[GenMSIL.this.global.icodes.BasicBlock]">covered</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="#785605" title="=&gt; scala.collection.mutable.Stack[GenMSIL.this.global.icodes.ExceptionHandler]">currentHandlers</a>.<a href="../../../../collection/mutable/Stack.scala.html#307336" title="()GenMSIL.this.global.icodes.ExceptionHandler">pop</a><span class="delimiter">(</span><span class="delimiter">)</span>
          <a href="#785605" title="=&gt; scala.collection.mutable.Stack[GenMSIL.this.global.icodes.ExceptionHandler]">currentHandlers</a>.<a href="../../../../collection/mutable/Stack.scala.html#307332" title="(elem: GenMSIL.this.global.icodes.ExceptionHandler)scala.collection.mutable.Stack[GenMSIL.this.global.icodes.ExceptionHandler]">push</a><span class="delimiter">(</span><a href="#790526" title="GenMSIL.this.global.icodes.ExceptionHandler">handler</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#790526" title="GenMSIL.this.global.icodes.ExceptionHandler">handler</a>.<a href="../icode/ExceptionHandlers.scala.html#734055" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">cls</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../../../reflect/internal/Symbols.scala.html#441152" title="=&gt; GenMSIL.this.global.NoSymbol">NoSymbol</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          // `finally` blocks are represented the same as `catch`, but with no catch-type
          <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="()Unit">BeginFinallyBlock</span><span class="delimiter">(</span><span class="delimiter">)</span>
        <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
          <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.Type" id="790560">t</a> = <a href="#785648" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.Type">getType</a><span class="delimiter">(</span><a href="#790526" title="GenMSIL.this.global.icodes.ExceptionHandler">handler</a>.<a href="../icode/ExceptionHandlers.scala.html#734055" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">cls</a><span class="delimiter">)</span>
          <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(exceptionType: ch.epfl.lamp.compiler.msil.Type)Unit">BeginCatchBlock</span><span class="delimiter">(</span><a href="#790560" title="ch.epfl.lamp.compiler.msil.Type">t</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>
      <span class="keyword">for</span> <span class="delimiter">(</span><a title="List[GenMSIL.this.global.icodes.ExceptionHandler]" id="790569">handlers</a> &lt;- <a href="#785598" title="=&gt; scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.BasicBlock,List[GenMSIL.this.global.icodes.ExceptionHandler]]">beginExBlock</a>.<a href="../../../../collection/mutable/HashMap.scala.html#79207" title="(key: GenMSIL.this.global.icodes.BasicBlock)Option[List[GenMSIL.this.global.icodes.ExceptionHandler]]">get</a><a href="../../../../Option.scala.html#63839" title="(f: List[GenMSIL.this.global.icodes.ExceptionHandler] =&gt; Unit)Unit" class="delimiter">(</a><a href="#789517" title="GenMSIL.this.global.icodes.BasicBlock">block</a><span class="delimiter">)</span>; <a title="GenMSIL.this.global.icodes.ExceptionHandler" id="790589">exh</a> &lt;- <a href="../../../../collection/LinearSeqOptimized.scala.html#76166" title="(f: GenMSIL.this.global.icodes.ExceptionHandler =&gt; Unit)Unit">handlers</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#785605" title="=&gt; scala.collection.mutable.Stack[GenMSIL.this.global.icodes.ExceptionHandler]">currentHandlers</a>.<a href="../../../../collection/mutable/Stack.scala.html#307332" title="(elem: GenMSIL.this.global.icodes.ExceptionHandler)scala.collection.mutable.Stack[GenMSIL.this.global.icodes.ExceptionHandler]">push</a><span class="delimiter">(</span><a href="#790589" title="GenMSIL.this.global.icodes.ExceptionHandler">exh</a><span class="delimiter">)</span>
        <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="()Unit">BeginExceptionBlock</span><span class="delimiter">(</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>

      <span class="keyword">for</span> <span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.Instruction" id="790598">instr</a> &lt;- <a href="../icode/BasicBlocks.scala.html#733774" title="(f: GenMSIL.this.global.icodes.Instruction =&gt; Unit)Unit">block</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="keyword">try</span> <span class="delimiter">{</span>
          <span class="keyword">val</span> <a title="Int" id="790599">currentLineNr</a> = <a href="#790598" title="GenMSIL.this.global.icodes.Instruction">instr</a>.<a href="../icode/Opcodes.scala.html#734294" title="=&gt; scala.tools.nsc.util.Position">pos</a>.<a href="../../util/Position.scala.html#445379" title="=&gt; Int">line</a>
          <span class="keyword">val</span> <a title="Boolean" id="790600">skip</a> = <span title="Boolean" class="keyword">if</span><span class="delimiter">(</span><a href="#790598" title="GenMSIL.this.global.icodes.Instruction">instr</a>.<a href="../icode/Opcodes.scala.html#734294" title="=&gt; scala.tools.nsc.util.Position">pos</a>.<a href="../../util/Position.scala.html#445355" title="=&gt; Boolean">isRange</a><span class="delimiter">)</span> <a href="#790598" title="GenMSIL.this.global.icodes.Instruction">instr</a>.<a href="../icode/Opcodes.scala.html#734294" title="=&gt; scala.tools.nsc.util.Position">pos</a>.<a href="../../util/Position.scala.html#445378" title="(pos: scala.reflect.api.Position)Boolean">sameRange</a><span class="delimiter">(</span><a href="#790119" title="GenMSIL.this.global.Position">lastPos</a><span class="delimiter">)</span> <span class="keyword">else</span> <span class="delimiter">(</span><a href="#790599" title="Int">currentLineNr</a> <a href="../../../../Int.scala.html#57891" title="(x: Int)Boolean">==</a> <a href="#790118" title="Int">lastLineNr</a><span class="delimiter">)</span>;
          <span title="Unit" class="keyword">if</span><span class="delimiter">(</span><a href="../../../../Boolean.scala.html#58721" title="=&gt; Boolean">!</a><a href="#790600" title="Boolean">skip</a> <a href="../../../../Boolean.scala.html#58724" title="(x: Boolean)Boolean">||</a> <a href="../../../../Boolean.scala.html#58721" title="=&gt; Boolean">!</a><a href="#785594" title="=&gt; Boolean">dbFilenameSeen</a><span class="delimiter">)</span> <span class="delimiter">{</span>
            <span class="keyword">val</span> <a title="String" id="790610">fileName</a> = <span title="String" class="keyword">if</span><span class="delimiter">(</span><a href="#785594" title="=&gt; Boolean">dbFilenameSeen</a><span class="delimiter">)</span> <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span> <span class="keyword">else</span> <span class="delimiter">{</span><a href="#785594" title="(x$1: Boolean)Unit">dbFilenameSeen</a> = <span title="Boolean(true)" class="keyword">true</span>; <a href="#785586" title="(iclass: GenMSIL.this.global.icodes.IClass)String">ilasmFileName</a><span class="delimiter">(</span><a href="#785551" title="=&gt; GenMSIL.this.global.icodes.IClass">clasz</a><span class="delimiter">)</span><span class="delimiter">}</span>;
            <span title="Unit" class="keyword">if</span><span class="delimiter">(</span><a href="#790598" title="GenMSIL.this.global.icodes.Instruction">instr</a>.<a href="../icode/Opcodes.scala.html#734294" title="=&gt; scala.tools.nsc.util.Position">pos</a>.<a href="../../util/Position.scala.html#445355" title="=&gt; Boolean">isRange</a><span class="delimiter">)</span> <span class="delimiter">{</span>
              <span class="keyword">val</span> <a title="Int" id="790612">startLine</a> = <a href="#790598" title="GenMSIL.this.global.icodes.Instruction">instr</a>.<a href="../icode/Opcodes.scala.html#734294" title="=&gt; scala.tools.nsc.util.Position">pos</a>.<a href="../../util/Position.scala.html#445370" title="=&gt; scala.tools.nsc.util.Position">focusStart</a>.<a href="../../util/Position.scala.html#445379" title="=&gt; Int">line</a>
              <span class="keyword">val</span> <a title="Int" id="790613">endLine</a>   = <a href="#790598" title="GenMSIL.this.global.icodes.Instruction">instr</a>.<a href="../icode/Opcodes.scala.html#734294" title="=&gt; scala.tools.nsc.util.Position">pos</a>.<a href="../../util/Position.scala.html#445372" title="=&gt; scala.tools.nsc.util.Position">focusEnd</a>.<a href="../../util/Position.scala.html#445379" title="=&gt; Int">line</a>
              <span class="keyword">val</span> <a title="Int" id="790614">startCol</a>  = <a href="#790598" title="GenMSIL.this.global.icodes.Instruction">instr</a>.<a href="../icode/Opcodes.scala.html#734294" title="=&gt; scala.tools.nsc.util.Position">pos</a>.<a href="../../util/Position.scala.html#445370" title="=&gt; scala.tools.nsc.util.Position">focusStart</a>.<a href="../../util/Position.scala.html#445380" title="=&gt; Int">column</a>
              <span class="keyword">val</span> <a title="Int" id="790615">endCol</a>    = <a href="#790598" title="GenMSIL.this.global.icodes.Instruction">instr</a>.<a href="../icode/Opcodes.scala.html#734294" title="=&gt; scala.tools.nsc.util.Position">pos</a>.<a href="../../util/Position.scala.html#445372" title="=&gt; scala.tools.nsc.util.Position">focusEnd</a>.<a href="../../util/Position.scala.html#445380" title="=&gt; Int">column</a>
              <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(startLine: Int, endLine: Int, startCol: Int, endCol: Int, filename: String)Unit">setPosition</span><span class="delimiter">(</span><a href="#790612" title="Int">startLine</a>, <a href="#790613" title="Int">endLine</a>, <a href="#790614" title="Int">startCol</a>, <a href="#790615" title="Int">endCol</a>, <a href="#790610" title="String">fileName</a><span class="delimiter">)</span>
            <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
              <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(line: Int, filename: String)Unit">setPosition</span><span class="delimiter">(</span><a href="#790598" title="GenMSIL.this.global.icodes.Instruction">instr</a>.<a href="../icode/Opcodes.scala.html#734294" title="=&gt; scala.tools.nsc.util.Position">pos</a>.<a href="../../util/Position.scala.html#445379" title="=&gt; Int">line</a>, <a href="#790610" title="String">fileName</a><span class="delimiter">)</span>
            <span class="delimiter">}</span>
            <a href="#790118" title="Int">lastLineNr</a> = <a href="#790599" title="Int">currentLineNr</a>
            <a href="#790119" title="GenMSIL.this.global.Position">lastPos</a> = <a href="#790598" title="GenMSIL.this.global.icodes.Instruction">instr</a>.<a href="../icode/Opcodes.scala.html#734294" title="=&gt; scala.tools.nsc.util.Position">pos</a>
          <span class="delimiter">}</span>
        <span class="delimiter">}</span> <span class="keyword">catch</span> <span class="delimiter">{</span> <span class="keyword">case</span> <span title="Unit">_</span>: <span title="UnsupportedOperationException">UnsupportedOperationException</span> =&gt; <span title="Unit" class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">}</span>

        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#790117" title="Boolean">previousWasNEW</a><span class="delimiter">)</span>
          <a href="../../Global.scala.html#559533" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a><span class="delimiter">(</span><a href="#790598" title="GenMSIL.this.global.icodes.Instruction">instr</a>.<span title="[T0]=&gt; Boolean">isInstanceOf</span><span title="Boolean" class="delimiter">[</span><a href="../icode/Opcodes.scala.html#653385" title="GenMSIL.this.global.icodes.opcodes.DUP">DUP</a><span class="delimiter">]</span>, <a href="#789517" title="GenMSIL.this.global.icodes.BasicBlock">block</a><span class="delimiter">)</span>

        <a href="#790598" title="GenMSIL.this.global.icodes.Instruction">instr</a> <span class="keyword">match</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> THIS<a href="#792688" title="Unit" id="792690" class="delimiter">(</a>clasz<span class="delimiter">)</span> =&gt;
            <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#792769" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldarg_0</span><span class="delimiter">)</span>

          <span class="keyword">case</span> CONSTANT<a href="#792688" title="Unit" id="792692" class="delimiter">(</a>const<span class="delimiter">)</span> =&gt;
            const.<a href="#792769" title="(x: Unit)Unit">tag</a> <span class="keyword">match</span> <span class="delimiter">{</span>
              <span class="keyword">case</span> UnitTag    =&gt; <span title="Unit" class="delimiter">(</span><span class="delimiter">)</span>
              <span class="keyword">case</span> BooleanTag =&gt; <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCode" class="keyword">if</span> <span class="delimiter">(</span>const.<a href="../../../../reflect/internal/Constants.scala.html#443093" title="=&gt; Boolean">booleanValue</a><span class="delimiter">)</span> <span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldc_I4_1</span>
                                            <span class="keyword">else</span> <span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldc_I4_0</span><span class="delimiter">)</span>
              <span class="keyword">case</span> ByteTag    =&gt; <a href="#785625" title="(value: Int, code: ch.epfl.lamp.compiler.msil.emit.ILGenerator)Unit">loadI4</a><span class="delimiter">(</span>const.<a href="../../../../Byte.scala.html#57570" title="=&gt; Int">byteValue</a>, <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a><span class="delimiter">)</span>
              <span class="keyword">case</span> ShortTag   =&gt; <a href="#785625" title="(value: Int, code: ch.epfl.lamp.compiler.msil.emit.ILGenerator)Unit">loadI4</a><span class="delimiter">(</span>const.<a href="../../../../Short.scala.html#57740" title="=&gt; Int">shortValue</a>, <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a><span class="delimiter">)</span>
              <span class="keyword">case</span> CharTag    =&gt; <a href="#785625" title="(value: Int, code: ch.epfl.lamp.compiler.msil.emit.ILGenerator)Unit">loadI4</a><span class="delimiter">(</span>const.<a href="../../../../Char.scala.html#58025" title="=&gt; Int">charValue</a>, <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a><span class="delimiter">)</span>
              <span class="keyword">case</span> IntTag     =&gt; <a href="#785625" title="(value: Int, code: ch.epfl.lamp.compiler.msil.emit.ILGenerator)Unit">loadI4</a><span class="delimiter">(</span>const.<a href="../../../../reflect/internal/Constants.scala.html#443097" title="=&gt; Int">intValue</a>, <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a><span class="delimiter">)</span>
              <span class="keyword">case</span> LongTag    =&gt; <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: Long)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldc_I8</span>, const.<a href="../../../../reflect/internal/Constants.scala.html#443098" title="=&gt; Long">longValue</a><span class="delimiter">)</span>
              <span class="keyword">case</span> FloatTag   =&gt; <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: Float)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldc_R4</span>, const.<a href="../../../../reflect/internal/Constants.scala.html#443099" title="=&gt; Float">floatValue</a><span class="delimiter">)</span>
              <span class="keyword">case</span> DoubleTag  =&gt; <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: Double)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldc_R8</span>, const.<a href="../../../../reflect/internal/Constants.scala.html#443100" title="=&gt; Double">doubleValue</a><span class="delimiter">)</span>
              <span class="keyword">case</span> StringTag  =&gt; <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: String)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldstr</span>, const.<a href="../../../../reflect/internal/Constants.scala.html#443102" title="=&gt; String">stringValue</a><span class="delimiter">)</span>
              <span class="keyword">case</span> NullTag    =&gt; <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldnull</span><span class="delimiter">)</span>
              <span class="keyword">case</span> ClazzTag   =&gt;
                <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.Type)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldtoken</span>, <a href="#785646" title="(tpe: GenMSIL.this.global.Type)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">(</span>const.<a href="../../../../reflect/internal/Constants.scala.html#443105" title="=&gt; GenMSIL.this.global.icodes.global.Type">typeValue</a><span class="delimiter">)</span><span class="delimiter">)</span>
                <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Call</span>, <a href="#785511" title="=&gt; ch.epfl.lamp.compiler.msil.MethodInfo">TYPE_FROM_HANDLE</a><span class="delimiter">)</span>
              <span class="keyword">case</span> _          =&gt; <a href="../../Global.scala.html#559537" title="(msg: String)Nothing">abort</a><span title="Nothing" class="delimiter">(</span><span title="String(&quot;Unknown constant value: &quot;)" class="string">&quot;Unknown constant value: &quot;</span> <span title="(x$1: Any)String">+</span> const<span class="delimiter">)</span>
            <span class="delimiter">}</span>

          <span class="keyword">case</span> LOAD_ARRAY_ITEM<a href="#792688" title="Unit" id="792694" class="delimiter">(</a>kind<span class="delimiter">)</span> =&gt;
            <span class="delimiter">(</span>kind: @<a href="#792769" title="(x: Unit)Unit">unchecked</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
              <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#642719" title="Unit" id="790757">BOOL</a>           =&gt; <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#790765" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldelem_I1</span><span class="delimiter">)</span>
              <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#642721" title="Unit" id="790758">BYTE</a>           =&gt; <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#790765" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldelem_I1</span><span class="delimiter">)</span> // I1 for System.SByte, i.e. a scala.Byte
              <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#642723" title="Unit" id="790759">SHORT</a>          =&gt; <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#790765" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldelem_I2</span><span class="delimiter">)</span>
              <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#642725" title="Unit" id="790760">CHAR</a>           =&gt; <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#790765" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldelem_U2</span><span class="delimiter">)</span>
              <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#642727" title="Unit" id="790761">INT</a>            =&gt; <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#790765" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldelem_I4</span><span class="delimiter">)</span>
              <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#642729" title="Unit" id="790762">LONG</a>           =&gt; <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#790765" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldelem_I8</span><span class="delimiter">)</span>
              <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#642731" title="Unit" id="790763">FLOAT</a>          =&gt; <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#790765" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldelem_R4</span><span class="delimiter">)</span>
              <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#642733" title="Unit" id="790764">DOUBLE</a>         =&gt; <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#790765" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldelem_R8</span><span class="delimiter">)</span>
              <span class="keyword">case</span> REFERENCE<a href="#790744" title="Unit" id="790754" class="delimiter">(</a>cls<span class="delimiter">)</span> =&gt; <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#790765" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldelem_Ref</span><span class="delimiter">)</span>
              <span class="keyword">case</span> ARRAY<a href="#790744" title="Unit" id="790756" class="delimiter">(</a>elem<span class="delimiter">)</span>    =&gt; <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#790765" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldelem_Ref</span><span class="delimiter">)</span>

              // case UNIT is not possible: an Array[Unit] will be an
              //  Array[scala.runtime.BoxedUnit] (-&gt; case REFERENCE)
            <span class="delimiter">}</span>

          <span class="keyword">case</span> LOAD_LOCAL<a href="#792688" title="Unit" id="792696" class="delimiter">(</a>local<span class="delimiter">)</span> =&gt; <a href="#790115" title="(local: GenMSIL.this.global.icodes.Local, msg: String, loadAddr: Boolean)Unit">loadLocalOrAddress</a><a href="#792769" title="(x: Unit)Unit" class="delimiter">(</a>local, <span title="String(&quot;load_local&quot;)" class="string">&quot;load_local&quot;</span>, <span title="Boolean(false)" class="keyword">false</span><span class="delimiter">)</span>

          <span class="keyword">case</span> CIL_LOAD_LOCAL_ADDRESS<a href="#792688" title="Unit" id="792698" class="delimiter">(</a>local<span class="delimiter">)</span> =&gt; <a href="#790115" title="(local: GenMSIL.this.global.icodes.Local, msg: String, loadAddr: Boolean)Unit">loadLocalOrAddress</a><a href="#792769" title="(x: Unit)Unit" class="delimiter">(</a>local, <span title="String(&quot;cil_load_local_address&quot;)" class="string">&quot;cil_load_local_address&quot;</span>, <span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span>

          <span class="keyword">case</span> LOAD_FIELD<a href="#792688" title="Unit" id="792700" class="delimiter">(</a>field, isStatic<span class="delimiter">)</span> =&gt; <a href="#790116" title="(field: GenMSIL.this.global.Symbol, isStatic: Boolean, msg: String, loadAddr: Boolean)Unit">loadFieldOrAddress</a><a href="#792769" title="(x: Unit)Unit" class="delimiter">(</a>field, isStatic, <span title="String(&quot;load_field&quot;)" class="string">&quot;load_field&quot;</span>, <span title="Boolean(false)" class="keyword">false</span><span class="delimiter">)</span>

          <span class="keyword">case</span> CIL_LOAD_FIELD_ADDRESS<a href="#792688" title="Unit" id="792702" class="delimiter">(</a>field, isStatic<span class="delimiter">)</span> =&gt; <a href="#790116" title="(field: GenMSIL.this.global.Symbol, isStatic: Boolean, msg: String, loadAddr: Boolean)Unit">loadFieldOrAddress</a><a href="#792769" title="(x: Unit)Unit" class="delimiter">(</a>field, isStatic, <span title="String(&quot;cil_load_field_address&quot;)" class="string">&quot;cil_load_field_address&quot;</span>, <span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span>

          <span class="keyword">case</span> CIL_LOAD_ARRAY_ITEM_ADDRESS<a href="#792688" title="Unit" id="792704" class="delimiter">(</a>kind<span class="delimiter">)</span> =&gt; <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.Type)Unit">Emit</span><a href="#792769" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldelema</span>, <a href="#785645" title="(t: GenMSIL.this.global.icodes.TypeKind)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">(</span>kind<span class="delimiter">)</span><span class="delimiter">)</span>

          <span class="keyword">case</span> CIL_NEWOBJ<a href="#792688" title="Unit" id="792706" class="delimiter">(</a>msym<span class="delimiter">)</span> =&gt;
            <a href="../../Global.scala.html#559534" title="(assertion: Boolean)Unit">assert</a><span class="delimiter">(</span>msym.<a href="../../../../reflect/internal/Symbols.scala.html#443264" title="=&gt; Boolean">isClassConstructor</a><span class="delimiter">)</span>
            <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.ConstructorInfo" id="790828">constructorInfo</a>: <span title="ch.epfl.lamp.compiler.msil.ConstructorInfo">ConstructorInfo</span> = <a href="#785672" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.ConstructorInfo">getConstructor</a><span class="delimiter">(</span>msym<span class="delimiter">)</span>
            <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.ConstructorInfo)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Newobj</span>, <a href="#790828" title="ch.epfl.lamp.compiler.msil.ConstructorInfo">constructorInfo</a><span class="delimiter">)</span>

          <span class="keyword">case</span> LOAD_MODULE<a href="#792688" title="Unit" id="792708" class="delimiter">(</a>module<span class="delimiter">)</span> =&gt;
            <a href="../../Global.scala.html#559553" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><span title="String(&quot;Generating LOAD_MODULE for: &quot;)" class="string">&quot;Generating LOAD_MODULE for: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#785681" title="(sym: GenMSIL.this.global.Symbol)String">showsym</a><span class="delimiter">(</span>module<span class="delimiter">)</span><span class="delimiter">)</span>
            <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.FieldInfo)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldsfld</span>, <a href="#785658" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.FieldInfo">getModuleInstanceField</a><span class="delimiter">(</span>module<span class="delimiter">)</span><span class="delimiter">)</span>

          <span class="keyword">case</span> STORE_ARRAY_ITEM<a href="#792688" title="Unit" id="792710" class="delimiter">(</a>kind<span class="delimiter">)</span> =&gt;
            <span class="delimiter">(</span>kind: @<a href="#792769" title="(x: Unit)Unit">unchecked</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
              <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#642719" title="Unit" id="790883">BOOL</a>           =&gt; <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#790891" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Stelem_I1</span><span class="delimiter">)</span>
              <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#642721" title="Unit" id="790884">BYTE</a>           =&gt; <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#790891" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Stelem_I1</span><span class="delimiter">)</span>
              <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#642723" title="Unit" id="790885">SHORT</a>          =&gt; <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#790891" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Stelem_I2</span><span class="delimiter">)</span>
              <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#642725" title="Unit" id="790886">CHAR</a>           =&gt; <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#790891" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Stelem_I2</span><span class="delimiter">)</span>
              <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#642727" title="Unit" id="790887">INT</a>            =&gt; <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#790891" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Stelem_I4</span><span class="delimiter">)</span>
              <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#642729" title="Unit" id="790888">LONG</a>           =&gt; <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#790891" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Stelem_I8</span><span class="delimiter">)</span>
              <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#642731" title="Unit" id="790889">FLOAT</a>          =&gt; <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#790891" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Stelem_R4</span><span class="delimiter">)</span>
              <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#642733" title="Unit" id="790890">DOUBLE</a>         =&gt; <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#790891" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Stelem_R8</span><span class="delimiter">)</span>
              <span class="keyword">case</span> REFERENCE<a href="#790870" title="Unit" id="790880" class="delimiter">(</a>cls<span class="delimiter">)</span> =&gt; <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#790891" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Stelem_Ref</span><span class="delimiter">)</span>
              <span class="keyword">case</span> ARRAY<a href="#790870" title="Unit" id="790882" class="delimiter">(</a>elem<span class="delimiter">)</span>    =&gt; <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#790891" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Stelem_Ref</span><span class="delimiter">)</span> // @TODO: test this! (occurs when calling a Array[Object]* vararg param method)

              // case UNIT not possible (see comment at LOAD_ARRAY_ITEM)
            <span class="delimiter">}</span>

          <span class="keyword">case</span> STORE_LOCAL<a href="#792688" title="Unit" id="792712" class="delimiter">(</a>local<span class="delimiter">)</span> =&gt;
            <span class="keyword">val</span> <a title="Boolean" id="790930">isArg</a> = local.<a href="../icode/Members.scala.html#734267" title="=&gt; Boolean">arg</a>
            <span class="keyword">val</span> <a title="Int" id="790931">i</a> = local.<a href="../icode/Members.scala.html#734270" title="=&gt; Int">index</a>
            <a href="../../Global.scala.html#559553" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><span title="String(&quot;store_local for &quot;)" class="string">&quot;store_local for &quot;</span> <span title="(x$1: Any)String">+</span> local <span title="(x$1: Any)String">+</span> <span title="String(&quot;, index &quot;)" class="string">&quot;, index &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#790931" title="Int">i</a><span class="delimiter">)</span>

            // there are some locals defined by the compiler that
            // are isArg and are need to be stored.
            <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#790930" title="Boolean">isArg</a><span class="delimiter">)</span> <span class="delimiter">{</span>
              <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#790931" title="Int">i</a> <a href="../../../../Int.scala.html#57926" title="(x: Int)Boolean">&gt;=</a> -<span title="Int(-128)" class="int">128</span> <a href="../../../../Boolean.scala.html#58725" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#790931" title="Int">i</a> <a href="../../../../Int.scala.html#57912" title="(x: Int)Boolean">&lt;=</a> <span title="Int(127)" class="int">127</span><span class="delimiter">)</span>
                <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: Int)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Starg_S</span>, <a href="#790931" title="Int">i</a><span class="delimiter">)</span>
              <span class="keyword">else</span>
                <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: Int)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Starg</span>, <a href="#790931" title="Int">i</a><span class="delimiter">)</span>
            <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
              <a href="#790931" title="Int">i</a> <span class="keyword">match</span> <span class="delimiter">{</span>
                <span class="keyword">case</span> <span class="int">0</span> =&gt; <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Stloc_0</span><span class="delimiter">)</span>
                <span class="keyword">case</span> <span class="int">1</span> =&gt; <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Stloc_1</span><span class="delimiter">)</span>
                <span class="keyword">case</span> <span class="int">2</span> =&gt; <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Stloc_2</span><span class="delimiter">)</span>
                <span class="keyword">case</span> <span class="int">3</span> =&gt; <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Stloc_3</span><span class="delimiter">)</span>
                <span class="keyword">case</span> _      =&gt;
                  <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#790931" title="Int">i</a> <a href="../../../../Int.scala.html#57926" title="(x: Int)Boolean">&gt;=</a> -<span title="Int(-128)" class="int">128</span> <a href="../../../../Boolean.scala.html#58725" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#790931" title="Int">i</a> <a href="../../../../Int.scala.html#57912" title="(x: Int)Boolean">&lt;=</a> <span title="Int(127)" class="int">127</span><span class="delimiter">)</span>
                    <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.emit.LocalBuilder)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Stloc_S</span>, <a href="../../../../collection/mutable/HashMap.scala.html#79206" title="(key: GenMSIL.this.global.icodes.Local)ch.epfl.lamp.compiler.msil.emit.LocalBuilder">localBuilders</a><span class="delimiter">(</span>local<span class="delimiter">)</span><span class="delimiter">)</span>
                  <span class="keyword">else</span>
                    <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.emit.LocalBuilder)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Stloc</span>, <a href="../../../../collection/mutable/HashMap.scala.html#79206" title="(key: GenMSIL.this.global.icodes.Local)ch.epfl.lamp.compiler.msil.emit.LocalBuilder">localBuilders</a><span class="delimiter">(</span>local<span class="delimiter">)</span><span class="delimiter">)</span>
              <span class="delimiter">}</span>
            <span class="delimiter">}</span>

          <span class="keyword">case</span> STORE_THIS<a href="#792688" title="Unit" id="792715" class="delimiter">(</a>_<span class="delimiter">)</span> =&gt;
            // this only works for impl classes because the self parameter comes first
            // in the method signature. If that changes, this code has to be revisited.
            <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: Int)Unit">Emit</span><a href="#792769" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Starg_S</span>, <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>

          <span class="keyword">case</span> STORE_FIELD<a href="#792688" title="Unit" id="792717" class="delimiter">(</a>field, isStatic<span class="delimiter">)</span> =&gt;
            <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.FieldInfo" id="791033">fieldInfo</a> = <a href="../../symtab/clr/CLRTypes.scala.html#730899" title="=&gt; scala.collection.mutable.Map[GenMSIL.this.global.loaders.clrTypes.global.Symbol,ch.epfl.lamp.compiler.msil.FieldInfo]">fields</a>.<a href="../../../../collection/MapLike.scala.html#78410" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol)Option[ch.epfl.lamp.compiler.msil.FieldInfo]">get</a><a href="#791046" title="(x: ch.epfl.lamp.compiler.msil.FieldInfo)ch.epfl.lamp.compiler.msil.FieldInfo" class="delimiter">(</a>field<span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
              <span class="keyword">case</span> Some<a href="#791042" title="ch.epfl.lamp.compiler.msil.FieldInfo" id="791043" class="delimiter">(</a>fInfo<span class="delimiter">)</span> =&gt; <a href="#791046" title="(x: ch.epfl.lamp.compiler.msil.FieldInfo)ch.epfl.lamp.compiler.msil.FieldInfo">fInfo</a>
              <span class="keyword">case</span> <a href="../../../../Option.scala.html#2498" title="ch.epfl.lamp.compiler.msil.FieldInfo" id="791045">None</a> =&gt;
                <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.FieldInfo" id="791038">fInfo</a> = <a href="#785648" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.Type">getType</a><span class="delimiter">(</span>field.<a href="../../../../reflect/internal/Symbols.scala.html#443379" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">owner</a><span class="delimiter">)</span>.<span title="(x$1: String)ch.epfl.lamp.compiler.msil.FieldInfo">GetField</span><span class="delimiter">(</span><a href="#785633" title="(sym: GenMSIL.this.global.Symbol)String">msilName</a><span class="delimiter">(</span>field<span class="delimiter">)</span><span class="delimiter">)</span>
                <a href="../../../../collection/mutable/MapLike.scala.html#78496" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol, value: ch.epfl.lamp.compiler.msil.FieldInfo)Unit">fields</a><span class="delimiter">(</span>field<span class="delimiter">)</span> = <a href="#791038" title="ch.epfl.lamp.compiler.msil.FieldInfo">fInfo</a>
                <a href="#791038" title="ch.epfl.lamp.compiler.msil.FieldInfo">fInfo</a>
            <span class="delimiter">}</span>
            <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.FieldInfo)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCode" class="keyword">if</span> <span class="delimiter">(</span>isStatic<span class="delimiter">)</span> <span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Stsfld</span> <span class="keyword">else</span> <span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Stfld</span>, <a href="#791033" title="ch.epfl.lamp.compiler.msil.FieldInfo">fieldInfo</a><span class="delimiter">)</span>

          <span class="keyword">case</span> CALL_PRIMITIVE<a href="#792688" title="Unit" id="792719" class="delimiter">(</a>primitive<span class="delimiter">)</span> =&gt;
            <a href="#785624" title="(primitive: GenMSIL.this.global.icodes.Primitive, pos: GenMSIL.this.global.Position)Unit">genPrimitive</a><a href="#792769" title="(x: Unit)Unit" class="delimiter">(</a>primitive, <a href="#790598" title="GenMSIL.this.global.icodes.Instruction">instr</a>.<a href="../icode/Opcodes.scala.html#734294" title="=&gt; scala.tools.nsc.util.Position">pos</a><span class="delimiter">)</span>

          <span class="keyword">case</span> CALL_METHOD<a href="#792688" title="Unit" id="792721" class="delimiter">(</a>msym, style<span class="delimiter">)</span> =&gt;
            <a href="#792769" title="(x: Unit)Unit" class="keyword">if</a> <span class="delimiter">(</span>msym.<a href="../../../../reflect/internal/Symbols.scala.html#443264" title="=&gt; Boolean">isClassConstructor</a><span class="delimiter">)</span> <span class="delimiter">{</span>
              <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.ConstructorInfo" id="791066">constructorInfo</a>: <span title="ch.epfl.lamp.compiler.msil.ConstructorInfo">ConstructorInfo</span> = <a href="#785672" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.ConstructorInfo">getConstructor</a><span class="delimiter">(</span>msym<span class="delimiter">)</span>
              <span class="delimiter">(</span>style: @<a href="../icode/Opcodes.scala.html#653403" title="GenMSIL.this.global.icodes.opcodes.InvokeStyle @unchecked">unchecked</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
                // normal constructor calls are Static..
                <span class="keyword">case</span> Static<a href="#791112" title="Unit" id="791115" class="delimiter">(</a>_<span class="delimiter">)</span> =&gt;
                  <a href="#791119" title="(x: Unit)Unit" class="keyword">if</a> <span class="delimiter">(</span><a href="#785554" title="=&gt; GenMSIL.this.global.icodes.IMethod">method</a>.<a href="../icode/Members.scala.html#733826" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443264" title="=&gt; Boolean">isClassConstructor</a> <a href="../../../../Boolean.scala.html#58725" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#785554" title="=&gt; GenMSIL.this.global.icodes.IMethod">method</a>.<a href="../icode/Members.scala.html#733826" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443379" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">owner</a> <span title="(x$1: AnyRef)Boolean">==</span> msym.<a href="../../../../reflect/internal/Symbols.scala.html#443379" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">owner</a><span class="delimiter">)</span>
                    // we're generating a constructor (method: IMethod is a constructor), and we're
                    // calling another constructor of the same class.

                    // @LUC TODO: this can probably break, namely when having: class A { def this() { new A() } }
                    // instead, we should instruct the CALL_METHOD with additional information, know whether it's
                    // an instance creation constructor call or not.
                    <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.ConstructorInfo)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Call</span>, <a href="#791066" title="ch.epfl.lamp.compiler.msil.ConstructorInfo">constructorInfo</a><span class="delimiter">)</span>
                  <span class="keyword">else</span>
                    <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.ConstructorInfo)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Newobj</span>, <a href="#791066" title="ch.epfl.lamp.compiler.msil.ConstructorInfo">constructorInfo</a><span class="delimiter">)</span>
                <span class="keyword">case</span> SuperCall<a href="#791112" title="Unit" id="791118" class="delimiter">(</a>_<span class="delimiter">)</span> =&gt;
                  <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.ConstructorInfo)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Call</span>, <a href="#791066" title="ch.epfl.lamp.compiler.msil.ConstructorInfo">constructorInfo</a><span class="delimiter">)</span>
                  <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#785655" title="(sym: GenMSIL.this.global.Symbol)Boolean">isStaticModule</a><span class="delimiter">(</span><a href="#785551" title="=&gt; GenMSIL.this.global.icodes.IClass">clasz</a>.<a href="../icode/Members.scala.html#642912" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a><span class="delimiter">)</span> <a href="../../../../Boolean.scala.html#58725" title="(x: Boolean)Boolean">&amp;&amp;</a>
                      <a href="#785640" title="=&gt; scala.collection.mutable.HashSet[GenMSIL.this.global.Symbol]">notInitializedModules</a>.<a href="../../../../collection/mutable/HashSet.scala.html#141569" title="(elem: GenMSIL.this.global.Symbol)Boolean">contains</a><span class="delimiter">(</span><a href="#785551" title="=&gt; GenMSIL.this.global.icodes.IClass">clasz</a>.<a href="../icode/Members.scala.html#642912" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a><span class="delimiter">)</span> <a href="../../../../Boolean.scala.html#58725" title="(x: Boolean)Boolean">&amp;&amp;</a>
                      <a href="#785554" title="=&gt; GenMSIL.this.global.icodes.IMethod">method</a>.<a href="../icode/Members.scala.html#733826" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443264" title="=&gt; Boolean">isClassConstructor</a><span class="delimiter">)</span>
                    <span class="delimiter">{</span>
                      <a href="#785640" title="=&gt; scala.collection.mutable.HashSet[GenMSIL.this.global.Symbol]">notInitializedModules</a> <a href="../../../../collection/mutable/HashSet.scala.html#141571" title="(elem: GenMSIL.this.global.Symbol)BytecodeGenerator.this.notInitializedModules.type">-=</a> <a href="#785551" title="=&gt; GenMSIL.this.global.icodes.IClass">clasz</a>.<a href="../icode/Members.scala.html#642912" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a>
                      <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldarg_0</span><span class="delimiter">)</span>
                      <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.FieldInfo)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Stsfld</span>, <a href="#785658" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.FieldInfo">getModuleInstanceField</a><span class="delimiter">(</span><a href="#785551" title="=&gt; GenMSIL.this.global.icodes.IClass">clasz</a>.<a href="../icode/Members.scala.html#642912" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a><span class="delimiter">)</span><span class="delimiter">)</span>
                    <span class="delimiter">}</span>
              <span class="delimiter">}</span>

            <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>

              <span class="keyword">var</span> <a title="Boolean" id="791124">doEmit</a> = <span title="Boolean(true)" class="keyword">true</span>
              <a href="#785649" title="(sym: GenMSIL.this.global.Symbol)Option[ch.epfl.lamp.compiler.msil.Type]">getTypeOpt</a><a href="../../../../Option.scala.html#64115" title="=&gt; ch.epfl.lamp.compiler.msil.Type" class="delimiter">(</a>msym.<a href="../../../../reflect/internal/Symbols.scala.html#443379" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">owner</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
                <span class="keyword">case</span> Some<a href="#791156" title="Unit" id="791157" class="delimiter">(</a>typ<span class="delimiter">)</span> <span class="keyword">if</span> <span class="delimiter">(</span>typ.<span title="()Boolean">IsEnum</span><span class="delimiter">)</span> =&gt; <a href="#791158" title="(x: Unit)Unit" class="delimiter">{</a>
                  <span class="keyword">def</span> <a title="()Unit" id="791131">negBool</a><span class="delimiter">(</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
                    <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldc_I4_0</span><span class="delimiter">)</span>
                    <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ceq</span><span class="delimiter">)</span>
                  <span class="delimiter">}</span>
                  <a href="#791124" title="Boolean">doEmit</a> = <span title="Boolean(false)" class="keyword">false</span>
                  <span class="keyword">val</span> <a title="msym.NameType" id="791132">name</a> = msym.<a href="../../../../reflect/internal/Symbols.scala.html#443152" title="=&gt; GenMSIL.this.global.icodes.global.Symbol#NameType">name</a>
                  <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#791132" title="msym.NameType">name</a> <span title="(x$1: AnyRef)Boolean">eq</span> <a href="../../../../reflect/internal/StdNames.scala.html#441764" title="GenMSIL.this.global.nme.type">nme</a>.<a href="../../../../reflect/internal/StdNames.scala.html#446791" title="=&gt; GenMSIL.this.global.TermName">EQ</a><span class="delimiter">)</span>       <span class="delimiter">{</span> <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ceq</span><span class="delimiter">)</span> <span class="delimiter">}</span>
                  <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#791132" title="msym.NameType">name</a> <span title="(x$1: AnyRef)Boolean">eq</span> <a href="../../../../reflect/internal/StdNames.scala.html#441764" title="GenMSIL.this.global.nme.type">nme</a>.<a href="../../../../reflect/internal/StdNames.scala.html#446815" title="=&gt; GenMSIL.this.global.TermName">NE</a><span class="delimiter">)</span>  <span class="delimiter">{</span> <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ceq</span><span class="delimiter">)</span>; <a href="#791131" title="()Unit">negBool</a> <span class="delimiter">}</span>
                  <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#791132" title="msym.NameType">name</a> <span title="(x$1: AnyRef)Boolean">eq</span> <a href="../../../../reflect/internal/StdNames.scala.html#441764" title="GenMSIL.this.global.nme.type">nme</a>.<a href="../../../../reflect/internal/StdNames.scala.html#446807" title="=&gt; GenMSIL.this.global.TermName">LT</a><span class="delimiter">)</span>  <span class="delimiter">{</span> <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Clt</span><span class="delimiter">)</span> <span class="delimiter">}</span>
                  <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#791132" title="msym.NameType">name</a> <span title="(x$1: AnyRef)Boolean">eq</span> <a href="../../../../reflect/internal/StdNames.scala.html#441764" title="GenMSIL.this.global.nme.type">nme</a>.<a href="../../../../reflect/internal/StdNames.scala.html#446801" title="=&gt; GenMSIL.this.global.TermName">LE</a><span class="delimiter">)</span>  <span class="delimiter">{</span> <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Cgt</span><span class="delimiter">)</span>; <a href="#791131" title="()Unit">negBool</a> <span class="delimiter">}</span>
                  <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#791132" title="msym.NameType">name</a> <span title="(x$1: AnyRef)Boolean">eq</span> <a href="../../../../reflect/internal/StdNames.scala.html#441764" title="GenMSIL.this.global.nme.type">nme</a>.<a href="../../../../reflect/internal/StdNames.scala.html#446797" title="=&gt; GenMSIL.this.global.TermName">GT</a><span class="delimiter">)</span>  <span class="delimiter">{</span> <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Cgt</span><span class="delimiter">)</span> <span class="delimiter">}</span>
                  <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#791132" title="msym.NameType">name</a> <span title="(x$1: AnyRef)Boolean">eq</span> <a href="../../../../reflect/internal/StdNames.scala.html#441764" title="GenMSIL.this.global.nme.type">nme</a>.<a href="../../../../reflect/internal/StdNames.scala.html#446795" title="=&gt; GenMSIL.this.global.TermName">GE</a><span class="delimiter">)</span>  <span class="delimiter">{</span> <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Clt</span><span class="delimiter">)</span>; <a href="#791131" title="()Unit">negBool</a> <span class="delimiter">}</span>
                  <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#791132" title="msym.NameType">name</a> <span title="(x$1: AnyRef)Boolean">eq</span> <a href="../../../../reflect/internal/StdNames.scala.html#441764" title="GenMSIL.this.global.nme.type">nme</a>.<a href="../../../../reflect/internal/StdNames.scala.html#446817" title="=&gt; GenMSIL.this.global.TermName">OR</a><span class="delimiter">)</span>  <span class="delimiter">{</span> <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Or</span><span class="delimiter">)</span> <span class="delimiter">}</span>
                  <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#791132" title="msym.NameType">name</a> <span title="(x$1: AnyRef)Boolean">eq</span> <a href="../../../../reflect/internal/StdNames.scala.html#441764" title="GenMSIL.this.global.nme.type">nme</a>.<a href="../../../../reflect/internal/StdNames.scala.html#446785" title="=&gt; GenMSIL.this.global.TermName">AND</a><span class="delimiter">)</span> <span class="delimiter">{</span> <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">And</span><span class="delimiter">)</span> <span class="delimiter">}</span>
                  <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#791132" title="msym.NameType">name</a> <span title="(x$1: AnyRef)Boolean">eq</span> <a href="../../../../reflect/internal/StdNames.scala.html#441764" title="GenMSIL.this.global.nme.type">nme</a>.<a href="../../../../reflect/internal/StdNames.scala.html#446823" title="=&gt; GenMSIL.this.global.TermName">XOR</a><span class="delimiter">)</span> <span class="delimiter">{</span> <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Xor</span><span class="delimiter">)</span> <span class="delimiter">}</span>
                  <span class="keyword">else</span>
                    <a href="#791124" title="Boolean">doEmit</a> = <span title="Boolean(true)" class="keyword">true</span>
                <span class="delimiter">}</span>
                <span class="keyword">case</span> _ =&gt; <a href="#791158" title="(x: Unit)Unit" class="delimiter">(</a><span class="delimiter">)</span>
              <span class="delimiter">}</span>

              // method: implicit view(FunctionX[PType0, PType1, ...,PTypeN, ResType]):DelegateType
              <span class="keyword">val</span> <a href="#791235" title="(x: (Boolean, GenMSIL.this.global.Type, GenMSIL.this.global.Type))(Boolean, GenMSIL.this.global.Type, GenMSIL.this.global.Type)" class="delimiter">(</a><a href="../../../../Tuple3.scala.html#61402" title="Boolean" id="791126">isDelegateView</a>, <a href="../../../../Tuple3.scala.html#61404" title="GenMSIL.this.global.Type" id="791127">paramType</a>, <a href="../../../../Tuple3.scala.html#61406" title="GenMSIL.this.global.Type" id="791128">resType</a><span class="delimiter">)</span> = <a href="../../Global.scala.html#559754" title="(op: =&gt; (Boolean, GenMSIL.this.global.Type, GenMSIL.this.global.Type))(Boolean, GenMSIL.this.global.Type, GenMSIL.this.global.Type)">beforeTyper</a> <a href="../../../../Tuple3.scala.html#214" title="(Boolean, GenMSIL.this.global.Type, GenMSIL.this.global.Type) @unchecked" class="delimiter">{</a>
                msym.<a href="../../../../reflect/internal/Symbols.scala.html#443425" title="=&gt; GenMSIL.this.global.icodes.global.Type">tpe</a> <span class="keyword">match</span> <span class="delimiter">{</span>
                  <span class="keyword">case</span> MethodType<a href="#791209" title="(Boolean, GenMSIL.this.global.Type, GenMSIL.this.global.Type)" id="791211" class="delimiter">(</a>params, resultType<span class="delimiter">)</span>
                  <span class="keyword">if</span> <span class="delimiter">(</span>params.<a href="../../../../collection/LinearSeqOptimized.scala.html#76164" title="=&gt; Int">length</a> <a href="../../../../Int.scala.html#57891" title="(x: Int)Boolean">==</a> <span title="Int(1)" class="int">1</span> <a href="../../../../Boolean.scala.html#58725" title="(x: Boolean)Boolean">&amp;&amp;</a> msym.<a href="../../../../reflect/internal/Symbols.scala.html#443152" title="=&gt; GenMSIL.this.global.icodes.global.Symbol#NameType">name</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../../../reflect/internal/StdNames.scala.html#441764" title="GenMSIL.this.global.nme.type">nme</a>.<a href="../../../../reflect/internal/StdNames.scala.html#446727" title="=&gt; GenMSIL.this.global.nme.NameType">view_</a><span class="delimiter">)</span> =&gt;
                    <span class="keyword">val</span> <a title="GenMSIL.this.global.Type" id="791179">paramType</a> = <a href="../../../../collection/LinearSeqOptimized.scala.html#76165" title="(n: Int)GenMSIL.this.global.Symbol">params</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>.<a href="../../../../reflect/internal/Symbols.scala.html#443425" title="=&gt; GenMSIL.this.global.Type">tpe</a>
                    <span class="keyword">val</span> <a title="Boolean" id="791180">isDel</a> = <a href="../../../../reflect/internal/Definitions.scala.html#441641" title="GenMSIL.this.global.definitions.type">definitions</a>.<a href="../../../../reflect/internal/Definitions.scala.html#442538" title="(delegateType: GenMSIL.this.global.Type, functionType: GenMSIL.this.global.Type)Boolean">isCorrespondingDelegate</a><span class="delimiter">(</span>resultType, <a href="#791179" title="GenMSIL.this.global.Type">paramType</a><span class="delimiter">)</span>
                    <a href="../../../../Tuple3.scala.html#64156" title="(_1: Boolean, _2: GenMSIL.this.global.Type, _3: GenMSIL.this.global.Type)(Boolean, GenMSIL.this.global.Type, GenMSIL.this.global.Type)" class="delimiter">(</a><a href="#791180" title="Boolean">isDel</a>, <a href="#791179" title="GenMSIL.this.global.Type">paramType</a>, resultType<span class="delimiter">)</span>
                  <span class="keyword">case</span> _ =&gt; <a href="#791212" title="(x: (Boolean, GenMSIL.this.global.Type, GenMSIL.this.global.Type))(Boolean, GenMSIL.this.global.Type, GenMSIL.this.global.Type)" class="delimiter">(</a><span title="Boolean(false)" class="keyword">false</span>, <span title="Null(null)" class="keyword">null</span>, <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span>
                <span class="delimiter">}</span>
              <span class="delimiter">}</span>
              <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#791124" title="Boolean">doEmit</a> <a href="../../../../Boolean.scala.html#58725" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#791126" title="Boolean">isDelegateView</a><span class="delimiter">)</span> <span class="delimiter">{</span>
                <a href="#791124" title="Boolean">doEmit</a> = <span title="Boolean(false)" class="keyword">false</span>
                <a href="#785669" title="(functionType: GenMSIL.this.global.Type, delegateType: GenMSIL.this.global.Type)Unit">createDelegateCaller</a><span class="delimiter">(</span><a href="#791127" title="GenMSIL.this.global.Type">paramType</a>, <a href="#791128" title="GenMSIL.this.global.Type">resType</a><span class="delimiter">)</span>
              <span class="delimiter">}</span>

              <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#791124" title="Boolean">doEmit</a> <a href="../../../../Boolean.scala.html#58725" title="(x: Boolean)Boolean">&amp;&amp;</a>
                  <span class="delimiter">(</span>msym.<a href="../../../../reflect/internal/Symbols.scala.html#443152" title="=&gt; GenMSIL.this.global.icodes.global.Symbol#NameType">name</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../../../reflect/internal/StdNames.scala.html#441764" title="GenMSIL.this.global.nme.type">nme</a>.<a href="../../../../reflect/internal/StdNames.scala.html#446819" title="=&gt; GenMSIL.this.global.TermName">PLUS</a> <a href="../../../../Boolean.scala.html#58724" title="(x: Boolean)Boolean">||</a> msym.<a href="../../../../reflect/internal/Symbols.scala.html#443152" title="=&gt; GenMSIL.this.global.icodes.global.Symbol#NameType">name</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../../../reflect/internal/StdNames.scala.html#441764" title="GenMSIL.this.global.nme.type">nme</a>.<a href="../../../../reflect/internal/StdNames.scala.html#446809" title="=&gt; GenMSIL.this.global.TermName">MINUS</a><span class="delimiter">)</span>
                  <a href="../../../../Boolean.scala.html#58725" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../symtab/SymbolLoaders.scala.html#650372" title="GenMSIL.this.global.loaders.clrTypes.type">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#730914" title="(t: ch.epfl.lamp.compiler.msil.Type)Boolean">isDelegateType</a><span class="delimiter">(</span><a href="#785646" title="(tpe: GenMSIL.this.global.Type)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">(</span>msym.<a href="../../../../reflect/internal/Symbols.scala.html#443379" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">owner</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443425" title="=&gt; GenMSIL.this.global.icodes.global.Type">tpe</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
                <span class="delimiter">{</span>
                <a href="#791124" title="Boolean">doEmit</a> = <span title="Boolean(false)" class="keyword">false</span>
                <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.MethodInfo" id="792099">methodInfo</a>: <span title="ch.epfl.lamp.compiler.msil.MethodInfo">MethodInfo</span> = <a href="#785674" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.MethodInfo">getMethod</a><span class="delimiter">(</span>msym<span class="delimiter">)</span>
                // call it as a static method, even if the compiler (symbol) thinks it's virtual
                <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Call</span>, <a href="#792099" title="ch.epfl.lamp.compiler.msil.MethodInfo">methodInfo</a><span class="delimiter">)</span>
                <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.Type)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Castclass</span>, <a href="#785646" title="(tpe: GenMSIL.this.global.Type)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">(</span>msym.<a href="../../../../reflect/internal/Symbols.scala.html#443379" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">owner</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443425" title="=&gt; GenMSIL.this.global.icodes.global.Type">tpe</a><span class="delimiter">)</span><span class="delimiter">)</span>
              <span class="delimiter">}</span>

              <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#791124" title="Boolean">doEmit</a> <a href="../../../../Boolean.scala.html#58725" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../../../reflect/internal/Definitions.scala.html#441641" title="GenMSIL.this.global.definitions.type">definitions</a>.<a href="../../../../reflect/internal/Definitions.scala.html#442533" title="=&gt; List[GenMSIL.this.global.Symbol]">Delegate_scalaCallers</a>.<a href="../../../../collection/SeqLike.scala.html#59768" title="(elem: Any)Boolean">contains</a><span class="delimiter">(</span>msym<span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
                <a href="#791124" title="Boolean">doEmit</a> = <span title="Boolean(false)" class="keyword">false</span>
                <span class="keyword">val</span> <a title="GenMSIL.this.global.Symbol" id="792114">methodSym</a>: <a href="../../../../reflect/internal/Symbols.scala.html#441132" title="GenMSIL.this.global.Symbol">Symbol</a> = <a href="../../../../reflect/internal/Definitions.scala.html#441641" title="GenMSIL.this.global.definitions.type">definitions</a>.<a href="../../../../collection/mutable/HashMap.scala.html#79206" title="(key: GenMSIL.this.global.Symbol)GenMSIL.this.global.Symbol">Delegate_scalaCallerTargets</a><span class="delimiter">(</span>msym<span class="delimiter">)</span>
                <span class="keyword">val</span> <a title="GenMSIL.this.global.Type" id="792115">delegateType</a>: <a href="../../../../reflect/internal/Types.scala.html#441242" title="GenMSIL.this.global.Type">Type</a> = msym.<a href="../../../../reflect/internal/Symbols.scala.html#443425" title="=&gt; GenMSIL.this.global.icodes.global.Type">tpe</a> <span class="keyword">match</span> <span class="delimiter">{</span>
                  <span class="keyword">case</span> MethodType<a href="#792153" title="GenMSIL.this.global.Type" id="792156" class="delimiter">(</a>_, retType<span class="delimiter">)</span> =&gt; <a href="#792157" title="(x: GenMSIL.this.global.Type)GenMSIL.this.global.Type">retType</a>
                  <span class="keyword">case</span> _ =&gt; <a href="../../Global.scala.html#559537" title="(msg: String)Nothing">abort</a><a href="#792157" title="(x: GenMSIL.this.global.Type)GenMSIL.this.global.Type" class="delimiter">(</a><span title="String(&quot;not a method type: &quot;)" class="string">&quot;not a method type: &quot;</span> <span title="(x$1: Any)String">+</span> msym.<a href="../../../../reflect/internal/Symbols.scala.html#443425" title="=&gt; GenMSIL.this.global.icodes.global.Type">tpe</a><span class="delimiter">)</span>
                <span class="delimiter">}</span>
                <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.MethodInfo" id="792116">methodInfo</a>: <span title="ch.epfl.lamp.compiler.msil.MethodInfo">MethodInfo</span> = <a href="#785674" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.MethodInfo">getMethod</a><span class="delimiter">(</span><a href="#792114" title="GenMSIL.this.global.Symbol">methodSym</a><span class="delimiter">)</span>
                <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.ConstructorInfo" id="792117">delegCtor</a> = <a href="#785646" title="(tpe: GenMSIL.this.global.Type)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">(</span><a href="#792115" title="GenMSIL.this.global.Type">delegateType</a><span class="delimiter">)</span>.<span title="(x$1: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.ConstructorInfo">GetConstructor</span><span class="delimiter">(</span><a href="../../../../Array.scala.html#68728" title="(xs: ch.epfl.lamp.compiler.msil.Type*)(implicit evidence$2: scala.reflect.ArrayTag[ch.epfl.lamp.compiler.msil.Type])Array[ch.epfl.lamp.compiler.msil.Type]">Array</a><a href="../../../../reflect/ClassTag.scala.html#61898" title="(erasure1: Class[_])scala.reflect.ClassTag[ch.epfl.lamp.compiler.msil.Type]" class="delimiter">(</a><a href="../../symtab/clr/CLRTypes.scala.html#730866" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MOBJECT</a>, <a href="#785513" title="=&gt; ch.epfl.lamp.compiler.msil.Type">INT_PTR</a><span class="delimiter">)</span><span class="delimiter">)</span>
                <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#792114" title="GenMSIL.this.global.Symbol">methodSym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443356" title="=&gt; Boolean">isStatic</a><span class="delimiter">)</span> <span class="delimiter">{</span>
                  <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldftn</span>, <a href="#792116" title="ch.epfl.lamp.compiler.msil.MethodInfo">methodInfo</a><span class="delimiter">)</span>
                <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
                  <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Dup</span><span class="delimiter">)</span>
                  <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldvirtftn</span>, <a href="#792116" title="ch.epfl.lamp.compiler.msil.MethodInfo">methodInfo</a><span class="delimiter">)</span>
                <span class="delimiter">}</span>
                <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.ConstructorInfo)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Newobj</span>, <a href="#792117" title="ch.epfl.lamp.compiler.msil.ConstructorInfo">delegCtor</a><span class="delimiter">)</span>
              <span class="delimiter">}</span>

              <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#791124" title="Boolean">doEmit</a><span class="delimiter">)</span> <span class="delimiter">{</span>
                <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.MethodInfo" id="792211">methodInfo</a>: <span title="ch.epfl.lamp.compiler.msil.MethodInfo">MethodInfo</span> = <a href="#785674" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.MethodInfo">getMethod</a><span class="delimiter">(</span>msym<span class="delimiter">)</span>
                <span class="delimiter">(</span>style: @<a href="../icode/Opcodes.scala.html#653403" title="GenMSIL.this.global.icodes.opcodes.InvokeStyle @unchecked">unchecked</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
                  <span class="keyword">case</span> SuperCall<a href="#792263" title="Unit" id="792266" class="delimiter">(</a>_<span class="delimiter">)</span> =&gt;
                    <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><a href="#792272" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Call</span>, <a href="#792211" title="ch.epfl.lamp.compiler.msil.MethodInfo">methodInfo</a><span class="delimiter">)</span>
                  <span class="keyword">case</span> <a href="../icode/Opcodes.scala.html#653404" title="Unit" id="792271">Dynamic</a> =&gt;
                    // methodInfo.DeclaringType is null for global methods
                    <span class="keyword">val</span> <a title="Boolean" id="792217">isValuetypeMethod</a> = <span class="delimiter">(</span><a href="#792211" title="ch.epfl.lamp.compiler.msil.MethodInfo">methodInfo</a>.<span title="ch.epfl.lamp.compiler.msil.Type">DeclaringType</span> <span title="(x$1: AnyRef)Boolean">ne</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <a href="../../../../Boolean.scala.html#58725" title="(x: Boolean)Boolean">&amp;&amp;</a> <span class="delimiter">(</span><a href="#792211" title="ch.epfl.lamp.compiler.msil.MethodInfo">methodInfo</a>.<span title="ch.epfl.lamp.compiler.msil.Type">DeclaringType</span>.<span title="()Boolean">IsValueType</span><span class="delimiter">)</span>
                    <span class="keyword">val</span> <a title="Boolean" id="792218">isValuetypeVirtualMethod</a> = <a href="#792217" title="Boolean">isValuetypeMethod</a> <a href="../../../../Boolean.scala.html#58725" title="(x: Boolean)Boolean">&amp;&amp;</a> <span class="delimiter">(</span><a href="#792211" title="ch.epfl.lamp.compiler.msil.MethodInfo">methodInfo</a>.<span title="()Boolean">IsVirtual</span><span class="delimiter">)</span>
                    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../../../collection/GenSetLike.scala.html#65156" title="(elem: GenMSIL.this.global.Symbol)Boolean">dynToStatMapped</a><span class="delimiter">(</span>msym<span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
                      <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Call</span>, <a href="#792211" title="ch.epfl.lamp.compiler.msil.MethodInfo">methodInfo</a><span class="delimiter">)</span>
                    <span class="delimiter">}</span> <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#792218" title="Boolean">isValuetypeVirtualMethod</a><span class="delimiter">)</span> <span class="delimiter">{</span>
                      <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.Type)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Constrained</span>, <a href="#792211" title="ch.epfl.lamp.compiler.msil.MethodInfo">methodInfo</a>.<span title="ch.epfl.lamp.compiler.msil.Type">DeclaringType</span><span class="delimiter">)</span>
                      <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Callvirt</span>, <a href="#792211" title="ch.epfl.lamp.compiler.msil.MethodInfo">methodInfo</a><span class="delimiter">)</span>
                    <span class="delimiter">}</span> <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#792217" title="Boolean">isValuetypeMethod</a><span class="delimiter">)</span> <span class="delimiter">{</span>
                      // otherwise error &quot;Callvirt on a value type method&quot; ensues
                      <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Call</span>, <a href="#792211" title="ch.epfl.lamp.compiler.msil.MethodInfo">methodInfo</a><span class="delimiter">)</span>
                    <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
                      <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Callvirt</span>, <a href="#792211" title="ch.epfl.lamp.compiler.msil.MethodInfo">methodInfo</a><span class="delimiter">)</span>
                    <span class="delimiter">}</span>
                  <span class="keyword">case</span> Static<a href="#792263" title="Unit" id="792270" class="delimiter">(</a>_<span class="delimiter">)</span> =&gt;
                    <a href="#792272" title="(x: Unit)Unit" class="keyword">if</a><span class="delimiter">(</span><a href="#792211" title="ch.epfl.lamp.compiler.msil.MethodInfo">methodInfo</a>.<span title="()Boolean">IsVirtual</span> <a href="../../../../Boolean.scala.html#58725" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../../../Boolean.scala.html#58721" title="=&gt; Boolean">!</a><a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="()Boolean">Ldarg0WasJustEmitted</span><span class="delimiter">)</span> <span class="delimiter">{</span>
                      <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Callvirt</span>, <a href="#792211" title="ch.epfl.lamp.compiler.msil.MethodInfo">methodInfo</a><span class="delimiter">)</span>
                    <span class="delimiter">}</span> <span class="keyword">else</span> <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Call</span>, <a href="#792211" title="ch.epfl.lamp.compiler.msil.MethodInfo">methodInfo</a><span class="delimiter">)</span>
              <span class="delimiter">}</span>
            <span class="delimiter">}</span>
            <span class="delimiter">}</span>

          <span class="keyword">case</span> BOX<a href="#792688" title="Unit" id="792723" class="delimiter">(</a>boxType<span class="delimiter">)</span> =&gt;
            <a href="#785670" title="(code: ch.epfl.lamp.compiler.msil.emit.ILGenerator, boxType: GenMSIL.this.global.icodes.TypeKind)Unit">emitBox</a><a href="#792769" title="(x: Unit)Unit" class="delimiter">(</a><a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>, boxType<span class="delimiter">)</span>

          <span class="keyword">case</span> UNBOX<a href="#792688" title="Unit" id="792725" class="delimiter">(</a>boxType<span class="delimiter">)</span> =&gt;
            <a href="#785671" title="(code: ch.epfl.lamp.compiler.msil.emit.ILGenerator, boxType: GenMSIL.this.global.icodes.TypeKind)Unit">emitUnbox</a><a href="#792769" title="(x: Unit)Unit" class="delimiter">(</a><a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>, boxType<span class="delimiter">)</span>

          <span class="keyword">case</span> CIL_UNBOX<a href="#792688" title="Unit" id="792727" class="delimiter">(</a>boxType<span class="delimiter">)</span> =&gt;
            <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.Type)Unit">Emit</span><a href="#792769" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Unbox</span>, <a href="#785645" title="(t: GenMSIL.this.global.icodes.TypeKind)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">(</span>boxType<span class="delimiter">)</span><span class="delimiter">)</span>

          <span class="keyword">case</span> CIL_INITOBJ<a href="#792688" title="Unit" id="792729" class="delimiter">(</a>valueType<span class="delimiter">)</span> =&gt;
            <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.Type)Unit">Emit</span><a href="#792769" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Initobj</span>, <a href="#785645" title="(t: GenMSIL.this.global.icodes.TypeKind)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">(</span>valueType<span class="delimiter">)</span><span class="delimiter">)</span>

          <span class="keyword">case</span> NEW<a href="#792688" title="Unit" id="792732" class="delimiter">(</a>REFERENCE<span class="delimiter">(</span>cls<span class="delimiter">)</span><span class="delimiter">)</span> =&gt;
            // the next instruction must be a DUP, see comment on `var previousWasNEW`
            <a href="#790117" title="Boolean">previousWasNEW</a> = <span title="Boolean(true)" class="keyword">true</span>

          // works also for arrays and reference-types
          <span class="keyword">case</span> CREATE_ARRAY<a href="#792688" title="Unit" id="792734" class="delimiter">(</a>elem, dims<span class="delimiter">)</span> =&gt;
            // TODO: handle multi dimensional arrays
            <a href="../../Global.scala.html#559533" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a><span class="delimiter">(</span>dims <a href="../../../../Int.scala.html#57891" title="(x: Int)Boolean">==</a> <span title="Int(1)" class="int">1</span>, <span title="String(&quot;Can\'t handle multi dimensional arrays&quot;)" class="string">&quot;Can't handle multi dimensional arrays&quot;</span><span class="delimiter">)</span>
            <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.Type)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Newarr</span>, <a href="#785645" title="(t: GenMSIL.this.global.icodes.TypeKind)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">(</span>elem<span class="delimiter">)</span><span class="delimiter">)</span>

          // works for arrays and reference-types
          <span class="keyword">case</span> IS_INSTANCE<a href="#792688" title="Unit" id="792736" class="delimiter">(</a>tpe<span class="delimiter">)</span> =&gt;
            <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.Type)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Isinst</span>, <a href="#785645" title="(t: GenMSIL.this.global.icodes.TypeKind)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">(</span>tpe<span class="delimiter">)</span><span class="delimiter">)</span>
            <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldnull</span><span class="delimiter">)</span>
            <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ceq</span><span class="delimiter">)</span>
            <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldc_I4_0</span><span class="delimiter">)</span>
            <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ceq</span><span class="delimiter">)</span>

          // works for arrays and reference-types
          // part from the scala reference: &quot;S &lt;: T does not imply
          //  Array[S] &lt;: Array[T] in Scala. However, it is possible
          //  to cast an array of S to an array of T if such a cast
          //  is permitted in the host environment.&quot;
          <span class="keyword">case</span> CHECK_CAST<a href="#792688" title="Unit" id="792738" class="delimiter">(</a>tpknd<span class="delimiter">)</span> =&gt;
            <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.Type" id="792355">tMSIL</a> = <a href="#785645" title="(t: GenMSIL.this.global.icodes.TypeKind)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">(</span>tpknd<span class="delimiter">)</span>
              <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.Type)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Castclass</span>, <a href="#792355" title="ch.epfl.lamp.compiler.msil.Type">tMSIL</a><span class="delimiter">)</span>

          // no SWITCH is generated when there's
          //  - a default case (&quot;case _ =&gt; ...&quot;) in the matching expr
          //  - OR is used (&quot;case 1 | 2 =&gt; ...&quot;)
          <span class="keyword">case</span> SWITCH<a href="#792688" title="Unit" id="792740" class="delimiter">(</a>tags, branches<span class="delimiter">)</span> =&gt;
            // tags is List[List[Int]]; a list of integers for every label.
            //    if the int on stack is 4, and 4 is in the second list =&gt; jump
            //    to second label
            // branches is List[BasicBlock]
            //    the labels to jump to (the last one is the default one)

            <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.LocalBuilder" id="792370">switchLocal</a> = <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(localType: ch.epfl.lamp.compiler.msil.Type)ch.epfl.lamp.compiler.msil.emit.LocalBuilder">DeclareLocal</span><span class="delimiter">(</span><a href="../../symtab/clr/CLRTypes.scala.html#730836" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MINT</a><span class="delimiter">)</span>
            // several switch variables will appear with the same name in the
            //  assembly code, but this makes no truble
            <a href="#792370" title="ch.epfl.lamp.compiler.msil.emit.LocalBuilder">switchLocal</a>.<span title="(name: String)Unit">SetLocalSymInfo</span><span class="delimiter">(</span><span title="String(&quot;$switch_var&quot;)" class="string">&quot;$switch_var&quot;</span><span class="delimiter">)</span>

            <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.emit.LocalBuilder)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Stloc</span>, <a href="#792370" title="ch.epfl.lamp.compiler.msil.emit.LocalBuilder">switchLocal</a><span class="delimiter">)</span>
            <span class="keyword">var</span> <a title="Int" id="792371">i</a> = <span title="Int(0)" class="int">0</span>
            <span class="keyword">for</span> <span class="delimiter">(</span><a title="List[Int]" id="792396">l</a> &lt;- <a href="../../../../collection/LinearSeqOptimized.scala.html#76166" title="(f: List[Int] =&gt; Unit)Unit">tags</a><span class="delimiter">)</span> <span class="delimiter">{</span>
              <span class="keyword">var</span> <a title="ch.epfl.lamp.compiler.msil.emit.Label" id="792397">targetLabel</a> = <a href="../../../../collection/mutable/HashMap.scala.html#79206" title="(key: GenMSIL.this.global.icodes.BasicBlock)ch.epfl.lamp.compiler.msil.emit.Label">labels</a><span class="delimiter">(</span><a href="../../../../collection/LinearSeqOptimized.scala.html#76165" title="(n: Int)GenMSIL.this.global.icodes.BasicBlock">branches</a><span class="delimiter">(</span><a href="#792371" title="Int">i</a><span class="delimiter">)</span><span class="delimiter">)</span>
              <span class="keyword">for</span> <span class="delimiter">(</span><a title="Int" id="792443">i</a> &lt;- <a href="../../../../collection/LinearSeqOptimized.scala.html#76166" title="(f: Int =&gt; Unit)Unit">l</a><span class="delimiter">)</span> <span class="delimiter">{</span>
                <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.emit.LocalBuilder)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldloc</span>, <a href="#792370" title="ch.epfl.lamp.compiler.msil.emit.LocalBuilder">switchLocal</a><span class="delimiter">)</span>
                <a href="#785625" title="(value: Int, code: ch.epfl.lamp.compiler.msil.emit.ILGenerator)Unit">loadI4</a><span class="delimiter">(</span><a href="#792443" title="Int">i</a>, <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a><span class="delimiter">)</span>
                <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, label: ch.epfl.lamp.compiler.msil.emit.Label)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Beq</span>, <a href="#792397" title="ch.epfl.lamp.compiler.msil.emit.Label">targetLabel</a><span class="delimiter">)</span>
              <span class="delimiter">}</span>
              <a href="#792371" title="Int">i</a> <a href="../../../../Int.scala.html#57948" title="(x: Int)Int">+=</a> <span title="Int(1)" class="int">1</span>
            <span class="delimiter">}</span>
            <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.Label" id="792372">defaultTarget</a> = <a href="../../../../collection/mutable/HashMap.scala.html#79206" title="(key: GenMSIL.this.global.icodes.BasicBlock)ch.epfl.lamp.compiler.msil.emit.Label">labels</a><span class="delimiter">(</span><a href="../../../../collection/LinearSeqOptimized.scala.html#76165" title="(n: Int)GenMSIL.this.global.icodes.BasicBlock">branches</a><span class="delimiter">(</span><a href="#792371" title="Int">i</a><span class="delimiter">)</span><span class="delimiter">)</span>
            <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#789519" title="GenMSIL.this.global.icodes.BasicBlock">next</a> <span title="(x$1: AnyRef)Boolean">!=</span> <a href="../../../../collection/LinearSeqOptimized.scala.html#76165" title="(n: Int)GenMSIL.this.global.icodes.BasicBlock">branches</a><span class="delimiter">(</span><a href="#792371" title="Int">i</a><span class="delimiter">)</span><span class="delimiter">)</span>
              <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, label: ch.epfl.lamp.compiler.msil.emit.Label)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Br</span>, <a href="#792372" title="ch.epfl.lamp.compiler.msil.emit.Label">defaultTarget</a><span class="delimiter">)</span>

          <span class="keyword">case</span> JUMP<a href="#792688" title="Unit" id="792742" class="delimiter">(</a>whereto<span class="delimiter">)</span> =&gt;
            <span class="keyword">val</span> <a href="#792526" title="(x: (Boolean, Boolean, Option[ch.epfl.lamp.compiler.msil.emit.Label]))(Boolean, Boolean, Option[ch.epfl.lamp.compiler.msil.emit.Label])" class="delimiter">(</a><a href="../../../../Tuple3.scala.html#61402" title="Boolean" id="792504">leaveHandler</a>, <a href="../../../../Tuple3.scala.html#61404" title="Boolean" id="792505">leaveFinally</a>, <a href="../../../../Tuple3.scala.html#61406" title="Option[ch.epfl.lamp.compiler.msil.emit.Label]" id="792506">lfTarget</a><span class="delimiter">)</span> = <a href="#785628" title="(from: GenMSIL.this.global.icodes.BasicBlock, to: GenMSIL.this.global.icodes.BasicBlock)(Boolean, Boolean, Option[ch.epfl.lamp.compiler.msil.emit.Label])">leavesHandler</a><a href="../../../../Tuple3.scala.html#214" title="(Boolean, Boolean, Option[ch.epfl.lamp.compiler.msil.emit.Label]) @unchecked" class="delimiter">(</a><a href="#789517" title="GenMSIL.this.global.icodes.BasicBlock">block</a>, whereto<span class="delimiter">)</span>
            <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#792504" title="Boolean">leaveHandler</a><span class="delimiter">)</span> <span class="delimiter">{</span>
              <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#792505" title="Boolean">leaveFinally</a><span class="delimiter">)</span> <span class="delimiter">{</span>
                <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#792506" title="Option[ch.epfl.lamp.compiler.msil.emit.Label]">lfTarget</a>.<a href="../../../../Option.scala.html#63812" title="=&gt; Boolean">isDefined</a><span class="delimiter">)</span> <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, label: ch.epfl.lamp.compiler.msil.emit.Label)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Leave</span>, <a href="#792506" title="Option[ch.epfl.lamp.compiler.msil.emit.Label]">lfTarget</a>.<a href="../../../../Option.scala.html#63813" title="=&gt; ch.epfl.lamp.compiler.msil.emit.Label">get</a><span class="delimiter">)</span>
                <span class="keyword">else</span> <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Endfinally</span><span class="delimiter">)</span>
              <span class="delimiter">}</span> <span class="keyword">else</span>
                <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, label: ch.epfl.lamp.compiler.msil.emit.Label)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Leave</span>, <a href="../../../../collection/mutable/HashMap.scala.html#79206" title="(key: GenMSIL.this.global.icodes.BasicBlock)ch.epfl.lamp.compiler.msil.emit.Label">labels</a><span class="delimiter">(</span>whereto<span class="delimiter">)</span><span class="delimiter">)</span>
            <span class="delimiter">}</span> <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#789519" title="GenMSIL.this.global.icodes.BasicBlock">next</a> <span title="(x$1: AnyRef)Boolean">!=</span> whereto<span class="delimiter">)</span>
              <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, label: ch.epfl.lamp.compiler.msil.emit.Label)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Br</span>, <a href="../../../../collection/mutable/HashMap.scala.html#79206" title="(key: GenMSIL.this.global.icodes.BasicBlock)ch.epfl.lamp.compiler.msil.emit.Label">labels</a><span class="delimiter">(</span>whereto<span class="delimiter">)</span><span class="delimiter">)</span>

          <span class="keyword">case</span> CJUMP<a href="#792688" title="Unit" id="792744" class="delimiter">(</a>success, failure, cond, kind<span class="delimiter">)</span> =&gt;
            // cond is TestOp (see Primitives.scala), and can take
            // values EQ, NE, LT, GE LE, GT
            // kind is TypeKind
            <span class="keyword">val</span> <a title="Boolean" id="792594">isFloat</a> = kind <span title="(x$1: AnyRef)Boolean">==</span> <a href="../icode/TypeKinds.scala.html#642731" title="GenMSIL.this.global.icodes.FLOAT.type">FLOAT</a> <a href="../../../../Boolean.scala.html#58724" title="(x: Boolean)Boolean">||</a> kind <span title="(x$1: AnyRef)Boolean">==</span> <a href="../icode/TypeKinds.scala.html#642733" title="GenMSIL.this.global.icodes.DOUBLE.type">DOUBLE</a>
            <span class="keyword">val</span> <a title="(GenMSIL.this.global.icodes.TestOp, ch.epfl.lamp.compiler.msil.emit.Label) =&gt; Unit" id="792595">emit</a> = <span class="delimiter">(</span>c: <a href="../icode/Primitives.scala.html#642803" title="GenMSIL.this.global.icodes.TestOp">TestOp</a>, l: <span title="ch.epfl.lamp.compiler.msil.emit.Label">Label</span><span class="delimiter">)</span> =&gt; <a href="#785630" title="(condition: GenMSIL.this.global.icodes.TestOp, dest: ch.epfl.lamp.compiler.msil.emit.Label, isFloat: Boolean)Unit">emitBr</a><span class="delimiter">(</span><a href="#792605" title="GenMSIL.this.global.icodes.TestOp">c</a>, <a href="#792606" title="ch.epfl.lamp.compiler.msil.emit.Label">l</a>, <a href="#792594" title="Boolean">isFloat</a><span class="delimiter">)</span>
            <a href="#785629" title="(block: GenMSIL.this.global.icodes.BasicBlock, cond: GenMSIL.this.global.icodes.TestOp, success: GenMSIL.this.global.icodes.BasicBlock, failure: GenMSIL.this.global.icodes.BasicBlock, next: GenMSIL.this.global.icodes.BasicBlock, emitBrFun: (GenMSIL.this.global.icodes.TestOp, ch.epfl.lamp.compiler.msil.emit.Label) =&gt; Unit)Unit">emitCondBr</a><span class="delimiter">(</span><a href="#789517" title="GenMSIL.this.global.icodes.BasicBlock">block</a>, cond, success, failure, <a href="#789519" title="GenMSIL.this.global.icodes.BasicBlock">next</a>, <a href="#792595" title="(GenMSIL.this.global.icodes.TestOp, ch.epfl.lamp.compiler.msil.emit.Label) =&gt; Unit">emit</a><span class="delimiter">)</span>

          <span class="keyword">case</span> CZJUMP<a href="#792688" title="Unit" id="792746" class="delimiter">(</a>success, failure, cond, kind<span class="delimiter">)</span> =&gt;
            <a href="#785629" title="(block: GenMSIL.this.global.icodes.BasicBlock, cond: GenMSIL.this.global.icodes.TestOp, success: GenMSIL.this.global.icodes.BasicBlock, failure: GenMSIL.this.global.icodes.BasicBlock, next: GenMSIL.this.global.icodes.BasicBlock, emitBrFun: (GenMSIL.this.global.icodes.TestOp, ch.epfl.lamp.compiler.msil.emit.Label) =&gt; Unit)Unit">emitCondBr</a><a href="#792769" title="(x: Unit)Unit" class="delimiter">(</a><a href="#789517" title="GenMSIL.this.global.icodes.BasicBlock">block</a>, cond, success, failure, <a href="#789519" title="GenMSIL.this.global.icodes.BasicBlock">next</a>, <a href="#785631" title="(cond: GenMSIL.this.global.icodes.TestOp, dest: ch.epfl.lamp.compiler.msil.emit.Label)Unit">emitBrBool</a><span class="delimiter">(</span><a href="#792625" title="GenMSIL.this.global.icodes.TestOp">_</a>, <a href="#792626" title="ch.epfl.lamp.compiler.msil.emit.Label">_</a><span class="delimiter">)</span><span class="delimiter">)</span>

          <span class="keyword">case</span> RETURN<a href="#792688" title="Unit" id="792748" class="delimiter">(</a>kind<span class="delimiter">)</span> =&gt;
            <a href="#792769" title="(x: Unit)Unit" class="keyword">if</a> <span class="delimiter">(</span><a href="#785605" title="=&gt; scala.collection.mutable.Stack[GenMSIL.this.global.icodes.ExceptionHandler]">currentHandlers</a>.<a href="../../../../collection/mutable/Stack.scala.html#307328" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span>
              <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ret</span><span class="delimiter">)</span>
            <span class="keyword">else</span> <span class="delimiter">{</span>
              <span class="keyword">val</span> <a href="#792649" title="(x: (ch.epfl.lamp.compiler.msil.emit.LocalBuilder, ch.epfl.lamp.compiler.msil.emit.Label))(ch.epfl.lamp.compiler.msil.emit.LocalBuilder, ch.epfl.lamp.compiler.msil.emit.Label)" class="delimiter">(</a><a href="../../../../Tuple2.scala.html#61506" title="ch.epfl.lamp.compiler.msil.emit.LocalBuilder" id="792635">local</a>, <a href="../../../../Tuple2.scala.html#61508" title="ch.epfl.lamp.compiler.msil.emit.Label" id="792636">label</a><span class="delimiter">)</span> = <a href="#785619" title="(kind: GenMSIL.this.global.icodes.TypeKind)(ch.epfl.lamp.compiler.msil.emit.LocalBuilder, ch.epfl.lamp.compiler.msil.emit.Label)">returnFromHandler</a><a href="../../../../Tuple2.scala.html#1222" title="(ch.epfl.lamp.compiler.msil.emit.LocalBuilder, ch.epfl.lamp.compiler.msil.emit.Label) @unchecked" class="delimiter">(</a>kind<span class="delimiter">)</span>
              <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span>kind <span title="(x$1: AnyRef)Boolean">!=</span> <a href="../icode/TypeKinds.scala.html#642717" title="GenMSIL.this.global.icodes.UNIT.type">UNIT</a><span class="delimiter">)</span>
                <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.emit.LocalBuilder)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Stloc</span>, <a href="#792635" title="ch.epfl.lamp.compiler.msil.emit.LocalBuilder">local</a><span class="delimiter">)</span>
              <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, label: ch.epfl.lamp.compiler.msil.emit.Label)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Leave</span>, <a href="#792636" title="ch.epfl.lamp.compiler.msil.emit.Label">label</a><span class="delimiter">)</span>
            <span class="delimiter">}</span>

          <span class="keyword">case</span> THROW<a href="#792688" title="Unit" id="792751" class="delimiter">(</a>_<span class="delimiter">)</span> =&gt;
            <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#792769" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Throw</span><span class="delimiter">)</span>

          <span class="keyword">case</span> DROP<a href="#792688" title="Unit" id="792753" class="delimiter">(</a>kind<span class="delimiter">)</span> =&gt;
            <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#792769" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Pop</span><span class="delimiter">)</span>

          <span class="keyword">case</span> DUP<a href="#792688" title="Unit" id="792755" class="delimiter">(</a>kind<span class="delimiter">)</span> =&gt;
            // see comment on `var previousWasNEW`
            <a href="#792769" title="(x: Unit)Unit" class="keyword">if</a> <span class="delimiter">(</span><a href="../../../../Boolean.scala.html#58721" title="=&gt; Boolean">!</a><a href="#790117" title="Boolean">previousWasNEW</a><span class="delimiter">)</span>
              <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Dup</span><span class="delimiter">)</span>
            <span class="keyword">else</span>
              <a href="#790117" title="Boolean">previousWasNEW</a> = <span title="Boolean(false)" class="keyword">false</span>

          <span class="keyword">case</span> MONITOR_ENTER<a href="#792688" title="Unit" id="792757" class="delimiter">(</a><span class="delimiter">)</span> =&gt;
            <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><a href="#792769" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Call</span>, <a href="#785501" title="=&gt; ch.epfl.lamp.compiler.msil.MethodInfo">MMONITOR_ENTER</a><span class="delimiter">)</span>

          <span class="keyword">case</span> MONITOR_EXIT<a href="#792688" title="Unit" id="792759" class="delimiter">(</a><span class="delimiter">)</span> =&gt;
            <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><a href="#792769" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Call</span>, <a href="#785503" title="=&gt; ch.epfl.lamp.compiler.msil.MethodInfo">MMONITOR_EXIT</a><span class="delimiter">)</span>

          <span class="keyword">case</span> SCOPE_ENTER<a href="#792688" title="Unit" id="792762" class="delimiter">(</a>_<span class="delimiter">)</span> | SCOPE_EXIT<a href="#792688" title="Boolean" id="792765" class="delimiter">(</a>_<span class="delimiter">)</span> | LOAD_EXCEPTION<a href="#792688" title="Boolean" id="792768" class="delimiter">(</a>_<span class="delimiter">)</span> =&gt;
            <a href="#792769" title="(x: Unit)Unit" class="delimiter">(</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>

      <span class="delimiter">}</span> // end for (instr &lt;- b) { .. }
    <span class="delimiter">}</span> // end genBlock

    <span class="keyword">def</span> <a title="(primitive: GenMSIL.this.global.icodes.Primitive, pos: GenMSIL.this.global.Position)Unit" id="785624">genPrimitive</a><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.Primitive" id="791060">primitive</a>: <a href="../icode/Primitives.scala.html#642763" title="GenMSIL.this.global.icodes.Primitive">Primitive</a>, <a title="GenMSIL.this.global.Position" id="791061">pos</a>: <a href="../../util/Position.scala.html#52230" title="GenMSIL.this.global.Position">Position</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#791060" title="GenMSIL.this.global.icodes.Primitive">primitive</a> <span class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> Negation<a href="#793152" title="Unit" id="793154" class="delimiter">(</a>kind<span class="delimiter">)</span> =&gt;
          <a href="#793172" title="(x: Unit)Unit">kind</a> <span class="keyword">match</span> <span class="delimiter">{</span>
            // CHECK: is ist possible to get this for BOOL? in this case, verify.
            <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#642719" title="Unit" id="792830">BOOL</a> | <a href="../icode/TypeKinds.scala.html#642721" title="Boolean" id="792831">BYTE</a> | <a href="../icode/TypeKinds.scala.html#642725" title="Boolean" id="792832">CHAR</a> | <a href="../icode/TypeKinds.scala.html#642723" title="Boolean" id="792833">SHORT</a> | <a href="../icode/TypeKinds.scala.html#642727" title="Boolean" id="792834">INT</a> | <a href="../icode/TypeKinds.scala.html#642729" title="Boolean" id="792835">LONG</a> | <a href="../icode/TypeKinds.scala.html#642731" title="Boolean" id="792836">FLOAT</a> | <a href="../icode/TypeKinds.scala.html#642733" title="Boolean" id="792837">DOUBLE</a> =&gt;
              <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#792838" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Neg</span><span class="delimiter">)</span>

            <span class="keyword">case</span> _ =&gt; <a href="../../Global.scala.html#559537" title="(msg: String)Nothing">abort</a><a href="#792838" title="(x: Unit)Unit" class="delimiter">(</a><span title="String(&quot;Impossible to negate a &quot;)" class="string">&quot;Impossible to negate a &quot;</span> <span title="(x$1: Any)String">+</span> kind<span class="delimiter">)</span>
          <span class="delimiter">}</span>

        <span class="keyword">case</span> Arithmetic<a href="#793152" title="Unit" id="793156" class="delimiter">(</a>op, kind<span class="delimiter">)</span> =&gt;
          <a href="#793172" title="(x: Unit)Unit">op</a> <span class="keyword">match</span> <span class="delimiter">{</span>
            <span class="keyword">case</span> <a href="../icode/Primitives.scala.html#642817" title="Unit" id="792904">ADD</a> =&gt; <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#792910" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Add</span><span class="delimiter">)</span>
            <span class="keyword">case</span> <a href="../icode/Primitives.scala.html#642819" title="Unit" id="792905">SUB</a> =&gt; <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#792910" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Sub</span><span class="delimiter">)</span>
            <span class="keyword">case</span> <a href="../icode/Primitives.scala.html#642821" title="Unit" id="792906">MUL</a> =&gt; <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#792910" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Mul</span><span class="delimiter">)</span>
            <span class="keyword">case</span> <a href="../icode/Primitives.scala.html#642823" title="Unit" id="792907">DIV</a> =&gt; <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#792910" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Div</span><span class="delimiter">)</span>
            <span class="keyword">case</span> <a href="../icode/Primitives.scala.html#642825" title="Unit" id="792908">REM</a> =&gt; <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#792910" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Rem</span><span class="delimiter">)</span>
            <span class="keyword">case</span> <a href="../icode/Primitives.scala.html#642827" title="Unit" id="792909">NOT</a> =&gt; <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#792910" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Not</span><span class="delimiter">)</span> //bitwise complement (one's complement)
            <span class="keyword">case</span> _ =&gt; <a href="../../Global.scala.html#559537" title="(msg: String)Nothing">abort</a><a href="#792910" title="(x: Unit)Unit" class="delimiter">(</a><span title="String(&quot;Unknown arithmetic primitive &quot;)" class="string">&quot;Unknown arithmetic primitive &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#791060" title="GenMSIL.this.global.icodes.Primitive">primitive</a> <span class="delimiter">)</span>
          <span class="delimiter">}</span>

        <span class="keyword">case</span> Logical<a href="#793152" title="Unit" id="793158" class="delimiter">(</a>op, kind<span class="delimiter">)</span> =&gt; <a href="#793172" title="(x: Unit)Unit">op</a> <span class="keyword">match</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> <a href="../icode/Primitives.scala.html#642837" title="Unit" id="792953">AND</a> =&gt; <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#792956" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">And</span><span class="delimiter">)</span>
          <span class="keyword">case</span> <a href="../icode/Primitives.scala.html#642839" title="Unit" id="792954">OR</a> =&gt; <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#792956" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Or</span><span class="delimiter">)</span>
          <span class="keyword">case</span> <a href="../icode/Primitives.scala.html#642841" title="Unit" id="792955">XOR</a> =&gt; <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#792956" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Xor</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>

        <span class="keyword">case</span> Shift<a href="#793152" title="Unit" id="793160" class="delimiter">(</a>op, kind<span class="delimiter">)</span> =&gt; <a href="#793172" title="(x: Unit)Unit">op</a> <span class="keyword">match</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> <a href="../icode/Primitives.scala.html#642830" title="Unit" id="792986">LSL</a> =&gt; <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#792989" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Shl</span><span class="delimiter">)</span>
          <span class="keyword">case</span> <a href="../icode/Primitives.scala.html#642832" title="Unit" id="792987">ASR</a> =&gt; <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#792989" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Shr</span><span class="delimiter">)</span>
          <span class="keyword">case</span> <a href="../icode/Primitives.scala.html#642834" title="Unit" id="792988">LSR</a> =&gt; <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#792989" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Shr_Un</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>

        <span class="keyword">case</span> Conversion<a href="#793152" title="Unit" id="793162" class="delimiter">(</a>src, dst<span class="delimiter">)</span> =&gt;
          <a href="../../Global.scala.html#559553" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><span title="String(&quot;Converting from: &quot;)" class="string">&quot;Converting from: &quot;</span> <span title="(x$1: Any)String">+</span> src <span title="(x$1: Any)String">+</span> <span title="String(&quot; to: &quot;)" class="string">&quot; to: &quot;</span> <span title="(x$1: Any)String">+</span> dst<span class="delimiter">)</span>

          <span title="Unit">dst</span> <span class="keyword">match</span> <span class="delimiter">{</span>
            <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#642721" title="Unit" id="793033">BYTE</a> =&gt;   <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#793040" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Conv_I1</span><span class="delimiter">)</span> // I1 for System.SByte, i.e. a scala.Byte
            <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#642723" title="Unit" id="793034">SHORT</a> =&gt;  <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#793040" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Conv_I2</span><span class="delimiter">)</span>
            <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#642725" title="Unit" id="793035">CHAR</a> =&gt;   <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#793040" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Conv_U2</span><span class="delimiter">)</span>
            <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#642727" title="Unit" id="793036">INT</a> =&gt;    <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#793040" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Conv_I4</span><span class="delimiter">)</span>
            <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#642729" title="Unit" id="793037">LONG</a> =&gt;   <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#793040" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Conv_I8</span><span class="delimiter">)</span>
            <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#642731" title="Unit" id="793038">FLOAT</a> =&gt;  <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#793040" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Conv_R4</span><span class="delimiter">)</span>
            <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#642733" title="Unit" id="793039">DOUBLE</a> =&gt; <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#793040" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Conv_R8</span><span class="delimiter">)</span>
            <span class="keyword">case</span> _ =&gt;
              <a href="../../../../Console.scala.html#227" title="Console.type">Console</a>.<a href="../../../../Console.scala.html#64301" title="(x: Any)Unit">println</a><a href="#793040" title="(x: Unit)Unit" class="delimiter">(</a><span title="String(&quot;Illegal conversion at: &quot;)" class="string">&quot;Illegal conversion at: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#785551" title="=&gt; GenMSIL.this.global.icodes.IClass">clasz</a> <span title="(x$1: Any)String">+</span>
                              <span title="String(&quot; at: &quot;)" class="string">&quot; at: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#791061" title="GenMSIL.this.global.Position">pos</a>.<a href="../../util/Position.scala.html#445352" title="=&gt; scala.tools.nsc.util.SourceFile">source</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;:&quot;)" class="string">&quot;:&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#791061" title="GenMSIL.this.global.Position">pos</a>.<a href="../../util/Position.scala.html#445379" title="=&gt; Int">line</a><span class="delimiter">)</span>
          <span class="delimiter">}</span>

        <span class="keyword">case</span> ArrayLength<a href="#793152" title="Unit" id="793165" class="delimiter">(</a>_<span class="delimiter">)</span> =&gt;
          <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#793172" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldlen</span><span class="delimiter">)</span>

        <span class="keyword">case</span> <a href="../icode/Primitives.scala.html#642791" title="Unit" id="793170">StartConcat</a> =&gt;
          <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.ConstructorInfo)Unit">Emit</span><a href="#793172" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Newobj</span>, <a href="#785507" title="=&gt; ch.epfl.lamp.compiler.msil.ConstructorInfo">MSTRING_BUILDER_CONSTR</a><span class="delimiter">)</span>


        <span class="keyword">case</span> StringConcat<a href="#793152" title="Unit" id="793168" class="delimiter">(</a>el<span class="delimiter">)</span> =&gt;
          <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.Type" id="793081">elemType</a> : <span title="ch.epfl.lamp.compiler.msil.Type">MsilType</span> = <span title="ch.epfl.lamp.compiler.msil.Type">el</span> <span class="keyword">match</span> <span class="delimiter">{</span>
            <span class="keyword">case</span> REFERENCE<a href="#793093" title="ch.epfl.lamp.compiler.msil.Type" id="793096" class="delimiter">(</a>_<span class="delimiter">)</span> | ARRAY<a href="#793093" title="Boolean" id="793099" class="delimiter">(</a>_<span class="delimiter">)</span> =&gt; <a href="#793100" title="(x: ch.epfl.lamp.compiler.msil.Type)ch.epfl.lamp.compiler.msil.Type">MOBJECT</a>
            <span class="keyword">case</span> _ =&gt; <a href="#785645" title="(t: GenMSIL.this.global.icodes.TypeKind)ch.epfl.lamp.compiler.msil.Type">msilType</a><a href="#793100" title="(x: ch.epfl.lamp.compiler.msil.Type)ch.epfl.lamp.compiler.msil.Type" class="delimiter">(</a>el<span class="delimiter">)</span>
          <span class="delimiter">}</span>

          <span class="keyword">val</span> <a title="Array[ch.epfl.lamp.compiler.msil.Type]" id="793082">argTypes</a>:<a href="../../../../Array.scala.html#292" title="Array[ch.epfl.lamp.compiler.msil.Type]">Array</a><span class="delimiter">[</span>MsilType<span class="delimiter">]</span> = <a href="../../../../Array.scala.html#68728" title="(xs: ch.epfl.lamp.compiler.msil.Type*)(implicit evidence$2: scala.reflect.ArrayTag[ch.epfl.lamp.compiler.msil.Type])Array[ch.epfl.lamp.compiler.msil.Type]">Array</a><a href="../../../../reflect/ClassTag.scala.html#61898" title="(erasure1: Class[_])scala.reflect.ClassTag[ch.epfl.lamp.compiler.msil.Type]" class="delimiter">(</a><a href="#793081" title="ch.epfl.lamp.compiler.msil.Type">elemType</a><span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.MethodInfo" id="793083">stringBuilderAppend</a> = <a href="#785505" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MSTRING_BUILDER</a>.<span title="(x$1: String, x$2: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.MethodInfo">GetMethod</span><span class="delimiter">(</span><span title="String(&quot;Append&quot;)" class="string">&quot;Append&quot;</span>, <a href="#793082" title="Array[ch.epfl.lamp.compiler.msil.Type]">argTypes</a> <span class="delimiter">)</span>
          <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Callvirt</span>,  <a href="#793083" title="ch.epfl.lamp.compiler.msil.MethodInfo">stringBuilderAppend</a><span class="delimiter">)</span>

        <span class="keyword">case</span> <a href="../icode/Primitives.scala.html#642793" title="Unit" id="793171">EndConcat</a> =&gt;
          <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><a href="#793172" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Callvirt</span>, <a href="#785509" title="=&gt; ch.epfl.lamp.compiler.msil.MethodInfo">MSTRING_BUILDER_TOSTRING</a><span class="delimiter">)</span>

        <span class="keyword">case</span> _ =&gt;
          <a href="../../Global.scala.html#559537" title="(msg: String)Nothing">abort</a><a href="#793172" title="(x: Unit)Unit" class="delimiter">(</a><span title="String(&quot;Unimplemented primitive &quot;)" class="string">&quot;Unimplemented primitive &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#791060" title="GenMSIL.this.global.icodes.Primitive">primitive</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span> // end genPrimitive


    ////////////////////// loading ///////////////////////

    <span class="keyword">def</span> <a title="(value: Int, code: ch.epfl.lamp.compiler.msil.emit.ILGenerator)Unit" id="785625">loadI4</a><span class="delimiter">(</span><a title="Int" id="790399">value</a>: <a href="../../../../Int.scala.html#508" title="Int">Int</a>, <a title="ch.epfl.lamp.compiler.msil.emit.ILGenerator" id="790400">code</a>: <span title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">ILGenerator</span><span class="delimiter">)</span>: <a href="../../../../Unit.scala.html#2389" title="Unit">Unit</a> = <a href="#790399" title="Int">value</a> <span class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> -<span class="int">1</span> =&gt; <a href="#790400" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldc_I4_M1</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <span class="int">0</span>  =&gt; <a href="#790400" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldc_I4_0</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <span class="int">1</span>  =&gt; <a href="#790400" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldc_I4_1</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <span class="int">2</span>  =&gt; <a href="#790400" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldc_I4_2</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <span class="int">3</span>  =&gt; <a href="#790400" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldc_I4_3</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <span class="int">4</span>  =&gt; <a href="#790400" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldc_I4_4</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <span class="int">5</span>  =&gt; <a href="#790400" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldc_I4_5</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <span class="int">6</span>  =&gt; <a href="#790400" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldc_I4_6</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <span class="int">7</span>  =&gt; <a href="#790400" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldc_I4_7</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <span class="int">8</span>  =&gt; <a href="#790400" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldc_I4_8</span><span class="delimiter">)</span>
      <span class="keyword">case</span> _  =&gt;
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#790399" title="Int">value</a> <a href="../../../../Int.scala.html#57926" title="(x: Int)Boolean">&gt;=</a> -<span title="Int(-128)" class="int">128</span> <a href="../../../../Boolean.scala.html#58725" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#790399" title="Int">value</a> <a href="../../../../Int.scala.html#57912" title="(x: Int)Boolean">&lt;=</a> <span title="Int(127)" class="int">127</span><span class="delimiter">)</span>
          <a href="#790400" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: Int)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldc_I4_S</span>, <a href="#790399" title="Int">value</a><span class="delimiter">)</span>
        <span class="keyword">else</span>
          <a href="#790400" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: Int)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldc_I4</span>, <a href="#790399" title="Int">value</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="(code: ch.epfl.lamp.compiler.msil.emit.ILGenerator, loadAddr: Boolean)(i: Int)Unit" id="785626">loadArg</a><span class="delimiter">(</span><a title="ch.epfl.lamp.compiler.msil.emit.ILGenerator" id="790125">code</a>: <span title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">ILGenerator</span>, <a title="Boolean" id="790126">loadAddr</a>: <a href="../../../../Boolean.scala.html#2218" title="Boolean">Boolean</a><span class="delimiter">)</span><span class="delimiter">(</span><a title="Int" id="790127">i</a>: <a href="../../../../Int.scala.html#508" title="Int">Int</a><span class="delimiter">)</span> =
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#790126" title="Boolean">loadAddr</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#790127" title="Int">i</a> <a href="../../../../Int.scala.html#57926" title="(x: Int)Boolean">&gt;=</a> -<span title="Int(-128)" class="int">128</span> <a href="../../../../Boolean.scala.html#58725" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#790127" title="Int">i</a> <a href="../../../../Int.scala.html#57912" title="(x: Int)Boolean">&lt;=</a> <span title="Int(127)" class="int">127</span><span class="delimiter">)</span>
          <a href="#790125" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: Int)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldarga_S</span>, <a href="#790127" title="Int">i</a><span class="delimiter">)</span>
        <span class="keyword">else</span>
          <a href="#790125" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: Int)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldarga</span>, <a href="#790127" title="Int">i</a><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
        <a href="#790127" title="Int">i</a> <span class="keyword">match</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> <span class="int">0</span> =&gt; <a href="#790125" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldarg_0</span><span class="delimiter">)</span>
          <span class="keyword">case</span> <span class="int">1</span> =&gt; <a href="#790125" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldarg_1</span><span class="delimiter">)</span>
          <span class="keyword">case</span> <span class="int">2</span> =&gt; <a href="#790125" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldarg_2</span><span class="delimiter">)</span>
          <span class="keyword">case</span> <span class="int">3</span> =&gt; <a href="#790125" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldarg_3</span><span class="delimiter">)</span>
          <span class="keyword">case</span> _      =&gt;
            <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#790127" title="Int">i</a> <a href="../../../../Int.scala.html#57926" title="(x: Int)Boolean">&gt;=</a> -<span title="Int(-128)" class="int">128</span> <a href="../../../../Boolean.scala.html#58725" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#790127" title="Int">i</a> <a href="../../../../Int.scala.html#57912" title="(x: Int)Boolean">&lt;=</a> <span title="Int(127)" class="int">127</span><span class="delimiter">)</span>
              <a href="#790125" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: Int)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldarg_S</span>, <a href="#790127" title="Int">i</a><span class="delimiter">)</span>
            <span class="keyword">else</span>
              <a href="#790125" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: Int)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldarg</span>, <a href="#790127" title="Int">i</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="(i: Int, local: GenMSIL.this.global.icodes.Local, code: ch.epfl.lamp.compiler.msil.emit.ILGenerator, loadAddr: Boolean)Unit" id="785627">loadLocal</a><span class="delimiter">(</span><a title="Int" id="790182">i</a>: <a href="../../../../Int.scala.html#508" title="Int">Int</a>, <a title="GenMSIL.this.global.icodes.Local" id="790183">local</a>: <a href="../icode/Members.scala.html#642681" title="GenMSIL.this.global.icodes.Local">Local</a>, <a title="ch.epfl.lamp.compiler.msil.emit.ILGenerator" id="790184">code</a>: <span title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">ILGenerator</span>, <a title="Boolean" id="790185">loadAddr</a>: <a href="../../../../Boolean.scala.html#2218" title="Boolean">Boolean</a><span class="delimiter">)</span> =
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#790185" title="Boolean">loadAddr</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#790182" title="Int">i</a> <a href="../../../../Int.scala.html#57926" title="(x: Int)Boolean">&gt;=</a> -<span title="Int(-128)" class="int">128</span> <a href="../../../../Boolean.scala.html#58725" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#790182" title="Int">i</a> <a href="../../../../Int.scala.html#57912" title="(x: Int)Boolean">&lt;=</a> <span title="Int(127)" class="int">127</span><span class="delimiter">)</span>
          <a href="#790184" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.emit.LocalBuilder)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldloca_S</span>, <a href="../../../../collection/mutable/HashMap.scala.html#79206" title="(key: GenMSIL.this.global.icodes.Local)ch.epfl.lamp.compiler.msil.emit.LocalBuilder">localBuilders</a><span class="delimiter">(</span><a href="#790183" title="GenMSIL.this.global.icodes.Local">local</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="keyword">else</span>
          <a href="#790184" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.emit.LocalBuilder)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldloca</span>, <a href="../../../../collection/mutable/HashMap.scala.html#79206" title="(key: GenMSIL.this.global.icodes.Local)ch.epfl.lamp.compiler.msil.emit.LocalBuilder">localBuilders</a><span class="delimiter">(</span><a href="#790183" title="GenMSIL.this.global.icodes.Local">local</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
        <a href="#790182" title="Int">i</a> <span class="keyword">match</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> <span class="int">0</span> =&gt; <a href="#790184" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldloc_0</span><span class="delimiter">)</span>
          <span class="keyword">case</span> <span class="int">1</span> =&gt; <a href="#790184" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldloc_1</span><span class="delimiter">)</span>
          <span class="keyword">case</span> <span class="int">2</span> =&gt; <a href="#790184" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldloc_2</span><span class="delimiter">)</span>
          <span class="keyword">case</span> <span class="int">3</span> =&gt; <a href="#790184" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldloc_3</span><span class="delimiter">)</span>
          <span class="keyword">case</span> _      =&gt;
            <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#790182" title="Int">i</a> <a href="../../../../Int.scala.html#57926" title="(x: Int)Boolean">&gt;=</a> -<span title="Int(-128)" class="int">128</span> <a href="../../../../Boolean.scala.html#58725" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#790182" title="Int">i</a> <a href="../../../../Int.scala.html#57912" title="(x: Int)Boolean">&lt;=</a> <span title="Int(127)" class="int">127</span><span class="delimiter">)</span>
              <a href="#790184" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.emit.LocalBuilder)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldloc_S</span>, <a href="../../../../collection/mutable/HashMap.scala.html#79206" title="(key: GenMSIL.this.global.icodes.Local)ch.epfl.lamp.compiler.msil.emit.LocalBuilder">localBuilders</a><span class="delimiter">(</span><a href="#790183" title="GenMSIL.this.global.icodes.Local">local</a><span class="delimiter">)</span><span class="delimiter">)</span>
            <span class="keyword">else</span>
              <a href="#790184" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.emit.LocalBuilder)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldloc</span>, <a href="../../../../collection/mutable/HashMap.scala.html#79206" title="(key: GenMSIL.this.global.icodes.Local)ch.epfl.lamp.compiler.msil.emit.LocalBuilder">localBuilders</a><span class="delimiter">(</span><a href="#790183" title="GenMSIL.this.global.icodes.Local">local</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>

    ////////////////////// branches ///////////////////////

    /** Returns a Triple (Boolean, Boolean, Option[Label])
     *   - whether the jump leaves some exception block (try / catch / finally)
     *   - whether it leaves a finally handler (finally block, but not it's try / catch)
     *   - a label where to jump for leaving the finally handler
     *     . None to leave directly using `endfinally`
     *     . Some(label) to emit `leave label` (for try / catch inside a finally handler)
     */
    <span class="keyword">def</span> <a title="(from: GenMSIL.this.global.icodes.BasicBlock, to: GenMSIL.this.global.icodes.BasicBlock)(Boolean, Boolean, Option[ch.epfl.lamp.compiler.msil.emit.Label])" id="785628">leavesHandler</a><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.BasicBlock" id="792507">from</a>: <a href="../icode/BasicBlocks.scala.html#642689" title="GenMSIL.this.global.icodes.BasicBlock">BasicBlock</a>, <a title="GenMSIL.this.global.icodes.BasicBlock" id="792508">to</a>: <a href="../icode/BasicBlocks.scala.html#642689" title="GenMSIL.this.global.icodes.BasicBlock">BasicBlock</a><span class="delimiter">)</span>: <a href="../../../../Tuple3.scala.html#214" title="(Boolean, Boolean, Option[ch.epfl.lamp.compiler.msil.emit.Label])" class="delimiter">(</a>Boolean, Boolean, Option<span class="delimiter">[</span>Label<span class="delimiter">]</span><span class="delimiter">)</span> =
      <span title="(Boolean, Boolean, Option[ch.epfl.lamp.compiler.msil.emit.Label])" class="keyword">if</span> <span class="delimiter">(</span><a href="#785605" title="=&gt; scala.collection.mutable.Stack[GenMSIL.this.global.icodes.ExceptionHandler]">currentHandlers</a>.<a href="../../../../collection/mutable/Stack.scala.html#307328" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <a href="../../../../Tuple3.scala.html#64156" title="(_1: Boolean, _2: Boolean, _3: None.type)(Boolean, Boolean, None.type)" class="delimiter">(</a><span title="Boolean(false)" class="keyword">false</span>, <span title="Boolean(false)" class="keyword">false</span>, <a href="../../../../Option.scala.html#2498" title="None.type">None</a><span class="delimiter">)</span>
      <span class="keyword">else</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="GenMSIL.this.global.icodes.ExceptionHandler" id="793269">h</a> = <a href="#785605" title="=&gt; scala.collection.mutable.Stack[GenMSIL.this.global.icodes.ExceptionHandler]">currentHandlers</a>.<a href="../../../../collection/IterableLike.scala.html#59473" title="=&gt; GenMSIL.this.global.icodes.ExceptionHandler">head</a>
        <span class="keyword">val</span> <a title="Boolean" id="793270">leaveHead</a> = <span class="delimiter">{</span> <a href="#793269" title="GenMSIL.this.global.icodes.ExceptionHandler">h</a>.<a href="../icode/ExceptionHandlers.scala.html#734076" title="(b: GenMSIL.this.global.icodes.BasicBlock)Boolean">covers</a><span class="delimiter">(</span><a href="#792507" title="GenMSIL.this.global.icodes.BasicBlock">from</a><span class="delimiter">)</span> <a href="../../../../Boolean.scala.html#58723" title="(x: Boolean)Boolean">!=</a> <a href="#793269" title="GenMSIL.this.global.icodes.ExceptionHandler">h</a>.<a href="../icode/ExceptionHandlers.scala.html#734076" title="(b: GenMSIL.this.global.icodes.BasicBlock)Boolean">covers</a><span class="delimiter">(</span><a href="#792508" title="GenMSIL.this.global.icodes.BasicBlock">to</a><span class="delimiter">)</span> <a href="../../../../Boolean.scala.html#58724" title="(x: Boolean)Boolean">||</a>
                          <a href="#793269" title="GenMSIL.this.global.icodes.ExceptionHandler">h</a>.<a href="../icode/ExceptionHandlers.scala.html#734077" title="=&gt; List[GenMSIL.this.global.icodes.BasicBlock]">blocks</a>.<a href="../../../../collection/SeqLike.scala.html#59768" title="(elem: Any)Boolean">contains</a><span class="delimiter">(</span><a href="#792507" title="GenMSIL.this.global.icodes.BasicBlock">from</a><span class="delimiter">)</span> <a href="../../../../Boolean.scala.html#58723" title="(x: Boolean)Boolean">!=</a> <a href="#793269" title="GenMSIL.this.global.icodes.ExceptionHandler">h</a>.<a href="../icode/ExceptionHandlers.scala.html#734077" title="=&gt; List[GenMSIL.this.global.icodes.BasicBlock]">blocks</a>.<a href="../../../../collection/SeqLike.scala.html#59768" title="(elem: Any)Boolean">contains</a><span class="delimiter">(</span><a href="#792508" title="GenMSIL.this.global.icodes.BasicBlock">to</a><span class="delimiter">)</span> <span class="delimiter">}</span>
        <span title="(Boolean, Boolean, Option[ch.epfl.lamp.compiler.msil.emit.Label])" class="keyword">if</span> <span class="delimiter">(</span><a href="#793270" title="Boolean">leaveHead</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          // we leave the innermost exception block.
          // find out if we also leave som e `finally` handler
          <a href="#785605" title="=&gt; scala.collection.mutable.Stack[GenMSIL.this.global.icodes.ExceptionHandler]">currentHandlers</a>.<a href="../../../../collection/IterableLike.scala.html#59463" title="(p: GenMSIL.this.global.icodes.ExceptionHandler =&gt; Boolean)Option[GenMSIL.this.global.icodes.ExceptionHandler]">find</a><a href="../../../../Option.scala.html#64115" title="=&gt; GenMSIL.this.global.icodes.ExceptionHandler" class="delimiter">(</a><a title="GenMSIL.this.global.icodes.ExceptionHandler" id="793290">e</a> =&gt; <span class="delimiter">{</span>
            <a href="#793290" title="GenMSIL.this.global.icodes.ExceptionHandler">e</a>.<a href="../icode/ExceptionHandlers.scala.html#734055" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">cls</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../../../reflect/internal/Symbols.scala.html#441152" title="=&gt; GenMSIL.this.global.NoSymbol">NoSymbol</a> <a href="../../../../Boolean.scala.html#58725" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#793290" title="GenMSIL.this.global.icodes.ExceptionHandler">e</a>.<a href="../icode/ExceptionHandlers.scala.html#734077" title="=&gt; List[GenMSIL.this.global.icodes.BasicBlock]">blocks</a>.<a href="../../../../collection/SeqLike.scala.html#59768" title="(elem: Any)Boolean">contains</a><span class="delimiter">(</span><a href="#792507" title="GenMSIL.this.global.icodes.BasicBlock">from</a><span class="delimiter">)</span> <a href="../../../../Boolean.scala.html#58723" title="(x: Boolean)Boolean">!=</a> <a href="#793290" title="GenMSIL.this.global.icodes.ExceptionHandler">e</a>.<a href="../icode/ExceptionHandlers.scala.html#734077" title="=&gt; List[GenMSIL.this.global.icodes.BasicBlock]">blocks</a>.<a href="../../../../collection/SeqLike.scala.html#59768" title="(elem: Any)Boolean">contains</a><span class="delimiter">(</span><a href="#792508" title="GenMSIL.this.global.icodes.BasicBlock">to</a><span class="delimiter">)</span>
          <span class="delimiter">}</span><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
            <span class="keyword">case</span> Some<a href="#793340" title="(Boolean, Boolean, Option[ch.epfl.lamp.compiler.msil.emit.Label])" id="793341" class="delimiter">(</a>finallyHandler<span class="delimiter">)</span> =&gt;
              <a href="#793344" title="(x: (Boolean, Boolean, Option[ch.epfl.lamp.compiler.msil.emit.Label]))(Boolean, Boolean, Option[ch.epfl.lamp.compiler.msil.emit.Label])" class="keyword">if</a> <span class="delimiter">(</span><a href="#793269" title="GenMSIL.this.global.icodes.ExceptionHandler">h</a> <span title="(x$1: AnyRef)Boolean">==</span> finallyHandler<span class="delimiter">)</span> <span class="delimiter">{</span>
                // the finally handler is the innermost, so we can emit `endfinally` directly
                <a href="../../../../Tuple3.scala.html#64156" title="(_1: Boolean, _2: Boolean, _3: None.type)(Boolean, Boolean, None.type)" class="delimiter">(</a><span title="Boolean(true)" class="keyword">true</span>, <span title="Boolean(true)" class="keyword">true</span>, <a href="../../../../Option.scala.html#2498" title="None.type">None</a><span class="delimiter">)</span>
              <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
                // we need to `Leave` to the `endfinally` of the next outer finally handler
                <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.Label" id="793315">l</a> = <a href="#785620" title="=&gt; scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.ExceptionHandler,ch.epfl.lamp.compiler.msil.emit.Label]">endFinallyLabels</a>.<a href="../../../../collection/mutable/MapLike.scala.html#78517" title="(key: GenMSIL.this.global.icodes.ExceptionHandler, op: =&gt; ch.epfl.lamp.compiler.msil.emit.Label)ch.epfl.lamp.compiler.msil.emit.Label">getOrElseUpdate</a><span class="delimiter">(</span>finallyHandler, <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="()ch.epfl.lamp.compiler.msil.emit.Label">DefineLabel</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
                <a href="../../../../Tuple3.scala.html#64156" title="(_1: Boolean, _2: Boolean, _3: Some[ch.epfl.lamp.compiler.msil.emit.Label])(Boolean, Boolean, Some[ch.epfl.lamp.compiler.msil.emit.Label])" class="delimiter">(</a><span title="Boolean(true)" class="keyword">true</span>, <span title="Boolean(true)" class="keyword">true</span>, <a href="../../../../Option.scala.html#64111" title="(x: ch.epfl.lamp.compiler.msil.emit.Label)Some[ch.epfl.lamp.compiler.msil.emit.Label]">Some</a><span class="delimiter">(</span><a href="#793315" title="ch.epfl.lamp.compiler.msil.emit.Label">l</a><span class="delimiter">)</span><span class="delimiter">)</span>
              <span class="delimiter">}</span>
            <span class="keyword">case</span> <a href="../../../../Option.scala.html#2498" title="(Boolean, Boolean, Option[ch.epfl.lamp.compiler.msil.emit.Label])" id="793343">None</a> =&gt;
              <a href="#793344" title="(x: (Boolean, Boolean, Option[ch.epfl.lamp.compiler.msil.emit.Label]))(Boolean, Boolean, Option[ch.epfl.lamp.compiler.msil.emit.Label])" class="delimiter">(</a><span title="Boolean(true)" class="keyword">true</span>, <span title="Boolean(false)" class="keyword">false</span>, <a href="../../../../Option.scala.html#2498" title="None.type">None</a><span class="delimiter">)</span>
          <span class="delimiter">}</span>
        <span class="delimiter">}</span> <span class="keyword">else</span> <a href="../../../../Tuple3.scala.html#64156" title="(_1: Boolean, _2: Boolean, _3: None.type)(Boolean, Boolean, None.type)" class="delimiter">(</a><span title="Boolean(false)" class="keyword">false</span>, <span title="Boolean(false)" class="keyword">false</span>, <a href="../../../../Option.scala.html#2498" title="None.type">None</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="(block: GenMSIL.this.global.icodes.BasicBlock, cond: GenMSIL.this.global.icodes.TestOp, success: GenMSIL.this.global.icodes.BasicBlock, failure: GenMSIL.this.global.icodes.BasicBlock, next: GenMSIL.this.global.icodes.BasicBlock, emitBrFun: (GenMSIL.this.global.icodes.TestOp, ch.epfl.lamp.compiler.msil.emit.Label) =&gt; Unit)Unit" id="785629">emitCondBr</a><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.BasicBlock" id="792610">block</a>: <a href="../icode/BasicBlocks.scala.html#642689" title="GenMSIL.this.global.icodes.BasicBlock">BasicBlock</a>, <a title="GenMSIL.this.global.icodes.TestOp" id="792611">cond</a>: <a href="../icode/Primitives.scala.html#642803" title="GenMSIL.this.global.icodes.TestOp">TestOp</a>, <a title="GenMSIL.this.global.icodes.BasicBlock" id="792612">success</a>: <a href="../icode/BasicBlocks.scala.html#642689" title="GenMSIL.this.global.icodes.BasicBlock">BasicBlock</a>, <a title="GenMSIL.this.global.icodes.BasicBlock" id="792613">failure</a>: <a href="../icode/BasicBlocks.scala.html#642689" title="GenMSIL.this.global.icodes.BasicBlock">BasicBlock</a>,
                   <a title="GenMSIL.this.global.icodes.BasicBlock" id="792614">next</a>: <a href="../icode/BasicBlocks.scala.html#642689" title="GenMSIL.this.global.icodes.BasicBlock">BasicBlock</a>, <a title="(GenMSIL.this.global.icodes.TestOp, ch.epfl.lamp.compiler.msil.emit.Label) =&gt; Unit" id="792615">emitBrFun</a>: <span class="delimiter">(</span>TestOp, Label<span class="delimiter">)</span> =&gt; Unit<span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="keyword">val</span> <a href="#793386" title="(x: (Boolean, Boolean, Option[ch.epfl.lamp.compiler.msil.emit.Label]))(Boolean, Boolean, Option[ch.epfl.lamp.compiler.msil.emit.Label])" class="delimiter">(</a><a href="../../../../Tuple3.scala.html#61402" title="Boolean" id="793362">sLeaveHandler</a>, <a href="../../../../Tuple3.scala.html#61404" title="Boolean" id="793363">sLeaveFinally</a>, <a href="../../../../Tuple3.scala.html#61406" title="Option[ch.epfl.lamp.compiler.msil.emit.Label]" id="793364">slfTarget</a><span class="delimiter">)</span> = <a href="#785628" title="(from: GenMSIL.this.global.icodes.BasicBlock, to: GenMSIL.this.global.icodes.BasicBlock)(Boolean, Boolean, Option[ch.epfl.lamp.compiler.msil.emit.Label])">leavesHandler</a><a href="../../../../Tuple3.scala.html#214" title="(Boolean, Boolean, Option[ch.epfl.lamp.compiler.msil.emit.Label]) @unchecked" class="delimiter">(</a><a href="#792610" title="GenMSIL.this.global.icodes.BasicBlock">block</a>, <a href="#792612" title="GenMSIL.this.global.icodes.BasicBlock">success</a><span class="delimiter">)</span>
      <span class="keyword">val</span> <a href="#793407" title="(x: (Boolean, Boolean, Option[ch.epfl.lamp.compiler.msil.emit.Label]))(Boolean, Boolean, Option[ch.epfl.lamp.compiler.msil.emit.Label])" class="delimiter">(</a><a href="../../../../Tuple3.scala.html#61402" title="Boolean" id="793366">fLeaveHandler</a>, <a href="../../../../Tuple3.scala.html#61404" title="Boolean" id="793367">fLeaveFinally</a>, <a href="../../../../Tuple3.scala.html#61406" title="Option[ch.epfl.lamp.compiler.msil.emit.Label]" id="793368">flfTarget</a><span class="delimiter">)</span> = <a href="#785628" title="(from: GenMSIL.this.global.icodes.BasicBlock, to: GenMSIL.this.global.icodes.BasicBlock)(Boolean, Boolean, Option[ch.epfl.lamp.compiler.msil.emit.Label])">leavesHandler</a><a href="../../../../Tuple3.scala.html#214" title="(Boolean, Boolean, Option[ch.epfl.lamp.compiler.msil.emit.Label]) @unchecked" class="delimiter">(</a><a href="#792610" title="GenMSIL.this.global.icodes.BasicBlock">block</a>, <a href="#792613" title="GenMSIL.this.global.icodes.BasicBlock">failure</a><span class="delimiter">)</span>

      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#793362" title="Boolean">sLeaveHandler</a> <a href="../../../../Boolean.scala.html#58724" title="(x: Boolean)Boolean">||</a> <a href="#793366" title="Boolean">fLeaveHandler</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="Option[ch.epfl.lamp.compiler.msil.emit.Label]" id="793411">sLabelOpt</a> = <span title="Option[ch.epfl.lamp.compiler.msil.emit.Label]" class="keyword">if</span> <span class="delimiter">(</span><a href="#793362" title="Boolean">sLeaveHandler</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.Label" id="793412">leaveSLabel</a> = <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="()ch.epfl.lamp.compiler.msil.emit.Label">DefineLabel</span><span class="delimiter">(</span><span class="delimiter">)</span>
          <a href="../../../../Function2.scala.html#65847" title="(v1: GenMSIL.this.global.icodes.TestOp, v2: ch.epfl.lamp.compiler.msil.emit.Label)Unit">emitBrFun</a><span class="delimiter">(</span><a href="#792611" title="GenMSIL.this.global.icodes.TestOp">cond</a>, <a href="#793412" title="ch.epfl.lamp.compiler.msil.emit.Label">leaveSLabel</a><span class="delimiter">)</span>
          <a href="../../../../Option.scala.html#64111" title="(x: ch.epfl.lamp.compiler.msil.emit.Label)Some[ch.epfl.lamp.compiler.msil.emit.Label]">Some</a><span class="delimiter">(</span><a href="#793412" title="ch.epfl.lamp.compiler.msil.emit.Label">leaveSLabel</a><span class="delimiter">)</span>
        <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
          <a href="../../../../Function2.scala.html#65847" title="(v1: GenMSIL.this.global.icodes.TestOp, v2: ch.epfl.lamp.compiler.msil.emit.Label)Unit">emitBrFun</a><span class="delimiter">(</span><a href="#792611" title="GenMSIL.this.global.icodes.TestOp">cond</a>, <a href="../../../../collection/mutable/HashMap.scala.html#79206" title="(key: GenMSIL.this.global.icodes.BasicBlock)ch.epfl.lamp.compiler.msil.emit.Label">labels</a><span class="delimiter">(</span><a href="#792612" title="GenMSIL.this.global.icodes.BasicBlock">success</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <a href="../../../../Option.scala.html#2498" title="None.type">None</a>
        <span class="delimiter">}</span>

        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#793366" title="Boolean">fLeaveHandler</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#793367" title="Boolean">fLeaveFinally</a><span class="delimiter">)</span> <span class="delimiter">{</span>
            <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#793368" title="Option[ch.epfl.lamp.compiler.msil.emit.Label]">flfTarget</a>.<a href="../../../../Option.scala.html#63812" title="=&gt; Boolean">isDefined</a><span class="delimiter">)</span> <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, label: ch.epfl.lamp.compiler.msil.emit.Label)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Leave</span>, <a href="#793368" title="Option[ch.epfl.lamp.compiler.msil.emit.Label]">flfTarget</a>.<a href="../../../../Option.scala.html#63813" title="=&gt; ch.epfl.lamp.compiler.msil.emit.Label">get</a><span class="delimiter">)</span>
            <span class="keyword">else</span> <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Endfinally</span><span class="delimiter">)</span>
          <span class="delimiter">}</span> <span class="keyword">else</span>
            <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, label: ch.epfl.lamp.compiler.msil.emit.Label)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Leave</span>, <a href="../../../../collection/mutable/HashMap.scala.html#79206" title="(key: GenMSIL.this.global.icodes.BasicBlock)ch.epfl.lamp.compiler.msil.emit.Label">labels</a><span class="delimiter">(</span><a href="#792613" title="GenMSIL.this.global.icodes.BasicBlock">failure</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="delimiter">}</span> <span class="keyword">else</span>
          <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, label: ch.epfl.lamp.compiler.msil.emit.Label)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Br</span>, <a href="../../../../collection/mutable/HashMap.scala.html#79206" title="(key: GenMSIL.this.global.icodes.BasicBlock)ch.epfl.lamp.compiler.msil.emit.Label">labels</a><span class="delimiter">(</span><a href="#792613" title="GenMSIL.this.global.icodes.BasicBlock">failure</a><span class="delimiter">)</span><span class="delimiter">)</span>

        <a href="#793411" title="Option[ch.epfl.lamp.compiler.msil.emit.Label]">sLabelOpt</a>.<a href="../../../../Option.scala.html#63820" title="(f: ch.epfl.lamp.compiler.msil.emit.Label =&gt; Unit)Option[Unit]">map</a><span title="Unit" class="delimiter">(</span><a title="ch.epfl.lamp.compiler.msil.emit.Label" id="793504">l</a> =&gt; <span class="delimiter">{</span>
          <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(label: ch.epfl.lamp.compiler.msil.emit.Label)Unit">MarkLabel</span><span class="delimiter">(</span><a href="#793504" title="ch.epfl.lamp.compiler.msil.emit.Label">l</a><span class="delimiter">)</span>
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#793363" title="Boolean">sLeaveFinally</a><span class="delimiter">)</span> <span class="delimiter">{</span>
            <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#793364" title="Option[ch.epfl.lamp.compiler.msil.emit.Label]">slfTarget</a>.<a href="../../../../Option.scala.html#63812" title="=&gt; Boolean">isDefined</a><span class="delimiter">)</span> <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, label: ch.epfl.lamp.compiler.msil.emit.Label)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Leave</span>, <a href="#793364" title="Option[ch.epfl.lamp.compiler.msil.emit.Label]">slfTarget</a>.<a href="../../../../Option.scala.html#63813" title="=&gt; ch.epfl.lamp.compiler.msil.emit.Label">get</a><span class="delimiter">)</span>
            <span class="keyword">else</span> <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Endfinally</span><span class="delimiter">)</span>
          <span class="delimiter">}</span> <span class="keyword">else</span>
            <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, label: ch.epfl.lamp.compiler.msil.emit.Label)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Leave</span>, <a href="../../../../collection/mutable/HashMap.scala.html#79206" title="(key: GenMSIL.this.global.icodes.BasicBlock)ch.epfl.lamp.compiler.msil.emit.Label">labels</a><span class="delimiter">(</span><a href="#792612" title="GenMSIL.this.global.icodes.BasicBlock">success</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="delimiter">}</span><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#792614" title="GenMSIL.this.global.icodes.BasicBlock">next</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#792612" title="GenMSIL.this.global.icodes.BasicBlock">success</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="../../../../Function2.scala.html#65847" title="(v1: GenMSIL.this.global.icodes.TestOp, v2: ch.epfl.lamp.compiler.msil.emit.Label)Unit">emitBrFun</a><span class="delimiter">(</span><a href="#792611" title="GenMSIL.this.global.icodes.TestOp">cond</a>.<a href="../icode/Primitives.scala.html#739616" title="()GenMSIL.this.global.icodes.TestOp">negate</a>, <a href="../../../../collection/mutable/HashMap.scala.html#79206" title="(key: GenMSIL.this.global.icodes.BasicBlock)ch.epfl.lamp.compiler.msil.emit.Label">labels</a><span class="delimiter">(</span><a href="#792613" title="GenMSIL.this.global.icodes.BasicBlock">failure</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
          <a href="../../../../Function2.scala.html#65847" title="(v1: GenMSIL.this.global.icodes.TestOp, v2: ch.epfl.lamp.compiler.msil.emit.Label)Unit">emitBrFun</a><span class="delimiter">(</span><a href="#792611" title="GenMSIL.this.global.icodes.TestOp">cond</a>, <a href="../../../../collection/mutable/HashMap.scala.html#79206" title="(key: GenMSIL.this.global.icodes.BasicBlock)ch.epfl.lamp.compiler.msil.emit.Label">labels</a><span class="delimiter">(</span><a href="#792612" title="GenMSIL.this.global.icodes.BasicBlock">success</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#792614" title="GenMSIL.this.global.icodes.BasicBlock">next</a> <span title="(x$1: AnyRef)Boolean">!=</span> <a href="#792613" title="GenMSIL.this.global.icodes.BasicBlock">failure</a><span class="delimiter">)</span> <span class="delimiter">{</span>
            <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, label: ch.epfl.lamp.compiler.msil.emit.Label)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Br</span>, <a href="../../../../collection/mutable/HashMap.scala.html#79206" title="(key: GenMSIL.this.global.icodes.BasicBlock)ch.epfl.lamp.compiler.msil.emit.Label">labels</a><span class="delimiter">(</span><a href="#792613" title="GenMSIL.this.global.icodes.BasicBlock">failure</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <span class="delimiter">}</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="(condition: GenMSIL.this.global.icodes.TestOp, dest: ch.epfl.lamp.compiler.msil.emit.Label, isFloat: Boolean)Unit" id="785630">emitBr</a><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.TestOp" id="792607">condition</a>: <a href="../icode/Primitives.scala.html#642803" title="GenMSIL.this.global.icodes.TestOp">TestOp</a>, <a title="ch.epfl.lamp.compiler.msil.emit.Label" id="792608">dest</a>: <span title="ch.epfl.lamp.compiler.msil.emit.Label">Label</span>, <a title="Boolean" id="792609">isFloat</a>: <a href="../../../../Boolean.scala.html#2218" title="Boolean">Boolean</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#792607" title="GenMSIL.this.global.icodes.TestOp">condition</a> <span class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <a href="../icode/Primitives.scala.html#642804" title="Unit" id="793636">EQ</a> =&gt; <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, label: ch.epfl.lamp.compiler.msil.emit.Label)Unit">Emit</span><a href="#793642" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Beq</span>, <a href="#792608" title="ch.epfl.lamp.compiler.msil.emit.Label">dest</a><span class="delimiter">)</span>
        <span class="keyword">case</span> <a href="../icode/Primitives.scala.html#642806" title="Unit" id="793637">NE</a> =&gt; <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, label: ch.epfl.lamp.compiler.msil.emit.Label)Unit">Emit</span><a href="#793642" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Bne_Un</span>, <a href="#792608" title="ch.epfl.lamp.compiler.msil.emit.Label">dest</a><span class="delimiter">)</span>
        <span class="keyword">case</span> <a href="../icode/Primitives.scala.html#642808" title="Unit" id="793638">LT</a> =&gt; <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, label: ch.epfl.lamp.compiler.msil.emit.Label)Unit">Emit</span><a href="#793642" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCode" class="keyword">if</span> <span class="delimiter">(</span><a href="#792609" title="Boolean">isFloat</a><span class="delimiter">)</span> <span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Blt_Un</span> <span class="keyword">else</span> <span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Blt</span>, <a href="#792608" title="ch.epfl.lamp.compiler.msil.emit.Label">dest</a><span class="delimiter">)</span>
        <span class="keyword">case</span> <a href="../icode/Primitives.scala.html#642810" title="Unit" id="793639">GE</a> =&gt; <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, label: ch.epfl.lamp.compiler.msil.emit.Label)Unit">Emit</span><a href="#793642" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCode" class="keyword">if</span> <span class="delimiter">(</span><a href="#792609" title="Boolean">isFloat</a><span class="delimiter">)</span> <span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Bge_Un</span> <span class="keyword">else</span> <span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Bge</span>, <a href="#792608" title="ch.epfl.lamp.compiler.msil.emit.Label">dest</a><span class="delimiter">)</span>
        <span class="keyword">case</span> <a href="../icode/Primitives.scala.html#642812" title="Unit" id="793640">LE</a> =&gt; <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, label: ch.epfl.lamp.compiler.msil.emit.Label)Unit">Emit</span><a href="#793642" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCode" class="keyword">if</span> <span class="delimiter">(</span><a href="#792609" title="Boolean">isFloat</a><span class="delimiter">)</span> <span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ble_Un</span> <span class="keyword">else</span> <span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ble</span>, <a href="#792608" title="ch.epfl.lamp.compiler.msil.emit.Label">dest</a><span class="delimiter">)</span>
        <span class="keyword">case</span> <a href="../icode/Primitives.scala.html#642814" title="Unit" id="793641">GT</a> =&gt; <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, label: ch.epfl.lamp.compiler.msil.emit.Label)Unit">Emit</span><a href="#793642" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCode" class="keyword">if</span> <span class="delimiter">(</span><a href="#792609" title="Boolean">isFloat</a><span class="delimiter">)</span> <span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Bgt_Un</span> <span class="keyword">else</span> <span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Bgt</span>, <a href="#792608" title="ch.epfl.lamp.compiler.msil.emit.Label">dest</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="(cond: GenMSIL.this.global.icodes.TestOp, dest: ch.epfl.lamp.compiler.msil.emit.Label)Unit" id="785631">emitBrBool</a><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.TestOp" id="792627">cond</a>: <a href="../icode/Primitives.scala.html#642803" title="GenMSIL.this.global.icodes.TestOp">TestOp</a>, <a title="ch.epfl.lamp.compiler.msil.emit.Label" id="792628">dest</a>: <span title="ch.epfl.lamp.compiler.msil.emit.Label">Label</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#792627" title="GenMSIL.this.global.icodes.TestOp">cond</a> <span class="keyword">match</span> <span class="delimiter">{</span>
        // EQ -&gt; Brfalse, NE -&gt; Brtrue; this is because we come from
        // a CZJUMP. If the value on the stack is 0 (e.g. a boolean
        // method returned false), and we are in the case EQ, then
        // we need to emit Brfalse (EQ Zero means false). vice versa
        <span class="keyword">case</span> <a href="../icode/Primitives.scala.html#642804" title="Unit" id="793681">EQ</a> =&gt; <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, label: ch.epfl.lamp.compiler.msil.emit.Label)Unit">Emit</span><a href="#793683" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Brfalse</span>, <a href="#792628" title="ch.epfl.lamp.compiler.msil.emit.Label">dest</a><span class="delimiter">)</span>
        <span class="keyword">case</span> <a href="../icode/Primitives.scala.html#642806" title="Unit" id="793682">NE</a> =&gt; <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, label: ch.epfl.lamp.compiler.msil.emit.Label)Unit">Emit</span><a href="#793683" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Brtrue</span>, <a href="#792628" title="ch.epfl.lamp.compiler.msil.emit.Label">dest</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    ////////////////////// local vars ///////////////////////

    /**
     * Compute the indexes of each local variable of the given
     * method.
     */
    <span class="keyword">def</span> <a title="(m: GenMSIL.this.global.icodes.IMethod)Unit" id="785632">computeLocalVarsIndex</a><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.IMethod" id="789304">m</a>: <a href="../icode/Members.scala.html#642680" title="GenMSIL.this.global.icodes.IMethod">IMethod</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="keyword">var</span> <a title="Int" id="793694">idx</a> = <span title="Int" class="keyword">if</span> <span class="delimiter">(</span><a href="#789304" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#733826" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443358" title="=&gt; Boolean">isStaticMember</a><span class="delimiter">)</span> <span title="Int(0)" class="int">0</span> <span class="keyword">else</span> <span title="Int(1)" class="int">1</span>

      <span class="keyword">val</span> <a title="List[GenMSIL.this.global.icodes.Local]" id="793695">params</a> = <a href="#789304" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#733861" title="=&gt; List[GenMSIL.this.global.icodes.Local]">params</a>
      <span class="keyword">for</span> <span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.Local" id="793716">l</a> &lt;- <a href="../../../../collection/LinearSeqOptimized.scala.html#76166" title="(f: GenMSIL.this.global.icodes.Local =&gt; Unit)Unit">params</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="../../Global.scala.html#559553" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><span title="String(&quot;Index value for parameter &quot;)" class="string">&quot;Index value for parameter &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#793716" title="GenMSIL.this.global.icodes.Local">l</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;: &quot;)" class="string">&quot;: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#793694" title="Int">idx</a><span class="delimiter">)</span>
        <a href="#793716" title="GenMSIL.this.global.icodes.Local">l</a>.<a href="../icode/Members.scala.html#734271" title="(x$1: Int)Unit">index</a> = <a href="#793694" title="Int">idx</a>
        <a href="#793694" title="Int">idx</a> <a href="../../../../Int.scala.html#57948" title="(x: Int)Int">+=</a> <span title="Int(1)" class="int">1</span> // sizeOf(l.kind)
      <span class="delimiter">}</span>

      <span class="keyword">val</span> <a title="List[GenMSIL.this.global.icodes.Local]" id="793696">locvars</a> = <a href="#789304" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#733858" title="=&gt; List[GenMSIL.this.global.icodes.Local]">locals</a> <a href="../../../../collection/TraversableLike.scala.html#58982" title="(p: GenMSIL.this.global.icodes.Local =&gt; Boolean)List[GenMSIL.this.global.icodes.Local]">filterNot</a> <span class="delimiter">(</span><a href="#793695" title="List[GenMSIL.this.global.icodes.Local]">params</a> <a href="../../../../collection/SeqLike.scala.html#59768" title="(elem: Any)Boolean">contains</a><span class="delimiter">)</span>
      <a href="#793694" title="Int">idx</a> = <span title="Int(0)" class="int">0</span>

      <span class="keyword">for</span> <span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.Local" id="793749">l</a> &lt;- <a href="../../../../collection/LinearSeqOptimized.scala.html#76166" title="(f: GenMSIL.this.global.icodes.Local =&gt; Unit)Unit">locvars</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="../../Global.scala.html#559553" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><span title="String(&quot;Index value for local variable &quot;)" class="string">&quot;Index value for local variable &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#793749" title="GenMSIL.this.global.icodes.Local">l</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;: &quot;)" class="string">&quot;: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#793694" title="Int">idx</a><span class="delimiter">)</span>
        <a href="#793749" title="GenMSIL.this.global.icodes.Local">l</a>.<a href="../icode/Members.scala.html#734271" title="(x$1: Int)Unit">index</a> = <a href="#793694" title="Int">idx</a>
        <a href="#793694" title="Int">idx</a> <a href="../../../../Int.scala.html#57948" title="(x: Int)Int">+=</a> <span title="Int(1)" class="int">1</span> // sizeOf(l.kind)
      <span class="delimiter">}</span>

    <span class="delimiter">}</span>

    ////////////////////// Utilities ////////////////////////

    /** Return the a name of this symbol that can be used on the .NET
     * platform. It removes spaces from names.
     *
     * Special handling: scala.All and scala.AllRef are 'erased' to
     * scala.All$ and scala.AllRef$. This is needed because they are
     * not real classes, and they mean 'abrupt termination upon evaluation
     * of that expression' or 'null' respectively. This handling is
     * done already in GenICode, but here we need to remove references
     * from method signatures to these types, because such classes can
     * not exist in the classpath: the type checker will be very confused.
     */
    <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol)String" id="785633">msilName</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="786527">sym</a>: <a href="../../../../reflect/internal/Symbols.scala.html#441132" title="GenMSIL.this.global.Symbol">Symbol</a><span class="delimiter">)</span>: <span title="String">String</span> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="String" id="793757">suffix</a> = <a href="#786527" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443390" title="=&gt; String">moduleSuffix</a>
      // Flags.JAVA: &quot;symbol was not defined by a scala-class&quot; (java, or .net-class)

      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#786527" title="GenMSIL.this.global.Symbol">sym</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../../../reflect/internal/Definitions.scala.html#441641" title="GenMSIL.this.global.definitions.type">definitions</a>.<a href="../../../../reflect/internal/Definitions.scala.html#442193" title="GenMSIL.this.global.definitions.NothingClass.type">NothingClass</a><span class="delimiter">)</span>
        <span title="Nothing" class="keyword">return</span> <span title="String(&quot;scala.runtime.Nothing$&quot;)" class="string">&quot;scala.runtime.Nothing$&quot;</span>
      <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#786527" title="GenMSIL.this.global.Symbol">sym</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../../../reflect/internal/Definitions.scala.html#441641" title="GenMSIL.this.global.definitions.type">definitions</a>.<a href="../../../../reflect/internal/Definitions.scala.html#442195" title="GenMSIL.this.global.definitions.NullClass.type">NullClass</a><span class="delimiter">)</span>
        <span title="Nothing" class="keyword">return</span> <span title="String(&quot;scala.runtime.Null$&quot;)" class="string">&quot;scala.runtime.Null$&quot;</span>

      <span class="delimiter">(</span><a href="../../../../Predef.scala.html#8576" title="implicit scala.Predef.any2stringadd : (x: Any)scala.runtime.StringAdd" class="keyword">if</a> <span class="delimiter">(</span><a href="#786527" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443231" title="=&gt; Boolean">isClass</a> <a href="../../../../Boolean.scala.html#58724" title="(x: Boolean)Boolean">||</a> <span class="delimiter">(</span><a href="#786527" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443270" title="=&gt; Boolean">isModule</a> <a href="../../../../Boolean.scala.html#58725" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../../../Boolean.scala.html#58721" title="=&gt; Boolean">!</a><a href="#786527" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443282" title="=&gt; Boolean">isMethod</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span title="Object" class="keyword">if</span> <span class="delimiter">(</span><a href="#786527" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443364" title="=&gt; Boolean">isNestedClass</a><span class="delimiter">)</span> <a href="#786527" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443544" title="=&gt; GenMSIL.this.global.Name">simpleName</a>
        <span class="keyword">else</span> <a href="#786527" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443398" title="=&gt; String">fullName</a>
       <span class="delimiter">}</span> <span class="keyword">else</span>
         <a href="#786527" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443544" title="=&gt; GenMSIL.this.global.Name">simpleName</a>.<a href="../../../../Function1.scala.html#59562" title="()String">toString</a>.<span title="()String">trim</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../../../runtime/StringAdd.scala.html#60949" title="(other: String)String">+</a> <a href="#793757" title="String">suffix</a>
    <span class="delimiter">}</span>


    ////////////////////// flags ///////////////////////

    <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol)Int" id="785634">msilTypeFlags</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="793783">sym</a>: <a href="../../../../reflect/internal/Symbols.scala.html#441132" title="GenMSIL.this.global.Symbol">Symbol</a><span class="delimiter">)</span>: <a href="../../../../Int.scala.html#508" title="Int">Int</a> = <span class="delimiter">{</span>
      <span class="keyword">var</span> <a title="Int" id="793784">mf</a>: <a href="../../../../Int.scala.html#508" title="Int">Int</a> = TypeAttributes.AutoLayout <span title="Int(0)">|</span> TypeAttributes.AnsiClass

      <span title="Unit" class="keyword">if</span><span class="delimiter">(</span><a href="#793783" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443364" title="=&gt; Boolean">isNestedClass</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#793784" title="Int">mf</a> = <a href="#793784" title="Int">mf</a> <a href="../../../../Int.scala.html#57933" title="(x: Int)Int">|</a> <span class="delimiter">(</span><span title="Int" class="keyword">if</span> <span class="delimiter">(</span><a href="#793783" title="GenMSIL.this.global.Symbol">sym</a> <a href="../../../../reflect/internal/Symbols.scala.html#443303" title="(mask: Long)Boolean">hasFlag</a> Flags.<span title="Long(4L)">PRIVATE</span><span class="delimiter">)</span> TypeAttributes.<span title="Int(3)">NestedPrivate</span> <span class="keyword">else</span> TypeAttributes.<span title="Int(2)">NestedPublic</span><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
        <a href="#793784" title="Int">mf</a> = <a href="#793784" title="Int">mf</a> <a href="../../../../Int.scala.html#57933" title="(x: Int)Int">|</a> <span class="delimiter">(</span><span title="Int" class="keyword">if</span> <span class="delimiter">(</span><a href="#793783" title="GenMSIL.this.global.Symbol">sym</a> <a href="../../../../reflect/internal/Symbols.scala.html#443303" title="(mask: Long)Boolean">hasFlag</a> Flags.<span title="Long(4L)">PRIVATE</span><span class="delimiter">)</span> TypeAttributes.<span title="Int(0)">NotPublic</span> <span class="keyword">else</span> TypeAttributes.<span title="Int(1)">Public</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
      <a href="#793784" title="Int">mf</a> = <a href="#793784" title="Int">mf</a> <a href="../../../../Int.scala.html#57933" title="(x: Int)Int">|</a> <span class="delimiter">(</span><span title="Int" class="keyword">if</span> <span class="delimiter">(</span><a href="#793783" title="GenMSIL.this.global.Symbol">sym</a> <a href="../../../../reflect/internal/Symbols.scala.html#443303" title="(mask: Long)Boolean">hasFlag</a> Flags.<span title="Long(8L)">ABSTRACT</span><span class="delimiter">)</span> TypeAttributes.<span title="Int(128)">Abstract</span> <span class="keyword">else</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
      <a href="#793784" title="Int">mf</a> = <a href="#793784" title="Int">mf</a> <a href="../../../../Int.scala.html#57933" title="(x: Int)Int">|</a> <span class="delimiter">(</span><span title="Int" class="keyword">if</span> <span class="delimiter">(</span><a href="#793783" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443249" title="=&gt; Boolean">isTrait</a> <a href="../../../../Boolean.scala.html#58725" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../../../Boolean.scala.html#58721" title="=&gt; Boolean">!</a><a href="#793783" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443243" title="=&gt; Boolean">isImplClass</a><span class="delimiter">)</span> TypeAttributes.<span title="Int(32)">Interface</span> <span class="keyword">else</span> TypeAttributes.<span title="Int(0)">Class</span><span class="delimiter">)</span>
      <a href="#793784" title="Int">mf</a> = <a href="#793784" title="Int">mf</a> <a href="../../../../Int.scala.html#57933" title="(x: Int)Int">|</a> <span class="delimiter">(</span><span title="Int" class="keyword">if</span> <span class="delimiter">(</span><a href="#793783" title="GenMSIL.this.global.Symbol">sym</a> <a href="../../../../reflect/internal/HasFlags.scala.html#443591" title="=&gt; Boolean">isFinal</a><span class="delimiter">)</span> TypeAttributes.<span title="Int(256)">Sealed</span> <span class="keyword">else</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>

      <a href="#793783" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443459" title="=&gt; List[GenMSIL.this.global.AnnotationInfo]">annotations</a> <a href="../../../../collection/LinearSeqOptimized.scala.html#76166" title="(f: GenMSIL.this.global.AnnotationInfo =&gt; Unit)Unit">foreach</a> <span class="delimiter">{</span> a =&gt; <a href="#793836" title="GenMSIL.this.global.AnnotationInfo">a</a> <span class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <a href="../../../../reflect/internal/AnnotationInfos.scala.html#443060" title="Option[(GenMSIL.this.global.Type, List[GenMSIL.this.global.Tree], List[(GenMSIL.this.global.Name, GenMSIL.this.global.ClassfileAnnotArg)])]" id="793862">AnnotationInfo</a><span class="delimiter">(</span><a href="#785541" title="Unit" id="793855">SerializableAttr</a>, _, _<span class="delimiter">)</span> =&gt;
          // TODO: add the Serializable TypeAttribute also if the annotation
          // System.SerializableAttribute is present (.net annotation, not scala)
          //  Best way to do it: compare with
          //  definitions.getClass(&quot;System.SerializableAttribute&quot;).tpe
          //  when frontend available
          <a href="#793784" title="Int">mf</a> = <a href="#793784" title="Int">mf</a> <a href="../../../../Int.scala.html#57933" title="(x: Int)Int">|</a> TypeAttributes.<span title="Int(8192)">Serializable</span>
        <span class="keyword">case</span> _ =&gt; <a href="#793856" title="(x: Unit)Unit" class="delimiter">(</a><span class="delimiter">)</span>
      <span class="delimiter">}</span><span class="delimiter">}</span>

      <a href="#793784" title="Int">mf</a>
      // static: not possible (or?)
    <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol)Short" id="785635">msilMethodFlags</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="793878">sym</a>: <a href="../../../../reflect/internal/Symbols.scala.html#441132" title="GenMSIL.this.global.Symbol">Symbol</a><span class="delimiter">)</span>: <a href="../../../../Short.scala.html#1258" title="Short">Short</a> = <span class="delimiter">{</span>
      <span class="keyword">var</span> <a title="Int" id="793879">mf</a>: <a href="../../../../Int.scala.html#508" title="Int">Int</a> = MethodAttributes.<span title="Short(128)">HideBySig</span> <a href="../../../../Short.scala.html#57797" title="(x: Short)Int">|</a>
        <span class="delimiter">(</span><span title="Short" class="keyword">if</span> <span class="delimiter">(</span><a href="#793878" title="GenMSIL.this.global.Symbol">sym</a> <a href="../../../../reflect/internal/Symbols.scala.html#443303" title="(mask: Long)Boolean">hasFlag</a> Flags.<span title="Long(4L)">PRIVATE</span><span class="delimiter">)</span> MethodAttributes.<span title="Short(1)">Private</span>
         <span class="keyword">else</span> MethodAttributes.<span title="Short(6)">Public</span><span class="delimiter">)</span>

      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../../../Boolean.scala.html#58721" title="=&gt; Boolean">!</a><a href="#793878" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443264" title="=&gt; Boolean">isClassConstructor</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#793878" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443358" title="=&gt; Boolean">isStaticMember</a><span class="delimiter">)</span>
          <a href="#793879" title="Int">mf</a> = <a href="#793879" title="Int">mf</a> <a href="../../../../Int.scala.html#57931" title="(x: Short)Int">|</a> FieldAttributes.<span title="Short(16)">Static</span> // coincidentally, same value as for MethodAttributes.Static ...
        <span class="keyword">else</span> <span class="delimiter">{</span>
          <a href="#793879" title="Int">mf</a> = <a href="#793879" title="Int">mf</a> <a href="../../../../Int.scala.html#57931" title="(x: Short)Int">|</a> MethodAttributes.<span title="Short(64)">Virtual</span>
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#793878" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/HasFlags.scala.html#443591" title="=&gt; Boolean">isFinal</a> <a href="../../../../Boolean.scala.html#58725" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../../../Boolean.scala.html#58721" title="=&gt; Boolean">!</a><a href="#785648" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.Type">getType</a><span class="delimiter">(</span><a href="#793878" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443379" title="=&gt; GenMSIL.this.global.Symbol">owner</a><span class="delimiter">)</span>.<span title="()Boolean">IsInterface</span><span class="delimiter">)</span>
            <a href="#793879" title="Int">mf</a> = <a href="#793879" title="Int">mf</a> <a href="../../../../Int.scala.html#57931" title="(x: Short)Int">|</a> MethodAttributes.<span title="Short(32)">Final</span>
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#793878" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/HasFlags.scala.html#443608" title="=&gt; Boolean">isDeferred</a> <a href="../../../../Boolean.scala.html#58724" title="(x: Boolean)Boolean">||</a> <a href="#785648" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.Type">getType</a><span class="delimiter">(</span><a href="#793878" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443379" title="=&gt; GenMSIL.this.global.Symbol">owner</a><span class="delimiter">)</span>.<span title="()Boolean">IsInterface</span><span class="delimiter">)</span>
            <a href="#793879" title="Int">mf</a> = <a href="#793879" title="Int">mf</a> <a href="../../../../Int.scala.html#57931" title="(x: Short)Int">|</a> MethodAttributes.<span title="Short(1024)">Abstract</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>

      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#793878" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443358" title="=&gt; Boolean">isStaticMember</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#793879" title="Int">mf</a> = <a href="#793879" title="Int">mf</a> <a href="../../../../Int.scala.html#57931" title="(x: Short)Int">|</a> MethodAttributes.<span title="Short(16)">Static</span>
      <span class="delimiter">}</span>

      // constructors of module classes should be private
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#793878" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443350" title="=&gt; Boolean">isPrimaryConstructor</a> <a href="../../../../Boolean.scala.html#58725" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#785654" title="(sym: GenMSIL.this.global.Symbol)Boolean">isTopLevelModule</a><span class="delimiter">(</span><a href="#793878" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443379" title="=&gt; GenMSIL.this.global.Symbol">owner</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#793879" title="Int">mf</a> <a href="../../../../Int.scala.html#57931" title="(x: Short)Int">|=</a> MethodAttributes.<span title="Short(1)">Private</span>
        <a href="#793879" title="Int">mf</a> <a href="../../../../Int.scala.html#57938" title="(x: Int)Int">&amp;=</a> <a href="../../../../Short.scala.html#57744" title="=&gt; Int">~</a><span class="delimiter">(</span>MethodAttributes.<span title="Short(6)">Public</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>

      <a href="#793879" title="Int">mf</a>.<a href="../../../../Int.scala.html#57872" title="=&gt; Short">toShort</a>
    <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol)Short" id="785636">msilFieldFlags</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="793916">sym</a>: <a href="../../../../reflect/internal/Symbols.scala.html#441132" title="GenMSIL.this.global.Symbol">Symbol</a><span class="delimiter">)</span>: <a href="../../../../Short.scala.html#1258" title="Short">Short</a> = <span class="delimiter">{</span>
      <span class="keyword">var</span> <a title="Int" id="793917">mf</a>: <a href="../../../../Int.scala.html#508" title="Int">Int</a> =
        <span title="Int" class="keyword">if</span> <span class="delimiter">(</span><a href="#793916" title="GenMSIL.this.global.Symbol">sym</a> <a href="../../../../reflect/internal/Symbols.scala.html#443303" title="(mask: Long)Boolean">hasFlag</a> Flags.<span title="Long(4L)">PRIVATE</span><span class="delimiter">)</span> FieldAttributes.<span title="Int(1)">Private</span>
        <span class="keyword">else</span> <span title="Int" class="keyword">if</span> <span class="delimiter">(</span><a href="#793916" title="GenMSIL.this.global.Symbol">sym</a> <a href="../../../../reflect/internal/Symbols.scala.html#443303" title="(mask: Long)Boolean">hasFlag</a> Flags.<span title="Long(1L)">PROTECTED</span><span class="delimiter">)</span> FieldAttributes.<span title="Int(5)">FamORAssem</span>
        <span class="keyword">else</span> FieldAttributes.<span title="Int(6)">Public</span>

      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#793916" title="GenMSIL.this.global.Symbol">sym</a> <a href="../../../../reflect/internal/Symbols.scala.html#443303" title="(mask: Long)Boolean">hasFlag</a> Flags.<span title="Long(32L)">FINAL</span><span class="delimiter">)</span>
        <a href="#793917" title="Int">mf</a> = <a href="#793917" title="Int">mf</a> <a href="../../../../Int.scala.html#57931" title="(x: Short)Int">|</a> FieldAttributes.<span title="Short(32)">InitOnly</span>

      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#793916" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443358" title="=&gt; Boolean">isStaticMember</a><span class="delimiter">)</span>
        <a href="#793917" title="Int">mf</a> = <a href="#793917" title="Int">mf</a> <a href="../../../../Int.scala.html#57931" title="(x: Short)Int">|</a> FieldAttributes.<span title="Short(16)">Static</span>

      // TRANSIENT: &quot;not serialized&quot;, VOLATILE: doesn't exist on .net
      // TODO: add this annotation also if the class has the custom attribute
      // System.NotSerializedAttribute
      <a href="#793916" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443459" title="=&gt; List[GenMSIL.this.global.AnnotationInfo]">annotations</a>.<a href="../../../../collection/LinearSeqOptimized.scala.html#76166" title="(f: GenMSIL.this.global.AnnotationInfo =&gt; Unit)Unit">foreach</a><span class="delimiter">(</span> a =&gt; <a href="#793949" title="GenMSIL.this.global.AnnotationInfo">a</a> <span class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <a href="../../../../reflect/internal/AnnotationInfos.scala.html#443060" title="Option[(GenMSIL.this.global.Type, List[GenMSIL.this.global.Tree], List[(GenMSIL.this.global.Name, GenMSIL.this.global.ClassfileAnnotArg)])]" id="793975">AnnotationInfo</a><span class="delimiter">(</span><a href="#785545" title="Unit" id="793968">TransientAtt</a>, _, _<span class="delimiter">)</span> =&gt;
          <a href="#793917" title="Int">mf</a> = <a href="#793917" title="Int">mf</a> <a href="../../../../Int.scala.html#57931" title="(x: Short)Int">|</a> FieldAttributes.<span title="Short(128)">NotSerialized</span>
        <span class="keyword">case</span> _ =&gt; <a href="#793969" title="(x: Unit)Unit" class="delimiter">(</a><span class="delimiter">)</span>
      <span class="delimiter">}</span><span class="delimiter">)</span>

      <a href="#793917" title="Int">mf</a>.<a href="../../../../Int.scala.html#57872" title="=&gt; Short">toShort</a>
    <span class="delimiter">}</span>

    ////////////////////// builders, types ///////////////////////

    <span class="keyword">var</span> <a title="GenMSIL.this.global.Symbol" id="785638">entryPoint</a>: <a href="../../../../reflect/internal/Symbols.scala.html#441132" title="GenMSIL.this.global.Symbol">Symbol</a> = _

    <span class="keyword">val</span> <a title="scala.collection.mutable.HashSet[GenMSIL.this.global.Symbol]" id="785640">notInitializedModules</a> = mutable.<a href="../../../../collection/generic/GenericCompanion.scala.html#60782" title="[A](elems: A*)scala.collection.mutable.HashSet[A]">HashSet</a><span title="(elems: GenMSIL.this.global.Symbol*)scala.collection.mutable.HashSet[GenMSIL.this.global.Symbol]" class="delimiter">[</span><a href="../../../../reflect/internal/Symbols.scala.html#441132" title="GenMSIL.this.global.Symbol">Symbol</a><span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>

    // TODO: create fields also in def createType, and not in genClass,
    // add a getField method (it only works as it is because fields never
    // accessed from outside a class)

    <span class="keyword">val</span> <a title="scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.Local,ch.epfl.lamp.compiler.msil.emit.LocalBuilder]" id="785642">localBuilders</a> = mutable.<a href="../../../../collection/generic/GenMapFactory.scala.html#61654" title="[A, B](elems: (A, B)*)scala.collection.mutable.HashMap[A,B]">HashMap</a><span title="(elems: (GenMSIL.this.global.icodes.Local, ch.epfl.lamp.compiler.msil.emit.LocalBuilder)*)scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.Local,ch.epfl.lamp.compiler.msil.emit.LocalBuilder]" class="delimiter">[</span><a href="../icode/Members.scala.html#642681" title="GenMSIL.this.global.icodes.Local">Local</a>, <span title="ch.epfl.lamp.compiler.msil.emit.LocalBuilder">LocalBuilder</span><span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>

    <span class="keyword">private</span><span class="delimiter">[</span>GenMSIL<span class="delimiter">]</span> <span class="keyword">def</span> <a title="(cls: GenMSIL.this.global.icodes.IClass)Unit" id="785644">findEntryPoint</a><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.IClass" id="785705">cls</a>: <a href="../icode/Members.scala.html#642676" title="GenMSIL.this.global.icodes.IClass">IClass</a><span class="delimiter">)</span> <span class="delimiter">{</span>

      <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol)Boolean" id="793991">isEntryPoint</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="793992">sym</a>: <a href="../../../../reflect/internal/Symbols.scala.html#441132" title="GenMSIL.this.global.Symbol">Symbol</a><span class="delimiter">)</span>:<a href="../../../../Boolean.scala.html#2218" title="Boolean">Boolean</a> = <span class="delimiter">{</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#785655" title="(sym: GenMSIL.this.global.Symbol)Boolean">isStaticModule</a><span class="delimiter">(</span><a href="#793992" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443379" title="=&gt; GenMSIL.this.global.Symbol">owner</a><span class="delimiter">)</span> <a href="../../../../Boolean.scala.html#58725" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#785633" title="(sym: GenMSIL.this.global.Symbol)String">msilName</a><span class="delimiter">(</span><a href="#793992" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span> <span title="(x$1: AnyRef)Boolean">==</span> <span title="String(&quot;main&quot;)" class="string">&quot;main&quot;</span><span class="delimiter">)</span>
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#793992" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443425" title="=&gt; GenMSIL.this.global.Type">tpe</a>.<a href="../../../../reflect/internal/Types.scala.html#442010" title="=&gt; List[GenMSIL.this.global.Type]">paramTypes</a>.<a href="../../../../collection/LinearSeqOptimized.scala.html#76164" title="=&gt; Int">length</a> <a href="../../../../Int.scala.html#57891" title="(x: Int)Boolean">==</a> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span> <span class="delimiter">{</span>
            <a href="../icode/TypeKinds.scala.html#642747" title="(t: GenMSIL.this.global.icodes.global.Type)GenMSIL.this.global.icodes.TypeKind">toTypeKind</a><a href="../icode/TypeKinds.scala.html#733460" title="=&gt; GenMSIL.this.global.icodes.TypeKind" class="delimiter">(</a><a href="#793992" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443425" title="=&gt; GenMSIL.this.global.Type">tpe</a>.<a href="../../../../collection/LinearSeqOptimized.scala.html#76165" title="(n: Int)GenMSIL.this.global.Type">paramTypes</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
              <span class="keyword">case</span> ARRAY<a href="#794021" title="Unit" id="794023" class="delimiter">(</a>elem<span class="delimiter">)</span> =&gt;
                <a href="#794024" title="(x: Unit)Unit" class="keyword">if</a> <span class="delimiter">(</span>elem.<a href="../icode/TypeKinds.scala.html#731168" title="=&gt; GenMSIL.this.global.icodes.global.Type">toType</a>.<a href="../../../../reflect/internal/Types.scala.html#441986" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">typeSymbol</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../../../reflect/internal/Definitions.scala.html#441641" title="GenMSIL.this.global.definitions.type">definitions</a>.<a href="../../../../reflect/internal/Definitions.scala.html#442219" title="=&gt; GenMSIL.this.global.ClassSymbol">StringClass</a><span class="delimiter">)</span> <span class="delimiter">{</span>
                  <span title="Nothing" class="keyword">return</span> <span title="Boolean(true)" class="keyword">true</span>
                <span class="delimiter">}</span>
              <span class="keyword">case</span> _ =&gt; <a href="#794024" title="(x: Unit)Unit" class="delimiter">(</a><span class="delimiter">)</span>
            <span class="delimiter">}</span>
          <span class="delimiter">}</span>
        <span title="Boolean(false)" class="keyword">false</span>
      <span class="delimiter">}</span>

      <span title="Unit" class="keyword">if</span><span class="delimiter">(</span><span class="delimiter">(</span><a href="#785638" title="=&gt; GenMSIL.this.global.Symbol">entryPoint</a> <span title="(x$1: AnyRef)Boolean">==</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <a href="../../../../Boolean.scala.html#58725" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../Global.scala.html#559558" title="GenMSIL.this.global.opt.type">opt</a>.<a href="../../Global.scala.html#561531" title="=&gt; Option[GenMSIL.this.global.Name]">showClass</a>.<a href="../../../../Option.scala.html#63812" title="=&gt; Boolean">isDefined</a><span class="delimiter">)</span> <span class="delimiter">{</span>  // TODO introduce dedicated setting instead
        <span class="keyword">val</span> <a title="String" id="794034">entryclass</a> = <a href="../../Global.scala.html#559558" title="GenMSIL.this.global.opt.type">opt</a>.<a href="../../Global.scala.html#561531" title="=&gt; Option[GenMSIL.this.global.Name]">showClass</a>.<a href="../../../../Option.scala.html#63813" title="=&gt; GenMSIL.this.global.Name">get</a>.<a href="../../../../Function1.scala.html#59562" title="()String">toString</a>
        <span class="keyword">val</span> <a title="String" id="794035">cfn</a> = <a href="#785705" title="GenMSIL.this.global.icodes.IClass">cls</a>.<a href="../icode/Members.scala.html#642912" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443398" title="=&gt; String">fullName</a>
        <span title="Unit" class="keyword">if</span><span class="delimiter">(</span><a href="#794035" title="String">cfn</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#794034" title="String">entryclass</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <span class="keyword">for</span> <span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.IMethod" id="794053">m</a> &lt;- <a href="#785705" title="GenMSIL.this.global.icodes.IClass">cls</a>.<a href="../../../../collection/generic/FilterMonadic.scala.html#59082" title="(f: GenMSIL.this.global.icodes.IMethod =&gt; Unit)Unit">methods</a>; <span class="keyword">if</span> <a href="#793991" title="(sym: GenMSIL.this.global.Symbol)Boolean">isEntryPoint</a><span class="delimiter">(</span><a href="#794053" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#733826" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span> <a href="#785638" title="(x$1: GenMSIL.this.global.Symbol)Unit">entryPoint</a> = <a href="#794053" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#733826" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a> <span class="delimiter">}</span>
          <span title="Unit" class="keyword">if</span><span class="delimiter">(</span><a href="#785638" title="=&gt; GenMSIL.this.global.Symbol">entryPoint</a> <span title="(x$1: AnyRef)Boolean">==</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <span class="delimiter">{</span> <a href="../../Global.scala.html#559532" title="(msg: String)Unit">warning</a><span class="delimiter">(</span><span title="String(&quot;Couldn\'t find main method in class &quot;)" class="string">&quot;Couldn't find main method in class &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#794035" title="String">cfn</a><span class="delimiter">)</span> <span class="delimiter">}</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>

      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#785569" title="=&gt; String">firstSourceName</a> <span title="(x$1: AnyRef)Boolean">==</span> <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#785705" title="GenMSIL.this.global.icodes.IClass">cls</a>.<a href="../icode/Members.scala.html#642912" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443536" title="=&gt; GenMSIL.this.global.icodes.global.AbstractFileType">sourceFile</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> // is null for nested classes
          <a href="#785569" title="(x$1: String)Unit">firstSourceName</a> = <a href="#785705" title="GenMSIL.this.global.icodes.IClass">cls</a>.<a href="../icode/Members.scala.html#642912" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443536" title="=&gt; GenMSIL.this.global.icodes.global.AbstractFileType">sourceFile</a>.<a href="../../io/AbstractFile.scala.html#561676" title="=&gt; String">name</a>
    <span class="delimiter">}</span>

    // #####################################################################
    // get and create types

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(t: GenMSIL.this.global.icodes.TypeKind)ch.epfl.lamp.compiler.msil.Type" id="785645">msilType</a><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.TypeKind" id="789447">t</a>: <a href="../icode/TypeKinds.scala.html#642711" title="GenMSIL.this.global.icodes.TypeKind">TypeKind</a><span class="delimiter">)</span>: <span title="ch.epfl.lamp.compiler.msil.Type">MsilType</span> = <span class="delimiter">(</span><a href="#789447" title="GenMSIL.this.global.icodes.TypeKind">t</a>: @<a href="../icode/TypeKinds.scala.html#642711" title="GenMSIL.this.global.icodes.TypeKind @unchecked">unchecked</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#642717" title="ch.epfl.lamp.compiler.msil.Type" id="794106">UNIT</a>           =&gt; <a href="#794115" title="(x: ch.epfl.lamp.compiler.msil.Type)ch.epfl.lamp.compiler.msil.Type">MVOID</a>
      <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#642719" title="ch.epfl.lamp.compiler.msil.Type" id="794107">BOOL</a>           =&gt; <a href="#794115" title="(x: ch.epfl.lamp.compiler.msil.Type)ch.epfl.lamp.compiler.msil.Type">MBOOL</a>
      <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#642721" title="ch.epfl.lamp.compiler.msil.Type" id="794108">BYTE</a>           =&gt; <a href="#794115" title="(x: ch.epfl.lamp.compiler.msil.Type)ch.epfl.lamp.compiler.msil.Type">MBYTE</a>
      <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#642723" title="ch.epfl.lamp.compiler.msil.Type" id="794109">SHORT</a>          =&gt; <a href="#794115" title="(x: ch.epfl.lamp.compiler.msil.Type)ch.epfl.lamp.compiler.msil.Type">MSHORT</a>
      <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#642725" title="ch.epfl.lamp.compiler.msil.Type" id="794110">CHAR</a>           =&gt; <a href="#794115" title="(x: ch.epfl.lamp.compiler.msil.Type)ch.epfl.lamp.compiler.msil.Type">MCHAR</a>
      <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#642727" title="ch.epfl.lamp.compiler.msil.Type" id="794111">INT</a>            =&gt; <a href="#794115" title="(x: ch.epfl.lamp.compiler.msil.Type)ch.epfl.lamp.compiler.msil.Type">MINT</a>
      <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#642729" title="ch.epfl.lamp.compiler.msil.Type" id="794112">LONG</a>           =&gt; <a href="#794115" title="(x: ch.epfl.lamp.compiler.msil.Type)ch.epfl.lamp.compiler.msil.Type">MLONG</a>
      <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#642731" title="ch.epfl.lamp.compiler.msil.Type" id="794113">FLOAT</a>          =&gt; <a href="#794115" title="(x: ch.epfl.lamp.compiler.msil.Type)ch.epfl.lamp.compiler.msil.Type">MFLOAT</a>
      <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#642733" title="ch.epfl.lamp.compiler.msil.Type" id="794114">DOUBLE</a>         =&gt; <a href="#794115" title="(x: ch.epfl.lamp.compiler.msil.Type)ch.epfl.lamp.compiler.msil.Type">MDOUBLE</a>
      <span class="keyword">case</span> REFERENCE<a href="#794092" title="ch.epfl.lamp.compiler.msil.Type" id="794103" class="delimiter">(</a>cls<span class="delimiter">)</span> =&gt; <a href="#785648" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.Type">getType</a><a href="#794115" title="(x: ch.epfl.lamp.compiler.msil.Type)ch.epfl.lamp.compiler.msil.Type" class="delimiter">(</a>cls<span class="delimiter">)</span>
      <span class="keyword">case</span> ARRAY<a href="#794092" title="ch.epfl.lamp.compiler.msil.Type" id="794105" class="delimiter">(</a>elem<span class="delimiter">)</span>    =&gt;
        <a href="#785645" title="(t: GenMSIL.this.global.icodes.TypeKind)ch.epfl.lamp.compiler.msil.Type">msilType</a><a href="#794115" title="(x: ch.epfl.lamp.compiler.msil.Type)ch.epfl.lamp.compiler.msil.Type" class="delimiter">(</a>elem<span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
          // For type builders, cannot call &quot;clrTypes.mkArrayType&quot; because this looks up
          // the type &quot;tp&quot; in the assembly (not in the HashMap &quot;types&quot; of the backend).
          // This can fail for nested types because the builders are not complete yet.
          <span class="keyword">case</span> <a href="#794083" title="ch.epfl.lamp.compiler.msil.Type" id="794084">tb</a>: TypeBuilder =&gt; tb.<span title="()ch.epfl.lamp.compiler.msil.Type">MakeArrayType</span><a href="#794086" title="(x: ch.epfl.lamp.compiler.msil.Type)ch.epfl.lamp.compiler.msil.Type" class="delimiter">(</a><span class="delimiter">)</span>
          <span class="keyword">case</span> <a href="#794083" title="ch.epfl.lamp.compiler.msil.Type" id="794085">tp</a>: MsilType =&gt; <a href="../../symtab/SymbolLoaders.scala.html#650372" title="GenMSIL.this.global.loaders.clrTypes.type">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#730913" title="(elemType: ch.epfl.lamp.compiler.msil.Type)ch.epfl.lamp.compiler.msil.Type">mkArrayType</a><a href="#794086" title="(x: ch.epfl.lamp.compiler.msil.Type)ch.epfl.lamp.compiler.msil.Type" class="delimiter">(</a>tp<span class="delimiter">)</span>
        <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(tpe: GenMSIL.this.global.Type)ch.epfl.lamp.compiler.msil.Type" id="785646">msilType</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Type" id="789446">tpe</a>: <a href="../../../../reflect/internal/Types.scala.html#441242" title="GenMSIL.this.global.Type">Type</a><span class="delimiter">)</span>: <span title="ch.epfl.lamp.compiler.msil.Type">MsilType</span> = <a href="#785645" title="(t: GenMSIL.this.global.icodes.TypeKind)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">(</span><a href="../icode/TypeKinds.scala.html#642747" title="(t: GenMSIL.this.global.icodes.global.Type)GenMSIL.this.global.icodes.TypeKind">toTypeKind</a><span class="delimiter">(</span><a href="#789446" title="GenMSIL.this.global.Type">tpe</a><span class="delimiter">)</span><span class="delimiter">)</span>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol)Array[ch.epfl.lamp.compiler.msil.Type]" id="785647">msilParamTypes</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="794162">sym</a>: <a href="../../../../reflect/internal/Symbols.scala.html#441132" title="GenMSIL.this.global.Symbol">Symbol</a><span class="delimiter">)</span>: <a href="../../../../Array.scala.html#292" title="Array[ch.epfl.lamp.compiler.msil.Type]">Array</a><span class="delimiter">[</span>MsilType<span class="delimiter">]</span> = <span class="delimiter">{</span>
      <a href="#794162" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443425" title="=&gt; GenMSIL.this.global.Type">tpe</a>.<a href="../../../../reflect/internal/Types.scala.html#442010" title="=&gt; List[GenMSIL.this.global.Type]">paramTypes</a>.<a href="../../../../collection/TraversableLike.scala.html#58971" title="(f: GenMSIL.this.global.Type =&gt; ch.epfl.lamp.compiler.msil.Type)(implicit bf: scala.collection.generic.CanBuildFrom[List[GenMSIL.this.global.Type],ch.epfl.lamp.compiler.msil.Type,List[ch.epfl.lamp.compiler.msil.Type]])List[ch.epfl.lamp.compiler.msil.Type]">map</a><a href="../../../../collection/immutable/List.scala.html#63282" title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.List.Coll,ch.epfl.lamp.compiler.msil.Type,List[ch.epfl.lamp.compiler.msil.Type]]" class="delimiter">(</a><a href="#785646" title="(tpe: GenMSIL.this.global.Type)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">)</span>.<a href="../../../../collection/TraversableOnce.scala.html#59170" title="(implicit evidence$1: ArrayTag[ch.epfl.lamp.compiler.msil.Type])Array[ch.epfl.lamp.compiler.msil.Type]">toArray</a>
    <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.Type" id="785648">getType</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="789203">sym</a>: <a href="../../../../reflect/internal/Symbols.scala.html#441132" title="GenMSIL.this.global.Symbol">Symbol</a><span class="delimiter">)</span> = <a href="#785649" title="(sym: GenMSIL.this.global.Symbol)Option[ch.epfl.lamp.compiler.msil.Type]">getTypeOpt</a><span class="delimiter">(</span><a href="#789203" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span>.<a href="../../../../Option.scala.html#63814" title="(default: =&gt; ch.epfl.lamp.compiler.msil.Type)ch.epfl.lamp.compiler.msil.Type">getOrElse</a><span class="delimiter">(</span><a href="../../Global.scala.html#559537" title="(msg: String)Nothing">abort</a><span class="delimiter">(</span><a href="#785681" title="(sym: GenMSIL.this.global.Symbol)String">showsym</a><span class="delimiter">(</span><a href="#789203" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>

    /**
     * Get an MSIL type from a symbol. First look in the clrTypes.types map, then
     * lookup the name using clrTypes.getType
     */
    <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol)Option[ch.epfl.lamp.compiler.msil.Type]" id="785649">getTypeOpt</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="789204">sym</a>: <a href="../../../../reflect/internal/Symbols.scala.html#441132" title="GenMSIL.this.global.Symbol">Symbol</a><span class="delimiter">)</span>: <a href="../../../../Option.scala.html#1510" title="Option[ch.epfl.lamp.compiler.msil.Type]">Option</a><span class="delimiter">[</span>MsilType<span class="delimiter">]</span> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="Option[ch.epfl.lamp.compiler.msil.Type]" id="794241">tmp</a> = <a href="../../symtab/clr/CLRTypes.scala.html#730893" title="=&gt; scala.collection.mutable.Map[GenMSIL.this.global.loaders.clrTypes.global.Symbol,ch.epfl.lamp.compiler.msil.Type]">types</a>.<a href="../../../../collection/MapLike.scala.html#78410" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol)Option[ch.epfl.lamp.compiler.msil.Type]">get</a><span class="delimiter">(</span><a href="#789204" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span>
      <a href="#794241" title="Option[ch.epfl.lamp.compiler.msil.Type]">tmp</a> <span class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> typ @ Some<a href="#794263" title="Option[ch.epfl.lamp.compiler.msil.Type]" id="794265" class="delimiter">(</a>_<span class="delimiter">)</span> =&gt; <a href="#794268" title="(x: Option[ch.epfl.lamp.compiler.msil.Type])Option[ch.epfl.lamp.compiler.msil.Type]">typ</a>
        <span class="keyword">case</span> <a href="../../../../Option.scala.html#2498" title="Option[ch.epfl.lamp.compiler.msil.Type]" id="794267">None</a> =&gt;
          <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol)String" id="794246">typeString</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="794249">sym</a>: <a href="../../../../reflect/internal/Symbols.scala.html#441132" title="GenMSIL.this.global.Symbol">Symbol</a><span class="delimiter">)</span>: <span title="String">String</span> = <span class="delimiter">{</span>
            <span class="keyword">val</span> <a title="String" id="794250">s</a> = <span title="String" class="keyword">if</span> <span class="delimiter">(</span><a href="#794249" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443364" title="=&gt; Boolean">isNestedClass</a><span class="delimiter">)</span> <a href="#794246" title="(sym: GenMSIL.this.global.Symbol)String">typeString</a><span class="delimiter">(</span><a href="#794249" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443379" title="=&gt; GenMSIL.this.global.Symbol">owner</a><span class="delimiter">)</span> <span title="(x$1: Any)String">+</span><span title="String(&quot;+&quot;)" class="string">&quot;+&quot;</span><span title="(x$1: Any)String">+</span> <a href="#794249" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443544" title="=&gt; GenMSIL.this.global.Name">simpleName</a>
                    <span class="keyword">else</span> <a href="#794249" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443398" title="=&gt; String">fullName</a>
            <span title="String" class="keyword">if</span> <span class="delimiter">(</span><a href="#794249" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443245" title="=&gt; Boolean">isModuleClass</a> <a href="../../../../Boolean.scala.html#58725" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../../../Boolean.scala.html#58721" title="=&gt; Boolean">!</a><a href="#794249" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443249" title="=&gt; Boolean">isTrait</a><span class="delimiter">)</span> <a href="#794250" title="String">s</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;$&quot;)" class="string">&quot;$&quot;</span> <span class="keyword">else</span> <a href="#794250" title="String">s</a>
          <span class="delimiter">}</span>
          <span class="keyword">val</span> <a title="String" id="794247">name</a> = <a href="#794246" title="(sym: GenMSIL.this.global.Symbol)String">typeString</a><span class="delimiter">(</span><a href="#789204" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.Type" id="794248">typ</a> = <a href="../../symtab/SymbolLoaders.scala.html#650372" title="GenMSIL.this.global.loaders.clrTypes.type">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#730911" title="(name: String)ch.epfl.lamp.compiler.msil.Type">getType</a><span class="delimiter">(</span><a href="#794247" title="String">name</a><span class="delimiter">)</span>
          <span title="Option[ch.epfl.lamp.compiler.msil.Type]" class="keyword">if</span> <span class="delimiter">(</span><a href="#794248" title="ch.epfl.lamp.compiler.msil.Type">typ</a> <span title="(x$1: AnyRef)Boolean">==</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span>
            <a href="../../../../Option.scala.html#2498" title="None.type">None</a>
          <span class="keyword">else</span> <span class="delimiter">{</span>
            <a href="../../../../collection/mutable/MapLike.scala.html#78496" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol, value: ch.epfl.lamp.compiler.msil.Type)Unit">types</a><span class="delimiter">(</span><a href="#789204" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span> = <a href="#794248" title="ch.epfl.lamp.compiler.msil.Type">typ</a>
            <a href="../../../../Option.scala.html#64111" title="(x: ch.epfl.lamp.compiler.msil.Type)Some[ch.epfl.lamp.compiler.msil.Type]">Some</a><span class="delimiter">(</span><a href="#794248" title="ch.epfl.lamp.compiler.msil.Type">typ</a><span class="delimiter">)</span>
          <span class="delimiter">}</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol, mType: ch.epfl.lamp.compiler.msil.Type)Unit" id="785650">mapType</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="786509">sym</a>: <a href="../../../../reflect/internal/Symbols.scala.html#441132" title="GenMSIL.this.global.Symbol">Symbol</a>, <a title="ch.epfl.lamp.compiler.msil.Type" id="786510">mType</a>: <span title="ch.epfl.lamp.compiler.msil.Type">MsilType</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="../../Global.scala.html#559533" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a><span class="delimiter">(</span><a href="#786510" title="ch.epfl.lamp.compiler.msil.Type">mType</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span>, <a href="#785681" title="(sym: GenMSIL.this.global.Symbol)String">showsym</a><span class="delimiter">(</span><a href="#786509" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="../../../../collection/mutable/MapLike.scala.html#78496" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol, value: ch.epfl.lamp.compiler.msil.Type)Unit">types</a><span class="delimiter">(</span><a href="#786509" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span> = <a href="#786510" title="ch.epfl.lamp.compiler.msil.Type">mType</a>
    <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="(iclass: GenMSIL.this.global.icodes.IClass)Unit" id="785651">createTypeBuilder</a><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.IClass" id="785803">iclass</a>: <a href="../icode/Members.scala.html#642676" title="GenMSIL.this.global.icodes.IClass">IClass</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      /**
       * First look in the clrTypes.types map, if that fails check if it's a class being compiled, otherwise
       * lookup by name (clrTypes.getType calls the static method msil.Type.GetType(fullname)).
       */
      <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.Type" id="794283">msilTypeFromSym</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="794291">sym</a>: <a href="../../../../reflect/internal/Symbols.scala.html#441132" title="GenMSIL.this.global.Symbol">Symbol</a><span class="delimiter">)</span>: <span title="ch.epfl.lamp.compiler.msil.Type">MsilType</span> = <span class="delimiter">{</span>
        <a href="../../symtab/clr/CLRTypes.scala.html#730893" title="=&gt; scala.collection.mutable.Map[GenMSIL.this.global.loaders.clrTypes.global.Symbol,ch.epfl.lamp.compiler.msil.Type]">types</a>.<a href="../../../../collection/MapLike.scala.html#78410" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol)Option[ch.epfl.lamp.compiler.msil.Type]">get</a><span class="delimiter">(</span><a href="#794291" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span>.<a href="../../../../Option.scala.html#63814" title="(default: =&gt; ch.epfl.lamp.compiler.msil.Type)ch.epfl.lamp.compiler.msil.Type">getOrElse</a> <span class="delimiter">{</span>
          <a href="../icode/ICodes.scala.html#642629" title="=&gt; scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.global.Symbol,GenMSIL.this.global.icodes.IClass]">classes</a>.<a href="../../../../collection/mutable/HashMap.scala.html#79207" title="(key: GenMSIL.this.global.icodes.global.Symbol)Option[GenMSIL.this.global.icodes.IClass]">get</a><a href="#794305" title="(x: ch.epfl.lamp.compiler.msil.Type)ch.epfl.lamp.compiler.msil.Type" class="delimiter">(</a><a href="#794291" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
            <span class="keyword">case</span> Some<a href="#794301" title="ch.epfl.lamp.compiler.msil.Type" id="794302" class="delimiter">(</a>iclass<span class="delimiter">)</span> =&gt;
	              <a href="#794284" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.emit.TypeBuilder">msilTypeBuilderFromSym</a><a href="#794305" title="(x: ch.epfl.lamp.compiler.msil.Type)ch.epfl.lamp.compiler.msil.Type" class="delimiter">(</a><a href="#794291" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span>
            <span class="keyword">case</span> <a href="../../../../Option.scala.html#2498" title="ch.epfl.lamp.compiler.msil.Type" id="794304">None</a> =&gt;
              <a href="#785648" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.Type">getType</a><a href="#794305" title="(x: ch.epfl.lamp.compiler.msil.Type)ch.epfl.lamp.compiler.msil.Type" class="delimiter">(</a><a href="#794291" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span>
          <span class="delimiter">}</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>

      <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.emit.TypeBuilder" id="794284">msilTypeBuilderFromSym</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="794299">sym</a>: <a href="../../../../reflect/internal/Symbols.scala.html#441132" title="GenMSIL.this.global.Symbol">Symbol</a><span class="delimiter">)</span>: <span title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">TypeBuilder</span> = <span class="delimiter">{</span>
        <span title="Unit" class="keyword">if</span><span class="delimiter">(</span><a href="../../../../Boolean.scala.html#58721" title="=&gt; Boolean">!</a><span class="delimiter">(</span><a href="../../symtab/clr/CLRTypes.scala.html#730893" title="=&gt; scala.collection.mutable.Map[GenMSIL.this.global.loaders.clrTypes.global.Symbol,ch.epfl.lamp.compiler.msil.Type]">types</a>.<a href="../../../../collection/MapLike.scala.html#78421" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol)Boolean">contains</a><span class="delimiter">(</span><a href="#794299" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span> <a href="../../../../Boolean.scala.html#58725" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../../../collection/MapLike.scala.html#78420" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol)ch.epfl.lamp.compiler.msil.Type">types</a><span class="delimiter">(</span><a href="#794299" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span>.<span title="[T0]=&gt; Boolean">isInstanceOf</span><span title="Boolean" class="delimiter">[</span><span title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">TypeBuilder</span><span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">{</span>
          <span class="keyword">val</span> <a title="GenMSIL.this.global.icodes.IClass" id="794331">iclass</a> = <a href="../../../../collection/mutable/HashMap.scala.html#79206" title="(key: GenMSIL.this.global.icodes.global.Symbol)GenMSIL.this.global.icodes.IClass">classes</a><span class="delimiter">(</span><a href="#794299" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span>
          <a href="../../Global.scala.html#559534" title="(assertion: Boolean)Unit">assert</a><span class="delimiter">(</span><a href="#794331" title="GenMSIL.this.global.icodes.IClass">iclass</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span>
          <a href="#785651" title="(iclass: GenMSIL.this.global.icodes.IClass)Unit">createTypeBuilder</a><span class="delimiter">(</span><a href="#794331" title="GenMSIL.this.global.icodes.IClass">iclass</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
        <a href="../../../../collection/MapLike.scala.html#78420" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol)ch.epfl.lamp.compiler.msil.Type">types</a><span class="delimiter">(</span><a href="#794299" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder" class="delimiter">[</span><span title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">TypeBuilder</span><span class="delimiter">]</span>
      <span class="delimiter">}</span>

      <span class="keyword">val</span> <a title="GenMSIL.this.global.icodes.global.Symbol" id="794285">sym</a> = <a href="#785803" title="GenMSIL.this.global.icodes.IClass">iclass</a>.<a href="../icode/Members.scala.html#642912" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../symtab/clr/CLRTypes.scala.html#730893" title="=&gt; scala.collection.mutable.Map[GenMSIL.this.global.loaders.clrTypes.global.Symbol,ch.epfl.lamp.compiler.msil.Type]">types</a>.<a href="../../../../collection/MapLike.scala.html#78421" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol)Boolean">contains</a><span class="delimiter">(</span><a href="#794285" title="GenMSIL.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span> <a href="../../../../Boolean.scala.html#58725" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../../../collection/MapLike.scala.html#78420" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol)ch.epfl.lamp.compiler.msil.Type">types</a><span class="delimiter">(</span><a href="#794285" title="GenMSIL.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span>.<span title="[T0]=&gt; Boolean">isInstanceOf</span><span title="Boolean" class="delimiter">[</span><span title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">TypeBuilder</span><span class="delimiter">]</span><span class="delimiter">)</span>
        <span title="Nothing" class="keyword">return</span>

      <span class="keyword">def</span> <a title="(s: GenMSIL.this.global.Symbol)Boolean" id="794286">isInterface</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="794388">s</a>: <a href="../../../../reflect/internal/Symbols.scala.html#441132" title="GenMSIL.this.global.Symbol">Symbol</a><span class="delimiter">)</span> = <a href="#794388" title="GenMSIL.this.global.Symbol">s</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443249" title="=&gt; Boolean">isTrait</a> <a href="../../../../Boolean.scala.html#58725" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../../../Boolean.scala.html#58721" title="=&gt; Boolean">!</a><a href="#794388" title="GenMSIL.this.global.Symbol">s</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443243" title="=&gt; Boolean">isImplClass</a>
      <span class="keyword">val</span> <a title="List[GenMSIL.this.global.Type]" id="794287">parents</a>: <a href="../../../../collection/immutable/List.scala.html#12322" title="List[GenMSIL.this.global.Type]">List</a><span class="delimiter">[</span>Type<span class="delimiter">]</span> =
        <span title="List[GenMSIL.this.global.Type]" class="keyword">if</span> <span class="delimiter">(</span><a href="#794285" title="GenMSIL.this.global.icodes.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443427" title="=&gt; GenMSIL.this.global.icodes.global.Type">info</a>.<a href="../../../../reflect/internal/Types.scala.html#441995" title="=&gt; List[GenMSIL.this.global.icodes.global.Type]">parents</a>.<a href="../../../../collection/IterableLike.scala.html#59464" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <a href="../../../../collection/immutable/List.scala.html#63291" title="(xs: GenMSIL.this.global.Type*)List[GenMSIL.this.global.Type]">List</a><span class="delimiter">(</span><a href="../../../../reflect/internal/Definitions.scala.html#441641" title="GenMSIL.this.global.definitions.type">definitions</a>.<a href="../../../../reflect/internal/Definitions.scala.html#442179" title="=&gt; GenMSIL.this.global.ClassSymbol">ObjectClass</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443721" title="=&gt; GenMSIL.this.global.Type">tpe</a><span class="delimiter">)</span>
        <span class="keyword">else</span> <a href="#794285" title="GenMSIL.this.global.icodes.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443427" title="=&gt; GenMSIL.this.global.icodes.global.Type">info</a>.<a href="../../../../reflect/internal/Types.scala.html#441995" title="=&gt; List[GenMSIL.this.global.icodes.global.Type]">parents</a>.<a href="../../../../collection/SeqLike.scala.html#59789" title="=&gt; List[GenMSIL.this.global.icodes.global.Type]">distinct</a>

      <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.Type" id="794288">superType</a> : <span title="ch.epfl.lamp.compiler.msil.Type">MsilType</span> = <span title="ch.epfl.lamp.compiler.msil.Type" class="keyword">if</span> <span class="delimiter">(</span><a href="#794286" title="(s: GenMSIL.this.global.Symbol)Boolean">isInterface</a><span class="delimiter">(</span><a href="#794285" title="GenMSIL.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span><span class="delimiter">)</span> <span title="Null(null)" class="keyword">null</span> <span class="keyword">else</span> <a href="#794283" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.Type">msilTypeFromSym</a><span class="delimiter">(</span><a href="#794287" title="List[GenMSIL.this.global.Type]">parents</a>.<a href="../../../../collection/IterableLike.scala.html#59473" title="=&gt; GenMSIL.this.global.Type">head</a>.<a href="../../../../reflect/internal/Types.scala.html#441986" title="=&gt; GenMSIL.this.global.Symbol">typeSymbol</a><span class="delimiter">)</span>
      <a href="../../Global.scala.html#559553" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><span title="String(&quot;super type: &quot;)" class="string">&quot;super type: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="../../../../collection/LinearSeqOptimized.scala.html#76165" title="(n: Int)GenMSIL.this.global.Type">parents</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>.<a href="../../../../reflect/internal/Types.scala.html#441986" title="=&gt; GenMSIL.this.global.Symbol">typeSymbol</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;, msil type: &quot;)" class="string">&quot;, msil type: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#794288" title="ch.epfl.lamp.compiler.msil.Type">superType</a><span class="delimiter">)</span>

      <span class="keyword">val</span> <a title="Array[ch.epfl.lamp.compiler.msil.Type]" id="794289">interfaces</a>: <a href="../../../../Array.scala.html#292" title="Array[ch.epfl.lamp.compiler.msil.Type]">Array</a><span class="delimiter">[</span>MsilType<span class="delimiter">]</span> =
	<a href="#794287" title="List[GenMSIL.this.global.Type]">parents</a>.<a href="../../../../collection/TraversableLike.scala.html#59012" title="=&gt; List[GenMSIL.this.global.Type]">tail</a>.<a href="../../../../collection/TraversableLike.scala.html#58971" title="(f: GenMSIL.this.global.Type =&gt; ch.epfl.lamp.compiler.msil.Type)(implicit bf: scala.collection.generic.CanBuildFrom[List[GenMSIL.this.global.Type],ch.epfl.lamp.compiler.msil.Type,List[ch.epfl.lamp.compiler.msil.Type]])List[ch.epfl.lamp.compiler.msil.Type]">map</a><a href="../../../../collection/immutable/List.scala.html#63282" title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.List.Coll,ch.epfl.lamp.compiler.msil.Type,List[ch.epfl.lamp.compiler.msil.Type]]" class="delimiter">(</a><a title="GenMSIL.this.global.Type" id="794432">p</a> =&gt; <a href="#794283" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.Type">msilTypeFromSym</a><span class="delimiter">(</span><a href="#794432" title="GenMSIL.this.global.Type">p</a>.<a href="../../../../reflect/internal/Types.scala.html#441986" title="=&gt; GenMSIL.this.global.Symbol">typeSymbol</a><span class="delimiter">)</span><span class="delimiter">)</span>.<a href="../../../../collection/TraversableOnce.scala.html#59170" title="(implicit evidence$1: ArrayTag[ch.epfl.lamp.compiler.msil.Type])Array[ch.epfl.lamp.compiler.msil.Type]">toArray</a>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#794287" title="List[GenMSIL.this.global.Type]">parents</a>.<a href="../../../../collection/LinearSeqOptimized.scala.html#76164" title="=&gt; Int">length</a> <a href="../../../../Int.scala.html#57919" title="(x: Int)Boolean">&gt;</a> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../Global.scala.html#559485" title="=&gt; scala.tools.nsc.Settings">settings</a>.<a href="../../settings/ScalaSettings.scala.html#467500" title="=&gt; scala.tools.nsc.Settings#BooleanSetting">debug</a>.<a href="../../settings/MutableSettings.scala.html#467820" title="=&gt; Boolean">value</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="../../Global.scala.html#559552" title="(msg: =&gt; AnyRef)Unit">log</a><span class="delimiter">(</span><span title="String(&quot;interfaces:&quot;)" class="string">&quot;interfaces:&quot;</span><span class="delimiter">)</span>
          <span class="keyword">for</span> <span class="delimiter">(</span><a title="Int" id="794590">i</a> &lt;- <a href="../../../../LowPriorityImplicits.scala.html#8333" title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">0</a>.<a href="../../../../runtime/RichInt.scala.html#57854" title="(end: Int)scala.collection.immutable.Range">until</a><a href="../../../../collection/immutable/Range.scala.html#69665" title="(f: Int =&gt; Unit)Unit" class="delimiter">(</a><a href="#794289" title="Array[ch.epfl.lamp.compiler.msil.Type]">interfaces</a>.<a href="../../../../Array.scala.html#57449" title="=&gt; Int">length</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
            <a href="../../Global.scala.html#559552" title="(msg: =&gt; AnyRef)Unit">log</a><span class="delimiter">(</span><span title="String(&quot;  type: &quot;)" class="string">&quot;  type: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="../../../../collection/LinearSeqOptimized.scala.html#76165" title="(n: Int)GenMSIL.this.global.Type">parents</a><span class="delimiter">(</span><a href="#794590" title="Int">i</a> <a href="../../../../Int.scala.html#57948" title="(x: Int)Int">+</a> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>.<a href="../../../../reflect/internal/Types.scala.html#441986" title="=&gt; GenMSIL.this.global.Symbol">typeSymbol</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;, msil type: &quot;)" class="string">&quot;, msil type: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="../../../../Array.scala.html#57450" title="(i: Int)ch.epfl.lamp.compiler.msil.Type">interfaces</a><span class="delimiter">(</span><a href="#794590" title="Int">i</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <span class="delimiter">}</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>

      <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder" id="794290">tBuilder</a> = <span title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder" class="keyword">if</span> <span class="delimiter">(</span><a href="#794285" title="GenMSIL.this.global.icodes.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443364" title="=&gt; Boolean">isNestedClass</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder" id="794604">ownerT</a> = <a href="#794284" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.emit.TypeBuilder">msilTypeBuilderFromSym</a><span class="delimiter">(</span><a href="#794285" title="GenMSIL.this.global.icodes.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443379" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">owner</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder" class="delimiter">[</span><span title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">TypeBuilder</span><span class="delimiter">]</span>
        <a href="#794604" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">ownerT</a>.<span title="(name: String, attributes: Int, baseType: ch.epfl.lamp.compiler.msil.Type, interfaces: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.emit.TypeBuilder">DefineNestedType</span><span class="delimiter">(</span><a href="#785633" title="(sym: GenMSIL.this.global.Symbol)String">msilName</a><span class="delimiter">(</span><a href="#794285" title="GenMSIL.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span>, <a href="#785634" title="(sym: GenMSIL.this.global.Symbol)Int">msilTypeFlags</a><span class="delimiter">(</span><a href="#794285" title="GenMSIL.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span>, <a href="#794288" title="ch.epfl.lamp.compiler.msil.Type">superType</a>, <a href="#794289" title="Array[ch.epfl.lamp.compiler.msil.Type]">interfaces</a><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
        <a href="#785560" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ModuleBuilder">mmodule</a>.<span title="(typeName: String, attributes: Int, baseType: ch.epfl.lamp.compiler.msil.Type, interfaces: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.emit.TypeBuilder">DefineType</span><span class="delimiter">(</span><a href="#785633" title="(sym: GenMSIL.this.global.Symbol)String">msilName</a><span class="delimiter">(</span><a href="#794285" title="GenMSIL.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span>, <a href="#785634" title="(sym: GenMSIL.this.global.Symbol)Int">msilTypeFlags</a><span class="delimiter">(</span><a href="#794285" title="GenMSIL.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span>, <a href="#794288" title="ch.epfl.lamp.compiler.msil.Type">superType</a>, <a href="#794289" title="Array[ch.epfl.lamp.compiler.msil.Type]">interfaces</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
      <a href="#785650" title="(sym: GenMSIL.this.global.Symbol, mType: ch.epfl.lamp.compiler.msil.Type)Unit">mapType</a><span class="delimiter">(</span><a href="#794285" title="GenMSIL.this.global.icodes.global.Symbol">sym</a>, <a href="#794290" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">tBuilder</a><span class="delimiter">)</span>
    <span class="delimiter">}</span> // createTypeBuilder

    <span class="keyword">def</span> <a title="(iclass: GenMSIL.this.global.icodes.IClass)Unit" id="785652">createClassMembers</a><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.IClass" id="785817">iclass</a>: <a href="../icode/Members.scala.html#642676" title="GenMSIL.this.global.icodes.IClass">IClass</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="keyword">try</span> <span class="delimiter">{</span>
        <a href="#785653" title="(iclass: GenMSIL.this.global.icodes.IClass)Unit">createClassMembers0</a><span class="delimiter">(</span><a href="#785817" title="GenMSIL.this.global.icodes.IClass">iclass</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
      <span class="keyword">catch</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <a title="Nothing" id="794608">e</a>: <span title="Throwable">Throwable</span> =&gt;
          java.lang.<span title="System.type">System</span>.<span title="java.io.PrintStream">err</span>.<span title="(x$1: String)Unit">println</span><span class="delimiter">(</span><a href="#785681" title="(sym: GenMSIL.this.global.Symbol)String">showsym</a><span class="delimiter">(</span><a href="#785817" title="GenMSIL.this.global.icodes.IClass">iclass</a>.<a href="../icode/Members.scala.html#642912" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a><span class="delimiter">)</span><span class="delimiter">)</span>
          java.lang.<span title="System.type">System</span>.<span title="java.io.PrintStream">err</span>.<span title="(x$1: String)Unit">println</span><span class="delimiter">(</span><span title="String(&quot;with methods = &quot;)" class="string">&quot;with methods = &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#785817" title="GenMSIL.this.global.icodes.IClass">iclass</a>.<a href="../icode/Members.scala.html#642918" title="=&gt; List[GenMSIL.this.global.icodes.IMethod]">methods</a><span class="delimiter">)</span>
          <span title="Nothing" class="keyword">throw</span> <a href="#794608" title="Throwable">e</a>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="(iclass: GenMSIL.this.global.icodes.IClass)Unit" id="785653">createClassMembers0</a><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.IClass" id="794607">iclass</a>: <a href="../icode/Members.scala.html#642676" title="GenMSIL.this.global.icodes.IClass">IClass</a><span class="delimiter">)</span> <span class="delimiter">{</span>

      <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder" id="794618">mtype</a> = <a href="#785648" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.Type">getType</a><span class="delimiter">(</span><a href="#794607" title="GenMSIL.this.global.icodes.IClass">iclass</a>.<a href="../icode/Members.scala.html#642912" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder" class="delimiter">[</span><span title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">TypeBuilder</span><span class="delimiter">]</span>

      <span class="keyword">for</span> <span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.IField" id="794644">ifield</a> &lt;- <a href="#794607" title="GenMSIL.this.global.icodes.IClass">iclass</a>.<a href="../../../../collection/LinearSeqOptimized.scala.html#76166" title="(f: GenMSIL.this.global.icodes.IField =&gt; Unit)Unit">fields</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="GenMSIL.this.global.icodes.global.Symbol" id="794645">sym</a> = <a href="#794644" title="GenMSIL.this.global.icodes.IField">ifield</a>.<a href="../icode/Members.scala.html#747583" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a>
        <a href="../../Global.scala.html#559553" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><span title="String(&quot;Adding field: &quot;)" class="string">&quot;Adding field: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#794645" title="GenMSIL.this.global.icodes.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443398" title="=&gt; String">fullName</a><span class="delimiter">)</span>

        <span class="keyword">var</span> <a title="Short" id="794646">attributes</a> = <a href="#785636" title="(sym: GenMSIL.this.global.Symbol)Short">msilFieldFlags</a><span class="delimiter">(</span><a href="#794645" title="GenMSIL.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.util.PECustomMod" id="794647">fieldTypeWithCustomMods</a> =
          <span title="ch.epfl.lamp.compiler.msil.util.PECustomMod" class="keyword">new</span> <span title="ch.epfl.lamp.compiler.msil.util.PECustomMod">PECustomMod</span><span class="delimiter">(</span><a href="#785646" title="(tpe: GenMSIL.this.global.Type)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">(</span><a href="#794645" title="GenMSIL.this.global.icodes.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443425" title="=&gt; GenMSIL.this.global.icodes.global.Type">tpe</a><span class="delimiter">)</span>,
                          <a href="#785583" title="(annotations: List[GenMSIL.this.global.AnnotationInfo])Array[ch.epfl.lamp.compiler.msil.CustomModifier]">customModifiers</a><span class="delimiter">(</span><a href="#794645" title="GenMSIL.this.global.icodes.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443459" title="=&gt; List[GenMSIL.this.global.icodes.global.AnnotationInfo]">annotations</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.FieldBuilder" id="794648">fBuilder</a> = <a href="#794618" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">mtype</a>.<span title="(name: String, fieldTypeWithMods: ch.epfl.lamp.compiler.msil.util.PECustomMod, attrs: Short)ch.epfl.lamp.compiler.msil.emit.FieldBuilder">DefineField</span><span class="delimiter">(</span><a href="#785633" title="(sym: GenMSIL.this.global.Symbol)String">msilName</a><span class="delimiter">(</span><a href="#794645" title="GenMSIL.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span>,
                                         <a href="#794647" title="ch.epfl.lamp.compiler.msil.util.PECustomMod">fieldTypeWithCustomMods</a>,
                                         <a href="#794646" title="Short">attributes</a><span class="delimiter">)</span>
        <a href="../../../../collection/mutable/MapLike.scala.html#78496" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol, value: ch.epfl.lamp.compiler.msil.FieldInfo)Unit">fields</a><span class="delimiter">(</span><a href="#794645" title="GenMSIL.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span> = <a href="#794648" title="ch.epfl.lamp.compiler.msil.emit.FieldBuilder">fBuilder</a>
        <a href="#785582" title="(member: ch.epfl.lamp.compiler.msil.emit.ICustomAttributeSetter, annotations: List[GenMSIL.this.global.AnnotationInfo])Unit">addAttributes</a><span class="delimiter">(</span><a href="#794648" title="ch.epfl.lamp.compiler.msil.emit.FieldBuilder">fBuilder</a>, <a href="#794645" title="GenMSIL.this.global.icodes.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443459" title="=&gt; List[GenMSIL.this.global.icodes.global.AnnotationInfo]">annotations</a><span class="delimiter">)</span>
      <span class="delimiter">}</span> // all iclass.fields iterated over

      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#785655" title="(sym: GenMSIL.this.global.Symbol)Boolean">isStaticModule</a><span class="delimiter">(</span><a href="#794607" title="GenMSIL.this.global.icodes.IClass">iclass</a>.<a href="../icode/Members.scala.html#642912" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="Option[GenMSIL.this.global.icodes.IMethod]" id="794664">sc</a> = <a href="#794607" title="GenMSIL.this.global.icodes.IClass">iclass</a>.<a href="../icode/Members.scala.html#642931" title="=&gt; Option[GenMSIL.this.global.icodes.IMethod]">lookupStaticCtor</a>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#794664" title="Option[GenMSIL.this.global.icodes.IMethod]">sc</a>.<a href="../../../../Option.scala.html#63812" title="=&gt; Boolean">isDefined</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <span class="keyword">val</span> <a title="GenMSIL.this.global.icodes.IMethod" id="794665">m</a> = <a href="#794664" title="Option[GenMSIL.this.global.icodes.IMethod]">sc</a>.<a href="../../../../Option.scala.html#63813" title="=&gt; GenMSIL.this.global.icodes.IMethod">get</a>
          <span class="keyword">val</span> <a title="GenMSIL.this.global.icodes.BasicBlock" id="794666">oldLastBlock</a> = <a href="#794665" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#733834" title="=&gt; GenMSIL.this.global.icodes.BasicBlock">lastBlock</a>
          <span class="keyword">val</span> <a title="GenMSIL.this.global.icodes.BasicBlock" id="794667">lastBlock</a> = <a href="#794665" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#733832" title="()GenMSIL.this.global.icodes.BasicBlock">newBlock</a><span class="delimiter">(</span><span class="delimiter">)</span>
          <a href="#794666" title="GenMSIL.this.global.icodes.BasicBlock">oldLastBlock</a>.<a href="../icode/BasicBlocks.scala.html#733780" title="(pos: Int, instr: GenMSIL.this.global.icodes.Instruction)Boolean">replaceInstruction</a><span class="delimiter">(</span><a href="#794666" title="GenMSIL.this.global.icodes.BasicBlock">oldLastBlock</a>.<a href="../icode/BasicBlocks.scala.html#733777" title="=&gt; Int">length</a> <a href="../../../../Int.scala.html#57955" title="(x: Int)Int">-</a> <span title="Int(1)" class="int">1</span>, <a href="../icode/Opcodes.scala.html#739145" title="(whereto: GenMSIL.this.global.icodes.BasicBlock)GenMSIL.this.global.icodes.opcodes.JUMP">JUMP</a><span class="delimiter">(</span><a href="#794667" title="GenMSIL.this.global.icodes.BasicBlock">lastBlock</a><span class="delimiter">)</span><span class="delimiter">)</span>
          // call object's private ctor from static ctor
          <a href="#794667" title="GenMSIL.this.global.icodes.BasicBlock">lastBlock</a>.<a href="../icode/BasicBlocks.scala.html#733787" title="(instr: GenMSIL.this.global.icodes.Instruction)Unit">emit</a><span class="delimiter">(</span><a href="../icode/Opcodes.scala.html#744908" title="(method: GenMSIL.this.global.icodes.global.Symbol)GenMSIL.this.global.icodes.opcodes.CIL_NEWOBJ">CIL_NEWOBJ</a><span class="delimiter">(</span><a href="#794607" title="GenMSIL.this.global.icodes.IClass">iclass</a>.<a href="../icode/Members.scala.html#642912" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443482" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">primaryConstructor</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <a href="#794667" title="GenMSIL.this.global.icodes.BasicBlock">lastBlock</a>.<a href="../icode/BasicBlocks.scala.html#733787" title="(instr: GenMSIL.this.global.icodes.Instruction)Unit">emit</a><span class="delimiter">(</span><a href="../icode/Opcodes.scala.html#742869" title="(typ: GenMSIL.this.global.icodes.TypeKind)GenMSIL.this.global.icodes.opcodes.DROP">DROP</a><span class="delimiter">(</span><a href="../icode/TypeKinds.scala.html#642747" title="(t: GenMSIL.this.global.icodes.global.Type)GenMSIL.this.global.icodes.TypeKind">toTypeKind</a><span class="delimiter">(</span><a href="#794607" title="GenMSIL.this.global.icodes.IClass">iclass</a>.<a href="../icode/Members.scala.html#642912" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443425" title="=&gt; GenMSIL.this.global.icodes.global.Type">tpe</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
          <a href="#794667" title="GenMSIL.this.global.icodes.BasicBlock">lastBlock</a> <a href="../icode/BasicBlocks.scala.html#733787" title="(instr: GenMSIL.this.global.icodes.Instruction)Unit">emit</a> <a href="../icode/Opcodes.scala.html#739174" title="(kind: GenMSIL.this.global.icodes.TypeKind)GenMSIL.this.global.icodes.opcodes.RETURN">RETURN</a><span class="delimiter">(</span><a href="../icode/TypeKinds.scala.html#642717" title="GenMSIL.this.global.icodes.UNIT.type">UNIT</a><span class="delimiter">)</span>
          <a href="#794667" title="GenMSIL.this.global.icodes.BasicBlock">lastBlock</a>.<a href="../icode/BasicBlocks.scala.html#733793" title="()Unit">close</a>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>

      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#794607" title="GenMSIL.this.global.icodes.IClass">iclass</a>.<a href="../icode/Members.scala.html#642912" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a> <span title="(x$1: AnyRef)Boolean">!=</span> <a href="../../../../reflect/internal/Definitions.scala.html#441641" title="GenMSIL.this.global.definitions.type">definitions</a>.<a href="../../../../reflect/internal/Definitions.scala.html#442352" title="=&gt; GenMSIL.this.global.ClassSymbol">ArrayClass</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="keyword">for</span> <span class="delimiter">(</span><a href="#794720" title="Boolean" id="794738">m</a>: <a href="../icode/Members.scala.html#642680" title="GenMSIL.this.global.icodes.IMethod">IMethod</a> &lt;- <a href="#794607" title="GenMSIL.this.global.icodes.IClass">iclass</a>.<a href="../../../../collection/generic/FilterMonadic.scala.html#59082" title="(f: GenMSIL.this.global.icodes.IMethod =&gt; Unit)Unit" id="794716">methods</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="GenMSIL.this.global.icodes.global.Symbol" id="794739">sym</a> = <a href="#794738" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#733826" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a>
        <a href="../../Global.scala.html#559553" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><span title="String(&quot;Creating MethodBuilder for &quot;)" class="string">&quot;Creating MethodBuilder for &quot;</span> <span title="(x$1: Any)String">+</span> <a href="../../symtab/package.scala.html#57302" title="=&gt; reflect.internal.Flags.type">Flags</a>.<a href="../../../../reflect/internal/Flags.scala.html#441022" title="(flags: Long)String">flagsToString</a><span class="delimiter">(</span><a href="#794739" title="GenMSIL.this.global.icodes.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443310" title="=&gt; Long">flags</a><span class="delimiter">)</span> <span title="(x$1: Any)String">+</span> <span title="String(&quot; &quot;)" class="string">&quot; &quot;</span> <span title="(x$1: Any)String">+</span>
              <a href="#794739" title="GenMSIL.this.global.icodes.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443379" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">owner</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443398" title="=&gt; String">fullName</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;::&quot;)" class="string">&quot;::&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#794739" title="GenMSIL.this.global.icodes.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443152" title="=&gt; sym.NameType">name</a><span class="delimiter">)</span>

        <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder" id="794740">ownerType</a> = <a href="#785648" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.Type">getType</a><span class="delimiter">(</span><a href="#794739" title="GenMSIL.this.global.icodes.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443480" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">enclClass</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder" class="delimiter">[</span><span title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">TypeBuilder</span><span class="delimiter">]</span>
        <a href="../../Global.scala.html#559533" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a><span class="delimiter">(</span><a href="#794618" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">mtype</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#794740" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">ownerType</a>, <span title="String(&quot;mtype = &quot;)" class="string">&quot;mtype = &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#794618" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">mtype</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;; ownerType = &quot;)" class="string">&quot;; ownerType = &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#794740" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">ownerType</a><span class="delimiter">)</span>
        <span class="keyword">var</span> <a title="Array[ch.epfl.lamp.compiler.msil.Type]" id="794741">paramTypes</a> = <a href="#785647" title="(sym: GenMSIL.this.global.Symbol)Array[ch.epfl.lamp.compiler.msil.Type]">msilParamTypes</a><span class="delimiter">(</span><a href="#794739" title="GenMSIL.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="Short" id="794742">attr</a> = <a href="#785635" title="(sym: GenMSIL.this.global.Symbol)Short">msilMethodFlags</a><span class="delimiter">(</span><a href="#794739" title="GenMSIL.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span>

        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#794738" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#733826" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443264" title="=&gt; Boolean">isClassConstructor</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.ConstructorBuilder" id="794755">constr</a> =
            <a href="#794740" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">ownerType</a>.<span title="(attrs: Short, callingConvention: Short, paramTypes: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.emit.ConstructorBuilder">DefineConstructor</span><span class="delimiter">(</span><a href="#794742" title="Short">attr</a>, CallingConventions.<span title="Short(1)">Standard</span>, <a href="#794741" title="Array[ch.epfl.lamp.compiler.msil.Type]">paramTypes</a><span class="delimiter">)</span>
          <span class="keyword">for</span> <span class="delimiter">(</span><a title="Int" id="794862">i</a> &lt;- <a href="../../../../LowPriorityImplicits.scala.html#8333" title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">0</a>.<a href="../../../../runtime/RichInt.scala.html#57854" title="(end: Int)scala.collection.immutable.Range">until</a><a href="../../../../collection/immutable/Range.scala.html#69665" title="(f: Int =&gt; ch.epfl.lamp.compiler.msil.emit.ParameterBuilder)Unit" class="delimiter">(</a><a href="#794741" title="Array[ch.epfl.lamp.compiler.msil.Type]">paramTypes</a>.<a href="../../../../Array.scala.html#57449" title="=&gt; Int">length</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
            <a href="#794755" title="ch.epfl.lamp.compiler.msil.emit.ConstructorBuilder">constr</a>.<span title="(pos: Int, attr: Int, name: String)ch.epfl.lamp.compiler.msil.emit.ParameterBuilder">DefineParameter</span><span class="delimiter">(</span><a href="#794862" title="Int">i</a>, ParameterAttributes.<span title="Int(0)">None</span>, <a href="#785633" title="(sym: GenMSIL.this.global.Symbol)String">msilName</a><span class="delimiter">(</span><a href="#794738" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../../../../collection/LinearSeqOptimized.scala.html#76165" title="(n: Int)GenMSIL.this.global.icodes.Local">params</a><span class="delimiter">(</span><a href="#794862" title="Int">i</a><span class="delimiter">)</span>.<a href="../icode/Members.scala.html#734263" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <span class="delimiter">}</span>
          <a href="#785673" title="(sym: GenMSIL.this.global.Symbol, cInfo: ch.epfl.lamp.compiler.msil.ConstructorInfo)Unit">mapConstructor</a><span class="delimiter">(</span><a href="#794739" title="GenMSIL.this.global.icodes.global.Symbol">sym</a>, <a href="#794755" title="ch.epfl.lamp.compiler.msil.emit.ConstructorBuilder">constr</a><span class="delimiter">)</span>
          <a href="#785582" title="(member: ch.epfl.lamp.compiler.msil.emit.ICustomAttributeSetter, annotations: List[GenMSIL.this.global.AnnotationInfo])Unit">addAttributes</a><span class="delimiter">(</span><a href="#794755" title="ch.epfl.lamp.compiler.msil.emit.ConstructorBuilder">constr</a>, <a href="#794739" title="GenMSIL.this.global.icodes.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443459" title="=&gt; List[GenMSIL.this.global.icodes.global.AnnotationInfo]">annotations</a><span class="delimiter">)</span>
        <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
          <span class="keyword">var</span> <a title="ch.epfl.lamp.compiler.msil.Type" id="794876">resType</a> = <a href="#785645" title="(t: GenMSIL.this.global.icodes.TypeKind)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">(</span><a href="#794738" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#733852" title="=&gt; GenMSIL.this.global.icodes.TypeKind">returnType</a><span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder" id="794877">method</a> =
            <a href="#794740" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">ownerType</a>.<span title="(name: String, attrs: Short, returnType: ch.epfl.lamp.compiler.msil.Type, paramTypes: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.emit.MethodBuilder">DefineMethod</span><span class="delimiter">(</span><a href="#785633" title="(sym: GenMSIL.this.global.Symbol)String">msilName</a><span class="delimiter">(</span><a href="#794739" title="GenMSIL.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span>, <a href="#794742" title="Short">attr</a>, <a href="#794876" title="ch.epfl.lamp.compiler.msil.Type">resType</a>, <a href="#794741" title="Array[ch.epfl.lamp.compiler.msil.Type]">paramTypes</a><span class="delimiter">)</span>
          <span class="keyword">for</span> <span class="delimiter">(</span><a title="Int" id="794983">i</a> &lt;- <a href="../../../../LowPriorityImplicits.scala.html#8333" title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">0</a>.<a href="../../../../runtime/RichInt.scala.html#57854" title="(end: Int)scala.collection.immutable.Range">until</a><a href="../../../../collection/immutable/Range.scala.html#69665" title="(f: Int =&gt; ch.epfl.lamp.compiler.msil.emit.ParameterBuilder)Unit" class="delimiter">(</a><a href="#794741" title="Array[ch.epfl.lamp.compiler.msil.Type]">paramTypes</a>.<a href="../../../../Array.scala.html#57449" title="=&gt; Int">length</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
            <a href="#794877" title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder">method</a>.<span title="(pos: Int, attr: Int, name: String)ch.epfl.lamp.compiler.msil.emit.ParameterBuilder">DefineParameter</span><span class="delimiter">(</span><a href="#794983" title="Int">i</a>, ParameterAttributes.<span title="Int(0)">None</span>, <a href="#785633" title="(sym: GenMSIL.this.global.Symbol)String">msilName</a><span class="delimiter">(</span><a href="#794738" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../../../../collection/LinearSeqOptimized.scala.html#76165" title="(n: Int)GenMSIL.this.global.icodes.Local">params</a><span class="delimiter">(</span><a href="#794983" title="Int">i</a><span class="delimiter">)</span>.<a href="../icode/Members.scala.html#734263" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <span class="delimiter">}</span>
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../../../Boolean.scala.html#58721" title="=&gt; Boolean">!</a><a href="../../symtab/clr/CLRTypes.scala.html#730897" title="=&gt; scala.collection.mutable.Map[GenMSIL.this.global.loaders.clrTypes.global.Symbol,ch.epfl.lamp.compiler.msil.MethodInfo]">methods</a>.<a href="../../../../collection/MapLike.scala.html#78421" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol)Boolean">contains</a><span class="delimiter">(</span><a href="#794739" title="GenMSIL.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span><span class="delimiter">)</span>
            <a href="#785675" title="(sym: GenMSIL.this.global.Symbol, mInfo: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">mapMethod</a><span class="delimiter">(</span><a href="#794739" title="GenMSIL.this.global.icodes.global.Symbol">sym</a>, <a href="#794877" title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder">method</a><span class="delimiter">)</span>
          <a href="#785582" title="(member: ch.epfl.lamp.compiler.msil.emit.ICustomAttributeSetter, annotations: List[GenMSIL.this.global.AnnotationInfo])Unit">addAttributes</a><span class="delimiter">(</span><a href="#794877" title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder">method</a>, <a href="#794739" title="GenMSIL.this.global.icodes.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443459" title="=&gt; List[GenMSIL.this.global.icodes.global.AnnotationInfo]">annotations</a><span class="delimiter">)</span>
          <a href="../../Global.scala.html#559553" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><span title="String(&quot;\t created MethodBuilder &quot;)" class="string">&quot;\t created MethodBuilder &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#794877" title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder">method</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>
      <span class="delimiter">}</span> // method builders created for non-array iclass

      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#785655" title="(sym: GenMSIL.this.global.Symbol)Boolean">isStaticModule</a><span class="delimiter">(</span><a href="#794607" title="GenMSIL.this.global.icodes.IClass">iclass</a>.<a href="../icode/Members.scala.html#642912" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#785657" title="(sym: GenMSIL.this.global.Symbol)Unit">addModuleInstanceField</a><span class="delimiter">(</span><a href="#794607" title="GenMSIL.this.global.icodes.IClass">iclass</a>.<a href="../icode/Members.scala.html#642912" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a><span class="delimiter">)</span>
        <a href="#785640" title="=&gt; scala.collection.mutable.HashSet[GenMSIL.this.global.Symbol]">notInitializedModules</a> <a href="../../../../collection/mutable/HashSet.scala.html#141570" title="(elem: GenMSIL.this.global.Symbol)BytecodeGenerator.this.notInitializedModules.type">+=</a> <a href="#794607" title="GenMSIL.this.global.icodes.IClass">iclass</a>.<a href="../icode/Members.scala.html#642912" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#794607" title="GenMSIL.this.global.icodes.IClass">iclass</a>.<a href="../icode/Members.scala.html#642931" title="=&gt; Option[GenMSIL.this.global.icodes.IMethod]">lookupStaticCtor</a>.<a href="../../../../Option.scala.html#63811" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="#785660" title="(sym: GenMSIL.this.global.Symbol)Unit">addStaticInit</a><span class="delimiter">(</span><a href="#794607" title="GenMSIL.this.global.icodes.IClass">iclass</a>.<a href="../icode/Members.scala.html#642912" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>

    <span class="delimiter">}</span> // createClassMembers0

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol)Boolean" id="785654">isTopLevelModule</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="789265">sym</a>: <a href="../../../../reflect/internal/Symbols.scala.html#441132" title="GenMSIL.this.global.Symbol">Symbol</a><span class="delimiter">)</span>: <a href="../../../../Boolean.scala.html#2218" title="Boolean">Boolean</a> =
      <a href="../../Global.scala.html#559748" title="(op: =&gt; Boolean)Boolean">beforeRefchecks</a> <span class="delimiter">{</span>
        <a href="#789265" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443245" title="=&gt; Boolean">isModuleClass</a> <a href="../../../../Boolean.scala.html#58725" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../../../Boolean.scala.html#58721" title="=&gt; Boolean">!</a><a href="#789265" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443243" title="=&gt; Boolean">isImplClass</a> <a href="../../../../Boolean.scala.html#58725" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../../../Boolean.scala.html#58721" title="=&gt; Boolean">!</a><a href="#789265" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443364" title="=&gt; Boolean">isNestedClass</a>
      <span class="delimiter">}</span>

    // if the module is lifted it does not need to be initialized in
    // its static constructor, and the MODULE$ field is not required.
    // the outer class will care about it.
    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol)Boolean" id="785655">isStaticModule</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="791088">sym</a>: <a href="../../../../reflect/internal/Symbols.scala.html#441132" title="GenMSIL.this.global.Symbol">Symbol</a><span class="delimiter">)</span>: <a href="../../../../Boolean.scala.html#2218" title="Boolean">Boolean</a> = <span class="delimiter">{</span>
      // .net inner classes: removed '!sym.hasFlag(Flags.LIFTED)', added
      // 'sym.isStatic'. -&gt; no longer compatible without skipping flatten!
      <a href="#791088" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443245" title="=&gt; Boolean">isModuleClass</a> <a href="../../../../Boolean.scala.html#58725" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#791088" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443356" title="=&gt; Boolean">isStatic</a> <a href="../../../../Boolean.scala.html#58725" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../../../Boolean.scala.html#58721" title="=&gt; Boolean">!</a><a href="#791088" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443243" title="=&gt; Boolean">isImplClass</a>
    <span class="delimiter">}</span>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol)Boolean" id="785656">isCloneable</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="789213">sym</a>: <a href="../../../../reflect/internal/Symbols.scala.html#441132" title="GenMSIL.this.global.Symbol">Symbol</a><span class="delimiter">)</span>: <a href="../../../../Boolean.scala.html#2218" title="Boolean">Boolean</a> = <span class="delimiter">{</span>
      <a href="../../../../Boolean.scala.html#58721" title="=&gt; Boolean">!</a><a href="#789213" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443459" title="=&gt; List[GenMSIL.this.global.AnnotationInfo]">annotations</a>.<a href="../../../../collection/LinearSeqOptimized.scala.html#76169" title="(p: GenMSIL.this.global.AnnotationInfo =&gt; Boolean)Boolean">forall</a><span class="delimiter">(</span> a =&gt; <a href="#795045" title="GenMSIL.this.global.AnnotationInfo">a</a> <span class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <a href="../../../../reflect/internal/AnnotationInfos.scala.html#443060" title="Option[(GenMSIL.this.global.Type, List[GenMSIL.this.global.Tree], List[(GenMSIL.this.global.Name, GenMSIL.this.global.ClassfileAnnotArg)])]" id="795067">AnnotationInfo</a><span class="delimiter">(</span><a href="#785543" title="Boolean" id="795060">CloneableAttr</a>, _, _<span class="delimiter">)</span> =&gt; <a href="#795061" title="(x: Boolean)Boolean" class="keyword">false</a>
        <span class="keyword">case</span> _ =&gt; <a href="#795061" title="(x: Boolean)Boolean" class="keyword">true</a>
      <span class="delimiter">}</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol)Unit" id="785657">addModuleInstanceField</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="795021">sym</a>: <a href="../../../../reflect/internal/Symbols.scala.html#441132" title="GenMSIL.this.global.Symbol">Symbol</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="../../Global.scala.html#559553" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><span title="String(&quot;Adding Module-Instance Field for &quot;)" class="string">&quot;Adding Module-Instance Field for &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#785681" title="(sym: GenMSIL.this.global.Symbol)String">showsym</a><span class="delimiter">(</span><a href="#795021" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder" id="795078">tBuilder</a> = <a href="#785648" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.Type">getType</a><span class="delimiter">(</span><a href="#795021" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder" class="delimiter">[</span><span title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">TypeBuilder</span><span class="delimiter">]</span>
      <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.FieldBuilder" id="795079">fb</a> = <a href="#795078" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">tBuilder</a>.<span title="(name: String, fieldType: ch.epfl.lamp.compiler.msil.Type, attrs: Short)ch.epfl.lamp.compiler.msil.emit.FieldBuilder">DefineField</span><span class="delimiter">(</span><a href="#785488" title="=&gt; String">MODULE_INSTANCE_NAME</a>,
                           <a href="#795078" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">tBuilder</a>,
                           <span class="delimiter">(</span>FieldAttributes.Public <span title="Int(22)">|</span>
                            //FieldAttributes.InitOnly |
                            FieldAttributes.Static<span class="delimiter">)</span>.<a href="../../../../Int.scala.html#57872" title="=&gt; Short">toShort</a><span class="delimiter">)</span>
      <a href="../../../../collection/mutable/MapLike.scala.html#78496" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol, value: ch.epfl.lamp.compiler.msil.FieldInfo)Unit">fields</a><span class="delimiter">(</span><a href="#795021" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span> = <a href="#795079" title="ch.epfl.lamp.compiler.msil.emit.FieldBuilder">fb</a>
    <span class="delimiter">}</span>


    // the symbol may be a object-symbol (module-symbol), or a module-class-symbol
    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.FieldInfo" id="785658">getModuleInstanceField</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="787428">sym</a>: <a href="../../../../reflect/internal/Symbols.scala.html#441132" title="GenMSIL.this.global.Symbol">Symbol</a><span class="delimiter">)</span>: <span title="ch.epfl.lamp.compiler.msil.FieldInfo">FieldInfo</span> = <span class="delimiter">{</span>
      <a href="../../Global.scala.html#559533" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a><span class="delimiter">(</span><a href="#787428" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443270" title="=&gt; Boolean">isModule</a> <a href="../../../../Boolean.scala.html#58724" title="(x: Boolean)Boolean">||</a> <a href="#787428" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443245" title="=&gt; Boolean">isModuleClass</a>, <span title="String(&quot;Expected module: &quot;)" class="string">&quot;Expected module: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#785681" title="(sym: GenMSIL.this.global.Symbol)String">showsym</a><span class="delimiter">(</span><a href="#787428" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span><span class="delimiter">)</span>

      // when called by LOAD_MODULE, the corresponding type maybe doesn't
      // exist yet -&gt; make a getType
      <span class="keyword">val</span> <a title="GenMSIL.this.global.Symbol" id="795090">moduleClassSym</a> = <span title="GenMSIL.this.global.Symbol" class="keyword">if</span> <span class="delimiter">(</span><a href="#787428" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443270" title="=&gt; Boolean">isModule</a><span class="delimiter">)</span> <a href="#787428" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443515" title="=&gt; GenMSIL.this.global.Symbol">moduleClass</a> <span class="keyword">else</span> <a href="#787428" title="GenMSIL.this.global.Symbol">sym</a>

      // TODO: get module field for modules not defined in the
      // source currently compiling (e.g. Console)

      <a href="../../symtab/clr/CLRTypes.scala.html#730899" title="=&gt; scala.collection.mutable.Map[GenMSIL.this.global.loaders.clrTypes.global.Symbol,ch.epfl.lamp.compiler.msil.FieldInfo]">fields</a> <a href="../../../../collection/MapLike.scala.html#78410" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol)Option[ch.epfl.lamp.compiler.msil.FieldInfo]">get</a> <a href="#795090" title="GenMSIL.this.global.Symbol">moduleClassSym</a> <span class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> Some<a href="#795108" title="ch.epfl.lamp.compiler.msil.FieldInfo" id="795109" class="delimiter">(</a>sym<span class="delimiter">)</span> =&gt; <a href="#795112" title="(x: ch.epfl.lamp.compiler.msil.FieldInfo)ch.epfl.lamp.compiler.msil.FieldInfo">sym</a>
        <span class="keyword">case</span> <a href="../../../../Option.scala.html#2498" title="ch.epfl.lamp.compiler.msil.FieldInfo" id="795111">None</a> =&gt;
          //val mclass = types(moduleClassSym)
          <span class="keyword">val</span> <a title="String" id="795098">nameInMetadata</a> = <a href="#785659" title="(csym: GenMSIL.this.global.Symbol)String">nestingAwareFullClassname</a><span class="delimiter">(</span><a href="#795090" title="GenMSIL.this.global.Symbol">moduleClassSym</a><span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.Type" id="795099">mClass</a> = <a href="../../symtab/SymbolLoaders.scala.html#650372" title="GenMSIL.this.global.loaders.clrTypes.type">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#730911" title="(name: String)ch.epfl.lamp.compiler.msil.Type">getType</a><span class="delimiter">(</span><a href="#795098" title="String">nameInMetadata</a><span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.FieldInfo" id="795100">mfield</a> = <a href="#795099" title="ch.epfl.lamp.compiler.msil.Type">mClass</a>.<span title="(x$1: String)ch.epfl.lamp.compiler.msil.FieldInfo">GetField</span><span class="delimiter">(</span><span title="String(&quot;MODULE$&quot;)" class="string">&quot;MODULE$&quot;</span><span class="delimiter">)</span>
          <a href="../../Global.scala.html#559533" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a><span class="delimiter">(</span><a href="#795100" title="ch.epfl.lamp.compiler.msil.FieldInfo">mfield</a> <span title="(x$1: AnyRef)Boolean">ne</span> <span title="Null(null)" class="keyword">null</span>, <span title="String(&quot;module not found &quot;)" class="string">&quot;module not found &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#785681" title="(sym: GenMSIL.this.global.Symbol)String">showsym</a><span class="delimiter">(</span><a href="#795090" title="GenMSIL.this.global.Symbol">moduleClassSym</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <a href="../../../../collection/mutable/MapLike.scala.html#78496" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol, value: ch.epfl.lamp.compiler.msil.FieldInfo)Unit">fields</a><span class="delimiter">(</span><a href="#795090" title="GenMSIL.this.global.Symbol">moduleClassSym</a><span class="delimiter">)</span> = <a href="#795100" title="ch.epfl.lamp.compiler.msil.FieldInfo">mfield</a>
          <a href="#795100" title="ch.epfl.lamp.compiler.msil.FieldInfo">mfield</a>
      <span class="delimiter">}</span>

      //fields(moduleClassSym)
    <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="(csym: GenMSIL.this.global.Symbol)String" id="785659">nestingAwareFullClassname</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="795101">csym</a>: <a href="../../../../reflect/internal/Symbols.scala.html#441132" title="GenMSIL.this.global.Symbol">Symbol</a><span class="delimiter">)</span> : <span title="String">String</span> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="String" id="795120">suffix</a> = <a href="#795101" title="GenMSIL.this.global.Symbol">csym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443390" title="=&gt; String">moduleSuffix</a>
      <span class="keyword">val</span> <a title="String" id="795121">res</a> = <span title="String" class="keyword">if</span> <span class="delimiter">(</span><a href="#795101" title="GenMSIL.this.global.Symbol">csym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443364" title="=&gt; Boolean">isNestedClass</a><span class="delimiter">)</span>
        <a href="#785659" title="(csym: GenMSIL.this.global.Symbol)String">nestingAwareFullClassname</a><span class="delimiter">(</span><a href="#795101" title="GenMSIL.this.global.Symbol">csym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443379" title="=&gt; GenMSIL.this.global.Symbol">owner</a><span class="delimiter">)</span> <span title="(x$1: Any)String">+</span> <span title="String(&quot;+&quot;)" class="string">&quot;+&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#795101" title="GenMSIL.this.global.Symbol">csym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443387" title="=&gt; String">encodedName</a>
      <span class="keyword">else</span>
        <a href="#795101" title="GenMSIL.this.global.Symbol">csym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443398" title="=&gt; String">fullName</a>
      <a href="#795121" title="String">res</a> <span title="(x$1: Any)String">+</span> <a href="#795120" title="String">suffix</a>
    <span class="delimiter">}</span>

    /** Adds a static initializer which creates an instance of the module
     *  class (calls the primary constructor). A special primary constructor
     *  will be generated (notInitializedModules) which stores the new instance
     *  in the MODULE$ field right after the super call.
     */
    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol)Unit" id="785660">addStaticInit</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="795031">sym</a>: <a href="../../../../reflect/internal/Symbols.scala.html#441132" title="GenMSIL.this.global.Symbol">Symbol</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder" id="795124">tBuilder</a> = <a href="#785648" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.Type">getType</a><span class="delimiter">(</span><a href="#795031" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder" class="delimiter">[</span><span title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">TypeBuilder</span><span class="delimiter">]</span>

      <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.ConstructorBuilder" id="795125">staticInit</a> = <a href="#795124" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">tBuilder</a>.<span title="(attrs: Short, callingConvention: Short, paramTypes: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.emit.ConstructorBuilder">DefineConstructor</span><span class="delimiter">(</span>
        <span class="delimiter">(</span>MethodAttributes.Static <span title="Int(22)">|</span> MethodAttributes.Public<span class="delimiter">)</span>.<a href="../../../../Int.scala.html#57872" title="=&gt; Short">toShort</a>,
        CallingConventions.<span title="Short(1)">Standard</span>,
        <span title="ch.epfl.lamp.compiler.msil.Type.type">MsilType</span>.<span title="Array[ch.epfl.lamp.compiler.msil.Type]">EmptyTypes</span><span class="delimiter">)</span>

      <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.ILGenerator" id="795126">sicode</a> = <a href="#795125" title="ch.epfl.lamp.compiler.msil.emit.ConstructorBuilder">staticInit</a>.<span title="()ch.epfl.lamp.compiler.msil.emit.ILGenerator">GetILGenerator</span><span class="delimiter">(</span><span class="delimiter">)</span>

      <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.ConstructorInfo" id="795127">instanceConstructor</a> = <a href="../../../../collection/MapLike.scala.html#78420" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol)ch.epfl.lamp.compiler.msil.ConstructorInfo">constructors</a><span class="delimiter">(</span><a href="#795031" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443482" title="=&gt; GenMSIL.this.global.Symbol">primaryConstructor</a><span class="delimiter">)</span>

      // there are no constructor parameters. assuming the constructor takes no parameter
      // is fine: we call (in the static constructor) the constructor of the module class,
      // which takes no arguments - an object definition cannot take constructor arguments.
      <a href="#795126" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">sicode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.ConstructorInfo)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Newobj</span>, <a href="#795127" title="ch.epfl.lamp.compiler.msil.ConstructorInfo">instanceConstructor</a><span class="delimiter">)</span>
      // the stsfld is done in the instance constructor, just after the super call.
      <a href="#795126" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">sicode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Pop</span><span class="delimiter">)</span>

      <a href="#795126" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">sicode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ret</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol)Unit" id="785661">generateMirrorClass</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="789271">sym</a>: <a href="../../../../reflect/internal/Symbols.scala.html#441132" title="GenMSIL.this.global.Symbol">Symbol</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.Type" id="795155">tBuilder</a> = <a href="#785648" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.Type">getType</a><span class="delimiter">(</span><a href="#789271" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span>
      <a href="../../Global.scala.html#559533" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a><span class="delimiter">(</span><a href="#789271" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443245" title="=&gt; Boolean">isModuleClass</a>, <span title="String(&quot;Can\'t generate Mirror-Class for the Non-Module class &quot;)" class="string">&quot;Can't generate Mirror-Class for the Non-Module class &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#789271" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span>
      <a href="../../Global.scala.html#559553" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><span title="String(&quot;Dumping mirror class for object: &quot;)" class="string">&quot;Dumping mirror class for object: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#789271" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span>
      <span class="keyword">val</span> <a title="String" id="795156">moduleName</a> = <a href="#785633" title="(sym: GenMSIL.this.global.Symbol)String">msilName</a><span class="delimiter">(</span><a href="#789271" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span>
      <span class="keyword">val</span> <a title="String" id="795157">mirrorName</a> = <a href="#795156" title="String">moduleName</a>.<span title="(x$1: Int, x$2: Int)String">substring</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span>, <a href="#795156" title="String">moduleName</a>.<span title="()Int">length</span><span class="delimiter">(</span><span class="delimiter">)</span> <a href="../../../../Int.scala.html#57955" title="(x: Int)Int">-</a> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
      <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder" id="795158">mirrorTypeBuilder</a> = <a href="#785560" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ModuleBuilder">mmodule</a>.<span title="(typeName: String, attributes: Int, baseType: ch.epfl.lamp.compiler.msil.Type, interfaces: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.emit.TypeBuilder">DefineType</span><span class="delimiter">(</span><a href="#795157" title="String">mirrorName</a>,
                                                 TypeAttributes.Class |
                                                 TypeAttributes.Public <span title="Int(257)">|</span>
                                                 TypeAttributes.Sealed,
                                                 <a href="../../symtab/clr/CLRTypes.scala.html#730866" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MOBJECT</a>,
                                                 <span title="ch.epfl.lamp.compiler.msil.Type.type">MsilType</span>.<span title="Array[ch.epfl.lamp.compiler.msil.Type]">EmptyTypes</span><span class="delimiter">)</span>

      <span class="keyword">val</span> <a title="GenMSIL.this.global.icodes.IClass" id="795159">iclass</a> = <a href="../../../../collection/mutable/HashMap.scala.html#79206" title="(key: GenMSIL.this.global.icodes.global.Symbol)GenMSIL.this.global.icodes.IClass">classes</a><span class="delimiter">(</span><a href="#789271" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span>

      <span class="keyword">for</span> <span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="795214">m</a> &lt;- <a href="#789271" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443425" title="=&gt; GenMSIL.this.global.Type">tpe</a>.<a href="../../../../collection/generic/FilterMonadic.scala.html#59082" title="(f: GenMSIL.this.global.Symbol =&gt; Unit)Unit">nonPrivateMembers</a>
           <span class="keyword">if</span> <a href="#795214" title="GenMSIL.this.global.Symbol">m</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443379" title="=&gt; GenMSIL.this.global.Symbol">owner</a> <span title="(x$1: AnyRef)Boolean">!=</span> <a href="../../../../reflect/internal/Definitions.scala.html#441641" title="GenMSIL.this.global.definitions.type">definitions</a>.<a href="../../../../reflect/internal/Definitions.scala.html#442179" title="=&gt; GenMSIL.this.global.ClassSymbol">ObjectClass</a> <a href="../../../../Boolean.scala.html#58725" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../../../Boolean.scala.html#58721" title="=&gt; Boolean">!</a><a href="#795214" title="GenMSIL.this.global.Symbol">m</a>.<a href="../../../../reflect/internal/HasFlags.scala.html#443597" title="=&gt; Boolean">isProtected</a> <a href="../../../../Boolean.scala.html#58725" title="(x: Boolean)Boolean">&amp;&amp;</a>
           <a href="#795214" title="GenMSIL.this.global.Symbol">m</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443282" title="=&gt; Boolean">isMethod</a> <a href="../../../../Boolean.scala.html#58725" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../../../Boolean.scala.html#58721" title="=&gt; Boolean">!</a><a href="#795214" title="GenMSIL.this.global.Symbol">m</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443264" title="=&gt; Boolean">isClassConstructor</a> <a href="../../../../Boolean.scala.html#58725" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../../../Boolean.scala.html#58721" title="=&gt; Boolean">!</a><a href="#795214" title="GenMSIL.this.global.Symbol">m</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443358" title="=&gt; Boolean">isStaticMember</a> <a href="../../../../Boolean.scala.html#58725" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../../../Boolean.scala.html#58721" title="=&gt; Boolean">!</a><a href="#795214" title="GenMSIL.this.global.Symbol">m</a>.<a href="../../../../reflect/internal/HasFlags.scala.html#443590" title="=&gt; Boolean">isCase</a> <a href="../../../../Boolean.scala.html#58725" title="(x: Boolean)Boolean">&amp;&amp;</a>
           <a href="../../../../Boolean.scala.html#58721" title="=&gt; Boolean">!</a><a href="#795214" title="GenMSIL.this.global.Symbol">m</a>.<a href="../../../../reflect/internal/HasFlags.scala.html#443608" title="=&gt; Boolean">isDeferred</a><span class="delimiter">)</span>
        <span class="delimiter">{</span>
          <a href="../../Global.scala.html#559553" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><span title="String(&quot;   Mirroring method: &quot;)" class="string">&quot;   Mirroring method: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#795214" title="GenMSIL.this.global.Symbol">m</a><span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="Array[ch.epfl.lamp.compiler.msil.Type]" id="795215">paramTypes</a> = <a href="#785647" title="(sym: GenMSIL.this.global.Symbol)Array[ch.epfl.lamp.compiler.msil.Type]">msilParamTypes</a><span class="delimiter">(</span><a href="#795214" title="GenMSIL.this.global.Symbol">m</a><span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="Array[String]" id="795216">paramNames</a>: <a href="../../../../Array.scala.html#292" title="Array[String]">Array</a><span class="delimiter">[</span>String<span class="delimiter">]</span> = <span title="Array[String]" class="keyword">new</span> <a href="../../../../Array.scala.html#292" title="Array[String]">Array</a><span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">(</span><a href="#795215" title="Array[ch.epfl.lamp.compiler.msil.Type]">paramTypes</a>.<a href="../../../../Array.scala.html#57449" title="=&gt; Int">length</a><span class="delimiter">)</span>
          <span class="keyword">for</span> <span class="delimiter">(</span><a title="Int" id="795321">i</a> &lt;- <a href="../../../../LowPriorityImplicits.scala.html#8333" title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">0</a> <a href="../../../../collection/immutable/Range.scala.html#69665" title="(f: Int =&gt; Unit)Unit">until</a> <a href="#795215" title="Array[ch.epfl.lamp.compiler.msil.Type]">paramTypes</a>.<a href="../../../../Array.scala.html#57449" title="=&gt; Int">length</a><span class="delimiter">)</span>
            <a href="../../../../Array.scala.html#57451" title="(i: Int, x: String)Unit">paramNames</a><span class="delimiter">(</span><a href="#795321" title="Int">i</a><span class="delimiter">)</span> = <span title="String(&quot;x_&quot;)" class="string">&quot;x_&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#795321" title="Int">i</a>

          // CHECK: verify if getMethodName is better than msilName
          <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder" id="795217">mirrorMethod</a> = <a href="#795158" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">mirrorTypeBuilder</a>.<span title="(name: String, attrs: Short, returnType: ch.epfl.lamp.compiler.msil.Type, paramTypes: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.emit.MethodBuilder">DefineMethod</span><span class="delimiter">(</span><a href="#785633" title="(sym: GenMSIL.this.global.Symbol)String">msilName</a><span class="delimiter">(</span><a href="#795214" title="GenMSIL.this.global.Symbol">m</a><span class="delimiter">)</span>,
                                                            <span class="delimiter">(</span>MethodAttributes.Public <span title="Int(22)">|</span>
                                                            MethodAttributes.Static<span class="delimiter">)</span>.<a href="../../../../Int.scala.html#57872" title="=&gt; Short">toShort</a>,
                                                            <a href="#785646" title="(tpe: GenMSIL.this.global.Type)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">(</span><a href="#795214" title="GenMSIL.this.global.Symbol">m</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443425" title="=&gt; GenMSIL.this.global.Type">tpe</a>.<a href="../../../../reflect/internal/Types.scala.html#442002" title="=&gt; GenMSIL.this.global.Type">resultType</a><span class="delimiter">)</span>,
                                                            <a href="#795215" title="Array[ch.epfl.lamp.compiler.msil.Type]">paramTypes</a><span class="delimiter">)</span>

          <span class="keyword">var</span> <a title="Int" id="795218">i</a> = <span title="Int(0)" class="int">0</span>
          <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><a href="#795218" title="Int">i</a> <a href="../../../../Int.scala.html#57905" title="(x: Int)Boolean">&lt;</a> <a href="#795215" title="Array[ch.epfl.lamp.compiler.msil.Type]">paramTypes</a>.<a href="../../../../Array.scala.html#57449" title="=&gt; Int">length</a><span class="delimiter">)</span> <a href="#795221" title="()Unit" class="delimiter">{</a>
            <a href="#795217" title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder">mirrorMethod</a>.<span title="(pos: Int, attr: Int, name: String)ch.epfl.lamp.compiler.msil.emit.ParameterBuilder">DefineParameter</span><span class="delimiter">(</span><a href="#795218" title="Int">i</a>, ParameterAttributes.<span title="Int(0)">None</span>, <a href="../../../../Array.scala.html#57450" title="(i: Int)String">paramNames</a><span class="delimiter">(</span><a href="#795218" title="Int">i</a><span class="delimiter">)</span><span class="delimiter">)</span>
            <a href="#795218" title="Int">i</a> <a href="../../../../Int.scala.html#57948" title="(x: Int)Int">+=</a> <span title="Int(1)" class="int">1</span>
          <span class="delimiter">}</span>

          <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.ILGenerator" id="795219">mirrorCode</a> = <a href="#795217" title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder">mirrorMethod</a>.<span title="()ch.epfl.lamp.compiler.msil.emit.ILGenerator">GetILGenerator</span><span class="delimiter">(</span><span class="delimiter">)</span>
          <a href="#795219" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">mirrorCode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.FieldInfo)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldsfld</span>, <a href="#785658" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.FieldInfo">getModuleInstanceField</a><span class="delimiter">(</span><a href="#789271" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.MethodInfo" id="795220">mInfo</a> = <a href="#785674" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.MethodInfo">getMethod</a><span class="delimiter">(</span><a href="#795214" title="GenMSIL.this.global.Symbol">m</a><span class="delimiter">)</span>
          <span class="keyword">for</span> <span class="delimiter">(</span><a title="Int" id="795451">paramidx</a> &lt;- <a href="../../../../LowPriorityImplicits.scala.html#8333" title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">0</a>.<a href="../../../../runtime/RichInt.scala.html#57854" title="(end: Int)scala.collection.immutable.Range">until</a><a href="../../../../collection/immutable/Range.scala.html#69665" title="(f: Int =&gt; Unit)Unit" class="delimiter">(</a><a href="#795215" title="Array[ch.epfl.lamp.compiler.msil.Type]">paramTypes</a>.<a href="../../../../Array.scala.html#57449" title="=&gt; Int">length</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
            <span class="keyword">val</span> <a title="Array[ch.epfl.lamp.compiler.msil.ParameterInfo]" id="795452">mInfoParams</a> = <a href="#795220" title="ch.epfl.lamp.compiler.msil.MethodInfo">mInfo</a>.<span title="()Array[ch.epfl.lamp.compiler.msil.ParameterInfo]">GetParameters</span>
            <span class="keyword">val</span> <a title="Boolean" id="795453">loadAddr</a> = <a href="../../../../Array.scala.html#57450" title="(i: Int)ch.epfl.lamp.compiler.msil.ParameterInfo">mInfoParams</a><span class="delimiter">(</span><a href="#795451" title="Int">paramidx</a><span class="delimiter">)</span>.<span title="ch.epfl.lamp.compiler.msil.Type">ParameterType</span>.<span title="()Boolean">IsByRef</span>
            <a href="#785626" title="(code: ch.epfl.lamp.compiler.msil.emit.ILGenerator, loadAddr: Boolean)(i: Int)Unit">loadArg</a><span class="delimiter">(</span><a href="#795219" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">mirrorCode</a>, <a href="#795453" title="Boolean">loadAddr</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#795451" title="Int">paramidx</a><span class="delimiter">)</span>
          <span class="delimiter">}</span>

          <a href="#795219" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">mirrorCode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Callvirt</span>, <a href="#785674" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.MethodInfo">getMethod</a><span class="delimiter">(</span><a href="#795214" title="GenMSIL.this.global.Symbol">m</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <a href="#795219" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">mirrorCode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ret</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>

      <a href="#785581" title="(sym: GenMSIL.this.global.Symbol, tBuilder: ch.epfl.lamp.compiler.msil.emit.TypeBuilder)Unit">addSymtabAttribute</a><span class="delimiter">(</span><a href="#789271" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443490" title="=&gt; GenMSIL.this.global.Symbol">sourceModule</a>, <a href="#795158" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">mirrorTypeBuilder</a><span class="delimiter">)</span>

      <a href="#795158" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">mirrorTypeBuilder</a>.<span title="()ch.epfl.lamp.compiler.msil.Type">CreateType</span><span class="delimiter">(</span><span class="delimiter">)</span>
      <a href="#795158" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">mirrorTypeBuilder</a>.<span title="(sourceFilepath: String)Unit">setSourceFilepath</span><span class="delimiter">(</span><a href="#795159" title="GenMSIL.this.global.icodes.IClass">iclass</a>.<a href="../icode/Members.scala.html#642921" title="=&gt; GenMSIL.this.global.icodes.global.CompilationUnit">cunit</a>.<a href="../../CompilationUnits.scala.html#560792" title="=&gt; scala.tools.nsc.util.SourceFile">source</a>.<a href="../../util/SourceFile.scala.html#561659" title="=&gt; scala.tools.nsc.io.AbstractFile">file</a>.<a href="../../io/AbstractFile.scala.html#561677" title="=&gt; String">path</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>


    // #####################################################################
    // delegate callers

    <span class="keyword">var</span> <a title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder" id="785663">delegateCallers</a>: <span title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">TypeBuilder</span> = _
    <span class="keyword">var</span> <a title="Int" id="785666">nbDelegateCallers</a>: <a href="../../../../Int.scala.html#508" title="Int">Int</a> = <span title="Int(0)" class="int">0</span>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="()Unit" id="785668">initDelegateCallers</a><span class="delimiter">(</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
      <a href="#785663" title="(x$1: ch.epfl.lamp.compiler.msil.emit.TypeBuilder)Unit">delegateCallers</a> = <a href="#785560" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ModuleBuilder">mmodule</a>.<span title="(typeName: String, attributes: Int)ch.epfl.lamp.compiler.msil.emit.TypeBuilder">DefineType</span><span class="delimiter">(</span><span title="String(&quot;$DelegateCallers&quot;)" class="string">&quot;$DelegateCallers&quot;</span>, TypeAttributes.Public <span title="Int(257)">|</span>
                                          TypeAttributes.Sealed<span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(functionType: GenMSIL.this.global.Type, delegateType: GenMSIL.this.global.Type)Unit" id="785669">createDelegateCaller</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Type" id="791239">functionType</a>: <a href="../../../../reflect/internal/Types.scala.html#441242" title="GenMSIL.this.global.Type">Type</a>, <a title="GenMSIL.this.global.Type" id="791240">delegateType</a>: <a href="../../../../reflect/internal/Types.scala.html#441242" title="GenMSIL.this.global.Type">Type</a><span class="delimiter">)</span> = <span class="delimiter">{</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#785663" title="=&gt; ch.epfl.lamp.compiler.msil.emit.TypeBuilder">delegateCallers</a> <span title="(x$1: AnyRef)Boolean">==</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span>
        <a href="#785668" title="()Unit">initDelegateCallers</a><span class="delimiter">(</span><span class="delimiter">)</span>
      // create a field an store the function-object
      <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.Type" id="791241">mFunctionType</a>: <span title="ch.epfl.lamp.compiler.msil.Type">MsilType</span> = <a href="#785646" title="(tpe: GenMSIL.this.global.Type)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">(</span><a href="#791239" title="GenMSIL.this.global.Type">functionType</a><span class="delimiter">)</span>
      <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.FieldBuilder" id="791242">anonfunField</a>: <span title="ch.epfl.lamp.compiler.msil.emit.FieldBuilder">FieldBuilder</span> = <a href="#785663" title="=&gt; ch.epfl.lamp.compiler.msil.emit.TypeBuilder">delegateCallers</a>.<span title="(name: String, fieldType: ch.epfl.lamp.compiler.msil.Type, attrs: Short)ch.epfl.lamp.compiler.msil.emit.FieldBuilder">DefineField</span><span class="delimiter">(</span>
        <span title="String(&quot;$anonfunField$$&quot;)" class="string">&quot;$anonfunField$$&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#785666" title="=&gt; Int">nbDelegateCallers</a>, <a href="#791241" title="ch.epfl.lamp.compiler.msil.Type">mFunctionType</a>,
        <span class="delimiter">(</span>FieldAttributes.InitOnly | FieldAttributes.Public <span title="Int(54)">|</span> FieldAttributes.Static<span class="delimiter">)</span>.<a href="../../../../Int.scala.html#57872" title="=&gt; Short">toShort</a><span class="delimiter">)</span>
      <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.FieldInfo)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Stsfld</span>, <a href="#791242" title="ch.epfl.lamp.compiler.msil.emit.FieldBuilder">anonfunField</a><span class="delimiter">)</span>


      // create the static caller method and the delegate object
      <span class="keyword">val</span> <a href="#791370" title="(x: (List[GenMSIL.this.global.Symbol], GenMSIL.this.global.Type))(List[GenMSIL.this.global.Symbol], GenMSIL.this.global.Type)" class="delimiter">(</a><a href="../../../../Tuple2.scala.html#61506" title="List[GenMSIL.this.global.Symbol]" id="791244">params</a>, <a href="../../../../Tuple2.scala.html#61508" title="GenMSIL.this.global.Type" id="791245">returnType</a><span class="delimiter">)</span> = <a href="#791240" title="GenMSIL.this.global.Type">delegateType</a>.<a href="../../../../reflect/internal/Types.scala.html#442028" title="(name: GenMSIL.this.global.Name)GenMSIL.this.global.Symbol">member</a><span class="delimiter">(</span><a href="../../../../reflect/internal/StdNames.scala.html#441764" title="GenMSIL.this.global.nme.type">nme</a>.<a href="../../../../reflect/internal/StdNames.scala.html#446433" title="=&gt; GenMSIL.this.global.nme.NameType">apply</a><span class="delimiter">)</span>.<a href="../../../../reflect/internal/Symbols.scala.html#443425" title="=&gt; GenMSIL.this.global.Type">tpe</a> <a href="../../../../Tuple2.scala.html#1222" title="(List[GenMSIL.this.global.Symbol], GenMSIL.this.global.Type) @unchecked" class="keyword">match</a> <span class="delimiter">{</span>
        <span class="keyword">case</span> MethodType<a href="#791350" title="(List[GenMSIL.this.global.Symbol], GenMSIL.this.global.Type)" id="791352" class="delimiter">(</a>delParams, delReturn<span class="delimiter">)</span> =&gt; <a href="#791353" title="(x: (List[GenMSIL.this.global.Symbol], GenMSIL.this.global.Type))(List[GenMSIL.this.global.Symbol], GenMSIL.this.global.Type)" class="delimiter">(</a>delParams, delReturn<span class="delimiter">)</span>
        <span class="keyword">case</span> _ =&gt; <a href="../../Global.scala.html#559537" title="(msg: String)Nothing">abort</a><a href="#791353" title="(x: (List[GenMSIL.this.global.Symbol], GenMSIL.this.global.Type))(List[GenMSIL.this.global.Symbol], GenMSIL.this.global.Type)" class="delimiter">(</a><span title="String(&quot;not a delegate type: &quot;)" class="string">&quot;not a delegate type: &quot;</span>  <span title="(x$1: Any)String">+</span> <a href="#791240" title="GenMSIL.this.global.Type">delegateType</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
      <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder" id="791246">caller</a>: <span title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder">MethodBuilder</span> = <a href="#785663" title="=&gt; ch.epfl.lamp.compiler.msil.emit.TypeBuilder">delegateCallers</a>.<span title="(name: String, attrs: Short, returnType: ch.epfl.lamp.compiler.msil.Type, paramTypes: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.emit.MethodBuilder">DefineMethod</span><span class="delimiter">(</span>
        <span title="String(&quot;$delegateCaller$$&quot;)" class="string">&quot;$delegateCaller$$&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#785666" title="=&gt; Int">nbDelegateCallers</a>,
        <span class="delimiter">(</span>MethodAttributes.Final | MethodAttributes.Public <span title="Int(54)">|</span> MethodAttributes.Static<span class="delimiter">)</span>.<a href="../../../../Int.scala.html#57872" title="=&gt; Short">toShort</a>,
        <a href="#785646" title="(tpe: GenMSIL.this.global.Type)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">(</span><a href="#791245" title="GenMSIL.this.global.Type">returnType</a><span class="delimiter">)</span>, <span class="delimiter">(</span><a href="#791244" title="List[GenMSIL.this.global.Symbol]">params</a> <a href="../../../../collection/TraversableLike.scala.html#58971" title="(f: GenMSIL.this.global.Symbol =&gt; GenMSIL.this.global.Type)(implicit bf: scala.collection.generic.CanBuildFrom[List[GenMSIL.this.global.Symbol],GenMSIL.this.global.Type,List[GenMSIL.this.global.Type]])List[GenMSIL.this.global.Type]">map</a> <span class="delimiter">(</span><a href="#791404" title="GenMSIL.this.global.Symbol">_</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443425" title="=&gt; GenMSIL.this.global.Type">tpe</a><span class="delimiter">)</span><span class="delimiter">)</span>.<a href="../../../../collection/TraversableLike.scala.html#58971" title="(f: GenMSIL.this.global.Type =&gt; ch.epfl.lamp.compiler.msil.Type)(implicit bf: scala.collection.generic.CanBuildFrom[List[GenMSIL.this.global.Type],ch.epfl.lamp.compiler.msil.Type,List[ch.epfl.lamp.compiler.msil.Type]])List[ch.epfl.lamp.compiler.msil.Type]">map</a><a href="../../../../collection/immutable/List.scala.html#63282" title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.List.Coll,ch.epfl.lamp.compiler.msil.Type,List[ch.epfl.lamp.compiler.msil.Type]]" class="delimiter">(</a><a href="#785646" title="(tpe: GenMSIL.this.global.Type)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">)</span>.<a href="../../../../collection/TraversableOnce.scala.html#59170" title="(implicit evidence$1: ArrayTag[ch.epfl.lamp.compiler.msil.Type])Array[ch.epfl.lamp.compiler.msil.Type]">toArray</a><span class="delimiter">)</span>
      <span class="keyword">for</span> <span class="delimiter">(</span><a title="Int" id="791650">i</a> &lt;- <a href="../../../../LowPriorityImplicits.scala.html#8333" title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">0</a> <a href="../../../../collection/immutable/Range.scala.html#69665" title="(f: Int =&gt; ch.epfl.lamp.compiler.msil.emit.ParameterBuilder)Unit">until</a> <a href="#791244" title="List[GenMSIL.this.global.Symbol]">params</a>.<a href="../../../../collection/LinearSeqOptimized.scala.html#76164" title="=&gt; Int">length</a><span class="delimiter">)</span>
        <a href="#791246" title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder">caller</a>.<span title="(pos: Int, attr: Int, name: String)ch.epfl.lamp.compiler.msil.emit.ParameterBuilder">DefineParameter</span><span class="delimiter">(</span><a href="#791650" title="Int">i</a>, ParameterAttributes.<span title="Int(0)">None</span>, <span title="String(&quot;arg&quot;)" class="string">&quot;arg&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#791650" title="Int">i</a><span class="delimiter">)</span> // FIXME: use name of parameter symbol
      <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.ConstructorInfo" id="791247">delegCtor</a> = <a href="#785646" title="(tpe: GenMSIL.this.global.Type)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">(</span><a href="#791240" title="GenMSIL.this.global.Type">delegateType</a><span class="delimiter">)</span>.<span title="(x$1: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.ConstructorInfo">GetConstructor</span><span class="delimiter">(</span><a href="../../../../Array.scala.html#68728" title="(xs: ch.epfl.lamp.compiler.msil.Type*)(implicit evidence$2: scala.reflect.ArrayTag[ch.epfl.lamp.compiler.msil.Type])Array[ch.epfl.lamp.compiler.msil.Type]">Array</a><a href="../../../../reflect/ClassTag.scala.html#61898" title="(erasure1: Class[_])scala.reflect.ClassTag[ch.epfl.lamp.compiler.msil.Type]" class="delimiter">(</a><a href="../../symtab/clr/CLRTypes.scala.html#730866" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MOBJECT</a>, <a href="#785513" title="=&gt; ch.epfl.lamp.compiler.msil.Type">INT_PTR</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldnull</span><span class="delimiter">)</span>
      <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldftn</span>, <a href="#791246" title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder">caller</a><span class="delimiter">)</span>
      <a href="#785563" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.ConstructorInfo)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Newobj</span>, <a href="#791247" title="ch.epfl.lamp.compiler.msil.ConstructorInfo">delegCtor</a><span class="delimiter">)</span>


      // create the static caller method body
      <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.MethodInfo" id="791248">functionApply</a>: <span title="ch.epfl.lamp.compiler.msil.MethodInfo">MethodInfo</span> = <a href="#785674" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.MethodInfo">getMethod</a><span class="delimiter">(</span><a href="#791239" title="GenMSIL.this.global.Type">functionType</a>.<a href="../../../../reflect/internal/Types.scala.html#442028" title="(name: GenMSIL.this.global.Name)GenMSIL.this.global.Symbol">member</a><span class="delimiter">(</span><a href="../../../../reflect/internal/StdNames.scala.html#441764" title="GenMSIL.this.global.nme.type">nme</a>.<a href="../../../../reflect/internal/StdNames.scala.html#446433" title="=&gt; GenMSIL.this.global.nme.NameType">apply</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.ILGenerator" id="791249">dcode</a>: <span title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">ILGenerator</span> = <a href="#791246" title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder">caller</a>.<span title="()ch.epfl.lamp.compiler.msil.emit.ILGenerator">GetILGenerator</span><span class="delimiter">(</span><span class="delimiter">)</span>
      <a href="#791249" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">dcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.FieldInfo)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldsfld</span>, <a href="#791242" title="ch.epfl.lamp.compiler.msil.emit.FieldBuilder">anonfunField</a><span class="delimiter">)</span>
      <span class="keyword">for</span> <span class="delimiter">(</span><a title="Int" id="791818">i</a> &lt;- <a href="../../../../LowPriorityImplicits.scala.html#8333" title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">0</a> <a href="../../../../collection/immutable/Range.scala.html#69665" title="(f: Int =&gt; Unit)Unit">until</a> <a href="#791244" title="List[GenMSIL.this.global.Symbol]">params</a>.<a href="../../../../collection/LinearSeqOptimized.scala.html#76164" title="=&gt; Int">length</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#785626" title="(code: ch.epfl.lamp.compiler.msil.emit.ILGenerator, loadAddr: Boolean)(i: Int)Unit">loadArg</a><span class="delimiter">(</span><a href="#791249" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">dcode</a>, <span title="Boolean(false)" class="keyword">false</span> /* TODO confirm whether passing actual as-is to formal is correct wrt the ByRef attribute of the param */<span class="delimiter">)</span><span class="delimiter">(</span><a href="#791818" title="Int">i</a><span class="delimiter">)</span>
        <a href="#785670" title="(code: ch.epfl.lamp.compiler.msil.emit.ILGenerator, boxType: GenMSIL.this.global.icodes.TypeKind)Unit">emitBox</a><span class="delimiter">(</span><a href="#791249" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">dcode</a>, <a href="../icode/TypeKinds.scala.html#642747" title="(t: GenMSIL.this.global.icodes.global.Type)GenMSIL.this.global.icodes.TypeKind">toTypeKind</a><span class="delimiter">(</span><a href="../../../../collection/LinearSeqOptimized.scala.html#76165" title="(n: Int)GenMSIL.this.global.Symbol">params</a><span class="delimiter">(</span><a href="#791818" title="Int">i</a><span class="delimiter">)</span>.<a href="../../../../reflect/internal/Symbols.scala.html#443425" title="=&gt; GenMSIL.this.global.Type">tpe</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
      <a href="#791249" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">dcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Callvirt</span>, <a href="#791248" title="ch.epfl.lamp.compiler.msil.MethodInfo">functionApply</a><span class="delimiter">)</span>
      <a href="#785671" title="(code: ch.epfl.lamp.compiler.msil.emit.ILGenerator, boxType: GenMSIL.this.global.icodes.TypeKind)Unit">emitUnbox</a><span class="delimiter">(</span><a href="#791249" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">dcode</a>, <a href="../icode/TypeKinds.scala.html#642747" title="(t: GenMSIL.this.global.icodes.global.Type)GenMSIL.this.global.icodes.TypeKind">toTypeKind</a><span class="delimiter">(</span><a href="#791245" title="GenMSIL.this.global.Type">returnType</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="#791249" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">dcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ret</span><span class="delimiter">)</span>

      <a href="#785666" title="(x$1: Int)Unit">nbDelegateCallers</a> = <a href="#785666" title="=&gt; Int">nbDelegateCallers</a> <a href="../../../../Int.scala.html#57948" title="(x: Int)Int">+</a> <span title="Int(1)" class="int">1</span>

    <span class="delimiter">}</span> //def createDelegateCaller

    <span class="keyword">def</span> <a title="(code: ch.epfl.lamp.compiler.msil.emit.ILGenerator, boxType: GenMSIL.this.global.icodes.TypeKind)Unit" id="785670">emitBox</a><span class="delimiter">(</span><a title="ch.epfl.lamp.compiler.msil.emit.ILGenerator" id="791819">code</a>: <span title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">ILGenerator</span>, <a title="GenMSIL.this.global.icodes.TypeKind" id="791820">boxType</a>: <a href="../icode/TypeKinds.scala.html#642711" title="GenMSIL.this.global.icodes.TypeKind">TypeKind</a><span class="delimiter">)</span> = <span class="delimiter">(</span><a href="#791820" title="GenMSIL.this.global.icodes.TypeKind">boxType</a>: @<a href="../icode/TypeKinds.scala.html#642711" title="GenMSIL.this.global.icodes.TypeKind @unchecked">unchecked</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
      // doesn't make sense, unit as parameter..
      <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#642717" title="Unit" id="791870">UNIT</a>   =&gt; <a href="#791819" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.FieldInfo)Unit">Emit</span><a href="#791879" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldsfld</span>, <a href="#785539" title="=&gt; ch.epfl.lamp.compiler.msil.FieldInfo">boxedUnit</a><span class="delimiter">)</span>
      <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#642719" title="Unit" id="791871">BOOL</a> | <a href="../icode/TypeKinds.scala.html#642721" title="Boolean" id="791872">BYTE</a> | <a href="../icode/TypeKinds.scala.html#642723" title="Boolean" id="791873">SHORT</a> | <a href="../icode/TypeKinds.scala.html#642725" title="Boolean" id="791874">CHAR</a> | <a href="../icode/TypeKinds.scala.html#642727" title="Boolean" id="791875">INT</a> | <a href="../icode/TypeKinds.scala.html#642729" title="Boolean" id="791876">LONG</a> | <a href="../icode/TypeKinds.scala.html#642731" title="Boolean" id="791877">FLOAT</a> | <a href="../icode/TypeKinds.scala.html#642733" title="Boolean" id="791878">DOUBLE</a> =&gt;
        <a href="#791819" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.Type)Unit">Emit</span><a href="#791879" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Box</span>, <a href="#785645" title="(t: GenMSIL.this.global.icodes.TypeKind)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">(</span><a href="#791820" title="GenMSIL.this.global.icodes.TypeKind">boxType</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">case</span> REFERENCE<a href="#791852" title="Unit" id="791863" class="delimiter">(</a>cls<span class="delimiter">)</span> <span class="keyword">if</span> <a href="../../symtab/SymbolLoaders.scala.html#650372" title="GenMSIL.this.global.loaders.clrTypes.type">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#730909" title="(cls: GenMSIL.this.global.loaders.clrTypes.global.Symbol)Boolean">isValueType</a><span class="delimiter">(</span>cls<span class="delimiter">)</span> =&gt;
        <a href="#791819" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.Type)Unit">Emit</span><a href="#791879" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Box</span>, <span class="delimiter">(</span><a href="#785645" title="(t: GenMSIL.this.global.icodes.TypeKind)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">(</span><a href="#791820" title="GenMSIL.this.global.icodes.TypeKind">boxType</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">case</span> REFERENCE<a href="#791852" title="Unit" id="791866" class="delimiter">(</a>_<span class="delimiter">)</span> | ARRAY<a href="#791852" title="Boolean" id="791869" class="delimiter">(</a>_<span class="delimiter">)</span> =&gt;
        <a href="../../Global.scala.html#559532" title="(msg: String)Unit">warning</a><span class="delimiter">(</span><span title="String(&quot;Tried to BOX a non-valuetype.&quot;)" class="string">&quot;Tried to BOX a non-valuetype.&quot;</span><span class="delimiter">)</span>
        <span title="Unit" class="delimiter">(</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="(code: ch.epfl.lamp.compiler.msil.emit.ILGenerator, boxType: GenMSIL.this.global.icodes.TypeKind)Unit" id="785671">emitUnbox</a><span class="delimiter">(</span><a title="ch.epfl.lamp.compiler.msil.emit.ILGenerator" id="791942">code</a>: <span title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">ILGenerator</span>, <a title="GenMSIL.this.global.icodes.TypeKind" id="791943">boxType</a>: <a href="../icode/TypeKinds.scala.html#642711" title="GenMSIL.this.global.icodes.TypeKind">TypeKind</a><span class="delimiter">)</span> = <span class="delimiter">(</span><a href="#791943" title="GenMSIL.this.global.icodes.TypeKind">boxType</a>: @<a href="../icode/TypeKinds.scala.html#642711" title="GenMSIL.this.global.icodes.TypeKind @unchecked">unchecked</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#642717" title="Unit" id="792021">UNIT</a>   =&gt; <a href="#791942" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><a href="#792030" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Pop</span><span class="delimiter">)</span>
      /* (1) it's essential to keep the code emitted here (as of now plain calls to System.Convert.ToBlaBla methods)
             behaviorally.equiv.wrt. BoxesRunTime.unboxToBlaBla methods
             (case null: that's easy, case boxed: track changes to unboxBlaBla)
         (2) See also: asInstanceOf to cast from Any to number,
             tracked in http://lampsvn.epfl.ch/trac/scala/ticket/4437  */
      <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#642719" title="Unit" id="792022">BOOL</a>   =&gt; <a href="#791942" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><a href="#792030" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Call</span>, <a href="#785523" title="=&gt; ch.epfl.lamp.compiler.msil.MethodInfo">toBool</a><span class="delimiter">)</span>
      <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#642721" title="Unit" id="792023">BYTE</a>   =&gt; <a href="#791942" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><a href="#792030" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Call</span>, <a href="#785525" title="=&gt; ch.epfl.lamp.compiler.msil.MethodInfo">toSByte</a><span class="delimiter">)</span>
      <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#642723" title="Unit" id="792024">SHORT</a>  =&gt; <a href="#791942" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><a href="#792030" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Call</span>, <a href="#785527" title="=&gt; ch.epfl.lamp.compiler.msil.MethodInfo">toShort</a><span class="delimiter">)</span>
      <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#642725" title="Unit" id="792025">CHAR</a>   =&gt; <a href="#791942" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><a href="#792030" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Call</span>, <a href="#785529" title="=&gt; ch.epfl.lamp.compiler.msil.MethodInfo">toChar</a><span class="delimiter">)</span>
      <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#642727" title="Unit" id="792026">INT</a>    =&gt; <a href="#791942" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><a href="#792030" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Call</span>, <a href="#785531" title="=&gt; ch.epfl.lamp.compiler.msil.MethodInfo">toInt</a><span class="delimiter">)</span>
      <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#642729" title="Unit" id="792027">LONG</a>   =&gt; <a href="#791942" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><a href="#792030" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Call</span>, <a href="#785533" title="=&gt; ch.epfl.lamp.compiler.msil.MethodInfo">toLong</a><span class="delimiter">)</span>
      <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#642731" title="Unit" id="792028">FLOAT</a>  =&gt; <a href="#791942" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><a href="#792030" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Call</span>, <a href="#785535" title="=&gt; ch.epfl.lamp.compiler.msil.MethodInfo">toFloat</a><span class="delimiter">)</span>
      <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#642733" title="Unit" id="792029">DOUBLE</a> =&gt; <a href="#791942" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><a href="#792030" title="(x: Unit)Unit" class="delimiter">(</a><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Call</span>, <a href="#785537" title="=&gt; ch.epfl.lamp.compiler.msil.MethodInfo">toDouble</a><span class="delimiter">)</span>
      <span class="keyword">case</span> REFERENCE<a href="#792003" title="Unit" id="792014" class="delimiter">(</a>cls<span class="delimiter">)</span> <span class="keyword">if</span> <a href="../../symtab/SymbolLoaders.scala.html#650372" title="GenMSIL.this.global.loaders.clrTypes.type">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#730909" title="(cls: GenMSIL.this.global.loaders.clrTypes.global.Symbol)Boolean">isValueType</a><span class="delimiter">(</span>cls<span class="delimiter">)</span> =&gt;
        <a href="#791942" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.Type)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Unbox</span>, <a href="#785645" title="(t: GenMSIL.this.global.icodes.TypeKind)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">(</span><a href="#791943" title="GenMSIL.this.global.icodes.TypeKind">boxType</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <a href="#791942" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.Type)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCodes.type">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldobj</span>, <a href="#785645" title="(t: GenMSIL.this.global.icodes.TypeKind)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">(</span><a href="#791943" title="GenMSIL.this.global.icodes.TypeKind">boxType</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">case</span> REFERENCE<a href="#792003" title="Unit" id="792017" class="delimiter">(</a>_<span class="delimiter">)</span> | ARRAY<a href="#792003" title="Boolean" id="792020" class="delimiter">(</a>_<span class="delimiter">)</span> =&gt;
        <a href="../../Global.scala.html#559532" title="(msg: String)Unit">warning</a><span class="delimiter">(</span><span title="String(&quot;Tried to UNBOX a non-valuetype.&quot;)" class="string">&quot;Tried to UNBOX a non-valuetype.&quot;</span><span class="delimiter">)</span>
        <span title="Unit" class="delimiter">(</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    // #####################################################################
    // get and create methods / constructors

    <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.ConstructorInfo" id="785672">getConstructor</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="790832">sym</a>: <a href="../../../../reflect/internal/Symbols.scala.html#441132" title="GenMSIL.this.global.Symbol">Symbol</a><span class="delimiter">)</span>: <span title="ch.epfl.lamp.compiler.msil.ConstructorInfo">ConstructorInfo</span> = <a href="../../symtab/clr/CLRTypes.scala.html#730895" title="=&gt; scala.collection.mutable.Map[GenMSIL.this.global.loaders.clrTypes.global.Symbol,ch.epfl.lamp.compiler.msil.ConstructorInfo]">constructors</a>.<a href="../../../../collection/MapLike.scala.html#78410" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol)Option[ch.epfl.lamp.compiler.msil.ConstructorInfo]">get</a><a href="#795485" title="(x: ch.epfl.lamp.compiler.msil.ConstructorInfo)ch.epfl.lamp.compiler.msil.ConstructorInfo" class="delimiter">(</a><a href="#790832" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> Some<a href="#795481" title="ch.epfl.lamp.compiler.msil.ConstructorInfo" id="795482" class="delimiter">(</a>constr<span class="delimiter">)</span> =&gt; <a href="#795485" title="(x: ch.epfl.lamp.compiler.msil.ConstructorInfo)ch.epfl.lamp.compiler.msil.ConstructorInfo">constr</a>
      <span class="keyword">case</span> <a href="../../../../Option.scala.html#2498" title="ch.epfl.lamp.compiler.msil.ConstructorInfo" id="795484">None</a> =&gt;
        <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.Type" id="795466">mClass</a> = <a href="#785648" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.Type">getType</a><span class="delimiter">(</span><a href="#790832" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443379" title="=&gt; GenMSIL.this.global.Symbol">owner</a><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.ConstructorInfo" id="795467">constr</a> = <a href="#795466" title="ch.epfl.lamp.compiler.msil.Type">mClass</a>.<span title="(x$1: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.ConstructorInfo">GetConstructor</span><span class="delimiter">(</span><a href="#785647" title="(sym: GenMSIL.this.global.Symbol)Array[ch.epfl.lamp.compiler.msil.Type]">msilParamTypes</a><span class="delimiter">(</span><a href="#790832" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span title="ch.epfl.lamp.compiler.msil.ConstructorInfo" class="keyword">if</span> <span class="delimiter">(</span><a href="#795467" title="ch.epfl.lamp.compiler.msil.ConstructorInfo">constr</a> <span title="(x$1: AnyRef)Boolean">eq</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <span class="delimiter">{</span>
          java.lang.<span title="System.type">System</span>.<span title="java.io.PrintStream">out</span>.<span title="(x$1: String)Unit">println</span><span class="delimiter">(</span><span title="String(&quot;Cannot find constructor &quot;)" class="string">&quot;Cannot find constructor &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#790832" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443379" title="=&gt; GenMSIL.this.global.Symbol">owner</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;::&quot;)" class="string">&quot;::&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#790832" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443152" title="=&gt; sym.NameType">name</a><span class="delimiter">)</span>
          java.lang.<span title="System.type">System</span>.<span title="java.io.PrintStream">out</span>.<span title="(x$1: String)Unit">println</span><span class="delimiter">(</span><span title="String(&quot;scope = &quot;)" class="string">&quot;scope = &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#790832" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443379" title="=&gt; GenMSIL.this.global.Symbol">owner</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443425" title="=&gt; GenMSIL.this.global.Type">tpe</a>.<a href="../../../../reflect/internal/Types.scala.html#442019" title="=&gt; GenMSIL.this.global.Scope">decls</a><span class="delimiter">)</span>
          <a href="../../Global.scala.html#559537" title="(msg: String)Nothing">abort</a><span class="delimiter">(</span><a href="#790832" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443398" title="=&gt; String">fullName</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
        <span class="keyword">else</span> <span class="delimiter">{</span>
          <a href="#785673" title="(sym: GenMSIL.this.global.Symbol, cInfo: ch.epfl.lamp.compiler.msil.ConstructorInfo)Unit">mapConstructor</a><span class="delimiter">(</span><a href="#790832" title="GenMSIL.this.global.Symbol">sym</a>, <a href="#795467" title="ch.epfl.lamp.compiler.msil.ConstructorInfo">constr</a><span class="delimiter">)</span>
          <a href="#795467" title="ch.epfl.lamp.compiler.msil.ConstructorInfo">constr</a>
        <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol, cInfo: ch.epfl.lamp.compiler.msil.ConstructorInfo)Unit" id="785673">mapConstructor</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="794872">sym</a>: <a href="../../../../reflect/internal/Symbols.scala.html#441132" title="GenMSIL.this.global.Symbol">Symbol</a>, <a title="ch.epfl.lamp.compiler.msil.ConstructorInfo" id="794873">cInfo</a>: <span title="ch.epfl.lamp.compiler.msil.ConstructorInfo">ConstructorInfo</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
      <a href="../../../../collection/mutable/MapLike.scala.html#78496" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol, value: ch.epfl.lamp.compiler.msil.ConstructorInfo)Unit">constructors</a><span class="delimiter">(</span><a href="#794872" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span> = <a href="#794873" title="ch.epfl.lamp.compiler.msil.ConstructorInfo">cInfo</a>
    <span class="delimiter">}</span>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.MethodInfo" id="785674">getMethod</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="791712">sym</a>: <a href="../../../../reflect/internal/Symbols.scala.html#441132" title="GenMSIL.this.global.Symbol">Symbol</a><span class="delimiter">)</span>: <span title="ch.epfl.lamp.compiler.msil.MethodInfo">MethodInfo</span> = <span class="delimiter">{</span>

        <a href="../../symtab/clr/CLRTypes.scala.html#730897" title="=&gt; scala.collection.mutable.Map[GenMSIL.this.global.loaders.clrTypes.global.Symbol,ch.epfl.lamp.compiler.msil.MethodInfo]">methods</a>.<a href="../../../../collection/MapLike.scala.html#78410" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol)Option[ch.epfl.lamp.compiler.msil.MethodInfo]">get</a><a href="#795538" title="(x: ch.epfl.lamp.compiler.msil.MethodInfo)ch.epfl.lamp.compiler.msil.MethodInfo" class="delimiter">(</a><a href="#791712" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> Some<a href="#795534" title="ch.epfl.lamp.compiler.msil.MethodInfo" id="795535" class="delimiter">(</a>method<span class="delimiter">)</span> =&gt; <a href="#795538" title="(x: ch.epfl.lamp.compiler.msil.MethodInfo)ch.epfl.lamp.compiler.msil.MethodInfo">method</a>
        <span class="keyword">case</span> <a href="../../../../Option.scala.html#2498" title="ch.epfl.lamp.compiler.msil.MethodInfo" id="795537">None</a> =&gt;
          <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.Type" id="795497">mClass</a> = <a href="#785648" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.Type">getType</a><span class="delimiter">(</span><a href="#791712" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443379" title="=&gt; GenMSIL.this.global.Symbol">owner</a><span class="delimiter">)</span>
          <span class="keyword">try</span> <span class="delimiter">{</span>
            <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.MethodInfo" id="795498">method</a> = <a href="#795497" title="ch.epfl.lamp.compiler.msil.Type">mClass</a>.<span title="(x$1: String, x$2: Array[ch.epfl.lamp.compiler.msil.Type], x$3: ch.epfl.lamp.compiler.msil.Type)ch.epfl.lamp.compiler.msil.MethodInfo">GetMethod</span><span class="delimiter">(</span><a href="#785633" title="(sym: GenMSIL.this.global.Symbol)String">msilName</a><span class="delimiter">(</span><a href="#791712" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span>, <a href="#785647" title="(sym: GenMSIL.this.global.Symbol)Array[ch.epfl.lamp.compiler.msil.Type]">msilParamTypes</a><span class="delimiter">(</span><a href="#791712" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span>,
                                          <a href="#785646" title="(tpe: GenMSIL.this.global.Type)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">(</span><a href="#791712" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443425" title="=&gt; GenMSIL.this.global.Type">tpe</a>.<a href="../../../../reflect/internal/Types.scala.html#442002" title="=&gt; GenMSIL.this.global.Type">resultType</a><span class="delimiter">)</span><span class="delimiter">)</span>
            <span title="ch.epfl.lamp.compiler.msil.MethodInfo" class="keyword">if</span> <span class="delimiter">(</span><a href="#795498" title="ch.epfl.lamp.compiler.msil.MethodInfo">method</a> <span title="(x$1: AnyRef)Boolean">eq</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <span class="delimiter">{</span>
              java.lang.<span title="System.type">System</span>.<span title="java.io.PrintStream">out</span>.<span title="(x$1: String)Unit">println</span><span class="delimiter">(</span><span title="String(&quot;Cannot find method &quot;)" class="string">&quot;Cannot find method &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#791712" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443379" title="=&gt; GenMSIL.this.global.Symbol">owner</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;::&quot;)" class="string">&quot;::&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#785633" title="(sym: GenMSIL.this.global.Symbol)String">msilName</a><span class="delimiter">(</span><a href="#791712" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span><span class="delimiter">)</span>
              java.lang.<span title="System.type">System</span>.<span title="java.io.PrintStream">out</span>.<span title="(x$1: String)Unit">println</span><span class="delimiter">(</span><span title="String(&quot;scope = &quot;)" class="string">&quot;scope = &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#791712" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443379" title="=&gt; GenMSIL.this.global.Symbol">owner</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443425" title="=&gt; GenMSIL.this.global.Type">tpe</a>.<a href="../../../../reflect/internal/Types.scala.html#442019" title="=&gt; GenMSIL.this.global.Scope">decls</a><span class="delimiter">)</span>
              <a href="../../Global.scala.html#559537" title="(msg: String)Nothing">abort</a><span class="delimiter">(</span><a href="#791712" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443398" title="=&gt; String">fullName</a><span class="delimiter">)</span>
            <span class="delimiter">}</span>
            <span class="keyword">else</span> <span class="delimiter">{</span>
              <a href="#785675" title="(sym: GenMSIL.this.global.Symbol, mInfo: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">mapMethod</a><span class="delimiter">(</span><a href="#791712" title="GenMSIL.this.global.Symbol">sym</a>, <a href="#795498" title="ch.epfl.lamp.compiler.msil.MethodInfo">method</a><span class="delimiter">)</span>
              <a href="#795498" title="ch.epfl.lamp.compiler.msil.MethodInfo">method</a>
            <span class="delimiter">}</span>
          <span class="delimiter">}</span>
          <span class="keyword">catch</span> <span class="delimiter">{</span>
            <span class="keyword">case</span> <a title="Nothing" id="795527">e</a>: <span title="Exception">Exception</span> =&gt;
              <a href="../../../../Console.scala.html#227" title="Console.type">Console</a>.<a href="../../../../Console.scala.html#64301" title="(x: Any)Unit">println</a><span class="delimiter">(</span><span title="String(&quot;While looking up &quot;)" class="string">&quot;While looking up &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#795497" title="ch.epfl.lamp.compiler.msil.Type">mClass</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;::&quot;)" class="string">&quot;::&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#791712" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443556" title="=&gt; String">nameString</a><span class="delimiter">)</span>
            <a href="../../../../Console.scala.html#227" title="Console.type">Console</a>.<a href="../../../../Console.scala.html#64301" title="(x: Any)Unit">println</a><span class="delimiter">(</span><span title="String(&quot;\t&quot;)" class="string">&quot;\t&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#785681" title="(sym: GenMSIL.this.global.Symbol)String">showsym</a><span class="delimiter">(</span><a href="#791712" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span><span class="delimiter">)</span>
            <span title="Nothing" class="keyword">throw</span> <a href="#795527" title="Exception">e</a>
          <span class="delimiter">}</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    /*
     * add a mapping between sym and mInfo
     */
    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol, mInfo: ch.epfl.lamp.compiler.msil.MethodInfo)Unit" id="785675">mapMethod</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="795018">sym</a>: <a href="../../../../reflect/internal/Symbols.scala.html#441132" title="GenMSIL.this.global.Symbol">Symbol</a>, <a title="ch.epfl.lamp.compiler.msil.MethodInfo" id="795019">mInfo</a>: <span title="ch.epfl.lamp.compiler.msil.MethodInfo">MethodInfo</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="../../Global.scala.html#559533" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a> <span class="delimiter">(</span><a href="#795019" title="ch.epfl.lamp.compiler.msil.MethodInfo">mInfo</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span>, <a href="#795019" title="ch.epfl.lamp.compiler.msil.MethodInfo">mInfo</a><span class="delimiter">)</span>
      <a href="../../../../collection/mutable/MapLike.scala.html#78496" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol, value: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">methods</a><span class="delimiter">(</span><a href="#795018" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span> = <a href="#795019" title="ch.epfl.lamp.compiler.msil.MethodInfo">mInfo</a>
    <span class="delimiter">}</span>

    /*
     * add mapping between sym and method with newName, paramTypes of newClass
     */
    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol, newClass: ch.epfl.lamp.compiler.msil.Type, newName: String, paramTypes: Array[ch.epfl.lamp.compiler.msil.Type])Unit" id="785676">mapMethod</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="795014">sym</a>: <a href="../../../../reflect/internal/Symbols.scala.html#441132" title="GenMSIL.this.global.Symbol">Symbol</a>, <a title="ch.epfl.lamp.compiler.msil.Type" id="795015">newClass</a>: <span title="ch.epfl.lamp.compiler.msil.Type">MsilType</span>, <a title="String" id="795016">newName</a>: <span title="String">String</span>, <a title="Array[ch.epfl.lamp.compiler.msil.Type]" id="795017">paramTypes</a>: <a href="../../../../Array.scala.html#292" title="Array[ch.epfl.lamp.compiler.msil.Type]">Array</a><span class="delimiter">[</span>MsilType<span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.MethodInfo" id="795555">methodInfo</a> = <a href="#795015" title="ch.epfl.lamp.compiler.msil.Type">newClass</a>.<span title="(x$1: String, x$2: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.MethodInfo">GetMethod</span><span class="delimiter">(</span><a href="#795016" title="String">newName</a>, <a href="#795017" title="Array[ch.epfl.lamp.compiler.msil.Type]">paramTypes</a><span class="delimiter">)</span>
      <a href="../../Global.scala.html#559533" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a><span class="delimiter">(</span><a href="#795555" title="ch.epfl.lamp.compiler.msil.MethodInfo">methodInfo</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span>, <span title="String(&quot;Can\'t find mapping for &quot;)" class="string">&quot;Can't find mapping for &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#795014" title="GenMSIL.this.global.Symbol">sym</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; -&gt; &quot;)" class="string">&quot; -&gt; &quot;</span> <span title="(x$1: Any)String">+</span>
             <a href="#795016" title="String">newName</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;(&quot;)" class="string">&quot;(&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#795017" title="Array[ch.epfl.lamp.compiler.msil.Type]">paramTypes</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;)&quot;)" class="string">&quot;)&quot;</span><span class="delimiter">)</span>
      <a href="#785675" title="(sym: GenMSIL.this.global.Symbol, mInfo: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">mapMethod</a><span class="delimiter">(</span><a href="#795014" title="GenMSIL.this.global.Symbol">sym</a>, <a href="#795555" title="ch.epfl.lamp.compiler.msil.MethodInfo">methodInfo</a><span class="delimiter">)</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#795555" title="ch.epfl.lamp.compiler.msil.MethodInfo">methodInfo</a>.<span title="()Boolean">IsStatic</span><span class="delimiter">)</span>
        <a href="#785547" title="=&gt; scala.collection.mutable.HashSet[GenMSIL.this.global.Symbol]">dynToStatMapped</a> <a href="../../../../collection/mutable/HashSet.scala.html#141570" title="(elem: GenMSIL.this.global.Symbol)BytecodeGenerator.this.dynToStatMapped.type">+=</a> <a href="#795014" title="GenMSIL.this.global.Symbol">sym</a>
    <span class="delimiter">}</span>

    /*
     * add mapping between method with name and paramTypes of clazz to
     * method with newName and newParamTypes of newClass (used for instance
     * for &quot;wait&quot;)
     */
    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(clazz: GenMSIL.this.global.Symbol, name: GenMSIL.this.global.Name, paramTypes: Array[GenMSIL.this.global.Type], newClass: ch.epfl.lamp.compiler.msil.Type, newName: String, newParamTypes: Array[ch.epfl.lamp.compiler.msil.Type])Unit" id="785677">mapMethod</a><span class="delimiter">(</span>
      <a title="GenMSIL.this.global.Symbol" id="795008">clazz</a>: <a href="../../../../reflect/internal/Symbols.scala.html#441132" title="GenMSIL.this.global.Symbol">Symbol</a>, <a title="GenMSIL.this.global.Name" id="795009">name</a>: <a href="../../../../reflect/internal/Names.scala.html#440792" title="GenMSIL.this.global.Name">Name</a>, <a title="Array[GenMSIL.this.global.Type]" id="795010">paramTypes</a>: <a href="../../../../Array.scala.html#292" title="Array[GenMSIL.this.global.Type]">Array</a><span class="delimiter">[</span>Type<span class="delimiter">]</span>,
      <a title="ch.epfl.lamp.compiler.msil.Type" id="795011">newClass</a>: <span title="ch.epfl.lamp.compiler.msil.Type">MsilType</span>, <a title="String" id="795012">newName</a>: <span title="String">String</span>, <a title="Array[ch.epfl.lamp.compiler.msil.Type]" id="795013">newParamTypes</a>: <a href="../../../../Array.scala.html#292" title="Array[ch.epfl.lamp.compiler.msil.Type]">Array</a><span class="delimiter">[</span>MsilType<span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="GenMSIL.this.global.Symbol" id="795579">methodSym</a> = <a href="#785680" title="(clazz: GenMSIL.this.global.Symbol, name: GenMSIL.this.global.Name, paramTypes: Array[GenMSIL.this.global.Type])GenMSIL.this.global.Symbol">lookupMethod</a><span class="delimiter">(</span><a href="#795008" title="GenMSIL.this.global.Symbol">clazz</a>, <a href="#795009" title="GenMSIL.this.global.Name">name</a>, <a href="#795010" title="Array[GenMSIL.this.global.Type]">paramTypes</a><span class="delimiter">)</span>
        <a href="../../Global.scala.html#559533" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a><span class="delimiter">(</span><a href="#795579" title="GenMSIL.this.global.Symbol">methodSym</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span>, <span title="String(&quot;cannot find method &quot;)" class="string">&quot;cannot find method &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#795009" title="GenMSIL.this.global.Name">name</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;(&quot;)" class="string">&quot;(&quot;</span> <span title="(x$1: Any)String">+</span>
               <a href="#795010" title="Array[GenMSIL.this.global.Type]">paramTypes</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;)&quot;)" class="string">&quot;)&quot;</span> <span title="(x$1: Any)String">+</span> <span title="String(&quot; in class &quot;)" class="string">&quot; in class &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#795008" title="GenMSIL.this.global.Symbol">clazz</a><span class="delimiter">)</span>
        <a href="#785676" title="(sym: GenMSIL.this.global.Symbol, newClass: ch.epfl.lamp.compiler.msil.Type, newName: String, paramTypes: Array[ch.epfl.lamp.compiler.msil.Type])Unit">mapMethod</a><span class="delimiter">(</span><a href="#795579" title="GenMSIL.this.global.Symbol">methodSym</a>, <a href="#795011" title="ch.epfl.lamp.compiler.msil.Type">newClass</a>, <a href="#795012" title="String">newName</a>, <a href="#795013" title="Array[ch.epfl.lamp.compiler.msil.Type]">newParamTypes</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>

    /*
     * add mapping for member with name and paramTypes to member
     * newName of newClass (same parameters)
     */
    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(clazz: GenMSIL.this.global.Symbol, name: GenMSIL.this.global.Name, paramTypes: Array[GenMSIL.this.global.Type], newClass: ch.epfl.lamp.compiler.msil.Type, newName: String)Unit" id="785678">mapMethod</a><span class="delimiter">(</span>
      <a title="GenMSIL.this.global.Symbol" id="795003">clazz</a>: <a href="../../../../reflect/internal/Symbols.scala.html#441132" title="GenMSIL.this.global.Symbol">Symbol</a>, <a title="GenMSIL.this.global.Name" id="795004">name</a>: <a href="../../../../reflect/internal/Names.scala.html#440792" title="GenMSIL.this.global.Name">Name</a>, <a title="Array[GenMSIL.this.global.Type]" id="795005">paramTypes</a>: <a href="../../../../Array.scala.html#292" title="Array[GenMSIL.this.global.Type]">Array</a><span class="delimiter">[</span>Type<span class="delimiter">]</span>,
      <a title="ch.epfl.lamp.compiler.msil.Type" id="795006">newClass</a>: <span title="ch.epfl.lamp.compiler.msil.Type">MsilType</span>, <a title="String" id="795007">newName</a>: <span title="String">String</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#785677" title="(clazz: GenMSIL.this.global.Symbol, name: GenMSIL.this.global.Name, paramTypes: Array[GenMSIL.this.global.Type], newClass: ch.epfl.lamp.compiler.msil.Type, newName: String, newParamTypes: Array[ch.epfl.lamp.compiler.msil.Type])Unit">mapMethod</a><span class="delimiter">(</span><a href="#795003" title="GenMSIL.this.global.Symbol">clazz</a>, <a href="#795004" title="GenMSIL.this.global.Name">name</a>, <a href="#795005" title="Array[GenMSIL.this.global.Type]">paramTypes</a>, <a href="#795006" title="ch.epfl.lamp.compiler.msil.Type">newClass</a>, <a href="#795007" title="String">newName</a>, <a href="../../../../Predef.scala.html#8521" title="(xs: Array[GenMSIL.this.global.Type])scala.collection.mutable.ArrayOps[GenMSIL.this.global.Type]">paramTypes</a> <a href="../../../../collection/TraversableLike.scala.html#58971" title="(f: GenMSIL.this.global.Type =&gt; ch.epfl.lamp.compiler.msil.Type)(implicit bf: scala.collection.generic.CanBuildFrom[Array[GenMSIL.this.global.Type],ch.epfl.lamp.compiler.msil.Type,Array[ch.epfl.lamp.compiler.msil.Type]])Array[ch.epfl.lamp.compiler.msil.Type]">map</a> <a href="#785646" title="(tpe: GenMSIL.this.global.Type)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>

    /*
     * add mapping for all methods with name of clazz to the corresponding
     * method (same parameters) with newName of newClass
     */
    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(clazz: GenMSIL.this.global.Symbol, name: GenMSIL.this.global.Name, newClass: ch.epfl.lamp.compiler.msil.Type, newName: String)Unit" id="785679">mapMethod</a><span class="delimiter">(</span>
      <a title="GenMSIL.this.global.Symbol" id="794999">clazz</a>: <a href="../../../../reflect/internal/Symbols.scala.html#441132" title="GenMSIL.this.global.Symbol">Symbol</a>, <a title="GenMSIL.this.global.Name" id="795000">name</a>: <a href="../../../../reflect/internal/Names.scala.html#440792" title="GenMSIL.this.global.Name">Name</a>,
      <a title="ch.epfl.lamp.compiler.msil.Type" id="795001">newClass</a>: <span title="ch.epfl.lamp.compiler.msil.Type">MsilType</span>, <a title="String" id="795002">newName</a>: <span title="String">String</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="GenMSIL.this.global.Symbol" id="796096">memberSym</a>: <a href="../../../../reflect/internal/Symbols.scala.html#441132" title="GenMSIL.this.global.Symbol">Symbol</a> = <a href="#794999" title="GenMSIL.this.global.Symbol">clazz</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443425" title="=&gt; GenMSIL.this.global.Type">tpe</a>.<a href="../../../../reflect/internal/Types.scala.html#442028" title="(name: GenMSIL.this.global.Name)GenMSIL.this.global.Symbol">member</a><span class="delimiter">(</span><a href="#795000" title="GenMSIL.this.global.Name">name</a><span class="delimiter">)</span>
        <a href="#796096" title="GenMSIL.this.global.Symbol">memberSym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443425" title="=&gt; GenMSIL.this.global.Type">tpe</a> <span class="keyword">match</span> <span class="delimiter">{</span>
          // alternatives: List[Symbol]
          <span class="keyword">case</span> OverloadedType<a href="#796144" title="Unit" id="796147" class="delimiter">(</a>_, alternatives<span class="delimiter">)</span> =&gt;
            alternatives.<a href="../../../../collection/LinearSeqOptimized.scala.html#76166" title="(f: GenMSIL.this.global.Symbol =&gt; Unit)Unit">foreach</a><a href="#796150" title="(x: Unit)Unit" class="delimiter">(</a><a title="GenMSIL.this.global.Symbol" id="796123">s</a> =&gt; <a href="#785676" title="(sym: GenMSIL.this.global.Symbol, newClass: ch.epfl.lamp.compiler.msil.Type, newName: String, paramTypes: Array[ch.epfl.lamp.compiler.msil.Type])Unit">mapMethod</a><span class="delimiter">(</span><a href="#796123" title="GenMSIL.this.global.Symbol">s</a>, <a href="#795001" title="ch.epfl.lamp.compiler.msil.Type">newClass</a>, <a href="#795002" title="String">newName</a>, <a href="#785647" title="(sym: GenMSIL.this.global.Symbol)Array[ch.epfl.lamp.compiler.msil.Type]">msilParamTypes</a><span class="delimiter">(</span><a href="#796123" title="GenMSIL.this.global.Symbol">s</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>

          // paramTypes: List[Type], resType: Type
          <span class="keyword">case</span> MethodType<a href="#796144" title="Unit" id="796149" class="delimiter">(</a>params, resType<span class="delimiter">)</span> =&gt;
            <a href="#785676" title="(sym: GenMSIL.this.global.Symbol, newClass: ch.epfl.lamp.compiler.msil.Type, newName: String, paramTypes: Array[ch.epfl.lamp.compiler.msil.Type])Unit">mapMethod</a><a href="#796150" title="(x: Unit)Unit" class="delimiter">(</a><a href="#796096" title="GenMSIL.this.global.Symbol">memberSym</a>, <a href="#795001" title="ch.epfl.lamp.compiler.msil.Type">newClass</a>, <a href="#795002" title="String">newName</a>, <a href="#785647" title="(sym: GenMSIL.this.global.Symbol)Array[ch.epfl.lamp.compiler.msil.Type]">msilParamTypes</a><span class="delimiter">(</span><a href="#796096" title="GenMSIL.this.global.Symbol">memberSym</a><span class="delimiter">)</span><span class="delimiter">)</span>

          <span class="keyword">case</span> _ =&gt;
            <a href="../../Global.scala.html#559537" title="(msg: String)Nothing">abort</a><a href="#796150" title="(x: Unit)Unit" class="delimiter">(</a><span title="String(&quot;member not found: &quot;)" class="string">&quot;member not found: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#794999" title="GenMSIL.this.global.Symbol">clazz</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;, &quot;)" class="string">&quot;, &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#795000" title="GenMSIL.this.global.Name">name</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>


    /*
     * find the method in clazz with name and paramTypes
     */
    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(clazz: GenMSIL.this.global.Symbol, name: GenMSIL.this.global.Name, paramTypes: Array[GenMSIL.this.global.Type])GenMSIL.this.global.Symbol" id="785680">lookupMethod</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="795580">clazz</a>: <a href="../../../../reflect/internal/Symbols.scala.html#441132" title="GenMSIL.this.global.Symbol">Symbol</a>, <a title="GenMSIL.this.global.Name" id="795581">name</a>: <a href="../../../../reflect/internal/Names.scala.html#440792" title="GenMSIL.this.global.Name">Name</a>, <a title="Array[GenMSIL.this.global.Type]" id="795582">paramTypes</a>: <a href="../../../../Array.scala.html#292" title="Array[GenMSIL.this.global.Type]">Array</a><span class="delimiter">[</span>Type<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../../../reflect/internal/Symbols.scala.html#441132" title="GenMSIL.this.global.Symbol">Symbol</a> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="GenMSIL.this.global.Symbol" id="796156">memberSym</a> = <a href="#795580" title="GenMSIL.this.global.Symbol">clazz</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443425" title="=&gt; GenMSIL.this.global.Type">tpe</a>.<a href="../../../../reflect/internal/Types.scala.html#442028" title="(name: GenMSIL.this.global.Name)GenMSIL.this.global.Symbol">member</a><span class="delimiter">(</span><a href="#795581" title="GenMSIL.this.global.Name">name</a><span class="delimiter">)</span>
      <a href="#796156" title="GenMSIL.this.global.Symbol">memberSym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443425" title="=&gt; GenMSIL.this.global.Type">tpe</a> <span class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> OverloadedType<a href="#796225" title="GenMSIL.this.global.Symbol" id="796228" class="delimiter">(</a>_, alternatives<span class="delimiter">)</span> =&gt;
          alternatives.<a href="../../../../collection/LinearSeqOptimized.scala.html#76172" title="(p: GenMSIL.this.global.Symbol =&gt; Boolean)Option[GenMSIL.this.global.Symbol]">find</a><a href="#796233" title="(x: GenMSIL.this.global.Symbol)GenMSIL.this.global.Symbol" class="delimiter">(</a><a title="GenMSIL.this.global.Symbol" id="796170">s</a> =&gt; <span class="delimiter">{</span>
            <span class="keyword">var</span> <a title="Int" id="796171">i</a>: <a href="../../../../Int.scala.html#508" title="Int">Int</a> = <span title="Int(0)" class="int">0</span>
            <span class="keyword">var</span> <a title="Boolean" id="796172">typesOK</a>: <a href="../../../../Boolean.scala.html#2218" title="Boolean">Boolean</a> = <span title="Boolean(true)" class="keyword">true</span>
            <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#795582" title="Array[GenMSIL.this.global.Type]">paramTypes</a>.<a href="../../../../Array.scala.html#57449" title="=&gt; Int">length</a> <a href="../../../../Int.scala.html#57891" title="(x: Int)Boolean">==</a> <a href="#796170" title="GenMSIL.this.global.Symbol">s</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443425" title="=&gt; GenMSIL.this.global.Type">tpe</a>.<a href="../../../../reflect/internal/Types.scala.html#442010" title="=&gt; List[GenMSIL.this.global.Type]">paramTypes</a>.<a href="../../../../collection/LinearSeqOptimized.scala.html#76164" title="=&gt; Int">length</a><span class="delimiter">)</span> <span class="delimiter">{</span>
              <span title="Unit" class="keyword">while</span><span class="delimiter">(</span><a href="#796171" title="Int">i</a> <a href="../../../../Int.scala.html#57905" title="(x: Int)Boolean">&lt;</a> <a href="#795582" title="Array[GenMSIL.this.global.Type]">paramTypes</a>.<a href="../../../../Array.scala.html#57449" title="=&gt; Int">length</a><span class="delimiter">)</span> <a href="#796179" title="()Unit" class="delimiter">{</a>
                <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../../../Array.scala.html#57450" title="(i: Int)GenMSIL.this.global.Type">paramTypes</a><span class="delimiter">(</span><a href="#796171" title="Int">i</a><span class="delimiter">)</span> <span title="(x$1: AnyRef)Boolean">!=</span> <a href="#796170" title="GenMSIL.this.global.Symbol">s</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443425" title="=&gt; GenMSIL.this.global.Type">tpe</a>.<a href="../../../../collection/LinearSeqOptimized.scala.html#76165" title="(n: Int)GenMSIL.this.global.Type">paramTypes</a><span class="delimiter">(</span><a href="#796171" title="Int">i</a><span class="delimiter">)</span><span class="delimiter">)</span>
                  <a href="#796172" title="Boolean">typesOK</a> = <span title="Boolean(false)" class="keyword">false</span>
                <a href="#796171" title="Int">i</a> <a href="../../../../Int.scala.html#57948" title="(x: Int)Int">+=</a> <span title="Int(1)" class="int">1</span>
              <span class="delimiter">}</span>
            <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
              <a href="#796172" title="Boolean">typesOK</a> = <span title="Boolean(false)" class="keyword">false</span>
            <span class="delimiter">}</span>
            <a href="#796172" title="Boolean">typesOK</a>
          <span class="delimiter">}</span><span class="delimiter">)</span> <span class="keyword">match</span> <span class="delimiter">{</span>
            <span class="keyword">case</span> Some<a href="#796208" title="GenMSIL.this.global.Symbol" id="796209" class="delimiter">(</a>sym<span class="delimiter">)</span> =&gt; <a href="#796212" title="(x: GenMSIL.this.global.Symbol)GenMSIL.this.global.Symbol">sym</a>
            <span class="keyword">case</span> <a href="../../../../Option.scala.html#2498" title="GenMSIL.this.global.Symbol" id="796211">None</a> =&gt; <a href="../../Global.scala.html#559537" title="(msg: String)Nothing">abort</a><a href="#796212" title="(x: GenMSIL.this.global.Symbol)GenMSIL.this.global.Symbol" class="delimiter">(</a><span title="String(&quot;member of &quot;)" class="string">&quot;member of &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#795580" title="GenMSIL.this.global.Symbol">clazz</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;, &quot;)" class="string">&quot;, &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#795581" title="GenMSIL.this.global.Name">name</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;(&quot;)" class="string">&quot;(&quot;</span> <span title="(x$1: Any)String">+</span>
                               <a href="#795582" title="Array[GenMSIL.this.global.Type]">paramTypes</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;) not found&quot;)" class="string">&quot;) not found&quot;</span><span class="delimiter">)</span>
          <span class="delimiter">}</span>

        <span class="keyword">case</span> MethodType<a href="#796225" title="GenMSIL.this.global.Symbol" id="796232" class="delimiter">(</a>_, _<span class="delimiter">)</span> =&gt; <a href="#796233" title="(x: GenMSIL.this.global.Symbol)GenMSIL.this.global.Symbol">memberSym</a>

        <span class="keyword">case</span> _ =&gt; <a href="../../Global.scala.html#559537" title="(msg: String)Nothing">abort</a><a href="#796233" title="(x: GenMSIL.this.global.Symbol)GenMSIL.this.global.Symbol" class="delimiter">(</a><span title="String(&quot;member not found: &quot;)" class="string">&quot;member not found: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#795581" title="GenMSIL.this.global.Name">name</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; of &quot;)" class="string">&quot; of &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#795580" title="GenMSIL.this.global.Symbol">clazz</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol)String" id="785681">showsym</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="789211">sym</a>: <a href="../../../../reflect/internal/Symbols.scala.html#441132" title="GenMSIL.this.global.Symbol">Symbol</a><span class="delimiter">)</span>: <span title="String">String</span> = <span class="delimiter">(</span><a href="#789211" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443559" title="()String">toString</a> <span title="(x$1: Any)String">+</span>
      <span title="String(&quot;\n  symbol = &quot;)" class="string">&quot;\n  symbol = &quot;</span> <span title="(x$1: Any)String">+</span> <a href="../../symtab/package.scala.html#57302" title="=&gt; reflect.internal.Flags.type">Flags</a>.<a href="../../../../reflect/internal/Flags.scala.html#441022" title="(flags: Long)String">flagsToString</a><span class="delimiter">(</span><a href="#789211" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443310" title="=&gt; Long">flags</a><span class="delimiter">)</span> <span title="(x$1: Any)String">+</span> <span title="String(&quot; &quot;)" class="string">&quot; &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#789211" title="GenMSIL.this.global.Symbol">sym</a> <span title="(x$1: Any)String">+</span>
      <span title="String(&quot;\n  owner  = &quot;)" class="string">&quot;\n  owner  = &quot;</span> <span title="(x$1: Any)String">+</span> <a href="../../symtab/package.scala.html#57302" title="=&gt; reflect.internal.Flags.type">Flags</a>.<a href="../../../../reflect/internal/Flags.scala.html#441022" title="(flags: Long)String">flagsToString</a><span class="delimiter">(</span><a href="#789211" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443379" title="=&gt; GenMSIL.this.global.Symbol">owner</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443310" title="=&gt; Long">flags</a><span class="delimiter">)</span> <span title="(x$1: Any)String">+</span> <span title="String(&quot; &quot;)" class="string">&quot; &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#789211" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#443379" title="=&gt; GenMSIL.this.global.Symbol">owner</a>
    <span class="delimiter">)</span>

  <span class="delimiter">}</span> // class BytecodeGenerator

<span title="Object" class="delimiter">}</span> // class GenMSIL

        </pre>
    </body>
</html>