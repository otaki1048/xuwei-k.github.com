<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>scala/collection/mutable/HashTable.scala</title>
        <script type="text/javascript" src="../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
/*                     __                                               *\
**     ________ ___   / /  ___     Scala API                            **
**    / __/ __// _ | / /  / _ |    (c) 2003-2011, LAMP/EPFL             **
**  __\ \/ /__/ __ |/ /__/ __ |    http://www.scala-lang.org/           **
** /____/\___/_/ |_/____/_/ | |                                         **
**                          |/                                          **
\*                                                                      */



<span class="keyword">package</span> scala.collection
<span class="keyword">package</span> mutable

/** This class can be used to construct data structures that are based
 *  on hashtables. Class `HashTable[A]` implements a hashtable
 *  that maps keys of type `A` to values of the fully abstract
 *  member type `Entry`. Classes that make use of `HashTable`
 *  have to provide an implementation for `Entry`.
 *
 *  There are mainly two parameters that affect the performance of a hashtable:
 *  the &lt;i&gt;initial size&lt;/i&gt; and the &lt;i&gt;load factor&lt;/i&gt;. The &lt;i&gt;size&lt;/i&gt;
 *  refers to the number of &lt;i&gt;buckets&lt;/i&gt; in the hashtable, and the &lt;i&gt;load
 *  factor&lt;/i&gt; is a measure of how full the hashtable is allowed to get before
 *  its size is automatically doubled. Both parameters may be changed by
 *  overriding the corresponding values in class `HashTable`.
 *
 *  @author  Matthias Zenger
 *  @author  Martin Odersky
 *  @version 2.0, 31/12/2006
 *  @since   1
 *
 *  @tparam A     type of the elements contained in this hash table.
 */
<span class="keyword">trait</span> <a title="trait HashTable[A, Entry &gt;: Null &lt;: scala.collection.mutable.HashEntry[A,Entry]] extends Object with scala.collection.mutable.HashTable.HashUtils[A]" id="13222">HashTable</a><span class="delimiter">[</span><a title="" id="13883">A</a>, <a title=" &gt;: Null &lt;: scala.collection.mutable.HashEntry[A,Entry]" id="13884">Entry</a> &gt;: Null &lt;: HashEntry<span class="delimiter">[</span>A, Entry<span class="delimiter">]</span><span class="delimiter">]</span> <a href="../../Unit.scala.html#2389" title="Unit" class="keyword">extends</a> HashTable.<a href="#79246" title="scala.collection.mutable.HashTable.HashUtils[A]">HashUtils</a><span class="delimiter">[</span>A<span class="delimiter">]</span> <span class="delimiter">{</span>
  <span class="keyword">import</span> <a href="#13223" title="scala.collection.mutable.HashTable.type">HashTable</a>._

  @transient <span class="keyword">protected</span> <span class="keyword">var</span> <a title="Int" id="79260">_loadFactor</a> = <a href="#79238" title="=&gt; Int">defaultLoadFactor</a>

  /** The actual hash table.
   */
  @transient <span class="keyword">protected</span> <span class="keyword">var</span> <a title="Array[scala.collection.mutable.HashEntry[A,Entry]]" id="79263">table</a>: <a href="../../Array.scala.html#292" title="Array[scala.collection.mutable.HashEntry[A,Entry]]">Array</a><span class="delimiter">[</span>HashEntry<span class="delimiter">[</span>A, Entry<span class="delimiter">]</span><span class="delimiter">]</span> = <span title="Array[scala.collection.mutable.HashEntry[A,Entry]]" class="keyword">new</span> <a href="../../Array.scala.html#292" title="Array[scala.collection.mutable.HashEntry[A,Entry]]">Array</a><span class="delimiter">(</span><a href="#79242" title="=&gt; Int">initialCapacity</a><span class="delimiter">)</span>

  /** The number of mappings contained in this hash table.
   */
  @transient <span class="keyword">protected</span> <span class="keyword">var</span> <a title="Int" id="79266">tableSize</a>: <a href="../../Int.scala.html#508" title="Int">Int</a> = <span title="Int(0)" class="int">0</span>

  /** The next size value at which to resize (capacity * load factor).
   */
  @transient <span class="keyword">protected</span> <span class="keyword">var</span> <a title="Int" id="79269">threshold</a>: <a href="../../Int.scala.html#508" title="Int">Int</a> = <a href="#79241" title="(_loadFactor: Int)Int">initialThreshold</a><span class="delimiter">(</span><a href="#79260" title="=&gt; Int">_loadFactor</a><span class="delimiter">)</span>

  /** The array keeping track of the number of elements in 32 element blocks.
   */
  @transient <span class="keyword">protected</span> <span class="keyword">var</span> <a title="Array[Int]" id="79272">sizemap</a>: <a href="../../Array.scala.html#292" title="Array[Int]">Array</a><span class="delimiter">[</span>Int<span class="delimiter">]</span> = <span title="Null(null)" class="keyword">null</span>

  @transient <span class="keyword">var</span> <a title="Int" id="79275">seedvalue</a>: <a href="../../Int.scala.html#508" title="Int">Int</a> = <a href="#79277" title="=&gt; Int">tableSizeSeed</a>

  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="=&gt; Int" id="79277">tableSizeSeed</a> = <span title="Integer.type">Integer</span>.<span title="(x$1: Int)Int">bitCount</span><span class="delimiter">(</span><a href="#79263" title="=&gt; Array[scala.collection.mutable.HashEntry[A,Entry]]">table</a>.<a href="../../Array.scala.html#57449" title="=&gt; Int">length</a> <a href="../../Int.scala.html#57955" title="(x: Int)Int">-</a> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>

  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="=&gt; Int" id="79278">initialSize</a>: <a href="../../Int.scala.html#508" title="Int">Int</a> = <a href="#13223" title="scala.collection.mutable.HashTable.type">HashTable</a>.<a href="#79240" title="=&gt; Int">initialSize</a>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="=&gt; Int" id="79279">lastPopulatedIndex</a> = <span class="delimiter">{</span>
    <span class="keyword">var</span> <a title="Int" id="283511">idx</a> = <a href="#79263" title="=&gt; Array[scala.collection.mutable.HashEntry[A,Entry]]">table</a>.<a href="../../Array.scala.html#57449" title="=&gt; Int">length</a> <a href="../../Int.scala.html#57955" title="(x: Int)Int">-</a> <span title="Int(1)" class="int">1</span>
    <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><a href="../../Array.scala.html#57450" title="(i: Int)scala.collection.mutable.HashEntry[A,Entry]">table</a><span class="delimiter">(</span><a href="#283511" title="Int">idx</a><span class="delimiter">)</span> <span title="(x$1: AnyRef)Boolean">==</span> <span title="Null(null)" class="keyword">null</span> <a href="../../Boolean.scala.html#58725" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#283511" title="Int">idx</a> <a href="../../Int.scala.html#57919" title="(x: Int)Boolean">&gt;</a> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
      <a href="#283511" title="Int">idx</a> <a href="../../Int.scala.html#57955" title="(x: Int)Int">-=</a> <span title="Int(1)" class="int">1</span>

    <a href="#283511" title="Int">idx</a>
  <span class="delimiter">}</span>

  /**
   * Initializes the collection from the input stream. `f` will be called for each key/value pair
   * read from the input stream in the order determined by the stream. This is useful for
   * structures where iteration order is important (e.g. LinkedHashMap).
   */
  <span class="keyword">private</span><span class="delimiter">[</span>collection<span class="delimiter">]</span> <span class="keyword">def</span> <a title="[B](in: java.io.ObjectInputStream, f: (A, B) =&gt; Entry)Unit" id="79280">init</a><span class="delimiter">[</span><a title="" id="79282">B</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="java.io.ObjectInputStream" id="283108">in</a>: java.io.<span title="java.io.ObjectInputStream">ObjectInputStream</span>, <a title="(A, B) =&gt; Entry" id="283109">f</a>: <span class="delimiter">(</span>A, B<span class="delimiter">)</span> =&gt; Entry<span class="delimiter">)</span> <span class="delimiter">{</span>
    <a href="#283108" title="java.io.ObjectInputStream">in</a>.<span title="()Unit">defaultReadObject</span>

    <a href="#79260" title="(x$1: Int)Unit">_loadFactor</a> = <a href="#283108" title="java.io.ObjectInputStream">in</a>.<span title="()Int">readInt</span><span class="delimiter">(</span><span class="delimiter">)</span>
    <a href="../../Predef.scala.html#8459" title="(assertion: Boolean)Unit">assert</a><span class="delimiter">(</span><a href="#79260" title="=&gt; Int">_loadFactor</a> <a href="../../Int.scala.html#57919" title="(x: Int)Boolean">&gt;</a> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>

    <span class="keyword">val</span> <a title="Int" id="283532">size</a> = <a href="#283108" title="java.io.ObjectInputStream">in</a>.<span title="()Int">readInt</span><span class="delimiter">(</span><span class="delimiter">)</span>
    <a href="#79266" title="(x$1: Int)Unit">tableSize</a> = <span title="Int(0)" class="int">0</span>
    <a href="../../Predef.scala.html#8459" title="(assertion: Boolean)Unit">assert</a><span class="delimiter">(</span><a href="#283532" title="Int">size</a> <a href="../../Int.scala.html#57926" title="(x: Int)Boolean">&gt;=</a> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>

    <a href="#79275" title="(x$1: Int)Unit">seedvalue</a> = <a href="#283108" title="java.io.ObjectInputStream">in</a>.<span title="()Int">readInt</span><span class="delimiter">(</span><span class="delimiter">)</span>

    <span class="keyword">val</span> <a title="Boolean" id="283533">smDefined</a> = <a href="#283108" title="java.io.ObjectInputStream">in</a>.<span title="()Boolean">readBoolean</span><span class="delimiter">(</span><span class="delimiter">)</span>

    <a href="#79263" title="(x$1: Array[scala.collection.mutable.HashEntry[A,Entry]])Unit">table</a> = <span title="Array[scala.collection.mutable.HashEntry[A,Entry]]" class="keyword">new</span> <a href="../../Array.scala.html#292" title="Array[scala.collection.mutable.HashEntry[A,Entry]]">Array</a><span class="delimiter">(</span><a href="#79245" title="(expectedSize: Int)Int">capacity</a><span class="delimiter">(</span><a href="#79244" title="(_loadFactor: Int, thr: Int)Int">sizeForThreshold</a><span class="delimiter">(</span><a href="#79260" title="=&gt; Int">_loadFactor</a>, <a href="#283532" title="Int">size</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="#79269" title="(x$1: Int)Unit">threshold</a> = <a href="#79243" title="(_loadFactor: Int, size: Int)Int">newThreshold</a><span class="delimiter">(</span><a href="#79260" title="=&gt; Int">_loadFactor</a>, <a href="../../Predef.scala.html#8521" title="(xs: Array[scala.collection.mutable.HashEntry[A,Entry]])scala.collection.mutable.ArrayOps[scala.collection.mutable.HashEntry[A,Entry]]">table</a>.<a href="../SeqLike.scala.html#59711" title="=&gt; Int">size</a><span class="delimiter">)</span>

    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#283533" title="Boolean">smDefined</a><span class="delimiter">)</span> <a href="#79300" title="(tableLength: Int)Unit">sizeMapInit</a><span class="delimiter">(</span><a href="#79263" title="=&gt; Array[scala.collection.mutable.HashEntry[A,Entry]]">table</a>.<a href="../../Array.scala.html#57449" title="=&gt; Int">length</a><span class="delimiter">)</span> <span class="keyword">else</span> <a href="#79272" title="(x$1: Array[Int])Unit">sizemap</a> = <span title="Null(null)" class="keyword">null</span>

    <span class="keyword">var</span> <a title="Int" id="283534">index</a> = <span title="Int(0)" class="int">0</span>
    <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><a href="#283534" title="Int">index</a> <a href="../../Int.scala.html#57905" title="(x: Int)Boolean">&lt;</a> <a href="#283532" title="Int">size</a><span class="delimiter">)</span> <a href="#283658" title="()Unit" class="delimiter">{</a>
      <a href="#79287" title="(e: Entry)Unit">addEntry</a><span class="delimiter">(</span><a href="../../Function2.scala.html#65847" title="(v1: A, v2: B)Entry">f</a><span class="delimiter">(</span><a href="#283108" title="java.io.ObjectInputStream">in</a>.<span title="()Object">readObject</span><span class="delimiter">(</span><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="A" class="delimiter">[</span><a href="#13883" title="A">A</a><span class="delimiter">]</span>, <a href="#283108" title="java.io.ObjectInputStream">in</a>.<span title="()Object">readObject</span><span class="delimiter">(</span><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="B" class="delimiter">[</span><a href="#79282" title="B">B</a><span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="#283534" title="Int">index</a> <a href="../../Int.scala.html#57948" title="(x: Int)Int">+=</a> <span title="Int(1)" class="int">1</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  /**
   * Serializes the collection to the output stream by saving the load factor, collection
   * size, collection keys and collection values. `value` is responsible for providing a value
   * from an entry.
   *
   * `foreach` determines the order in which the key/value pairs are saved to the stream. To
   * deserialize, `init` should be used.
   */
  <span class="keyword">private</span><span class="delimiter">[</span>collection<span class="delimiter">]</span> <span class="keyword">def</span> <a title="[B](out: java.io.ObjectOutputStream, value: Entry =&gt; B)Unit" id="79283">serializeTo</a><span class="delimiter">[</span><a title="" id="79285">B</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="java.io.ObjectOutputStream" id="283092">out</a>: java.io.<span title="java.io.ObjectOutputStream">ObjectOutputStream</span>, <a title="Entry =&gt; B" id="283093">value</a>: Entry =&gt; B<span class="delimiter">)</span> <span class="delimiter">{</span>
    <a href="#283092" title="java.io.ObjectOutputStream">out</a>.<span title="()Unit">defaultWriteObject</span>
    <a href="#283092" title="java.io.ObjectOutputStream">out</a>.<span title="(x$1: Int)Unit">writeInt</span><span class="delimiter">(</span><a href="#79260" title="=&gt; Int">_loadFactor</a><span class="delimiter">)</span>
    <a href="#283092" title="java.io.ObjectOutputStream">out</a>.<span title="(x$1: Int)Unit">writeInt</span><span class="delimiter">(</span><a href="#79266" title="=&gt; Int">tableSize</a><span class="delimiter">)</span>
    <a href="#283092" title="java.io.ObjectOutputStream">out</a>.<span title="(x$1: Int)Unit">writeInt</span><span class="delimiter">(</span><a href="#79275" title="=&gt; Int">seedvalue</a><span class="delimiter">)</span>
    <a href="#283092" title="java.io.ObjectOutputStream">out</a>.<span title="(x$1: Boolean)Unit">writeBoolean</span><span class="delimiter">(</span><a href="#79304" title="=&gt; Boolean">isSizeMapDefined</a><span class="delimiter">)</span>
    <a href="#79290" title="(f: Entry =&gt; Unit)Unit">foreachEntry</a> <span class="delimiter">{</span> <a title="Entry" id="283674">entry</a> =&gt;
      <a href="#283092" title="java.io.ObjectOutputStream">out</a>.<span title="(x$1: Any)Unit">writeObject</span><span class="delimiter">(</span><a href="#283674" title="Entry">entry</a>.<a href="HashEntry.scala.html#141449" title="=&gt; A">key</a><span class="delimiter">)</span>
      <a href="#283092" title="java.io.ObjectOutputStream">out</a>.<span title="(x$1: Any)Unit">writeObject</span><span class="delimiter">(</span><a href="../../Function1.scala.html#59555" title="(v1: Entry)B">value</a><span class="delimiter">(</span><a href="#283674" title="Entry">entry</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  /** Find entry with given key in table, null if not found.
   */
  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="(key: A)Entry" id="79286">findEntry</a><span class="delimiter">(</span><a title="A" id="281645">key</a>: <a href="#13883" title="A">A</a><span class="delimiter">)</span>: <a href="#13884" title="Entry">Entry</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Int" id="283677">h</a> = <a href="#79307" title="(hcode: Int)Int">index</a><span class="delimiter">(</span><a href="#79255" title="(key: A)Int">elemHashCode</a><span class="delimiter">(</span><a href="#281645" title="A">key</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="keyword">var</span> <a title="Entry" id="283678">e</a> = <a href="../../Array.scala.html#57450" title="(i: Int)scala.collection.mutable.HashEntry[A,Entry]">table</a><span class="delimiter">(</span><a href="#283677" title="Int">h</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="Entry" class="delimiter">[</span><a href="#13884" title="Entry">Entry</a><span class="delimiter">]</span>
    <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><a href="#283678" title="Entry">e</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span> <a href="../../Boolean.scala.html#58725" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../Boolean.scala.html#58721" title="=&gt; Boolean">!</a><a href="#79306" title="(key1: A, key2: A)Boolean">elemEquals</a><span class="delimiter">(</span><a href="#283678" title="Entry">e</a>.<a href="HashEntry.scala.html#141449" title="=&gt; A">key</a>, <a href="#281645" title="A">key</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="#283678" title="Entry">e</a> = <a href="#283678" title="Entry">e</a>.<a href="HashEntry.scala.html#141450" title="=&gt; Entry">next</a>
    <a href="#283678" title="Entry">e</a>
  <span class="delimiter">}</span>

  /** Add entry to table
   *  pre: no entry with same key exists
   */
  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="(e: Entry)Unit" id="79287">addEntry</a><span class="delimiter">(</span><a title="Entry" id="281683">e</a>: <a href="#13884" title="Entry">Entry</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Int" id="283745">h</a> = <a href="#79307" title="(hcode: Int)Int">index</a><span class="delimiter">(</span><a href="#79255" title="(key: A)Int">elemHashCode</a><span class="delimiter">(</span><a href="#281683" title="Entry">e</a>.<a href="HashEntry.scala.html#141449" title="=&gt; A">key</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="#281683" title="Entry">e</a>.<a href="HashEntry.scala.html#141451" title="(x$1: Entry)Unit">next</a> = <a href="../../Array.scala.html#57450" title="(i: Int)scala.collection.mutable.HashEntry[A,Entry]">table</a><span class="delimiter">(</span><a href="#283745" title="Int">h</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="Entry" class="delimiter">[</span><a href="#13884" title="Entry">Entry</a><span class="delimiter">]</span>
    <a href="../../Array.scala.html#57451" title="(i: Int, x: scala.collection.mutable.HashEntry[A,Entry])Unit">table</a><span class="delimiter">(</span><a href="#283745" title="Int">h</a><span class="delimiter">)</span> = <a href="#281683" title="Entry">e</a>
    <a href="#79266" title="(x$1: Int)Unit">tableSize</a> = <a href="#79266" title="=&gt; Int">tableSize</a> <a href="../../Int.scala.html#57948" title="(x: Int)Int">+</a> <span title="Int(1)" class="int">1</span>
    <a href="#79295" title="(h: Int)Unit">nnSizeMapAdd</a><span class="delimiter">(</span><a href="#283745" title="Int">h</a><span class="delimiter">)</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#79266" title="=&gt; Int">tableSize</a> <a href="../../Int.scala.html#57919" title="(x: Int)Boolean">&gt;</a> <a href="#79269" title="=&gt; Int">threshold</a><span class="delimiter">)</span>
      <a href="#79294" title="(newSize: Int)Unit">resize</a><span class="delimiter">(</span><span title="Int(2)" class="int">2</span> <a href="../../Int.scala.html#57962" title="(x: Int)Int">*</a> <a href="#79263" title="=&gt; Array[scala.collection.mutable.HashEntry[A,Entry]]">table</a>.<a href="../../Array.scala.html#57449" title="=&gt; Int">length</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  /** Remove entry from table if present.
   */
  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="(key: A)Entry" id="79288">removeEntry</a><span class="delimiter">(</span><a title="A" id="281697">key</a>: <a href="#13883" title="A">A</a><span class="delimiter">)</span> : <a href="#13884" title="Entry">Entry</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Int" id="283780">h</a> = <a href="#79307" title="(hcode: Int)Int">index</a><span class="delimiter">(</span><a href="#79255" title="(key: A)Int">elemHashCode</a><span class="delimiter">(</span><a href="#281697" title="A">key</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="keyword">var</span> <a title="Entry" id="283781">e</a> = <a href="../../Array.scala.html#57450" title="(i: Int)scala.collection.mutable.HashEntry[A,Entry]">table</a><span class="delimiter">(</span><a href="#283780" title="Int">h</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="Entry" class="delimiter">[</span><a href="#13884" title="Entry">Entry</a><span class="delimiter">]</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#283781" title="Entry">e</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#79306" title="(key1: A, key2: A)Boolean">elemEquals</a><span class="delimiter">(</span><a href="#283781" title="Entry">e</a>.<a href="HashEntry.scala.html#141449" title="=&gt; A">key</a>, <a href="#281697" title="A">key</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="../../Array.scala.html#57451" title="(i: Int, x: scala.collection.mutable.HashEntry[A,Entry])Unit">table</a><span class="delimiter">(</span><a href="#283780" title="Int">h</a><span class="delimiter">)</span> = <a href="#283781" title="Entry">e</a>.<a href="HashEntry.scala.html#141450" title="=&gt; Entry">next</a>
        <a href="#79266" title="(x$1: Int)Unit">tableSize</a> = <a href="#79266" title="=&gt; Int">tableSize</a> <a href="../../Int.scala.html#57955" title="(x: Int)Int">-</a> <span title="Int(1)" class="int">1</span>
        <a href="#79296" title="(h: Int)Unit">nnSizeMapRemove</a><span class="delimiter">(</span><a href="#283780" title="Int">h</a><span class="delimiter">)</span>
        <span title="Nothing" class="keyword">return</span> <a href="#283781" title="Entry">e</a>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
        <span class="keyword">var</span> <a title="Entry" id="283810">e1</a> = <a href="#283781" title="Entry">e</a>.<a href="HashEntry.scala.html#141450" title="=&gt; Entry">next</a>
        <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><a href="#283810" title="Entry">e1</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span> <a href="../../Boolean.scala.html#58725" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../Boolean.scala.html#58721" title="=&gt; Boolean">!</a><a href="#79306" title="(key1: A, key2: A)Boolean">elemEquals</a><span class="delimiter">(</span><a href="#283810" title="Entry">e1</a>.<a href="HashEntry.scala.html#141449" title="=&gt; A">key</a>, <a href="#281697" title="A">key</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="#283811" title="()Unit" class="delimiter">{</a>
          <a href="#283781" title="Entry">e</a> = <a href="#283810" title="Entry">e1</a>
          <a href="#283810" title="Entry">e1</a> = <a href="#283810" title="Entry">e1</a>.<a href="HashEntry.scala.html#141450" title="=&gt; Entry">next</a>
        <span class="delimiter">}</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#283810" title="Entry">e1</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="#283781" title="Entry">e</a>.<a href="HashEntry.scala.html#141451" title="(x$1: Entry)Unit">next</a> = <a href="#283810" title="Entry">e1</a>.<a href="HashEntry.scala.html#141450" title="=&gt; Entry">next</a>
          <a href="#79266" title="(x$1: Int)Unit">tableSize</a> = <a href="#79266" title="=&gt; Int">tableSize</a> <a href="../../Int.scala.html#57955" title="(x: Int)Int">-</a> <span title="Int(1)" class="int">1</span>
          <a href="#79296" title="(h: Int)Unit">nnSizeMapRemove</a><span class="delimiter">(</span><a href="#283780" title="Int">h</a><span class="delimiter">)</span>
          <span title="Nothing" class="keyword">return</span> <a href="#283810" title="Entry">e1</a>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
    <span title="Null(null)" class="keyword">null</span>
  <span class="delimiter">}</span>

  /** An iterator returning all entries.
   */
  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="=&gt; Iterator[Entry]" id="79289">entriesIterator</a>: <a href="../Iterator.scala.html#5383" title="Iterator[Entry]">Iterator</a><span class="delimiter">[</span>Entry<span class="delimiter">]</span> = <a href="#283827" title="scala.collection.AbstractIterator[Entry]{}" class="keyword">new</a> <a title="anonymous class $anon extends scala.collection.AbstractIterator[Entry]" id="283827">AbstractIterator</a><span class="delimiter">[</span>Entry<span class="delimiter">]</span> <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Array[scala.collection.mutable.HashEntry[A,Entry]]" id="283829">iterTable</a> = <a href="#79263" title="=&gt; Array[scala.collection.mutable.HashEntry[A,Entry]]">table</a>
    <span class="keyword">var</span> <a title="Int" id="283832">idx</a>       = <a href="#79279" title="=&gt; Int">lastPopulatedIndex</a>
    <span class="keyword">var</span> <a title="scala.collection.mutable.HashEntry[A,Entry]" id="283835">es</a>        = <a href="../../Array.scala.html#57450" title="(i: Int)scala.collection.mutable.HashEntry[A,Entry]">iterTable</a><span class="delimiter">(</span><a href="#283832" title="=&gt; Int">idx</a><span class="delimiter">)</span>

    <span class="keyword">def</span> <a title="=&gt; Boolean" id="283837">hasNext</a> = <a href="#283835" title="=&gt; scala.collection.mutable.HashEntry[A,Entry]">es</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span>
    <span class="keyword">def</span> <a title="()Entry" id="283838">next</a><span class="delimiter">(</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="scala.collection.mutable.HashEntry[A,Entry]" id="284011">res</a> = <a href="#283835" title="=&gt; scala.collection.mutable.HashEntry[A,Entry]">es</a>
      <a href="#283835" title="(x$1: scala.collection.mutable.HashEntry[A,Entry])Unit">es</a> = <a href="#283835" title="=&gt; scala.collection.mutable.HashEntry[A,Entry]">es</a>.<a href="HashEntry.scala.html#141450" title="=&gt; Entry">next</a>
      <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><a href="#283835" title="=&gt; scala.collection.mutable.HashEntry[A,Entry]">es</a> <span title="(x$1: AnyRef)Boolean">==</span> <span title="Null(null)" class="keyword">null</span> <a href="../../Boolean.scala.html#58725" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#283832" title="=&gt; Int">idx</a> <a href="../../Int.scala.html#57919" title="(x: Int)Boolean">&gt;</a> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <a href="#284012" title="()Unit" class="delimiter">{</a>
        <a href="#283832" title="(x$1: Int)Unit">idx</a> = <a href="#283832" title="=&gt; Int">idx</a> <a href="../../Int.scala.html#57955" title="(x: Int)Int">-</a> <span title="Int(1)" class="int">1</span>
        <a href="#283835" title="(x$1: scala.collection.mutable.HashEntry[A,Entry])Unit">es</a> = <a href="../../Array.scala.html#57450" title="(i: Int)scala.collection.mutable.HashEntry[A,Entry]">iterTable</a><span class="delimiter">(</span><a href="#283832" title="=&gt; Int">idx</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
      <a href="#284011" title="scala.collection.mutable.HashEntry[A,Entry]">res</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="Entry" class="delimiter">[</span><a href="#13884" title="Entry">Entry</a><span class="delimiter">]</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  /** Avoid iterator for a 2x faster traversal. */
  <span class="keyword">protected</span> <span class="keyword">final</span> <span class="keyword">def</span> <a title="[C](f: Entry =&gt; C)Unit" id="79290">foreachEntry</a><span class="delimiter">[</span><a title="" id="79292">C</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="Entry =&gt; C" id="281787">f</a>: Entry =&gt; C<span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Array[scala.collection.mutable.HashEntry[A,Entry]]" id="284029">iterTable</a> = <a href="#79263" title="=&gt; Array[scala.collection.mutable.HashEntry[A,Entry]]">table</a>
    <span class="keyword">var</span> <a title="Int" id="284030">idx</a>       = <a href="#79279" title="=&gt; Int">lastPopulatedIndex</a>
    <span class="keyword">var</span> <a title="scala.collection.mutable.HashEntry[A,Entry]" id="284031">es</a>        = <a href="../../Array.scala.html#57450" title="(i: Int)scala.collection.mutable.HashEntry[A,Entry]">iterTable</a><span class="delimiter">(</span><a href="#284030" title="Int">idx</a><span class="delimiter">)</span>

    <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><a href="#284031" title="scala.collection.mutable.HashEntry[A,Entry]">es</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <a href="#284032" title="()Unit" class="delimiter">{</a>
      <a href="../../Function1.scala.html#59555" title="(v1: Entry)C">f</a><span class="delimiter">(</span><a href="#284031" title="scala.collection.mutable.HashEntry[A,Entry]">es</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="Entry" class="delimiter">[</span><a href="#13884" title="Entry">Entry</a><span class="delimiter">]</span><span class="delimiter">)</span>
      <a href="#284031" title="scala.collection.mutable.HashEntry[A,Entry]">es</a> = <a href="#284031" title="scala.collection.mutable.HashEntry[A,Entry]">es</a>.<a href="HashEntry.scala.html#141450" title="=&gt; Entry">next</a>

      <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><a href="#284031" title="scala.collection.mutable.HashEntry[A,Entry]">es</a> <span title="(x$1: AnyRef)Boolean">==</span> <span title="Null(null)" class="keyword">null</span> <a href="../../Boolean.scala.html#58725" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#284030" title="Int">idx</a> <a href="../../Int.scala.html#57919" title="(x: Int)Boolean">&gt;</a> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <a href="#284039" title="()Unit" class="delimiter">{</a>
        <a href="#284030" title="Int">idx</a> <a href="../../Int.scala.html#57955" title="(x: Int)Int">-=</a> <span title="Int(1)" class="int">1</span>
        <a href="#284031" title="scala.collection.mutable.HashEntry[A,Entry]">es</a> = <a href="../../Array.scala.html#57450" title="(i: Int)scala.collection.mutable.HashEntry[A,Entry]">iterTable</a><span class="delimiter">(</span><a href="#284030" title="Int">idx</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  /** Remove all entries from table
   */
  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="()Unit" id="79293">clearTable</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">var</span> <a title="Int" id="284055">i</a> = <a href="#79263" title="=&gt; Array[scala.collection.mutable.HashEntry[A,Entry]]">table</a>.<a href="../../Array.scala.html#57449" title="=&gt; Int">length</a> <a href="../../Int.scala.html#57955" title="(x: Int)Int">-</a> <span title="Int(1)" class="int">1</span>
    <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><a href="#284055" title="Int">i</a> <a href="../../Int.scala.html#57926" title="(x: Int)Boolean">&gt;=</a> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <a href="#284056" title="()Unit" class="delimiter">{</a> <a href="../../Array.scala.html#57451" title="(i: Int, x: scala.collection.mutable.HashEntry[A,Entry])Unit">table</a><span class="delimiter">(</span><a href="#284055" title="Int">i</a><span class="delimiter">)</span> = <span title="Null(null)" class="keyword">null</span>; <a href="#284055" title="Int">i</a> = <a href="#284055" title="Int">i</a> <a href="../../Int.scala.html#57955" title="(x: Int)Int">-</a> <span title="Int(1)" class="int">1</span> <span class="delimiter">}</span>
    <a href="#79266" title="(x$1: Int)Unit">tableSize</a> = <span title="Int(0)" class="int">0</span>
    <a href="#79297" title="(tableLength: Int)Unit">nnSizeMapReset</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(newSize: Int)Unit" id="79294">resize</a><span class="delimiter">(</span><a title="Int" id="283774">newSize</a>: <a href="../../Int.scala.html#508" title="Int">Int</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Array[scala.collection.mutable.HashEntry[A,Entry]]" id="284095">oldTable</a> = <a href="#79263" title="=&gt; Array[scala.collection.mutable.HashEntry[A,Entry]]">table</a>
    <a href="#79263" title="(x$1: Array[scala.collection.mutable.HashEntry[A,Entry]])Unit">table</a> = <span title="Array[scala.collection.mutable.HashEntry[A,Entry]]" class="keyword">new</span> <a href="../../Array.scala.html#292" title="Array[scala.collection.mutable.HashEntry[A,Entry]]">Array</a><span class="delimiter">(</span><a href="#283774" title="Int">newSize</a><span class="delimiter">)</span>
    <a href="#79297" title="(tableLength: Int)Unit">nnSizeMapReset</a><span class="delimiter">(</span><a href="#79263" title="=&gt; Array[scala.collection.mutable.HashEntry[A,Entry]]">table</a>.<a href="../../Array.scala.html#57449" title="=&gt; Int">length</a><span class="delimiter">)</span>
    <span class="keyword">var</span> <a title="Int" id="284096">i</a> = <a href="#284095" title="Array[scala.collection.mutable.HashEntry[A,Entry]]">oldTable</a>.<a href="../../Array.scala.html#57449" title="=&gt; Int">length</a> <a href="../../Int.scala.html#57955" title="(x: Int)Int">-</a> <span title="Int(1)" class="int">1</span>
    <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><a href="#284096" title="Int">i</a> <a href="../../Int.scala.html#57926" title="(x: Int)Boolean">&gt;=</a> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <a href="#284097" title="()Unit" class="delimiter">{</a>
      <span class="keyword">var</span> <a title="scala.collection.mutable.HashEntry[A,Entry]" id="284107">e</a> = <a href="../../Array.scala.html#57450" title="(i: Int)scala.collection.mutable.HashEntry[A,Entry]">oldTable</a><span class="delimiter">(</span><a href="#284096" title="Int">i</a><span class="delimiter">)</span>
      <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><a href="#284107" title="scala.collection.mutable.HashEntry[A,Entry]">e</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <a href="#284108" title="()Unit" class="delimiter">{</a>
        <span class="keyword">val</span> <a title="Int" id="284114">h</a> = <a href="#79307" title="(hcode: Int)Int">index</a><span class="delimiter">(</span><a href="#79255" title="(key: A)Int">elemHashCode</a><span class="delimiter">(</span><a href="#284107" title="scala.collection.mutable.HashEntry[A,Entry]">e</a>.<a href="HashEntry.scala.html#141449" title="=&gt; A">key</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="Entry" id="284115">e1</a> = <a href="#284107" title="scala.collection.mutable.HashEntry[A,Entry]">e</a>.<a href="HashEntry.scala.html#141450" title="=&gt; Entry">next</a>
        <a href="#284107" title="scala.collection.mutable.HashEntry[A,Entry]">e</a>.<a href="HashEntry.scala.html#141451" title="(x$1: Entry)Unit">next</a> = <a href="../../Array.scala.html#57450" title="(i: Int)scala.collection.mutable.HashEntry[A,Entry]">table</a><span class="delimiter">(</span><a href="#284114" title="Int">h</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="Entry" class="delimiter">[</span><a href="#13884" title="Entry">Entry</a><span class="delimiter">]</span>
        <a href="../../Array.scala.html#57451" title="(i: Int, x: scala.collection.mutable.HashEntry[A,Entry])Unit">table</a><span class="delimiter">(</span><a href="#284114" title="Int">h</a><span class="delimiter">)</span> = <a href="#284107" title="scala.collection.mutable.HashEntry[A,Entry]">e</a>
        <a href="#284107" title="scala.collection.mutable.HashEntry[A,Entry]">e</a> = <a href="#284115" title="Entry">e1</a>
        <a href="#79295" title="(h: Int)Unit">nnSizeMapAdd</a><span class="delimiter">(</span><a href="#284114" title="Int">h</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
      <a href="#284096" title="Int">i</a> = <a href="#284096" title="Int">i</a> <a href="../../Int.scala.html#57955" title="(x: Int)Int">-</a> <span title="Int(1)" class="int">1</span>
    <span class="delimiter">}</span>
    <a href="#79269" title="(x$1: Int)Unit">threshold</a> = <a href="#79243" title="(_loadFactor: Int, size: Int)Int">newThreshold</a><span class="delimiter">(</span><a href="#79260" title="=&gt; Int">_loadFactor</a>, <a href="#283774" title="Int">newSize</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  /* Size map handling code */

  /*
   * The following three sizeMap* functions (Add, Remove, Reset)
   * are used to update the size map of the hash table.
   *
   * The size map logically divides the hash table into `sizeMapBucketSize` element buckets
   * by keeping an integer entry for each such bucket. Each integer entry simply denotes
   * the number of elements in the corresponding bucket.
   * Best understood through an example, see:
   * table   = [/, 1, /, 6, 90, /, -3, 5]    (8 entries)
   * sizemap = [     2     |     3      ]    (2 entries)
   * where sizeMapBucketSize == 4.
   *
   * By default the size map is not initialized, so these methods don't do anything, thus,
   * their impact on hash table performance is negligible. However, if the hash table
   * is converted into a parallel hash table, the size map is initialized, as it will be needed
   * there.
   */
  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="(h: Int)Unit" id="79295">nnSizeMapAdd</a><span class="delimiter">(</span><a title="Int" id="283753">h</a>: <a href="../../Int.scala.html#508" title="Int">Int</a><span class="delimiter">)</span> = <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#79272" title="=&gt; Array[Int]">sizemap</a> <span title="(x$1: AnyRef)Boolean">ne</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <a href="#79272" title="=&gt; Array[Int]">sizemap</a><span class="delimiter">(</span><a href="#283753" title="Int">h</a> <a href="../../Int.scala.html#57886" title="(x: Int)Int">&gt;&gt;</a> <a href="#79253" title="=&gt; Int">sizeMapBucketBitSize</a><span class="delimiter">)</span> <a href="../../Int.scala.html#57948" title="(x: Int)Int">+=</a> <span title="Int(1)" class="int">1</span>
  <span class="delimiter">}</span>

  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="(h: Int)Unit" id="79296">nnSizeMapRemove</a><span class="delimiter">(</span><a title="Int" id="283793">h</a>: <a href="../../Int.scala.html#508" title="Int">Int</a><span class="delimiter">)</span> = <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#79272" title="=&gt; Array[Int]">sizemap</a> <span title="(x$1: AnyRef)Boolean">ne</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <a href="#79272" title="=&gt; Array[Int]">sizemap</a><span class="delimiter">(</span><a href="#283793" title="Int">h</a> <a href="../../Int.scala.html#57886" title="(x: Int)Int">&gt;&gt;</a> <a href="#79253" title="=&gt; Int">sizeMapBucketBitSize</a><span class="delimiter">)</span> <a href="../../Int.scala.html#57955" title="(x: Int)Int">-=</a> <span title="Int(1)" class="int">1</span>
  <span class="delimiter">}</span>

  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="(tableLength: Int)Unit" id="79297">nnSizeMapReset</a><span class="delimiter">(</span><a title="Int" id="284071">tableLength</a>: <a href="../../Int.scala.html#508" title="Int">Int</a><span class="delimiter">)</span> = <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#79272" title="=&gt; Array[Int]">sizemap</a> <span title="(x$1: AnyRef)Boolean">ne</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Int" id="284074">nsize</a> = <a href="#79299" title="(tableLength: Int)Int">calcSizeMapSize</a><span class="delimiter">(</span><a href="#284071" title="Int">tableLength</a><span class="delimiter">)</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#79272" title="=&gt; Array[Int]">sizemap</a>.<a href="../../Array.scala.html#57449" title="=&gt; Int">length</a> <a href="../../Int.scala.html#57898" title="(x: Int)Boolean">!=</a> <a href="#284074" title="Int">nsize</a><span class="delimiter">)</span> <a href="#79272" title="(x$1: Array[Int])Unit">sizemap</a> = <span title="Array[Int]" class="keyword">new</span> <a href="../../Array.scala.html#292" title="Array[Int]">Array</a><span class="delimiter">[</span>Int<span class="delimiter">]</span><span class="delimiter">(</span><a href="#284074" title="Int">nsize</a><span class="delimiter">)</span>
    <span class="keyword">else</span> java.util.<span title="java.util.Arrays.type">Arrays</span>.<span title="(x$1: Array[Int], x$2: Int)Unit">fill</span><span class="delimiter">(</span><a href="#79272" title="=&gt; Array[Int]">sizemap</a>, <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">private</span><span class="delimiter">[</span>collection<span class="delimiter">]</span> <span class="keyword">final</span> <span class="keyword">def</span> <a title="=&gt; Int" id="79298">totalSizeMapBuckets</a> = <span title="Int" class="keyword">if</span> <span class="delimiter">(</span><a href="#79254" title="=&gt; Int">sizeMapBucketSize</a> <a href="../../Int.scala.html#57905" title="(x: Int)Boolean">&lt;</a> <a href="#79263" title="=&gt; Array[scala.collection.mutable.HashEntry[A,Entry]]">table</a>.<a href="../../Array.scala.html#57449" title="=&gt; Int">length</a><span class="delimiter">)</span> <span title="Int(1)" class="int">1</span> <span class="keyword">else</span> <a href="#79263" title="=&gt; Array[scala.collection.mutable.HashEntry[A,Entry]]">table</a>.<a href="../../Array.scala.html#57449" title="=&gt; Int">length</a> <a href="../../Int.scala.html#57969" title="(x: Int)Int">/</a> <a href="#79254" title="=&gt; Int">sizeMapBucketSize</a>

  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="(tableLength: Int)Int" id="79299">calcSizeMapSize</a><span class="delimiter">(</span><a title="Int" id="284075">tableLength</a>: <a href="../../Int.scala.html#508" title="Int">Int</a><span class="delimiter">)</span> = <span class="delimiter">(</span><a href="#284075" title="Int">tableLength</a> <a href="../../Int.scala.html#57886" title="(x: Int)Int">&gt;&gt;</a> <a href="#79253" title="=&gt; Int">sizeMapBucketBitSize</a><span class="delimiter">)</span> <a href="../../Int.scala.html#57948" title="(x: Int)Int">+</a> <span title="Int(1)" class="int">1</span>

  // discards the previous sizemap and only allocates a new one
  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="(tableLength: Int)Unit" id="79300">sizeMapInit</a><span class="delimiter">(</span><a title="Int" id="283656">tableLength</a>: <a href="../../Int.scala.html#508" title="Int">Int</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <a href="#79272" title="(x$1: Array[Int])Unit">sizemap</a> = <span title="Array[Int]" class="keyword">new</span> <a href="../../Array.scala.html#292" title="Array[Int]">Array</a><span class="delimiter">[</span>Int<span class="delimiter">]</span><span class="delimiter">(</span><a href="#79299" title="(tableLength: Int)Int">calcSizeMapSize</a><span class="delimiter">(</span><a href="#283656" title="Int">tableLength</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  // discards the previous sizemap and populates the new one
  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="()Unit" id="79301">sizeMapInitAndRebuild</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <a href="#79300" title="(tableLength: Int)Unit">sizeMapInit</a><span class="delimiter">(</span><a href="#79263" title="=&gt; Array[scala.collection.mutable.HashEntry[A,Entry]]">table</a>.<a href="../../Array.scala.html#57449" title="=&gt; Int">length</a><span class="delimiter">)</span>

    // go through the buckets, count elements
    <span class="keyword">var</span> <a title="Int" id="284136">tableidx</a> = <span title="Int(0)" class="int">0</span>
    <span class="keyword">var</span> <a title="Int" id="284137">bucketidx</a> = <span title="Int(0)" class="int">0</span>
    <span class="keyword">val</span> <a title="Array[scala.collection.mutable.HashEntry[A,Entry]]" id="284138">tbl</a> = <a href="#79263" title="=&gt; Array[scala.collection.mutable.HashEntry[A,Entry]]">table</a>
    <span class="keyword">var</span> <a title="Int" id="284139">tableuntil</a> = <span title="Int(0)" class="int">0</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#284138" title="Array[scala.collection.mutable.HashEntry[A,Entry]]">tbl</a>.<a href="../../Array.scala.html#57449" title="=&gt; Int">length</a> <a href="../../Int.scala.html#57905" title="(x: Int)Boolean">&lt;</a> <a href="#79254" title="=&gt; Int">sizeMapBucketSize</a><span class="delimiter">)</span> <a href="#284139" title="Int">tableuntil</a> = <a href="#284138" title="Array[scala.collection.mutable.HashEntry[A,Entry]]">tbl</a>.<a href="../../Array.scala.html#57449" title="=&gt; Int">length</a> <span class="keyword">else</span> <a href="#284139" title="Int">tableuntil</a> = <a href="#79254" title="=&gt; Int">sizeMapBucketSize</a>
    <span class="keyword">val</span> <a title="Int" id="284140">totalbuckets</a> = <a href="#79298" title="=&gt; Int">totalSizeMapBuckets</a>
    <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><a href="#284137" title="Int">bucketidx</a> <a href="../../Int.scala.html#57905" title="(x: Int)Boolean">&lt;</a> <a href="#284140" title="Int">totalbuckets</a><span class="delimiter">)</span> <a href="#284145" title="()Unit" class="delimiter">{</a>
      <span class="keyword">var</span> <a title="Int" id="284150">currbucketsize</a> = <span title="Int(0)" class="int">0</span>
      <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><a href="#284136" title="Int">tableidx</a> <a href="../../Int.scala.html#57905" title="(x: Int)Boolean">&lt;</a> <a href="#284139" title="Int">tableuntil</a><span class="delimiter">)</span> <a href="#284151" title="()Unit" class="delimiter">{</a>
        <span class="keyword">var</span> <a title="scala.collection.mutable.HashEntry[A,Entry]" id="284156">e</a> = <a href="../../Array.scala.html#57450" title="(i: Int)scala.collection.mutable.HashEntry[A,Entry]">tbl</a><span class="delimiter">(</span><a href="#284136" title="Int">tableidx</a><span class="delimiter">)</span>
        <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><a href="#284156" title="scala.collection.mutable.HashEntry[A,Entry]">e</a> <span title="(x$1: AnyRef)Boolean">ne</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <a href="#284157" title="()Unit" class="delimiter">{</a>
          <a href="#284150" title="Int">currbucketsize</a> <a href="../../Int.scala.html#57948" title="(x: Int)Int">+=</a> <span title="Int(1)" class="int">1</span>
          <a href="#284156" title="scala.collection.mutable.HashEntry[A,Entry]">e</a> = <a href="#284156" title="scala.collection.mutable.HashEntry[A,Entry]">e</a>.<a href="HashEntry.scala.html#141450" title="=&gt; Entry">next</a>
        <span class="delimiter">}</span>
        <a href="#284136" title="Int">tableidx</a> <a href="../../Int.scala.html#57948" title="(x: Int)Int">+=</a> <span title="Int(1)" class="int">1</span>
      <span class="delimiter">}</span>
      <a href="../../Array.scala.html#57451" title="(i: Int, x: Int)Unit">sizemap</a><span class="delimiter">(</span><a href="#284137" title="Int">bucketidx</a><span class="delimiter">)</span> = <a href="#284150" title="Int">currbucketsize</a>
      <a href="#284139" title="Int">tableuntil</a> <a href="../../Int.scala.html#57948" title="(x: Int)Int">+=</a> <a href="#79254" title="=&gt; Int">sizeMapBucketSize</a>
      <a href="#284137" title="Int">bucketidx</a> <a href="../../Int.scala.html#57948" title="(x: Int)Int">+=</a> <span title="Int(1)" class="int">1</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">private</span><span class="delimiter">[</span>collection<span class="delimiter">]</span> <span class="keyword">def</span> <a title="()Unit" id="79302">printSizeMap</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <a href="../../Predef.scala.html#8489" title="(x: Any)Unit">println</a><span class="delimiter">(</span><a href="../../Predef.scala.html#8524" title="implicit scala.Predef.intArrayOps : (xs: Array[Int])scala.collection.mutable.ArrayOps[Int]">sizemap</a>.<a href="../TraversableOnce.scala.html#59174" title="=&gt; List[Int]">toList</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="()Unit" id="79303">sizeMapDisable</a><span class="delimiter">(</span><span class="delimiter">)</span> = <a href="#79272" title="(x$1: Array[Int])Unit">sizemap</a> = <span title="Null(null)" class="keyword">null</span>

  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="=&gt; Boolean" id="79304">isSizeMapDefined</a> = <a href="#79272" title="=&gt; Array[Int]">sizemap</a> <span title="(x$1: AnyRef)Boolean">ne</span> <span title="Null(null)" class="keyword">null</span>

  // override to automatically initialize the size map
  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="=&gt; Boolean" id="79305">alwaysInitSizeMap</a> = <span title="Boolean(false)" class="keyword">false</span>

  /* End of size map handling code */

  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="(key1: A, key2: A)Boolean" id="79306">elemEquals</a><span class="delimiter">(</span><a title="A" id="283742">key1</a>: <a href="#13883" title="A">A</a>, <a title="A" id="283743">key2</a>: <a href="#13883" title="A">A</a><span class="delimiter">)</span>: <a href="../../Boolean.scala.html#2218" title="Boolean">Boolean</a> = <span class="delimiter">(</span><a href="#283742" title="A">key1</a> <span title="(x$1: Any)Boolean">==</span> <a href="#283743" title="A">key2</a><span class="delimiter">)</span>

  // Note:
  // we take the most significant bits of the hashcode, not the lower ones
  // this is of crucial importance when populating the table in parallel
  <span class="keyword">protected</span> <span class="keyword">final</span> <span class="keyword">def</span> <a title="(hcode: Int)Int" id="79307">index</a><span class="delimiter">(</span><a title="Int" id="283680">hcode</a>: <a href="../../Int.scala.html#508" title="Int">Int</a><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Int" id="283683">ones</a> = <a href="#79263" title="=&gt; Array[scala.collection.mutable.HashEntry[A,Entry]]">table</a>.<a href="../../Array.scala.html#57449" title="=&gt; Int">length</a> <a href="../../Int.scala.html#57955" title="(x: Int)Int">-</a> <span title="Int(1)" class="int">1</span>
    <span class="keyword">val</span> <a title="Int" id="283684">improved</a> = <a href="#79256" title="(hcode: Int, seed: Int)Int">improve</a><span class="delimiter">(</span><a href="#283680" title="Int">hcode</a>, <a href="#79275" title="=&gt; Int">seedvalue</a><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="Int" id="283685">shifted</a> = <span class="delimiter">(</span><a href="#283684" title="Int">improved</a> <a href="../../Int.scala.html#57886" title="(x: Int)Int">&gt;&gt;</a> <span class="delimiter">(</span><span title="Int(32)" class="int">32</span> <a href="../../Int.scala.html#57955" title="(x: Int)Int">-</a> java.lang.<span title="Integer.type">Integer</span>.<span title="(x$1: Int)Int">bitCount</span><span class="delimiter">(</span><a href="#283683" title="Int">ones</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../Int.scala.html#57938" title="(x: Int)Int">&amp;</a> <a href="#283683" title="Int">ones</a>
    <a href="#283685" title="Int">shifted</a>
  <span class="delimiter">}</span>

  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="(c: scala.collection.mutable.HashTable.Contents[A,Entry])Unit" id="79308">initWithContents</a><span class="delimiter">(</span><a title="scala.collection.mutable.HashTable.Contents[A,Entry]" id="281542">c</a>: HashTable.<a href="#79249" title="scala.collection.mutable.HashTable.Contents[A,Entry]">Contents</a><span class="delimiter">[</span>A, Entry<span class="delimiter">]</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#281542" title="scala.collection.mutable.HashTable.Contents[A,Entry]">c</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#79260" title="(x$1: Int)Unit">_loadFactor</a> = <a href="#281542" title="scala.collection.mutable.HashTable.Contents[A,Entry]">c</a>.<a href="#281618" title="=&gt; Int">loadFactor</a>
      <a href="#79263" title="(x$1: Array[scala.collection.mutable.HashEntry[A,Entry]])Unit">table</a> = <a href="#281542" title="scala.collection.mutable.HashTable.Contents[A,Entry]">c</a>.<a href="#281619" title="=&gt; Array[scala.collection.mutable.HashEntry[A,Entry]]">table</a>
      <a href="#79266" title="(x$1: Int)Unit">tableSize</a> = <a href="#281542" title="scala.collection.mutable.HashTable.Contents[A,Entry]">c</a>.<a href="#281620" title="=&gt; Int">tableSize</a>
      <a href="#79269" title="(x$1: Int)Unit">threshold</a> = <a href="#281542" title="scala.collection.mutable.HashTable.Contents[A,Entry]">c</a>.<a href="#281621" title="=&gt; Int">threshold</a>
      <a href="#79275" title="(x$1: Int)Unit">seedvalue</a> = <a href="#281542" title="scala.collection.mutable.HashTable.Contents[A,Entry]">c</a>.<a href="#281622" title="=&gt; Int">seedvalue</a>
      <a href="#79272" title="(x$1: Array[Int])Unit">sizemap</a> = <a href="#281542" title="scala.collection.mutable.HashTable.Contents[A,Entry]">c</a>.<a href="#281623" title="=&gt; Array[Int]">sizemap</a>
    <span class="delimiter">}</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#79305" title="=&gt; Boolean">alwaysInitSizeMap</a> <a href="../../Boolean.scala.html#58725" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#79272" title="=&gt; Array[Int]">sizemap</a> <span title="(x$1: AnyRef)Boolean">==</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <a href="#79301" title="()Unit">sizeMapInitAndRebuild</a>
  <span class="delimiter">}</span>

  <span class="keyword">private</span><span class="delimiter">[</span>collection<span class="delimiter">]</span> <span class="keyword">def</span> <a title="=&gt; scala.collection.mutable.HashTable.Contents[A,Entry]" id="79309">hashTableContents</a> = <span title="scala.collection.mutable.HashTable.Contents[A,Entry]" class="keyword">new</span> HashTable.<a href="#79249" title="scala.collection.mutable.HashTable.Contents[A,Entry]">Contents</a><span class="delimiter">(</span>
    <a href="#79260" title="=&gt; Int">_loadFactor</a>,
    <a href="#79263" title="=&gt; Array[scala.collection.mutable.HashEntry[A,Entry]]">table</a>,
    <a href="#79266" title="=&gt; Int">tableSize</a>,
    <a href="#79269" title="=&gt; Int">threshold</a>,
    <a href="#79275" title="=&gt; Int">seedvalue</a>,
    <a href="#79272" title="=&gt; Array[Int]">sizemap</a>
  <span class="delimiter">)</span>
<span class="delimiter">}</span>

<span class="keyword">private</span><span class="delimiter">[</span>collection<span class="delimiter">]</span> <span class="keyword">object</span> <a title="scala.collection.mutable.HashTable.type" id="13223">HashTable</a> <a href="#13224" title="scala.collection.mutable.HashTable.type" class="delimiter">{</a>
  /** The load factor for the hash table (in 0.001 step).
   */
  <span class="keyword">private</span><span class="delimiter">[</span>collection<span class="delimiter">]</span> <span class="keyword">final</span> <span class="keyword">def</span> <a title="=&gt; Int" id="79238">defaultLoadFactor</a>: <a href="../../Int.scala.html#508" title="Int">Int</a> = <span title="Int(750)" class="int">750</span> // corresponds to 75%
  <span class="keyword">private</span><span class="delimiter">[</span>collection<span class="delimiter">]</span> <span class="keyword">final</span> <span class="keyword">def</span> <a title="=&gt; Int" id="79239">loadFactorDenum</a> = <span title="Int(1000)" class="int">1000</span>;

  /** The initial size of the hash table.
   */
  <span class="keyword">private</span><span class="delimiter">[</span>collection<span class="delimiter">]</span> <span class="keyword">final</span> <span class="keyword">def</span> <a title="=&gt; Int" id="79240">initialSize</a>: <a href="../../Int.scala.html#508" title="Int">Int</a> = <span title="Int(16)" class="int">16</span>

  /** The initial threshold.
   */
  <span class="keyword">private</span><span class="delimiter">[</span>collection<span class="delimiter">]</span> <span class="keyword">final</span> <span class="keyword">def</span> <a title="(_loadFactor: Int)Int" id="79241">initialThreshold</a><span class="delimiter">(</span><a title="Int" id="283497">_loadFactor</a>: <a href="../../Int.scala.html#508" title="Int">Int</a><span class="delimiter">)</span>: <a href="../../Int.scala.html#508" title="Int">Int</a> = <a href="#79243" title="(_loadFactor: Int, size: Int)Int">newThreshold</a><span class="delimiter">(</span><a href="#283497" title="Int">_loadFactor</a>, <a href="#79242" title="=&gt; Int">initialCapacity</a><span class="delimiter">)</span>

  <span class="keyword">private</span><span class="delimiter">[</span>collection<span class="delimiter">]</span> <span class="keyword">final</span> <span class="keyword">def</span> <a title="=&gt; Int" id="79242">initialCapacity</a> = <a href="#79245" title="(expectedSize: Int)Int">capacity</a><span class="delimiter">(</span><a href="#79240" title="=&gt; Int">initialSize</a><span class="delimiter">)</span>

  <span class="keyword">private</span><span class="delimiter">[</span>collection<span class="delimiter">]</span> <span class="keyword">final</span> <span class="keyword">def</span> <a title="(_loadFactor: Int, size: Int)Int" id="79243">newThreshold</a><span class="delimiter">(</span><a title="Int" id="283558">_loadFactor</a>: <a href="../../Int.scala.html#508" title="Int">Int</a>, <a title="Int" id="283559">size</a>: <a href="../../Int.scala.html#508" title="Int">Int</a><span class="delimiter">)</span> = <span class="delimiter">(</span><span class="delimiter">(</span><a href="#283559" title="Int">size</a>.<a href="../../Int.scala.html#57875" title="=&gt; Long">toLong</a> <a href="../../Long.scala.html#58324" title="(x: Int)Long">*</a> <a href="#283558" title="Int">_loadFactor</a><span class="delimiter">)</span> <a href="../../Long.scala.html#58331" title="(x: Int)Long">/</a> <a href="#79239" title="=&gt; Int">loadFactorDenum</a><span class="delimiter">)</span>.<a href="../../Long.scala.html#58236" title="=&gt; Int">toInt</a>

  <span class="keyword">private</span><span class="delimiter">[</span>collection<span class="delimiter">]</span> <span class="keyword">final</span> <span class="keyword">def</span> <a title="(_loadFactor: Int, thr: Int)Int" id="79244">sizeForThreshold</a><span class="delimiter">(</span><a title="Int" id="283548">_loadFactor</a>: <a href="../../Int.scala.html#508" title="Int">Int</a>, <a title="Int" id="283549">thr</a>: <a href="../../Int.scala.html#508" title="Int">Int</a><span class="delimiter">)</span> = <span class="delimiter">(</span><span class="delimiter">(</span><a href="#283549" title="Int">thr</a>.<a href="../../Int.scala.html#57875" title="=&gt; Long">toLong</a> <a href="../../Long.scala.html#58324" title="(x: Int)Long">*</a> <a href="#79239" title="=&gt; Int">loadFactorDenum</a><span class="delimiter">)</span> <a href="../../Long.scala.html#58331" title="(x: Int)Long">/</a> <a href="#283548" title="Int">_loadFactor</a><span class="delimiter">)</span>.<a href="../../Long.scala.html#58236" title="=&gt; Int">toInt</a>

  <span class="keyword">private</span><span class="delimiter">[</span>collection<span class="delimiter">]</span> <span class="keyword">final</span> <span class="keyword">def</span> <a title="(expectedSize: Int)Int" id="79245">capacity</a><span class="delimiter">(</span><a title="Int" id="283492">expectedSize</a>: <a href="../../Int.scala.html#508" title="Int">Int</a><span class="delimiter">)</span> = <span title="Int" class="keyword">if</span> <span class="delimiter">(</span><a href="#283492" title="Int">expectedSize</a> <a href="../../Int.scala.html#57891" title="(x: Int)Boolean">==</a> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span title="Int(1)" class="int">1</span> <span class="keyword">else</span> <a href="#79248" title="(target: Int)Int">powerOfTwo</a><span class="delimiter">(</span><a href="#283492" title="Int">expectedSize</a><span class="delimiter">)</span>

  <span class="keyword">trait</span> <a title="trait HashUtils[KeyType] extends Object" id="79246">HashUtils</a><span class="delimiter">[</span><a title="" id="79247">KeyType</a><span class="delimiter">]</span> <a href="../../Unit.scala.html#2389" title="Unit" class="delimiter">{</a>
    <span class="keyword">protected</span> <span class="keyword">final</span> <span class="keyword">def</span> <a title="=&gt; Int" id="79253">sizeMapBucketBitSize</a> = <span title="Int(5)" class="int">5</span>
    // so that:
    <span class="keyword">protected</span> <span class="keyword">final</span> <span class="keyword">def</span> <a title="=&gt; Int" id="79254">sizeMapBucketSize</a> = <span title="Int(1)" class="int">1</span> <a href="../../Int.scala.html#57882" title="(x: Int)Int">&lt;&lt;</a> <a href="#79253" title="=&gt; Int">sizeMapBucketBitSize</a>

    <span class="keyword">protected</span> <span class="keyword">def</span> <a title="(key: KeyType)Int" id="79255">elemHashCode</a><span class="delimiter">(</span><a title="KeyType" id="283735">key</a>: <a href="#79247" title="KeyType">KeyType</a><span class="delimiter">)</span> = <a href="#283735" title="KeyType">key</a>.<span title="()Int">##</span>

    <span class="keyword">protected</span> <span class="keyword">final</span> <span class="keyword">def</span> <a title="(hcode: Int, seed: Int)Int" id="79256">improve</a><span class="delimiter">(</span><a title="Int" id="283690">hcode</a>: <a href="../../Int.scala.html#508" title="Int">Int</a>, <a title="Int" id="283691">seed</a>: <a href="../../Int.scala.html#508" title="Int">Int</a><span class="delimiter">)</span> = <span class="delimiter">{</span>
      /* Murmur hash
       *  m = 0x5bd1e995
       *  r = 24
       *  note: h = seed = 0 in mmix
       *  mmix(h,k) = k *= m; k ^= k &gt;&gt; r; k *= m; h *= m; h ^= k; */
      // var k = hcode * 0x5bd1e995
      // k ^= k &gt;&gt; 24
      // k *= 0x5bd1e995
      // k

      /* Another fast multiplicative hash
       * by Phil Bagwell
       *
       * Comment:
       * Multiplication doesn't affect all the bits in the same way, so we want to
       * multiply twice, &quot;once from each side&quot;.
       * It would be ideal to reverse all the bits after the first multiplication,
       * however, this is more costly. We therefore restrict ourselves only to
       * reversing the bytes before final multiplication. This yields a slightly
       * worse entropy in the lower 8 bits, but that can be improved by adding:
       *
       * `i ^= i &gt;&gt; 6`
       *
       * For performance reasons, we avoid this improvement.
       * */
      <span class="keyword">var</span> <a title="Int" id="283692">i</a> = <a href="#283690" title="Int">hcode</a> <a href="../../Int.scala.html#57962" title="(x: Int)Int">*</a> <span title="Int(-1640532531)" class="int">0x9e3775cd</span>
      <a href="#283692" title="Int">i</a> = java.lang.<span title="Integer.type">Integer</span>.<span title="(x$1: Int)Int">reverseBytes</span><span class="delimiter">(</span><a href="#283692" title="Int">i</a><span class="delimiter">)</span>
      <a href="#283692" title="Int">i</a> = <a href="#283692" title="Int">i</a> <a href="../../Int.scala.html#57962" title="(x: Int)Int">*</a> <span title="Int(-1640532531)" class="int">0x9e3775cd</span>
      // a slower alternative for byte reversal:
      // i = (i &lt;&lt; 16) | (i &gt;&gt; 16)
      // i = ((i &gt;&gt; 8) &amp; 0x00ff00ff) | ((i &lt;&lt; 8) &amp; 0xff00ff00)

      /* Jenkins hash
       * for range 0-10000, output has the msb set to zero */
      // var h = hcode + (hcode &lt;&lt; 12)
      // h ^= (h &gt;&gt; 22)
      // h += (h &lt;&lt; 4)
      // h ^= (h &gt;&gt; 9)
      // h += (h &lt;&lt; 10)
      // h ^= (h &gt;&gt; 2)
      // h += (h &lt;&lt; 7)
      // h ^= (h &gt;&gt; 12)
      // h

      /* OLD VERSION
       * quick, but bad for sequence 0-10000 - little enthropy in higher bits
       * since 2003 */
      // var h: Int = hcode + ~(hcode &lt;&lt; 9)
      // h = h ^ (h &gt;&gt;&gt; 14)
      // h = h + (h &lt;&lt; 4)
      // h ^ (h &gt;&gt;&gt; 10)

      // the rest of the computation is due to SI-5293
      <span class="keyword">val</span> <a title="Int" id="283693">rotation</a> = <a href="#283691" title="Int">seed</a> <a href="../../Int.scala.html#57976" title="(x: Int)Int">%</a> <span title="Int(32)" class="int">32</span>
      <span class="keyword">val</span> <a title="Int" id="283694">rotated</a> = <span class="delimiter">(</span><a href="#283692" title="Int">i</a> <a href="../../Int.scala.html#57884" title="(x: Int)Int">&gt;&gt;&gt;</a> <a href="#283693" title="Int">rotation</a><span class="delimiter">)</span> <a href="../../Int.scala.html#57933" title="(x: Int)Int">|</a> <span class="delimiter">(</span><a href="#283692" title="Int">i</a> <a href="../../Int.scala.html#57882" title="(x: Int)Int">&lt;&lt;</a> <span class="delimiter">(</span><span title="Int(32)" class="int">32</span> <a href="../../Int.scala.html#57955" title="(x: Int)Int">-</a> <a href="#283693" title="Int">rotation</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="#283694" title="Int">rotated</a>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  /**
   * Returns a power of two &gt;= `target`.
   */
  <span class="keyword">private</span><span class="delimiter">[</span>collection<span class="delimiter">]</span> <span class="keyword">def</span> <a title="(target: Int)Int" id="79248">powerOfTwo</a><span class="delimiter">(</span><a title="Int" id="280018">target</a>: <a href="../../Int.scala.html#508" title="Int">Int</a><span class="delimiter">)</span>: <a href="../../Int.scala.html#508" title="Int">Int</a> = <span class="delimiter">{</span>
    /* See http://bits.stephan-brumme.com/roundUpToNextPowerOfTwo.html */
    <span class="keyword">var</span> <a title="Int" id="284284">c</a> = <a href="#280018" title="Int">target</a> <a href="../../Int.scala.html#57955" title="(x: Int)Int">-</a> <span title="Int(1)" class="int">1</span>;
    <a href="#284284" title="Int">c</a> <a href="../../Int.scala.html#57933" title="(x: Int)Int">|=</a> <a href="#284284" title="Int">c</a> <a href="../../Int.scala.html#57884" title="(x: Int)Int">&gt;&gt;&gt;</a>  <span title="Int(1)" class="int">1</span>;
    <a href="#284284" title="Int">c</a> <a href="../../Int.scala.html#57933" title="(x: Int)Int">|=</a> <a href="#284284" title="Int">c</a> <a href="../../Int.scala.html#57884" title="(x: Int)Int">&gt;&gt;&gt;</a>  <span title="Int(2)" class="int">2</span>;
    <a href="#284284" title="Int">c</a> <a href="../../Int.scala.html#57933" title="(x: Int)Int">|=</a> <a href="#284284" title="Int">c</a> <a href="../../Int.scala.html#57884" title="(x: Int)Int">&gt;&gt;&gt;</a>  <span title="Int(4)" class="int">4</span>;
    <a href="#284284" title="Int">c</a> <a href="../../Int.scala.html#57933" title="(x: Int)Int">|=</a> <a href="#284284" title="Int">c</a> <a href="../../Int.scala.html#57884" title="(x: Int)Int">&gt;&gt;&gt;</a>  <span title="Int(8)" class="int">8</span>;
    <a href="#284284" title="Int">c</a> <a href="../../Int.scala.html#57933" title="(x: Int)Int">|=</a> <a href="#284284" title="Int">c</a> <a href="../../Int.scala.html#57884" title="(x: Int)Int">&gt;&gt;&gt;</a> <span title="Int(16)" class="int">16</span>;
    <a href="#284284" title="Int">c</a> <a href="../../Int.scala.html#57948" title="(x: Int)Int">+</a> <span title="Int(1)" class="int">1</span>;
  <span class="delimiter">}</span>

  <span class="keyword">class</span> <a title="class Contents[A, Entry &gt;: Null &lt;: scala.collection.mutable.HashEntry[A,Entry]] extends Object" id="79249">Contents</a><span class="delimiter">[</span><a title="" id="79250">A</a>, <a title=" &gt;: Null &lt;: scala.collection.mutable.HashEntry[A,Entry]" id="79251">Entry</a> &gt;: Null &lt;: HashEntry<span class="delimiter">[</span>A, Entry<span class="delimiter">]</span><span class="delimiter">]</span><a href="#79249" title="scala.collection.mutable.HashTable.Contents[A,Entry]" class="delimiter">(</a>
    <span class="keyword">val</span> <a title="Int" id="281618">loadFactor</a>: <a href="../../Int.scala.html#508" title="Int">Int</a>,
    <span class="keyword">val</span> <a title="Array[scala.collection.mutable.HashEntry[A,Entry]]" id="281619">table</a>: <a href="../../Array.scala.html#292" title="Array[scala.collection.mutable.HashEntry[A,Entry]]">Array</a><span class="delimiter">[</span>HashEntry<span class="delimiter">[</span>A, Entry<span class="delimiter">]</span><span class="delimiter">]</span>,
    <span class="keyword">val</span> <a title="Int" id="281620">tableSize</a>: <a href="../../Int.scala.html#508" title="Int">Int</a>,
    <span class="keyword">val</span> <a title="Int" id="281621">threshold</a>: <a href="../../Int.scala.html#508" title="Int">Int</a>,
    <span class="keyword">val</span> <a title="Int" id="281622">seedvalue</a>: <a href="../../Int.scala.html#508" title="Int">Int</a>,
    <span class="keyword">val</span> <a title="Array[Int]" id="281623">sizemap</a>: <a href="../../Array.scala.html#292" title="Array[Int]">Array</a><span class="delimiter">[</span>Int<span class="delimiter">]</span>
  <span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">import</span> collection.<a href="../package.scala.html#5303" title="scala.collection.DebugUtils.type">DebugUtils</a>._
    <span class="keyword">private</span><span class="delimiter">[</span>collection<span class="delimiter">]</span> <span class="keyword">def</span> <a title="=&gt; String" id="141447">debugInformation</a> = <a href="../package.scala.html#284355" title="(closure: (Any =&gt; Unit) =&gt; Unit)String">buildString</a> <span class="delimiter">{</span>
      <a title="Any =&gt; Unit" id="284361">append</a> =&gt;
      <a href="../../Function1.scala.html#59555" title="(v1: Any)Unit">append</a><span class="delimiter">(</span><span title="String(&quot;Hash table contents&quot;)" class="string">&quot;Hash table contents&quot;</span><span class="delimiter">)</span>
      <a href="../../Function1.scala.html#59555" title="(v1: Any)Unit">append</a><span class="delimiter">(</span><span title="String(&quot;-------------------&quot;)" class="string">&quot;-------------------&quot;</span><span class="delimiter">)</span>
      <a href="../../Function1.scala.html#59555" title="(v1: Any)Unit">append</a><span class="delimiter">(</span><span title="String(&quot;Table: [&quot;)" class="string">&quot;Table: [&quot;</span> <span title="(x$1: Any)String">+</span> <a href="../package.scala.html#284356" title="(array: Array[scala.collection.mutable.HashEntry[A,Entry]], from: Int, until: Int)String">arrayString</a><span class="delimiter">(</span><a href="#281619" title="=&gt; Array[scala.collection.mutable.HashEntry[A,Entry]]">table</a>, <span title="Int(0)" class="int">0</span>, <a href="#281619" title="=&gt; Array[scala.collection.mutable.HashEntry[A,Entry]]">table</a>.<a href="../../Array.scala.html#57449" title="=&gt; Int">length</a><span class="delimiter">)</span> <span title="(x$1: Any)String">+</span> <span title="String(&quot;]&quot;)" class="string">&quot;]&quot;</span><span class="delimiter">)</span>
      <a href="../../Function1.scala.html#59555" title="(v1: Any)Unit">append</a><span class="delimiter">(</span><span title="String(&quot;Table size: &quot;)" class="string">&quot;Table size: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#281620" title="=&gt; Int">tableSize</a><span class="delimiter">)</span>
      <a href="../../Function1.scala.html#59555" title="(v1: Any)Unit">append</a><span class="delimiter">(</span><span title="String(&quot;Load factor: &quot;)" class="string">&quot;Load factor: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#281618" title="=&gt; Int">loadFactor</a><span class="delimiter">)</span>
      <a href="../../Function1.scala.html#59555" title="(v1: Any)Unit">append</a><span class="delimiter">(</span><span title="String(&quot;Seedvalue: &quot;)" class="string">&quot;Seedvalue: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#281622" title="=&gt; Int">seedvalue</a><span class="delimiter">)</span>
      <a href="../../Function1.scala.html#59555" title="(v1: Any)Unit">append</a><span class="delimiter">(</span><span title="String(&quot;Threshold: &quot;)" class="string">&quot;Threshold: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#281621" title="=&gt; Int">threshold</a><span class="delimiter">)</span>
      <a href="../../Function1.scala.html#59555" title="(v1: Any)Unit">append</a><span class="delimiter">(</span><span title="String(&quot;Sizemap: [&quot;)" class="string">&quot;Sizemap: [&quot;</span> <span title="(x$1: Any)String">+</span> <a href="../package.scala.html#284356" title="(array: Array[Int], from: Int, until: Int)String">arrayString</a><span class="delimiter">(</span><a href="#281623" title="=&gt; Array[Int]">sizemap</a>, <span title="Int(0)" class="int">0</span>, <a href="#281623" title="=&gt; Array[Int]">sizemap</a>.<a href="../../Array.scala.html#57449" title="=&gt; Int">length</a><span class="delimiter">)</span> <span title="(x$1: Any)String">+</span> <span title="String(&quot;]&quot;)" class="string">&quot;]&quot;</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

<span title="Object" class="delimiter">}</span>

        </pre>
    </body>
</html>