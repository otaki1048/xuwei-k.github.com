<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>scala/collection/parallel/Tasks.scala</title>
        <script type="text/javascript" src="../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
/*                     __                                               *\
**     ________ ___   / /  ___     Scala API                            **
**    / __/ __// _ | / /  / _ |    (c) 2003-2011, LAMP/EPFL             **
**  __\ \/ /__/ __ |/ /__/ __ |    http://scala-lang.org/               **
** /____/\___/_/ |_/____/_/ | |                                         **
**                          |/                                          **
\*                                                                      */

<span class="keyword">package</span> scala.collection.parallel



<span class="keyword">import</span> java.util.concurrent.ThreadPoolExecutor

<span class="keyword">import</span> scala.concurrent.forkjoin._
<span class="keyword">import</span> scala.concurrent.ExecutionContext
<span class="keyword">import</span> scala.util.control.<a href="../../util/control/Breaks.scala.html#53827" title="scala.util.control.Breaks.type">Breaks</a>._

<span class="keyword">import</span> annotation.unchecked.uncheckedVariance



<span class="keyword">trait</span> <a title="trait Task[R, +Tp] extends Object" id="14357">Task</a><span class="delimiter">[</span><a title="" id="15662">R</a>, +<a title="" id="15663">Tp</a><span class="delimiter">]</span> <a href="../../Unit.scala.html#2389" title="Unit" class="delimiter">{</a>
  <span class="keyword">type</span> <a title="R" id="247853">Result</a> = <a href="#15662" title="R">R</a>

  <span class="keyword">def</span> <a title="=&gt; Tp" id="247854">repr</a> = <a href="#14357" title="Task.this.type" class="keyword">this</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="Tp" class="delimiter">[</span><a href="#15663" title="Tp">Tp</a><span class="delimiter">]</span>

  /** Body of the task - non-divisible unit of work done by this task.
   *  Optionally is provided with the result from the previous completed task
   *  or `None` if there was no previous task (or the previous task is uncompleted or unknown).
   */
  <span class="keyword">def</span> <a title="(result: Option[R])Unit" id="247855">leaf</a><span class="delimiter">(</span><a title="Option[R]" id="248014">result</a>: <a href="../../Option.scala.html#1510" title="Option[R]">Option</a><span class="delimiter">[</span>R<span class="delimiter">]</span><span class="delimiter">)</span>

  /** A result that can be accessed once the task is completed. */
  <span class="keyword">var</span> <a title="=&gt; R" id="247857">result</a>: <a href="#15662" title="R">R</a>

  /** Decides whether or not this task should be split further. */
  <span class="keyword">def</span> <a title="=&gt; Boolean" id="247858">shouldSplitFurther</a>: <a href="../../Boolean.scala.html#2218" title="Boolean">Boolean</a>

  /** Splits this task into a list of smaller tasks. */
  <span class="keyword">private</span><span class="delimiter">[</span>parallel<span class="delimiter">]</span> <span class="keyword">def</span> <a title="=&gt; Seq[scala.collection.parallel.Task[R,Tp]]" id="247859">split</a>: <a href="../Seq.scala.html#5620" title="Seq[scala.collection.parallel.Task[R,Tp]]">Seq</a><span class="delimiter">[</span>Task<span class="delimiter">[</span>R, Tp<span class="delimiter">]</span><span class="delimiter">]</span>

  /** Read of results of `that` task and merge them into results of this one. */
  <span class="keyword">private</span><span class="delimiter">[</span>parallel<span class="delimiter">]</span> <span class="keyword">def</span> <a title="(that: Tp)Unit" id="247860">merge</a><span class="delimiter">(</span><a title="Tp @scala.annotation.unchecked.uncheckedVariance" id="350386">that</a>: Tp @<a href="#15663" title="Tp @scala.annotation.unchecked.uncheckedVariance">uncheckedVariance</a><span class="delimiter">)</span> <span title="Unit" class="delimiter">{</span><span class="delimiter">}</span>

  // exception handling mechanism
  @volatile <span class="keyword">var</span> <a title="Throwable" id="247862">throwable</a>: <span title="Throwable">Throwable</span> = <span title="Null(null)" class="keyword">null</span>
  <span class="keyword">def</span> <a title="()Unit" id="247864">forwardThrowable</a><span class="delimiter">(</span><span class="delimiter">)</span> = <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#247862" title="=&gt; Throwable">throwable</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <span title="Nothing" class="keyword">throw</span> <a href="#247862" title="=&gt; Throwable">throwable</a>

  // tries to do the leaf computation, storing the possible exception
  <span class="keyword">private</span><span class="delimiter">[</span>parallel<span class="delimiter">]</span> <span class="keyword">def</span> <a title="(lastres: Option[R])Unit" id="247865">tryLeaf</a><span class="delimiter">(</span><a title="Option[R]" id="384106">lastres</a>: <a href="../../Option.scala.html#1510" title="Option[R]">Option</a><span class="delimiter">[</span>R<span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">try</span> <span class="delimiter">{</span>
      <a href="../../util/control/Breaks.scala.html#59409" title="(op: =&gt; Unit)util.control.Breaks.TryBlock">tryBreakable</a> <span class="delimiter">{</span>
        <a href="#247855" title="(result: Option[R])Unit">leaf</a><span class="delimiter">(</span><a href="#384106" title="Option[R]">lastres</a><span class="delimiter">)</span>
        <a href="#247857" title="(x$1: R)Unit">result</a> = <a href="#247857" title="=&gt; R">result</a> // ensure that effects of `leaf` are visible to readers of `result`
      <span class="delimiter">}</span> <a href="../../util/control/Breaks.scala.html#384109" title="(onBreak: =&gt; Unit)Unit">catchBreak</a> <span class="delimiter">{</span>
        <a href="#247869" title="()Unit">signalAbort</a>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span> <span class="keyword">catch</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <a title="Unit" id="384133">thr</a>: <span title="Exception">Exception</span> =&gt;
        <a href="#247857" title="(x$1: R)Unit">result</a> = <a href="#247857" title="=&gt; R">result</a> // ensure that effects of `leaf` are visible
      <a href="#247862" title="(x$1: Throwable)Unit">throwable</a> = <a href="#384133" title="Exception">thr</a>
      <a href="#247869" title="()Unit">signalAbort</a>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">private</span><span class="delimiter">[</span>parallel<span class="delimiter">]</span> <span class="keyword">def</span> <a title="(t: Tp)Unit" id="247866">tryMerge</a><span class="delimiter">(</span><a title="Tp @scala.annotation.unchecked.uncheckedVariance" id="384135">t</a>: Tp @<a href="#15663" title="Tp @scala.annotation.unchecked.uncheckedVariance">uncheckedVariance</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="scala.collection.parallel.Task[R,Tp]" id="384136">that</a> = <a href="#384135" title="Tp @scala.annotation.unchecked.uncheckedVariance">t</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="scala.collection.parallel.Task[R,Tp]" class="delimiter">[</span><a href="#14357" title="scala.collection.parallel.Task[R,Tp]">Task</a><span class="delimiter">[</span>R, Tp<span class="delimiter">]</span><span class="delimiter">]</span>
    <span class="keyword">val</span> <a title="R" id="384137">local</a> = <a href="#247857" title="=&gt; R">result</a> // ensure that any effects of modifying `result` are detected
    // checkMerge(that)
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#14357" title="Task.this.type" class="keyword">this</a>.<a href="#247862" title="=&gt; Throwable">throwable</a> <span title="(x$1: AnyRef)Boolean">==</span> <span title="Null(null)" class="keyword">null</span> <a href="../../Boolean.scala.html#58725" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#384136" title="scala.collection.parallel.Task[R,Tp]">that</a>.<a href="#247862" title="=&gt; Throwable">throwable</a> <span title="(x$1: AnyRef)Boolean">==</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <a href="#247860" title="(that: Tp)Unit">merge</a><span class="delimiter">(</span><a href="#384135" title="Tp @scala.annotation.unchecked.uncheckedVariance">t</a><span class="delimiter">)</span>
    <a href="#247868" title="(that: scala.collection.parallel.Task[_, _])Unit">mergeThrowables</a><span class="delimiter">(</span><a href="#384136" title="scala.collection.parallel.Task[R,Tp]">that</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(that: scala.collection.parallel.Task[R,Tp])Unit" id="247867">checkMerge</a><span class="delimiter">(</span><a title="scala.collection.parallel.Task[R,Tp] @scala.annotation.unchecked.uncheckedVariance" id="384151">that</a>: Task<span class="delimiter">[</span>R, Tp<span class="delimiter">]</span> @<a href="#14357" title="scala.collection.parallel.Task[R,Tp] @scala.annotation.unchecked.uncheckedVariance">uncheckedVariance</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#14357" title="Task.this.type" class="keyword">this</a>.<a href="#247862" title="=&gt; Throwable">throwable</a> <span title="(x$1: AnyRef)Boolean">==</span> <span title="Null(null)" class="keyword">null</span> <a href="../../Boolean.scala.html#58725" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#384151" title="scala.collection.parallel.Task[R,Tp] @scala.annotation.unchecked.uncheckedVariance">that</a>.<a href="#247862" title="=&gt; Throwable">throwable</a> <span title="(x$1: AnyRef)Boolean">==</span> <span title="Null(null)" class="keyword">null</span> <a href="../../Boolean.scala.html#58725" title="(x: Boolean)Boolean">&amp;&amp;</a> <span class="delimiter">(</span><a href="#14357" title="Task.this.type" class="keyword">this</a>.<a href="#247857" title="=&gt; R">result</a> <span title="(x$1: Any)Boolean">==</span> <span title="Null(null)" class="keyword">null</span> <a href="../../Boolean.scala.html#58724" title="(x: Boolean)Boolean">||</a> <a href="#384151" title="scala.collection.parallel.Task[R,Tp] @scala.annotation.unchecked.uncheckedVariance">that</a>.<a href="#247857" title="=&gt; R">result</a> <span title="(x$1: Any)Boolean">==</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="../../Predef.scala.html#8489" title="(x: Any)Unit">println</a><span class="delimiter">(</span><span title="String(&quot;This: &quot;)" class="string">&quot;This: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#14357" title="scala.collection.parallel.Task[R,Tp]" class="keyword">this</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;, thr=&quot;)" class="string">&quot;, thr=&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#14357" title="Task.this.type" class="keyword">this</a>.<a href="#247862" title="=&gt; Throwable">throwable</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;; merged with &quot;)" class="string">&quot;; merged with &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#384151" title="scala.collection.parallel.Task[R,Tp] @scala.annotation.unchecked.uncheckedVariance">that</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;, thr=&quot;)" class="string">&quot;, thr=&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#384151" title="scala.collection.parallel.Task[R,Tp] @scala.annotation.unchecked.uncheckedVariance">that</a>.<a href="#247862" title="=&gt; Throwable">throwable</a><span class="delimiter">)</span>
    <span class="delimiter">}</span> <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#14357" title="Task.this.type" class="keyword">this</a>.<a href="#247862" title="=&gt; Throwable">throwable</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span> <a href="../../Boolean.scala.html#58724" title="(x: Boolean)Boolean">||</a> <a href="#384151" title="scala.collection.parallel.Task[R,Tp] @scala.annotation.unchecked.uncheckedVariance">that</a>.<a href="#247862" title="=&gt; Throwable">throwable</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="../../Predef.scala.html#8489" title="(x: Any)Unit">println</a><span class="delimiter">(</span><span title="String(&quot;merging this: &quot;)" class="string">&quot;merging this: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#14357" title="scala.collection.parallel.Task[R,Tp]" class="keyword">this</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; with thr: &quot;)" class="string">&quot; with thr: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#14357" title="Task.this.type" class="keyword">this</a>.<a href="#247862" title="=&gt; Throwable">throwable</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; with &quot;)" class="string">&quot; with &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#384151" title="scala.collection.parallel.Task[R,Tp] @scala.annotation.unchecked.uncheckedVariance">that</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;, thr=&quot;)" class="string">&quot;, thr=&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#384151" title="scala.collection.parallel.Task[R,Tp] @scala.annotation.unchecked.uncheckedVariance">that</a>.<a href="#247862" title="=&gt; Throwable">throwable</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">private</span><span class="delimiter">[</span>parallel<span class="delimiter">]</span> <span class="keyword">def</span> <a title="(that: scala.collection.parallel.Task[_, _])Unit" id="247868">mergeThrowables</a><span class="delimiter">(</span><a title="scala.collection.parallel.Task[_, _]" id="350316">that</a>: <a href="#14357" title="scala.collection.parallel.Task[_, _]">Task</a><span class="delimiter">[</span>_, _<span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#14357" title="Task.this.type" class="keyword">this</a>.<a href="#247862" title="=&gt; Throwable">throwable</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span> <a href="../../Boolean.scala.html#58725" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#350316" title="scala.collection.parallel.Task[_, _]">that</a>.<a href="#247862" title="=&gt; Throwable">throwable</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      // merge exceptions, since there were multiple exceptions
      <a href="#14357" title="Task.this.type" class="keyword">this</a>.<a href="#247862" title="(x$1: Throwable)Unit">throwable</a> = <a href="#14357" title="Task.this.type" class="keyword">this</a>.<a href="package.scala.html#56848" title="implicit scala.collection.parallel.package.throwable2ops : (self: Throwable)scala.collection.parallel.ThrowableOps">throwable</a> <a href="package.scala.html#71221" title="(that: Throwable)Throwable">alongWith</a> <a href="#350316" title="scala.collection.parallel.Task[_, _]">that</a>.<a href="#247862" title="=&gt; Throwable">throwable</a>
    <span class="delimiter">}</span> <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#350316" title="scala.collection.parallel.Task[_, _]">that</a>.<a href="#247862" title="=&gt; Throwable">throwable</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <a href="#14357" title="Task.this.type" class="keyword">this</a>.<a href="#247862" title="(x$1: Throwable)Unit">throwable</a> = <a href="#350316" title="scala.collection.parallel.Task[_, _]">that</a>.<a href="#247862" title="=&gt; Throwable">throwable</a>
      <span class="keyword">else</span> <a href="#14357" title="Task.this.type" class="keyword">this</a>.<a href="#247862" title="(x$1: Throwable)Unit">throwable</a> = <a href="#14357" title="Task.this.type" class="keyword">this</a>.<a href="#247862" title="=&gt; Throwable">throwable</a>
  <span class="delimiter">}</span>

  // override in concrete task implementations to signal abort to other tasks
  <span class="keyword">private</span><span class="delimiter">[</span>parallel<span class="delimiter">]</span> <span class="keyword">def</span> <a title="()Unit" id="247869">signalAbort</a><span class="delimiter">(</span><span class="delimiter">)</span> <span title="Unit" class="delimiter">{</span><span class="delimiter">}</span>
<span class="delimiter">}</span>


/** A trait that declares task execution capabilities used
 *  by parallel collections.
 */
<span title="Object" class="keyword">trait</span> <a title="trait Tasks extends Object" id="14657">Tasks</a> <a href="../../Unit.scala.html#2389" title="Unit" class="delimiter">{</a>

  <span class="keyword">private</span><span class="delimiter">[</span>parallel<span class="delimiter">]</span> <span class="keyword">val</span> <a title="scala.collection.mutable.ArrayBuffer[String]" id="248023">debugMessages</a> = collection.mutable.<a href="../generic/GenericCompanion.scala.html#60782" title="[A](elems: A*)scala.collection.mutable.ArrayBuffer[A]">ArrayBuffer</a><span title="(elems: String*)scala.collection.mutable.ArrayBuffer[String]" class="delimiter">[</span><span title="String">String</span><span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>

  <span class="keyword">private</span><span class="delimiter">[</span>parallel<span class="delimiter">]</span> <span class="keyword">def</span> <a title="(s: String)scala.collection.mutable.ArrayBuffer[String]" id="248025">debuglog</a><span class="delimiter">(</span><a title="String" id="384199">s</a>: <span title="String">String</span><span class="delimiter">)</span> = <a href="#14657" title="(x$1: scala.collection.mutable.ArrayBuffer[String])scala.collection.mutable.ArrayBuffer[String]">synchronized</a> <span class="delimiter">{</span>
    <a href="#248023" title="=&gt; scala.collection.mutable.ArrayBuffer[String]">debugMessages</a> <a href="../mutable/ArrayBuffer.scala.html#71782" title="(elem: String)Tasks.this.debugMessages.type">+=</a> <a href="#384199" title="String">s</a>
  <span class="delimiter">}</span>

  <span class="keyword">trait</span> <a title="trait WrappedTask[R, +Tp] extends Object" id="248026">WrappedTask</a><span class="delimiter">[</span><a title="" id="248027">R</a>, +<a title="" id="248028">Tp</a><span class="delimiter">]</span> <a href="../../Unit.scala.html#2389" title="Unit" class="delimiter">{</a>
    /** the body of this task - what it executes, how it gets split and how results are merged. */
    <span class="keyword">val</span> <a title="=&gt; scala.collection.parallel.Task[R,Tp]" id="384213">body</a>: <a href="#14357" title="scala.collection.parallel.Task[R,Tp]">Task</a><span class="delimiter">[</span>R, Tp<span class="delimiter">]</span>

    <span class="keyword">def</span> <a title="=&gt; Seq[Tasks.this.WrappedTask[R,Tp]]" id="384214">split</a>: <a href="../Seq.scala.html#5620" title="Seq[Tasks.this.WrappedTask[R,Tp]]">Seq</a><span class="delimiter">[</span>WrappedTask<span class="delimiter">[</span>R, Tp<span class="delimiter">]</span><span class="delimiter">]</span>
    /** Code that gets called after the task gets started - it may spawn other tasks instead of calling `leaf`. */
    <span class="keyword">def</span> <a title="()Unit" id="384215">compute</a><span class="delimiter">(</span><span class="delimiter">)</span>
    /** Start task. */
    <span class="keyword">def</span> <a title="()Unit" id="384216">start</a><span class="delimiter">(</span><span class="delimiter">)</span>
    /** Wait for task to finish. */
    <span class="keyword">def</span> <a title="()Unit" id="384217">sync</a><span class="delimiter">(</span><span class="delimiter">)</span>
    /** Try to cancel the task.
     *  @return     `true` if cancellation is successful.
     */
    <span class="keyword">def</span> <a title="()Boolean" id="384218">tryCancel</a><span class="delimiter">(</span><span class="delimiter">)</span>: <a href="../../Boolean.scala.html#2218" title="Boolean">Boolean</a>
    /** If the task has been cancelled successfully, those syncing on it may
     *  automatically be notified, depending on the implementation. If they
     *  aren't, this release method should be called after processing the
     *  cancelled task.
     *
     *  This method may be overridden.
     */
    <span class="keyword">def</span> <a title="()Unit" id="384219">release</a><span class="delimiter">(</span><span class="delimiter">)</span> <span title="Unit" class="delimiter">{</span><span class="delimiter">}</span>
  <span class="delimiter">}</span>

  /* task control */

  /** The type of the environment is more specific in the implementations. */
  <span class="keyword">val</span> <a title="=&gt; AnyRef" id="248029">environment</a>: <span title="AnyRef">AnyRef</span>

  /** Executes a task and returns a future. Forwards an exception if some task threw it. */
  <span class="keyword">def</span> <a title="[R, Tp](fjtask: scala.collection.parallel.Task[R,Tp])() =&gt; R" id="248030">execute</a><span class="delimiter">[</span><a title="" id="248033">R</a>, <a title="" id="248034">Tp</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="scala.collection.parallel.Task[R,Tp]" id="248135">fjtask</a>: <a href="#14357" title="scala.collection.parallel.Task[R,Tp]">Task</a><span class="delimiter">[</span>R, Tp<span class="delimiter">]</span><span class="delimiter">)</span>: <span class="delimiter">(</span><span class="delimiter">)</span> =&gt; R

  /** Executes a result task, waits for it to finish, then returns its result. Forwards an exception if some task threw it. */
  <span class="keyword">def</span> <a title="[R, Tp](task: scala.collection.parallel.Task[R,Tp])R" id="248035">executeAndWaitResult</a><span class="delimiter">[</span><a title="" id="248038">R</a>, <a title="" id="248039">Tp</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="scala.collection.parallel.Task[R,Tp]" id="248042">task</a>: <a href="#14357" title="scala.collection.parallel.Task[R,Tp]">Task</a><span class="delimiter">[</span>R, Tp<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#248038" title="R">R</a>

  /** Retrieves the parallelism level of the task execution environment. */
  <span class="keyword">def</span> <a title="=&gt; Int" id="248040">parallelismLevel</a>: <a href="../../Int.scala.html#508" title="Int">Int</a>

<span class="delimiter">}</span>



/** This trait implements scheduling by employing
 *  an adaptive work stealing technique.
 */
<span title="Object" class="keyword">trait</span> <a title="trait AdaptiveWorkStealingTasks extends Object with scala.collection.parallel.Tasks" id="15383">AdaptiveWorkStealingTasks</a> <a href="../../Unit.scala.html#2389" title="Unit" class="keyword">extends</a> <a href="#14657" title="scala.collection.parallel.Tasks">Tasks</a> <span class="delimiter">{</span>

  <span class="keyword">trait</span> <a title="trait WrappedTask[R, Tp] extends Object with AdaptiveWorkStealingTasks.this.WrappedTask[R,Tp]" id="382745">WrappedTask</a><span class="delimiter">[</span><a title="" id="382746">R</a>, <a title="" id="382747">Tp</a><span class="delimiter">]</span> <a href="../../Unit.scala.html#2389" title="Unit" class="keyword">extends</a> <span class="keyword">super</span>.<a href="#248026" title="AdaptiveWorkStealingTasks.this.WrappedTask[R,Tp]">WrappedTask</a><span class="delimiter">[</span>R, Tp<span class="delimiter">]</span> <span class="delimiter">{</span>
    @volatile <span class="keyword">var</span> <a title="AdaptiveWorkStealingTasks.this.WrappedTask[R,Tp]" id="384226">next</a>: <a href="#382745" title="AdaptiveWorkStealingTasks.this.WrappedTask[R,Tp]">WrappedTask</a><span class="delimiter">[</span>R, Tp<span class="delimiter">]</span> = <span title="Null(null)" class="keyword">null</span>
    @volatile <span class="keyword">var</span> <a title="Boolean" id="384229">shouldWaitFor</a> = <span title="Boolean(true)" class="keyword">true</span>

    <span class="keyword">def</span> <a title="=&gt; Seq[AdaptiveWorkStealingTasks.this.WrappedTask[R,Tp]]" id="384231">split</a>: <a href="../Seq.scala.html#5620" title="Seq[AdaptiveWorkStealingTasks.this.WrappedTask[R,Tp]]">Seq</a><span class="delimiter">[</span>WrappedTask<span class="delimiter">[</span>R, Tp<span class="delimiter">]</span><span class="delimiter">]</span>

    <span class="keyword">def</span> <a title="()Unit" id="384232">compute</a><span class="delimiter">(</span><span class="delimiter">)</span> = <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#384213" title="=&gt; scala.collection.parallel.Task[R,Tp]">body</a>.<a href="#247858" title="=&gt; Boolean">shouldSplitFurther</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#384233" title="()Unit">internal</a><span class="delimiter">(</span><span class="delimiter">)</span>
      <a href="#384219" title="()Unit">release</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
      <a href="#384213" title="=&gt; scala.collection.parallel.Task[R,Tp]">body</a>.<a href="#247865" title="(lastres: Option[R])Unit">tryLeaf</a><span class="delimiter">(</span><a href="../../Option.scala.html#2498" title="None.type">None</a><span class="delimiter">)</span>
      <a href="#384219" title="()Unit">release</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="()Unit" id="384233">internal</a><span class="delimiter">(</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
      <span class="keyword">var</span> <a title="AdaptiveWorkStealingTasks.this.WrappedTask[R,Tp]" id="384246">last</a> = <a href="#384234" title="()AdaptiveWorkStealingTasks.this.WrappedTask[R,Tp]">spawnSubtasks</a><span class="delimiter">(</span><span class="delimiter">)</span>

      <a href="#384246" title="AdaptiveWorkStealingTasks.this.WrappedTask[R,Tp]">last</a>.<a href="#384213" title="=&gt; scala.collection.parallel.Task[R,Tp]">body</a>.<a href="#247865" title="(lastres: Option[R])Unit">tryLeaf</a><span class="delimiter">(</span><a href="../../Option.scala.html#2498" title="None.type">None</a><span class="delimiter">)</span>
      <a href="#384246" title="AdaptiveWorkStealingTasks.this.WrappedTask[R,Tp]">last</a>.<a href="#384219" title="()Unit">release</a><span class="delimiter">(</span><span class="delimiter">)</span>
      <a href="#384213" title="=&gt; scala.collection.parallel.Task[R,Tp]">body</a>.<a href="#247857" title="(x$1: R)Unit">result</a> = <a href="#384246" title="AdaptiveWorkStealingTasks.this.WrappedTask[R,Tp]">last</a>.<a href="#384213" title="=&gt; scala.collection.parallel.Task[R,Tp]">body</a>.<a href="#247857" title="=&gt; R">result</a>
      <a href="#384213" title="=&gt; scala.collection.parallel.Task[R,Tp]">body</a>.<a href="#247862" title="(x$1: Throwable)Unit">throwable</a> = <a href="#384246" title="AdaptiveWorkStealingTasks.this.WrappedTask[R,Tp]">last</a>.<a href="#384213" title="=&gt; scala.collection.parallel.Task[R,Tp]">body</a>.<a href="#247862" title="=&gt; Throwable">throwable</a>

      <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><a href="#384246" title="AdaptiveWorkStealingTasks.this.WrappedTask[R,Tp]">last</a>.<a href="#384226" title="=&gt; AdaptiveWorkStealingTasks.this.WrappedTask[R,Tp]">next</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <a href="#384279" title="()Unit" class="delimiter">{</a>
        // val lastresult = Option(last.body.result)
        <span class="keyword">val</span> <a title="AdaptiveWorkStealingTasks.this.WrappedTask[R,Tp]" id="384285">beforelast</a> = <a href="#384246" title="AdaptiveWorkStealingTasks.this.WrappedTask[R,Tp]">last</a>
        <a href="#384246" title="AdaptiveWorkStealingTasks.this.WrappedTask[R,Tp]">last</a> = <a href="#384246" title="AdaptiveWorkStealingTasks.this.WrappedTask[R,Tp]">last</a>.<a href="#384226" title="=&gt; AdaptiveWorkStealingTasks.this.WrappedTask[R,Tp]">next</a>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#384246" title="AdaptiveWorkStealingTasks.this.WrappedTask[R,Tp]">last</a>.<a href="#384218" title="()Boolean">tryCancel</a><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
          // println(&quot;Done with &quot; + beforelast.body + &quot;, next direct is &quot; + last.body)
          <a href="#384246" title="AdaptiveWorkStealingTasks.this.WrappedTask[R,Tp]">last</a>.<a href="#384213" title="=&gt; scala.collection.parallel.Task[R,Tp]">body</a>.<a href="#247865" title="(lastres: Option[R])Unit">tryLeaf</a><span class="delimiter">(</span><a href="../../Option.scala.html#64111" title="(x: R)Some[R]">Some</a><span class="delimiter">(</span><a href="#384213" title="=&gt; scala.collection.parallel.Task[R,Tp]">body</a>.<a href="#247857" title="=&gt; R">result</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <a href="#384246" title="AdaptiveWorkStealingTasks.this.WrappedTask[R,Tp]">last</a>.<a href="#384219" title="()Unit">release</a><span class="delimiter">(</span><span class="delimiter">)</span>
        <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
          // println(&quot;Done with &quot; + beforelast.body + &quot;, next sync is &quot; + last.body)
          <a href="#384246" title="AdaptiveWorkStealingTasks.this.WrappedTask[R,Tp]">last</a>.<a href="#384217" title="()Unit">sync</a><span class="delimiter">(</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>
        // println(&quot;Merging &quot; + body + &quot; with &quot; + last.body)
        <a href="#384213" title="=&gt; scala.collection.parallel.Task[R,Tp]">body</a>.<a href="#247866" title="(t: Tp)Unit">tryMerge</a><span class="delimiter">(</span><a href="#384246" title="AdaptiveWorkStealingTasks.this.WrappedTask[R,Tp]">last</a>.<a href="#384213" title="=&gt; scala.collection.parallel.Task[R,Tp]">body</a>.<a href="#247854" title="=&gt; Tp">repr</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="()AdaptiveWorkStealingTasks.this.WrappedTask[R,Tp]" id="384234">spawnSubtasks</a><span class="delimiter">(</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
      <span class="keyword">var</span> <a title="AdaptiveWorkStealingTasks.this.WrappedTask[R,Tp]" id="384249">last</a>: <a href="#382745" title="AdaptiveWorkStealingTasks.this.WrappedTask[R,Tp]">WrappedTask</a><span class="delimiter">[</span>R, Tp<span class="delimiter">]</span> = <span title="Null(null)" class="keyword">null</span>
      <span class="keyword">var</span> <a title="AdaptiveWorkStealingTasks.this.WrappedTask[R,Tp]" id="384250">head</a>: <a href="#382745" title="AdaptiveWorkStealingTasks.this.WrappedTask[R,Tp]">WrappedTask</a><span class="delimiter">[</span>R, Tp<span class="delimiter">]</span> = <a href="#382745" title="AdaptiveWorkStealingTasks.this.WrappedTask[R,Tp]" class="keyword">this</a>
      <a href="#384251" title="Unit" class="keyword">do</a> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="Seq[AdaptiveWorkStealingTasks.this.WrappedTask[R,Tp]]" id="384252">subtasks</a> = <a href="#384250" title="AdaptiveWorkStealingTasks.this.WrappedTask[R,Tp]">head</a>.<a href="#384231" title="=&gt; Seq[AdaptiveWorkStealingTasks.this.WrappedTask[R,Tp]]">split</a>
        <a href="#384250" title="AdaptiveWorkStealingTasks.this.WrappedTask[R,Tp]">head</a> = <a href="#384252" title="Seq[AdaptiveWorkStealingTasks.this.WrappedTask[R,Tp]]">subtasks</a>.<a href="../IterableLike.scala.html#59473" title="=&gt; AdaptiveWorkStealingTasks.this.WrappedTask[R,Tp]">head</a>
        <span class="keyword">for</span> <span class="delimiter">(</span><a title="AdaptiveWorkStealingTasks.this.WrappedTask[R,Tp]" id="384275">t</a> &lt;- <a href="#384252" title="Seq[AdaptiveWorkStealingTasks.this.WrappedTask[R,Tp]]">subtasks</a>.<a href="../TraversableLike.scala.html#59012" title="=&gt; Seq[AdaptiveWorkStealingTasks.this.WrappedTask[R,Tp]]">tail</a>.<a href="../IterableLike.scala.html#59458" title="(f: AdaptiveWorkStealingTasks.this.WrappedTask[R,Tp] =&gt; Unit)Unit">reverse</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="#384275" title="AdaptiveWorkStealingTasks.this.WrappedTask[R,Tp]">t</a>.<a href="#384226" title="(x$1: AdaptiveWorkStealingTasks.this.WrappedTask[R,Tp])Unit">next</a> = <a href="#384249" title="AdaptiveWorkStealingTasks.this.WrappedTask[R,Tp]">last</a>
          <a href="#384249" title="AdaptiveWorkStealingTasks.this.WrappedTask[R,Tp]">last</a> = <a href="#384275" title="AdaptiveWorkStealingTasks.this.WrappedTask[R,Tp]">t</a>
          <a href="#384275" title="AdaptiveWorkStealingTasks.this.WrappedTask[R,Tp]">t</a>.<a href="#384216" title="()Unit">start</a><span class="delimiter">(</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span> <span class="keyword">while</span> <span class="delimiter">(</span><a href="#384250" title="AdaptiveWorkStealingTasks.this.WrappedTask[R,Tp]">head</a>.<a href="#384213" title="=&gt; scala.collection.parallel.Task[R,Tp]">body</a>.<a href="#247858" title="=&gt; Boolean">shouldSplitFurther</a><span class="delimiter">)</span>;
      <a href="#384250" title="AdaptiveWorkStealingTasks.this.WrappedTask[R,Tp]">head</a>.<a href="#384226" title="(x$1: AdaptiveWorkStealingTasks.this.WrappedTask[R,Tp])Unit">next</a> = <a href="#384249" title="AdaptiveWorkStealingTasks.this.WrappedTask[R,Tp]">last</a>
      <a href="#384250" title="AdaptiveWorkStealingTasks.this.WrappedTask[R,Tp]">head</a>
    <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="()Unit" id="384235">printChain</a><span class="delimiter">(</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
      <span class="keyword">var</span> <a title="AdaptiveWorkStealingTasks.this.WrappedTask[R,Tp]" id="384293">curr</a> = <a href="#382745" title="AdaptiveWorkStealingTasks.this.WrappedTask[R,Tp]" class="keyword">this</a>
      <span class="keyword">var</span> <a title="String" id="384294">chain</a> = <span title="String(&quot;chain: &quot;)" class="string">&quot;chain: &quot;</span>
      <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><a href="#384293" title="AdaptiveWorkStealingTasks.this.WrappedTask[R,Tp]">curr</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <a href="#384295" title="()Unit" class="delimiter">{</a>
        <a href="#384294" title="String">chain</a> <span title="(x$1: Any)String">+=</span> <a href="../../Predef.scala.html#8576" title="implicit scala.Predef.any2stringadd : (x: Any)scala.runtime.StringAdd">curr</a> <a href="../../runtime/StringAdd.scala.html#60949" title="(other: String)String">+</a> <span title="String(&quot; ---&gt; &quot;)" class="string">&quot; ---&gt; &quot;</span>
        <a href="#384293" title="AdaptiveWorkStealingTasks.this.WrappedTask[R,Tp]">curr</a> = <a href="#384293" title="AdaptiveWorkStealingTasks.this.WrappedTask[R,Tp]">curr</a>.<a href="#384226" title="=&gt; AdaptiveWorkStealingTasks.this.WrappedTask[R,Tp]">next</a>
      <span class="delimiter">}</span>
      <a href="../../Predef.scala.html#8489" title="(x: Any)Unit">println</a><span class="delimiter">(</span><a href="#384294" title="String">chain</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  // specialize ctor
  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="[R, Tp](b: scala.collection.parallel.Task[R,Tp])AdaptiveWorkStealingTasks.this.WrappedTask[R,Tp]" id="382748">newWrappedTask</a><span class="delimiter">[</span><a title="" id="382751">R</a>, <a title="" id="382752">Tp</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="scala.collection.parallel.Task[R,Tp]" id="384307">b</a>: <a href="#14357" title="scala.collection.parallel.Task[R,Tp]">Task</a><span class="delimiter">[</span>R, Tp<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#382745" title="AdaptiveWorkStealingTasks.this.WrappedTask[R,Tp]">WrappedTask</a><span class="delimiter">[</span>R, Tp<span class="delimiter">]</span>

<span class="delimiter">}</span>


/** An implementation of tasks objects based on the Java thread pooling API. */
<span class="keyword">trait</span> <a title="trait ThreadPoolTasks extends Object with scala.collection.parallel.Tasks" id="14492">ThreadPoolTasks</a> <a href="../../Unit.scala.html#2389" title="Unit" class="keyword">extends</a> <a href="#14657" title="scala.collection.parallel.Tasks">Tasks</a> <span class="delimiter">{</span>
  <span class="keyword">import</span> java.util.concurrent._

  <span class="keyword">trait</span> <a title="trait WrappedTask[R, +Tp] extends Object with Runnable with ThreadPoolTasks.this.WrappedTask[R,Tp]" id="383287">WrappedTask</a><span class="delimiter">[</span><a title="" id="383288">R</a>, +<a title="" id="383289">Tp</a><span class="delimiter">]</span> <a href="../../Unit.scala.html#2389" title="Unit" class="keyword">extends</a> <span title="Runnable">Runnable</span> <span class="keyword">with</span> <span class="keyword">super</span>.<a href="#248026" title="ThreadPoolTasks.this.WrappedTask[R,Tp]">WrappedTask</a><span class="delimiter">[</span>R, Tp<span class="delimiter">]</span> <span class="delimiter">{</span>
    // initially, this is null
    // once the task is started, this future is set and used for `sync`
    // utb: var future: Future[_] = null
    @volatile <span class="keyword">var</span> <a title="Boolean" id="384316">owned</a> = <span title="Boolean(false)" class="keyword">false</span>
    @volatile <span class="keyword">var</span> <a title="Boolean" id="384319">completed</a> = <span title="Boolean(false)" class="keyword">false</span>

    <span class="keyword">def</span> <a title="()Unit" id="384321">start</a><span class="delimiter">(</span><span class="delimiter">)</span> = <a href="#383287" title="(x$1: java.util.concurrent.Future[?0])java.util.concurrent.Future[?0]">synchronized</a> <span title="Unit" class="delimiter">{</span>
      // debuglog(&quot;Starting &quot; + body)
      // utb: future = executor.submit(this)
      <a href="#383296" title="=&gt; java.util.concurrent.ThreadPoolExecutor">executor</a>.<span title="(x$1: java.util.concurrent.Future[?0])java.util.concurrent.Future[?0]">synchronized</span> <span class="delimiter">{</span>
        <a href="#383301" title="()Unit">incrTasks</a><span class="delimiter">(</span><span class="delimiter">)</span>
        <a href="#383296" title="=&gt; java.util.concurrent.ThreadPoolExecutor">executor</a>.<span title="(x$1: Runnable)java.util.concurrent.Future[_]">submit</span><span class="delimiter">(</span><a href="#383287" title="ThreadPoolTasks.this.WrappedTask[R,Tp]" class="keyword">this</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
    <span class="keyword">def</span> <a title="()Unit" id="384322">sync</a><span class="delimiter">(</span><span class="delimiter">)</span> = <a href="#383287" title="(x$1: Unit)Unit">synchronized</a> <span class="delimiter">{</span>
      // debuglog(&quot;Syncing on &quot; + body)
      // utb: future.get()
      <a href="#383296" title="=&gt; java.util.concurrent.ThreadPoolExecutor">executor</a>.<span title="(x$1: Unit)Unit">synchronized</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="Int" id="384388">coresize</a> = <a href="#383296" title="=&gt; java.util.concurrent.ThreadPoolExecutor">executor</a>.<span title="()Int">getCorePoolSize</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#384388" title="Int">coresize</a> <a href="../../Int.scala.html#57905" title="(x: Int)Boolean">&lt;</a> <a href="#383299" title="=&gt; Int">totaltasks</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="#383296" title="=&gt; java.util.concurrent.ThreadPoolExecutor">executor</a>.<span title="(x$1: Int)Unit">setCorePoolSize</span><span class="delimiter">(</span><a href="#384388" title="Int">coresize</a> <a href="../../Int.scala.html#57948" title="(x: Int)Int">+</a> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
          //assert(executor.getCorePoolSize == (coresize + 1))
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>
      <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><a href="../../Boolean.scala.html#58721" title="=&gt; Boolean">!</a><a href="#384319" title="=&gt; Boolean">completed</a><span class="delimiter">)</span> <a href="#383287" title="WrappedTask.this.type" class="keyword">this</a>.<a href="#384398" title="()Unit">wait</a>
    <span class="delimiter">}</span>
    <span class="keyword">def</span> <a title="()Boolean" id="384323">tryCancel</a><span class="delimiter">(</span><span class="delimiter">)</span> = <a href="#383287" title="(x$1: Boolean)Boolean">synchronized</a> <span class="delimiter">{</span>
      // utb: future.cancel(false)
      <span title="Boolean" class="keyword">if</span> <span class="delimiter">(</span><a href="../../Boolean.scala.html#58721" title="=&gt; Boolean">!</a><a href="#384316" title="=&gt; Boolean">owned</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        // debuglog(&quot;Cancelling &quot; + body)
        <a href="#384316" title="(x$1: Boolean)Unit">owned</a> = <span title="Boolean(true)" class="keyword">true</span>
        <span title="Boolean(true)" class="keyword">true</span>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span title="Boolean(false)" class="keyword">false</span>
    <span class="delimiter">}</span>
    <span class="keyword">def</span> <a title="()Unit" id="384324">run</a><span class="delimiter">(</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
      // utb: compute
      <span class="keyword">var</span> <a title="Boolean" id="384412">isOkToRun</a> = <span title="Boolean(false)" class="keyword">false</span>
      <a href="#383287" title="(x$1: Unit)Unit">synchronized</a> <span class="delimiter">{</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../Boolean.scala.html#58721" title="=&gt; Boolean">!</a><a href="#384316" title="=&gt; Boolean">owned</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="#384316" title="(x$1: Boolean)Unit">owned</a> = <span title="Boolean(true)" class="keyword">true</span>
          <a href="#384412" title="Boolean">isOkToRun</a> = <span title="Boolean(true)" class="keyword">true</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#384412" title="Boolean">isOkToRun</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        // debuglog(&quot;Running body of &quot; + body)
        <a href="#384215" title="()Unit">compute</a><span class="delimiter">(</span><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span title="Unit" class="delimiter">{</span>
        // just skip
        // debuglog(&quot;skipping body of &quot; + body)
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="()Unit" id="384325">release</a><span class="delimiter">(</span><span class="delimiter">)</span> = <a href="#383287" title="(x$1: Unit)Unit">synchronized</a> <span class="delimiter">{</span>
      //println(&quot;releasing: &quot; + this + &quot;, body: &quot; + this.body)
      <a href="#384319" title="(x$1: Boolean)Unit">completed</a> = <span title="Boolean(true)" class="keyword">true</span>
      <a href="#383296" title="=&gt; java.util.concurrent.ThreadPoolExecutor">executor</a>.<span title="(x$1: Unit)Unit">synchronized</span> <span class="delimiter">{</span>
        <a href="#383302" title="()Unit">decrTasks</a><span class="delimiter">(</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
      <a href="#383287" title="WrappedTask.this.type" class="keyword">this</a>.<span title="()Unit">notifyAll</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="[R, Tp](b: scala.collection.parallel.Task[R,Tp])ThreadPoolTasks.this.WrappedTask[R,Tp]" id="383290">newWrappedTask</a><span class="delimiter">[</span><a title="" id="383293">R</a>, <a title="" id="383294">Tp</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="scala.collection.parallel.Task[R,Tp]" id="384435">b</a>: <a href="#14357" title="scala.collection.parallel.Task[R,Tp]">Task</a><span class="delimiter">[</span>R, Tp<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#383287" title="ThreadPoolTasks.this.WrappedTask[R,Tp]">WrappedTask</a><span class="delimiter">[</span>R, Tp<span class="delimiter">]</span>

  <span class="keyword">val</span> <a title="=&gt; java.util.concurrent.ThreadPoolExecutor" id="383295">environment</a>: <span title="java.util.concurrent.ThreadPoolExecutor">ThreadPoolExecutor</span>
  <span class="keyword">def</span> <a title="=&gt; java.util.concurrent.ThreadPoolExecutor" id="383296">executor</a> = <a href="#383295" title="=&gt; java.util.concurrent.ThreadPoolExecutor">environment</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="java.util.concurrent.ThreadPoolExecutor" class="delimiter">[</span><span title="java.util.concurrent.ThreadPoolExecutor">ThreadPoolExecutor</span><span class="delimiter">]</span>
  <span class="keyword">def</span> <a title="=&gt; java.util.concurrent.LinkedBlockingQueue[Runnable]" id="383297">queue</a> = <a href="#383296" title="=&gt; java.util.concurrent.ThreadPoolExecutor">executor</a>.<span title="()java.util.concurrent.BlockingQueue[Runnable]">getQueue</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="java.util.concurrent.LinkedBlockingQueue[Runnable]" class="delimiter">[</span><span title="java.util.concurrent.LinkedBlockingQueue[Runnable]">LinkedBlockingQueue</span><span class="delimiter">[</span>Runnable<span class="delimiter">]</span><span class="delimiter">]</span>
  @volatile <span class="keyword">var</span> <a title="Int" id="383299">totaltasks</a> = <span title="Int(0)" class="int">0</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="()Unit" id="383301">incrTasks</a><span class="delimiter">(</span><span class="delimiter">)</span> = <a href="#14492" title="(x$1: Unit)Unit">synchronized</a> <span class="delimiter">{</span>
    <a href="#383299" title="(x$1: Int)Unit">totaltasks</a> <a href="../../Int.scala.html#57948" title="(x: Int)Int">+=</a> <span title="Int(1)" class="int">1</span>
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="()Unit" id="383302">decrTasks</a><span class="delimiter">(</span><span class="delimiter">)</span> = <a href="#14492" title="(x$1: Unit)Unit">synchronized</a> <span class="delimiter">{</span>
    <a href="#383299" title="(x$1: Int)Unit">totaltasks</a> <a href="../../Int.scala.html#57955" title="(x: Int)Int">-=</a> <span title="Int(1)" class="int">1</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="[R, Tp](task: scala.collection.parallel.Task[R,Tp])() =&gt; R" id="383303">execute</a><span class="delimiter">[</span><a title="" id="383306">R</a>, <a title="" id="383307">Tp</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="scala.collection.parallel.Task[R,Tp]" id="384441">task</a>: <a href="#14357" title="scala.collection.parallel.Task[R,Tp]">Task</a><span class="delimiter">[</span>R, Tp<span class="delimiter">]</span><span class="delimiter">)</span>: <span class="delimiter">(</span><span class="delimiter">)</span> =&gt; R = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="ThreadPoolTasks.this.WrappedTask[R,Tp]" id="384446">t</a> = <a href="#383290" title="(b: scala.collection.parallel.Task[R,Tp])ThreadPoolTasks.this.WrappedTask[R,Tp]">newWrappedTask</a><span class="delimiter">(</span><a href="#384441" title="scala.collection.parallel.Task[R,Tp]">task</a><span class="delimiter">)</span>

    // debuglog(&quot;-----------&gt; Executing without wait: &quot; + task)
    <a href="#384446" title="ThreadPoolTasks.this.WrappedTask[R,Tp]">t</a>.<a href="#384321" title="()Unit">start</a><span class="delimiter">(</span><span class="delimiter">)</span>

    <span class="delimiter">(</span><span class="delimiter">)</span> =&gt; <span class="delimiter">{</span>
      <a href="#384446" title="ThreadPoolTasks.this.WrappedTask[R,Tp]">t</a>.<a href="#384322" title="()Unit">sync</a><span class="delimiter">(</span><span class="delimiter">)</span>
      <a href="#384446" title="ThreadPoolTasks.this.WrappedTask[R,Tp]">t</a>.<a href="#384213" title="=&gt; scala.collection.parallel.Task[R,Tp]">body</a>.<a href="#247864" title="()Unit">forwardThrowable</a>
      <a href="#384446" title="ThreadPoolTasks.this.WrappedTask[R,Tp]">t</a>.<a href="#384213" title="=&gt; scala.collection.parallel.Task[R,Tp]">body</a>.<a href="#247857" title="=&gt; R">result</a>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="[R, Tp](task: scala.collection.parallel.Task[R,Tp])R" id="383308">executeAndWaitResult</a><span class="delimiter">[</span><a title="" id="383311">R</a>, <a title="" id="383312">Tp</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="scala.collection.parallel.Task[R,Tp]" id="384452">task</a>: <a href="#14357" title="scala.collection.parallel.Task[R,Tp]">Task</a><span class="delimiter">[</span>R, Tp<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#383311" title="R">R</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="ThreadPoolTasks.this.WrappedTask[R,Tp]" id="384457">t</a> = <a href="#383290" title="(b: scala.collection.parallel.Task[R,Tp])ThreadPoolTasks.this.WrappedTask[R,Tp]">newWrappedTask</a><span class="delimiter">(</span><a href="#384452" title="scala.collection.parallel.Task[R,Tp]">task</a><span class="delimiter">)</span>

    // debuglog(&quot;-----------&gt; Executing with wait: &quot; + task)
    <a href="#384457" title="ThreadPoolTasks.this.WrappedTask[R,Tp]">t</a>.<a href="#384321" title="()Unit">start</a><span class="delimiter">(</span><span class="delimiter">)</span>

    <a href="#384457" title="ThreadPoolTasks.this.WrappedTask[R,Tp]">t</a>.<a href="#384322" title="()Unit">sync</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <a href="#384457" title="ThreadPoolTasks.this.WrappedTask[R,Tp]">t</a>.<a href="#384213" title="=&gt; scala.collection.parallel.Task[R,Tp]">body</a>.<a href="#247864" title="()Unit">forwardThrowable</a>
    <a href="#384457" title="ThreadPoolTasks.this.WrappedTask[R,Tp]">t</a>.<a href="#384213" title="=&gt; scala.collection.parallel.Task[R,Tp]">body</a>.<a href="#247857" title="=&gt; R">result</a>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="=&gt; Int" id="383313">parallelismLevel</a> = <a href="#14493" title="scala.collection.parallel.ThreadPoolTasks.type">ThreadPoolTasks</a>.<a href="#383458" title="=&gt; Int">numCores</a>

<span class="delimiter">}</span>

<span class="keyword">object</span> <a title="scala.collection.parallel.ThreadPoolTasks.type" id="14493">ThreadPoolTasks</a> <a href="#14494" title="scala.collection.parallel.ThreadPoolTasks.type" class="delimiter">{</a>
  <span class="keyword">import</span> java.util.concurrent._

  <span class="keyword">val</span> <a title="Int" id="383458">numCores</a> = <span title="Runtime.type">Runtime</span>.<span title="()Runtime">getRuntime</span>.<span title="()Int">availableProcessors</span>

  <span class="keyword">val</span> <a title="java.util.concurrent.atomic.AtomicLong" id="383460">tcount</a> = <span title="java.util.concurrent.atomic.AtomicLong" class="keyword">new</span> atomic.<span title="java.util.concurrent.atomic.AtomicLong">AtomicLong</span><span class="delimiter">(</span><span title="Long(0L)" class="long">0L</span><span class="delimiter">)</span>

  <span class="keyword">val</span> <a title="java.util.concurrent.ThreadPoolExecutor" id="383462">defaultThreadPool</a> = <span title="(x$1: Int, x$2: Int, x$3: Long, x$4: java.util.concurrent.TimeUnit, x$5: java.util.concurrent.BlockingQueue[Runnable], x$6: java.util.concurrent.ThreadFactory, x$7: java.util.concurrent.RejectedExecutionHandler)java.util.concurrent.ThreadPoolExecutor" class="keyword">new</span> <span title="java.util.concurrent.ThreadPoolExecutor">ThreadPoolExecutor</span><span class="delimiter">(</span>
    <a href="#383458" title="=&gt; Int">numCores</a>,
    Int.<span title="Int(2147483647)">MaxValue</span>,
    <span title="Long(60L)" class="long">60L</span>, TimeUnit.<span title="java.util.concurrent.TimeUnit(value MILLISECONDS)">MILLISECONDS</span>,
    <span title="java.util.concurrent.LinkedBlockingQueue[Runnable]" class="keyword">new</span> <span title="java.util.concurrent.LinkedBlockingQueue[Runnable]">LinkedBlockingQueue</span><span class="delimiter">[</span>Runnable<span class="delimiter">]</span>,
    <a href="#383937" title="java.util.concurrent.ThreadFactory" class="keyword">new</a> <a title="anonymous class $anon extends Object with java.util.concurrent.ThreadFactory" id="383937">ThreadFactory</a> <span class="delimiter">{</span>
      <span class="keyword">def</span> <a title="(r: Runnable)Thread" id="383939">newThread</a><span class="delimiter">(</span><a title="Runnable" id="383942">r</a>: <span title="Runnable">Runnable</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="Thread" id="383945">t</a> = <span title="(x$1: Runnable)Thread" class="keyword">new</span> <span title="Thread">Thread</span><span class="delimiter">(</span><a href="#383942" title="Runnable">r</a><span class="delimiter">)</span>
        <a href="#383945" title="Thread">t</a>.<span title="(x$1: String)Unit">setName</span><span class="delimiter">(</span><span title="String(&quot;pc-thread-&quot;)" class="string">&quot;pc-thread-&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#383460" title="=&gt; java.util.concurrent.atomic.AtomicLong">tcount</a>.<span title="()Long">incrementAndGet</span><span class="delimiter">)</span>
        <a href="#383945" title="Thread">t</a>.<span title="(x$1: Boolean)Unit">setDaemon</span><span class="delimiter">(</span><span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span>
        <a href="#383945" title="Thread">t</a>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>,
    <span title="java.util.concurrent.ThreadPoolExecutor.CallerRunsPolicy" class="keyword">new</span> <span title="java.util.concurrent.ThreadPoolExecutor.type">ThreadPoolExecutor</span>.<span title="java.util.concurrent.ThreadPoolExecutor.CallerRunsPolicy">CallerRunsPolicy</span>
  <span class="delimiter">)</span>
<span class="delimiter">}</span>


/** An implementation of tasks objects based on the Java thread pooling API and synchronization using futures. */
@deprecated<span class="delimiter">(</span><span class="string">&quot;This implementation is not used.&quot;</span>, <span class="string">&quot;2.10.0&quot;</span><span class="delimiter">)</span>
<span class="keyword">trait</span> <a title="trait FutureThreadPoolTasks extends Object with scala.collection.parallel.Tasks" id="14444">FutureThreadPoolTasks</a> <a href="../../Unit.scala.html#2389" title="Unit" class="keyword">extends</a> <a href="#14657" title="scala.collection.parallel.Tasks">Tasks</a> <span class="delimiter">{</span>
  <span class="keyword">import</span> java.util.concurrent._

  <span class="keyword">trait</span> <a title="trait WrappedTask[R, +Tp] extends Object with Runnable with FutureThreadPoolTasks.this.WrappedTask[R,Tp]" id="384468">WrappedTask</a><span class="delimiter">[</span><a title="" id="384469">R</a>, +<a title="" id="384470">Tp</a><span class="delimiter">]</span> <a href="../../Unit.scala.html#2389" title="Unit" class="keyword">extends</a> <span title="Runnable">Runnable</span> <span class="keyword">with</span> <span class="keyword">super</span>.<a href="#248026" title="FutureThreadPoolTasks.this.WrappedTask[R,Tp]">WrappedTask</a><span class="delimiter">[</span>R, Tp<span class="delimiter">]</span> <span class="delimiter">{</span>
    @volatile <span class="keyword">var</span> <a title="java.util.concurrent.Future[_]" id="384495">future</a>: <span title="java.util.concurrent.Future[_]">Future</span><span class="delimiter">[</span>_<span class="delimiter">]</span> = <span title="Null(null)" class="keyword">null</span>

    <span class="keyword">def</span> <a title="()Unit" id="384497">start</a><span class="delimiter">(</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
      <a href="#384478" title="=&gt; java.util.concurrent.ThreadPoolExecutor">executor</a>.<span title="(x$1: Unit)Unit">synchronized</span> <span class="delimiter">{</span>
        <a href="#384495" title="(x$1: java.util.concurrent.Future[_])Unit">future</a> = <a href="#384478" title="=&gt; java.util.concurrent.ThreadPoolExecutor">executor</a>.<span title="(x$1: Runnable)java.util.concurrent.Future[_]">submit</span><span class="delimiter">(</span><a href="#384468" title="FutureThreadPoolTasks.this.WrappedTask[R,Tp]" class="keyword">this</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
    <span class="keyword">def</span> <a title="()Unit" id="384498">sync</a><span class="delimiter">(</span><span class="delimiter">)</span> = <a href="#384495" title="=&gt; java.util.concurrent.Future[_]">future</a>.<span title="()_$3">get</span>
    <span class="keyword">def</span> <a title="()Boolean" id="384499">tryCancel</a> = <span title="Boolean(false)" class="keyword">false</span>
    <span class="keyword">def</span> <a title="()Unit" id="384500">run</a> = <span class="delimiter">{</span>
      <a href="#384215" title="()Unit">compute</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="[R, Tp](b: scala.collection.parallel.Task[R,Tp])FutureThreadPoolTasks.this.WrappedTask[R,Tp]" id="384471">newWrappedTask</a><span class="delimiter">[</span><a title="" id="384474">R</a>, <a title="" id="384475">Tp</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="scala.collection.parallel.Task[R,Tp]" id="384557">b</a>: <a href="#14357" title="scala.collection.parallel.Task[R,Tp]">Task</a><span class="delimiter">[</span>R, Tp<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#384468" title="FutureThreadPoolTasks.this.WrappedTask[R,Tp]">WrappedTask</a><span class="delimiter">[</span>R, Tp<span class="delimiter">]</span>

  <span class="keyword">val</span> <a title="AnyRef" id="384476">environment</a>: <span title="AnyRef">AnyRef</span> = <a href="#14445" title="scala.collection.parallel.FutureThreadPoolTasks.type">FutureThreadPoolTasks</a>.<a href="#384566" title="=&gt; java.util.concurrent.ExecutorService">defaultThreadPool</a>
  <span class="keyword">def</span> <a title="=&gt; java.util.concurrent.ThreadPoolExecutor" id="384478">executor</a> = <a href="#384476" title="=&gt; AnyRef">environment</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="java.util.concurrent.ThreadPoolExecutor" class="delimiter">[</span><span title="java.util.concurrent.ThreadPoolExecutor">ThreadPoolExecutor</span><span class="delimiter">]</span>

  <span class="keyword">def</span> <a title="[R, Tp](task: scala.collection.parallel.Task[R,Tp])() =&gt; R" id="384479">execute</a><span class="delimiter">[</span><a title="" id="384482">R</a>, <a title="" id="384483">Tp</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="scala.collection.parallel.Task[R,Tp]" id="384652">task</a>: <a href="#14357" title="scala.collection.parallel.Task[R,Tp]">Task</a><span class="delimiter">[</span>R, Tp<span class="delimiter">]</span><span class="delimiter">)</span>: <span class="delimiter">(</span><span class="delimiter">)</span> =&gt; R = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="FutureThreadPoolTasks.this.WrappedTask[R,Tp]" id="384657">t</a> = <a href="#384471" title="(b: scala.collection.parallel.Task[R,Tp])FutureThreadPoolTasks.this.WrappedTask[R,Tp]">newWrappedTask</a><span class="delimiter">(</span><a href="#384652" title="scala.collection.parallel.Task[R,Tp]">task</a><span class="delimiter">)</span>

    // debuglog(&quot;-----------&gt; Executing without wait: &quot; + task)
    <a href="#384657" title="FutureThreadPoolTasks.this.WrappedTask[R,Tp]">t</a>.<a href="#384497" title="()Unit">start</a>

    <span class="delimiter">(</span><span class="delimiter">)</span> =&gt; <span class="delimiter">{</span>
      <a href="#384657" title="FutureThreadPoolTasks.this.WrappedTask[R,Tp]">t</a>.<a href="#384498" title="()Unit">sync</a>
      <a href="#384657" title="FutureThreadPoolTasks.this.WrappedTask[R,Tp]">t</a>.<a href="#384213" title="=&gt; scala.collection.parallel.Task[R,Tp]">body</a>.<a href="#247864" title="()Unit">forwardThrowable</a>
      <a href="#384657" title="FutureThreadPoolTasks.this.WrappedTask[R,Tp]">t</a>.<a href="#384213" title="=&gt; scala.collection.parallel.Task[R,Tp]">body</a>.<a href="#247857" title="=&gt; R">result</a>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="[R, Tp](task: scala.collection.parallel.Task[R,Tp])R" id="384484">executeAndWaitResult</a><span class="delimiter">[</span><a title="" id="384487">R</a>, <a title="" id="384488">Tp</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="scala.collection.parallel.Task[R,Tp]" id="384663">task</a>: <a href="#14357" title="scala.collection.parallel.Task[R,Tp]">Task</a><span class="delimiter">[</span>R, Tp<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#384487" title="R">R</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="FutureThreadPoolTasks.this.WrappedTask[R,Tp]" id="384668">t</a> = <a href="#384471" title="(b: scala.collection.parallel.Task[R,Tp])FutureThreadPoolTasks.this.WrappedTask[R,Tp]">newWrappedTask</a><span class="delimiter">(</span><a href="#384663" title="scala.collection.parallel.Task[R,Tp]">task</a><span class="delimiter">)</span>

    // debuglog(&quot;-----------&gt; Executing with wait: &quot; + task)
    <a href="#384668" title="FutureThreadPoolTasks.this.WrappedTask[R,Tp]">t</a>.<a href="#384497" title="()Unit">start</a>

    <a href="#384668" title="FutureThreadPoolTasks.this.WrappedTask[R,Tp]">t</a>.<a href="#384498" title="()Unit">sync</a>
    <a href="#384668" title="FutureThreadPoolTasks.this.WrappedTask[R,Tp]">t</a>.<a href="#384213" title="=&gt; scala.collection.parallel.Task[R,Tp]">body</a>.<a href="#247864" title="()Unit">forwardThrowable</a>
    <a href="#384668" title="FutureThreadPoolTasks.this.WrappedTask[R,Tp]">t</a>.<a href="#384213" title="=&gt; scala.collection.parallel.Task[R,Tp]">body</a>.<a href="#247857" title="=&gt; R">result</a>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="=&gt; Int" id="384489">parallelismLevel</a> = <a href="#14445" title="scala.collection.parallel.FutureThreadPoolTasks.type">FutureThreadPoolTasks</a>.<a href="#384562" title="=&gt; Int">numCores</a>

<span class="delimiter">}</span>

<span class="keyword">object</span> <a title="scala.collection.parallel.FutureThreadPoolTasks.type" id="14445">FutureThreadPoolTasks</a> <a href="#14446" title="scala.collection.parallel.FutureThreadPoolTasks.type" class="delimiter">{</a>
  <span class="keyword">import</span> java.util.concurrent._

  <span class="keyword">val</span> <a title="Int" id="384562">numCores</a> = <span title="Runtime.type">Runtime</span>.<span title="()Runtime">getRuntime</span>.<span title="()Int">availableProcessors</span>

  <span class="keyword">val</span> <a title="java.util.concurrent.atomic.AtomicLong" id="384564">tcount</a> = <span title="java.util.concurrent.atomic.AtomicLong" class="keyword">new</span> atomic.<span title="java.util.concurrent.atomic.AtomicLong">AtomicLong</span><span class="delimiter">(</span><span title="Long(0L)" class="long">0L</span><span class="delimiter">)</span>

  <span class="keyword">val</span> <a title="java.util.concurrent.ExecutorService" id="384566">defaultThreadPool</a> = <span title="java.util.concurrent.Executors.type">Executors</span>.<span title="()java.util.concurrent.ExecutorService">newCachedThreadPool</span><span class="delimiter">(</span><span class="delimiter">)</span>
<span class="delimiter">}</span>



/**
 * A trait describing objects that provide a fork/join pool.
 */
<span title="Object" class="keyword">trait</span> <a title="trait HavingForkJoinPool extends Object" id="14345">HavingForkJoinPool</a> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="=&gt; scala.concurrent.forkjoin.ForkJoinPool" id="382743">forkJoinPool</a>: <span title="scala.concurrent.forkjoin.ForkJoinPool">ForkJoinPool</span>
<span class="delimiter">}</span>


/** An implementation trait for parallel tasks based on the fork/join framework.
 *
 *  @define fjdispatch
 *  If the current thread is a fork/join worker thread, the task's `fork` method will
 *  be invoked. Otherwise, the task will be executed on the fork/join pool.
 */
<span title="Object" class="keyword">trait</span> <a title="trait ForkJoinTasks extends Object with scala.collection.parallel.Tasks with scala.collection.parallel.HavingForkJoinPool" id="15407">ForkJoinTasks</a> <a href="../../Unit.scala.html#2389" title="Unit" class="keyword">extends</a> <a href="#14657" title="scala.collection.parallel.Tasks">Tasks</a> <span class="keyword">with</span> <a href="#14345" title="scala.collection.parallel.HavingForkJoinPool">HavingForkJoinPool</a> <span class="delimiter">{</span>

  <span class="keyword">trait</span> <a title="trait WrappedTask[R, +Tp] extends scala.concurrent.forkjoin.RecursiveAction with ForkJoinTasks.this.WrappedTask[R,Tp]" id="382713">WrappedTask</a><span class="delimiter">[</span><a title="" id="382714">R</a>, +<a title="" id="382715">Tp</a><span class="delimiter">]</span> <a href="../../Unit.scala.html#2389" title="Unit" class="keyword">extends</a> <span title="scala.concurrent.forkjoin.RecursiveAction">RecursiveAction</span> <span class="keyword">with</span> <span class="keyword">super</span>.<a href="#248026" title="ForkJoinTasks.this.WrappedTask[R,Tp]">WrappedTask</a><span class="delimiter">[</span>R, Tp<span class="delimiter">]</span> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="()Unit" id="384693">start</a><span class="delimiter">(</span><span class="delimiter">)</span> = <a href="#382713" title="()scala.concurrent.forkjoin.ForkJoinTask[Void]">fork</a>
    <span class="keyword">def</span> <a title="()Unit" id="384694">sync</a><span class="delimiter">(</span><span class="delimiter">)</span> = <a href="#382713" title="()Void">join</a>
    <span class="keyword">def</span> <a title="()Boolean" id="384695">tryCancel</a> = <a href="#382713" title="()Boolean">tryUnfork</a>
  <span class="delimiter">}</span>

  // specialize ctor
  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="[R, Tp](b: scala.collection.parallel.Task[R,Tp])ForkJoinTasks.this.WrappedTask[R,Tp]" id="382716">newWrappedTask</a><span class="delimiter">[</span><a title="" id="382719">R</a>, <a title="" id="382720">Tp</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="scala.collection.parallel.Task[R,Tp]" id="384833">b</a>: <a href="#14357" title="scala.collection.parallel.Task[R,Tp]">Task</a><span class="delimiter">[</span>R, Tp<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#382713" title="ForkJoinTasks.this.WrappedTask[R,Tp]">WrappedTask</a><span class="delimiter">[</span>R, Tp<span class="delimiter">]</span>

  /** The fork/join pool of this collection.
   */
  <span class="keyword">def</span> <a title="=&gt; scala.concurrent.forkjoin.ForkJoinPool" id="382721">forkJoinPool</a>: <span title="scala.concurrent.forkjoin.ForkJoinPool">ForkJoinPool</span> = <a href="#382722" title="=&gt; scala.concurrent.forkjoin.ForkJoinPool">environment</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="scala.concurrent.forkjoin.ForkJoinPool" class="delimiter">[</span><span title="scala.concurrent.forkjoin.ForkJoinPool">ForkJoinPool</span><span class="delimiter">]</span>
  <span class="keyword">val</span> <a title="=&gt; scala.concurrent.forkjoin.ForkJoinPool" id="382722">environment</a>: <span title="scala.concurrent.forkjoin.ForkJoinPool">ForkJoinPool</span>

  /** Executes a task and does not wait for it to finish - instead returns a future.
   *
   *  $fjdispatch
   */
  <span class="keyword">def</span> <a title="[R, Tp](task: scala.collection.parallel.Task[R,Tp])() =&gt; R" id="382723">execute</a><span class="delimiter">[</span><a title="" id="382726">R</a>, <a title="" id="382727">Tp</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="scala.collection.parallel.Task[R,Tp]" id="384838">task</a>: <a href="#14357" title="scala.collection.parallel.Task[R,Tp]">Task</a><span class="delimiter">[</span>R, Tp<span class="delimiter">]</span><span class="delimiter">)</span>: <span class="delimiter">(</span><span class="delimiter">)</span> =&gt; R = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="ForkJoinTasks.this.WrappedTask[R,Tp]" id="384843">fjtask</a> = <a href="#382716" title="(b: scala.collection.parallel.Task[R,Tp])ForkJoinTasks.this.WrappedTask[R,Tp]">newWrappedTask</a><span class="delimiter">(</span><a href="#384838" title="scala.collection.parallel.Task[R,Tp]">task</a><span class="delimiter">)</span>

    <span title="Any" class="keyword">if</span> <span class="delimiter">(</span><span title="Thread.type">Thread</span>.<span title="()Thread">currentThread</span>.<span title="[T0]=&gt; Boolean">isInstanceOf</span><span title="Boolean" class="delimiter">[</span><span title="scala.concurrent.forkjoin.ForkJoinWorkerThread">ForkJoinWorkerThread</span><span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#384843" title="ForkJoinTasks.this.WrappedTask[R,Tp]">fjtask</a>.<span title="()scala.concurrent.forkjoin.ForkJoinTask[Void]">fork</span>
    <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
      <a href="#382721" title="=&gt; scala.concurrent.forkjoin.ForkJoinPool">forkJoinPool</a>.<span title="(x$1: scala.concurrent.forkjoin.ForkJoinTask[_])Unit">execute</span><span class="delimiter">(</span><a href="#384843" title="ForkJoinTasks.this.WrappedTask[R,Tp]">fjtask</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="delimiter">(</span><span class="delimiter">)</span> =&gt; <span class="delimiter">{</span>
      <a href="#384843" title="ForkJoinTasks.this.WrappedTask[R,Tp]">fjtask</a>.<a href="#384694" title="()Unit">sync</a>
      <a href="#384843" title="ForkJoinTasks.this.WrappedTask[R,Tp]">fjtask</a>.<a href="#384213" title="=&gt; scala.collection.parallel.Task[R,Tp]">body</a>.<a href="#247864" title="()Unit">forwardThrowable</a>
      <a href="#384843" title="ForkJoinTasks.this.WrappedTask[R,Tp]">fjtask</a>.<a href="#384213" title="=&gt; scala.collection.parallel.Task[R,Tp]">body</a>.<a href="#247857" title="=&gt; R">result</a>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  /** Executes a task on a fork/join pool and waits for it to finish.
   *  Returns its result when it does.
   *
   *  $fjdispatch
   *
   *  @return    the result of the task
   */
  <span class="keyword">def</span> <a title="[R, Tp](task: scala.collection.parallel.Task[R,Tp])R" id="382728">executeAndWaitResult</a><span class="delimiter">[</span><a title="" id="382731">R</a>, <a title="" id="382732">Tp</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="scala.collection.parallel.Task[R,Tp]" id="384873">task</a>: <a href="#14357" title="scala.collection.parallel.Task[R,Tp]">Task</a><span class="delimiter">[</span>R, Tp<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#382731" title="R">R</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="ForkJoinTasks.this.WrappedTask[R,Tp]" id="384878">fjtask</a> = <a href="#382716" title="(b: scala.collection.parallel.Task[R,Tp])ForkJoinTasks.this.WrappedTask[R,Tp]">newWrappedTask</a><span class="delimiter">(</span><a href="#384873" title="scala.collection.parallel.Task[R,Tp]">task</a><span class="delimiter">)</span>

    <span title="Any" class="keyword">if</span> <span class="delimiter">(</span><span title="Thread.type">Thread</span>.<span title="()Thread">currentThread</span>.<span title="[T0]=&gt; Boolean">isInstanceOf</span><span title="Boolean" class="delimiter">[</span><span title="scala.concurrent.forkjoin.ForkJoinWorkerThread">ForkJoinWorkerThread</span><span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#384878" title="ForkJoinTasks.this.WrappedTask[R,Tp]">fjtask</a>.<span title="()scala.concurrent.forkjoin.ForkJoinTask[Void]">fork</span>
    <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
      <a href="#382721" title="=&gt; scala.concurrent.forkjoin.ForkJoinPool">forkJoinPool</a>.<span title="(x$1: scala.concurrent.forkjoin.ForkJoinTask[_])Unit">execute</span><span class="delimiter">(</span><a href="#384878" title="ForkJoinTasks.this.WrappedTask[R,Tp]">fjtask</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <a href="#384878" title="ForkJoinTasks.this.WrappedTask[R,Tp]">fjtask</a>.<a href="#384694" title="()Unit">sync</a>
    // if (fjtask.body.throwable != null) println(&quot;throwing: &quot; + fjtask.body.throwable + &quot; at &quot; + fjtask.body)
    <a href="#384878" title="ForkJoinTasks.this.WrappedTask[R,Tp]">fjtask</a>.<a href="#384213" title="=&gt; scala.collection.parallel.Task[R,Tp]">body</a>.<a href="#247864" title="()Unit">forwardThrowable</a>
    <a href="#384878" title="ForkJoinTasks.this.WrappedTask[R,Tp]">fjtask</a>.<a href="#384213" title="=&gt; scala.collection.parallel.Task[R,Tp]">body</a>.<a href="#247857" title="=&gt; R">result</a>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="=&gt; Int" id="382733">parallelismLevel</a> = <a href="#382721" title="=&gt; scala.concurrent.forkjoin.ForkJoinPool">forkJoinPool</a>.<span title="()Int">getParallelism</span>

<span class="delimiter">}</span>


<span class="keyword">object</span> <a title="scala.collection.parallel.ForkJoinTasks.type" id="15408">ForkJoinTasks</a> <a href="#15409" title="scala.collection.parallel.ForkJoinTasks.type" class="delimiter">{</a>
  <span class="keyword">val</span> <a title="scala.concurrent.forkjoin.ForkJoinPool" id="383277">defaultForkJoinPool</a>: <span title="scala.concurrent.forkjoin.ForkJoinPool">ForkJoinPool</span> = <span title="scala.concurrent.forkjoin.ForkJoinPool" class="keyword">new</span> <span title="scala.concurrent.forkjoin.ForkJoinPool">ForkJoinPool</span><span class="delimiter">(</span><span class="delimiter">)</span> // scala.parallel.forkjoinpool
  // defaultForkJoinPool.setParallelism(Runtime.getRuntime.availableProcessors)
  // defaultForkJoinPool.setMaximumPoolSize(Runtime.getRuntime.availableProcessors)
<span class="delimiter">}</span>


/* Some boilerplate due to no deep mixin composition. Not sure if it can be done differently without them.
 */
<span title="Object" class="keyword">trait</span> <a title="trait AdaptiveWorkStealingForkJoinTasks extends Object with scala.collection.parallel.ForkJoinTasks with scala.collection.parallel.AdaptiveWorkStealingTasks" id="15386">AdaptiveWorkStealingForkJoinTasks</a> <a href="../../Unit.scala.html#2389" title="Unit" class="keyword">extends</a> <a href="#15407" title="scala.collection.parallel.ForkJoinTasks">ForkJoinTasks</a> <span class="keyword">with</span> <a href="#15383" title="scala.collection.parallel.AdaptiveWorkStealingTasks">AdaptiveWorkStealingTasks</a> <span class="delimiter">{</span>

  <span class="keyword">class</span> <a title="class WrappedTask[R, Tp] extends scala.concurrent.forkjoin.RecursiveAction with AdaptiveWorkStealingForkJoinTasks.this.WrappedTask[R,Tp] with AdaptiveWorkStealingForkJoinTasks.this.WrappedTask[R,Tp]" id="382735">WrappedTask</a><span class="delimiter">[</span><a title="" id="382736">R</a>, <a title="" id="382737">Tp</a><span class="delimiter">]</span><a href="#382735" title="AdaptiveWorkStealingForkJoinTasks.this.WrappedTask[R,Tp]" class="delimiter">(</a><span class="keyword">val</span> <a title="scala.collection.parallel.Task[R,Tp]" id="384917">body</a>: <a href="#14357" title="scala.collection.parallel.Task[R,Tp]">Task</a><span class="delimiter">[</span>R, Tp<span class="delimiter">]</span><span class="delimiter">)</span>
  <span class="keyword">extends</span> <span class="keyword">super</span><span class="delimiter">[</span>ForkJoinTasks<span class="delimiter">]</span>.<a href="#382713" title="AdaptiveWorkStealingForkJoinTasks.this.WrappedTask[R,Tp]">WrappedTask</a><span class="delimiter">[</span>R, Tp<span class="delimiter">]</span> <span class="keyword">with</span> <span class="keyword">super</span><span class="delimiter">[</span>AdaptiveWorkStealingTasks<span class="delimiter">]</span>.<a href="#382745" title="AdaptiveWorkStealingForkJoinTasks.this.WrappedTask[R,Tp]">WrappedTask</a><span class="delimiter">[</span>R, Tp<span class="delimiter">]</span> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="=&gt; Seq[AdaptiveWorkStealingForkJoinTasks.this.WrappedTask[R,Tp]]" id="384914">split</a> = <a href="#384917" title="=&gt; scala.collection.parallel.Task[R,Tp]">body</a>.<a href="#247859" title="=&gt; Seq[scala.collection.parallel.Task[R,Tp]]">split</a>.<a href="../TraversableLike.scala.html#58971" title="(f: scala.collection.parallel.Task[R,Tp] =&gt; AdaptiveWorkStealingForkJoinTasks.this.WrappedTask[R,Tp])(implicit bf: scala.collection.generic.CanBuildFrom[Seq[scala.collection.parallel.Task[R,Tp]],AdaptiveWorkStealingForkJoinTasks.this.WrappedTask[R,Tp],Seq[AdaptiveWorkStealingForkJoinTasks.this.WrappedTask[R,Tp]]])Seq[AdaptiveWorkStealingForkJoinTasks.this.WrappedTask[R,Tp]]">map</a><a href="../Seq.scala.html#70316" title="scala.collection.generic.CanBuildFrom[scala.collection.Seq.Coll,AdaptiveWorkStealingForkJoinTasks.this.WrappedTask[R,Tp],Seq[AdaptiveWorkStealingForkJoinTasks.this.WrappedTask[R,Tp]]]" class="delimiter">(</a><a title="scala.collection.parallel.Task[R,Tp]" id="384942">b</a> =&gt; <a href="#382738" title="(b: scala.collection.parallel.Task[R,Tp])AdaptiveWorkStealingForkJoinTasks.this.WrappedTask[R,Tp]">newWrappedTask</a><span class="delimiter">(</span><a href="#384942" title="scala.collection.parallel.Task[R,Tp]">b</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="[R, Tp](b: scala.collection.parallel.Task[R,Tp])AdaptiveWorkStealingForkJoinTasks.this.WrappedTask[R,Tp]" id="382738">newWrappedTask</a><span class="delimiter">[</span><a title="" id="382741">R</a>, <a title="" id="382742">Tp</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="scala.collection.parallel.Task[R,Tp]" id="384943">b</a>: <a href="#14357" title="scala.collection.parallel.Task[R,Tp]">Task</a><span class="delimiter">[</span>R, Tp<span class="delimiter">]</span><span class="delimiter">)</span> = <span title="AdaptiveWorkStealingForkJoinTasks.this.WrappedTask[R,Tp]" class="keyword">new</span> <a href="#382735" title="AdaptiveWorkStealingForkJoinTasks.this.WrappedTask[R,Tp]">WrappedTask</a><span class="delimiter">[</span>R, Tp<span class="delimiter">]</span><span class="delimiter">(</span><a href="#384943" title="scala.collection.parallel.Task[R,Tp]">b</a><span class="delimiter">)</span>

<span class="delimiter">}</span>


<span class="keyword">trait</span> <a title="trait AdaptiveWorkStealingThreadPoolTasks extends Object with scala.collection.parallel.ThreadPoolTasks with scala.collection.parallel.AdaptiveWorkStealingTasks" id="14774">AdaptiveWorkStealingThreadPoolTasks</a> <a href="../../Unit.scala.html#2389" title="Unit" class="keyword">extends</a> <a href="#14492" title="scala.collection.parallel.ThreadPoolTasks">ThreadPoolTasks</a> <span class="keyword">with</span> <a href="#15383" title="scala.collection.parallel.AdaptiveWorkStealingTasks">AdaptiveWorkStealingTasks</a> <span class="delimiter">{</span>

  <span class="keyword">class</span> <a title="class WrappedTask[R, Tp] extends Object with AdaptiveWorkStealingThreadPoolTasks.this.WrappedTask[R,Tp] with AdaptiveWorkStealingThreadPoolTasks.this.WrappedTask[R,Tp]" id="383315">WrappedTask</a><span class="delimiter">[</span><a title="" id="383316">R</a>, <a title="" id="383317">Tp</a><span class="delimiter">]</span><a href="#383315" title="AdaptiveWorkStealingThreadPoolTasks.this.WrappedTask[R,Tp]" class="delimiter">(</a><span class="keyword">val</span> <a title="scala.collection.parallel.Task[R,Tp]" id="384992">body</a>: <a href="#14357" title="scala.collection.parallel.Task[R,Tp]">Task</a><span class="delimiter">[</span>R, Tp<span class="delimiter">]</span><span class="delimiter">)</span>
  <span class="keyword">extends</span> <span class="keyword">super</span><span class="delimiter">[</span>ThreadPoolTasks<span class="delimiter">]</span>.<a href="#383287" title="AdaptiveWorkStealingThreadPoolTasks.this.WrappedTask[R,Tp]">WrappedTask</a><span class="delimiter">[</span>R, Tp<span class="delimiter">]</span> <span class="keyword">with</span> <span class="keyword">super</span><span class="delimiter">[</span>AdaptiveWorkStealingTasks<span class="delimiter">]</span>.<a href="#382745" title="AdaptiveWorkStealingThreadPoolTasks.this.WrappedTask[R,Tp]">WrappedTask</a><span class="delimiter">[</span>R, Tp<span class="delimiter">]</span> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="=&gt; Seq[AdaptiveWorkStealingThreadPoolTasks.this.WrappedTask[R,Tp]]" id="384989">split</a> = <a href="#384992" title="=&gt; scala.collection.parallel.Task[R,Tp]">body</a>.<a href="#247859" title="=&gt; Seq[scala.collection.parallel.Task[R,Tp]]">split</a>.<a href="../TraversableLike.scala.html#58971" title="(f: scala.collection.parallel.Task[R,Tp] =&gt; AdaptiveWorkStealingThreadPoolTasks.this.WrappedTask[R,Tp])(implicit bf: scala.collection.generic.CanBuildFrom[Seq[scala.collection.parallel.Task[R,Tp]],AdaptiveWorkStealingThreadPoolTasks.this.WrappedTask[R,Tp],Seq[AdaptiveWorkStealingThreadPoolTasks.this.WrappedTask[R,Tp]]])Seq[AdaptiveWorkStealingThreadPoolTasks.this.WrappedTask[R,Tp]]">map</a><a href="../Seq.scala.html#70316" title="scala.collection.generic.CanBuildFrom[scala.collection.Seq.Coll,AdaptiveWorkStealingThreadPoolTasks.this.WrappedTask[R,Tp],Seq[AdaptiveWorkStealingThreadPoolTasks.this.WrappedTask[R,Tp]]]" class="delimiter">(</a><a title="scala.collection.parallel.Task[R,Tp]" id="385017">b</a> =&gt; <a href="#383318" title="(b: scala.collection.parallel.Task[R,Tp])AdaptiveWorkStealingThreadPoolTasks.this.WrappedTask[R,Tp]">newWrappedTask</a><span class="delimiter">(</span><a href="#385017" title="scala.collection.parallel.Task[R,Tp]">b</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="[R, Tp](b: scala.collection.parallel.Task[R,Tp])AdaptiveWorkStealingThreadPoolTasks.this.WrappedTask[R,Tp]" id="383318">newWrappedTask</a><span class="delimiter">[</span><a title="" id="383321">R</a>, <a title="" id="383322">Tp</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="scala.collection.parallel.Task[R,Tp]" id="385018">b</a>: <a href="#14357" title="scala.collection.parallel.Task[R,Tp]">Task</a><span class="delimiter">[</span>R, Tp<span class="delimiter">]</span><span class="delimiter">)</span> = <span title="AdaptiveWorkStealingThreadPoolTasks.this.WrappedTask[R,Tp]" class="keyword">new</span> <a href="#383315" title="AdaptiveWorkStealingThreadPoolTasks.this.WrappedTask[R,Tp]">WrappedTask</a><span class="delimiter">[</span>R, Tp<span class="delimiter">]</span><span class="delimiter">(</span><a href="#385018" title="scala.collection.parallel.Task[R,Tp]">b</a><span class="delimiter">)</span>

<span class="delimiter">}</span>


<span class="keyword">trait</span> <a title="trait ExecutionContextTasks extends Object with scala.collection.parallel.Tasks" id="15008">ExecutionContextTasks</a> <a href="../../Unit.scala.html#2389" title="Unit" class="keyword">extends</a> <a href="#14657" title="scala.collection.parallel.Tasks">Tasks</a> <span class="delimiter">{</span>
  
  <span class="keyword">def</span> <a title="=&gt; scala.concurrent.ExecutionContext" id="384055">executionContext</a> = <a href="#384056" title="=&gt; scala.concurrent.ExecutionContext">environment</a>
  
  <span class="keyword">val</span> <a title="=&gt; scala.concurrent.ExecutionContext" id="384056">environment</a>: <a href="../../concurrent/ExecutionContext.scala.html#16554" title="scala.concurrent.ExecutionContext">ExecutionContext</a>
  
  // this part is a hack which allows switching
  <span class="keyword">val</span> <a title="scala.collection.parallel.Tasks" id="384057">driver</a>: <a href="#14657" title="scala.collection.parallel.Tasks">Tasks</a> = <a href="#384055" title="=&gt; scala.concurrent.ExecutionContext">executionContext</a> <span class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <a href="#385077" title="scala.collection.parallel.Tasks" id="385078">eci</a>: scala.concurrent.impl.ExecutionContextImpl =&gt; eci.<a href="#385079" title="(x: scala.collection.parallel.Tasks)scala.collection.parallel.Tasks">executorService</a> <span class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <a href="#385067" title="scala.collection.parallel.Tasks" id="385068">fjp</a>: ForkJoinPool =&gt; <a href="#385070" title="(x: scala.collection.parallel.Tasks)scala.collection.parallel.Tasks" class="keyword">new</a> <a href="TaskSupport.scala.html#14372" title="scala.collection.parallel.ForkJoinTaskSupport">ForkJoinTaskSupport</a><span class="delimiter">(</span>fjp<span class="delimiter">)</span>
      <span class="keyword">case</span> <a href="#385067" title="scala.collection.parallel.Tasks" id="385069">tpe</a>: ThreadPoolExecutor =&gt; <a href="#385070" title="(x: scala.collection.parallel.Tasks)scala.collection.parallel.Tasks" class="keyword">new</a> <a href="TaskSupport.scala.html#14279" title="scala.collection.parallel.ThreadPoolTaskSupport">ThreadPoolTaskSupport</a><span class="delimiter">(</span>tpe<span class="delimiter">)</span>
      <span class="keyword">case</span> _ =&gt; <a href="#385070" title="(x: scala.collection.parallel.Tasks)scala.collection.parallel.Tasks">???</a>
    <span class="delimiter">}</span>
    <span class="keyword">case</span> _ =&gt; <a href="#385079" title="(x: scala.collection.parallel.Tasks)scala.collection.parallel.Tasks">???</a>
  <span class="delimiter">}</span>
  
  <span class="keyword">def</span> <a title="[R, Tp](task: scala.collection.parallel.Task[R,Tp])() =&gt; R" id="384059">execute</a><span class="delimiter">[</span><a title="" id="384062">R</a>, <a title="" id="384063">Tp</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="scala.collection.parallel.Task[R,Tp]" id="385084">task</a>: <a href="#14357" title="scala.collection.parallel.Task[R,Tp]">Task</a><span class="delimiter">[</span>R, Tp<span class="delimiter">]</span><span class="delimiter">)</span>: <span class="delimiter">(</span><span class="delimiter">)</span> =&gt; R = <a href="#384057" title="=&gt; scala.collection.parallel.Tasks">driver</a> <a href="#248030" title="(fjtask: scala.collection.parallel.Task[R,Tp])() =&gt; R">execute</a> <a href="#385084" title="scala.collection.parallel.Task[R,Tp]">task</a>
  
  <span class="keyword">def</span> <a title="[R, Tp](task: scala.collection.parallel.Task[R,Tp])R" id="384064">executeAndWaitResult</a><span class="delimiter">[</span><a title="" id="384067">R</a>, <a title="" id="384068">Tp</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="scala.collection.parallel.Task[R,Tp]" id="385093">task</a>: <a href="#14357" title="scala.collection.parallel.Task[R,Tp]">Task</a><span class="delimiter">[</span>R, Tp<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#384067" title="R">R</a> = <a href="#384057" title="=&gt; scala.collection.parallel.Tasks">driver</a> <a href="#248035" title="(task: scala.collection.parallel.Task[R,Tp])R">executeAndWaitResult</a> <a href="#385093" title="scala.collection.parallel.Task[R,Tp]">task</a>
  
  <span class="keyword">def</span> <a title="=&gt; Int" id="384069">parallelismLevel</a> = <a href="#384057" title="=&gt; scala.collection.parallel.Tasks">driver</a>.<a href="#248040" title="=&gt; Int">parallelismLevel</a>
  
<span class="delimiter">}</span>












        </pre>
    </body>
</html>