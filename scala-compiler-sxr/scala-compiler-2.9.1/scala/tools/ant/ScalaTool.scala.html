<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>scala/tools/ant/ScalaTool.scala</title>
        <script type="text/javascript" src="../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/*                     __                                               *\
**     ________ ___   / /  ___     Scala Ant Tasks                      **
**    / __/ __// _ | / /  / _ |    (c) 2005-2011, LAMP/EPFL             **
**  __\ \/ /__/ __ |/ /__/ __ |    http://scala-lang.org/               **
** /____/\___/_/ |_/____/_/ | |                                         **
**                          |/                                          **
\*                                                                      */</span>


<span class="keyword">package</span> scala.tools.ant

<span class="keyword">import</span> java.io.<span class="delimiter">{</span>File, InputStream, FileWriter<span class="delimiter">}</span>
<span class="keyword">import</span> org.apache.tools.ant.BuildException
<span class="keyword">import</span> org.apache.tools.ant.types.<span class="delimiter">{</span>Path, Reference<span class="delimiter">}</span>

<span class="comment">/** &lt;p&gt;
 *    An Ant task that generates a shell or batch script to execute a
 *    Scala program.
 *    This task can take the following parameters as attributes:
 *  &lt;/p&gt;&lt;ul&gt;
 *  &lt;li&gt;file (mandatory),&lt;/li&gt;
 *  &lt;li&gt;class (mandatory),&lt;/li&gt;
 *  &lt;li&gt;platforms,&lt;/li&gt;
 *  &lt;li&gt;classpath,&lt;/li&gt;
 *  &lt;li&gt;properties,&lt;/li&gt;
 *  &lt;li&gt;javaflags,&lt;/li&gt;
 *  &lt;li&gt;toolflags.&lt;/li&gt;&lt;/ul&gt;
 *
 * @author  Gilles Dubochet
 * @version 1.1
 */</span>
<span class="keyword">class</span> <a title="class ScalaTool extends scala.tools.ant.ScalaMatchingTask with ScalaObject" id="9472">ScalaTool</a> <a href="#9472" title="ScalaObject" class="keyword">extends</a> <a href="ScalaMatchingTask.scala.html#9694" title="scala.tools.ant.ScalaMatchingTask">ScalaMatchingTask</a> <span class="delimiter">{</span>
  
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="=&gt; org.apache.tools.ant.types.Path" id="59392">emptyPath</a> = <span title="(x$1: org.apache.tools.ant.Project)org.apache.tools.ant.types.Path" class="keyword">new</span> <span title="org.apache.tools.ant.types.Path">Path</span><span class="delimiter">(</span><a href="#9472" title="()org.apache.tools.ant.Project">getProject</a><span class="delimiter">)</span>

<span class="comment">/*============================================================================*\
**                             Ant user-properties                            **
\*============================================================================*/</span>

  <span class="keyword">abstract</span> <span class="keyword">class</span> <a title="class PermissibleValue extends java.lang.Object with ScalaObject" id="59393">PermissibleValue</a> <a href="#59393" title="ScalaObject" class="delimiter">{</a>
    <span class="keyword">val</span> <a title="=&gt; List[String]" id="59523">values</a>: <span title="List[String]">List</span><span class="delimiter">[</span>String<span class="delimiter">]</span>
    <span class="keyword">def</span> <a title="(value: String)Boolean" id="59524">isPermissible</a><span class="delimiter">(</span><a title="String" id="59526">value</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> =
      <span class="delimiter">(</span><a href="#59526" title="String">value</a> <span title="(x$1: AnyRef)Boolean">==</span> <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span> <span title="(x: Boolean)Boolean">||</span> <a href="#59523" title="=&gt; List[String]">values</a>.<span title="(p: String =&gt; Boolean)Boolean">exists</span><span class="delimiter">(</span><a href="#59538" title="String">_</a>.<span title="(x$1: java.lang.String)Boolean">startsWith</span><span class="delimiter">(</span><a href="#59526" title="String">value</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/** Defines valid values for the platforms property. */</span>
  <span class="keyword">object</span> <a title="object ScalaTool.this.Platforms" id="59394">Platforms</a> <span title="ScalaObject" class="keyword">extends</span> <a href="#59393" title="ScalaTool.this.PermissibleValue">PermissibleValue</a> <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="List[java.lang.String]" id="59542">values</a> = <span title="(xs: java.lang.String*)List[java.lang.String]">List</span><span class="delimiter">(</span><span title="java.lang.String(&quot;unix&quot;)" class="string">&quot;unix&quot;</span>, <span title="java.lang.String(&quot;windows&quot;)" class="string">&quot;windows&quot;</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/** The path to the exec script file. &quot;.bat&quot; will be appended for the
    * Windows BAT file, if generated. */</span>
  <span class="keyword">private</span> <span class="keyword">var</span> <a title="Option[java.io.File]" id="59397">file</a>: <span title="Option[java.io.File]">Option</span><span class="delimiter">[</span>File<span class="delimiter">]</span> = <span title="object None">None</span>

  <span class="comment">/** The main class to run. */</span>
  <span class="keyword">private</span> <span class="keyword">var</span> <a title="Option[String]" id="59400">mainClass</a>: <span title="Option[String]">Option</span><span class="delimiter">[</span>String<span class="delimiter">]</span> = <span title="object None">None</span>

  <span class="comment">/** Supported platforms for the script. Either &quot;unix&quot; or &quot;windows&quot;.
    * Defaults to both. */</span>
  <span class="keyword">private</span> <span class="keyword">var</span> <a title="List[String]" id="59403">platforms</a>: <span title="List[String]">List</span><span class="delimiter">[</span>String<span class="delimiter">]</span> = <span title="(xs: java.lang.String*)List[java.lang.String]">List</span><span class="delimiter">(</span><span title="java.lang.String(&quot;unix&quot;)" class="string">&quot;unix&quot;</span>, <span title="java.lang.String(&quot;windows&quot;)" class="string">&quot;windows&quot;</span><span class="delimiter">)</span>

  <span class="comment">/** An (optional) path to all JARs that this script depend on. Paths must be
    * relative to the scala home directory. If not set, all JAR archives and
    * folders in &quot;lib/&quot; are automatically added. */</span>
  <span class="keyword">private</span> <span class="keyword">var</span> <a title="List[String]" id="59406">classpath</a>: <span title="List[String]">List</span><span class="delimiter">[</span>String<span class="delimiter">]</span> = <span title="object Nil">Nil</span>

  <span class="comment">/** An (optional) path to JARs that this script depends on relative to the
    * ant project's basedir. */</span>
  <span class="keyword">private</span> <span class="keyword">var</span> <a title="org.apache.tools.ant.types.Path" id="59409">classpathPath</a>: <span title="org.apache.tools.ant.types.Path">Path</span> = <a href="#59392" title="=&gt; org.apache.tools.ant.types.Path">emptyPath</a>

  <span class="comment">/** Comma-separated Java system properties to pass to the JRE. Properties
    * are formatted as name=value. Properties scala.home, scala.tool.name and
    * scala.tool.version are always set. */</span>
  <span class="keyword">private</span> <span class="keyword">var</span> <a title="List[(String, String)]" id="59412">properties</a>: <span title="List[(String, String)]">List</span><span class="delimiter">[</span><span class="delimiter">(</span>String, String<span class="delimiter">)</span><span class="delimiter">]</span> = <span title="object Nil">Nil</span>

  <span class="comment">/** Additional flags passed to the JRE (&quot;java [javaFlags] class&quot;). */</span>
  <span class="keyword">private</span> <span class="keyword">var</span> <a title="String" id="59415">javaFlags</a>: <span title="String">String</span> = <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span>

  <span class="comment">/** Additional flags passed to the tool (&quot;java class [toolFlags]&quot;). Can only
    * be set when a main class is defined. */</span>
  <span class="keyword">private</span> <span class="keyword">var</span> <a title="String" id="59418">toolFlags</a>: <span title="String">String</span> = <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span>

<span class="comment">/*============================================================================*\
**                             Properties setters                             **
\*============================================================================*/</span>

  <span class="comment">/** Sets the file attribute. */</span>
  <span class="keyword">def</span> <a title="(input: java.io.File)Unit" id="59420">setFile</a><span class="delimiter">(</span><a title="java.io.File" id="59559">input</a>: <span title="java.io.File">File</span><span class="delimiter">)</span> =
    <a href="#59397" title="(x$1: Option[java.io.File])Unit">file</a> = <span title="(x: java.io.File)Some[java.io.File]">Some</span><span class="delimiter">(</span><a href="#59559" title="java.io.File">input</a><span class="delimiter">)</span>

  <span class="comment">/** Sets the main class attribute. */</span>
  <span class="keyword">def</span> <a title="(input: String)Unit" id="59421">setClass</a><span class="delimiter">(</span><a title="String" id="59565">input</a>: <span title="String">String</span><span class="delimiter">)</span> =
    <a href="#59400" title="(x$1: Option[String])Unit">mainClass</a> = <span title="(x: String)Some[String]">Some</span><span class="delimiter">(</span><a href="#59565" title="String">input</a><span class="delimiter">)</span>

  <span class="comment">/** Sets the platforms attribute. */</span>
  <span class="keyword">def</span> <a title="(input: String)Unit" id="59422">setPlatforms</a><span class="delimiter">(</span><a title="String" id="59571">input</a>: <span title="String">String</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <a href="#59403" title="(x$1: List[String])Unit">platforms</a> = <a href="#59571" title="String">input</a>.<span title="(x$1: java.lang.String)Array[java.lang.String]">split</span><span title="(xs: Array[java.lang.String])scala.collection.mutable.ArrayOps[java.lang.String]" class="delimiter">(</span><span title="java.lang.String(&quot;,&quot;)" class="string">&quot;,&quot;</span><span class="delimiter">)</span>.<span title="=&gt; List[java.lang.String]">toList</span>.<span title="(f: java.lang.String =&gt; scala.collection.GenTraversableOnce[java.lang.String])(implicit bf: scala.collection.generic.CanBuildFrom[List[java.lang.String],java.lang.String,List[String]])List[String]">flatMap</span> <span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.List.Coll,java.lang.String,List[java.lang.String]]" class="delimiter">{</span> s: <span title="String">String</span> =&gt;
      <span class="keyword">val</span> <a title="java.lang.String" id="59700">st</a> = <a href="#59699" title="String">s</a>.<span title="()java.lang.String">trim</span>
      <span title="List[java.lang.String]" class="keyword">if</span> <span class="delimiter">(</span><a href="#59394" title="object ScalaTool.this.Platforms">Platforms</a>.<a href="#59524" title="(value: String)Boolean">isPermissible</a><span class="delimiter">(</span><a href="#59700" title="java.lang.String">st</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="delimiter">(</span><span title="List[java.lang.String]" class="keyword">if</span> <span class="delimiter">(</span><a href="#59571" title="String">input</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span> <span title="(xs: java.lang.String*)List[java.lang.String]">List</span><span class="delimiter">(</span><a href="#59700" title="java.lang.String">st</a><span class="delimiter">)</span> <span class="keyword">else</span> <span title="object Nil">Nil</span><span class="delimiter">)</span>
      <span class="keyword">else</span> <span class="delimiter">{</span>
        <a href="ScalaMatchingTask.scala.html#33961" title="(message: String)Nothing">buildError</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Platform &quot;)" class="string">&quot;Platform &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#59700" title="java.lang.String">st</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot; does not exist.&quot;)" class="string">&quot; does not exist.&quot;</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="comment">/** 
   * Sets the classpath with which to run the tool. 
   * Note that this mechanism of setting the classpath is generally preferred
   * for general purpose scripts, as this does not assume all elements are
   * relative to the ant basedir.  Additionally, the platform specific demarcation
   * of any script variables (e.g. ${SCALA_HOME} or %SCALA_HOME%) can be specified
   * in a platform independant way (e.g. @SCALA_HOME@) and automatically translated
   * for you.
   */</span>
  <span class="keyword">def</span> <a title="(input: String)Unit" id="59423">setClassPath</a><span class="delimiter">(</span><a title="String" id="59739">input</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    <a href="#59406" title="(x$1: List[String])Unit">classpath</a> = <a href="#59406" title="=&gt; List[String]">classpath</a> <a href="#59741" title="(prefix: List[java.lang.String])List[java.lang.String]">:::</a> <a href="#59739" title="String">input</a>.<span title="(x$1: java.lang.String)Array[java.lang.String]">split</span><span title="(xs: Array[java.lang.String])scala.collection.mutable.ArrayOps[java.lang.String]" class="delimiter">(</span><span title="java.lang.String(&quot;,&quot;)" class="string">&quot;,&quot;</span><span class="delimiter">)</span>.<span title="=&gt; List[java.lang.String]">toList</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * A special method that allows ant classpath path definitions to be nested
   * within this ant task.
   */</span>
  <span class="keyword">def</span> <a title="=&gt; org.apache.tools.ant.types.Path" id="59424">createClassPath</a>: <span title="org.apache.tools.ant.types.Path">Path</span> = <a href="#59409" title="=&gt; org.apache.tools.ant.types.Path">classpathPath</a>.<span title="()org.apache.tools.ant.types.Path">createPath</span><span class="delimiter">(</span><span class="delimiter">)</span>

  <span class="comment">/** 
   * Adds an Ant Path reference to the tool's classpath.  
   * Note that all entries in the path must exist either relative to the project
   * basedir or with an absolute path to a file in the filesystem.  As a result,
   * this is not a mechanism for setting the classpath for more general use scripts,
   * such as those distributed within sbaz distribution packages.
   */</span>
  <span class="keyword">def</span> <a title="(input: org.apache.tools.ant.types.Reference)Unit" id="59425">setClassPathRef</a><span class="delimiter">(</span><a title="org.apache.tools.ant.types.Reference" id="59860">input</a>: <span title="org.apache.tools.ant.types.Reference">Reference</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="org.apache.tools.ant.types.Path" id="59877">tmpPath</a> = <a href="#59392" title="=&gt; org.apache.tools.ant.types.Path">emptyPath</a>
    <a href="#59877" title="org.apache.tools.ant.types.Path">tmpPath</a>.<span title="(x$1: org.apache.tools.ant.types.Reference)Unit">setRefid</span><span class="delimiter">(</span><a href="#59860" title="org.apache.tools.ant.types.Reference">input</a><span class="delimiter">)</span>
    <a href="#59406" title="(x$1: List[String])Unit">classpath</a> = <a href="#59406" title="=&gt; List[String]">classpath</a> <a href="#59878" title="(prefix: List[java.lang.String])List[java.lang.String]">:::</a> <a href="#59877" title="org.apache.tools.ant.types.Path">tmpPath</a>.<span title="(xs: Array[java.lang.String])scala.collection.mutable.ArrayOps[java.lang.String]">list</span>.<span title="=&gt; List[java.lang.String]">toList</span>
  <span class="delimiter">}</span>

  <span class="comment">/** Sets JVM properties that will be set whilst running the tool. */</span>
  <span class="keyword">def</span> <a title="(input: String)Unit" id="59426">setProperties</a><span class="delimiter">(</span><a title="String" id="59990">input</a>: <span title="String">String</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <a href="#59412" title="(x$1: List[(String, String)])Unit">properties</a> = <a href="#59990" title="String">input</a>.<span title="(x$1: java.lang.String)Array[java.lang.String]">split</span><span title="(xs: Array[java.lang.String])scala.collection.mutable.ArrayOps[java.lang.String]" class="delimiter">(</span><span title="java.lang.String(&quot;,&quot;)" class="string">&quot;,&quot;</span><span class="delimiter">)</span>.<span title="=&gt; List[java.lang.String]">toList</span>.<span title="(f: java.lang.String =&gt; scala.collection.GenTraversableOnce[(java.lang.String, java.lang.String)])(implicit bf: scala.collection.generic.CanBuildFrom[List[java.lang.String],(java.lang.String, java.lang.String),List[(String, String)]])List[(String, String)]">flatMap</span> <span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.List.Coll,(java.lang.String, java.lang.String),List[(java.lang.String, java.lang.String)]]" class="delimiter">{</span> s: <span title="String">String</span> =&gt;
      <span class="keyword">val</span> <a title="java.lang.String" id="60129">st</a> = <a href="#60128" title="String">s</a>.<span title="()java.lang.String">trim</span>
      <span class="keyword">val</span> <a title="Array[java.lang.String]" id="60130">stArray</a> = <a href="#60129" title="java.lang.String">st</a>.<span title="(x$1: java.lang.String, x$2: Int)Array[java.lang.String]">split</span><span class="delimiter">(</span><span title="java.lang.String(&quot;=&quot;)" class="string">&quot;=&quot;</span>, <span title="Int(2)" class="int">2</span><span class="delimiter">)</span>
      <span title="List[(java.lang.String, java.lang.String)]" class="keyword">if</span> <span class="delimiter">(</span><a href="#60130" title="Array[java.lang.String]">stArray</a>.<span title="=&gt; Int">length</span> <span title="(x: Int)Boolean">==</span> <span title="Int(2)" class="int">2</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span title="List[(java.lang.String, java.lang.String)]" class="keyword">if</span> <span class="delimiter">(</span><a href="#59990" title="String">input</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span> <span title="(xs: (java.lang.String, java.lang.String)*)List[(java.lang.String, java.lang.String)]">List</span><span class="delimiter">(</span><span title="(x: java.lang.String, y: java.lang.String)(java.lang.String, java.lang.String)">Pair</span><span class="delimiter">(</span><a href="#60130" title="(i: Int)java.lang.String">stArray</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>, <a href="#60130" title="(i: Int)java.lang.String">stArray</a><span class="delimiter">(</span><span title="Int(1)" class="int">1</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="keyword">else</span> <span title="object Nil">Nil</span>
      <span class="delimiter">}</span>
      <span class="keyword">else</span>
        <a href="ScalaMatchingTask.scala.html#33961" title="(message: String)Nothing">buildError</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Property &quot;)" class="string">&quot;Property &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#60129" title="java.lang.String">st</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot; is not formatted properly.&quot;)" class="string">&quot; is not formatted properly.&quot;</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="comment">/** Sets flags to be passed to the Java interpreter. */</span>
  <span class="keyword">def</span> <a title="(input: String)Unit" id="59427">setJavaflags</a><span class="delimiter">(</span><a title="String" id="60187">input</a>: <span title="String">String</span><span class="delimiter">)</span> =
    <a href="#59415" title="(x$1: String)Unit">javaFlags</a> = <a href="#60187" title="String">input</a>.<span title="()java.lang.String">trim</span>

  <span class="comment">/** Sets flags to be passed to the tool. */</span>
  <span class="keyword">def</span> <a title="(input: String)Unit" id="59428">setToolflags</a><span class="delimiter">(</span><a title="String" id="60190">input</a>: <span title="String">String</span><span class="delimiter">)</span> =
    <a href="#59418" title="(x$1: String)Unit">toolFlags</a> = <a href="#60190" title="String">input</a>.<span title="()java.lang.String">trim</span>

<span class="comment">/*============================================================================*\
**                             Properties getters                             **
\*============================================================================*/</span>

    <span class="comment">/** Gets the value of the classpath attribute in a Scala-friendly form.
      * @return The class path as a list of files. */</span>
    <span class="keyword">private</span> <span class="keyword">def</span> <a title="=&gt; String" id="59429">getUnixclasspath</a>: <span title="String">String</span> =
      <a href="#59433" title="(text: String, pre: String, post: String)String">transposeVariableMarkup</a><span class="delimiter">(</span><a href="#59406" title="=&gt; List[String]">classpath</a>.<span title="(start: String, sep: String, end: String)String">mkString</span><span class="delimiter">(</span><span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span>, <span title="java.lang.String(&quot;:&quot;)" class="string">&quot;:&quot;</span>, <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span>.<span title="(x$1: Char, x$2: Char)java.lang.String">replace</span><span class="delimiter">(</span><span title="Char(\'\\\\\')" class="char">'\\'</span>, <span title="Char(\'/\')" class="char">'/'</span><span class="delimiter">)</span>, <span title="java.lang.String(&quot;${&quot;)" class="string">&quot;${&quot;</span>, <span title="java.lang.String(&quot;}&quot;)" class="string">&quot;}&quot;</span><span class="delimiter">)</span>

    <span class="comment">/** Gets the value of the classpath attribute in a Scala-friendly form.
      * @return The class path as a list of files. */</span>
    <span class="keyword">private</span> <span class="keyword">def</span> <a title="=&gt; String" id="59430">getWinclasspath</a>: <span title="String">String</span> =
      <a href="#59433" title="(text: String, pre: String, post: String)String">transposeVariableMarkup</a><span class="delimiter">(</span><a href="#59406" title="=&gt; List[String]">classpath</a>.<span title="(start: String, sep: String, end: String)String">mkString</span><span class="delimiter">(</span><span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span>, <span title="java.lang.String(&quot;;&quot;)" class="string">&quot;;&quot;</span>, <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span>.<span title="(x$1: Char, x$2: Char)java.lang.String">replace</span><span class="delimiter">(</span><span title="Char(\'/\')" class="char">'/'</span>, <span title="Char(\'\\\\\')" class="char">'\\'</span><span class="delimiter">)</span>, <span title="java.lang.String(&quot;%&quot;)" class="string">&quot;%&quot;</span>, <span title="java.lang.String(&quot;%&quot;)" class="string">&quot;%&quot;</span><span class="delimiter">)</span>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="=&gt; String" id="59431">getProperties</a>: <span title="String">String</span> =
      <a href="#59412" title="=&gt; List[(String, String)]">properties</a>.<span title="(f: (String, String) =&gt; java.lang.String)(implicit bf: scala.collection.generic.CanBuildFrom[List[(String, String)],java.lang.String,List[java.lang.String]])List[java.lang.String]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.List.Coll,java.lang.String,List[java.lang.String]]" class="delimiter">(</span><a href="#60246" title="java.lang.String" class="delimiter">{</a>
        <span class="keyword">case</span> <a href="#60247" title="java.lang.String">Pair</a><span class="delimiter">(</span><a title="String" id="60255">name</a>,<a title="String" id="60256">value</a><span class="delimiter">)</span> =&gt; <span title="java.lang.String(&quot;-D&quot;)" class="string">&quot;-D&quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#60255" title="String">name</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;=\&quot;&quot;)" class="string">&quot;=\&quot;&quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#60256" title="String">value</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;\&quot;&quot;)" class="string">&quot;\&quot;&quot;</span>
      <span class="delimiter">}</span><span class="delimiter">)</span>.<span title="(start: String, sep: String, end: String)String">mkString</span><span class="delimiter">(</span><span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span>, <span title="java.lang.String(&quot; &quot;)" class="string">&quot; &quot;</span>, <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span>

<span class="comment">/*============================================================================*\
**                       Compilation and support methods                      **
\*============================================================================*/</span>
  
    <span class="comment">// XXX encoding and generalize</span>
    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(clazz: Class[_], resource: String)Stream[Char]" id="59432">getResourceAsCharStream</a><span class="delimiter">(</span><a title="Class[_]" id="60287">clazz</a>: <span title="Class[_]">Class</span><span class="delimiter">[</span>_<span class="delimiter">]</span>, <a title="String" id="60288">resource</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="Stream[Char]">Stream</span><span class="delimiter">[</span>Char<span class="delimiter">]</span> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="java.io.InputStream" id="60567">stream</a> = <a href="#60287" title="Class[_]">clazz</a>.<span title="()java.lang.ClassLoader">getClassLoader</span><span class="delimiter">(</span><span class="delimiter">)</span> <span title="(x$1: java.lang.String)java.io.InputStream">getResourceAsStream</span> <a href="#60288" title="String">resource</a>
      <span title="Stream[Char]" class="keyword">if</span> <span class="delimiter">(</span><a href="#60567" title="java.io.InputStream">stream</a> <span title="(x$1: AnyRef)Boolean">==</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <span title="=&gt; collection.immutable.Stream.type">Stream</span>.<span title="scala.collection.immutable.Stream[Nothing]">empty</span>
      <span class="keyword">else</span> <span title="=&gt; collection.immutable.Stream.type">Stream</span> <span title="(elem: =&gt; Int)scala.collection.immutable.Stream[Int]">continually</span> <a href="#60567" title="java.io.InputStream">stream</a>.<span title="()Int">read</span><span class="delimiter">(</span><span class="delimiter">)</span> <span title="(p: Int =&gt; Boolean)scala.collection.immutable.Stream[Int]">takeWhile</span> <span class="delimiter">(</span><a href="#61391" title="Int">_</a> <span title="(x: Int)Boolean">!=</span> -<span title="Int(-1)" class="int">1</span><span class="delimiter">)</span> <span title="(f: Int =&gt; Char)(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.Stream[Int],Char,Stream[Char]])Stream[Char]">map</span> <span class="delimiter">(</span><a href="#61421" title="Int">_</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="Char" class="delimiter">[</span><span title="Char">Char</span><span class="delimiter">]</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="comment">// Converts a variable like @SCALA_HOME@ to ${SCALA_HOME} when pre = &quot;${&quot; and post = &quot;}&quot;</span>
    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(text: String, pre: String, post: String)String" id="59433">transposeVariableMarkup</a><span class="delimiter">(</span><a title="String" id="60195">text</a>: <span title="String">String</span>, <a title="String" id="60196">pre</a>: <span title="String">String</span>, <a title="String" id="60197">post</a>: <span title="String">String</span><span class="delimiter">)</span> : <span title="String">String</span> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="scala.io.Source" id="61475">chars</a> = scala.io.<span title="object scala.io.Source">Source</span>.<span title="(s: String)scala.io.Source">fromString</span><span class="delimiter">(</span><a href="#60195" title="String">text</a><span class="delimiter">)</span>
      <span class="keyword">val</span> <a title="StringBuilder" id="61476">builder</a> = <span title="()StringBuilder" class="keyword">new</span> <span title="StringBuilder">StringBuilder</span><span class="delimiter">(</span><span class="delimiter">)</span>
      
      <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><a href="#61475" title="scala.io.Source">chars</a>.<span title="=&gt; Boolean">hasNext</span><span class="delimiter">)</span> <a href="#61477" title="()Unit" class="delimiter">{</a>
        <span class="keyword">val</span> <a title="Char" id="62467">char</a> = <a href="#61475" title="scala.io.Source">chars</a>.<span title="()Char">next</span>
        <span title="StringBuilder" class="keyword">if</span> <span class="delimiter">(</span><a href="#62467" title="Char">char</a> <span title="(x: Char)Boolean">==</span> <span title="Char(\'@\')" class="char">'@'</span><span class="delimiter">)</span> <span class="delimiter">{</span>
          <span class="keyword">var</span> <a title="Char" id="62472">char</a> = <a href="#61475" title="scala.io.Source">chars</a>.<span title="()Char">next</span>
          <span class="keyword">val</span> <a title="StringBuilder" id="62473">token</a> = <span title="()StringBuilder" class="keyword">new</span> <span title="StringBuilder">StringBuilder</span><span class="delimiter">(</span><span class="delimiter">)</span>
          <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><a href="#61475" title="scala.io.Source">chars</a>.<span title="=&gt; Boolean">hasNext</span> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#62472" title="Char">char</a> <span title="(x: Char)Boolean">!=</span> <span title="Char(\'@\')" class="char">'@'</span><span class="delimiter">)</span> <a href="#62474" title="()Unit" class="delimiter">{</a>
            <a href="#62473" title="StringBuilder">token</a>.<span title="(x: Char)StringBuilder">append</span><span class="delimiter">(</span><a href="#62472" title="Char">char</a><span class="delimiter">)</span>
            <a href="#62472" title="Char">char</a> = <a href="#61475" title="scala.io.Source">chars</a>.<span title="()Char">next</span>
          <span class="delimiter">}</span>
          <span title="StringBuilder" class="keyword">if</span> <span class="delimiter">(</span><a href="#62473" title="StringBuilder">token</a>.<span title="()java.lang.String">toString</span> <span title="(x$1: AnyRef)Boolean">==</span> <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span>
            <a href="#61476" title="StringBuilder">builder</a>.<span title="(x: Char)StringBuilder">append</span><span class="delimiter">(</span><span title="Char(\'@\')" class="char">'@'</span><span class="delimiter">)</span>
          <span class="keyword">else</span>
            <a href="#61476" title="StringBuilder">builder</a>.<span title="(s: String)StringBuilder">append</span><span class="delimiter">(</span><a href="#60196" title="String">pre</a> <span title="(x$1: Any)java.lang.String">+</span> <a href="#62473" title="StringBuilder">token</a>.<span title="()java.lang.String">toString</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#60197" title="String">post</a><span class="delimiter">)</span>
        <span class="delimiter">}</span> <span class="keyword">else</span> <a href="#61476" title="StringBuilder">builder</a>.<span title="(x: Char)StringBuilder">append</span><span class="delimiter">(</span><a href="#62467" title="Char">char</a><span class="delimiter">)</span>          
      <span class="delimiter">}</span>
      <a href="#61476" title="StringBuilder">builder</a>.<span title="()java.lang.String">toString</span>
    <span class="delimiter">}</span>
    
    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(resource: String, tokens: Map[String,String])String" id="59434">readAndPatchResource</a><span class="delimiter">(</span><a title="String" id="62525">resource</a>: <span title="String">String</span>, <a title="Map[String,String]" id="62526">tokens</a>: <span title="Map[String,String]">Map</span><span class="delimiter">[</span>String, String<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="String">String</span> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="Iterator[Char]" id="62735">chars</a> = <a href="#59432" title="(clazz: Class[_], resource: String)Stream[Char]">getResourceAsCharStream</a><span class="delimiter">(</span><a href="#9472" title="ScalaTool.this.type" class="keyword">this</a>.<span title="()java.lang.Class[_]">getClass</span>, <a href="#62525" title="String">resource</a><span class="delimiter">)</span>.<span title="=&gt; Iterator[Char]">iterator</span>
      <span class="keyword">val</span> <a title="StringBuilder" id="62736">builder</a> = <span title="()StringBuilder" class="keyword">new</span> <span title="StringBuilder">StringBuilder</span><span class="delimiter">(</span><span class="delimiter">)</span>
      
      <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><a href="#62735" title="Iterator[Char]">chars</a>.<span title="=&gt; Boolean">hasNext</span><span class="delimiter">)</span> <a href="#62737" title="()Unit" class="delimiter">{</a>
        <span class="keyword">val</span> <a title="Char" id="62769">char</a> = <a href="#62735" title="Iterator[Char]">chars</a>.<span title="()Char">next</span>
        <span title="StringBuilder" class="keyword">if</span> <span class="delimiter">(</span><a href="#62769" title="Char">char</a> <span title="(x: Char)Boolean">==</span> <span title="Char(\'@\')" class="char">'@'</span><span class="delimiter">)</span> <span class="delimiter">{</span>
          <span class="keyword">var</span> <a title="Char" id="62774">char</a> = <a href="#62735" title="Iterator[Char]">chars</a>.<span title="()Char">next</span>
          <span class="keyword">val</span> <a title="StringBuilder" id="62775">token</a> = <span title="()StringBuilder" class="keyword">new</span> <span title="StringBuilder">StringBuilder</span><span class="delimiter">(</span><span class="delimiter">)</span>
          <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><a href="#62735" title="Iterator[Char]">chars</a>.<span title="=&gt; Boolean">hasNext</span> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#62774" title="Char">char</a> <span title="(x: Char)Boolean">!=</span> <span title="Char(\'@\')" class="char">'@'</span><span class="delimiter">)</span> <a href="#62776" title="()Unit" class="delimiter">{</a>
            <a href="#62775" title="StringBuilder">token</a>.<span title="(x: Char)StringBuilder">append</span><span class="delimiter">(</span><a href="#62774" title="Char">char</a><span class="delimiter">)</span>
            <a href="#62774" title="Char">char</a> = <a href="#62735" title="Iterator[Char]">chars</a>.<span title="()Char">next</span>
          <span class="delimiter">}</span>
          <span title="StringBuilder" class="keyword">if</span> <span class="delimiter">(</span><a href="#62526" title="Map[String,String]">tokens</a>.<span title="(key: String)Boolean">contains</span><span class="delimiter">(</span><a href="#62775" title="StringBuilder">token</a>.<span title="()java.lang.String">toString</span><span class="delimiter">)</span><span class="delimiter">)</span>
            <a href="#62736" title="StringBuilder">builder</a>.<span title="(s: String)StringBuilder">append</span><span class="delimiter">(</span><a href="#62526" title="(key: String)String">tokens</a><span class="delimiter">(</span><a href="#62775" title="StringBuilder">token</a>.<span title="()java.lang.String">toString</span><span class="delimiter">)</span><span class="delimiter">)</span>
          <span class="keyword">else</span> <span title="StringBuilder" class="keyword">if</span> <span class="delimiter">(</span><a href="#62775" title="StringBuilder">token</a>.<span title="()java.lang.String">toString</span> <span title="(x$1: AnyRef)Boolean">==</span> <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span>
            <a href="#62736" title="StringBuilder">builder</a>.<span title="(x: Char)StringBuilder">append</span><span class="delimiter">(</span><span title="Char(\'@\')" class="char">'@'</span><span class="delimiter">)</span>
          <span class="keyword">else</span>
            <a href="#62736" title="StringBuilder">builder</a>.<span title="(s: String)StringBuilder">append</span><span class="delimiter">(</span><span title="java.lang.String(&quot;@&quot;)" class="string">&quot;@&quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#62775" title="StringBuilder">token</a>.<span title="()java.lang.String">toString</span> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;@&quot;)" class="string">&quot;@&quot;</span><span class="delimiter">)</span>
        <span class="delimiter">}</span> <span class="keyword">else</span> <a href="#62736" title="StringBuilder">builder</a>.<span title="(x: Char)StringBuilder">append</span><span class="delimiter">(</span><a href="#62769" title="Char">char</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
      <a href="#62736" title="StringBuilder">builder</a>.<span title="()java.lang.String">toString</span>
    <span class="delimiter">}</span>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(file: java.io.File, content: String)Unit" id="59435">writeFile</a><span class="delimiter">(</span><a title="java.io.File" id="62944">file</a>: <span title="java.io.File">File</span>, <a title="String" id="62945">content</a>: <span title="String">String</span><span class="delimiter">)</span> =
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#62944" title="java.io.File">file</a>.<span title="()Boolean">exists</span><span class="delimiter">(</span><span class="delimiter">)</span> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <span title="=&gt; Boolean">!</span><a href="#62944" title="java.io.File">file</a>.<span title="()Boolean">canWrite</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
        <a href="ScalaMatchingTask.scala.html#33961" title="(message: String)Nothing">buildError</a><span class="delimiter">(</span><span title="java.lang.String(&quot;File &quot;)" class="string">&quot;File &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#62944" title="java.io.File">file</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot; is not writable&quot;)" class="string">&quot; is not writable&quot;</span><span class="delimiter">)</span>
      <span class="keyword">else</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="java.io.FileWriter" id="62948">writer</a> = <span title="(x$1: java.io.File, x$2: Boolean)java.io.FileWriter" class="keyword">new</span> <span title="java.io.FileWriter">FileWriter</span><span class="delimiter">(</span><a href="#62944" title="java.io.File">file</a>, <span title="Boolean(false)" class="keyword">false</span><span class="delimiter">)</span>
        <a href="#62948" title="java.io.FileWriter">writer</a>.<span title="(x$1: java.lang.String)Unit">write</span><span class="delimiter">(</span><a href="#62945" title="String">content</a><span class="delimiter">)</span>
        <a href="#62948" title="java.io.FileWriter">writer</a>.<span title="()Unit">close</span><span class="delimiter">(</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>

<span class="comment">/*============================================================================*\
**                           The big execute method                           **
\*============================================================================*/</span>

  <span class="comment">/** Performs the tool creation. */</span>
  <span class="keyword">override</span> <span class="keyword">def</span> <a title="()Unit" id="59436">execute</a><span class="delimiter">(</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span class="comment">// Tests if all mandatory attributes are set and valid.</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#59397" title="=&gt; Option[java.io.File]">file</a>.<span title="=&gt; Boolean">isEmpty</span><span class="delimiter">)</span> <a href="ScalaMatchingTask.scala.html#33961" title="(message: String)Nothing">buildError</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Attribute \'file\' is not set.&quot;)" class="string">&quot;Attribute 'file' is not set.&quot;</span><span class="delimiter">)</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#59400" title="=&gt; Option[String]">mainClass</a>.<span title="=&gt; Boolean">isEmpty</span><span class="delimiter">)</span> <a href="ScalaMatchingTask.scala.html#33961" title="(message: String)Nothing">buildError</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Main class must be set.&quot;)" class="string">&quot;Main class must be set.&quot;</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="java.lang.String" id="62959">resourceRoot</a> = <span title="java.lang.String(&quot;scala/tools/ant/templates/&quot;)" class="string">&quot;scala/tools/ant/templates/&quot;</span>
    <span class="keyword">val</span> <a title="scala.collection.immutable.Map[java.lang.String,String]" id="62960">patches</a> = <span title="(elems: (java.lang.String, String)*)scala.collection.immutable.Map[java.lang.String,String]">Map</span> <span class="delimiter">(</span>
      <span title="(_1: java.lang.String, _2: String)(java.lang.String, String)" class="delimiter">(</span><span title="java.lang.String(&quot;class&quot;)" class="string">&quot;class&quot;</span>, <a href="#59400" title="=&gt; Option[String]">mainClass</a>.<span title="=&gt; String">get</span><span class="delimiter">)</span>,
      <span title="(_1: java.lang.String, _2: String)(java.lang.String, String)" class="delimiter">(</span><span title="java.lang.String(&quot;properties&quot;)" class="string">&quot;properties&quot;</span>, <a href="#59431" title="=&gt; String">getProperties</a><span class="delimiter">)</span>,
      <span title="(_1: java.lang.String, _2: String)(java.lang.String, String)" class="delimiter">(</span><span title="java.lang.String(&quot;javaflags&quot;)" class="string">&quot;javaflags&quot;</span>, <a href="#59415" title="=&gt; String">javaFlags</a><span class="delimiter">)</span>,
      <span title="(_1: java.lang.String, _2: String)(java.lang.String, String)" class="delimiter">(</span><span title="java.lang.String(&quot;toolflags&quot;)" class="string">&quot;toolflags&quot;</span>, <a href="#59418" title="=&gt; String">toolFlags</a><span class="delimiter">)</span>
    <span class="delimiter">)</span>
    <span class="comment">// Consolidate Paths into classpath</span>
    <a href="#59406" title="(x$1: List[String])Unit">classpath</a> = <a href="#59406" title="=&gt; List[String]">classpath</a> <a href="#63028" title="(prefix: List[java.lang.String])List[java.lang.String]">:::</a> <a href="#59409" title="=&gt; org.apache.tools.ant.types.Path">classpathPath</a>.<span title="(xs: Array[java.lang.String])scala.collection.mutable.ArrayOps[java.lang.String]">list</span>.<span title="=&gt; List[java.lang.String]">toList</span>
    <span class="comment">// Generate the scripts    </span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#59403" title="=&gt; List[String]">platforms</a>.<span title="(elem: Any)Boolean">contains</span><span class="delimiter">(</span><span title="java.lang.String(&quot;unix&quot;)" class="string">&quot;unix&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="scala.collection.immutable.Map[java.lang.String,String]" id="63140">unixPatches</a> = <a href="#62960" title="scala.collection.immutable.Map[java.lang.String,String]">patches</a> <span title="(kv: (java.lang.String, String))scala.collection.immutable.Map[java.lang.String,String]">+</span> <span class="delimiter">(</span><span title="(_1: java.lang.String, _2: String)(java.lang.String, String)" class="delimiter">(</span><span title="java.lang.String(&quot;classpath&quot;)" class="string">&quot;classpath&quot;</span>, <a href="#59429" title="=&gt; String">getUnixclasspath</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">val</span> <a title="java.lang.String" id="63141">unixTemplateResource</a> = <a href="#62959" title="java.lang.String">resourceRoot</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;tool-unix.tmpl&quot;)" class="string">&quot;tool-unix.tmpl&quot;</span>
      <span class="keyword">val</span> <a title="String" id="63142">unixTemplate</a> = <a href="#59434" title="(resource: String, tokens: Map[String,String])String">readAndPatchResource</a><span class="delimiter">(</span><a href="#63141" title="java.lang.String">unixTemplateResource</a>, <a href="#63140" title="scala.collection.immutable.Map[java.lang.String,String]">unixPatches</a><span class="delimiter">)</span>
      <a href="#59435" title="(file: java.io.File, content: String)Unit">writeFile</a><span class="delimiter">(</span><a href="#59397" title="=&gt; Option[java.io.File]">file</a>.<span title="=&gt; java.io.File">get</span>, <a href="#63142" title="String">unixTemplate</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#59403" title="=&gt; List[String]">platforms</a>.<span title="(elem: Any)Boolean">contains</span><span class="delimiter">(</span><span title="java.lang.String(&quot;windows&quot;)" class="string">&quot;windows&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="scala.collection.immutable.Map[java.lang.String,String]" id="63211">winPatches</a> = <a href="#62960" title="scala.collection.immutable.Map[java.lang.String,String]">patches</a> <span title="(kv: (java.lang.String, String))scala.collection.immutable.Map[java.lang.String,String]">+</span> <span class="delimiter">(</span><span title="(_1: java.lang.String, _2: String)(java.lang.String, String)" class="delimiter">(</span><span title="java.lang.String(&quot;classpath&quot;)" class="string">&quot;classpath&quot;</span>, <a href="#59430" title="=&gt; String">getWinclasspath</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">val</span> <a title="java.lang.String" id="63212">winTemplateResource</a> = <a href="#62959" title="java.lang.String">resourceRoot</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;tool-windows.tmpl&quot;)" class="string">&quot;tool-windows.tmpl&quot;</span>
      <span class="keyword">val</span> <a title="String" id="63213">winTemplate</a> = <a href="#59434" title="(resource: String, tokens: Map[String,String])String">readAndPatchResource</a><span class="delimiter">(</span><a href="#63212" title="java.lang.String">winTemplateResource</a>, <a href="#63211" title="scala.collection.immutable.Map[java.lang.String,String]">winPatches</a><span class="delimiter">)</span>
      <a href="#59435" title="(file: java.io.File, content: String)Unit">writeFile</a><span class="delimiter">(</span><span title="java.io.File" class="keyword">new</span> <span title="java.io.File">File</span><span class="delimiter">(</span><a href="#59397" title="=&gt; Option[java.io.File]">file</a>.<span title="=&gt; java.io.File">get</span>.<span title="()java.lang.String">getAbsolutePath</span><span class="delimiter">(</span><span class="delimiter">)</span> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;.bat&quot;)" class="string">&quot;.bat&quot;</span><span class="delimiter">)</span>, <a href="#63213" title="String">winTemplate</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

<span class="delimiter">}</span>

        </pre>
    </body>
</html>