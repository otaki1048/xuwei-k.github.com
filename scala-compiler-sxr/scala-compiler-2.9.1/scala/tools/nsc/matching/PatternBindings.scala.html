<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>scala/tools/nsc/matching/PatternBindings.scala</title>
        <script type="text/javascript" src="../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/* NSC -- new Scala compiler
 * Copyright 2005-2011 LAMP/EPFL
 * Author: Paul Phillips
 */</span>

<span class="keyword">package</span> scala.tools.nsc
<span class="keyword">package</span> matching

<span class="keyword">import</span> transform.ExplicitOuter
<span class="keyword">import</span> collection.immutable.TreeMap
<span class="keyword">import</span> <span title="object PartialFunction">PartialFunction</span>._

<span class="keyword">trait</span> <a title="trait PatternBindings extends java.lang.Object with scala.tools.nsc.ast.TreeDSL with ScalaObject" id="22288">PatternBindings</a> <span title="ScalaObject" class="keyword">extends</span> ast.<a href="../ast/TreeDSL.scala.html#11731" title="scala.tools.nsc.ast.TreeDSL">TreeDSL</a>
<span class="delimiter">{</span> 
  self: ExplicitOuter <span class="keyword">with</span> ParallelMatching =&gt;
  
  <span class="keyword">import</span> <a href="../transform/TypingTransformers.scala.html#110161" title="=&gt; scala.tools.nsc.Global">global</a>.<span class="delimiter">{</span> typer =&gt; _, _ <span class="delimiter">}</span>
  <span class="keyword">import</span> <a href="../symtab/Definitions.scala.html#67688" title="object PatternBindings.this.global.definitions">definitions</a>.<span class="delimiter">{</span> EqualsPatternClass <span class="delimiter">}</span>
  <span class="keyword">import</span> <a href="../ast/TreeDSL.scala.html#105696" title="object PatternBindings.this.CODE">CODE</a>._
  <span class="keyword">import</span> <a href="MatchSupport.scala.html#110799" title="object PatternBindings.this.Debug">Debug</a>._
  
  <span class="comment">/** EqualsPattern **/</span>
  <span class="keyword">def</span> <a title="(tpe: PatternBindings.this.global.Type)Boolean" id="110837">isEquals</a><span class="delimiter">(</span><a title="PatternBindings.this.global.Type" id="405018">tpe</a>: <a href="../symtab/Types.scala.html#67381" title="PatternBindings.this.global.Type">Type</a><span class="delimiter">)</span>             = <span title="(x: PatternBindings.this.global.Type)(pf: PartialFunction[PatternBindings.this.global.Type,Boolean])Boolean">cond</span><span class="delimiter">(</span><a href="#405018" title="PatternBindings.this.global.Type">tpe</a><span class="delimiter">)</span> <a href="#405029" title="Boolean" class="delimiter">{</a> <span class="keyword">case</span> <span title="Boolean(true)">TypeRef</span><span class="delimiter">(</span>_, <a href="../symtab/Definitions.scala.html#106226" title="=&gt; PatternBindings.this.global.Symbol">EqualsPatternClass</a>, _<span class="delimiter">)</span> =&gt; <span title="Boolean(true)" class="keyword">true</span> <span class="delimiter">}</span>
  <span class="keyword">def</span> <a title="(tpe: PatternBindings.this.global.Type)PatternBindings.this.global.Type" id="110838">mkEqualsRef</a><span class="delimiter">(</span><a title="PatternBindings.this.global.Type" id="410158">tpe</a>: <a href="../symtab/Types.scala.html#67381" title="PatternBindings.this.global.Type">Type</a><span class="delimiter">)</span>          = <a href="../symtab/Types.scala.html#67472" title="(pre: PatternBindings.this.global.Type, sym: PatternBindings.this.global.Symbol, args: List[PatternBindings.this.global.Type])PatternBindings.this.global.Type">typeRef</a><span class="delimiter">(</span><a href="../symtab/Types.scala.html#67397" title="object PatternBindings.this.global.NoPrefix">NoPrefix</a>, <a href="../symtab/Definitions.scala.html#106226" title="=&gt; PatternBindings.this.global.Symbol">EqualsPatternClass</a>, <span title="(xs: PatternBindings.this.global.Type*)List[PatternBindings.this.global.Type]">List</span><span class="delimiter">(</span><a href="#410158" title="PatternBindings.this.global.Type">tpe</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="(tpe: PatternBindings.this.global.Type)PatternBindings.this.global.Type" id="110839">decodedEqualsType</a><span class="delimiter">(</span><a title="PatternBindings.this.global.Type" id="399060">tpe</a>: <a href="../symtab/Types.scala.html#67381" title="PatternBindings.this.global.Type">Type</a><span class="delimiter">)</span>    = <span title="(x: PatternBindings.this.global.Type)(pf: PartialFunction[PatternBindings.this.global.Type,PatternBindings.this.global.Type])Option[PatternBindings.this.global.Type]">condOpt</span><span class="delimiter">(</span><a href="#399060" title="PatternBindings.this.global.Type">tpe</a><span class="delimiter">)</span> <a href="#399095" title="PatternBindings.this.global.Type" class="delimiter">{</a> <span class="keyword">case</span> <span title="PatternBindings.this.global.Type">TypeRef</span><span class="delimiter">(</span>_, <a href="../symtab/Definitions.scala.html#106226" title="=&gt; PatternBindings.this.global.Symbol">EqualsPatternClass</a>, <a href="#399160" title="(x: List[PatternBindings.this.global.Type])Some[List[PatternBindings.this.global.Type]]">List</a><span class="delimiter">(</span><a title="PatternBindings.this.global.Type" id="399182">arg</a><span class="delimiter">)</span><span class="delimiter">)</span> =&gt; <a href="#399182" title="PatternBindings.this.global.Type">arg</a> <span class="delimiter">}</span> <span title="(default: =&gt; PatternBindings.this.global.Type)PatternBindings.this.global.Type">getOrElse</span> <span class="delimiter">(</span><a href="#399060" title="PatternBindings.this.global.Type">tpe</a><span class="delimiter">)</span>
  
  <span class="comment">// A subtype test which creates fresh existentials for type</span>
  <span class="comment">// parameters on the right hand side.</span>
  <span class="keyword">def</span> <a title="(arg1: PatternBindings.this.global.Type, arg2: PatternBindings.this.global.Type)Boolean" id="110840">matches</a><span class="delimiter">(</span><a title="PatternBindings.this.global.Type" id="408130">arg1</a>: <a href="../symtab/Types.scala.html#67381" title="PatternBindings.this.global.Type">Type</a>, <a title="PatternBindings.this.global.Type" id="408131">arg2</a>: <a href="../symtab/Types.scala.html#67381" title="PatternBindings.this.global.Type">Type</a><span class="delimiter">)</span> = <a href="#110839" title="(tpe: PatternBindings.this.global.Type)PatternBindings.this.global.Type">decodedEqualsType</a><span class="delimiter">(</span><a href="#408130" title="PatternBindings.this.global.Type">arg1</a><span class="delimiter">)</span> <a href="../symtab/Types.scala.html#105376" title="(that: PatternBindings.this.global.Type)Boolean">matchesPattern</a> <a href="#110839" title="(tpe: PatternBindings.this.global.Type)PatternBindings.this.global.Type">decodedEqualsType</a><span class="delimiter">(</span><a href="#408131" title="PatternBindings.this.global.Type">arg2</a><span class="delimiter">)</span>

  <span class="comment">// For spotting duplicate unapplies</span>
  <span class="keyword">def</span> <a title="(t1: PatternBindings.this.global.Tree, t2: PatternBindings.this.global.Tree)Boolean" id="110841">isEquivalentTree</a><span class="delimiter">(</span><a title="PatternBindings.this.global.Tree" id="406480">t1</a>: <span title="PatternBindings.this.global.Tree">Tree</span>, <a title="PatternBindings.this.global.Tree" id="406481">t2</a>: <span title="PatternBindings.this.global.Tree">Tree</span><span class="delimiter">)</span> = <span class="delimiter">(</span><a href="#406480" title="PatternBindings.this.global.Tree">t1</a>.<span title="=&gt; PatternBindings.this.global.Symbol">symbol</span> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#406481" title="PatternBindings.this.global.Tree">t2</a>.<span title="=&gt; PatternBindings.this.global.Symbol">symbol</span><span class="delimiter">)</span> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <span class="delimiter">(</span><a href="../ast/Trees.scala.html#67777" title="implicit scala.tools.nsc.ast.Trees.treeWrapper : (tree: PatternBindings.this.global.Tree)PatternBindings.this.global.TreeOps">t1</a> <a href="../ast/Trees.scala.html#109040" title="(that: PatternBindings.this.global.Tree)Boolean">equalsStructure</a> <a href="#406481" title="PatternBindings.this.global.Tree">t2</a><span class="delimiter">)</span>
  
  <span class="comment">// Reproduce the Bind trees wrapping oldTree around newTree</span>
  <span class="keyword">def</span> <a title="(oldTree: PatternBindings.this.global.Tree, newTree: PatternBindings.this.global.Tree)PatternBindings.this.global.Tree" id="110842">moveBindings</a><span class="delimiter">(</span><a title="PatternBindings.this.global.Tree" id="410171">oldTree</a>: <span title="PatternBindings.this.global.Tree">Tree</span>, <a title="PatternBindings.this.global.Tree" id="410172">newTree</a>: <span title="PatternBindings.this.global.Tree">Tree</span><span class="delimiter">)</span>: <span title="PatternBindings.this.global.Tree">Tree</span> = <a href="#410171" title="PatternBindings.this.global.Tree">oldTree</a> <span title="PatternBindings.this.global.Tree" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <a title="PatternBindings.this.global.Bind" id="410174">b</a> @ Bind<span class="delimiter">(</span><a title="PatternBindings.this.global.Name" id="410181">x</a>, <a title="PatternBindings.this.global.Tree" id="410182">body</a><span class="delimiter">)</span>  =&gt; <a href="../ast/Trees.scala.html#67797" title="(sym: PatternBindings.this.global.Symbol, body: PatternBindings.this.global.Tree)PatternBindings.this.global.Bind">Bind</a><span class="delimiter">(</span><a href="#410174" title="PatternBindings.this.global.Bind">b</a>.<span title="=&gt; PatternBindings.this.global.Symbol">symbol</span>, <a href="#110842" title="(oldTree: PatternBindings.this.global.Tree, newTree: PatternBindings.this.global.Tree)PatternBindings.this.global.Tree">moveBindings</a><span class="delimiter">(</span><a href="#410182" title="PatternBindings.this.global.Tree">body</a>, <a href="#410172" title="PatternBindings.this.global.Tree">newTree</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="keyword">case</span> <span title="PatternBindings.this.global.Tree">_</span>                  =&gt; <a href="#410172" title="PatternBindings.this.global.Tree">newTree</a>
  <span class="delimiter">}</span>
  
  <span class="comment">// used as argument to `EqualsPatternClass'</span>
  case <span class="keyword">class</span> <a title="class PseudoType extends PatternBindings.this.global.Type with PatternBindings.this.global.SimpleTypeProxy with ScalaObject with Product with Serializable" id="407879">PseudoType</a><a href="#407879" title="ScalaObject" class="delimiter">(</a><a title="PatternBindings.this.global.Tree" id="410609">o</a>: <span title="PatternBindings.this.global.Tree">Tree</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="../symtab/Types.scala.html#67379" title="PatternBindings.this.global.SimpleTypeProxy">SimpleTypeProxy</a> <span class="delimiter">{</span>
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; PatternBindings.this.global.Type" id="407884">underlying</a>: <a href="../symtab/Types.scala.html#67381" title="PatternBindings.this.global.Type">Type</a> = <a href="#410609" title="=&gt; PatternBindings.this.global.Tree">o</a>.<span title="=&gt; PatternBindings.this.global.Type">tpe</span>
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; String" id="407885">safeToString</a>: <span title="String">String</span> = <span title="java.lang.String(&quot;PseudoType(&quot;)" class="string">&quot;PseudoType(&quot;</span><span title="(x$1: Any)java.lang.String">+</span><a href="#410609" title="=&gt; PatternBindings.this.global.Tree">o</a><span title="(x$1: Any)java.lang.String">+</span><span title="java.lang.String(&quot;)&quot;)" class="string">&quot;)&quot;</span>
  <span class="delimiter">}</span>

  <span class="comment">// If the given pattern contains alternatives, return it as a list of patterns.</span>
  <span class="comment">// Makes typed copies of any bindings found so all alternatives point to final state.</span>
  <span class="keyword">def</span> <a title="(p: PatternBindings.this.Pattern)List[PatternBindings.this.Pattern]" id="110846">extractBindings</a><span class="delimiter">(</span><a title="PatternBindings.this.Pattern" id="409110">p</a>: <a href="Patterns.scala.html#110776" title="PatternBindings.this.Pattern">Pattern</a><span class="delimiter">)</span>: <span title="List[PatternBindings.this.Pattern]">List</span><span class="delimiter">[</span>Pattern<span class="delimiter">]</span> =
    <a href="ParallelMatching.scala.html#110786" title="(xs: List[PatternBindings.this.global.Tree])List[PatternBindings.this.Pattern]">toPats</a><span class="delimiter">(</span><a href="#110847" title="(p: PatternBindings.this.global.Tree, prevBindings: PatternBindings.this.global.Tree =&gt; PatternBindings.this.global.Tree)List[PatternBindings.this.global.Tree]">_extractBindings</a><span class="delimiter">(</span><a href="#409110" title="PatternBindings.this.Pattern">p</a>.<a href="#403089" title="=&gt; PatternBindings.this.global.Tree">boundTree</a>, <a href="#410240" title="(x: PatternBindings.this.global.Tree)PatternBindings.this.global.Tree">identity</a><span class="delimiter">)</span><span class="delimiter">)</span>
  
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(p: PatternBindings.this.global.Tree, prevBindings: PatternBindings.this.global.Tree =&gt; PatternBindings.this.global.Tree)List[PatternBindings.this.global.Tree]" id="110847">_extractBindings</a><span class="delimiter">(</span><a title="PatternBindings.this.global.Tree" id="410232">p</a>: <span title="PatternBindings.this.global.Tree">Tree</span>, <a title="PatternBindings.this.global.Tree =&gt; PatternBindings.this.global.Tree" id="410233">prevBindings</a>: Tree =&gt; Tree<span class="delimiter">)</span>: <span title="List[PatternBindings.this.global.Tree]">List</span><span class="delimiter">[</span>Tree<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="(b: PatternBindings.this.global.Bind)PatternBindings.this.global.Tree =&gt; PatternBindings.this.global.Bind" id="410242">newPrev</a><span class="delimiter">(</span><a title="PatternBindings.this.global.Bind" id="410243">b</a>: <span title="PatternBindings.this.global.Bind">Bind</span><span class="delimiter">)</span> = <span class="delimiter">(</span>x: <span title="PatternBindings.this.global.Tree">Tree</span><span class="delimiter">)</span> =&gt; <a href="../ast/Trees.scala.html#67775" title="=&gt; PatternBindings.this.global.LazyTreeCopier">treeCopy</a>.<a href="../ast/Trees.scala.html#162468" title="(tree: PatternBindings.this.global.Tree, name: PatternBindings.this.global.Name, body: PatternBindings.this.global.Tree)PatternBindings.this.global.Bind">Bind</a><span class="delimiter">(</span><a href="#410243" title="PatternBindings.this.global.Bind">b</a>, <a href="#410243" title="PatternBindings.this.global.Bind">b</a>.<span title="=&gt; PatternBindings.this.global.Name">name</span>, <a href="#410245" title="PatternBindings.this.global.Tree">x</a><span class="delimiter">)</span> <span title="(tp: PatternBindings.this.global.Type)PatternBindings.this.global.Bind">setType</span> <a href="#410245" title="PatternBindings.this.global.Tree">x</a>.<span title="=&gt; PatternBindings.this.global.Type">tpe</span>

    <a href="#410232" title="PatternBindings.this.global.Tree">p</a> <span title="List[PatternBindings.this.global.Tree]" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <a title="List[PatternBindings.this.global.Tree]" id="410255">b</a> @ Bind<span class="delimiter">(</span>_, <a title="PatternBindings.this.global.Tree" id="410260">body</a><span class="delimiter">)</span>  =&gt; <a href="#110847" title="(p: PatternBindings.this.global.Tree, prevBindings: PatternBindings.this.global.Tree =&gt; PatternBindings.this.global.Tree)List[PatternBindings.this.global.Tree]">_extractBindings</a><span class="delimiter">(</span><a href="#410260" title="PatternBindings.this.global.Tree">body</a>, <a href="#410242" title="(b: PatternBindings.this.global.Bind)PatternBindings.this.global.Tree =&gt; PatternBindings.this.global.Bind">newPrev</a><span class="delimiter">(</span><a href="#410255" title="PatternBindings.this.global.Bind">b</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="List[PatternBindings.this.global.Tree]">Alternative</span><span class="delimiter">(</span><a title="List[PatternBindings.this.global.Tree]" id="410262">ps</a><span class="delimiter">)</span>    =&gt; <a href="#410262" title="List[PatternBindings.this.global.Tree]">ps</a> <span title="(f: PatternBindings.this.global.Tree =&gt; PatternBindings.this.global.Tree)(implicit bf: scala.collection.generic.CanBuildFrom[List[PatternBindings.this.global.Tree],PatternBindings.this.global.Tree,List[PatternBindings.this.global.Tree]])List[PatternBindings.this.global.Tree]">map</span> <a href="#410233" title="PatternBindings.this.global.Tree =&gt; PatternBindings.this.global.Tree">prevBindings</a>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
  
  <span class="keyword">trait</span> <a title="trait PatternBindingLogic extends java.lang.Object with ScalaObject" id="110848">PatternBindingLogic</a> <span title="ScalaObject" class="delimiter">{</span>
    self: Pattern =&gt;
    
    <span class="comment">// This is for traversing the pattern tree - pattern types which might have</span>
    <span class="comment">// bound variables beneath them return a list of said patterns for flatMapping.</span>
    <span class="keyword">def</span> <a title="=&gt; List[PatternBindings.this.Pattern]" id="403085">subpatternsForVars</a>: <span title="List[PatternBindings.this.Pattern]">List</span><span class="delimiter">[</span>Pattern<span class="delimiter">]</span> = <span title="object Nil">Nil</span>

    <span class="comment">// The outermost Bind(x1, Bind(x2, ...)) surrounding the tree.</span>
    <span class="keyword">private</span> <span class="keyword">var</span> <a title="PatternBindings.this.global.Tree" id="403087">_boundTree</a>: <span title="PatternBindings.this.global.Tree">Tree</span> = <a href="Patterns.scala.html#403101" title="=&gt; PatternBindings.this.global.Tree">tree</a>
    <span class="keyword">def</span> <a title="=&gt; PatternBindings.this.global.Tree" id="403089">boundTree</a> = <a href="#403087" title="=&gt; PatternBindings.this.global.Tree">_boundTree</a>
    <span class="keyword">def</span> <a title="(x: PatternBindings.this.global.Bind)PatternBindings.this.Pattern" id="403090">setBound</a><span class="delimiter">(</span><a title="PatternBindings.this.global.Bind" id="410326">x</a>: <span title="PatternBindings.this.global.Bind">Bind</span><span class="delimiter">)</span>: <a href="Patterns.scala.html#110776" title="PatternBindings.this.Pattern">Pattern</a> = <span class="delimiter">{</span>
      <a href="#403087" title="(x$1: PatternBindings.this.global.Tree)Unit">_boundTree</a> = <a href="#410326" title="PatternBindings.this.global.Bind">x</a>
      <a href="#110848" title="PatternBindings.this.Pattern" class="keyword">this</a>
    <span class="delimiter">}</span>
    <span class="keyword">def</span> <a title="=&gt; List[PatternBindings.this.global.Symbol]" id="403091">boundVariables</a> = <a href="#403098" title="(t: PatternBindings.this.global.Tree)List[PatternBindings.this.global.Symbol]">strip</a><span class="delimiter">(</span><a href="#403089" title="=&gt; PatternBindings.this.global.Tree">boundTree</a><span class="delimiter">)</span>
    
    <span class="comment">// If a tree has bindings, boundTree looks something like</span>
    <span class="comment">//   Bind(v3, Bind(v2, Bind(v1, tree)))</span>
    <span class="comment">// This takes the given tree and creates a new pattern</span>
    <span class="comment">//   using the same bindings.</span>
    <span class="keyword">def</span> <a title="(t: PatternBindings.this.global.Tree)PatternBindings.this.Pattern" id="403092">rebindTo</a><span class="delimiter">(</span><a title="PatternBindings.this.global.Tree" id="407280">t</a>: <span title="PatternBindings.this.global.Tree">Tree</span><span class="delimiter">)</span>: <a href="Patterns.scala.html#110776" title="PatternBindings.this.Pattern">Pattern</a> = <a href="Patterns.scala.html#403886" title="(tree: PatternBindings.this.global.Tree)PatternBindings.this.Pattern">Pattern</a><span class="delimiter">(</span><a href="#110842" title="(oldTree: PatternBindings.this.global.Tree, newTree: PatternBindings.this.global.Tree)PatternBindings.this.global.Tree">moveBindings</a><span class="delimiter">(</span><a href="#403089" title="=&gt; PatternBindings.this.global.Tree">boundTree</a>, <a href="#407280" title="PatternBindings.this.global.Tree">t</a><span class="delimiter">)</span><span class="delimiter">)</span>

    <span class="comment">// Wrap this pattern's bindings around (_: Type)</span>
    <span class="keyword">def</span> <a title="(tpe: PatternBindings.this.global.Type, ascription: PatternBindings.this.global.Type)PatternBindings.this.Pattern" id="403093">rebindToType</a><span class="delimiter">(</span><a title="PatternBindings.this.global.Type" id="410329">tpe</a>: <a href="../symtab/Types.scala.html#67381" title="PatternBindings.this.global.Type">Type</a>, <a title="PatternBindings.this.global.Type" id="410332">ascription</a>: <a href="../symtab/Types.scala.html#67381" title="PatternBindings.this.global.Type">Type</a> = <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span>: <a href="Patterns.scala.html#110776" title="PatternBindings.this.Pattern">Pattern</a> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="PatternBindings.this.global.Type" id="410333">aType</a> = <span title="PatternBindings.this.global.Type" class="keyword">if</span> <span class="delimiter">(</span><a href="#410332" title="PatternBindings.this.global.Type">ascription</a> <span title="(x$1: AnyRef)Boolean">==</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <a href="#410329" title="PatternBindings.this.global.Type">tpe</a> <span class="keyword">else</span> <a href="#410332" title="PatternBindings.this.global.Type">ascription</a>
      <a href="#403092" title="(t: PatternBindings.this.global.Tree)PatternBindings.this.Pattern">rebindTo</a><span class="delimiter">(</span><a href="../transform/TypingTransformers.scala.html#110161" title="(expr: PatternBindings.this.global.Tree, tpt: PatternBindings.this.global.Tree)PatternBindings.this.global.Typed">Typed</a><span class="delimiter">(</span><a href="../ast/TreeDSL.scala.html#149541" title="(tpe: PatternBindings.this.global.Type)PatternBindings.this.global.Ident">WILD</a><span class="delimiter">(</span><a href="#410329" title="PatternBindings.this.global.Type">tpe</a><span class="delimiter">)</span>, <a href="../ast/Trees.scala.html#67807" title="(tp: PatternBindings.this.global.Type)PatternBindings.this.global.TypeTree">TypeTree</a><span class="delimiter">(</span><a href="#410333" title="PatternBindings.this.global.Type">aType</a><span class="delimiter">)</span><span class="delimiter">)</span> <span title="(tp: PatternBindings.this.global.Type)PatternBindings.this.global.Typed">setType</span> <a href="#410329" title="PatternBindings.this.global.Type">tpe</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
    
    <span class="comment">// Wrap them around _</span>
    <span class="keyword">def</span> <a title="(tpe: PatternBindings.this.global.Type)PatternBindings.this.Pattern" id="403094">rebindToEmpty</a><span class="delimiter">(</span><a title="PatternBindings.this.global.Type" id="410349">tpe</a>: <a href="../symtab/Types.scala.html#67381" title="PatternBindings.this.global.Type">Type</a><span class="delimiter">)</span>: <a href="Patterns.scala.html#110776" title="PatternBindings.this.Pattern">Pattern</a> =
      <a href="#403092" title="(t: PatternBindings.this.global.Tree)PatternBindings.this.Pattern">rebindTo</a><span class="delimiter">(</span><a href="../transform/TypingTransformers.scala.html#110161" title="(expr: PatternBindings.this.global.Tree, tpt: PatternBindings.this.global.Tree)PatternBindings.this.global.Typed">Typed</a><span class="delimiter">(</span><a href="../transform/TypingTransformers.scala.html#110161" title="object PatternBindings.this.global.EmptyTree">EmptyTree</a>, <a href="../ast/Trees.scala.html#67807" title="(tp: PatternBindings.this.global.Type)PatternBindings.this.global.TypeTree">TypeTree</a><span class="delimiter">(</span><a href="#410349" title="PatternBindings.this.global.Type">tpe</a><span class="delimiter">)</span><span class="delimiter">)</span> <span title="(tp: PatternBindings.this.global.Type)PatternBindings.this.global.Typed">setType</span> <a href="#410349" title="PatternBindings.this.global.Type">tpe</a><span class="delimiter">)</span>
    
    <span class="comment">// Wrap them around a singleton type for an EqualsPattern check.</span>
    <span class="keyword">def</span> <a title="()PatternBindings.this.Pattern" id="403095">rebindToEqualsCheck</a><span class="delimiter">(</span><span class="delimiter">)</span>: <a href="Patterns.scala.html#110776" title="PatternBindings.this.Pattern">Pattern</a> =
      <a href="#403093" title="(tpe: PatternBindings.this.global.Type, ascription: PatternBindings.this.global.Type)PatternBindings.this.Pattern">rebindToType</a><span class="delimiter">(</span><a href="Patterns.scala.html#403116" title="=&gt; PatternBindings.this.global.Type">equalsCheck</a><span class="delimiter">)</span>
    
    <span class="comment">// Like rebindToEqualsCheck, but subtly different.  Not trying to be</span>
    <span class="comment">// mysterious -- I haven't sorted it all out yet.</span>
    <span class="keyword">def</span> <a title="()PatternBindings.this.Pattern" id="403096">rebindToObjectCheck</a><span class="delimiter">(</span><span class="delimiter">)</span>: <a href="Patterns.scala.html#110776" title="PatternBindings.this.Pattern">Pattern</a> =
      <a href="#403093" title="(tpe: PatternBindings.this.global.Type, ascription: PatternBindings.this.global.Type)PatternBindings.this.Pattern">rebindToType</a><span class="delimiter">(</span><a href="#110838" title="(tpe: PatternBindings.this.global.Type)PatternBindings.this.global.Type">mkEqualsRef</a><span class="delimiter">(</span><a href="Patterns.scala.html#403106" title="=&gt; PatternBindings.this.global.Type">sufficientType</a><span class="delimiter">)</span>, <a href="Patterns.scala.html#403106" title="=&gt; PatternBindings.this.global.Type">sufficientType</a><span class="delimiter">)</span>
       
    <span class="comment">/** Helpers **/</span>    
    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(vs: List[PatternBindings.this.global.Symbol], pat: PatternBindings.this.global.Tree)PatternBindings.this.global.Tree" id="403097">wrapBindings</a><span class="delimiter">(</span><a title="List[PatternBindings.this.global.Symbol]" id="410380">vs</a>: <span title="List[PatternBindings.this.global.Symbol]">List</span><span class="delimiter">[</span>Symbol<span class="delimiter">]</span>, <a title="PatternBindings.this.global.Tree" id="410381">pat</a>: <span title="PatternBindings.this.global.Tree">Tree</span><span class="delimiter">)</span>: <span title="PatternBindings.this.global.Tree">Tree</span> = <a href="#410380" title="List[PatternBindings.this.global.Symbol]">vs</a> <span title="PatternBindings.this.global.Tree" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <span title="PatternBindings.this.global.Tree">Nil</span>      =&gt; <a href="#410381" title="PatternBindings.this.global.Tree">pat</a>
      <span class="keyword">case</span> <a title="PatternBindings.this.global.Bind" id="410389">x</a> :: <a title="List[PatternBindings.this.global.Symbol]" id="410390">xs</a>  =&gt; <a href="../ast/Trees.scala.html#67797" title="(sym: PatternBindings.this.global.Symbol, body: PatternBindings.this.global.Tree)PatternBindings.this.global.Bind">Bind</a><span class="delimiter">(</span><a href="#410389" title="PatternBindings.this.global.Symbol">x</a>, <a href="#403097" title="(vs: List[PatternBindings.this.global.Symbol], pat: PatternBindings.this.global.Tree)PatternBindings.this.global.Tree">wrapBindings</a><span class="delimiter">(</span><a href="#410390" title="List[PatternBindings.this.global.Symbol]">xs</a>, <a href="#410381" title="PatternBindings.this.global.Tree">pat</a><span class="delimiter">)</span><span class="delimiter">)</span> <span title="(tp: PatternBindings.this.global.Type)PatternBindings.this.global.Bind">setType</span> <a href="#410381" title="PatternBindings.this.global.Tree">pat</a>.<span title="=&gt; PatternBindings.this.global.Type">tpe</span>
    <span class="delimiter">}</span>
    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(t: PatternBindings.this.global.Tree)List[PatternBindings.this.global.Symbol]" id="403098">strip</a><span class="delimiter">(</span><a title="PatternBindings.this.global.Tree" id="405654">t</a>: <span title="PatternBindings.this.global.Tree">Tree</span><span class="delimiter">)</span>: <span title="List[PatternBindings.this.global.Symbol]">List</span><span class="delimiter">[</span>Symbol<span class="delimiter">]</span> = <a href="#405654" title="PatternBindings.this.global.Tree">t</a> <span title="List[PatternBindings.this.global.Symbol]" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <a title="List[PatternBindings.this.global.Symbol]" id="410412">b</a> @ Bind<span class="delimiter">(</span>_, <a title="PatternBindings.this.global.Tree" id="410417">pat</a><span class="delimiter">)</span> =&gt; <a href="#410412" title="PatternBindings.this.global.Bind">b</a>.<span title="=&gt; PatternBindings.this.global.Symbol">symbol</span> <a href="#410418" title="(x: PatternBindings.this.global.Symbol)List[PatternBindings.this.global.Symbol]">::</a> <a href="#403098" title="(t: PatternBindings.this.global.Tree)List[PatternBindings.this.global.Symbol]">strip</a><span class="delimiter">(</span><a href="#410417" title="PatternBindings.this.global.Tree">pat</a><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="scala.collection.immutable.Nil.type">_</span>                =&gt; <span title="object Nil">Nil</span>
    <span class="delimiter">}</span>
    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(t: PatternBindings.this.global.Tree)List[PatternBindings.this.global.Symbol]" id="403099">deepstrip</a><span class="delimiter">(</span><a title="PatternBindings.this.global.Tree" id="410424">t</a>: <span title="PatternBindings.this.global.Tree">Tree</span><span class="delimiter">)</span>: <span title="List[PatternBindings.this.global.Symbol]">List</span><span class="delimiter">[</span>Symbol<span class="delimiter">]</span> =
      <a href="MatchSupport.scala.html#110794" title="(tree: PatternBindings.this.global.Tree, pf: PartialFunction[PatternBindings.this.global.Tree,PatternBindings.this.global.Symbol])List[PatternBindings.this.global.Symbol]">treeCollect</a><span class="delimiter">(</span><a href="#410424" title="PatternBindings.this.global.Tree">t</a>, <a href="#410432" title="PatternBindings.this.global.Symbol" class="delimiter">{</a> <span class="keyword">case</span> <a title="PatternBindings.this.global.Symbol" id="410433">x</a>: <span title="PatternBindings.this.global.Bind">Bind</span> =&gt; <a href="#410433" title="PatternBindings.this.global.Bind">x</a>.<span title="=&gt; PatternBindings.this.global.Symbol">symbol</span> <span class="delimiter">}</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  case <span class="keyword">class</span> <a title="class Binding extends java.lang.Object with ScalaObject with Product with Serializable" id="401849">Binding</a><a href="#401849" title="ScalaObject" class="delimiter">(</a><a title="PatternBindings.this.global.Symbol" id="410501">pvar</a>: <a href="../symtab/Symbols.scala.html#67320" title="PatternBindings.this.global.Symbol">Symbol</a>, <a title="PatternBindings.this.global.Symbol" id="410502">tvar</a>: <a href="../symtab/Symbols.scala.html#67320" title="PatternBindings.this.global.Symbol">Symbol</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="()java.lang.String" id="401824">toString</a><span class="delimiter">(</span><span class="delimiter">)</span> = <a href="#410501" title="=&gt; PatternBindings.this.global.Symbol">pvar</a>.<a href="../symtab/Symbols.scala.html#107407" title="implicit scala.Predef.any2stringadd : (x: Any)scala.runtime.StringAdd">name</a> <span title="(other: String)java.lang.String">+</span> <span title="java.lang.String(&quot; -&gt; &quot;)" class="string">&quot; -&gt; &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#410502" title="=&gt; PatternBindings.this.global.Symbol">tvar</a>.<a href="../symtab/Symbols.scala.html#107407" title="=&gt; PatternBindings.this.global.Name">name</a>
  <span class="delimiter">}</span>

  <span class="keyword">class</span> <a title="class Bindings extends java.lang.Object with ScalaObject" id="110852">Bindings</a><a href="#110852" title="ScalaObject" class="delimiter">(</a><span class="keyword">private</span> <span class="keyword">val</span> <a title="List[PatternBindings.this.Binding]" id="410477">vlist</a>: <span title="List[PatternBindings.this.Binding]">List</span><span class="delimiter">[</span>Binding<span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="comment">// if (!vlist.isEmpty)</span>
    <span class="comment">//   traceCategory(&quot;Bindings&quot;, this.toString)</span>

    <span class="keyword">def</span> <a title="()List[PatternBindings.this.Binding]" id="405395">get</a><span class="delimiter">(</span><span class="delimiter">)</span> = <a href="#410477" title="=&gt; List[PatternBindings.this.Binding]">vlist</a>
    <span class="keyword">def</span> <a title="=&gt; scala.collection.immutable.Map[PatternBindings.this.global.Symbol,PatternBindings.this.global.Symbol]" id="405396">toMap</a> = <a href="#410477" title="=&gt; List[PatternBindings.this.Binding]">vlist</a> <span title="(f: PatternBindings.this.Binding =&gt; (PatternBindings.this.global.Symbol, PatternBindings.this.global.Symbol))(implicit bf: scala.collection.generic.CanBuildFrom[List[PatternBindings.this.Binding],(PatternBindings.this.global.Symbol, PatternBindings.this.global.Symbol),List[(PatternBindings.this.global.Symbol, PatternBindings.this.global.Symbol)]])List[(PatternBindings.this.global.Symbol, PatternBindings.this.global.Symbol)]">map</span> <span class="delimiter">(</span><a title="PatternBindings.this.Binding" id="405429">x</a> =&gt; <span title="(_1: PatternBindings.this.global.Symbol, _2: PatternBindings.this.global.Symbol)(PatternBindings.this.global.Symbol, PatternBindings.this.global.Symbol)" class="delimiter">(</span><a href="#405429" title="PatternBindings.this.Binding">x</a>.<a href="#410501" title="=&gt; PatternBindings.this.global.Symbol">pvar</a>, <a href="#405429" title="PatternBindings.this.Binding">x</a>.<a href="#410502" title="=&gt; PatternBindings.this.global.Symbol">tvar</a><span class="delimiter">)</span><span class="delimiter">)</span> <span title="(implicit ev: &lt;:&lt;[(PatternBindings.this.global.Symbol, PatternBindings.this.global.Symbol),(PatternBindings.this.global.Symbol, PatternBindings.this.global.Symbol)])scala.collection.immutable.Map[PatternBindings.this.global.Symbol,PatternBindings.this.global.Symbol]">toMap</span>
    
    <span class="keyword">def</span> <a title="(vs: Iterable[PatternBindings.this.global.Symbol], tvar: PatternBindings.this.global.Symbol)PatternBindings.this.Bindings" id="405397">add</a><span class="delimiter">(</span><a title="Iterable[PatternBindings.this.global.Symbol]" id="405699">vs</a>: <span title="Iterable[PatternBindings.this.global.Symbol]">Iterable</span><span class="delimiter">[</span>Symbol<span class="delimiter">]</span>, <a title="PatternBindings.this.global.Symbol" id="405700">tvar</a>: <a href="../symtab/Symbols.scala.html#67320" title="PatternBindings.this.global.Symbol">Symbol</a><span class="delimiter">)</span>: <a href="#110852" title="PatternBindings.this.Bindings">Bindings</a> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="List[PatternBindings.this.Binding]" id="410478">newBindings</a> = <a href="#405699" title="Iterable[PatternBindings.this.global.Symbol]">vs</a>.<span title="=&gt; List[PatternBindings.this.global.Symbol]">toList</span> <span title="(f: PatternBindings.this.global.Symbol =&gt; PatternBindings.this.Binding)(implicit bf: scala.collection.generic.CanBuildFrom[List[PatternBindings.this.global.Symbol],PatternBindings.this.Binding,List[PatternBindings.this.Binding]])List[PatternBindings.this.Binding]">map</span> <span class="delimiter">(</span><a title="PatternBindings.this.global.Symbol" id="410500">v</a> =&gt; <a href="#401849" title="(pvar: PatternBindings.this.global.Symbol, tvar: PatternBindings.this.global.Symbol)PatternBindings.this.Binding">Binding</a><span class="delimiter">(</span><a href="#410500" title="PatternBindings.this.global.Symbol">v</a>, <a href="#405700" title="PatternBindings.this.global.Symbol">tvar</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span title="PatternBindings.this.Bindings" class="keyword">new</span> <a href="#110852" title="PatternBindings.this.Bindings">Bindings</a><span class="delimiter">(</span><a href="#410478" title="List[PatternBindings.this.Binding]">newBindings</a> <span title="(that: scala.collection.GenTraversableOnce[PatternBindings.this.Binding])(implicit bf: scala.collection.generic.CanBuildFrom[List[PatternBindings.this.Binding],PatternBindings.this.Binding,List[PatternBindings.this.Binding]])List[PatternBindings.this.Binding]">++</span> <a href="#410477" title="=&gt; List[PatternBindings.this.Binding]">vlist</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="keyword">override</span> <span class="keyword">def</span> <a title="()java.lang.String" id="405398">toString</a><span class="delimiter">(</span><span class="delimiter">)</span> = 
      <span title="java.lang.String" class="keyword">if</span> <span class="delimiter">(</span><a href="#410477" title="=&gt; List[PatternBindings.this.Binding]">vlist</a>.<span title="=&gt; Boolean">isEmpty</span><span class="delimiter">)</span> <span title="java.lang.String(&quot;&lt;none&gt;&quot;)" class="string">&quot;&lt;none&gt;&quot;</span>
      <span class="keyword">else</span> <a href="#410477" title="=&gt; List[PatternBindings.this.Binding]">vlist</a>.<span title="(sep: String)String">mkString</span><span class="delimiter">(</span><span title="java.lang.String(&quot;, &quot;)" class="string">&quot;, &quot;</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">val</span> <a title="PatternBindings.this.Bindings" id="110853">NoBinding</a>: <a href="#110852" title="PatternBindings.this.Bindings">Bindings</a> = <span title="PatternBindings.this.Bindings" class="keyword">new</span> <a href="#110852" title="PatternBindings.this.Bindings">Bindings</a><span class="delimiter">(</span><span title="object Nil">Nil</span><span class="delimiter">)</span>
<span class="delimiter">}</span>
        </pre>
    </body>
</html>