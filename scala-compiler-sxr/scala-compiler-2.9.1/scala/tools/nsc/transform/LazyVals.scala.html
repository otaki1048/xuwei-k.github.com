<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>scala/tools/nsc/transform/LazyVals.scala</title>
        <script type="text/javascript" src="../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> scala.tools.nsc
<span class="keyword">package</span> transform

<span class="keyword">import</span> scala.collection.<span class="delimiter">{</span> mutable, immutable <span class="delimiter">}</span>

<span class="keyword">abstract</span> <span class="keyword">class</span> <a title="class LazyVals extends scala.tools.nsc.SubComponent with scala.tools.nsc.transform.Transform with scala.tools.nsc.transform.TypingTransformers with scala.tools.nsc.ast.TreeDSL with ScalaObject" id="25755">LazyVals</a> <a href="#25755" title="ScalaObject" class="keyword">extends</a> <a href="Transform.scala.html#27198" title="scala.tools.nsc.transform.Transform">Transform</a> <span class="keyword">with</span> <a href="TypingTransformers.scala.html#26991" title="scala.tools.nsc.transform.TypingTransformers">TypingTransformers</a> <span class="keyword">with</span> ast.<a href="../ast/TreeDSL.scala.html#11720" title="scala.tools.nsc.ast.TreeDSL">TreeDSL</a> <span class="delimiter">{</span>
  <span class="comment">// inherits abstract value `global' and class `Phase' from Transform</span>

  <span class="keyword">import</span> <a href="../ast/TreeDSL.scala.html#105833" title="=&gt; scala.tools.nsc.Global">global</a>._                  <span class="comment">// the global environment</span>
  <span class="keyword">import</span> <a href="../symtab/Definitions.scala.html#67699" title="object LazyVals.this.global.definitions">definitions</a>._             <span class="comment">// standard classes and methods</span>
  <span class="keyword">import</span> <a href="../Global.scala.html#64965" title="object LazyVals.this.global.typer">typer</a>.<span class="delimiter">{</span>typed, atOwner<span class="delimiter">}</span>    <span class="comment">// methods to type trees</span>
  <span class="keyword">import</span> <a href="../ast/TreeDSL.scala.html#105837" title="object LazyVals.this.CODE">CODE</a>._

  <span class="keyword">val</span> <a title="String" id="111815">phaseName</a>: <span title="String">String</span> = <span title="java.lang.String(&quot;lazyvals&quot;)" class="string">&quot;lazyvals&quot;</span>
  <span class="keyword">val</span> <a title="=&gt; Int" id="111817">FLAGS_PER_WORD</a>: <span title="Int">Int</span>

  <span class="keyword">def</span> <a title="(unit: LazyVals.this.global.CompilationUnit)LazyVals.this.global.Transformer" id="111818">newTransformer</a><span class="delimiter">(</span><a title="LazyVals.this.global.CompilationUnit" id="507232">unit</a>: <a href="../CompilationUnits.scala.html#67953" title="LazyVals.this.global.CompilationUnit">CompilationUnit</a><span class="delimiter">)</span>: <a href="../ast/Trees.scala.html#67836" title="LazyVals.this.global.Transformer">Transformer</a> =
    <span title="LazyVals.this.LazyValues" class="keyword">new</span> <a href="#111822" title="LazyVals.this.LazyValues">LazyValues</a><span class="delimiter">(</span><a href="#507232" title="LazyVals.this.global.CompilationUnit">unit</a><span class="delimiter">)</span>
  
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(sym: LazyVals.this.global.Symbol)Boolean" id="111819">lazyUnit</a><span class="delimiter">(</span><a title="LazyVals.this.global.Symbol" id="507250">sym</a>: <a href="../symtab/Symbols.scala.html#67331" title="LazyVals.this.global.Symbol">Symbol</a><span class="delimiter">)</span> = <a href="#507250" title="LazyVals.this.global.Symbol">sym</a>.<a href="../symtab/Symbols.scala.html#107562" title="=&gt; LazyVals.this.global.Type">tpe</a>.<a href="../symtab/Types.scala.html#105468" title="=&gt; LazyVals.this.global.Type">resultType</a>.<a href="../symtab/Types.scala.html#105454" title="=&gt; LazyVals.this.global.Symbol">typeSymbol</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../symtab/Definitions.scala.html#106718" title="=&gt; LazyVals.this.global.Symbol">UnitClass</a>

  <span class="keyword">object</span> <a title="object LazyVals.this.LocalLazyValFinder" id="111820">LocalLazyValFinder</a> <span title="ScalaObject" class="keyword">extends</span> <a href="../ast/Trees.scala.html#67837" title="LazyVals.this.global.Traverser">Traverser</a> <span class="delimiter">{</span>
    <span class="keyword">var</span> <a title="Boolean" id="507264">result</a>: <span title="Boolean">Boolean</span>  = _
      
    <span class="keyword">def</span> <a title="(t: LazyVals.this.global.Tree)Boolean" id="507266">find</a><span class="delimiter">(</span><a title="LazyVals.this.global.Tree" id="507271">t</a>: <span title="LazyVals.this.global.Tree">Tree</span><span class="delimiter">)</span> = <span class="delimiter">{</span><a href="#507264" title="(x$1: Boolean)Unit">result</a> = <span title="Boolean(false)" class="keyword">false</span>; <a href="#507268" title="(t: LazyVals.this.global.Tree)Unit">traverse</a><span class="delimiter">(</span><a href="#507271" title="LazyVals.this.global.Tree">t</a><span class="delimiter">)</span>; <a href="#507264" title="=&gt; Boolean">result</a><span class="delimiter">}</span>
    <span class="keyword">def</span> <a title="(ts: List[LazyVals.this.global.Tree])Boolean" id="507267">find</a><span class="delimiter">(</span><a title="List[LazyVals.this.global.Tree]" id="507280">ts</a>: <span title="List[LazyVals.this.global.Tree]">List</span><span class="delimiter">[</span>Tree<span class="delimiter">]</span><span class="delimiter">)</span> = <span class="delimiter">{</span><a href="#507264" title="(x$1: Boolean)Unit">result</a> = <span title="Boolean(false)" class="keyword">false</span>; <span title="(trees: List[LazyVals.this.global.Tree])Unit">traverseTrees</span><span class="delimiter">(</span><a href="#507280" title="List[LazyVals.this.global.Tree]">ts</a><span class="delimiter">)</span>; <a href="#507264" title="=&gt; Boolean">result</a><span class="delimiter">}</span>  
    
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="(t: LazyVals.this.global.Tree)Unit" id="507268">traverse</a><span class="delimiter">(</span><a title="LazyVals.this.global.Tree" id="507274">t</a>: <span title="LazyVals.this.global.Tree">Tree</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#507264" title="=&gt; Boolean">result</a><span class="delimiter">)</span>
        <a href="#507274" title="LazyVals.this.global.Tree">t</a> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> <a title="Unit" id="507284">v</a>@ValDef<span class="delimiter">(</span>_, _, _, _<span class="delimiter">)</span> <span class="keyword">if</span> <a href="#507284" title="LazyVals.this.global.ValDef">v</a>.<span title="=&gt; LazyVals.this.global.Symbol">symbol</span>.<span title="=&gt; Boolean">isLazy</span> =&gt;
            <a href="#507264" title="(x$1: Boolean)Unit">result</a> = <span title="Boolean(true)" class="keyword">true</span>

          <span class="keyword">case</span> <a title="Unit" id="507294">d</a>@DefDef<span class="delimiter">(</span>_, _, _, _, _, _<span class="delimiter">)</span> <span class="keyword">if</span> <a href="#507294" title="LazyVals.this.global.DefDef">d</a>.<span title="=&gt; LazyVals.this.global.Symbol">symbol</span>.<span title="=&gt; Boolean">isLazy</span> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#111819" title="(sym: LazyVals.this.global.Symbol)Boolean">lazyUnit</a><span class="delimiter">(</span><a href="#507294" title="LazyVals.this.global.DefDef">d</a>.<span title="=&gt; LazyVals.this.global.Symbol">symbol</span><span class="delimiter">)</span> =&gt;
            <a href="#507294" title="LazyVals.this.global.DefDef">d</a>.<span title="=&gt; LazyVals.this.global.Symbol">symbol</span>.<a href="../symtab/Symbols.scala.html#107554" title="(mask: Long)LazyVals.this.global.Symbol">resetFlag</a><span class="delimiter">(</span>symtab.Flags.<span title="Long(2147483648L)">LAZY</span><span class="delimiter">)</span>
            <a href="#507264" title="(x$1: Boolean)Unit">result</a> = <span title="Boolean(true)" class="keyword">true</span>
              
          <span class="keyword">case</span> <span title="Unit">ClassDef</span><span class="delimiter">(</span>_, _, _, _<span class="delimiter">)</span> | DefDef<span class="delimiter">(</span>_, _, _, _, _, _<span class="delimiter">)</span> | ModuleDef<span class="delimiter">(</span>_, _, _<span class="delimiter">)</span> =&gt;
              
          <span class="keyword">case</span> <span title="Unit">LabelDef</span><span class="delimiter">(</span><a title="LazyVals.this.global.TermName" id="507356">name</a>, _, _<span class="delimiter">)</span> <span class="keyword">if</span> <a href="../symtab/StdNames.scala.html#67724" title="object LazyVals.this.global.nme">nme</a>.<a href="../symtab/NameManglers.scala.html#115747" title="(name: LazyVals.this.global.Name)Boolean">isLoopHeaderLabel</a><span class="delimiter">(</span><a href="#507356" title="LazyVals.this.global.TermName">name</a><span class="delimiter">)</span> =&gt;
              
          <span class="keyword">case</span> <span title="Unit">_</span> =&gt;
            <span class="keyword">super</span>.<a href="../ast/Trees.scala.html#162670" title="(tree: LazyVals.this.global.Tree)Unit">traverse</a><span class="delimiter">(</span><a href="#507274" title="LazyVals.this.global.Tree">t</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
  
  <span class="comment">/**
   * Transform local lazy accessors to check for the initialized bit.
   */</span>
  <span class="keyword">class</span> <a title="class LazyValues extends LazyVals.this.TypingTransformer with ScalaObject" id="111822">LazyValues</a><a href="#111822" title="ScalaObject" class="delimiter">(</a><a title="LazyVals.this.global.CompilationUnit" id="507249">unit</a>: <a href="../CompilationUnits.scala.html#67953" title="LazyVals.this.global.CompilationUnit">CompilationUnit</a><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="TypingTransformers.scala.html#110303" title="LazyVals.this.TypingTransformer">TypingTransformer</a><span class="delimiter">(</span><a href="#507249" title="LazyVals.this.global.CompilationUnit">unit</a><span class="delimiter">)</span> <span class="delimiter">{</span>    
    <span class="comment">/** map from method symbols to the number of lazy values it defines. */</span>
    <span class="keyword">private</span> <span class="keyword">val</span> <a title="scala.collection.mutable.HashMap[LazyVals.this.global.Symbol,Int]" id="507238">lazyVals</a> = <a href="#507362" title="scala.collection.mutable.HashMap[LazyVals.this.global.Symbol,Int]" class="keyword">new</a> <a title="anonymous class $anon extends scala.collection.mutable.HashMap[LazyVals.this.global.Symbol,Int]" id="507362">mutable</a>.<span title="scala.collection.mutable.HashMap[LazyVals.this.global.Symbol,Int]">HashMap</span><span class="delimiter">[</span>Symbol, Int<span class="delimiter">]</span> <span class="delimiter">{</span>
      <span class="keyword">override</span> <span class="keyword">def</span> <a title="(meth: LazyVals.this.global.Symbol)Int" id="507364">default</a><span class="delimiter">(</span><a title="LazyVals.this.global.Symbol" id="507365">meth</a>: <a href="../symtab/Symbols.scala.html#67331" title="LazyVals.this.global.Symbol">Symbol</a><span class="delimiter">)</span> = <span title="Int(0)" class="int">0</span>
    <span class="delimiter">}</span>
    
    <span class="keyword">import</span> symtab.<a href="../symtab/Flags.scala.html#24068" title="object scala.tools.nsc.symtab.Flags">Flags</a>._
    <span class="keyword">import</span> <a href="#507238" title="=&gt; scala.collection.mutable.HashMap[LazyVals.this.global.Symbol,Int]">lazyVals</a>._

    <span class="comment">/** Perform the following transformations:
     *  - for a lazy accessor inside a method, make it check the initialization bitmap
     *  - for all methods, add enough int vars to allow one flag per lazy local value
     *  - blocks in template bodies behave almost like methods. A single bitmaps section is
     *      added in the first block, for all lazy values defined in such blocks.
     *  - remove ACCESSOR flags: accessors in traits are not statically implemented,  
     *    but moved to the host class. local lazy values should be statically implemented.
     */</span>
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="(tree: LazyVals.this.global.Tree)LazyVals.this.global.Tree" id="507242">transform</a><span class="delimiter">(</span><a title="LazyVals.this.global.Tree" id="507448">tree</a>: <span title="LazyVals.this.global.Tree">Tree</span><span class="delimiter">)</span>: <span title="LazyVals.this.global.Tree">Tree</span> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="LazyVals.this.global.Symbol" id="507453">sym</a> = <a href="#507448" title="LazyVals.this.global.Tree">tree</a>.<span title="=&gt; LazyVals.this.global.Symbol">symbol</span>
      <a href="TypingTransformers.scala.html#501547" title="(x$1: LazyVals.this.global.Tree)Unit">curTree</a> = <a href="#507448" title="LazyVals.this.global.Tree">tree</a>
      
      <a href="#507448" title="LazyVals.this.global.Tree">tree</a> <span title="LazyVals.this.global.Tree" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <span title="LazyVals.this.global.DefDef">DefDef</span><span class="delimiter">(</span><a title="LazyVals.this.global.Modifiers" id="507464">mods</a>, <a title="LazyVals.this.global.TermName" id="507465">name</a>, <a title="List[LazyVals.this.global.TypeDef]" id="507466">tparams</a>, <a title="List[List[LazyVals.this.global.ValDef]]" id="507467">vparams</a>, <a title="LazyVals.this.global.Tree" id="507468">tpt</a>, <a title="LazyVals.this.global.Tree" id="507469">rhs</a><span class="delimiter">)</span> =&gt; <a href="TypingTransformers.scala.html#501552" title="(owner: LazyVals.this.global.Symbol)(trans: =&gt; LazyVals.this.global.DefDef)LazyVals.this.global.DefDef">atOwner</a><span class="delimiter">(</span><a href="#507448" title="LazyVals.this.global.Tree">tree</a>.<span title="=&gt; LazyVals.this.global.Symbol">symbol</span><span class="delimiter">)</span> <span class="delimiter">{</span>
          <span class="keyword">val</span> <a title="LazyVals.this.global.Tree" id="507489">res</a> = <span title="LazyVals.this.global.Tree" class="keyword">if</span> <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#507453" title="LazyVals.this.global.Symbol">sym</a>.<a href="../symtab/Symbols.scala.html#107541" title="=&gt; LazyVals.this.global.Symbol">owner</a>.<span title="=&gt; Boolean">isClass</span> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#507453" title="LazyVals.this.global.Symbol">sym</a>.<span title="=&gt; Boolean">isLazy</span><span class="delimiter">)</span> <span class="delimiter">{</span>
            <span class="keyword">val</span> <a title="LazyVals.this.global.Symbol" id="507490">enclosingClassOrDummyOrMethod</a> = <span class="delimiter">{</span>
              <span class="keyword">val</span> <a title="LazyVals.this.global.Symbol" id="507493">enclMethod</a> = <a href="#507453" title="LazyVals.this.global.Symbol">sym</a>.<span title="=&gt; LazyVals.this.global.Symbol">enclMethod</span>
              
              <span title="LazyVals.this.global.Symbol" class="keyword">if</span> <span class="delimiter">(</span><a href="#507493" title="LazyVals.this.global.Symbol">enclMethod</a> <span title="(x$1: AnyRef)Boolean">!=</span> <a href="../symtab/Symbols.scala.html#67339" title="object LazyVals.this.global.NoSymbol">NoSymbol</a> <span class="delimiter">)</span> <span class="delimiter">{</span>
                <span class="keyword">val</span> <a title="LazyVals.this.global.Symbol" id="507498">enclClass</a> = <a href="#507453" title="LazyVals.this.global.Symbol">sym</a>.<span title="=&gt; LazyVals.this.global.Symbol">enclClass</span>
                <span title="LazyVals.this.global.Symbol" class="keyword">if</span> <span class="delimiter">(</span><a href="#507498" title="LazyVals.this.global.Symbol">enclClass</a> <span title="(x$1: AnyRef)Boolean">!=</span> <a href="../symtab/Symbols.scala.html#67339" title="object LazyVals.this.global.NoSymbol">NoSymbol</a> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#507493" title="LazyVals.this.global.Symbol">enclMethod</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#507498" title="LazyVals.this.global.Symbol">enclClass</a>.<span title="=&gt; LazyVals.this.global.Symbol">enclMethod</span><span class="delimiter">)</span>
                  <a href="#507498" title="LazyVals.this.global.Symbol">enclClass</a>
                <span class="keyword">else</span>
                  <a href="#507493" title="LazyVals.this.global.Symbol">enclMethod</a>
              <span class="delimiter">}</span> <span class="keyword">else</span>
                <a href="#507453" title="LazyVals.this.global.Symbol">sym</a>.<a href="../symtab/Symbols.scala.html#107541" title="=&gt; LazyVals.this.global.Symbol">owner</a>
            <span class="delimiter">}</span>
            <span class="keyword">val</span> <a title="Int" id="507491">idx</a> = <a href="#507238" title="(key: LazyVals.this.global.Symbol)Int">lazyVals</a><span class="delimiter">(</span><a href="#507490" title="LazyVals.this.global.Symbol">enclosingClassOrDummyOrMethod</a><span class="delimiter">)</span>
            <a href="#507238" title="(key: LazyVals.this.global.Symbol, value: Int)Unit">lazyVals</a><span class="delimiter">(</span><a href="#507490" title="LazyVals.this.global.Symbol">enclosingClassOrDummyOrMethod</a><span class="delimiter">)</span> = <a href="#507491" title="Int">idx</a> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span>
            <span class="keyword">val</span> <a title="LazyVals.this.global.Tree" id="507492">rhs1</a> = <a href="#507244" title="(methOrClass: LazyVals.this.global.Symbol, tree: LazyVals.this.global.Tree, offset: Int, lazyVal: LazyVals.this.global.Symbol)LazyVals.this.global.Tree">mkLazyDef</a><span class="delimiter">(</span><a href="#507490" title="LazyVals.this.global.Symbol">enclosingClassOrDummyOrMethod</a>, <a href="#111822" title="LazyVals.this.LazyValues" class="keyword">super</a>.<a href="TypingTransformers.scala.html#501558" title="(tree: LazyVals.this.global.Tree)LazyVals.this.global.Tree">transform</a><span class="delimiter">(</span><a href="#507469" title="LazyVals.this.global.Tree">rhs</a><span class="delimiter">)</span>, <a href="#507491" title="Int">idx</a>, <a href="#507453" title="LazyVals.this.global.Symbol">sym</a><span class="delimiter">)</span>
            <a href="#507453" title="LazyVals.this.global.Symbol">sym</a>.<a href="../symtab/Symbols.scala.html#107554" title="(mask: Long)sym.type">resetFlag</a><span class="delimiter">(</span><span class="delimiter">(</span><span title="Long" class="keyword">if</span> <span class="delimiter">(</span><a href="#111819" title="(sym: LazyVals.this.global.Symbol)Boolean">lazyUnit</a><span class="delimiter">(</span><a href="#507453" title="LazyVals.this.global.Symbol">sym</a><span class="delimiter">)</span><span class="delimiter">)</span> <span title="Long(0L)" class="int">0</span> <span class="keyword">else</span> <span title="Long(2147483648L)">LAZY</span><span class="delimiter">)</span> <span title="(x: Int)Long">|</span> <span title="Int(134217728)">ACCESSOR</span><span class="delimiter">)</span>
            <a href="#507492" title="LazyVals.this.global.Tree">rhs1</a>
          <span class="delimiter">}</span> <span class="keyword">else</span>
            <a href="#111822" title="LazyVals.this.LazyValues" class="keyword">super</a>.<a href="TypingTransformers.scala.html#501558" title="(tree: LazyVals.this.global.Tree)LazyVals.this.global.Tree">transform</a><span class="delimiter">(</span><a href="#507469" title="LazyVals.this.global.Tree">rhs</a><span class="delimiter">)</span>

          <a href="../ast/Trees.scala.html#162568" title="=&gt; LazyVals.this.global.TreeCopier">treeCopy</a>.<a href="../ast/Trees.scala.html#162473" title="(tree: LazyVals.this.global.Tree, mods: LazyVals.this.global.Modifiers, name: LazyVals.this.global.Name, tparams: List[LazyVals.this.global.TypeDef], vparamss: List[List[LazyVals.this.global.ValDef]], tpt: LazyVals.this.global.Tree, rhs: LazyVals.this.global.Tree)LazyVals.this.global.DefDef">DefDef</a><span class="delimiter">(</span><a href="#507448" title="LazyVals.this.global.Tree">tree</a>, <a href="#507464" title="LazyVals.this.global.Modifiers">mods</a>, <a href="#507465" title="LazyVals.this.global.TermName">name</a>, <a href="#507466" title="List[LazyVals.this.global.TypeDef]">tparams</a>, <a href="#507467" title="List[List[LazyVals.this.global.ValDef]]">vparams</a>, <a href="#507468" title="LazyVals.this.global.Tree">tpt</a>,
                  <span title="LazyVals.this.global.Tree" class="keyword">if</span> <span class="delimiter">(</span><a href="#111820" title="object LazyVals.this.LocalLazyValFinder">LocalLazyValFinder</a>.<a href="#507266" title="(t: LazyVals.this.global.Tree)Boolean">find</a><span class="delimiter">(</span><a href="#507489" title="LazyVals.this.global.Tree">res</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../typechecker/Typers.scala.html#106063" title="(tree: LazyVals.this.global.analyzer.global.Tree)LazyVals.this.global.analyzer.global.Tree">typed</a><span class="delimiter">(</span><a href="#507243" title="(methSym: LazyVals.this.global.Symbol, rhs: LazyVals.this.global.Tree)LazyVals.this.global.Tree">addBitmapDefs</a><span class="delimiter">(</span><a href="#507453" title="LazyVals.this.global.Symbol">sym</a>, <a href="#507489" title="LazyVals.this.global.Tree">res</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="keyword">else</span> <a href="#507489" title="LazyVals.this.global.Tree">res</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>

        <span class="keyword">case</span> <span title="LazyVals.this.global.Template">Template</span><span class="delimiter">(</span><a title="List[LazyVals.this.global.Tree]" id="507593">parents</a>, <a title="LazyVals.this.global.ValDef" id="507594">self</a>, <a title="List[LazyVals.this.global.Tree]" id="507595">body</a><span class="delimiter">)</span> =&gt; <a href="TypingTransformers.scala.html#501552" title="(owner: LazyVals.this.global.Symbol)(trans: =&gt; LazyVals.this.global.Template)LazyVals.this.global.Template">atOwner</a><span class="delimiter">(</span><a href="../ast/Trees.scala.html#162570" title="=&gt; LazyVals.this.global.Symbol">currentOwner</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <span class="keyword">val</span> <a title="List[LazyVals.this.global.Tree]" id="507611">body1</a> = <a href="#111822" title="LazyVals.this.LazyValues" class="keyword">super</a>.<a href="../ast/Trees.scala.html#162577" title="(trees: List[LazyVals.this.global.Tree])List[LazyVals.this.global.Tree]">transformTrees</a><span class="delimiter">(</span><a href="#507595" title="List[LazyVals.this.global.Tree]">body</a><span class="delimiter">)</span>
          <span class="keyword">var</span> <a title="Boolean" id="507612">added</a> = <span title="Boolean(false)" class="keyword">false</span>
          <span class="keyword">val</span> <a title="List[LazyVals.this.global.analyzer.global.Tree]" id="507613">stats</a> = 
            <span class="keyword">for</span> <span class="delimiter">(</span><a title="LazyVals.this.global.Tree" id="507633">stat</a> &lt;- <a href="#507611" title="(f: LazyVals.this.global.Tree =&gt; LazyVals.this.global.analyzer.global.Tree)(implicit bf: scala.collection.generic.CanBuildFrom[List[LazyVals.this.global.Tree],LazyVals.this.global.analyzer.global.Tree,List[LazyVals.this.global.analyzer.global.Tree]])List[LazyVals.this.global.analyzer.global.Tree]">body1</a><span class="delimiter">)</span> <span class="keyword">yield</span> <a href="#507633" title="LazyVals.this.global.Tree">stat</a> <span title="LazyVals.this.global.analyzer.global.Tree" class="keyword">match</span> <span class="delimiter">{</span>
              <span class="keyword">case</span> <span title="LazyVals.this.global.analyzer.global.Tree">Block</span><span class="delimiter">(</span>_, _<span class="delimiter">)</span> | Apply<span class="delimiter">(</span>_, _<span class="delimiter">)</span> | If<span class="delimiter">(</span>_, _, _<span class="delimiter">)</span> <span class="keyword">if</span> <span title="=&gt; Boolean">!</span><a href="#507612" title="Boolean">added</a> =&gt;
                <span class="comment">// Avoid adding bitmaps when they are fully overshadowed by those</span>
                <span class="comment">// that are added inside loops</span>
                <span title="LazyVals.this.global.analyzer.global.Tree" class="keyword">if</span> <span class="delimiter">(</span><a href="#111820" title="object LazyVals.this.LocalLazyValFinder">LocalLazyValFinder</a>.<a href="#507266" title="(t: LazyVals.this.global.Tree)Boolean">find</a><span class="delimiter">(</span><a href="#507633" title="LazyVals.this.global.Tree">stat</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
                  <a href="#507612" title="Boolean">added</a> = <span title="Boolean(true)" class="keyword">true</span>
                  <a href="../typechecker/Typers.scala.html#106063" title="(tree: LazyVals.this.global.analyzer.global.Tree)LazyVals.this.global.analyzer.global.Tree">typed</a><span class="delimiter">(</span><a href="#507243" title="(methSym: LazyVals.this.global.Symbol, rhs: LazyVals.this.global.Tree)LazyVals.this.global.Tree">addBitmapDefs</a><span class="delimiter">(</span><a href="#507453" title="LazyVals.this.global.Symbol">sym</a>, <a href="#507633" title="LazyVals.this.global.Tree">stat</a><span class="delimiter">)</span><span class="delimiter">)</span>
                <span class="delimiter">}</span> <span class="keyword">else</span> <a href="#507633" title="LazyVals.this.global.Tree">stat</a>
              <span class="keyword">case</span> <span title="LazyVals.this.global.analyzer.global.Tree">ValDef</span><span class="delimiter">(</span><a title="LazyVals.this.global.Modifiers" id="507656">mods</a>, <a title="LazyVals.this.global.TermName" id="507657">name</a>, <a title="LazyVals.this.global.Tree" id="507658">tpt</a>, <a title="LazyVals.this.global.Tree" id="507659">rhs</a><span class="delimiter">)</span> =&gt;
                <a href="../typechecker/Typers.scala.html#106063" title="(tree: LazyVals.this.global.analyzer.global.Tree)LazyVals.this.global.analyzer.global.Tree">typed</a><span class="delimiter">(</span><a href="../ast/Trees.scala.html#162568" title="=&gt; LazyVals.this.global.TreeCopier">treeCopy</a>.<a href="../ast/Trees.scala.html#162472" title="(tree: LazyVals.this.global.Tree, mods: LazyVals.this.global.Modifiers, name: LazyVals.this.global.Name, tpt: LazyVals.this.global.Tree, rhs: LazyVals.this.global.Tree)LazyVals.this.global.ValDef">ValDef</a><span class="delimiter">(</span><a href="#507633" title="LazyVals.this.global.Tree">stat</a>, <a href="#507656" title="LazyVals.this.global.Modifiers">mods</a>, <a href="#507657" title="LazyVals.this.global.TermName">name</a>, <a href="#507658" title="LazyVals.this.global.Tree">tpt</a>, <a href="#507243" title="(methSym: LazyVals.this.global.Symbol, rhs: LazyVals.this.global.Tree)LazyVals.this.global.Tree">addBitmapDefs</a><span class="delimiter">(</span><a href="#507633" title="LazyVals.this.global.Tree">stat</a>.<span title="=&gt; LazyVals.this.global.Symbol">symbol</span>, <a href="#507659" title="LazyVals.this.global.Tree">rhs</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
              <span class="keyword">case</span> <span title="LazyVals.this.global.Tree">_</span> =&gt; 
                <a href="#507633" title="LazyVals.this.global.Tree">stat</a>
            <span class="delimiter">}</span>
          <span class="keyword">val</span> <a title="List[LazyVals.this.global.analyzer.global.Tree]" id="507614">innerClassBitmaps</a> = <span title="List[LazyVals.this.global.analyzer.global.Tree]" class="keyword">if</span> <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#507612" title="Boolean">added</a> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="../ast/Trees.scala.html#162570" title="=&gt; LazyVals.this.global.Symbol">currentOwner</a>.<span title="=&gt; Boolean">isClass</span> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#507246" title="=&gt; scala.collection.mutable.HashMap[LazyVals.this.global.Symbol,List[LazyVals.this.global.Symbol]]{def default(meth: LazyVals.this.global.Symbol): scala.collection.immutable.Nil.type}">bitmaps</a>.<span title="(key: LazyVals.this.global.Symbol)Boolean">contains</span><span class="delimiter">(</span><a href="../ast/Trees.scala.html#162570" title="=&gt; LazyVals.this.global.Symbol">currentOwner</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
              <span class="comment">// add bitmap to inner class if necessary</span>
                <span class="keyword">val</span> <a title="List[LazyVals.this.global.analyzer.global.Tree]" id="507695">toAdd0</a> = <a href="#507246" title="(key: LazyVals.this.global.Symbol)List[LazyVals.this.global.Symbol]">bitmaps</a><span class="delimiter">(</span><a href="../ast/Trees.scala.html#162570" title="=&gt; LazyVals.this.global.Symbol">currentOwner</a><span class="delimiter">)</span>.<span title="(f: LazyVals.this.global.Symbol =&gt; LazyVals.this.global.analyzer.global.Tree)(implicit bf: scala.collection.generic.CanBuildFrom[List[LazyVals.this.global.Symbol],LazyVals.this.global.analyzer.global.Tree,List[LazyVals.this.global.analyzer.global.Tree]])List[LazyVals.this.global.analyzer.global.Tree]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.List.Coll,LazyVals.this.global.analyzer.global.Tree,List[LazyVals.this.global.analyzer.global.Tree]]" class="delimiter">(</span><a title="LazyVals.this.global.Symbol" id="507725">s</a> =&gt; <a href="../typechecker/Typers.scala.html#106063" title="(tree: LazyVals.this.global.analyzer.global.Tree)LazyVals.this.global.analyzer.global.Tree">typed</a><span class="delimiter">(</span><a href="../ast/Trees.scala.html#67794" title="(sym: LazyVals.this.global.Symbol, rhs: LazyVals.this.global.Tree)LazyVals.this.global.ValDef">ValDef</a><span class="delimiter">(</span><a href="#507725" title="LazyVals.this.global.Symbol">s</a>, <a href="../ast/TreeDSL.scala.html#113950" title="=&gt; LazyVals.this.global.Literal">ZERO</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
                <a href="#507695" title="List[LazyVals.this.global.analyzer.global.Tree]">toAdd0</a>.<span title="(f: LazyVals.this.global.analyzer.global.Tree =&gt; Any)Unit">foreach</span><span class="delimiter">(</span><a title="LazyVals.this.global.analyzer.global.Tree" id="507788">t</a> =&gt; <span class="delimiter">{</span>
                    <span title="Any" class="keyword">if</span> <span class="delimiter">(</span><a href="../ast/Trees.scala.html#162570" title="=&gt; LazyVals.this.global.Symbol">currentOwner</a>.<a href="../symtab/Symbols.scala.html#107564" title="=&gt; LazyVals.this.global.Type">info</a>.<a href="../symtab/Types.scala.html#105488" title="(name: LazyVals.this.global.Name)LazyVals.this.global.Symbol">decl</a><span class="delimiter">(</span><a href="#507788" title="LazyVals.this.global.analyzer.global.Tree">t</a>.<span title="=&gt; LazyVals.this.global.analyzer.global.Symbol">symbol</span>.<a href="../symtab/Symbols.scala.html#107548" title="=&gt; LazyVals.this.global.analyzer.global.Name">name</a><span class="delimiter">)</span> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../symtab/Symbols.scala.html#67339" title="object LazyVals.this.global.NoSymbol">NoSymbol</a><span class="delimiter">)</span> <span class="delimiter">{</span>
                      <a href="#507788" title="LazyVals.this.global.analyzer.global.Tree">t</a>.<span title="=&gt; LazyVals.this.global.analyzer.global.Symbol">symbol</span>.<a href="../symtab/Symbols.scala.html#107553" title="(mask: Long)LazyVals.this.global.analyzer.global.Symbol">setFlag</a><span class="delimiter">(</span><span title="Long(1L)">PROTECTED</span><span class="delimiter">)</span>
                      <a href="../ast/Trees.scala.html#162570" title="=&gt; LazyVals.this.global.Symbol">currentOwner</a>.<a href="../symtab/Symbols.scala.html#107564" title="=&gt; LazyVals.this.global.Type">info</a>.<a href="../symtab/Types.scala.html#105487" title="=&gt; LazyVals.this.global.Scope">decls</a>.<a href="../symtab/Scopes.scala.html#113086" title="(sym: LazyVals.this.global.Symbol)LazyVals.this.global.Symbol">enter</a><span class="delimiter">(</span><a href="#507788" title="LazyVals.this.global.analyzer.global.Tree">t</a>.<span title="=&gt; LazyVals.this.global.analyzer.global.Symbol">symbol</span><span class="delimiter">)</span>
                    <span class="delimiter">}</span>
                <span class="delimiter">}</span><span class="delimiter">)</span>
                <a href="#507695" title="List[LazyVals.this.global.analyzer.global.Tree]">toAdd0</a>
            <span class="delimiter">}</span> <span class="keyword">else</span> List<span title="object Nil" class="delimiter">(</span><span class="delimiter">)</span>
          <a href="../ast/Trees.scala.html#162568" title="=&gt; LazyVals.this.global.TreeCopier">treeCopy</a>.<a href="../ast/Trees.scala.html#162478" title="(tree: LazyVals.this.global.Tree, parents: List[LazyVals.this.global.Tree], self: LazyVals.this.global.ValDef, body: List[LazyVals.this.global.Tree])LazyVals.this.global.Template">Template</a><span class="delimiter">(</span><a href="#507448" title="LazyVals.this.global.Tree">tree</a>, <a href="#507593" title="List[LazyVals.this.global.Tree]">parents</a>, <a href="#507594" title="LazyVals.this.global.ValDef">self</a>, <a href="#507614" title="List[LazyVals.this.global.analyzer.global.Tree]">innerClassBitmaps</a> <span title="(that: scala.collection.GenTraversableOnce[LazyVals.this.global.analyzer.global.Tree])(implicit bf: scala.collection.generic.CanBuildFrom[List[LazyVals.this.global.analyzer.global.Tree],LazyVals.this.global.analyzer.global.Tree,List[LazyVals.this.global.Tree]])List[LazyVals.this.global.Tree]">++</span> <a href="#507613" title="List[LazyVals.this.global.analyzer.global.Tree]">stats</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>

        <span class="keyword">case</span> <span title="LazyVals.this.global.ValDef">ValDef</span><span class="delimiter">(</span><a title="LazyVals.this.global.Modifiers" id="507911">mods</a>, <a title="LazyVals.this.global.TermName" id="507912">name</a>, <a title="LazyVals.this.global.Tree" id="507913">tpt</a>, <a title="LazyVals.this.global.Tree" id="507914">rhs0</a><span class="delimiter">)</span> <span class="keyword">if</span> <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#507453" title="LazyVals.this.global.Symbol">sym</a>.<a href="../symtab/Symbols.scala.html#107541" title="=&gt; LazyVals.this.global.Symbol">owner</a>.<span title="=&gt; Boolean">isModule</span> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <span title="=&gt; Boolean">!</span><a href="#507453" title="LazyVals.this.global.Symbol">sym</a>.<a href="../symtab/Symbols.scala.html#107541" title="=&gt; LazyVals.this.global.Symbol">owner</a>.<span title="=&gt; Boolean">isClass</span><span class="delimiter">)</span> =&gt;
          <span class="keyword">val</span> <a title="LazyVals.this.global.Tree" id="507915">rhs</a> = <a href="#111822" title="LazyVals.this.LazyValues" class="keyword">super</a>.<a href="TypingTransformers.scala.html#501558" title="(tree: LazyVals.this.global.Tree)LazyVals.this.global.Tree">transform</a><span class="delimiter">(</span><a href="#507914" title="LazyVals.this.global.Tree">rhs0</a><span class="delimiter">)</span>
          <a href="../ast/Trees.scala.html#162568" title="=&gt; LazyVals.this.global.TreeCopier">treeCopy</a>.<a href="../ast/Trees.scala.html#162472" title="(tree: LazyVals.this.global.Tree, mods: LazyVals.this.global.Modifiers, name: LazyVals.this.global.Name, tpt: LazyVals.this.global.Tree, rhs: LazyVals.this.global.Tree)LazyVals.this.global.ValDef">ValDef</a><span class="delimiter">(</span><a href="#507448" title="LazyVals.this.global.Tree">tree</a>, <a href="#507911" title="LazyVals.this.global.Modifiers">mods</a>, <a href="#507912" title="LazyVals.this.global.TermName">name</a>, <a href="#507913" title="LazyVals.this.global.Tree">tpt</a>,
                  <span title="LazyVals.this.global.Tree" class="keyword">if</span> <span class="delimiter">(</span><a href="#111820" title="object LazyVals.this.LocalLazyValFinder">LocalLazyValFinder</a>.<a href="#507266" title="(t: LazyVals.this.global.Tree)Boolean">find</a><span class="delimiter">(</span><a href="#507915" title="LazyVals.this.global.Tree">rhs</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../typechecker/Typers.scala.html#106063" title="(tree: LazyVals.this.global.analyzer.global.Tree)LazyVals.this.global.analyzer.global.Tree">typed</a><span class="delimiter">(</span><a href="#507243" title="(methSym: LazyVals.this.global.Symbol, rhs: LazyVals.this.global.Tree)LazyVals.this.global.Tree">addBitmapDefs</a><span class="delimiter">(</span><a href="#507453" title="LazyVals.this.global.Symbol">sym</a>, <a href="#507915" title="LazyVals.this.global.Tree">rhs</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="keyword">else</span> <a href="#507915" title="LazyVals.this.global.Tree">rhs</a><span class="delimiter">)</span>

        <span class="keyword">case</span> <a title="LazyVals.this.global.Tree" id="507925">l</a>@LabelDef<span class="delimiter">(</span><a title="LazyVals.this.global.TermName" id="507931">name0</a>, <a title="List[LazyVals.this.global.Ident]" id="507932">params0</a>, <a title="LazyVals.this.global.If" id="507933">ifp0</a>@If<span class="delimiter">(</span>_, _, _<span class="delimiter">)</span><span class="delimiter">)</span> <span class="keyword">if</span> <a href="#507931" title="LazyVals.this.global.TermName">name0</a>.<a href="../symtab/Names.scala.html#96627" title="(name: String)Boolean">startsWith</a><span class="delimiter">(</span><a href="../symtab/StdNames.scala.html#67724" title="object LazyVals.this.global.nme">nme</a>.<a href="../symtab/StdNames.scala.html#115662" title="=&gt; java.lang.String">WHILE_PREFIX</a><span class="delimiter">)</span> =&gt;
          <span class="keyword">val</span> <a title="LazyVals.this.global.Tree" id="507944">ifp1</a> = <a href="#111822" title="LazyVals.this.LazyValues" class="keyword">super</a>.<a href="TypingTransformers.scala.html#501558" title="(tree: LazyVals.this.global.Tree)LazyVals.this.global.Tree">transform</a><span class="delimiter">(</span><a href="#507933" title="LazyVals.this.global.If">ifp0</a><span class="delimiter">)</span>
          <span class="keyword">val</span> If<a href="#507946" title="(LazyVals.this.global.Tree, LazyVals.this.global.Tree, LazyVals.this.global.Tree)" class="delimiter">(</a><a href="#507945" title="LazyVals.this.global.Tree" id="507946">cond0</a>, <a href="#507945" title="LazyVals.this.global.Tree" id="507947">thenp0</a>, <a href="#507945" title="LazyVals.this.global.Tree" id="507948">elsep0</a><span class="delimiter">)</span> = <a href="#507944" title="LazyVals.this.global.Tree">ifp1</a> 
          <span title="LazyVals.this.global.Tree" class="keyword">if</span> <span class="delimiter">(</span><a href="#111820" title="object LazyVals.this.LocalLazyValFinder">LocalLazyValFinder</a>.<a href="#507266" title="(t: LazyVals.this.global.Tree)Boolean">find</a><span class="delimiter">(</span><a href="#507947" title="LazyVals.this.global.Tree">thenp0</a><span class="delimiter">)</span><span class="delimiter">)</span>
            <a href="../ast/Trees.scala.html#162568" title="=&gt; LazyVals.this.global.TreeCopier">treeCopy</a>.<a href="../ast/Trees.scala.html#162475" title="(tree: LazyVals.this.global.Tree, name: LazyVals.this.global.Name, params: List[LazyVals.this.global.Ident], rhs: LazyVals.this.global.Tree)LazyVals.this.global.LabelDef">LabelDef</a><span class="delimiter">(</span><a href="#507925" title="LazyVals.this.global.LabelDef">l</a>, <a href="#507931" title="LazyVals.this.global.TermName">name0</a>, <a href="#507932" title="List[LazyVals.this.global.Ident]">params0</a>,
                    <a href="../ast/Trees.scala.html#162568" title="=&gt; LazyVals.this.global.TreeCopier">treeCopy</a>.<a href="../ast/Trees.scala.html#162489" title="(tree: LazyVals.this.global.Tree, cond: LazyVals.this.global.Tree, thenp: LazyVals.this.global.Tree, elsep: LazyVals.this.global.Tree)LazyVals.this.global.If">If</a><span class="delimiter">(</span><a href="#507944" title="LazyVals.this.global.Tree">ifp1</a>, <a href="#507946" title="LazyVals.this.global.Tree">cond0</a>, <a href="../typechecker/Typers.scala.html#106063" title="(tree: LazyVals.this.global.analyzer.global.Tree)LazyVals.this.global.analyzer.global.Tree">typed</a><span class="delimiter">(</span><a href="#507243" title="(methSym: LazyVals.this.global.Symbol, rhs: LazyVals.this.global.Tree)LazyVals.this.global.Tree">addBitmapDefs</a><span class="delimiter">(</span><a href="#507453" title="LazyVals.this.global.Symbol">sym</a>.<a href="../symtab/Symbols.scala.html#107541" title="=&gt; LazyVals.this.global.Symbol">owner</a>, <a href="#507947" title="LazyVals.this.global.Tree">thenp0</a><span class="delimiter">)</span><span class="delimiter">)</span>, <a href="#507948" title="LazyVals.this.global.Tree">elsep0</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <span class="keyword">else</span>
            <a href="#507925" title="LazyVals.this.global.LabelDef">l</a>

        <span class="keyword">case</span> <a title="LazyVals.this.global.Tree" id="507981">l</a>@LabelDef<span class="delimiter">(</span><a title="LazyVals.this.global.TermName" id="507987">name0</a>, <a title="List[LazyVals.this.global.Ident]" id="507988">params0</a>, <a title="LazyVals.this.global.Block" id="507989">block</a>@Block<span class="delimiter">(</span><a title="List[LazyVals.this.global.Tree]" id="507994">stats0</a>, _<span class="delimiter">)</span><span class="delimiter">)</span>
          <span class="keyword">if</span> <a href="#507987" title="LazyVals.this.global.TermName">name0</a>.<a href="../symtab/Names.scala.html#96627" title="(name: String)Boolean">startsWith</a><span class="delimiter">(</span><a href="../symtab/StdNames.scala.html#67724" title="object LazyVals.this.global.nme">nme</a>.<a href="../symtab/StdNames.scala.html#115662" title="=&gt; java.lang.String">WHILE_PREFIX</a><span class="delimiter">)</span> <span title="(x: Boolean)Boolean">||</span> <a href="#507987" title="LazyVals.this.global.TermName">name0</a>.<a href="../symtab/Names.scala.html#96627" title="(name: String)Boolean">startsWith</a><span class="delimiter">(</span><a href="../symtab/StdNames.scala.html#67724" title="object LazyVals.this.global.nme">nme</a>.<a href="../symtab/StdNames.scala.html#115646" title="=&gt; java.lang.String">DO_WHILE_PREFIX</a><span class="delimiter">)</span> =&gt;
          <span class="keyword">val</span> <a title="List[LazyVals.this.global.Tree]" id="508006">stats1</a> = <a href="#111822" title="LazyVals.this.LazyValues" class="keyword">super</a>.<a href="../ast/Trees.scala.html#162577" title="(trees: List[LazyVals.this.global.Tree])List[LazyVals.this.global.Tree]">transformTrees</a><span class="delimiter">(</span><a href="#507994" title="List[LazyVals.this.global.Tree]">stats0</a><span class="delimiter">)</span>
          <span title="LazyVals.this.global.Tree" class="keyword">if</span> <span class="delimiter">(</span><a href="#111820" title="object LazyVals.this.LocalLazyValFinder">LocalLazyValFinder</a>.<a href="#507267" title="(ts: List[LazyVals.this.global.Tree])Boolean">find</a><span class="delimiter">(</span><a href="#508006" title="List[LazyVals.this.global.Tree]">stats1</a><span class="delimiter">)</span><span class="delimiter">)</span>
            <a href="../ast/Trees.scala.html#162568" title="=&gt; LazyVals.this.global.TreeCopier">treeCopy</a>.<a href="../ast/Trees.scala.html#162475" title="(tree: LazyVals.this.global.Tree, name: LazyVals.this.global.Name, params: List[LazyVals.this.global.Ident], rhs: LazyVals.this.global.Tree)LazyVals.this.global.LabelDef">LabelDef</a><span class="delimiter">(</span><a href="#507981" title="LazyVals.this.global.LabelDef">l</a>, <a href="#507987" title="LazyVals.this.global.TermName">name0</a>, <a href="#507988" title="List[LazyVals.this.global.Ident]">params0</a>,
                    <a href="../ast/Trees.scala.html#162568" title="=&gt; LazyVals.this.global.TreeCopier">treeCopy</a>.<a href="../ast/Trees.scala.html#162479" title="(tree: LazyVals.this.global.Tree, stats: List[LazyVals.this.global.Tree], expr: LazyVals.this.global.Tree)LazyVals.this.global.Block">Block</a><span class="delimiter">(</span><a href="#507989" title="LazyVals.this.global.Block">block</a>, <a href="../typechecker/Typers.scala.html#106063" title="(tree: LazyVals.this.global.analyzer.global.Tree)LazyVals.this.global.analyzer.global.Tree">typed</a><span class="delimiter">(</span><a href="#507243" title="(methSym: LazyVals.this.global.Symbol, rhs: LazyVals.this.global.Tree)LazyVals.this.global.Tree">addBitmapDefs</a><span class="delimiter">(</span><a href="#507453" title="LazyVals.this.global.Symbol">sym</a>.<a href="../symtab/Symbols.scala.html#107541" title="=&gt; LazyVals.this.global.Symbol">owner</a>, <a href="#508006" title="List[LazyVals.this.global.Tree]">stats1</a>.<span title="=&gt; LazyVals.this.global.Tree">head</span><span class="delimiter">)</span><span class="delimiter">)</span><a href="#508016" title="(x: LazyVals.this.global.Tree)List[LazyVals.this.global.Tree]">::</a><a href="#508006" title="List[LazyVals.this.global.Tree]">stats1</a>.<span title="=&gt; List[LazyVals.this.global.Tree]">tail</span>, <a href="#507989" title="LazyVals.this.global.Block">block</a>.<span title="=&gt; LazyVals.this.global.Tree">expr</span><span class="delimiter">)</span><span class="delimiter">)</span>
          <span class="keyword">else</span>
            <a href="#507981" title="LazyVals.this.global.LabelDef">l</a>

        <span class="keyword">case</span> <span title="LazyVals.this.global.Tree">_</span> =&gt; <a href="#111822" title="LazyVals.this.LazyValues" class="keyword">super</a>.<a href="TypingTransformers.scala.html#501558" title="(tree: LazyVals.this.global.Tree)LazyVals.this.global.Tree">transform</a><span class="delimiter">(</span><a href="#507448" title="LazyVals.this.global.Tree">tree</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <span class="comment">/** Add the bitmap definitions to the rhs of a method definition.
     *  If the rhs has been tail-call transformed, insert the bitmap
     *  definitions inside the top-level label definition, so that each
     *  iteration has the lazy values un-initialized. Otherwise add them
     *  at the very beginning of the method.
     */</span>
    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(methSym: LazyVals.this.global.Symbol, rhs: LazyVals.this.global.Tree)LazyVals.this.global.Tree" id="507243">addBitmapDefs</a><span class="delimiter">(</span><a title="LazyVals.this.global.Symbol" id="507576">methSym</a>: <a href="../symtab/Symbols.scala.html#67331" title="LazyVals.this.global.Symbol">Symbol</a>, <a title="LazyVals.this.global.Tree" id="507577">rhs</a>: <span title="LazyVals.this.global.Tree">Tree</span><span class="delimiter">)</span>: <span title="LazyVals.this.global.Tree">Tree</span> = <span class="delimiter">{</span>
      <span class="keyword">def</span> <a title="(stats: List[LazyVals.this.global.Tree], tree: LazyVals.this.global.Tree)LazyVals.this.global.Block" id="508027">prependStats</a><span class="delimiter">(</span><a title="List[LazyVals.this.global.Tree]" id="508030">stats</a>: <span title="List[LazyVals.this.global.Tree]">List</span><span class="delimiter">[</span>Tree<span class="delimiter">]</span>, <a title="LazyVals.this.global.Tree" id="508031">tree</a>: <span title="LazyVals.this.global.Tree">Tree</span><span class="delimiter">)</span>: <span title="LazyVals.this.global.Block">Block</span> = <a href="#508031" title="LazyVals.this.global.Tree">tree</a> <span title="LazyVals.this.global.Block" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <span title="LazyVals.this.global.Block">Block</span><span class="delimiter">(</span><a title="List[LazyVals.this.global.Tree]" id="508036">stats1</a>, <a title="LazyVals.this.global.Tree" id="508037">res</a><span class="delimiter">)</span> =&gt; <a href="../ast/TreeDSL.scala.html#105833" title="(stats: List[LazyVals.this.global.Tree], expr: LazyVals.this.global.Tree)LazyVals.this.global.Block">Block</a><span class="delimiter">(</span><a href="#508030" title="List[LazyVals.this.global.Tree]">stats</a> <a href="#508050" title="(prefix: List[LazyVals.this.global.Tree])List[LazyVals.this.global.Tree]">:::</a> <a href="#508036" title="List[LazyVals.this.global.Tree]">stats1</a>, <a href="#508037" title="LazyVals.this.global.Tree">res</a><span class="delimiter">)</span>
        <span class="keyword">case</span> <span title="LazyVals.this.global.Block">_</span> =&gt; <a href="../ast/TreeDSL.scala.html#105833" title="(stats: List[LazyVals.this.global.Tree], expr: LazyVals.this.global.Tree)LazyVals.this.global.Block">Block</a><span class="delimiter">(</span><a href="#508030" title="List[LazyVals.this.global.Tree]">stats</a>, <a href="#508031" title="LazyVals.this.global.Tree">tree</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>

      <span class="keyword">val</span> <a title="List[LazyVals.this.global.ValDef]" id="508028">bmps</a> = <a href="#507246" title="(key: LazyVals.this.global.Symbol)List[LazyVals.this.global.Symbol]">bitmaps</a><span class="delimiter">(</span><a href="#507576" title="LazyVals.this.global.Symbol">methSym</a><span class="delimiter">)</span> <span title="(f: LazyVals.this.global.Symbol =&gt; LazyVals.this.global.ValDef)(implicit bf: scala.collection.generic.CanBuildFrom[List[LazyVals.this.global.Symbol],LazyVals.this.global.ValDef,List[LazyVals.this.global.ValDef]])List[LazyVals.this.global.ValDef]">map</span> <span class="delimiter">(</span><a href="../ast/Trees.scala.html#67794" title="(sym: LazyVals.this.global.Symbol, rhs: LazyVals.this.global.Tree)LazyVals.this.global.ValDef">ValDef</a><span class="delimiter">(</span><a href="#508107" title="LazyVals.this.global.Symbol">_</a>, <a href="../ast/TreeDSL.scala.html#113950" title="=&gt; LazyVals.this.global.Literal">ZERO</a><span class="delimiter">)</span><span class="delimiter">)</span>

      <span class="keyword">def</span> <a title="(params: List[LazyVals.this.global.Ident])Boolean" id="508029">isMatch</a><span class="delimiter">(</span><a title="List[LazyVals.this.global.Ident]" id="508145">params</a>: <span title="List[LazyVals.this.global.Ident]">List</span><span class="delimiter">[</span>Ident<span class="delimiter">]</span><span class="delimiter">)</span> = <span class="delimiter">(</span><a href="#508145" title="List[LazyVals.this.global.Ident]">params</a>.<span title="=&gt; List[LazyVals.this.global.Ident]">tail</span> <span title="(that: scala.collection.GenSeq[LazyVals.this.global.Symbol])(p: (LazyVals.this.global.Ident, LazyVals.this.global.Symbol) =&gt; Boolean)Boolean">corresponds</span> <a href="#507576" title="LazyVals.this.global.Symbol">methSym</a>.<a href="../symtab/Symbols.scala.html#107562" title="=&gt; LazyVals.this.global.Type">tpe</a>.<a href="../symtab/Types.scala.html#105475" title="=&gt; List[LazyVals.this.global.Symbol]">params</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#508180" title="LazyVals.this.global.Ident">_</a>.<span title="=&gt; LazyVals.this.global.Type">tpe</span> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#508181" title="LazyVals.this.global.Symbol">_</a>.<a href="../symtab/Symbols.scala.html#107562" title="=&gt; LazyVals.this.global.Type">tpe</a><span class="delimiter">)</span>

      <span title="LazyVals.this.global.Tree" class="keyword">if</span> <span class="delimiter">(</span><a href="#508028" title="List[LazyVals.this.global.ValDef]">bmps</a>.<span title="=&gt; Boolean">isEmpty</span><span class="delimiter">)</span> <a href="#507577" title="LazyVals.this.global.Tree">rhs</a> <span class="keyword">else</span> <a href="#507577" title="LazyVals.this.global.Tree">rhs</a> <span title="LazyVals.this.global.Tree" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <span title="LazyVals.this.global.Block">Block</span><span class="delimiter">(</span><a title="List[LazyVals.this.global.Tree]" id="508191">assign</a>, <a title="LazyVals.this.global.LabelDef" id="508192">l</a> @ LabelDef<span class="delimiter">(</span><a title="LazyVals.this.global.TermName" id="508198">name</a>, <a title="List[LazyVals.this.global.Ident]" id="508199">params</a>, <a title="LazyVals.this.global.Tree" id="508200">rhs1</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <span class="keyword">if</span> <a href="#508198" title="LazyVals.this.global.TermName">name</a>.<a href="../symtab/Names.scala.html#96604" title="()String">toString</a> <span title="(x$1: AnyRef)Boolean">==</span> <span class="delimiter">(</span><span title="java.lang.String(&quot;_&quot;)" class="string">&quot;_&quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#507576" title="LazyVals.this.global.Symbol">methSym</a>.<a href="../symtab/Symbols.scala.html#107548" title="=&gt; LazyVals.this.global.Name">name</a><span class="delimiter">)</span> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#508029" title="(params: List[LazyVals.this.global.Ident])Boolean">isMatch</a><span class="delimiter">(</span><a href="#508199" title="List[LazyVals.this.global.Ident]">params</a><span class="delimiter">)</span> =&gt;
            <a href="../ast/TreeDSL.scala.html#105833" title="(stats: List[LazyVals.this.global.Tree], expr: LazyVals.this.global.Tree)LazyVals.this.global.Block">Block</a><span class="delimiter">(</span><a href="#508191" title="List[LazyVals.this.global.Tree]">assign</a>, <a href="../ast/Trees.scala.html#162568" title="=&gt; LazyVals.this.global.TreeCopier">treeCopy</a>.<a href="../ast/Trees.scala.html#162475" title="(tree: LazyVals.this.global.Tree, name: LazyVals.this.global.Name, params: List[LazyVals.this.global.Ident], rhs: LazyVals.this.global.Tree)LazyVals.this.global.LabelDef">LabelDef</a><span class="delimiter">(</span><a href="#508192" title="LazyVals.this.global.LabelDef">l</a>, <a href="#508198" title="LazyVals.this.global.TermName">name</a>, <a href="#508199" title="List[LazyVals.this.global.Ident]">params</a>, <a href="../typechecker/Typers.scala.html#106063" title="(tree: LazyVals.this.global.analyzer.global.Tree)LazyVals.this.global.analyzer.global.Tree">typed</a><span class="delimiter">(</span><a href="#508027" title="(stats: List[LazyVals.this.global.Tree], tree: LazyVals.this.global.Tree)LazyVals.this.global.Block">prependStats</a><span class="delimiter">(</span><a href="#508028" title="List[LazyVals.this.global.ValDef]">bmps</a>, <a href="#508200" title="LazyVals.this.global.Tree">rhs1</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>

        <span class="keyword">case</span> <span title="LazyVals.this.global.Block">_</span> =&gt; <a href="#508027" title="(stats: List[LazyVals.this.global.Tree], tree: LazyVals.this.global.Tree)LazyVals.this.global.Block">prependStats</a><span class="delimiter">(</span><a href="#508028" title="List[LazyVals.this.global.ValDef]">bmps</a>, <a href="#507577" title="LazyVals.this.global.Tree">rhs</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
    
    <span class="comment">/** return a 'lazified' version of rhs. Rhs should conform to the
     *  following schema:
     *  {
     *    l$ = &lt;rhs&gt; 
     *    l$
     *  } or
     *  &lt;rhs&gt; when the lazy value has type Unit (for which there is no field
     *  to cache it's value.
     * 
     *  The result will be a tree of the form
     *  {
     *    if ((bitmap$n &amp; MASK) == 0) {
     *       l$ = &lt;rhs&gt;
     *       bitmap$n = bimap$n | MASK
     *    }
     *    l$
     *  }
     *  where bitmap$n is an int value acting as a bitmap of initialized values. It is
     *  the 'n' is (offset / 32), the MASK is (1 &lt;&lt; (offset % 32)). If the value has type
     *  unit, no field is used to cache the value, so the resulting code is:
     *  {
     *    if ((bitmap$n &amp; MASK) == 0) {
     *       &lt;rhs&gt;;
     *       bitmap$n = bimap$n | MASK
     *    }
     *    ()
     *  }
     */</span>
    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(methOrClass: LazyVals.this.global.Symbol, tree: LazyVals.this.global.Tree, offset: Int, lazyVal: LazyVals.this.global.Symbol)LazyVals.this.global.Tree" id="507244">mkLazyDef</a><span class="delimiter">(</span><a title="LazyVals.this.global.Symbol" id="507542">methOrClass</a>: <a href="../symtab/Symbols.scala.html#67331" title="LazyVals.this.global.Symbol">Symbol</a>, <a title="LazyVals.this.global.Tree" id="507543">tree</a>: <span title="LazyVals.this.global.Tree">Tree</span>, <a title="Int" id="507544">offset</a>: <span title="Int">Int</span>, <a title="LazyVals.this.global.Symbol" id="507545">lazyVal</a>: <a href="../symtab/Symbols.scala.html#67331" title="LazyVals.this.global.Symbol">Symbol</a><span class="delimiter">)</span>: <span title="LazyVals.this.global.Tree">Tree</span> = <span class="delimiter">{</span>      
      <span class="keyword">val</span> <a title="LazyVals.this.global.Symbol" id="508224">bitmapSym</a>           = <a href="#507248" title="(meth: LazyVals.this.global.Symbol, offset: Int)LazyVals.this.global.Symbol">getBitmapFor</a><span class="delimiter">(</span><a href="#507542" title="LazyVals.this.global.Symbol">methOrClass</a>, <a href="#507544" title="Int">offset</a><span class="delimiter">)</span>
      <span class="keyword">val</span> <a title="LazyVals.this.global.Literal" id="508225">mask</a>                = <a href="../ast/TreeDSL.scala.html#149354" title="(x: Any)LazyVals.this.global.Literal">LIT</a><span class="delimiter">(</span><span title="Int(1)" class="int">1</span> <span title="(x: Int)Int">&lt;&lt;</span> <span class="delimiter">(</span><a href="#507544" title="Int">offset</a> <span title="(x: Int)Int">%</span> <a href="#111817" title="=&gt; Int">FLAGS_PER_WORD</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">val</span> <a title="&lt;none&gt; extends LazyVals.this.global.RefTree with Serializable" id="508226">bitmapRef</a> = <span title="&lt;none&gt; extends LazyVals.this.global.RefTree with Serializable" class="keyword">if</span> <span class="delimiter">(</span><a href="#507542" title="LazyVals.this.global.Symbol">methOrClass</a>.<span title="=&gt; Boolean">isClass</span><span class="delimiter">)</span> <a href="../ast/Trees.scala.html#67812" title="(qualifier: LazyVals.this.global.Tree, sym: LazyVals.this.global.Symbol)LazyVals.this.global.Select">Select</a><span class="delimiter">(</span><a href="../ast/Trees.scala.html#67811" title="(sym: LazyVals.this.global.Symbol)LazyVals.this.global.Tree">This</a><span class="delimiter">(</span><a href="#507542" title="LazyVals.this.global.Symbol">methOrClass</a><span class="delimiter">)</span>, <a href="#508224" title="LazyVals.this.global.Symbol">bitmapSym</a><span class="delimiter">)</span> <span class="keyword">else</span> <a href="../ast/Trees.scala.html#67813" title="(sym: LazyVals.this.global.Symbol)LazyVals.this.global.Ident">Ident</a><span class="delimiter">(</span><a href="#508224" title="LazyVals.this.global.Symbol">bitmapSym</a><span class="delimiter">)</span>

      <span class="keyword">def</span> <a title="(stmt: LazyVals.this.global.Tree)LazyVals.this.global.Block" id="508227">mkBlock</a><span class="delimiter">(</span><a title="LazyVals.this.global.Tree" id="508304">stmt</a>: <span title="LazyVals.this.global.Tree">Tree</span><span class="delimiter">)</span> = <a href="../ast/TreeDSL.scala.html#113998" title="(xs: LazyVals.this.global.Tree*)LazyVals.this.global.Block">BLOCK</a><span class="delimiter">(</span><a href="#508304" title="LazyVals.this.global.Tree">stmt</a>, <a href="#507245" title="(bmp: LazyVals.this.global.Symbol, mask: LazyVals.this.global.Tree, bmpRef: LazyVals.this.global.Tree)LazyVals.this.global.Tree">mkSetFlag</a><span class="delimiter">(</span><a href="#508224" title="LazyVals.this.global.Symbol">bitmapSym</a>, <a href="#508225" title="LazyVals.this.global.Literal">mask</a>, <a href="#508226" title="&lt;none&gt; extends LazyVals.this.global.RefTree with Serializable">bitmapRef</a><span class="delimiter">)</span>, <a href="../ast/TreeDSL.scala.html#113953" title="=&gt; LazyVals.this.global.Literal">UNIT</a><span class="delimiter">)</span>


      <span class="keyword">val</span> <a href="#508229" title="(LazyVals.this.global.Block, LazyVals.this.global.Tree)" class="delimiter">(</a><a href="#508228" title="LazyVals.this.global.Block" id="508229">block</a>, <a href="#508228" title="LazyVals.this.global.Tree" id="508230">res</a><span class="delimiter">)</span> = <a href="#507543" title="LazyVals.this.global.Tree">tree</a> <span title="(LazyVals.this.global.Block, LazyVals.this.global.Tree)" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <span title="(LazyVals.this.global.Block, LazyVals.this.global.Tree)">Block</span><span class="delimiter">(</span><a href="#508315" title="(x: List[LazyVals.this.global.Tree])Some[List[LazyVals.this.global.Tree]]">List</a><span class="delimiter">(</span><a title="LazyVals.this.global.Tree" id="508326">assignment</a><span class="delimiter">)</span>, <a title="LazyVals.this.global.Tree" id="508327">res</a><span class="delimiter">)</span> <span class="keyword">if</span> <span title="=&gt; Boolean">!</span><a href="#111819" title="(sym: LazyVals.this.global.Symbol)Boolean">lazyUnit</a><span class="delimiter">(</span><a href="#507545" title="LazyVals.this.global.Symbol">lazyVal</a><span class="delimiter">)</span> =&gt;
          <span title="(_1: LazyVals.this.global.Block, _2: LazyVals.this.global.Tree)(LazyVals.this.global.Block, LazyVals.this.global.Tree)" class="delimiter">(</span><a href="#508227" title="(stmt: LazyVals.this.global.Tree)LazyVals.this.global.Block">mkBlock</a><span class="delimiter">(</span><a href="#508326" title="LazyVals.this.global.Tree">assignment</a><span class="delimiter">)</span>,  <a href="#508327" title="LazyVals.this.global.Tree">res</a><span class="delimiter">)</span>
        <span class="keyword">case</span> <a title="(LazyVals.this.global.Block, LazyVals.this.global.Literal)" id="508334">rhs</a>                          =&gt;
          <span title="(_1: LazyVals.this.global.Block, _2: LazyVals.this.global.Literal)(LazyVals.this.global.Block, LazyVals.this.global.Literal)" class="delimiter">(</span><a href="#508227" title="(stmt: LazyVals.this.global.Tree)LazyVals.this.global.Block">mkBlock</a><span class="delimiter">(</span><a href="#508334" title="LazyVals.this.global.Tree">rhs</a><span class="delimiter">)</span>,         <a href="../ast/TreeDSL.scala.html#113953" title="=&gt; LazyVals.this.global.Literal">UNIT</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
      
      <span class="keyword">val</span> <a title="LazyVals.this.global.Apply" id="508231">cond</a> = <span class="delimiter">(</span><a href="../ast/TreeDSL.scala.html#114008" title="implicit scala.tools.nsc.ast.TreeDSL.CODE.mkTreeMethods : (target: LazyVals.this.global.Tree)LazyVals.this.CODE.TreeMethods">bitmapRef</a> <a href="../ast/TreeDSL.scala.html#114008" title="implicit scala.tools.nsc.ast.TreeDSL.CODE.mkTreeMethods : (target: LazyVals.this.global.Tree)LazyVals.this.CODE.TreeMethods">INT_&amp;</a> <a href="#508225" title="LazyVals.this.global.Literal">mask</a><span class="delimiter">)</span> <a href="../ast/TreeDSL.scala.html#149435" title="(other: LazyVals.this.global.Tree)LazyVals.this.global.Apply">INT_==</a> <a href="../ast/TreeDSL.scala.html#113950" title="=&gt; LazyVals.this.global.Literal">ZERO</a>

      <a href="../ast/Trees.scala.html#67851" title="(pos: LazyVals.this.global.Position)(tree: LazyVals.this.global.analyzer.global.Tree)LazyVals.this.global.analyzer.global.Tree">atPos</a><span class="delimiter">(</span><a href="#507543" title="LazyVals.this.global.Tree">tree</a>.<span title="=&gt; LazyVals.this.global.Position">pos</span><span class="delimiter">)</span><span class="delimiter">(</span><a href="TypingTransformers.scala.html#501543" title="=&gt; LazyVals.this.global.analyzer.Typer">localTyper</a>.<a href="../typechecker/Typers.scala.html#106063" title="(tree: LazyVals.this.global.analyzer.global.Tree)LazyVals.this.global.analyzer.global.Tree">typed</a> <span class="delimiter">{</span>
        <span class="keyword">def</span> <a title="=&gt; LazyVals.this.global.gen.global.Tree" id="508378">body</a> = <a href="../Global.scala.html#64843" title="object LazyVals.this.global.gen">gen</a>.<a href="../ast/TreeGen.scala.html#105611" title="(clazz: LazyVals.this.global.gen.global.Symbol, cond: LazyVals.this.global.gen.global.Tree, syncBody: List[LazyVals.this.global.gen.global.Tree], stats: List[LazyVals.this.global.gen.global.Tree])LazyVals.this.global.gen.global.Tree">mkDoubleCheckedLocking</a><span class="delimiter">(</span><a href="#507542" title="LazyVals.this.global.Symbol">methOrClass</a>.<span title="=&gt; LazyVals.this.global.Symbol">enclClass</span>, <a href="#508231" title="LazyVals.this.global.Apply">cond</a>, <span title="(xs: LazyVals.this.global.Block*)List[LazyVals.this.global.Block]">List</span><span class="delimiter">(</span><a href="#508229" title="LazyVals.this.global.Block">block</a><span class="delimiter">)</span>, <span title="object Nil">Nil</span><span class="delimiter">)</span>
        <a href="../ast/TreeDSL.scala.html#113998" title="(xs: LazyVals.this.global.Tree*)LazyVals.this.global.Block">BLOCK</a><span class="delimiter">(</span><a href="#508378" title="=&gt; LazyVals.this.global.gen.global.Tree">body</a>, <a href="#508230" title="LazyVals.this.global.Tree">res</a><span class="delimiter">)</span>
      <span class="delimiter">}</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
     
    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(bmp: LazyVals.this.global.Symbol, mask: LazyVals.this.global.Tree, bmpRef: LazyVals.this.global.Tree)LazyVals.this.global.Tree" id="507245">mkSetFlag</a><span class="delimiter">(</span><a title="LazyVals.this.global.Symbol" id="508306">bmp</a>: <a href="../symtab/Symbols.scala.html#67331" title="LazyVals.this.global.Symbol">Symbol</a>, <a title="LazyVals.this.global.Tree" id="508307">mask</a>: <span title="LazyVals.this.global.Tree">Tree</span>, <a title="LazyVals.this.global.Tree" id="508308">bmpRef</a>: <span title="LazyVals.this.global.Tree">Tree</span><span class="delimiter">)</span>: <span title="LazyVals.this.global.Tree">Tree</span> =
      <a href="../ast/TreeDSL.scala.html#114008" title="implicit scala.tools.nsc.ast.TreeDSL.CODE.mkTreeMethods : (target: LazyVals.this.global.Tree)LazyVals.this.CODE.TreeMethods">bmpRef</a> <a href="../ast/TreeDSL.scala.html#149444" title="(rhs: LazyVals.this.global.Tree)LazyVals.this.global.Assign">===</a> <span class="delimiter">(</span><a href="../ast/TreeDSL.scala.html#114008" title="implicit scala.tools.nsc.ast.TreeDSL.CODE.mkTreeMethods : (target: LazyVals.this.global.Tree)LazyVals.this.CODE.TreeMethods">bmpRef</a> <a href="../ast/TreeDSL.scala.html#149432" title="(other: LazyVals.this.global.Tree)LazyVals.this.global.Apply">INT_|</a> <a href="#508307" title="LazyVals.this.global.Tree">mask</a><span class="delimiter">)</span>
    
    <span class="keyword">val</span> <a title="bitmaps extends scala.collection.mutable.HashMap[LazyVals.this.global.Symbol,List[LazyVals.this.global.Symbol]]" id="507246">bitmaps</a> = <a href="#507403" title="scala.collection.mutable.HashMap[LazyVals.this.global.Symbol,List[LazyVals.this.global.Symbol]]" class="keyword">new</a> <a title="anonymous class $anon extends scala.collection.mutable.HashMap[LazyVals.this.global.Symbol,List[LazyVals.this.global.Symbol]]" id="507403">mutable</a>.<span title="scala.collection.mutable.HashMap[LazyVals.this.global.Symbol,List[LazyVals.this.global.Symbol]]">HashMap</span><span class="delimiter">[</span>Symbol, List<span class="delimiter">[</span>Symbol<span class="delimiter">]</span><span class="delimiter">]</span> <span class="delimiter">{</span>
      <span class="keyword">override</span> <span class="keyword">def</span> <a title="(meth: LazyVals.this.global.Symbol)scala.collection.immutable.Nil.type" id="507405">default</a><span class="delimiter">(</span><a title="LazyVals.this.global.Symbol" id="507406">meth</a>: <a href="../symtab/Symbols.scala.html#67331" title="LazyVals.this.global.Symbol">Symbol</a><span class="delimiter">)</span> = <span title="object Nil">Nil</span>
    <span class="delimiter">}</span>
    
    <span class="comment">/** Return the symbol corresponding of the right bitmap int inside meth,
     *  given offset.
     */</span>
    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(meth: LazyVals.this.global.Symbol, offset: Int)LazyVals.this.global.Symbol" id="507248">getBitmapFor</a><span class="delimiter">(</span><a title="LazyVals.this.global.Symbol" id="508232">meth</a>: <a href="../symtab/Symbols.scala.html#67331" title="LazyVals.this.global.Symbol">Symbol</a>, <a title="Int" id="508233">offset</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <a href="../symtab/Symbols.scala.html#67331" title="LazyVals.this.global.Symbol">Symbol</a> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="Int" id="508413">n</a> = <a href="#508233" title="Int">offset</a> <span title="(x: Int)Int">/</span> <a href="#111817" title="=&gt; Int">FLAGS_PER_WORD</a>
      <span class="keyword">val</span> <a title="List[LazyVals.this.global.Symbol]" id="508414">bmps</a> = <a href="#507246" title="(key: LazyVals.this.global.Symbol)List[LazyVals.this.global.Symbol]">bitmaps</a><span class="delimiter">(</span><a href="#508232" title="LazyVals.this.global.Symbol">meth</a><span class="delimiter">)</span>
      <span title="LazyVals.this.global.Symbol" class="keyword">if</span> <span class="delimiter">(</span><a href="#508414" title="List[LazyVals.this.global.Symbol]">bmps</a>.<span title="=&gt; Int">length</span> <span title="(x: Int)Boolean">&gt;</span> <a href="#508413" title="Int">n</a><span class="delimiter">)</span> 
        <a href="#508414" title="(n: Int)LazyVals.this.global.Symbol">bmps</a><span class="delimiter">(</span><a href="#508413" title="Int">n</a><span class="delimiter">)</span>
      <span class="keyword">else</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="LazyVals.this.global.TermSymbol" id="508436">sym</a> = <a href="#508232" title="LazyVals.this.global.Symbol">meth</a>.<a href="../symtab/Symbols.scala.html#107422" title="(pos: LazyVals.this.global.Position, name: LazyVals.this.global.TermName)LazyVals.this.global.TermSymbol">newVariable</a><span class="delimiter">(</span><a href="#508232" title="LazyVals.this.global.Symbol">meth</a>.<a href="../symtab/Symbols.scala.html#107404" title="=&gt; LazyVals.this.global.Position">pos</a>, <a href="../symtab/StdNames.scala.html#67724" title="object LazyVals.this.global.nme">nme</a>.<a href="../symtab/StdNames.scala.html#115635" title="(n: Int)LazyVals.this.global.TermName">bitmapName</a><span class="delimiter">(</span><a href="#508413" title="Int">n</a><span class="delimiter">)</span><span class="delimiter">)</span>.<a href="../symtab/Symbols.scala.html#107566" title="(info: LazyVals.this.global.Type)LazyVals.this.global.TermSymbol">setInfo</a><span class="delimiter">(</span><a href="../symtab/Definitions.scala.html#106726" title="=&gt; LazyVals.this.global.Symbol">IntClass</a>.<a href="../symtab/Symbols.scala.html#107562" title="=&gt; LazyVals.this.global.Type">tpe</a><span class="delimiter">)</span>
        <a href="../symtab/SymbolTable.scala.html#64815" title="(ph: scala.tools.nsc.Phase)(op: =&gt; Unit)Unit">atPhase</a><span class="delimiter">(</span><a href="../Global.scala.html#64991" title="=&gt; LazyVals.this.global.Run">currentRun</a>.<a href="../Global.scala.html#72332" title="=&gt; scala.tools.nsc.Phase">typerPhase</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="#508436" title="LazyVals.this.global.TermSymbol">sym</a> <a href="../symtab/Symbols.scala.html#107413" title="(annot: LazyVals.this.global.AnnotationInfo)Unit">addAnnotation</a> <a href="../symtab/AnnotationInfos.scala.html#134310" title="(atp: LazyVals.this.global.Type, args: List[LazyVals.this.global.Tree], assocs: List[(LazyVals.this.global.Name, LazyVals.this.global.ClassfileAnnotArg)])LazyVals.this.global.AnnotationInfo">AnnotationInfo</a><span class="delimiter">(</span><a href="../symtab/Definitions.scala.html#106630" title="=&gt; LazyVals.this.global.Symbol">VolatileAttr</a>.<a href="../symtab/Symbols.scala.html#107562" title="=&gt; LazyVals.this.global.Type">tpe</a>, <span title="object Nil">Nil</span>, <span title="object Nil">Nil</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>
        
        <a href="#507246" title="(key: LazyVals.this.global.Symbol, value: List[LazyVals.this.global.Symbol])Unit">bitmaps</a><span class="delimiter">(</span><a href="#508232" title="LazyVals.this.global.Symbol">meth</a><span class="delimiter">)</span> = <span class="delimiter">(</span><a href="#508436" title="LazyVals.this.global.TermSymbol">sym</a> <a href="#508461" title="(x: LazyVals.this.global.Symbol)List[LazyVals.this.global.Symbol]">::</a> <a href="#508414" title="List[LazyVals.this.global.Symbol]">bmps</a><span class="delimiter">)</span>.<span title="=&gt; List[LazyVals.this.global.Symbol]">reverse</span>
        <a href="#508436" title="LazyVals.this.global.TermSymbol">sym</a>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>