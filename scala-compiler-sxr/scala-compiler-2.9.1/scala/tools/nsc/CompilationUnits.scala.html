<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>scala/tools/nsc/CompilationUnits.scala</title>
        <script type="text/javascript" src="../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/* NSC -- new Scala compiler
 * Copyright 2005-2011 LAMP/EPFL
 * @author  Martin Odersky
 */</span>

<span class="keyword">package</span> scala.tools.nsc

<span class="keyword">import</span> util.<span class="delimiter">{</span> FreshNameCreator,Position,NoPosition,SourceFile <span class="delimiter">}</span>
<span class="keyword">import</span> scala.collection.mutable.<span class="delimiter">{</span> LinkedHashSet, HashSet, HashMap, ListBuffer <span class="delimiter">}</span>

<span class="keyword">trait</span> <a title="trait CompilationUnits extends java.lang.Object with ScalaObject" id="10978">CompilationUnits</a> <span title="ScalaObject" class="delimiter">{</span> self: Global =&gt;

  <span class="comment">/** One unit of compilation that has been submitted to the compiler.
    * It typically corresponds to a single file of source code.  It includes
    * error-reporting hooks.  */</span>
  <span class="keyword">class</span> <a title="class CompilationUnit extends java.lang.Object with CompilationUnits.this.CompilationUnitTrait with ScalaObject" id="67942">CompilationUnit</a><a href="#67942" title="ScalaObject" class="delimiter">(</a><span class="keyword">val</span> <a title="scala.tools.nsc.util.SourceFile" id="96444">source</a>: <a href="util/SourceFile.scala.html#30392" title="scala.tools.nsc.util.SourceFile">SourceFile</a><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="ast/Trees.scala.html#67768" title="CompilationUnits.this.CompilationUnitTrait">CompilationUnitTrait</a> <span class="delimiter">{</span>

    <span class="comment">/** the fresh name creator */</span>
    <span class="keyword">var</span> <a title="scala.tools.nsc.util.FreshNameCreator" id="96406">fresh</a>: <a href="util/FreshNameCreator.scala.html#30437" title="scala.tools.nsc.util.FreshNameCreator">FreshNameCreator</a> = <span title="scala.tools.nsc.util.FreshNameCreator.Default" class="keyword">new</span> <a href="util/FreshNameCreator.scala.html#30438" title="object scala.tools.nsc.util.FreshNameCreator">FreshNameCreator</a>.<a href="util/FreshNameCreator.scala.html#97153" title="scala.tools.nsc.util.FreshNameCreator.Default">Default</a>
    
    <span class="keyword">def</span> <a title="(prefix: String)CompilationUnits.this.TermName" id="96408">freshTermName</a><span class="delimiter">(</span><a title="String" id="97162">prefix</a>: <span title="String">String</span><span class="delimiter">)</span>: <a href="symtab/Names.scala.html#66915" title="CompilationUnits.this.TermName">TermName</a> = <a href="symtab/Names.scala.html#66903" title="(s: String)CompilationUnits.this.TermName">newTermName</a><span class="delimiter">(</span><a href="#96406" title="=&gt; scala.tools.nsc.util.FreshNameCreator">fresh</a>.<a href="util/FreshNameCreator.scala.html#96668" title="(prefix: String)String">newName</a><span class="delimiter">(</span><a href="#97162" title="String">prefix</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="keyword">def</span> <a title="(prefix: String)CompilationUnits.this.TypeName" id="96409">freshTypeName</a><span class="delimiter">(</span><a title="String" id="97229">prefix</a>: <span title="String">String</span><span class="delimiter">)</span>: <a href="symtab/Names.scala.html#66916" title="CompilationUnits.this.TypeName">TypeName</a> = <a href="symtab/Names.scala.html#66906" title="(s: String)CompilationUnits.this.TypeName">newTypeName</a><span class="delimiter">(</span><a href="#96406" title="=&gt; scala.tools.nsc.util.FreshNameCreator">fresh</a>.<a href="util/FreshNameCreator.scala.html#96668" title="(prefix: String)String">newName</a><span class="delimiter">(</span><a href="#97229" title="String">prefix</a><span class="delimiter">)</span><span class="delimiter">)</span>

    <span class="comment">/** the content of the compilation unit in tree form */</span>
    <span class="keyword">var</span> <a title="CompilationUnits.this.Tree" id="96411">body</a>: <span title="CompilationUnits.this.Tree">Tree</span> = <a href="#10978" title="object CompilationUnits.this.EmptyTree">EmptyTree</a>
    
    <span class="comment">/** representation for a source code comment, includes 
     * '//' or '/*' '*/' in the value and the position
     */</span>
    case <span class="keyword">class</span> <a title="class Comment extends java.lang.Object with ScalaObject with Product with Serializable" id="97301">Comment</a><a href="#97301" title="ScalaObject" class="delimiter">(</a><a title="String" id="97564">text</a>: <span title="String">String</span>, <a title="CompilationUnits.this.Position" id="97565">pos</a>: <a href="util/Position.scala.html#30599" title="CompilationUnits.this.Position">Position</a><span class="delimiter">)</span>
        
    <span class="comment">/** all comments found in this compilation unit */</span>
    <span class="keyword">val</span> <a title="scala.collection.mutable.ListBuffer[CompilationUnit.this.Comment]" id="96416">comments</a> = <span title="scala.collection.mutable.ListBuffer[CompilationUnit.this.Comment]" class="keyword">new</span> <span title="scala.collection.mutable.ListBuffer[CompilationUnit.this.Comment]">ListBuffer</span><span class="delimiter">[</span>Comment<span class="delimiter">]</span>

<span class="comment">//    def parseSettings() = {</span>
<span class="comment">//      val argsmarker = &quot;SCALAC_ARGS&quot;</span>
<span class="comment">//      if(comments nonEmpty) {</span>
<span class="comment">//        val pragmas = comments find (_.text.startsWith(&quot;//#&quot;)) // only parse first one</span>
<span class="comment">//        pragmas foreach { p =&gt;</span>
<span class="comment">//          val i = p.text.indexOf(argsmarker)</span>
<span class="comment">//          if(i &gt; 0)</span>
<span class="comment">//        }</span>
<span class="comment">//      }</span>
<span class="comment">//    }</span>
    <span class="comment">/** Note: depends now contains toplevel classes.
     *  To get their sourcefiles, you need to dereference with .sourcefile
     */</span>
    <span class="keyword">val</span> <a title="scala.collection.mutable.HashSet[CompilationUnits.this.Symbol]" id="96418">depends</a> = <span title="()scala.collection.mutable.HashSet[CompilationUnits.this.Symbol]" class="keyword">new</span> <span title="scala.collection.mutable.HashSet[CompilationUnits.this.Symbol]">HashSet</span><span class="delimiter">[</span>Symbol<span class="delimiter">]</span>

    <span class="comment">/** so we can relink 
     */</span>
    <span class="keyword">val</span> <a title="scala.collection.mutable.HashSet[CompilationUnits.this.Symbol]" id="96420">defined</a> = <span title="()scala.collection.mutable.HashSet[CompilationUnits.this.Symbol]" class="keyword">new</span> <span title="scala.collection.mutable.HashSet[CompilationUnits.this.Symbol]">HashSet</span><span class="delimiter">[</span>Symbol<span class="delimiter">]</span>

    <span class="comment">/** Synthetic definitions generated by namer, eliminated by typer.
     */</span>
    <span class="keyword">val</span> <a title="scala.collection.mutable.HashMap[CompilationUnits.this.Symbol,CompilationUnits.this.Tree]" id="96422">synthetics</a> = <span title="()scala.collection.mutable.HashMap[CompilationUnits.this.Symbol,CompilationUnits.this.Tree]" class="keyword">new</span> <span title="scala.collection.mutable.HashMap[CompilationUnits.this.Symbol,CompilationUnits.this.Tree]">HashMap</span><span class="delimiter">[</span>Symbol, Tree<span class="delimiter">]</span>

    <span class="comment">/** things to check at end of compilation unit */</span>
    <span class="keyword">val</span> <a title="scala.collection.mutable.ListBuffer[() =&gt; Unit]" id="96424">toCheck</a> = <span title="scala.collection.mutable.ListBuffer[() =&gt; Unit]" class="keyword">new</span> <span title="scala.collection.mutable.ListBuffer[() =&gt; Unit]">ListBuffer</span><span class="delimiter">[</span><span class="delimiter">(</span><span class="delimiter">)</span> =&gt; Unit<span class="delimiter">]</span>

    <span class="keyword">def</span> <a title="(pos: Int)scala.tools.nsc.util.Position" id="96426">position</a><span class="delimiter">(</span><a title="Int" id="97344">pos</a>: <span title="Int">Int</span><span class="delimiter">)</span> = <a href="#96444" title="=&gt; scala.tools.nsc.util.SourceFile">source</a>.<a href="util/SourceFile.scala.html#96504" title="(offset: Int)scala.tools.nsc.util.Position">position</a><span class="delimiter">(</span><a href="#97344" title="Int">pos</a><span class="delimiter">)</span>

    <span class="comment">/** The position of a targeted type check
     *  If this is different from NoPosition, the type checking
     *  will stop once a tree that contains this position range
     *  is fully attributed.
     */</span>
    <span class="keyword">def</span> <a title="=&gt; CompilationUnits.this.Position" id="96427">targetPos</a>: <a href="util/Position.scala.html#30599" title="CompilationUnits.this.Position">Position</a> = <a href="symtab/Positions.scala.html#67891" title="=&gt; tools.nsc.util.NoPosition.type">NoPosition</a>

    <span class="comment">/** The icode representation of classes in this compilation unit.
     *  It is empty up to phase 'icode'.
     */</span>
    <span class="keyword">val</span> <a title="scala.collection.mutable.LinkedHashSet[CompilationUnits.this.icodes.IClass]" id="96428">icode</a>: <span title="scala.collection.mutable.LinkedHashSet[CompilationUnits.this.icodes.IClass]">LinkedHashSet</span><span class="delimiter">[</span>icodes.IClass<span class="delimiter">]</span> = <span title="scala.collection.mutable.LinkedHashSet[CompilationUnits.this.icodes.IClass]" class="keyword">new</span> <span title="scala.collection.mutable.LinkedHashSet[CompilationUnits.this.icodes.IClass]">LinkedHashSet</span>

    <span class="keyword">def</span> <a title="(pos: CompilationUnits.this.Position, msg: String)Unit" id="96430">error</a><span class="delimiter">(</span><a title="CompilationUnits.this.Position" id="97413">pos</a>: <a href="util/Position.scala.html#30599" title="CompilationUnits.this.Position">Position</a>, <a title="String" id="97414">msg</a>: <span title="String">String</span><span class="delimiter">)</span> =
      <a href="Global.scala.html#64821" title="=&gt; scala.tools.nsc.reporters.Reporter">reporter</a>.<a href="reporters/Reporter.scala.html#67997" title="(pos: scala.tools.nsc.util.Position, msg: String)Unit">error</a><span class="delimiter">(</span><a href="#97413" title="CompilationUnits.this.Position">pos</a>, <a href="#97414" title="String">msg</a><span class="delimiter">)</span>

    <span class="keyword">def</span> <a title="(pos: CompilationUnits.this.Position, msg: String)Unit" id="96431">warning</a><span class="delimiter">(</span><a title="CompilationUnits.this.Position" id="97437">pos</a>: <a href="util/Position.scala.html#30599" title="CompilationUnits.this.Position">Position</a>, <a title="String" id="97438">msg</a>: <span title="String">String</span><span class="delimiter">)</span> = 
      <a href="Global.scala.html#64821" title="=&gt; scala.tools.nsc.reporters.Reporter">reporter</a>.<a href="reporters/Reporter.scala.html#67996" title="(pos: scala.tools.nsc.util.Position, msg: String)Unit">warning</a><span class="delimiter">(</span><a href="#97437" title="CompilationUnits.this.Position">pos</a>, <a href="#97438" title="String">msg</a><span class="delimiter">)</span>

    <span class="keyword">def</span> <a title="(pos: CompilationUnits.this.Position, msg: String)Unit" id="96432">deprecationWarning</a><span class="delimiter">(</span><a title="CompilationUnits.this.Position" id="97444">pos</a>: <a href="util/Position.scala.html#30599" title="CompilationUnits.this.Position">Position</a>, <a title="String" id="97445">msg</a>: <span title="String">String</span><span class="delimiter">)</span> = 
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="Global.scala.html#64877" title="object CompilationUnits.this.opt">opt</a>.<a href="settings/AestheticSettings.scala.html#97458" title="=&gt; Boolean">deprecation</a><span class="delimiter">)</span> <a href="#96431" title="(pos: CompilationUnits.this.Position, msg: String)Unit">warning</a><span class="delimiter">(</span><a href="#97444" title="CompilationUnits.this.Position">pos</a>, <a href="#97445" title="String">msg</a><span class="delimiter">)</span>
      <span class="keyword">else</span> <a href="Global.scala.html#64980" title="=&gt; CompilationUnits.this.Run">currentRun</a>.<a href="Global.scala.html#72297" title="(x$1: Int)Unit">deprecationWarnings</a> <span title="(x: Int)Int">+=</span> <span title="Int(1)" class="int">1</span>

    <span class="keyword">def</span> <a title="(pos: CompilationUnits.this.Position, msg: String)Unit" id="96433">uncheckedWarning</a><span class="delimiter">(</span><a title="CompilationUnits.this.Position" id="97523">pos</a>: <a href="util/Position.scala.html#30599" title="CompilationUnits.this.Position">Position</a>, <a title="String" id="97524">msg</a>: <span title="String">String</span><span class="delimiter">)</span> = 
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="Global.scala.html#64877" title="object CompilationUnits.this.opt">opt</a>.<a href="settings/AestheticSettings.scala.html#97465" title="=&gt; Boolean">unchecked</a><span class="delimiter">)</span> <a href="#96431" title="(pos: CompilationUnits.this.Position, msg: String)Unit">warning</a><span class="delimiter">(</span><a href="#97523" title="CompilationUnits.this.Position">pos</a>, <a href="#97524" title="String">msg</a><span class="delimiter">)</span>
      <span class="keyword">else</span> <a href="Global.scala.html#64980" title="=&gt; CompilationUnits.this.Run">currentRun</a>.<a href="Global.scala.html#72300" title="(x$1: Int)Unit">uncheckedWarnings</a> <span title="(x: Int)Int">+=</span> <span title="Int(1)" class="int">1</span>

    <span class="keyword">def</span> <a title="(pos: CompilationUnits.this.Position, msg: String)Unit" id="96434">incompleteInputError</a><span class="delimiter">(</span><a title="CompilationUnits.this.Position" id="97541">pos</a>: <a href="util/Position.scala.html#30599" title="CompilationUnits.this.Position">Position</a>, <a title="String" id="97542">msg</a>:<span title="String">String</span><span class="delimiter">)</span> =
      <a href="Global.scala.html#64821" title="=&gt; scala.tools.nsc.reporters.Reporter">reporter</a>.<a href="reporters/Reporter.scala.html#67998" title="(pos: scala.tools.nsc.util.Position, msg: String)Unit">incompleteInputError</a><span class="delimiter">(</span><a href="#97541" title="CompilationUnits.this.Position">pos</a>, <a href="#97542" title="String">msg</a><span class="delimiter">)</span> 

    <span class="keyword">def</span> <a title="(pos: CompilationUnits.this.Position, msg: String)Unit" id="96435">comment</a><span class="delimiter">(</span><a title="CompilationUnits.this.Position" id="97548">pos</a>: <a href="util/Position.scala.html#30599" title="CompilationUnits.this.Position">Position</a>, <a title="String" id="97549">msg</a>: <span title="String">String</span><span class="delimiter">)</span> =
      <a href="Global.scala.html#64821" title="=&gt; scala.tools.nsc.reporters.Reporter">reporter</a>.<a href="reporters/Reporter.scala.html#67999" title="(pos: scala.tools.nsc.util.Position, msg: String)Unit">comment</a><span class="delimiter">(</span><a href="#97548" title="CompilationUnits.this.Position">pos</a>, <a href="#97549" title="String">msg</a><span class="delimiter">)</span>
      
    <span class="comment">/** Is this about a .java source file? */</span>
    <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="Boolean" id="96437">isJava</a> = <a href="#96444" title="=&gt; scala.tools.nsc.util.SourceFile">source</a>.<a href="util/SourceFile.scala.html#96500" title="=&gt; scala.tools.nsc.io.AbstractFile">file</a>.<a href="io/AbstractFile.scala.html#96452" title="=&gt; String">name</a>.<span title="(x$1: java.lang.String)Boolean">endsWith</span><span class="delimiter">(</span><span title="java.lang.String(&quot;.java&quot;)" class="string">&quot;.java&quot;</span><span class="delimiter">)</span>
    
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="()String" id="96438">toString</a><span class="delimiter">(</span><span class="delimiter">)</span> = <a href="#96444" title="=&gt; scala.tools.nsc.util.SourceFile">source</a>.<a href="util/SourceFile.scala.html#96509" title="()String">toString</a><span class="delimiter">(</span><span class="delimiter">)</span>

    <span class="keyword">def</span> <a title="()Unit" id="96439">clear</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#96406" title="(x$1: scala.tools.nsc.util.FreshNameCreator)Unit">fresh</a> = <span title="Null(null)" class="keyword">null</span>
      <a href="#96411" title="(x$1: CompilationUnits.this.Tree)Unit">body</a> = <span title="Null(null)" class="keyword">null</span>
      <a href="#96418" title="=&gt; scala.collection.mutable.HashSet[CompilationUnits.this.Symbol]">depends</a>.<span title="()Unit">clear</span>
      <a href="#96420" title="=&gt; scala.collection.mutable.HashSet[CompilationUnits.this.Symbol]">defined</a>.<span title="()Unit">clear</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>



        </pre>
    </body>
</html>