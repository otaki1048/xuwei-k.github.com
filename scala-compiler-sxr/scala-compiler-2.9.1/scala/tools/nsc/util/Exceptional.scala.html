<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>scala/tools/nsc/util/Exceptional.scala</title>
        <script type="text/javascript" src="../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> scala.tools.nsc
<span class="keyword">package</span> util

<span class="keyword">import</span> java.util.concurrent.ExecutionException
<span class="keyword">import</span> java.lang.reflect.<span class="delimiter">{</span> InvocationTargetException, UndeclaredThrowableException <span class="delimiter">}</span>
<span class="keyword">import</span> io.<span class="delimiter">{</span> Sources, Fileish <span class="delimiter">}</span>
<span class="keyword">import</span> scala.tools.util.<a href="../../util/StringOps.scala.html#31716" title="object scala.tools.util.StringOps">StringOps</a>._

<span class="comment">/** A simple throwable wrapper so it looks more like a parade of
 *  glittering frame-shaped beauties than the other thing.
 */</span>
<span class="keyword">class</span> <a title="class Exceptional extends java.lang.Object with ScalaObject" id="30582">Exceptional</a><a href="#30582" title="ScalaObject" class="delimiter">(</a><span class="keyword">val</span> <a title="Throwable" id="108341">ex</a>: <span title="Throwable">Throwable</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scala.tools.nsc.util.ScalaPrefs" id="108342">prefs</a>: <a href="ScalaPrefs.scala.html#31074" title="scala.tools.nsc.util.ScalaPrefs">ScalaPrefs</a><span class="delimiter">)</span> <span class="delimiter">{</span>
  <span class="keyword">val</span> <a title="scala.tools.nsc.util.Exceptional.Calibrated" id="108312">formatter</a>  = <a href="#108342" title="scala.tools.nsc.util.ScalaPrefs">prefs</a>.<a href="#599206" title="(ex: Throwable)scala.tools.nsc.util.Exceptional.Calibrated">exceptionFormatter</a><span class="delimiter">(</span><a href="#108341" title="=&gt; Throwable">ex</a><span class="delimiter">)</span>
  <span class="keyword">val</span> <a title="Throwable" id="108314">unwrapped</a>  = <a href="#30583" title="object scala.tools.nsc.util.Exceptional">Exceptional</a>.<a href="#108301" title="(x: Throwable)Throwable">unwrap</a><span class="delimiter">(</span><a href="#108341" title="=&gt; Throwable">ex</a><span class="delimiter">)</span>
  <span class="keyword">val</span> <a title="scala.tools.nsc.util.TableDef[scala.tools.nsc.util.JavaStackFrame]#Table" id="108316">table</a>      = <a href="#108312" title="=&gt; scala.tools.nsc.util.Exceptional.Calibrated">formatter</a>.<a href="#599218" title="(ex: Throwable)scala.tools.nsc.util.TableDef[scala.tools.nsc.util.JavaStackFrame]#Table">newTable</a><span class="delimiter">(</span><a href="#108314" title="=&gt; Throwable">unwrapped</a><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="()Unit" id="108318">rawTrace</a><span class="delimiter">(</span><span class="delimiter">)</span> = <a href="#108314" title="=&gt; Throwable">unwrapped</a>.<span title="()Unit">printStackTrace</span><span class="delimiter">(</span><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="=&gt; Boolean" id="108319">isScanDone</a> = <a href="#108342" title="scala.tools.nsc.util.ScalaPrefs">prefs</a>.<a href="ScalaPrefs.scala.html#108343" title="=&gt; scala.tools.nsc.io.Sources">codeSources</a>.<a href="../io/Sources.scala.html#342998" title="()Boolean">isDone</a><span class="delimiter">(</span><span class="delimiter">)</span>

  <span class="comment">/** Block until the scanning is complete. */</span>
  <span class="keyword">def</span> <a title="()Exceptional.this.type" id="108320">force</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span class="keyword">this</span>.<span class="keyword">type</span> = <span class="delimiter">{</span>
    <a href="#108342" title="scala.tools.nsc.util.ScalaPrefs">prefs</a>.<a href="ScalaPrefs.scala.html#108343" title="=&gt; scala.tools.nsc.io.Sources">codeSources</a>.<a href="../io/Sources.scala.html#343000" title="()Unit">force</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <a href="#30582" title="Exceptional.this.type" class="keyword">this</a>
  <span class="delimiter">}</span>

  <span class="comment">/** Stack frame contexts are only shown as long as this is true. */</span>
  <span class="keyword">def</span> <a title="(frame: scala.tools.nsc.util.JavaStackFrame)Boolean" id="108321">spanFn</a><span class="delimiter">(</span><a title="scala.tools.nsc.util.JavaStackFrame" id="348664">frame</a>: <a href="JavaStackFrame.scala.html#30969" title="scala.tools.nsc.util.JavaStackFrame">JavaStackFrame</a><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> = <span title="Boolean(true)" class="keyword">true</span>
  
  <span class="comment">/** The result of this will be printed before a context trace. */</span>
  <span class="keyword">def</span> <a title="=&gt; String" id="108322">contextPrelude</a>: <span title="String">String</span> =
    <span title="String" class="keyword">if</span> <span class="delimiter">(</span><a href="#108319" title="=&gt; Boolean">isScanDone</a><span class="delimiter">)</span> <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span>
    <span class="keyword">else</span> <span title="java.lang.String(&quot;/* Still scanning source path: there may be more momentarily. */\012&quot;)" class="string">&quot;/* Still scanning source path: there may be more momentarily. */\n&quot;</span>
  
  <span class="comment">/** Frames with surrounding context. */</span>
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="=&gt; List[scala.tools.nsc.util.JavaStackFrame]" id="108323">contextFrames</a>     = <a href="#108329" title="=&gt; List[scala.tools.nsc.util.JavaStackFrame]">toList</a> <span title="(p: scala.tools.nsc.util.JavaStackFrame =&gt; Boolean)List[scala.tools.nsc.util.JavaStackFrame]">takeWhile</span> <a href="#108321" title="(frame: scala.tools.nsc.util.JavaStackFrame)Boolean">spanFn</a>
  <span class="keyword">def</span> <a title="()String" id="108324">contextHead</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="String">String</span>     = <a href="#108325" title="()List[String]">contextElems</a>.<span title="=&gt; Option[String]">headOption</span> <span title="(default: =&gt; String)String">getOrElse</span> <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span>
  <span class="keyword">def</span> <a title="()List[String]" id="108325">contextElems</a><span class="delimiter">(</span><span class="delimiter">)</span>            = <a href="#108323" title="=&gt; List[scala.tools.nsc.util.JavaStackFrame]">contextFrames</a> <span title="(f: scala.tools.nsc.util.JavaStackFrame =&gt; String)(implicit bf: scala.collection.generic.CanBuildFrom[List[scala.tools.nsc.util.JavaStackFrame],String,List[String]])List[String]">map</span> <a href="#108312" title="=&gt; scala.tools.nsc.util.Exceptional.Calibrated">formatter</a>.<a href="#599219" title="(frame: scala.tools.nsc.util.JavaStackFrame)String">inContext</a>
  <span class="keyword">def</span> <a title="()String" id="108326">context</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="String">String</span>         = <a href="#108327" title="(num: Int)String">context</a><span class="delimiter">(</span><a href="#108328" title="=&gt; Int">length</a><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="(num: Int)String" id="108327">context</a><span class="delimiter">(</span><a title="Int" id="108358">num</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="String">String</span> = <a href="#108322" title="=&gt; String">contextPrelude</a> <span title="(x$1: Any)java.lang.String">+</span> <a href="../../util/StringOps.scala.html#72453" title="(xs: Seq[String], sep: String, orElse: String)String">ojoinOr</a><span class="delimiter">(</span><a href="#108323" title="=&gt; List[scala.tools.nsc.util.JavaStackFrame]">contextFrames</a> <span title="(n: Int)List[scala.tools.nsc.util.JavaStackFrame]">take</span> <a href="#108358" title="Int">num</a> <span title="(f: scala.tools.nsc.util.JavaStackFrame =&gt; String)(implicit bf: scala.collection.generic.CanBuildFrom[List[scala.tools.nsc.util.JavaStackFrame],String,Seq[String]])Seq[String]">map</span> <a href="#108312" title="=&gt; scala.tools.nsc.util.Exceptional.Calibrated">formatter</a>.<a href="#599219" title="(frame: scala.tools.nsc.util.JavaStackFrame)String">inContext</a>, <span title="java.lang.String(&quot;\012&quot;)" class="string">&quot;\n&quot;</span>, <span title="java.lang.String(&quot;No stack trace.&quot;)" class="string">&quot;No stack trace.&quot;</span><span class="delimiter">)</span>  
  
  <span class="comment">/** Exceptional doesn't extend Seq because it turns out to be super 
   *  annoying in the repl: tab-completion sees all the Seq methods.
   */</span>
  <span class="keyword">def</span> <a title="=&gt; Int" id="108328">length</a>            = <a href="#108329" title="=&gt; List[scala.tools.nsc.util.JavaStackFrame]">toList</a>.<span title="=&gt; Int">length</span>
  <span class="keyword">def</span> <a title="=&gt; List[scala.tools.nsc.util.JavaStackFrame]" id="108329">toList</a>            = <a href="#108316" title="=&gt; scala.tools.nsc.util.TableDef[scala.tools.nsc.util.JavaStackFrame]#Table">table</a>.<span title="=&gt; List[scala.tools.nsc.util.JavaStackFrame]">toList</span>
  <span class="keyword">def</span> <a title="=&gt; Iterator[scala.tools.nsc.util.JavaStackFrame]" id="108330">iterator</a>          = <a href="#108316" title="=&gt; scala.tools.nsc.util.TableDef[scala.tools.nsc.util.JavaStackFrame]#Table">table</a>.<a href="TableDef.scala.html#121854" title="=&gt; Iterator[scala.tools.nsc.util.JavaStackFrame]">iterator</a>
  <span class="keyword">def</span> <a title="(index: Int)scala.tools.nsc.util.JavaStackFrame" id="108331">apply</a><span class="delimiter">(</span><a title="Int" id="599395">index</a>: <span title="Int">Int</span><span class="delimiter">)</span> = <a href="TableDef.scala.html#121855" title="(index: Int)scala.tools.nsc.util.JavaStackFrame">table</a><span class="delimiter">(</span><a href="#599395" title="Int">index</a><span class="delimiter">)</span>
  
  <span class="keyword">def</span> <a title="=&gt; List[Throwable]" id="108332">causes</a>  = <a href="#30583" title="object scala.tools.nsc.util.Exceptional">Exceptional</a>.<a href="#108300" title="(x: Throwable)List[Throwable]">causes</a><span class="delimiter">(</span><a href="#108341" title="=&gt; Throwable">ex</a><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="=&gt; java.lang.String" id="108333">summary</a> = <a href="#108314" title="=&gt; Throwable">unwrapped</a>.<span title="()java.lang.String">toString</span> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;\012  at &quot;)" class="string">&quot;\n  at &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#108331" title="(index: Int)scala.tools.nsc.util.JavaStackFrame">apply</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>.<a href="JavaStackFrame.scala.html#348686" title="=&gt; String">shortNameString</a>
  
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(msg: Any)Unit" id="108334">println</a><span class="delimiter">(</span><a title="Any" id="599701">msg</a>: <span title="Any">Any</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span title="object Console">Console</span> <span title="(x: Any)Unit">println</span> <a href="#599701" title="Any">msg</a>
    <span title="object Console">Console</span>.<span title="()Unit">flush</span><span class="delimiter">(</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="()Unit" id="108335">show</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="Unit">Unit</span>         = <a href="#108334" title="(msg: Any)Unit">println</a><span class="delimiter">(</span><a href="#108326" title="()String">context</a><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="(num: Int)Unit" id="108336">show</a><span class="delimiter">(</span><a title="Int" id="381364">num</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <a href="#108334" title="(msg: Any)Unit">println</a><span class="delimiter">(</span><a href="#108327" title="(num: Int)String">context</a><span class="delimiter">(</span><a href="#381364" title="Int">num</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="()Unit" id="108337">showCauses</a><span class="delimiter">(</span><span class="delimiter">)</span>         = <a href="#108334" title="(msg: Any)Unit">println</a><span class="delimiter">(</span><span class="delimiter">(</span><a href="#108341" title="=&gt; Throwable">ex</a> <a href="#599716" title="(x: Throwable)List[Throwable]">::</a> <a href="#108332" title="=&gt; List[Throwable]">causes</a><span class="delimiter">)</span>.<span title="(start: String, sep: String, end: String)String">mkString</span><span class="delimiter">(</span><span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span>, <span title="java.lang.String(&quot;\012  caused by -&gt; &quot;)" class="string">&quot;\n  caused by -&gt; &quot;</span>, <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="()Unit" id="108338">showTable</a><span class="delimiter">(</span><span class="delimiter">)</span>          = <a href="#108334" title="(msg: Any)Unit">println</a><span class="delimiter">(</span><a href="#108316" title="=&gt; scala.tools.nsc.util.TableDef[scala.tools.nsc.util.JavaStackFrame]#Table">table</a><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="()Unit" id="108339">showSummary</a><span class="delimiter">(</span><span class="delimiter">)</span>        = <a href="#108334" title="(msg: Any)Unit">println</a><span class="delimiter">(</span><a href="#108333" title="=&gt; java.lang.String">summary</a><span class="delimiter">)</span>
  
  <span class="keyword">override</span> <span class="keyword">def</span> <a title="()java.lang.String" id="108340">toString</a> = <a href="#108333" title="=&gt; java.lang.String">summary</a>
<span class="delimiter">}</span>


<span class="keyword">object</span> <a title="object scala.tools.nsc.util.Exceptional" id="30583">Exceptional</a> <span title="ScalaObject" class="delimiter">{</span>
  <span class="keyword">type</span> <a title="[+T]PartialFunction[Throwable,T]" id="108281">Catcher</a><span class="delimiter">[</span>+<a title="&gt;: Nothing &lt;: Any" id="108282">T</a><span class="delimiter">]</span> = <span title="PartialFunction[Throwable,T]">PartialFunction</span><span class="delimiter">[</span>Throwable, T<span class="delimiter">]</span>
  
  <span class="comment">/** Creates an exception handler which will only ever catch the given
   *  number of exceptions (if the given pf is defined there) and after
   *  that will disable itself.
   */</span>
  <span class="keyword">def</span> <a title="[T](numCatches: Int)(pf: scala.tools.nsc.util.Exceptional.Catcher[T])scala.tools.nsc.util.Exceptional.Catcher[T]" id="108283">expiringHandler</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="108285">T</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="Int" id="541115">numCatches</a>: <span title="Int">Int</span><span class="delimiter">)</span><span class="delimiter">(</span><a title="scala.tools.nsc.util.Exceptional.Catcher[T]" id="541116">pf</a>: <span title="scala.tools.nsc.util.Exceptional.Catcher[T]">Catcher</span><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="scala.tools.nsc.util.Exceptional.Catcher[T]">Catcher</span><span class="delimiter">[</span>T<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">var</span> <a title="Int" id="599737">remaining</a> = <a href="#541115" title="Int">numCatches</a>;
    <a href="#599739" title="T" class="delimiter">{</a> <span class="keyword">case</span> <a title="T" id="599740">ex</a>: <span title="Throwable">Throwable</span> <span class="keyword">if</span> <a href="#599737" title="Int">remaining</a> <span title="(x: Int)Boolean">&gt;</span> <span title="Int(0)" class="int">0</span> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#541116" title="scala.tools.nsc.util.Exceptional.Catcher[T]">pf</a>.<span title="(x: Throwable)Boolean">isDefinedAt</span><span class="delimiter">(</span><a href="#599740" title="java.lang.Throwable">ex</a><span class="delimiter">)</span> =&gt;
        <a href="#599737" title="Int">remaining</a> <span title="(x: Int)Int">-=</span> <span title="Int(1)" class="int">1</span>
        <a href="#541116" title="(v1: Throwable)T">pf</a><span class="delimiter">(</span><a href="#599740" title="java.lang.Throwable">ex</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
  
  <span class="comment">/** The Throwable =&gt; Exceptional implicit plus the associated factory. */</span>
  <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="implicit scala.tools.nsc.util.Exceptional.throwableToExceptional : (ex: Throwable)(implicit prefs: scala.tools.nsc.util.ScalaPrefs)scala.tools.nsc.util.Exceptional" id="108286">throwableToExceptional</a><span class="delimiter">(</span><a title="Throwable" id="599456">ex</a>: <span title="Throwable">Throwable</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scala.tools.nsc.util.ScalaPrefs" id="599457">prefs</a>: <a href="ScalaPrefs.scala.html#31074" title="scala.tools.nsc.util.ScalaPrefs">ScalaPrefs</a><span class="delimiter">)</span>: <a href="#30582" title="scala.tools.nsc.util.Exceptional">Exceptional</a> = <a href="#108287" title="(ex: Throwable)(implicit prefs: scala.tools.nsc.util.ScalaPrefs)scala.tools.nsc.util.Exceptional">apply</a><span class="delimiter">(</span><a href="#599456" title="Throwable">ex</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#599457" title="scala.tools.nsc.util.ScalaPrefs">prefs</a><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="(ex: Throwable)(implicit prefs: scala.tools.nsc.util.ScalaPrefs)scala.tools.nsc.util.Exceptional" id="108287">apply</a><span class="delimiter">(</span><a title="Throwable" id="108302">ex</a>: <span title="Throwable">Throwable</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scala.tools.nsc.util.ScalaPrefs" id="108303">prefs</a>: <a href="ScalaPrefs.scala.html#31074" title="scala.tools.nsc.util.ScalaPrefs">ScalaPrefs</a><span class="delimiter">)</span> = <span title="scala.tools.nsc.util.Exceptional" class="keyword">new</span> <a href="#30582" title="scala.tools.nsc.util.Exceptional">Exceptional</a><span class="delimiter">(</span><a href="#108302" title="Throwable">ex</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#108303" title="scala.tools.nsc.util.ScalaPrefs">prefs</a><span class="delimiter">)</span>

  <span class="comment">/** Some handy functions. */</span>
  <span class="keyword">def</span> <a title="()Array[scala.tools.nsc.util.JavaStackFrame]" id="108288">stack</a><span class="delimiter">(</span><span class="delimiter">)</span>  = <a href="JavaStackFrame.scala.html#30970" title="object scala.tools.nsc.util.JavaStackFrame">JavaStackFrame</a> <a href="JavaStackFrame.scala.html#599281" title="(xs: Array[java.lang.StackTraceElement])Array[scala.tools.nsc.util.JavaStackFrame]">frames</a> <span class="delimiter">(</span><span class="delimiter">(</span><span title="java.lang.Throwable" class="keyword">new</span> <span title="java.lang.Throwable">Throwable</span><span class="delimiter">)</span>.<span title="(xs: Array[java.lang.StackTraceElement])scala.collection.mutable.ArrayOps[java.lang.StackTraceElement]">getStackTrace</span> <span title="(p: java.lang.StackTraceElement =&gt; Boolean)Array[java.lang.StackTraceElement]">dropWhile</span> <a href="#108299" title="(ste: java.lang.StackTraceElement)Boolean">isLocal</a><span class="delimiter">)</span>  
  <span class="keyword">def</span> <a title="()Unit" id="108289">showme</a><span class="delimiter">(</span><span class="delimiter">)</span> = <a href="#108287" title="(ex: Throwable)(implicit prefs: scala.tools.nsc.util.ScalaPrefs)scala.tools.nsc.util.Exceptional">apply</a><a href="ScalaPrefs.scala.html#108346" title="object scala.tools.nsc.util.ScalaPrefs.DefaultScalaPrefs" class="delimiter">(</a><span title="java.lang.Throwable" class="keyword">new</span> <span title="java.lang.Throwable">Throwable</span><span class="delimiter">)</span>.<a href="#108335" title="()Unit">show</a><span class="delimiter">(</span><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="()Unit" id="108290">showstack</a><span class="delimiter">(</span><span class="delimiter">)</span> = <a href="#108287" title="(ex: Throwable)(implicit prefs: scala.tools.nsc.util.ScalaPrefs)scala.tools.nsc.util.Exceptional">apply</a><a href="ScalaPrefs.scala.html#108346" title="object scala.tools.nsc.util.ScalaPrefs.DefaultScalaPrefs" class="delimiter">(</a><span title="java.lang.Throwable" class="keyword">new</span> <span title="java.lang.Throwable">Throwable</span><span class="delimiter">)</span>.<a href="#108338" title="()Unit">showTable</a><span class="delimiter">(</span><span class="delimiter">)</span>

  <span class="comment">/** A frame formatter with more refined aesthetics than the default.
   *  Come, let us be civilized.
   */</span>
  <span class="keyword">object</span> <a title="object scala.tools.nsc.util.Exceptional.ScalaFormat" id="108291">ScalaFormat</a> <span title="ScalaObject" class="keyword">extends</span> <a href="TableDef.scala.html#30375" title="scala.tools.nsc.util.TableDef[scala.tools.nsc.util.JavaStackFrame]">TableDef</a><span class="delimiter">[</span>JavaStackFrame<span class="delimiter">]</span> <span class="delimiter">{</span>
      <a href="TableDef.scala.html#121820" title="(pair: (String, scala.tools.nsc.util.JavaStackFrame =&gt; Any))scala.tools.nsc.util.TableDef[scala.tools.nsc.util.JavaStackFrame]">&gt;&gt;</a> <span class="delimiter">(</span><span title="(x: java.lang.String)ArrowAssoc[java.lang.String]" class="string">&quot;file&quot;</span>    <span title="(y: scala.tools.nsc.util.JavaStackFrame =&gt; String)(java.lang.String, scala.tools.nsc.util.JavaStackFrame =&gt; String)">-&gt;</span> <span class="delimiter">(</span><a href="#600023" title="scala.tools.nsc.util.JavaStackFrame">_</a>.<a href="JavaStackFrame.scala.html#348674" title="=&gt; String">fileName</a><span class="delimiter">)</span><span class="delimiter">)</span>   <a href="TableDef.scala.html#121822" title="(sep: String)scala.tools.nsc.util.TableDef[scala.tools.nsc.util.JavaStackFrame]">&gt;+</a> <span title="java.lang.String(&quot;:&quot;)" class="string">&quot;:&quot;</span>
      <a href="TableDef.scala.html#121821" title="(pair: (String, scala.tools.nsc.util.JavaStackFrame =&gt; Any))scala.tools.nsc.util.TableDef[scala.tools.nsc.util.JavaStackFrame]">&lt;&lt;</a> <span class="delimiter">(</span><span title="(x: java.lang.String)ArrowAssoc[java.lang.String]" class="string">&quot;line&quot;</span>    <span title="(y: scala.tools.nsc.util.JavaStackFrame =&gt; Int)(java.lang.String, scala.tools.nsc.util.JavaStackFrame =&gt; Int)">-&gt;</span> <span class="delimiter">(</span><a href="#600042" title="scala.tools.nsc.util.JavaStackFrame">_</a>.<a href="JavaStackFrame.scala.html#348675" title="=&gt; Int">line</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="TableDef.scala.html#121820" title="(pair: (String, scala.tools.nsc.util.JavaStackFrame =&gt; Any))scala.tools.nsc.util.TableDef[scala.tools.nsc.util.JavaStackFrame]">&gt;&gt;</a> <span class="delimiter">(</span><span title="(x: java.lang.String)ArrowAssoc[java.lang.String]" class="string">&quot;class&quot;</span>   <span title="(y: scala.tools.nsc.util.JavaStackFrame =&gt; java.lang.String)(java.lang.String, scala.tools.nsc.util.JavaStackFrame =&gt; java.lang.String)">-&gt;</span> <span class="delimiter">(</span><a href="#600060" title="scala.tools.nsc.util.JavaStackFrame">_</a>.<a href="JavaStackFrame.scala.html#348681" title="=&gt; java.lang.String">shortestName</a><span class="delimiter">)</span><span class="delimiter">)</span>  <a href="TableDef.scala.html#121822" title="(sep: String)scala.tools.nsc.util.TableDef[scala.tools.nsc.util.JavaStackFrame]">&gt;+</a> <span title="java.lang.String(&quot;.&quot;)" class="string">&quot;.&quot;</span>
      <a href="TableDef.scala.html#121821" title="(pair: (String, scala.tools.nsc.util.JavaStackFrame =&gt; Any))scala.tools.nsc.util.TableDef[scala.tools.nsc.util.JavaStackFrame]">&lt;&lt;</a> <span class="delimiter">(</span><span title="(x: java.lang.String)ArrowAssoc[java.lang.String]" class="string">&quot;method&quot;</span>  <span title="(y: scala.tools.nsc.util.JavaStackFrame =&gt; String)(java.lang.String, scala.tools.nsc.util.JavaStackFrame =&gt; String)">-&gt;</span> <span class="delimiter">(</span><a href="#600080" title="scala.tools.nsc.util.JavaStackFrame">_</a>.<a href="JavaStackFrame.scala.html#348673" title="=&gt; String">methodName</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>
  
  <span class="keyword">trait</span> <a title="trait Calibrated extends java.lang.Object" id="108293">Calibrated</a> <span title="java.lang.Object" class="delimiter">{</span>
    <span class="keyword">def</span> <a title="(ex: Throwable)scala.tools.nsc.util.TableDef[scala.tools.nsc.util.JavaStackFrame]#Table" id="599218">newTable</a><span class="delimiter">(</span><a title="Throwable" id="599220">ex</a>: <span title="Throwable">Throwable</span><span class="delimiter">)</span>: TableDef<span class="delimiter">[</span>JavaStackFrame<span class="delimiter">]</span>#<a href="TableDef.scala.html#121837" title="scala.tools.nsc.util.TableDef[scala.tools.nsc.util.JavaStackFrame]#Table">Table</a>
    <span class="keyword">def</span> <a title="(frame: scala.tools.nsc.util.JavaStackFrame)String" id="599219">inContext</a><span class="delimiter">(</span><a title="scala.tools.nsc.util.JavaStackFrame" id="599272">frame</a>: <a href="JavaStackFrame.scala.html#30969" title="scala.tools.nsc.util.JavaStackFrame">JavaStackFrame</a><span class="delimiter">)</span>: <span title="String">String</span>
  <span class="delimiter">}</span>
  <span class="keyword">trait</span> <a title="trait Formatter extends java.lang.Object with Throwable =&gt; scala.tools.nsc.util.Exceptional.Calibrated" id="108294">Formatter</a> <span class="keyword">extends</span> <span class="delimiter">(</span>Throwable =&gt; Calibrated<span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="(ex: Throwable)scala.tools.nsc.util.Exceptional.Calibrated" id="599206">apply</a><span class="delimiter">(</span><a title="Throwable" id="599208">ex</a>: <span title="Throwable">Throwable</span><span class="delimiter">)</span>: <a href="#108293" title="scala.tools.nsc.util.Exceptional.Calibrated">Calibrated</a>
  <span class="delimiter">}</span>
  <span class="keyword">object</span> <a title="object scala.tools.nsc.util.Exceptional.Formatter" id="108295">Formatter</a> <span title="ScalaObject" class="delimiter">{</span>
    <span class="keyword">def</span> <a title="(implicit prefs: scala.tools.nsc.util.ScalaPrefs)scala.tools.nsc.util.Exceptional.Formatter" id="600087">apply</a><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scala.tools.nsc.util.ScalaPrefs" id="600089">prefs</a>: <a href="ScalaPrefs.scala.html#31074" title="scala.tools.nsc.util.ScalaPrefs">ScalaPrefs</a><span class="delimiter">)</span>: <a href="#108294" title="scala.tools.nsc.util.Exceptional.Formatter">Formatter</a> = <a href="#600091" title="java.lang.Object with scala.tools.nsc.util.Exceptional.Formatter" class="keyword">new</a> <a title="anonymous class $anon extends java.lang.Object with scala.tools.nsc.util.Exceptional.Formatter" id="600091">Formatter</a> <span class="delimiter">{</span>
      <span class="keyword">def</span> <a title="(ex: Throwable)java.lang.Object with scala.tools.nsc.util.Exceptional.Calibrated{def newTable(ex: Throwable): scala.tools.nsc.util.Exceptional.ScalaFormat.Table}" id="600096">apply</a><span class="delimiter">(</span><a title="Throwable" id="600097">ex</a>: <span title="Throwable">Throwable</span><span class="delimiter">)</span> = <a href="#600102" title="java.lang.Object with scala.tools.nsc.util.Exceptional.Calibrated" class="keyword">new</a> <a title="anonymous class $anon extends java.lang.Object with scala.tools.nsc.util.Exceptional.Calibrated" id="600102">Calibrated</a> <span class="delimiter">{</span>
        <span class="keyword">def</span> <a title="(ex: Throwable)scala.tools.nsc.util.Exceptional.ScalaFormat.Table" id="600106">newTable</a><span class="delimiter">(</span><a title="Throwable" id="600108">ex</a>: <span title="Throwable">Throwable</span><span class="delimiter">)</span>          = <span title="scala.tools.nsc.util.Exceptional.ScalaFormat.Table" class="keyword">new</span> <a href="#108291" title="object scala.tools.nsc.util.Exceptional.ScalaFormat">ScalaFormat</a>.<a href="TableDef.scala.html#121837" title="scala.tools.nsc.util.Exceptional.ScalaFormat.Table">Table</a><span class="delimiter">(</span><a href="JavaStackFrame.scala.html#30970" title="object scala.tools.nsc.util.JavaStackFrame">JavaStackFrame</a> <a href="JavaStackFrame.scala.html#599282" title="(xs: Array[scala.tools.nsc.util.JavaStackFrame])scala.collection.mutable.WrappedArray[scala.tools.nsc.util.JavaStackFrame]">frames</a> <a href="#600108" title="Throwable">ex</a><span class="delimiter">)</span>
        <span class="keyword">def</span> <a title="(frame: scala.tools.nsc.util.JavaStackFrame)java.lang.String" id="600107">inContext</a><span class="delimiter">(</span><a title="scala.tools.nsc.util.JavaStackFrame" id="600146">frame</a>: <a href="JavaStackFrame.scala.html#30969" title="scala.tools.nsc.util.JavaStackFrame">JavaStackFrame</a><span class="delimiter">)</span> = <span title="scala.tools.nsc.util.FrameContext" class="keyword">new</span> <a href="JavaStackFrame.scala.html#30735" title="scala.tools.nsc.util.FrameContext">FrameContext</a><span class="delimiter">(</span><a href="#600146" title="scala.tools.nsc.util.JavaStackFrame">frame</a>, <a href="#600089" title="scala.tools.nsc.util.ScalaPrefs">prefs</a>.<a href="ScalaPrefs.scala.html#108343" title="=&gt; scala.tools.nsc.io.Sources">codeSources</a><span class="delimiter">)</span> <a href="JavaStackFrame.scala.html#600164" title="()java.lang.String">toString</a>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="comment">/** Java stack traces have the interesting property of using only the name
   *  of the file, no paths.  This makes it a bit of a gamble to try to associate
   *  a stack frame with a specific file.  Witness the heuristic.
   */</span>
  <span class="keyword">def</span> <a title="(sources: scala.tools.nsc.io.Sources, frame: scala.tools.nsc.util.JavaStackFrame)List[scala.tools.nsc.io.Fileish]" id="108297">locateSources</a><span class="delimiter">(</span><a title="scala.tools.nsc.io.Sources" id="600366">sources</a>: <a href="../io/Sources.scala.html#21613" title="scala.tools.nsc.io.Sources">Sources</a>, <a title="scala.tools.nsc.util.JavaStackFrame" id="600367">frame</a>: <a href="JavaStackFrame.scala.html#30969" title="scala.tools.nsc.util.JavaStackFrame">JavaStackFrame</a><span class="delimiter">)</span>: <span title="List[scala.tools.nsc.io.Fileish]">List</span><span class="delimiter">[</span>Fileish<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="comment">// if only one has a matching path, that's fairly sure to be the one</span>
    <span class="keyword">val</span> <a title="List[scala.tools.nsc.io.Fileish]" id="600369">matches</a> = <a href="../io/Sources.scala.html#342985" title="(name: String)List[scala.tools.nsc.io.Fileish]">sources</a><span class="delimiter">(</span><a href="#600367" title="scala.tools.nsc.util.JavaStackFrame">frame</a>.<a href="JavaStackFrame.scala.html#348674" title="=&gt; String">fileName</a><span class="delimiter">)</span> <span title="(p: scala.tools.nsc.io.Fileish =&gt; Boolean)List[scala.tools.nsc.io.Fileish]">filter</span> <span class="delimiter">(</span><a href="#600375" title="scala.tools.nsc.io.Fileish">_</a>.<a href="../io/Fileish.scala.html#383695" title="=&gt; java.lang.String">pkgFromPath</a> <span title="(x$1: java.lang.String)Boolean">endsWith</span> <a href="#600367" title="scala.tools.nsc.util.JavaStackFrame">frame</a>.<a href="JavaStackFrame.scala.html#348677" title="=&gt; String">pkgName</a><span class="delimiter">)</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#600369" title="List[scala.tools.nsc.io.Fileish]">matches</a>.<span title="=&gt; Boolean">isEmpty</span> <span title="(x: Boolean)Boolean">||</span> <a href="#600369" title="List[scala.tools.nsc.io.Fileish]">matches</a>.<span title="=&gt; List[scala.tools.nsc.io.Fileish]">tail</span>.<span title="=&gt; Boolean">isEmpty</span><span class="delimiter">)</span>
      <span title="Nothing" class="keyword">return</span> <a href="#600369" title="List[scala.tools.nsc.io.Fileish]">matches</a>

    <span class="comment">// otherwise we'll drink them in and look for a package name</span>
    <a href="#600369" title="List[scala.tools.nsc.io.Fileish]">matches</a> <span title="(p: scala.tools.nsc.io.Fileish =&gt; Boolean)List[scala.tools.nsc.io.Fileish]">filter</span> <span class="delimiter">(</span><a href="#600383" title="scala.tools.nsc.io.Fileish">_</a>.<a href="../io/Fileish.scala.html#383697" title="=&gt; String">pkgFromSource</a> <span title="(x$1: java.lang.String)Boolean">endsWith</span> <a href="#600367" title="scala.tools.nsc.util.JavaStackFrame">frame</a>.<a href="JavaStackFrame.scala.html#348677" title="=&gt; String">pkgName</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/** Right now this punts if more than one match and it accepts the first at random.
   */</span>
  <span class="keyword">def</span> <a title="(sources: scala.tools.nsc.io.Sources, frame: scala.tools.nsc.util.JavaStackFrame)Option[scala.tools.nsc.io.Fileish]" id="108298">locateSource</a><span class="delimiter">(</span><a title="scala.tools.nsc.io.Sources" id="600171">sources</a>: <a href="../io/Sources.scala.html#21613" title="scala.tools.nsc.io.Sources">Sources</a>, <a title="scala.tools.nsc.util.JavaStackFrame" id="600172">frame</a>: <a href="JavaStackFrame.scala.html#30969" title="scala.tools.nsc.util.JavaStackFrame">JavaStackFrame</a><span class="delimiter">)</span>: <span title="Option[scala.tools.nsc.io.Fileish]">Option</span><span class="delimiter">[</span>Fileish<span class="delimiter">]</span> =
    <a href="#108297" title="(sources: scala.tools.nsc.io.Sources, frame: scala.tools.nsc.util.JavaStackFrame)List[scala.tools.nsc.io.Fileish]">locateSources</a><span class="delimiter">(</span><a href="#600171" title="scala.tools.nsc.io.Sources">sources</a>, <a href="#600172" title="scala.tools.nsc.util.JavaStackFrame">frame</a><span class="delimiter">)</span>.<span title="=&gt; Option[scala.tools.nsc.io.Fileish]">headOption</span>

  <span class="keyword">def</span> <a title="(ste: java.lang.StackTraceElement)Boolean" id="108299">isLocal</a><span class="delimiter">(</span><a title="java.lang.StackTraceElement" id="599984">ste</a>: <span title="java.lang.StackTraceElement">StackTraceElement</span><span class="delimiter">)</span> = <a href="#599984" title="java.lang.StackTraceElement">ste</a>.<span title="()java.lang.String">getClassName</span> <span title="(x$1: java.lang.String)Boolean">startsWith</span> <span class="keyword">this</span>.<span title="()java.lang.Class[_]">getClass</span>.<span title="()java.lang.String">getName</span>
  <span class="keyword">def</span> <a title="(x: Throwable)List[Throwable]" id="108300">causes</a><span class="delimiter">(</span><a title="Throwable" id="599444">x</a>: <span title="Throwable">Throwable</span><span class="delimiter">)</span>: <span title="List[Throwable]">List</span><span class="delimiter">[</span>Throwable<span class="delimiter">]</span> = <a href="#599444" title="Throwable">x</a>.<span title="()java.lang.Throwable">getCause</span> <span title="List[Throwable]" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <span title="scala.collection.immutable.Nil.type" class="keyword">null</span> =&gt; <span title="object Nil">Nil</span>
    <span class="keyword">case</span> <a title="List[Throwable]" id="600384">ex</a>   =&gt; <a href="#599444" title="Throwable">x</a> <a href="#600385" title="(x: Throwable)List[Throwable]">::</a> <a href="#108300" title="(x: Throwable)List[Throwable]">causes</a><span class="delimiter">(</span><a href="#600384" title="java.lang.Throwable">ex</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>
  <span class="keyword">def</span> <a title="(x: Throwable)Throwable" id="108301">unwrap</a><span class="delimiter">(</span><a title="Throwable" id="126530">x</a>: <span title="Throwable">Throwable</span><span class="delimiter">)</span>: <span title="Throwable">Throwable</span> = <a href="#126530" title="Throwable">x</a> <span title="Throwable" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span>  <span title="Throwable">_</span>: <span title="java.lang.reflect.InvocationTargetException">InvocationTargetException</span> | 
          _: <span title="java.lang.ExceptionInInitializerError">ExceptionInInitializerError</span> |
          _: <span title="java.lang.reflect.UndeclaredThrowableException">UndeclaredThrowableException</span> |
          _: <span title="java.util.concurrent.ExecutionException">ExecutionException</span>
            <span class="keyword">if</span> <a href="#126530" title="Throwable">x</a>.<span title="()java.lang.Throwable">getCause</span> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span> =&gt;
              <a href="#108301" title="(x: Throwable)Throwable">unwrap</a><span class="delimiter">(</span><a href="#126530" title="Throwable">x</a>.<span title="()java.lang.Throwable">getCause</span><span class="delimiter">)</span>

    <span class="keyword">case</span> <span title="Throwable">_</span> =&gt; <a href="#126530" title="Throwable">x</a>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>