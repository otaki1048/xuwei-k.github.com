<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>scala/tools/nsc/util/Exceptional.scala</title>
        <script type="text/javascript" src="../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> scala.tools.nsc
<span class="keyword">package</span> util

<span class="keyword">import</span> java.util.concurrent.ExecutionException
<span class="keyword">import</span> java.lang.reflect.<span class="delimiter">{</span> InvocationTargetException, UndeclaredThrowableException <span class="delimiter">}</span>
<span class="keyword">import</span> io.<span class="delimiter">{</span> Sources, Fileish <span class="delimiter">}</span>
<span class="keyword">import</span> scala.tools.util.<a href="../../util/StringOps.scala.html#31727" title="object scala.tools.util.StringOps">StringOps</a>._

<span class="comment">/** A simple throwable wrapper so it looks more like a parade of
 *  glittering frame-shaped beauties than the other thing.
 */</span>
<span class="keyword">class</span> <a title="class Exceptional extends java.lang.Object with ScalaObject" id="30593">Exceptional</a><a href="#30593" title="ScalaObject" class="delimiter">(</a><span class="keyword">val</span> <a title="Throwable" id="108200">ex</a>: <span title="Throwable">Throwable</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scala.tools.nsc.util.ScalaPrefs" id="108201">prefs</a>: <a href="ScalaPrefs.scala.html#31085" title="scala.tools.nsc.util.ScalaPrefs">ScalaPrefs</a><span class="delimiter">)</span> <span class="delimiter">{</span>
  <span class="keyword">val</span> <a title="scala.tools.nsc.util.Exceptional.Calibrated" id="108171">formatter</a>  = <a href="#108201" title="scala.tools.nsc.util.ScalaPrefs">prefs</a>.<a href="#599143" title="(ex: Throwable)scala.tools.nsc.util.Exceptional.Calibrated">exceptionFormatter</a><span class="delimiter">(</span><a href="#108200" title="=&gt; Throwable">ex</a><span class="delimiter">)</span>
  <span class="keyword">val</span> <a title="Throwable" id="108173">unwrapped</a>  = <a href="#30594" title="object scala.tools.nsc.util.Exceptional">Exceptional</a>.<a href="#108160" title="(x: Throwable)Throwable">unwrap</a><span class="delimiter">(</span><a href="#108200" title="=&gt; Throwable">ex</a><span class="delimiter">)</span>
  <span class="keyword">val</span> <a title="scala.tools.nsc.util.TableDef[scala.tools.nsc.util.JavaStackFrame]#Table" id="108175">table</a>      = <a href="#108171" title="=&gt; scala.tools.nsc.util.Exceptional.Calibrated">formatter</a>.<a href="#599155" title="(ex: Throwable)scala.tools.nsc.util.TableDef[scala.tools.nsc.util.JavaStackFrame]#Table">newTable</a><span class="delimiter">(</span><a href="#108173" title="=&gt; Throwable">unwrapped</a><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="()Unit" id="108177">rawTrace</a><span class="delimiter">(</span><span class="delimiter">)</span> = <a href="#108173" title="=&gt; Throwable">unwrapped</a>.<span title="()Unit">printStackTrace</span><span class="delimiter">(</span><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="=&gt; Boolean" id="108178">isScanDone</a> = <a href="#108201" title="scala.tools.nsc.util.ScalaPrefs">prefs</a>.<a href="ScalaPrefs.scala.html#108202" title="=&gt; scala.tools.nsc.io.Sources">codeSources</a>.<a href="../io/Sources.scala.html#342935" title="()Boolean">isDone</a><span class="delimiter">(</span><span class="delimiter">)</span>

  <span class="comment">/** Block until the scanning is complete. */</span>
  <span class="keyword">def</span> <a title="()Exceptional.this.type" id="108179">force</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span class="keyword">this</span>.<span class="keyword">type</span> = <span class="delimiter">{</span>
    <a href="#108201" title="scala.tools.nsc.util.ScalaPrefs">prefs</a>.<a href="ScalaPrefs.scala.html#108202" title="=&gt; scala.tools.nsc.io.Sources">codeSources</a>.<a href="../io/Sources.scala.html#342937" title="()Unit">force</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <a href="#30593" title="Exceptional.this.type" class="keyword">this</a>
  <span class="delimiter">}</span>

  <span class="comment">/** Stack frame contexts are only shown as long as this is true. */</span>
  <span class="keyword">def</span> <a title="(frame: scala.tools.nsc.util.JavaStackFrame)Boolean" id="108180">spanFn</a><span class="delimiter">(</span><a title="scala.tools.nsc.util.JavaStackFrame" id="348601">frame</a>: <a href="JavaStackFrame.scala.html#30980" title="scala.tools.nsc.util.JavaStackFrame">JavaStackFrame</a><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> = <span title="Boolean(true)" class="keyword">true</span>
  
  <span class="comment">/** The result of this will be printed before a context trace. */</span>
  <span class="keyword">def</span> <a title="=&gt; String" id="108181">contextPrelude</a>: <span title="String">String</span> =
    <span title="String" class="keyword">if</span> <span class="delimiter">(</span><a href="#108178" title="=&gt; Boolean">isScanDone</a><span class="delimiter">)</span> <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span>
    <span class="keyword">else</span> <span title="java.lang.String(&quot;/* Still scanning source path: there may be more momentarily. */\012&quot;)" class="string">&quot;/* Still scanning source path: there may be more momentarily. */\n&quot;</span>
  
  <span class="comment">/** Frames with surrounding context. */</span>
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="=&gt; List[scala.tools.nsc.util.JavaStackFrame]" id="108182">contextFrames</a>     = <a href="#108188" title="=&gt; List[scala.tools.nsc.util.JavaStackFrame]">toList</a> <span title="(p: scala.tools.nsc.util.JavaStackFrame =&gt; Boolean)List[scala.tools.nsc.util.JavaStackFrame]">takeWhile</span> <a href="#108180" title="(frame: scala.tools.nsc.util.JavaStackFrame)Boolean">spanFn</a>
  <span class="keyword">def</span> <a title="()String" id="108183">contextHead</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="String">String</span>     = <a href="#108184" title="()List[String]">contextElems</a>.<span title="=&gt; Option[String]">headOption</span> <span title="(default: =&gt; String)String">getOrElse</span> <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span>
  <span class="keyword">def</span> <a title="()List[String]" id="108184">contextElems</a><span class="delimiter">(</span><span class="delimiter">)</span>            = <a href="#108182" title="=&gt; List[scala.tools.nsc.util.JavaStackFrame]">contextFrames</a> <span title="(f: scala.tools.nsc.util.JavaStackFrame =&gt; String)(implicit bf: scala.collection.generic.CanBuildFrom[List[scala.tools.nsc.util.JavaStackFrame],String,List[String]])List[String]">map</span> <a href="#108171" title="=&gt; scala.tools.nsc.util.Exceptional.Calibrated">formatter</a>.<a href="#599156" title="(frame: scala.tools.nsc.util.JavaStackFrame)String">inContext</a>
  <span class="keyword">def</span> <a title="()String" id="108185">context</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="String">String</span>         = <a href="#108186" title="(num: Int)String">context</a><span class="delimiter">(</span><a href="#108187" title="=&gt; Int">length</a><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="(num: Int)String" id="108186">context</a><span class="delimiter">(</span><a title="Int" id="108217">num</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="String">String</span> = <a href="#108181" title="=&gt; String">contextPrelude</a> <span title="(x$1: Any)java.lang.String">+</span> <a href="../../util/StringOps.scala.html#72442" title="(xs: Seq[String], sep: String, orElse: String)String">ojoinOr</a><span class="delimiter">(</span><a href="#108182" title="=&gt; List[scala.tools.nsc.util.JavaStackFrame]">contextFrames</a> <span title="(n: Int)List[scala.tools.nsc.util.JavaStackFrame]">take</span> <a href="#108217" title="Int">num</a> <span title="(f: scala.tools.nsc.util.JavaStackFrame =&gt; String)(implicit bf: scala.collection.generic.CanBuildFrom[List[scala.tools.nsc.util.JavaStackFrame],String,Seq[String]])Seq[String]">map</span> <a href="#108171" title="=&gt; scala.tools.nsc.util.Exceptional.Calibrated">formatter</a>.<a href="#599156" title="(frame: scala.tools.nsc.util.JavaStackFrame)String">inContext</a>, <span title="java.lang.String(&quot;\012&quot;)" class="string">&quot;\n&quot;</span>, <span title="java.lang.String(&quot;No stack trace.&quot;)" class="string">&quot;No stack trace.&quot;</span><span class="delimiter">)</span>  
  
  <span class="comment">/** Exceptional doesn't extend Seq because it turns out to be super 
   *  annoying in the repl: tab-completion sees all the Seq methods.
   */</span>
  <span class="keyword">def</span> <a title="=&gt; Int" id="108187">length</a>            = <a href="#108188" title="=&gt; List[scala.tools.nsc.util.JavaStackFrame]">toList</a>.<span title="=&gt; Int">length</span>
  <span class="keyword">def</span> <a title="=&gt; List[scala.tools.nsc.util.JavaStackFrame]" id="108188">toList</a>            = <a href="#108175" title="=&gt; scala.tools.nsc.util.TableDef[scala.tools.nsc.util.JavaStackFrame]#Table">table</a>.<span title="=&gt; List[scala.tools.nsc.util.JavaStackFrame]">toList</span>
  <span class="keyword">def</span> <a title="=&gt; Iterator[scala.tools.nsc.util.JavaStackFrame]" id="108189">iterator</a>          = <a href="#108175" title="=&gt; scala.tools.nsc.util.TableDef[scala.tools.nsc.util.JavaStackFrame]#Table">table</a>.<a href="TableDef.scala.html#121676" title="=&gt; Iterator[scala.tools.nsc.util.JavaStackFrame]">iterator</a>
  <span class="keyword">def</span> <a title="(index: Int)scala.tools.nsc.util.JavaStackFrame" id="108190">apply</a><span class="delimiter">(</span><a title="Int" id="599332">index</a>: <span title="Int">Int</span><span class="delimiter">)</span> = <a href="TableDef.scala.html#121677" title="(index: Int)scala.tools.nsc.util.JavaStackFrame">table</a><span class="delimiter">(</span><a href="#599332" title="Int">index</a><span class="delimiter">)</span>
  
  <span class="keyword">def</span> <a title="=&gt; List[Throwable]" id="108191">causes</a>  = <a href="#30594" title="object scala.tools.nsc.util.Exceptional">Exceptional</a>.<a href="#108159" title="(x: Throwable)List[Throwable]">causes</a><span class="delimiter">(</span><a href="#108200" title="=&gt; Throwable">ex</a><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="=&gt; java.lang.String" id="108192">summary</a> = <a href="#108173" title="=&gt; Throwable">unwrapped</a>.<span title="()java.lang.String">toString</span> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;\012  at &quot;)" class="string">&quot;\n  at &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#108190" title="(index: Int)scala.tools.nsc.util.JavaStackFrame">apply</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>.<a href="JavaStackFrame.scala.html#348623" title="=&gt; String">shortNameString</a>
  
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(msg: Any)Unit" id="108193">println</a><span class="delimiter">(</span><a title="Any" id="599638">msg</a>: <span title="Any">Any</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span title="object Console">Console</span> <span title="(x: Any)Unit">println</span> <a href="#599638" title="Any">msg</a>
    <span title="object Console">Console</span>.<span title="()Unit">flush</span><span class="delimiter">(</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="()Unit" id="108194">show</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="Unit">Unit</span>         = <a href="#108193" title="(msg: Any)Unit">println</a><span class="delimiter">(</span><a href="#108185" title="()String">context</a><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="(num: Int)Unit" id="108195">show</a><span class="delimiter">(</span><a title="Int" id="381301">num</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <a href="#108193" title="(msg: Any)Unit">println</a><span class="delimiter">(</span><a href="#108186" title="(num: Int)String">context</a><span class="delimiter">(</span><a href="#381301" title="Int">num</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="()Unit" id="108196">showCauses</a><span class="delimiter">(</span><span class="delimiter">)</span>         = <a href="#108193" title="(msg: Any)Unit">println</a><span class="delimiter">(</span><span class="delimiter">(</span><a href="#108200" title="=&gt; Throwable">ex</a> <a href="#599653" title="(x: Throwable)List[Throwable]">::</a> <a href="#108191" title="=&gt; List[Throwable]">causes</a><span class="delimiter">)</span>.<span title="(start: String, sep: String, end: String)String">mkString</span><span class="delimiter">(</span><span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span>, <span title="java.lang.String(&quot;\012  caused by -&gt; &quot;)" class="string">&quot;\n  caused by -&gt; &quot;</span>, <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="()Unit" id="108197">showTable</a><span class="delimiter">(</span><span class="delimiter">)</span>          = <a href="#108193" title="(msg: Any)Unit">println</a><span class="delimiter">(</span><a href="#108175" title="=&gt; scala.tools.nsc.util.TableDef[scala.tools.nsc.util.JavaStackFrame]#Table">table</a><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="()Unit" id="108198">showSummary</a><span class="delimiter">(</span><span class="delimiter">)</span>        = <a href="#108193" title="(msg: Any)Unit">println</a><span class="delimiter">(</span><a href="#108192" title="=&gt; java.lang.String">summary</a><span class="delimiter">)</span>
  
  <span class="keyword">override</span> <span class="keyword">def</span> <a title="()java.lang.String" id="108199">toString</a> = <a href="#108192" title="=&gt; java.lang.String">summary</a>
<span class="delimiter">}</span>


<span class="keyword">object</span> <a title="object scala.tools.nsc.util.Exceptional" id="30594">Exceptional</a> <span title="ScalaObject" class="delimiter">{</span>
  <span class="keyword">type</span> <a title="[+T]PartialFunction[Throwable,T]" id="108140">Catcher</a><span class="delimiter">[</span>+<a title="&gt;: Nothing &lt;: Any" id="108141">T</a><span class="delimiter">]</span> = <span title="PartialFunction[Throwable,T]">PartialFunction</span><span class="delimiter">[</span>Throwable, T<span class="delimiter">]</span>
  
  <span class="comment">/** Creates an exception handler which will only ever catch the given
   *  number of exceptions (if the given pf is defined there) and after
   *  that will disable itself.
   */</span>
  <span class="keyword">def</span> <a title="[T](numCatches: Int)(pf: scala.tools.nsc.util.Exceptional.Catcher[T])scala.tools.nsc.util.Exceptional.Catcher[T]" id="108142">expiringHandler</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="108144">T</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="Int" id="541052">numCatches</a>: <span title="Int">Int</span><span class="delimiter">)</span><span class="delimiter">(</span><a title="scala.tools.nsc.util.Exceptional.Catcher[T]" id="541053">pf</a>: <span title="scala.tools.nsc.util.Exceptional.Catcher[T]">Catcher</span><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="scala.tools.nsc.util.Exceptional.Catcher[T]">Catcher</span><span class="delimiter">[</span>T<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">var</span> <a title="Int" id="599674">remaining</a> = <a href="#541052" title="Int">numCatches</a>;
    <a href="#599676" title="T" class="delimiter">{</a> <span class="keyword">case</span> <a title="T" id="599677">ex</a>: <span title="Throwable">Throwable</span> <span class="keyword">if</span> <a href="#599674" title="Int">remaining</a> <span title="(x: Int)Boolean">&gt;</span> <span title="Int(0)" class="int">0</span> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#541053" title="scala.tools.nsc.util.Exceptional.Catcher[T]">pf</a>.<span title="(x: Throwable)Boolean">isDefinedAt</span><span class="delimiter">(</span><a href="#599677" title="java.lang.Throwable">ex</a><span class="delimiter">)</span> =&gt;
        <a href="#599674" title="Int">remaining</a> <span title="(x: Int)Int">-=</span> <span title="Int(1)" class="int">1</span>
        <a href="#541053" title="(v1: Throwable)T">pf</a><span class="delimiter">(</span><a href="#599677" title="java.lang.Throwable">ex</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
  
  <span class="comment">/** The Throwable =&gt; Exceptional implicit plus the associated factory. */</span>
  <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="implicit scala.tools.nsc.util.Exceptional.throwableToExceptional : (ex: Throwable)(implicit prefs: scala.tools.nsc.util.ScalaPrefs)scala.tools.nsc.util.Exceptional" id="108145">throwableToExceptional</a><span class="delimiter">(</span><a title="Throwable" id="599393">ex</a>: <span title="Throwable">Throwable</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scala.tools.nsc.util.ScalaPrefs" id="599394">prefs</a>: <a href="ScalaPrefs.scala.html#31085" title="scala.tools.nsc.util.ScalaPrefs">ScalaPrefs</a><span class="delimiter">)</span>: <a href="#30593" title="scala.tools.nsc.util.Exceptional">Exceptional</a> = <a href="#108146" title="(ex: Throwable)(implicit prefs: scala.tools.nsc.util.ScalaPrefs)scala.tools.nsc.util.Exceptional">apply</a><span class="delimiter">(</span><a href="#599393" title="Throwable">ex</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#599394" title="scala.tools.nsc.util.ScalaPrefs">prefs</a><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="(ex: Throwable)(implicit prefs: scala.tools.nsc.util.ScalaPrefs)scala.tools.nsc.util.Exceptional" id="108146">apply</a><span class="delimiter">(</span><a title="Throwable" id="108161">ex</a>: <span title="Throwable">Throwable</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scala.tools.nsc.util.ScalaPrefs" id="108162">prefs</a>: <a href="ScalaPrefs.scala.html#31085" title="scala.tools.nsc.util.ScalaPrefs">ScalaPrefs</a><span class="delimiter">)</span> = <span title="scala.tools.nsc.util.Exceptional" class="keyword">new</span> <a href="#30593" title="scala.tools.nsc.util.Exceptional">Exceptional</a><span class="delimiter">(</span><a href="#108161" title="Throwable">ex</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#108162" title="scala.tools.nsc.util.ScalaPrefs">prefs</a><span class="delimiter">)</span>

  <span class="comment">/** Some handy functions. */</span>
  <span class="keyword">def</span> <a title="()Array[scala.tools.nsc.util.JavaStackFrame]" id="108147">stack</a><span class="delimiter">(</span><span class="delimiter">)</span>  = <a href="JavaStackFrame.scala.html#30981" title="object scala.tools.nsc.util.JavaStackFrame">JavaStackFrame</a> <a href="JavaStackFrame.scala.html#599218" title="(xs: Array[java.lang.StackTraceElement])Array[scala.tools.nsc.util.JavaStackFrame]">frames</a> <span class="delimiter">(</span><span class="delimiter">(</span><span title="java.lang.Throwable" class="keyword">new</span> <span title="java.lang.Throwable">Throwable</span><span class="delimiter">)</span>.<span title="(xs: Array[java.lang.StackTraceElement])scala.collection.mutable.ArrayOps[java.lang.StackTraceElement]">getStackTrace</span> <span title="(p: java.lang.StackTraceElement =&gt; Boolean)Array[java.lang.StackTraceElement]">dropWhile</span> <a href="#108158" title="(ste: java.lang.StackTraceElement)Boolean">isLocal</a><span class="delimiter">)</span>  
  <span class="keyword">def</span> <a title="()Unit" id="108148">showme</a><span class="delimiter">(</span><span class="delimiter">)</span> = <a href="#108146" title="(ex: Throwable)(implicit prefs: scala.tools.nsc.util.ScalaPrefs)scala.tools.nsc.util.Exceptional">apply</a><a href="ScalaPrefs.scala.html#108205" title="object scala.tools.nsc.util.ScalaPrefs.DefaultScalaPrefs" class="delimiter">(</a><span title="java.lang.Throwable" class="keyword">new</span> <span title="java.lang.Throwable">Throwable</span><span class="delimiter">)</span>.<a href="#108194" title="()Unit">show</a><span class="delimiter">(</span><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="()Unit" id="108149">showstack</a><span class="delimiter">(</span><span class="delimiter">)</span> = <a href="#108146" title="(ex: Throwable)(implicit prefs: scala.tools.nsc.util.ScalaPrefs)scala.tools.nsc.util.Exceptional">apply</a><a href="ScalaPrefs.scala.html#108205" title="object scala.tools.nsc.util.ScalaPrefs.DefaultScalaPrefs" class="delimiter">(</a><span title="java.lang.Throwable" class="keyword">new</span> <span title="java.lang.Throwable">Throwable</span><span class="delimiter">)</span>.<a href="#108197" title="()Unit">showTable</a><span class="delimiter">(</span><span class="delimiter">)</span>

  <span class="comment">/** A frame formatter with more refined aesthetics than the default.
   *  Come, let us be civilized.
   */</span>
  <span class="keyword">object</span> <a title="object scala.tools.nsc.util.Exceptional.ScalaFormat" id="108150">ScalaFormat</a> <span title="ScalaObject" class="keyword">extends</span> <a href="TableDef.scala.html#30386" title="scala.tools.nsc.util.TableDef[scala.tools.nsc.util.JavaStackFrame]">TableDef</a><span class="delimiter">[</span>JavaStackFrame<span class="delimiter">]</span> <span class="delimiter">{</span>
      <a href="TableDef.scala.html#121642" title="(pair: (String, scala.tools.nsc.util.JavaStackFrame =&gt; Any))scala.tools.nsc.util.TableDef[scala.tools.nsc.util.JavaStackFrame]">&gt;&gt;</a> <span class="delimiter">(</span><span title="(x: java.lang.String)ArrowAssoc[java.lang.String]" class="string">&quot;file&quot;</span>    <span title="(y: scala.tools.nsc.util.JavaStackFrame =&gt; String)(java.lang.String, scala.tools.nsc.util.JavaStackFrame =&gt; String)">-&gt;</span> <span class="delimiter">(</span><a href="#599960" title="scala.tools.nsc.util.JavaStackFrame">_</a>.<a href="JavaStackFrame.scala.html#348611" title="=&gt; String">fileName</a><span class="delimiter">)</span><span class="delimiter">)</span>   <a href="TableDef.scala.html#121644" title="(sep: String)scala.tools.nsc.util.TableDef[scala.tools.nsc.util.JavaStackFrame]">&gt;+</a> <span title="java.lang.String(&quot;:&quot;)" class="string">&quot;:&quot;</span>
      <a href="TableDef.scala.html#121643" title="(pair: (String, scala.tools.nsc.util.JavaStackFrame =&gt; Any))scala.tools.nsc.util.TableDef[scala.tools.nsc.util.JavaStackFrame]">&lt;&lt;</a> <span class="delimiter">(</span><span title="(x: java.lang.String)ArrowAssoc[java.lang.String]" class="string">&quot;line&quot;</span>    <span title="(y: scala.tools.nsc.util.JavaStackFrame =&gt; Int)(java.lang.String, scala.tools.nsc.util.JavaStackFrame =&gt; Int)">-&gt;</span> <span class="delimiter">(</span><a href="#599979" title="scala.tools.nsc.util.JavaStackFrame">_</a>.<a href="JavaStackFrame.scala.html#348612" title="=&gt; Int">line</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="TableDef.scala.html#121642" title="(pair: (String, scala.tools.nsc.util.JavaStackFrame =&gt; Any))scala.tools.nsc.util.TableDef[scala.tools.nsc.util.JavaStackFrame]">&gt;&gt;</a> <span class="delimiter">(</span><span title="(x: java.lang.String)ArrowAssoc[java.lang.String]" class="string">&quot;class&quot;</span>   <span title="(y: scala.tools.nsc.util.JavaStackFrame =&gt; java.lang.String)(java.lang.String, scala.tools.nsc.util.JavaStackFrame =&gt; java.lang.String)">-&gt;</span> <span class="delimiter">(</span><a href="#599997" title="scala.tools.nsc.util.JavaStackFrame">_</a>.<a href="JavaStackFrame.scala.html#348618" title="=&gt; java.lang.String">shortestName</a><span class="delimiter">)</span><span class="delimiter">)</span>  <a href="TableDef.scala.html#121644" title="(sep: String)scala.tools.nsc.util.TableDef[scala.tools.nsc.util.JavaStackFrame]">&gt;+</a> <span title="java.lang.String(&quot;.&quot;)" class="string">&quot;.&quot;</span>
      <a href="TableDef.scala.html#121643" title="(pair: (String, scala.tools.nsc.util.JavaStackFrame =&gt; Any))scala.tools.nsc.util.TableDef[scala.tools.nsc.util.JavaStackFrame]">&lt;&lt;</a> <span class="delimiter">(</span><span title="(x: java.lang.String)ArrowAssoc[java.lang.String]" class="string">&quot;method&quot;</span>  <span title="(y: scala.tools.nsc.util.JavaStackFrame =&gt; String)(java.lang.String, scala.tools.nsc.util.JavaStackFrame =&gt; String)">-&gt;</span> <span class="delimiter">(</span><a href="#600017" title="scala.tools.nsc.util.JavaStackFrame">_</a>.<a href="JavaStackFrame.scala.html#348610" title="=&gt; String">methodName</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>
  
  <span class="keyword">trait</span> <a title="trait Calibrated extends java.lang.Object" id="108152">Calibrated</a> <span title="java.lang.Object" class="delimiter">{</span>
    <span class="keyword">def</span> <a title="(ex: Throwable)scala.tools.nsc.util.TableDef[scala.tools.nsc.util.JavaStackFrame]#Table" id="599155">newTable</a><span class="delimiter">(</span><a title="Throwable" id="599157">ex</a>: <span title="Throwable">Throwable</span><span class="delimiter">)</span>: TableDef<span class="delimiter">[</span>JavaStackFrame<span class="delimiter">]</span>#<a href="TableDef.scala.html#121659" title="scala.tools.nsc.util.TableDef[scala.tools.nsc.util.JavaStackFrame]#Table">Table</a>
    <span class="keyword">def</span> <a title="(frame: scala.tools.nsc.util.JavaStackFrame)String" id="599156">inContext</a><span class="delimiter">(</span><a title="scala.tools.nsc.util.JavaStackFrame" id="599209">frame</a>: <a href="JavaStackFrame.scala.html#30980" title="scala.tools.nsc.util.JavaStackFrame">JavaStackFrame</a><span class="delimiter">)</span>: <span title="String">String</span>
  <span class="delimiter">}</span>
  <span class="keyword">trait</span> <a title="trait Formatter extends java.lang.Object with Throwable =&gt; scala.tools.nsc.util.Exceptional.Calibrated" id="108153">Formatter</a> <span class="keyword">extends</span> <span class="delimiter">(</span>Throwable =&gt; Calibrated<span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="(ex: Throwable)scala.tools.nsc.util.Exceptional.Calibrated" id="599143">apply</a><span class="delimiter">(</span><a title="Throwable" id="599145">ex</a>: <span title="Throwable">Throwable</span><span class="delimiter">)</span>: <a href="#108152" title="scala.tools.nsc.util.Exceptional.Calibrated">Calibrated</a>
  <span class="delimiter">}</span>
  <span class="keyword">object</span> <a title="object scala.tools.nsc.util.Exceptional.Formatter" id="108154">Formatter</a> <span title="ScalaObject" class="delimiter">{</span>
    <span class="keyword">def</span> <a title="(implicit prefs: scala.tools.nsc.util.ScalaPrefs)scala.tools.nsc.util.Exceptional.Formatter" id="600024">apply</a><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scala.tools.nsc.util.ScalaPrefs" id="600026">prefs</a>: <a href="ScalaPrefs.scala.html#31085" title="scala.tools.nsc.util.ScalaPrefs">ScalaPrefs</a><span class="delimiter">)</span>: <a href="#108153" title="scala.tools.nsc.util.Exceptional.Formatter">Formatter</a> = <a href="#600028" title="java.lang.Object with scala.tools.nsc.util.Exceptional.Formatter" class="keyword">new</a> <a title="anonymous class $anon extends java.lang.Object with scala.tools.nsc.util.Exceptional.Formatter" id="600028">Formatter</a> <span class="delimiter">{</span>
      <span class="keyword">def</span> <a title="(ex: Throwable)java.lang.Object with scala.tools.nsc.util.Exceptional.Calibrated{def newTable(ex: Throwable): scala.tools.nsc.util.Exceptional.ScalaFormat.Table}" id="600033">apply</a><span class="delimiter">(</span><a title="Throwable" id="600034">ex</a>: <span title="Throwable">Throwable</span><span class="delimiter">)</span> = <a href="#600039" title="java.lang.Object with scala.tools.nsc.util.Exceptional.Calibrated" class="keyword">new</a> <a title="anonymous class $anon extends java.lang.Object with scala.tools.nsc.util.Exceptional.Calibrated" id="600039">Calibrated</a> <span class="delimiter">{</span>
        <span class="keyword">def</span> <a title="(ex: Throwable)scala.tools.nsc.util.Exceptional.ScalaFormat.Table" id="600043">newTable</a><span class="delimiter">(</span><a title="Throwable" id="600045">ex</a>: <span title="Throwable">Throwable</span><span class="delimiter">)</span>          = <span title="scala.tools.nsc.util.Exceptional.ScalaFormat.Table" class="keyword">new</span> <a href="#108150" title="object scala.tools.nsc.util.Exceptional.ScalaFormat">ScalaFormat</a>.<a href="TableDef.scala.html#121659" title="scala.tools.nsc.util.Exceptional.ScalaFormat.Table">Table</a><span class="delimiter">(</span><a href="JavaStackFrame.scala.html#30981" title="object scala.tools.nsc.util.JavaStackFrame">JavaStackFrame</a> <a href="JavaStackFrame.scala.html#599219" title="(xs: Array[scala.tools.nsc.util.JavaStackFrame])scala.collection.mutable.WrappedArray[scala.tools.nsc.util.JavaStackFrame]">frames</a> <a href="#600045" title="Throwable">ex</a><span class="delimiter">)</span>
        <span class="keyword">def</span> <a title="(frame: scala.tools.nsc.util.JavaStackFrame)java.lang.String" id="600044">inContext</a><span class="delimiter">(</span><a title="scala.tools.nsc.util.JavaStackFrame" id="600083">frame</a>: <a href="JavaStackFrame.scala.html#30980" title="scala.tools.nsc.util.JavaStackFrame">JavaStackFrame</a><span class="delimiter">)</span> = <span title="scala.tools.nsc.util.FrameContext" class="keyword">new</span> <a href="JavaStackFrame.scala.html#30746" title="scala.tools.nsc.util.FrameContext">FrameContext</a><span class="delimiter">(</span><a href="#600083" title="scala.tools.nsc.util.JavaStackFrame">frame</a>, <a href="#600026" title="scala.tools.nsc.util.ScalaPrefs">prefs</a>.<a href="ScalaPrefs.scala.html#108202" title="=&gt; scala.tools.nsc.io.Sources">codeSources</a><span class="delimiter">)</span> <a href="JavaStackFrame.scala.html#600101" title="()java.lang.String">toString</a>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="comment">/** Java stack traces have the interesting property of using only the name
   *  of the file, no paths.  This makes it a bit of a gamble to try to associate
   *  a stack frame with a specific file.  Witness the heuristic.
   */</span>
  <span class="keyword">def</span> <a title="(sources: scala.tools.nsc.io.Sources, frame: scala.tools.nsc.util.JavaStackFrame)List[scala.tools.nsc.io.Fileish]" id="108156">locateSources</a><span class="delimiter">(</span><a title="scala.tools.nsc.io.Sources" id="600303">sources</a>: <a href="../io/Sources.scala.html#21624" title="scala.tools.nsc.io.Sources">Sources</a>, <a title="scala.tools.nsc.util.JavaStackFrame" id="600304">frame</a>: <a href="JavaStackFrame.scala.html#30980" title="scala.tools.nsc.util.JavaStackFrame">JavaStackFrame</a><span class="delimiter">)</span>: <span title="List[scala.tools.nsc.io.Fileish]">List</span><span class="delimiter">[</span>Fileish<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="comment">// if only one has a matching path, that's fairly sure to be the one</span>
    <span class="keyword">val</span> <a title="List[scala.tools.nsc.io.Fileish]" id="600306">matches</a> = <a href="../io/Sources.scala.html#342922" title="(name: String)List[scala.tools.nsc.io.Fileish]">sources</a><span class="delimiter">(</span><a href="#600304" title="scala.tools.nsc.util.JavaStackFrame">frame</a>.<a href="JavaStackFrame.scala.html#348611" title="=&gt; String">fileName</a><span class="delimiter">)</span> <span title="(p: scala.tools.nsc.io.Fileish =&gt; Boolean)List[scala.tools.nsc.io.Fileish]">filter</span> <span class="delimiter">(</span><a href="#600312" title="scala.tools.nsc.io.Fileish">_</a>.<a href="../io/Fileish.scala.html#383632" title="=&gt; java.lang.String">pkgFromPath</a> <span title="(x$1: java.lang.String)Boolean">endsWith</span> <a href="#600304" title="scala.tools.nsc.util.JavaStackFrame">frame</a>.<a href="JavaStackFrame.scala.html#348614" title="=&gt; String">pkgName</a><span class="delimiter">)</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#600306" title="List[scala.tools.nsc.io.Fileish]">matches</a>.<span title="=&gt; Boolean">isEmpty</span> <span title="(x: Boolean)Boolean">||</span> <a href="#600306" title="List[scala.tools.nsc.io.Fileish]">matches</a>.<span title="=&gt; List[scala.tools.nsc.io.Fileish]">tail</span>.<span title="=&gt; Boolean">isEmpty</span><span class="delimiter">)</span>
      <span title="Nothing" class="keyword">return</span> <a href="#600306" title="List[scala.tools.nsc.io.Fileish]">matches</a>

    <span class="comment">// otherwise we'll drink them in and look for a package name</span>
    <a href="#600306" title="List[scala.tools.nsc.io.Fileish]">matches</a> <span title="(p: scala.tools.nsc.io.Fileish =&gt; Boolean)List[scala.tools.nsc.io.Fileish]">filter</span> <span class="delimiter">(</span><a href="#600320" title="scala.tools.nsc.io.Fileish">_</a>.<a href="../io/Fileish.scala.html#383634" title="=&gt; String">pkgFromSource</a> <span title="(x$1: java.lang.String)Boolean">endsWith</span> <a href="#600304" title="scala.tools.nsc.util.JavaStackFrame">frame</a>.<a href="JavaStackFrame.scala.html#348614" title="=&gt; String">pkgName</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/** Right now this punts if more than one match and it accepts the first at random.
   */</span>
  <span class="keyword">def</span> <a title="(sources: scala.tools.nsc.io.Sources, frame: scala.tools.nsc.util.JavaStackFrame)Option[scala.tools.nsc.io.Fileish]" id="108157">locateSource</a><span class="delimiter">(</span><a title="scala.tools.nsc.io.Sources" id="600108">sources</a>: <a href="../io/Sources.scala.html#21624" title="scala.tools.nsc.io.Sources">Sources</a>, <a title="scala.tools.nsc.util.JavaStackFrame" id="600109">frame</a>: <a href="JavaStackFrame.scala.html#30980" title="scala.tools.nsc.util.JavaStackFrame">JavaStackFrame</a><span class="delimiter">)</span>: <span title="Option[scala.tools.nsc.io.Fileish]">Option</span><span class="delimiter">[</span>Fileish<span class="delimiter">]</span> =
    <a href="#108156" title="(sources: scala.tools.nsc.io.Sources, frame: scala.tools.nsc.util.JavaStackFrame)List[scala.tools.nsc.io.Fileish]">locateSources</a><span class="delimiter">(</span><a href="#600108" title="scala.tools.nsc.io.Sources">sources</a>, <a href="#600109" title="scala.tools.nsc.util.JavaStackFrame">frame</a><span class="delimiter">)</span>.<span title="=&gt; Option[scala.tools.nsc.io.Fileish]">headOption</span>

  <span class="keyword">def</span> <a title="(ste: java.lang.StackTraceElement)Boolean" id="108158">isLocal</a><span class="delimiter">(</span><a title="java.lang.StackTraceElement" id="599921">ste</a>: <span title="java.lang.StackTraceElement">StackTraceElement</span><span class="delimiter">)</span> = <a href="#599921" title="java.lang.StackTraceElement">ste</a>.<span title="()java.lang.String">getClassName</span> <span title="(x$1: java.lang.String)Boolean">startsWith</span> <span class="keyword">this</span>.<span title="()java.lang.Class[_]">getClass</span>.<span title="()java.lang.String">getName</span>
  <span class="keyword">def</span> <a title="(x: Throwable)List[Throwable]" id="108159">causes</a><span class="delimiter">(</span><a title="Throwable" id="599381">x</a>: <span title="Throwable">Throwable</span><span class="delimiter">)</span>: <span title="List[Throwable]">List</span><span class="delimiter">[</span>Throwable<span class="delimiter">]</span> = <a href="#599381" title="Throwable">x</a>.<span title="()java.lang.Throwable">getCause</span> <span title="List[Throwable]" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <span title="scala.collection.immutable.Nil.type" class="keyword">null</span> =&gt; <span title="object Nil">Nil</span>
    <span class="keyword">case</span> <a title="List[Throwable]" id="600321">ex</a>   =&gt; <a href="#599381" title="Throwable">x</a> <a href="#600322" title="(x: Throwable)List[Throwable]">::</a> <a href="#108159" title="(x: Throwable)List[Throwable]">causes</a><span class="delimiter">(</span><a href="#600321" title="java.lang.Throwable">ex</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>
  <span class="keyword">def</span> <a title="(x: Throwable)Throwable" id="108160">unwrap</a><span class="delimiter">(</span><a title="Throwable" id="126352">x</a>: <span title="Throwable">Throwable</span><span class="delimiter">)</span>: <span title="Throwable">Throwable</span> = <a href="#126352" title="Throwable">x</a> <span title="Throwable" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span>  <span title="Throwable">_</span>: <span title="java.lang.reflect.InvocationTargetException">InvocationTargetException</span> | 
          _: <span title="java.lang.ExceptionInInitializerError">ExceptionInInitializerError</span> |
          _: <span title="java.lang.reflect.UndeclaredThrowableException">UndeclaredThrowableException</span> |
          _: <span title="java.util.concurrent.ExecutionException">ExecutionException</span>
            <span class="keyword">if</span> <a href="#126352" title="Throwable">x</a>.<span title="()java.lang.Throwable">getCause</span> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span> =&gt;
              <a href="#108160" title="(x: Throwable)Throwable">unwrap</a><span class="delimiter">(</span><a href="#126352" title="Throwable">x</a>.<span title="()java.lang.Throwable">getCause</span><span class="delimiter">)</span>

    <span class="keyword">case</span> <span title="Throwable">_</span> =&gt; <a href="#126352" title="Throwable">x</a>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>