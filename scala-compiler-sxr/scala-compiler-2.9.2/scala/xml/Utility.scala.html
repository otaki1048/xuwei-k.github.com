<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>scala/xml/Utility.scala</title>
        <script type="text/javascript" src="../../jquery-all.js"></script>
        <script type="text/javascript" src="../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/*                     __                                               *\
**     ________ ___   / /  ___     Scala API                            **
**    / __/ __// _ | / /  / _ |    (c) 2003-2011, LAMP/EPFL             **
**  __\ \/ /__/ __ |/ /__/ __ |    http://scala-lang.org/               **
** /____/\___/_/ |_/____/_/ | |                                         **
**                          |/                                          **
\*                                                                      */</span>



<span class="keyword">package</span> scala.xml

<span class="keyword">import</span> collection.mutable
<span class="keyword">import</span> mutable.<span class="delimiter">{</span> Set, HashSet <span class="delimiter">}</span>
<span class="keyword">import</span> parsing.XhtmlEntities

<span class="comment">/**
 * The &lt;code&gt;Utility&lt;/code&gt; object provides utility functions for processing
 * instances of bound and not bound XML classes, as well as escaping text nodes.
 *
 * @author Burak Emir
 */</span>
<span class="keyword">object</span> <a title="object scala.xml.Utility" id="46093">Utility</a> <a href="../ScalaObject.scala.html#464" title="ScalaObject" class="keyword">extends</a> <span title="java.lang.Object">AnyRef</span> <span class="keyword">with</span> parsing.<a href="parsing/TokenTests.scala.html#47105" title="scala.xml.parsing.TokenTests">TokenTests</a>
<span class="delimiter">{</span>
  <span class="keyword">final</span> <span class="keyword">val</span> <a title="Char(\'\032\')" id="566066">SU</a> = <span title="Char(\'\032\')" class="char">'\u001A'</span>

  <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="implicit scala.xml.Utility.implicitSbToString : (sb: StringBuilder)java.lang.String" id="566068">implicitSbToString</a><span class="delimiter">(</span><a title="StringBuilder" id="1035245">sb</a>: <a href="../collection/mutable/StringBuilder.scala.html#15106" title="StringBuilder">StringBuilder</a><span class="delimiter">)</span> = <a href="#1035245" title="StringBuilder">sb</a>.<a href="../collection/mutable/StringBuilder.scala.html#60572" title="()java.lang.String">toString</a><span class="delimiter">(</span><span class="delimiter">)</span>

  <span class="comment">// helper for the extremely oft-repeated sequence of creating a</span>
  <span class="comment">// StringBuilder, passing it around, and then grabbing its String.</span>
  <span class="keyword">private</span> <span class="delimiter">[</span>xml<span class="delimiter">]</span> <span class="keyword">def</span> <a title="(f: StringBuilder =&gt; Unit)String" id="566069">sbToString</a><span class="delimiter">(</span><a title="StringBuilder =&gt; Unit" id="1041123">f</a>: <span class="delimiter">(</span>StringBuilder<span class="delimiter">)</span> =&gt; Unit<span class="delimiter">)</span>: <span title="String">String</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="StringBuilder" id="1051074">sb</a> = <a href="../collection/mutable/StringBuilder.scala.html#60509" title="()StringBuilder" class="keyword">new</a> <a href="../package.scala.html#47558" title="StringBuilder">StringBuilder</a>
    <a href="../Function1.scala.html#53453" title="(v1: StringBuilder)Unit">f</a><span class="delimiter">(</span><a href="#1051074" title="StringBuilder">sb</a><span class="delimiter">)</span>
    <a href="#1051074" title="StringBuilder">sb</a>.<a href="../collection/mutable/StringBuilder.scala.html#60572" title="()java.lang.String">toString</a>
  <span class="delimiter">}</span>
  <span class="keyword">private</span><span class="delimiter">[</span>xml<span class="delimiter">]</span> <span class="keyword">def</span> <a title="(x: scala.xml.Node)Boolean" id="566070">isAtomAndNotText</a><span class="delimiter">(</span><a title="scala.xml.Node" id="1051079">x</a>: <a href="Node.scala.html#46155" title="scala.xml.Node">Node</a><span class="delimiter">)</span> = <a href="#1051079" title="scala.xml.Node">x</a>.<a href="Node.scala.html#460161" title="=&gt; Boolean">isAtom</a> <a href="../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../Boolean.scala.html#55576" title="=&gt; Boolean">!</a><a href="#1051079" title="scala.xml.Node">x</a>.<span title="[T0]=&gt; Boolean">isInstanceOf</span><span title="Boolean" class="delimiter">[</span><a href="Text.scala.html#46365" title="scala.xml.Text">Text</a><span class="delimiter">]</span>

  <span class="comment">/** trims an element - call this method, when you know that it is an
   *  element (and not a text node) so you know that it will not be trimmed
   *  away. With this assumption, the function can return a &lt;code&gt;Node&lt;/code&gt;,
   *  rather than a &lt;code&gt;Seq[Node]&lt;/code&gt;. If you don't know, call
   *  &lt;code&gt;trimProper&lt;/code&gt; and account for the fact that you may get back
   *  an empty sequence of nodes.
   *
   *  precondition: node is not a text node (it might be trimmed)
   */</span>
  <span class="keyword">def</span> <a title="(x: scala.xml.Node)scala.xml.Node" id="566071">trim</a><span class="delimiter">(</span><a title="scala.xml.Node" id="1051082">x</a>: <a href="Node.scala.html#46155" title="scala.xml.Node">Node</a><span class="delimiter">)</span>: <a href="Node.scala.html#46155" title="scala.xml.Node">Node</a> = <a href="#1051082" title="scala.xml.Node">x</a> <span title="scala.xml.Node" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <a href="Elem.scala.html#462412" title="scala.xml.Elem">Elem</a><span class="delimiter">(</span><a title="String" id="1051085">pre</a>, <a title="String" id="1051086">lab</a>, <a title="scala.xml.MetaData" id="1051087">md</a>, <a title="scala.xml.NamespaceBinding" id="1051088">scp</a>, <a title="Seq[scala.xml.Node]" id="1051089">child</a>@_*<span class="delimiter">)</span> =&gt;
      <a href="Elem.scala.html#462411" title="(prefix: String, label: String, attributes: scala.xml.MetaData, scope: scala.xml.NamespaceBinding, child: scala.xml.Node*)scala.xml.Elem">Elem</a><span class="delimiter">(</span><a href="#1051085" title="String">pre</a>, <a href="#1051086" title="String">lab</a>, <a href="#1051087" title="scala.xml.MetaData">md</a>, <a href="#1051088" title="scala.xml.NamespaceBinding">scp</a>, <span class="delimiter">(</span><a href="#1051089" title="Seq[scala.xml.Node]">child</a> <a href="../collection/TraversableLike.scala.html#49046" title="(f: scala.xml.Node =&gt; scala.collection.GenTraversableOnce[scala.xml.Node])(implicit bf: scala.collection.generic.CanBuildFrom[Seq[scala.xml.Node],scala.xml.Node,Seq[scala.xml.Node]])Seq[scala.xml.Node]">flatMap</a> <a href="#566072" title="(x: scala.xml.Node)Seq[scala.xml.Node]">trimProper</a><span class="delimiter">)</span>:_*<span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/** trim a child of an element. &lt;code&gt;Attribute&lt;/code&gt; values and
   *  &lt;code&gt;Atom&lt;/code&gt; nodes that are not &lt;code&gt;Text&lt;/code&gt; nodes are unaffected.
   */</span>
  <span class="keyword">def</span> <a title="(x: scala.xml.Node)Seq[scala.xml.Node]" id="566072">trimProper</a><span class="delimiter">(</span><a title="scala.xml.Node" id="1051105">x</a>:<a href="Node.scala.html#46155" title="scala.xml.Node">Node</a><span class="delimiter">)</span>: <a href="../collection/Seq.scala.html#8648" title="Seq[scala.xml.Node]">Seq</a><span class="delimiter">[</span>Node<span class="delimiter">]</span> = <a href="#1051105" title="scala.xml.Node">x</a> <span title="Seq[scala.xml.Node]" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <a href="Elem.scala.html#462412" title="scala.xml.Elem">Elem</a><span class="delimiter">(</span><a title="String" id="1051134">pre</a>,<a title="String" id="1051135">lab</a>,<a title="scala.xml.MetaData" id="1051136">md</a>,<a title="scala.xml.NamespaceBinding" id="1051137">scp</a>,<a title="Seq[scala.xml.Node]" id="1051138">child</a>@_*<span class="delimiter">)</span> =&gt;
      <a href="Elem.scala.html#462411" title="(prefix: String, label: String, attributes: scala.xml.MetaData, scope: scala.xml.NamespaceBinding, child: scala.xml.Node*)scala.xml.Elem">Elem</a><span class="delimiter">(</span><a href="#1051134" title="String">pre</a>,<a href="#1051135" title="String">lab</a>,<a href="#1051136" title="scala.xml.MetaData">md</a>,<a href="#1051137" title="scala.xml.NamespaceBinding">scp</a>, <span class="delimiter">(</span><a href="#1051138" title="Seq[scala.xml.Node]">child</a> <a href="../collection/TraversableLike.scala.html#49046" title="(f: scala.xml.Node =&gt; scala.collection.GenTraversableOnce[scala.xml.Node])(implicit bf: scala.collection.generic.CanBuildFrom[Seq[scala.xml.Node],scala.xml.Node,Seq[scala.xml.Node]])Seq[scala.xml.Node]">flatMap</a> <a href="#566072" title="(x: scala.xml.Node)Seq[scala.xml.Node]">trimProper</a><span class="delimiter">)</span>:_*<span class="delimiter">)</span>
    <span class="keyword">case</span> <span title="Seq[scala.xml.Text]">Text</span><span class="delimiter">(</span><a title="String" id="1051180">s</a><span class="delimiter">)</span> =&gt;
      <span title="scala.xml.TextBuffer" class="keyword">new</span> <a href="TextBuffer.scala.html#46200" title="scala.xml.TextBuffer">TextBuffer</a><span class="delimiter">(</span><span class="delimiter">)</span>.<a href="TextBuffer.scala.html#567582" title="(cs: Seq[Char])scala.xml.TextBuffer">append</a><span class="delimiter">(</span><a href="../LowPriorityImplicits.scala.html#9503" title="implicit scala.LowPriorityImplicits.wrapString : (s: String)scala.collection.immutable.WrappedString">s</a><span class="delimiter">)</span>.<a href="TextBuffer.scala.html#567583" title="=&gt; Seq[scala.xml.Text]">toText</a>
    <span class="keyword">case</span> <span title="scala.xml.Node">_</span> =&gt;
      <a href="#1051105" title="scala.xml.Node">x</a>
  <span class="delimiter">}</span>
  <span class="comment">/** returns a sorted attribute list */</span>
  <span class="keyword">def</span> <a title="(md: scala.xml.MetaData)scala.xml.MetaData" id="566073">sort</a><span class="delimiter">(</span><a title="scala.xml.MetaData" id="1051181">md</a>: <a href="MetaData.scala.html#46083" title="scala.xml.MetaData">MetaData</a><span class="delimiter">)</span>: <a href="MetaData.scala.html#46083" title="scala.xml.MetaData">MetaData</a> = <span title="scala.xml.MetaData" class="keyword">if</span><span class="delimiter">(</span><span class="delimiter">(</span><a href="#1051181" title="scala.xml.MetaData">md</a> <span title="(x$1: AnyRef)Boolean">eq</span> <a href="Null.scala.html#46435" title="object scala.xml.Null">Null</a><span class="delimiter">)</span> <a href="../Boolean.scala.html#55579" title="(x: Boolean)Boolean">||</a> <span class="delimiter">(</span><a href="#1051181" title="scala.xml.MetaData">md</a>.<a href="MetaData.scala.html#460227" title="=&gt; scala.xml.MetaData">next</a> <span title="(x$1: AnyRef)Boolean">eq</span> <a href="Null.scala.html#46435" title="object scala.xml.Null">Null</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="#1051181" title="scala.xml.MetaData">md</a> <span class="keyword">else</span> <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="String" id="1051183">key</a> = <a href="#1051181" title="scala.xml.MetaData">md</a>.<a href="MetaData.scala.html#460223" title="=&gt; String">key</a>
    <span class="keyword">val</span> <a title="scala.xml.MetaData" id="1051184">smaller</a> = <a href="#566073" title="(md: scala.xml.MetaData)scala.xml.MetaData">sort</a><span class="delimiter">(</span><a href="#1051181" title="scala.xml.MetaData">md</a>.<a href="MetaData.scala.html#460222" title="(f: scala.xml.MetaData =&gt; Boolean)scala.xml.MetaData">filter</a> <span class="delimiter">{</span> <a title="scala.xml.MetaData" id="1051197">m</a> =&gt; <a href="#1051197" title="scala.xml.MetaData">m</a>.<a href="../Predef.scala.html#9682" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">key</a> <a href="../math/Ordered.scala.html#54423" title="(that: String)Boolean">&lt;</a> <a href="#1051183" title="String">key</a> <span class="delimiter">}</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="scala.xml.MetaData" id="1051185">greater</a> = <a href="#566073" title="(md: scala.xml.MetaData)scala.xml.MetaData">sort</a><span class="delimiter">(</span><a href="#1051181" title="scala.xml.MetaData">md</a>.<a href="MetaData.scala.html#460222" title="(f: scala.xml.MetaData =&gt; Boolean)scala.xml.MetaData">filter</a> <span class="delimiter">{</span> <a title="scala.xml.MetaData" id="1051214">m</a> =&gt; <a href="#1051214" title="scala.xml.MetaData">m</a>.<a href="../Predef.scala.html#9682" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">key</a> <a href="../math/Ordered.scala.html#54424" title="(that: String)Boolean">&gt;</a> <a href="#1051183" title="String">key</a> <span class="delimiter">}</span><span class="delimiter">)</span>
    <a href="#1051184" title="scala.xml.MetaData">smaller</a>.<a href="MetaData.scala.html#460209" title="(updates: scala.xml.MetaData, scope: scala.xml.NamespaceBinding)scala.xml.MetaData">append</a><a title="scala.xml.MetaData" id="1051222" class="delimiter">(</a> <a href="Null.scala.html#46435" title="object scala.xml.Null">Null</a> <span class="delimiter">)</span>.<a href="MetaData.scala.html#1041471" title="scala.xml.NamespaceBinding" id="1051224">append</a><span class="delimiter">(</span><a href="#1051181" title="scala.xml.MetaData">md</a>.<a href="MetaData.scala.html#460213" title="(next: scala.xml.MetaData)scala.xml.MetaData">copy</a> <a title="scala.xml.MetaData" id="1051223" class="delimiter">(</a> <a href="#1051185" title="scala.xml.MetaData">greater</a> <span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/** returns the node with its attribute list sorted alphabetically (prefixes are ignored) */</span>
  <span class="keyword">def</span> <a title="(n: scala.xml.Node)scala.xml.Node" id="566074">sort</a><span class="delimiter">(</span><a title="scala.xml.Node" id="1051190">n</a>:<a href="Node.scala.html#46155" title="scala.xml.Node">Node</a><span class="delimiter">)</span>: <a href="Node.scala.html#46155" title="scala.xml.Node">Node</a> = <a href="#1051190" title="scala.xml.Node">n</a> <span title="scala.xml.Node" class="keyword">match</span> <span class="delimiter">{</span>
	  <span class="keyword">case</span> <a href="Elem.scala.html#462412" title="scala.xml.Elem">Elem</a><span class="delimiter">(</span><a title="String" id="1051226">pre</a>,<a title="String" id="1051227">lab</a>,<a title="scala.xml.MetaData" id="1051228">md</a>,<a title="scala.xml.NamespaceBinding" id="1051229">scp</a>,<a title="Seq[scala.xml.Node]" id="1051230">child</a>@_*<span class="delimiter">)</span> =&gt;
		  <a href="Elem.scala.html#462411" title="(prefix: String, label: String, attributes: scala.xml.MetaData, scope: scala.xml.NamespaceBinding, child: scala.xml.Node*)scala.xml.Elem">Elem</a><span class="delimiter">(</span><a href="#1051226" title="String">pre</a>,<a href="#1051227" title="String">lab</a>,<a href="#566073" title="(md: scala.xml.MetaData)scala.xml.MetaData">sort</a><span class="delimiter">(</span><a href="#1051228" title="scala.xml.MetaData">md</a><span class="delimiter">)</span>,<a href="#1051229" title="scala.xml.NamespaceBinding">scp</a>, <span class="delimiter">(</span><a href="#1051230" title="Seq[scala.xml.Node]">child</a> <a href="../collection/TraversableLike.scala.html#49041" title="(f: scala.xml.Node =&gt; scala.xml.Node)(implicit bf: scala.collection.generic.CanBuildFrom[Seq[scala.xml.Node],scala.xml.Node,Seq[scala.xml.Node]])Seq[scala.xml.Node]">map</a> <a href="#566074" title="(n: scala.xml.Node)scala.xml.Node">sort</a><span class="delimiter">)</span>:_*<span class="delimiter">)</span>
	  <span class="keyword">case</span> <span title="scala.xml.Node">_</span> =&gt; <a href="#1051190" title="scala.xml.Node">n</a>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Escapes the characters &amp;lt; &amp;gt; &amp;amp; and &amp;quot; from string.
   *
   * @param text ...
   * @return     ...
   */</span>
  <span class="keyword">final</span> <span class="keyword">def</span> <a title="(text: String)String" id="566075">escape</a><span class="delimiter">(</span><a title="String" id="1034845">text</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="String">String</span> = <a href="#566069" title="(f: StringBuilder =&gt; Unit)String">sbToString</a><span class="delimiter">(</span><a href="#566079" title="(text: String, s: StringBuilder)StringBuilder">escape</a><span title="Unit" class="delimiter">(</span><a href="#1034845" title="String">text</a>, <a href="#1051287" title="StringBuilder">_</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">object</span> <a title="object scala.xml.Utility.Escapes" id="566076">Escapes</a> <a href="../ScalaObject.scala.html#464" title="ScalaObject" class="delimiter">{</a>
    <span class="comment">/** For reasons unclear escape and unescape are a long ways from
      * being logical inverses. */</span>
    <span class="keyword">val</span> <a title="scala.collection.immutable.Map[java.lang.String,Char]" id="1035238">pairs</a> = <a href="../collection/generic/GenMapFactory.scala.html#56702" title="(elems: (java.lang.String, Char)*)scala.collection.immutable.Map[java.lang.String,Char]">Map</a><span class="delimiter">(</span>
      <a href="../Predef.scala.html#9589" title="(x: java.lang.String)ArrowAssoc[java.lang.String]" class="string">&quot;lt&quot;</a>    <a href="../Predef.scala.html#57653" title="(y: Char)(java.lang.String, Char)">-&gt;</a> <span title="Char(\'&lt;\')" class="char">'&lt;'</span>,
      <a href="../Predef.scala.html#9589" title="(x: java.lang.String)ArrowAssoc[java.lang.String]" class="string">&quot;gt&quot;</a>    <a href="../Predef.scala.html#57653" title="(y: Char)(java.lang.String, Char)">-&gt;</a> <span title="Char(\'&gt;\')" class="char">'&gt;'</span>,
      <a href="../Predef.scala.html#9589" title="(x: java.lang.String)ArrowAssoc[java.lang.String]" class="string">&quot;amp&quot;</a>   <a href="../Predef.scala.html#57653" title="(y: Char)(java.lang.String, Char)">-&gt;</a> <span title="Char(\'&amp;\')" class="char">'&amp;'</span>,
      <a href="../Predef.scala.html#9589" title="(x: java.lang.String)ArrowAssoc[java.lang.String]" class="string">&quot;quot&quot;</a>  <a href="../Predef.scala.html#57653" title="(y: Char)(java.lang.String, Char)">-&gt;</a> <span title="Char(\'\\\&quot;\')" class="char">'&quot;'</span>
      <span class="comment">// enigmatic comment explaining why this isn't escaped --</span>
      <span class="comment">// is valid xhtml but not html, and IE doesn't know it, says jweb</span>
      <span class="comment">// &quot;apos&quot;  -&gt; '\''</span>
    <span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="scala.collection.immutable.Map[Char,String]" id="1035240">escMap</a>    = <a href="#1035238" title="=&gt; scala.collection.immutable.Map[java.lang.String,Char]">pairs</a> <a href="../collection/TraversableLike.scala.html#49041" title="(f: ((java.lang.String, Char)) =&gt; (Char, String))(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.Map[java.lang.String,Char],(Char, String),scala.collection.immutable.Map[Char,String]])scala.collection.immutable.Map[Char,String]">map</a> <a href="#1051377" title="(Char, String)" class="delimiter">{</a> <span class="keyword">case</span> <span title="(Char, String)" class="delimiter">(</span><a title="java.lang.String" id="1051380">s</a>, <a title="Char" id="1051381">c</a><span class="delimiter">)</span> =&gt; <a href="../Predef.scala.html#9589" title="(x: Char)ArrowAssoc[Char]">c</a><a href="../Predef.scala.html#57653" title="(y: String)(Char, String)">-&gt;</a> <span class="delimiter">(</span><a href="../Predef.scala.html#9682" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;&amp;%s;&quot;</a> <a href="../collection/immutable/StringLike.scala.html#56577" title="(args: Any*)String">format</a> <a href="#1051380" title="java.lang.String">s</a><span class="delimiter">)</span> <span class="delimiter">}</span>
    <span class="keyword">val</span> <a title="scala.collection.immutable.Map[java.lang.String,Char]" id="1035242">unescMap</a>  = <a href="#1035238" title="=&gt; scala.collection.immutable.Map[java.lang.String,Char]">pairs</a> <a href="../collection/immutable/MapLike.scala.html#102814" title="(xs: scala.collection.GenTraversableOnce[(java.lang.String, Char)])scala.collection.immutable.Map[java.lang.String,Char]">++</a> <a href="../collection/generic/GenMapFactory.scala.html#56702" title="(elems: (java.lang.String, Char)*)scala.collection.immutable.Map[java.lang.String,Char]">Map</a><span class="delimiter">(</span><a href="../Predef.scala.html#9589" title="(x: java.lang.String)ArrowAssoc[java.lang.String]" class="string">&quot;apos&quot;</a>  <a href="../Predef.scala.html#57653" title="(y: Char)(java.lang.String, Char)">-&gt;</a> <span title="Char(\'\\\'\')" class="char">'\''</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>
  <span class="keyword">import</span> <a href="#566076" title="object scala.xml.Utility.Escapes">Escapes</a>.<span class="delimiter">{</span> escMap, unescMap <span class="delimiter">}</span>

  <span class="comment">/**
   * Appends escaped string to &lt;code&gt;s&lt;/code&gt;.
   *
   * @param text ...
   * @param s    ...
   * @return     ...
   */</span>
  <span class="keyword">final</span> <span class="keyword">def</span> <a title="(text: String, s: StringBuilder)StringBuilder" id="566079">escape</a><span class="delimiter">(</span><a title="String" id="1034842">text</a>: <span title="String">String</span>, <a title="StringBuilder" id="1034843">s</a>: <a href="../collection/mutable/StringBuilder.scala.html#15106" title="StringBuilder">StringBuilder</a><span class="delimiter">)</span>: <a href="../collection/mutable/StringBuilder.scala.html#15106" title="StringBuilder">StringBuilder</a> = <span class="delimiter">{</span>
    <span class="comment">// Implemented per XML spec:</span>
    <span class="comment">// http://www.w3.org/International/questions/qa-controls</span>
    <span class="comment">// imperative code 3x-4x faster than current implementation</span>
    <span class="comment">// dpp (David Pollak) 2010/02/03</span>
    <span class="keyword">val</span> <a title="Int" id="1051524">len</a> = <a href="#1034842" title="String">text</a>.<span title="()Int">length</span>
    <span class="keyword">var</span> <a title="Int" id="1051525">pos</a> = <span title="Int(0)" class="int">0</span>
    <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><a href="#1051525" title="Int">pos</a> <a href="../Int.scala.html#54761" title="(x: Int)Boolean">&lt;</a> <a href="#1051524" title="Int">len</a><span class="delimiter">)</span> <a href="#1051526" title="()Unit" class="delimiter">{</a>
      <a href="#1034842" title="String">text</a>.<span title="(x$1: Int)Char">charAt</span><span class="delimiter">(</span><a href="#1051525" title="Int">pos</a><span class="delimiter">)</span> <span title="Any" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <span title="StringBuilder" class="char">'&lt;'</span> =&gt; <a href="#1034843" title="StringBuilder">s</a>.<a href="../collection/mutable/StringBuilder.scala.html#60531" title="(s: String)StringBuilder">append</a><span class="delimiter">(</span><span title="java.lang.String(&quot;&amp;lt;&quot;)" class="string">&quot;&amp;lt;&quot;</span><span class="delimiter">)</span>
        <span class="keyword">case</span> <span title="StringBuilder" class="char">'&gt;'</span> =&gt; <a href="#1034843" title="StringBuilder">s</a>.<a href="../collection/mutable/StringBuilder.scala.html#60531" title="(s: String)StringBuilder">append</a><span class="delimiter">(</span><span title="java.lang.String(&quot;&amp;gt;&quot;)" class="string">&quot;&amp;gt;&quot;</span><span class="delimiter">)</span>
        <span class="keyword">case</span> <span title="StringBuilder" class="char">'&amp;'</span> =&gt; <a href="#1034843" title="StringBuilder">s</a>.<a href="../collection/mutable/StringBuilder.scala.html#60531" title="(s: String)StringBuilder">append</a><span class="delimiter">(</span><span title="java.lang.String(&quot;&amp;amp;&quot;)" class="string">&quot;&amp;amp;&quot;</span><span class="delimiter">)</span>
        <span class="keyword">case</span> <span title="StringBuilder" class="char">'&quot;'</span> =&gt; <a href="#1034843" title="StringBuilder">s</a>.<a href="../collection/mutable/StringBuilder.scala.html#60531" title="(s: String)StringBuilder">append</a><span class="delimiter">(</span><span title="java.lang.String(&quot;&amp;quot;&quot;)" class="string">&quot;&amp;quot;&quot;</span><span class="delimiter">)</span>
        <span class="keyword">case</span> <span title="StringBuilder" class="char">'\n'</span> =&gt; <a href="#1034843" title="StringBuilder">s</a>.<a href="../collection/mutable/StringBuilder.scala.html#60543" title="(x: Char)StringBuilder">append</a><span class="delimiter">(</span><span title="Char(\'\\n\')" class="char">'\n'</span><span class="delimiter">)</span>
        <span class="keyword">case</span> <span title="StringBuilder" class="char">'\r'</span> =&gt; <a href="#1034843" title="StringBuilder">s</a>.<a href="../collection/mutable/StringBuilder.scala.html#60543" title="(x: Char)StringBuilder">append</a><span class="delimiter">(</span><span title="Char(\'\\r\')" class="char">'\r'</span><span class="delimiter">)</span>
        <span class="keyword">case</span> <span title="StringBuilder" class="char">'\t'</span> =&gt; <a href="#1034843" title="StringBuilder">s</a>.<a href="../collection/mutable/StringBuilder.scala.html#60543" title="(x: Char)StringBuilder">append</a><span class="delimiter">(</span><span title="Char(\'\\t\')" class="char">'\t'</span><span class="delimiter">)</span>
        <span class="keyword">case</span> <a title="Any" id="1051559">c</a> =&gt; <span title="Any" class="keyword">if</span> <span class="delimiter">(</span><a href="#1051559" title="Char">c</a> <a href="../Char.scala.html#54937" title="(x: Char)Boolean">&gt;=</a> <span title="Char(\' \')" class="char">' '</span><span class="delimiter">)</span> <a href="#1034843" title="StringBuilder">s</a>.<a href="../collection/mutable/StringBuilder.scala.html#60543" title="(x: Char)StringBuilder">append</a><span class="delimiter">(</span><a href="#1051559" title="Char">c</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>

      <a href="#1051525" title="Int">pos</a> <a href="../Int.scala.html#54804" title="(x: Int)Int">+=</a> <span title="Int(1)" class="int">1</span>
    <span class="delimiter">}</span>
    <a href="#1034843" title="StringBuilder">s</a>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Appends unescaped string to &lt;code&gt;s&lt;/code&gt;, amp becomes &amp;amp;
   * lt becomes &amp;lt; etc..
   *
   * @param ref ...
   * @param s   ...
   * @return    &lt;code&gt;null&lt;/code&gt; if &lt;code&gt;ref&lt;/code&gt; was not a predefined
   *            entity.
   */</span>
  <span class="keyword">final</span> <span class="keyword">def</span> <a title="(ref: String, s: StringBuilder)StringBuilder" id="566080">unescape</a><span class="delimiter">(</span><a title="String" id="1051580">ref</a>: <span title="String">String</span>, <a title="StringBuilder" id="1051581">s</a>: <a href="../collection/mutable/StringBuilder.scala.html#15106" title="StringBuilder">StringBuilder</a><span class="delimiter">)</span>: <a href="../collection/mutable/StringBuilder.scala.html#15106" title="StringBuilder">StringBuilder</a> =
    <span class="delimiter">(</span><a href="#1035242" title="=&gt; scala.collection.immutable.Map[java.lang.String,Char]">unescMap</a> <a href="../collection/MapLike.scala.html#73194" title="(key: java.lang.String)Option[Char]">get</a> <a href="#1051580" title="String">ref</a><span class="delimiter">)</span> <a href="../Option.scala.html#48480" title="(f: Char =&gt; StringBuilder)Option[StringBuilder]">map</a> <span class="delimiter">(</span><a href="#1051581" title="StringBuilder">s</a> <a href="../collection/mutable/StringBuilder.scala.html#60543" title="(x: Char)StringBuilder">append</a> <a href="#1051589" title="Char">_</a><span class="delimiter">)</span> <a href="../Option.scala.html#48477" title="(implicit ev: &lt;:&lt;[Null,StringBuilder])StringBuilder">orNull</a>

  <span class="comment">/**
   * Returns a set of all namespaces used in a sequence of nodes
   * and all their descendants, including the empty namespaces.
   *
   * @param nodes ...
   * @return      ...
   */</span>
  <span class="keyword">def</span> <a title="(nodes: Seq[scala.xml.Node])scala.collection.mutable.Set[String]" id="566081">collectNamespaces</a><span class="delimiter">(</span><a title="Seq[scala.xml.Node]" id="1051602">nodes</a>: <a href="../collection/Seq.scala.html#8648" title="Seq[scala.xml.Node]">Seq</a><span class="delimiter">[</span>Node<span class="delimiter">]</span><span class="delimiter">)</span>: mutable.<a href="../collection/mutable/Set.scala.html#14833" title="scala.collection.mutable.Set[String]">Set</a><span class="delimiter">[</span>String<span class="delimiter">]</span> =
    <a href="#1051602" title="Seq[scala.xml.Node]">nodes</a>.<a href="../collection/TraversableOnce.scala.html#53630" title="(z: scala.collection.mutable.HashSet[String])(op: (scala.collection.mutable.HashSet[String], scala.xml.Node) =&gt; scala.collection.mutable.HashSet[String])scala.collection.mutable.HashSet[String]">foldLeft</a><span class="delimiter">(</span><a href="../collection/mutable/HashSet.scala.html#108311" title="()scala.collection.mutable.HashSet[String]" class="keyword">new</a> <a href="../collection/mutable/HashSet.scala.html#14593" title="scala.collection.mutable.HashSet[String]">HashSet</a><span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span> <span class="delimiter">(</span><a title="scala.collection.mutable.HashSet[String]" id="1051617">set</a>, <a title="scala.xml.Node" id="1051618">x</a><span class="delimiter">)</span> =&gt; <a href="#566082" title="(n: scala.xml.Node, set: scala.collection.mutable.Set[String])Unit">collectNamespaces</a><span class="delimiter">(</span><a href="#1051618" title="scala.xml.Node">x</a>, <a href="#1051617" title="scala.collection.mutable.HashSet[String]">set</a><span class="delimiter">)</span> ; <a href="#1051617" title="scala.collection.mutable.HashSet[String]">set</a> <span class="delimiter">}</span>

  <span class="comment">/**
   * Adds all namespaces in node to set.
   *
   * @param n   ...
   * @param set ...
   */</span>
  <span class="keyword">def</span> <a title="(n: scala.xml.Node, set: scala.collection.mutable.Set[String])Unit" id="566082">collectNamespaces</a><span class="delimiter">(</span><a title="scala.xml.Node" id="1051623">n</a>: <a href="Node.scala.html#46155" title="scala.xml.Node">Node</a>, <a title="scala.collection.mutable.Set[String]" id="1051624">set</a>: mutable.<a href="../collection/mutable/Set.scala.html#14833" title="scala.collection.mutable.Set[String]">Set</a><span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#1051623" title="scala.xml.Node">n</a>.<a href="Node.scala.html#460162" title="=&gt; Boolean">doCollectNamespaces</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#1051624" title="scala.collection.mutable.Set[String]">set</a> <a href="../collection/mutable/SetLike.scala.html#108335" title="(elem: String)set.type">+=</a> <a href="#1051623" title="scala.xml.Node">n</a>.<a href="Node.scala.html#460165" title="=&gt; String">namespace</a>
      <span class="keyword">for</span> <span class="delimiter">(</span><a title="scala.xml.MetaData" id="1051652">a</a> &lt;- <a href="#1051623" title="scala.xml.Node">n</a>.<a href="../collection/IterableLike.scala.html#53856" title="(f: scala.xml.MetaData =&gt; Any)Unit">attributes</a><span class="delimiter">)</span> <a href="#1051652" title="scala.xml.MetaData">a</a> <span title="Any" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <span title="set.type">_</span>:<a href="PrefixedAttribute.scala.html#46140" title="scala.xml.PrefixedAttribute">PrefixedAttribute</a> =&gt;
          <a href="#1051624" title="scala.collection.mutable.Set[String]">set</a> <a href="../collection/mutable/SetLike.scala.html#108335" title="(elem: String)set.type">+=</a> <a href="#1051652" title="scala.xml.MetaData">a</a>.<a href="MetaData.scala.html#460214" title="(owner: scala.xml.Node)String">getNamespace</a><span class="delimiter">(</span><a href="#1051623" title="scala.xml.Node">n</a><span class="delimiter">)</span>
        <span class="keyword">case</span> <span title="Unit">_</span> =&gt;
      <span class="delimiter">}</span>
      <span class="keyword">for</span> <span class="delimiter">(</span><a title="scala.xml.Node" id="1051691">i</a> &lt;- <a href="#1051623" title="scala.xml.Node">n</a>.<a href="../collection/IterableLike.scala.html#53856" title="(f: scala.xml.Node =&gt; Unit)Unit">child</a><span class="delimiter">)</span>
        <a href="#566082" title="(n: scala.xml.Node, set: scala.collection.mutable.Set[String])Unit">collectNamespaces</a><span class="delimiter">(</span><a href="#1051691" title="scala.xml.Node">i</a>, <a href="#1051624" title="scala.collection.mutable.Set[String]">set</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="comment">// def toXML(</span>
  <span class="comment">//   x: Node,</span>
  <span class="comment">//   pscope: NamespaceBinding = TopScope,</span>
  <span class="comment">//   sb: StringBuilder = new StringBuilder,</span>
  <span class="comment">//   stripComments: Boolean = false,</span>
  <span class="comment">//   decodeEntities: Boolean = true,</span>
  <span class="comment">//   preserveWhitespace: Boolean = false,</span>
  <span class="comment">//   minimizeTags: Boolean = false): String =</span>
  <span class="comment">// {</span>
  <span class="comment">//   toXMLsb(x, pscope, sb, stripComments, decodeEntities, preserveWhitespace, minimizeTags)</span>
  <span class="comment">//   sb.toString()</span>
  <span class="comment">// }</span>

  <span class="keyword">def</span> <a title="(x: scala.xml.Node, pscope: scala.xml.NamespaceBinding, sb: StringBuilder, stripComments: Boolean, decodeEntities: Boolean, preserveWhitespace: Boolean, minimizeTags: Boolean)StringBuilder" id="566083">toXML</a><span class="delimiter">(</span>
    <a title="scala.xml.Node" id="1047500">x</a>: <a href="Node.scala.html#46155" title="scala.xml.Node">Node</a>,
    <a title="scala.xml.NamespaceBinding" id="1047508">pscope</a>: <a href="NamespaceBinding.scala.html#46320" title="scala.xml.NamespaceBinding">NamespaceBinding</a> = <a href="TopScope.scala.html#46183" title="object scala.xml.TopScope">TopScope</a>,
    <a title="StringBuilder" id="1047509">sb</a>: <a href="../collection/mutable/StringBuilder.scala.html#15106" title="StringBuilder">StringBuilder</a> = <a href="../collection/mutable/StringBuilder.scala.html#60509" title="()StringBuilder" class="keyword">new</a> <a href="../package.scala.html#47558" title="StringBuilder">StringBuilder</a>,
    <a title="Boolean" id="1047510">stripComments</a>: <a href="../Boolean.scala.html#65" title="Boolean">Boolean</a> = <span title="Boolean(false)" class="keyword">false</span>,
    <a title="Boolean" id="1047511">decodeEntities</a>: <a href="../Boolean.scala.html#65" title="Boolean">Boolean</a> = <span title="Boolean(true)" class="keyword">true</span>,
    <a title="Boolean" id="1047512">preserveWhitespace</a>: <a href="../Boolean.scala.html#65" title="Boolean">Boolean</a> = <span title="Boolean(false)" class="keyword">false</span>,
    <a title="Boolean" id="1047513">minimizeTags</a>: <a href="../Boolean.scala.html#65" title="Boolean">Boolean</a> = <span title="Boolean(false)" class="keyword">false</span><span class="delimiter">)</span>: <a href="../collection/mutable/StringBuilder.scala.html#15106" title="StringBuilder">StringBuilder</a> =
  <span class="delimiter">{</span>
    <a href="#1047500" title="scala.xml.Node">x</a> <span title="StringBuilder" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <a title="StringBuilder" id="1051699">c</a>: <a href="Comment.scala.html#46143" title="scala.xml.Comment">Comment</a> =&gt; <span title="StringBuilder" class="keyword">if</span> <span class="delimiter">(</span><a href="../Boolean.scala.html#55576" title="=&gt; Boolean">!</a><a href="#1047510" title="Boolean">stripComments</a><span class="delimiter">)</span> <a href="#1051699" title="scala.xml.Comment">c</a> <a href="Comment.scala.html#1035284" title="(sb: StringBuilder)StringBuilder">buildString</a> <a href="#1047509" title="StringBuilder">sb</a> <span class="keyword">else</span> <a href="#1047509" title="StringBuilder">sb</a>
      <span class="keyword">case</span> <a title="StringBuilder" id="1051702">x</a>: <a href="SpecialNode.scala.html#46281" title="scala.xml.SpecialNode">SpecialNode</a> =&gt; <a href="#1051702" title="scala.xml.SpecialNode">x</a> <a href="SpecialNode.scala.html#475538" title="(sb: StringBuilder)StringBuilder">buildString</a> <a href="#1047509" title="StringBuilder">sb</a>
      <span class="keyword">case</span> <a title="StringBuilder" id="1051705">g</a>: <a href="Group.scala.html#46356" title="scala.xml.Group">Group</a> =&gt;
        <a href="#1051705" title="scala.xml.Group">g</a>.<a href="Group.scala.html#659605" title="=&gt; Seq[scala.xml.Node]">nodes</a> <a href="../collection/IterableLike.scala.html#53856" title="(f: scala.xml.Node =&gt; StringBuilder)Unit">foreach</a> <span class="delimiter">{</span><a href="#566083" title="(x: scala.xml.Node, pscope: scala.xml.NamespaceBinding, sb: StringBuilder, stripComments: Boolean, decodeEntities: Boolean, preserveWhitespace: Boolean, minimizeTags: Boolean)StringBuilder">toXML</a><span class="delimiter">(</span><a href="#1051722" title="scala.xml.Node">_</a>, <a href="#1047500" title="scala.xml.Node">x</a>.<a href="Node.scala.html#460164" title="=&gt; scala.xml.NamespaceBinding">scope</a>, <a href="#1047509" title="StringBuilder">sb</a>, <a href="#1047510" title="Boolean">stripComments</a>, <a href="#1047511" title="Boolean">decodeEntities</a>, <a href="#1047512" title="Boolean">preserveWhitespace</a>, <a href="#1047513" title="Boolean">minimizeTags</a><span class="delimiter">)</span><span class="delimiter">}</span>
        <a href="#1047509" title="StringBuilder">sb</a>
      <span class="keyword">case</span> <span title="StringBuilder">_</span>  =&gt;
        <span class="comment">// print tag with namespace declarations</span>
        <a href="#1047509" title="StringBuilder">sb</a>.<a href="../collection/mutable/StringBuilder.scala.html#60543" title="(x: Char)StringBuilder">append</a><span class="delimiter">(</span><span title="Char(\'&lt;\')" class="char">'&lt;'</span><span class="delimiter">)</span>
        <a href="#1047500" title="scala.xml.Node">x</a>.<a href="Node.scala.html#460180" title="(sb: StringBuilder)StringBuilder">nameToString</a><span class="delimiter">(</span><a href="#1047509" title="StringBuilder">sb</a><span class="delimiter">)</span>
        <span title="Any" class="keyword">if</span> <span class="delimiter">(</span><a href="#1047500" title="scala.xml.Node">x</a>.<a href="Node.scala.html#460169" title="=&gt; scala.xml.MetaData">attributes</a> <span title="(x$1: AnyRef)Boolean">ne</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <a href="#1047500" title="scala.xml.Node">x</a>.<a href="Node.scala.html#460169" title="=&gt; scala.xml.MetaData">attributes</a>.<a href="MetaData.scala.html#460234" title="(sb: StringBuilder)StringBuilder">buildString</a><span class="delimiter">(</span><a href="#1047509" title="StringBuilder">sb</a><span class="delimiter">)</span>
        <a href="#1047500" title="scala.xml.Node">x</a>.<a href="Node.scala.html#460164" title="=&gt; scala.xml.NamespaceBinding">scope</a>.<a href="NamespaceBinding.scala.html#56935" title="(sb: StringBuilder, stop: scala.xml.NamespaceBinding)Unit">buildString</a><span class="delimiter">(</span><a href="#1047509" title="StringBuilder">sb</a>, <a href="#1047508" title="scala.xml.NamespaceBinding">pscope</a><span class="delimiter">)</span>
        <span title="StringBuilder" class="keyword">if</span> <span class="delimiter">(</span><a href="#1047500" title="scala.xml.Node">x</a>.<a href="Node.scala.html#460170" title="=&gt; Seq[scala.xml.Node]">child</a>.<a href="../collection/IterableLike.scala.html#53862" title="=&gt; Boolean">isEmpty</a> <a href="../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#1047513" title="Boolean">minimizeTags</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <span class="comment">// no children, so use short form: &lt;xyz .../&gt;</span>
          <a href="#1047509" title="StringBuilder">sb</a>.<a href="../collection/mutable/StringBuilder.scala.html#60531" title="(s: String)StringBuilder">append</a><span class="delimiter">(</span><span title="java.lang.String(&quot; /&gt;&quot;)" class="string">&quot; /&gt;&quot;</span><span class="delimiter">)</span>
        <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
          <span class="comment">// children, so use long form: &lt;xyz ...&gt;...&lt;/xyz&gt;</span>
          <a href="#1047509" title="StringBuilder">sb</a>.<a href="../collection/mutable/StringBuilder.scala.html#60543" title="(x: Char)StringBuilder">append</a><span class="delimiter">(</span><span title="Char(\'&gt;\')" class="char">'&gt;'</span><span class="delimiter">)</span>
          <a href="#566084" title="(children: Seq[scala.xml.Node], pscope: scala.xml.NamespaceBinding, sb: StringBuilder, stripComments: Boolean, decodeEntities: Boolean, preserveWhitespace: Boolean, minimizeTags: Boolean)Unit">sequenceToXML</a><span class="delimiter">(</span><a href="#1047500" title="scala.xml.Node">x</a>.<a href="Node.scala.html#460170" title="=&gt; Seq[scala.xml.Node]">child</a>, <a href="#1047500" title="scala.xml.Node">x</a>.<a href="Node.scala.html#460164" title="=&gt; scala.xml.NamespaceBinding">scope</a>, <a href="#1047509" title="StringBuilder">sb</a>, <a href="#1047510" title="Boolean">stripComments</a>, <a href="#1047511" title="Boolean">decodeEntities</a>, <a href="#1047512" title="Boolean">preserveWhitespace</a>, <a href="#1047513" title="Boolean">minimizeTags</a><span class="delimiter">)</span>
          <a href="#1047509" title="StringBuilder">sb</a>.<a href="../collection/mutable/StringBuilder.scala.html#60531" title="(s: String)StringBuilder">append</a><span class="delimiter">(</span><span title="java.lang.String(&quot;&lt;/&quot;)" class="string">&quot;&lt;/&quot;</span><span class="delimiter">)</span>
          <a href="#1047500" title="scala.xml.Node">x</a>.<a href="Node.scala.html#460180" title="(sb: StringBuilder)StringBuilder">nameToString</a><span class="delimiter">(</span><a href="#1047509" title="StringBuilder">sb</a><span class="delimiter">)</span>
          <a href="#1047509" title="StringBuilder">sb</a>.<a href="../collection/mutable/StringBuilder.scala.html#60543" title="(x: Char)StringBuilder">append</a><span class="delimiter">(</span><span title="Char(\'&gt;\')" class="char">'&gt;'</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(children: Seq[scala.xml.Node], pscope: scala.xml.NamespaceBinding, sb: StringBuilder, stripComments: Boolean, decodeEntities: Boolean, preserveWhitespace: Boolean, minimizeTags: Boolean)Unit" id="566084">sequenceToXML</a><span class="delimiter">(</span>
    <a title="Seq[scala.xml.Node]" id="1035210">children</a>: <a href="../collection/Seq.scala.html#8648" title="Seq[scala.xml.Node]">Seq</a><span class="delimiter">[</span>Node<span class="delimiter">]</span>,
    <a title="scala.xml.NamespaceBinding" id="1035218">pscope</a>: <a href="NamespaceBinding.scala.html#46320" title="scala.xml.NamespaceBinding">NamespaceBinding</a> = <a href="TopScope.scala.html#46183" title="object scala.xml.TopScope">TopScope</a>,
    <a title="StringBuilder" id="1035219">sb</a>: <a href="../collection/mutable/StringBuilder.scala.html#15106" title="StringBuilder">StringBuilder</a> = <a href="../collection/mutable/StringBuilder.scala.html#60509" title="()StringBuilder" class="keyword">new</a> <a href="../package.scala.html#47558" title="StringBuilder">StringBuilder</a>,
    <a title="Boolean" id="1035220">stripComments</a>: <a href="../Boolean.scala.html#65" title="Boolean">Boolean</a> = <span title="Boolean(false)" class="keyword">false</span>,
    <a title="Boolean" id="1035221">decodeEntities</a>: <a href="../Boolean.scala.html#65" title="Boolean">Boolean</a> = <span title="Boolean(true)" class="keyword">true</span>,
    <a title="Boolean" id="1035222">preserveWhitespace</a>: <a href="../Boolean.scala.html#65" title="Boolean">Boolean</a> = <span title="Boolean(false)" class="keyword">false</span>,
    <a title="Boolean" id="1035223">minimizeTags</a>: <a href="../Boolean.scala.html#65" title="Boolean">Boolean</a> = <span title="Boolean(false)" class="keyword">false</span><span class="delimiter">)</span>: <a href="../Unit.scala.html#461" title="Unit">Unit</a> =
  <span class="delimiter">{</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#1035210" title="Seq[scala.xml.Node]">children</a>.<a href="../collection/IterableLike.scala.html#53862" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <span title="Nothing" class="keyword">return</span>
    <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#1035210" title="Seq[scala.xml.Node]">children</a> <a href="../collection/IterableLike.scala.html#53859" title="(p: scala.xml.Node =&gt; Boolean)Boolean">forall</a> <a href="#566070" title="(x: scala.xml.Node)Boolean">isAtomAndNotText</a><span class="delimiter">)</span> <span class="delimiter">{</span> <span class="comment">// add space</span>
      <span class="keyword">val</span> <a title="Iterator[scala.xml.Node]" id="1051763">it</a> = <a href="#1035210" title="Seq[scala.xml.Node]">children</a>.<a href="../collection/IterableLike.scala.html#53855" title="=&gt; Iterator[scala.xml.Node]">iterator</a>
      <span class="keyword">val</span> <a title="scala.xml.Node" id="1051764">f</a> = <a href="#1051763" title="Iterator[scala.xml.Node]">it</a>.<a href="../collection/Iterator.scala.html#59108" title="()scala.xml.Node">next</a>
      <a href="#566083" title="(x: scala.xml.Node, pscope: scala.xml.NamespaceBinding, sb: StringBuilder, stripComments: Boolean, decodeEntities: Boolean, preserveWhitespace: Boolean, minimizeTags: Boolean)StringBuilder">toXML</a><span class="delimiter">(</span><a href="#1051764" title="scala.xml.Node">f</a>, <a href="#1035218" title="scala.xml.NamespaceBinding">pscope</a>, <a href="#1035219" title="StringBuilder">sb</a>, <a href="#1035220" title="Boolean">stripComments</a>, <a href="#1035221" title="Boolean">decodeEntities</a>, <a href="#1035222" title="Boolean">preserveWhitespace</a>, <a href="#1035223" title="Boolean">minimizeTags</a><span class="delimiter">)</span>
      <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><a href="#1051763" title="Iterator[scala.xml.Node]">it</a>.<a href="../collection/Iterator.scala.html#59107" title="=&gt; Boolean">hasNext</a><span class="delimiter">)</span> <a href="#1051765" title="()Unit" class="delimiter">{</a>
        <span class="keyword">val</span> <a title="scala.xml.Node" id="1051766">x</a> = <a href="#1051763" title="Iterator[scala.xml.Node]">it</a>.<a href="../collection/Iterator.scala.html#59108" title="()scala.xml.Node">next</a>
        <a href="#1035219" title="StringBuilder">sb</a>.<a href="../collection/mutable/StringBuilder.scala.html#60543" title="(x: Char)StringBuilder">append</a><span class="delimiter">(</span><span title="Char(\' \')" class="char">' '</span><span class="delimiter">)</span>
        <a href="#566083" title="(x: scala.xml.Node, pscope: scala.xml.NamespaceBinding, sb: StringBuilder, stripComments: Boolean, decodeEntities: Boolean, preserveWhitespace: Boolean, minimizeTags: Boolean)StringBuilder">toXML</a><span class="delimiter">(</span><a href="#1051766" title="scala.xml.Node">x</a>, <a href="#1035218" title="scala.xml.NamespaceBinding">pscope</a>, <a href="#1035219" title="StringBuilder">sb</a>, <a href="#1035220" title="Boolean">stripComments</a>, <a href="#1035221" title="Boolean">decodeEntities</a>, <a href="#1035222" title="Boolean">preserveWhitespace</a>, <a href="#1035223" title="Boolean">minimizeTags</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
    <span class="keyword">else</span> <a href="#1035210" title="Seq[scala.xml.Node]">children</a> <a href="../collection/IterableLike.scala.html#53856" title="(f: scala.xml.Node =&gt; StringBuilder)Unit">foreach</a> <span class="delimiter">{</span> <a href="#566083" title="(x: scala.xml.Node, pscope: scala.xml.NamespaceBinding, sb: StringBuilder, stripComments: Boolean, decodeEntities: Boolean, preserveWhitespace: Boolean, minimizeTags: Boolean)StringBuilder">toXML</a><span class="delimiter">(</span><a href="#1051787" title="scala.xml.Node">_</a>, <a href="#1035218" title="scala.xml.NamespaceBinding">pscope</a>, <a href="#1035219" title="StringBuilder">sb</a>, <a href="#1035220" title="Boolean">stripComments</a>, <a href="#1035221" title="Boolean">decodeEntities</a>, <a href="#1035222" title="Boolean">preserveWhitespace</a>, <a href="#1035223" title="Boolean">minimizeTags</a><span class="delimiter">)</span> <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Returns prefix of qualified name if any.
   *
   * @param name ...
   * @return     ...
   */</span>
  <span class="keyword">final</span> <span class="keyword">def</span> <a title="(name: String)Option[String]" id="566085">prefix</a><span class="delimiter">(</span><a title="String" id="1051789">name</a>: <span title="String">String</span><span class="delimiter">)</span>: <a href="../Option.scala.html#560" title="Option[String]">Option</a><span class="delimiter">[</span>String<span class="delimiter">]</span> = <span class="delimiter">(</span><a href="#1051789" title="String">name</a> <span title="(x$1: Int)Int">indexOf</span> <span title="Int(58)" class="char">':'</span><span class="delimiter">)</span> <span title="Option[String]" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <span title="None.type">-</span><span class="int">1</span>   =&gt; <a href="../Option.scala.html#1737" title="object None">None</a>
    <span class="keyword">case</span> <a title="Some[java.lang.String]" id="1051795">i</a>    =&gt; <a href="../Option.scala.html#57885" title="(x: java.lang.String)Some[java.lang.String]">Some</a><span class="delimiter">(</span><a href="#1051789" title="String">name</a>.<span title="(x$1: Int, x$2: Int)java.lang.String">substring</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span>, <a href="#1051795" title="Int">i</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Returns a hashcode for the given constituents of a node
   *
   * @param uri
   * @param label
   * @param attribHashCode
   * @param children
   */</span>
  <span class="keyword">def</span> <a title="(pre: String, label: String, attribHashCode: Int, scpeHash: Int, children: Seq[scala.xml.Node])Int" id="566086">hashCode</a><span class="delimiter">(</span><a title="String" id="1051801">pre</a>: <span title="String">String</span>, <a title="String" id="1051802">label</a>: <span title="String">String</span>, <a title="Int" id="1051803">attribHashCode</a>: <a href="../Int.scala.html#386" title="Int">Int</a>, <a title="Int" id="1051804">scpeHash</a>: <a href="../Int.scala.html#386" title="Int">Int</a>, <a title="Seq[scala.xml.Node]" id="1051805">children</a>: <a href="../collection/Seq.scala.html#8648" title="Seq[scala.xml.Node]">Seq</a><span class="delimiter">[</span>Node<span class="delimiter">]</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="scala.util.MurmurHash[scala.xml.Node]" id="1051808">h</a> = <span title="scala.util.MurmurHash[scala.xml.Node]" class="keyword">new</span> util.<a href="../util/MurmurHash.scala.html#44032" title="scala.util.MurmurHash[scala.xml.Node]">MurmurHash</a><span class="delimiter">[</span>Node<span class="delimiter">]</span><span class="delimiter">(</span><a href="#1051801" title="String">pre</a>.<span title="()Int">##</span><span class="delimiter">)</span>
    <a href="#1051808" title="scala.util.MurmurHash[scala.xml.Node]">h</a>.<a href="../util/MurmurHash.scala.html#114550" title="(i: Int)Unit">append</a><span class="delimiter">(</span><a href="#1051802" title="String">label</a>.<span title="()Int">##</span><span class="delimiter">)</span>
    <a href="#1051808" title="scala.util.MurmurHash[scala.xml.Node]">h</a>.<a href="../util/MurmurHash.scala.html#114550" title="(i: Int)Unit">append</a><span class="delimiter">(</span><a href="#1051803" title="Int">attribHashCode</a><span class="delimiter">)</span>
    <a href="#1051808" title="scala.util.MurmurHash[scala.xml.Node]">h</a>.<a href="../util/MurmurHash.scala.html#114550" title="(i: Int)Unit">append</a><span class="delimiter">(</span><a href="#1051804" title="Int">scpeHash</a><span class="delimiter">)</span>
    <a href="#1051805" title="Seq[scala.xml.Node]">children</a>.<a href="../collection/IterableLike.scala.html#53856" title="(f: scala.xml.Node =&gt; Unit)Unit">foreach</a><span class="delimiter">(</span><a href="#1051808" title="scala.util.MurmurHash[scala.xml.Node]">h</a><span class="delimiter">)</span>
    <a href="#1051808" title="scala.util.MurmurHash[scala.xml.Node]">h</a>.<a href="../util/MurmurHash.scala.html#114551" title="=&gt; Int">hash</a>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(s: String)String" id="566087">appendQuoted</a><span class="delimiter">(</span><a title="String" id="1035271">s</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="String">String</span> = <a href="#566069" title="(f: StringBuilder =&gt; Unit)String">sbToString</a><span class="delimiter">(</span><a href="#566088" title="(s: String, sb: StringBuilder)StringBuilder">appendQuoted</a><span title="Unit" class="delimiter">(</span><a href="#1035271" title="String">s</a>, <a href="#1051826" title="StringBuilder">_</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="comment">/**
   * Appends &amp;quot;s&amp;quot; if string &lt;code&gt;s&lt;/code&gt; does not contain &amp;quot;,
   * &amp;apos;s&amp;apos; otherwise.
   *
   * @param s  ...
   * @param sb ...
   * @return   ...
   */</span>
  <span class="keyword">def</span> <a title="(s: String, sb: StringBuilder)StringBuilder" id="566088">appendQuoted</a><span class="delimiter">(</span><a title="String" id="1035232">s</a>: <span title="String">String</span>, <a title="StringBuilder" id="1035233">sb</a>: <a href="../collection/mutable/StringBuilder.scala.html#15106" title="StringBuilder">StringBuilder</a><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Char" id="1035236">ch</a> = <span title="Char" class="keyword">if</span> <span class="delimiter">(</span><a href="../Predef.scala.html#9682" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">s</a> <a href="../collection/SeqLike.scala.html#54119" title="(elem: Any)Boolean">contains</a> <span title="Char(\'\\\&quot;\')" class="char">'&quot;'</span><span class="delimiter">)</span> <span title="Char(\'\\\'\')" class="char">'\''</span> <span class="keyword">else</span> <span title="Char(\'\\\&quot;\')" class="char">'&quot;'</span>
    <a href="#1035233" title="StringBuilder">sb</a>.<a href="../collection/mutable/StringBuilder.scala.html#60543" title="(x: Char)StringBuilder">append</a><span class="delimiter">(</span><a href="#1035236" title="Char">ch</a><span class="delimiter">)</span>.<a href="../collection/mutable/StringBuilder.scala.html#60531" title="(s: String)StringBuilder">append</a><span class="delimiter">(</span><a href="#1035232" title="String">s</a><span class="delimiter">)</span>.<a href="../collection/mutable/StringBuilder.scala.html#60543" title="(x: Char)StringBuilder">append</a><span class="delimiter">(</span><a href="#1035236" title="Char">ch</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Appends &amp;quot;s&amp;quot; and escapes and &amp;quot; i s with \&amp;quot;
   *
   * @param s  ...
   * @param sb ...
   * @return   ...
   */</span>
  <span class="keyword">def</span> <a title="(s: String, sb: StringBuilder)StringBuilder" id="566089">appendEscapedQuoted</a><span class="delimiter">(</span><a title="String" id="1051831">s</a>: <span title="String">String</span>, <a title="StringBuilder" id="1051832">sb</a>: <a href="../collection/mutable/StringBuilder.scala.html#15106" title="StringBuilder">StringBuilder</a><span class="delimiter">)</span>: <a href="../collection/mutable/StringBuilder.scala.html#15106" title="StringBuilder">StringBuilder</a> = <span class="delimiter">{</span>
    <a href="#1051832" title="StringBuilder">sb</a>.<a href="../collection/mutable/StringBuilder.scala.html#60543" title="(x: Char)StringBuilder">append</a><span class="delimiter">(</span><span title="Char(\'\\\&quot;\')" class="char">'&quot;'</span><span class="delimiter">)</span>
    <span class="keyword">for</span> <span class="delimiter">(</span><a title="Char" id="1052524">c</a> &lt;- <a href="../collection/IndexedSeqOptimized.scala.html#55926" title="(f: Char =&gt; StringBuilder)Unit">s</a><span class="delimiter">)</span> <a href="#1052524" title="Char">c</a> <span title="StringBuilder" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <span title="StringBuilder" class="char">'&quot;'</span> =&gt; <a href="#1051832" title="StringBuilder">sb</a>.<a href="../collection/mutable/StringBuilder.scala.html#60543" title="(x: Char)StringBuilder">append</a><span class="delimiter">(</span><span title="Char(\'\\\\\')" class="char">'\\'</span><span class="delimiter">)</span>; <a href="#1051832" title="StringBuilder">sb</a>.<a href="../collection/mutable/StringBuilder.scala.html#60543" title="(x: Char)StringBuilder">append</a><span class="delimiter">(</span><span title="Char(\'\\\&quot;\')" class="char">'&quot;'</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="StringBuilder">_</span>   =&gt; <a href="#1051832" title="StringBuilder">sb</a>.<a href="../collection/mutable/StringBuilder.scala.html#60543" title="(x: Char)StringBuilder">append</a><span class="delimiter">(</span><a href="#1052524" title="Char">c</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
    <a href="#1051832" title="StringBuilder">sb</a>.<a href="../collection/mutable/StringBuilder.scala.html#60543" title="(x: Char)StringBuilder">append</a><span class="delimiter">(</span><span title="Char(\'\\\&quot;\')" class="char">'&quot;'</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * @param s     ...
   * @param index ...
   * @return      ...
   */</span>
  <span class="keyword">def</span> <a title="(s: String, index: Int)String" id="566090">getName</a><span class="delimiter">(</span><a title="String" id="1052542">s</a>: <span title="String">String</span>, <a title="Int" id="1052543">index</a>: <a href="../Int.scala.html#386" title="Int">Int</a><span class="delimiter">)</span>: <span title="String">String</span> = <span class="delimiter">{</span>
    <span title="String" class="keyword">if</span> <span class="delimiter">(</span><a href="#1052543" title="Int">index</a> <a href="../Int.scala.html#54782" title="(x: Int)Boolean">&gt;=</a> <a href="#1052542" title="String">s</a>.<span title="()Int">length</span><span class="delimiter">)</span> <span title="Null(null)" class="keyword">null</span>
    <span class="keyword">else</span> <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="String" id="1052549">xs</a> = <a href="../Predef.scala.html#9682" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">s</a> <a href="../collection/IndexedSeqOptimized.scala.html#55968" title="(n: Int)String">drop</a> <a href="#1052543" title="Int">index</a>
      <span title="String" class="keyword">if</span> <span class="delimiter">(</span><a href="../Predef.scala.html#9682" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">xs</a>.<a href="../collection/TraversableOnce.scala.html#53619" title="=&gt; Boolean">nonEmpty</a> <a href="../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="parsing/TokenTests.scala.html#566100" title="(ch: Char)Boolean">isNameStart</a><span class="delimiter">(</span><a href="../Predef.scala.html#9682" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">xs</a>.<a href="../collection/IndexedSeqOptimized.scala.html#55963" title="=&gt; Char">head</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../Predef.scala.html#9682" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">xs</a> <a href="../collection/IndexedSeqOptimized.scala.html#55972" title="(p: Char =&gt; Boolean)String">takeWhile</a> <a href="parsing/TokenTests.scala.html#566099" title="(ch: Char)Boolean">isNameChar</a>
      <span class="keyword">else</span> <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Returns &lt;code&gt;null&lt;/code&gt; if the value is a correct attribute value,
   * error message if it isn't.
   *
   * @param value ...
   * @return      ...
   */</span>
  <span class="keyword">def</span> <a title="(value: String)String" id="566091">checkAttributeValue</a><span class="delimiter">(</span><a title="String" id="1053238">value</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="String">String</span> = <span class="delimiter">{</span>
    <span class="keyword">var</span> <a title="Int" id="1053240">i</a> = <span title="Int(0)" class="int">0</span>
    <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><a href="#1053240" title="Int">i</a> <a href="../Int.scala.html#54761" title="(x: Int)Boolean">&lt;</a> <a href="#1053238" title="String">value</a>.<span title="()Int">length</span><span class="delimiter">)</span> <a href="#1053241" title="()Unit" class="delimiter">{</a>
      <a href="#1053238" title="String">value</a>.<span title="(x$1: Int)Char">charAt</span><span class="delimiter">(</span><a href="#1053240" title="Int">i</a><span class="delimiter">)</span> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <span title="Nothing" class="char">'&lt;'</span> =&gt;
          <span title="Nothing" class="keyword">return</span> <span title="java.lang.String(&quot;&lt; not allowed in attribute value&quot;)" class="string">&quot;&lt; not allowed in attribute value&quot;</span>;
        <span class="keyword">case</span> <span title="Unit" class="char">'&amp;'</span> =&gt;
          <span class="keyword">val</span> <a title="String" id="1053246">n</a> = <a href="#566090" title="(s: String, index: Int)String">getName</a><span class="delimiter">(</span><a href="#1053238" title="String">value</a>, <a href="#1053240" title="Int">i</a><a href="../Int.scala.html#54804" title="(x: Int)Int">+</a><span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#1053246" title="String">n</a> <span title="(x$1: AnyRef)Boolean">eq</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span>
            <span title="Nothing" class="keyword">return</span> <span title="java.lang.String(&quot;malformed entity reference in attribute value [&quot;)" class="string">&quot;malformed entity reference in attribute value [&quot;</span><span title="(x$1: Any)java.lang.String">+</span><a href="#1053238" title="String">value</a><span title="(x$1: Any)java.lang.String">+</span><span title="java.lang.String(&quot;]&quot;)" class="string">&quot;]&quot;</span>;
          <a href="#1053240" title="Int">i</a> = <a href="#1053240" title="Int">i</a> <a href="../Int.scala.html#54804" title="(x: Int)Int">+</a> <a href="#1053246" title="String">n</a>.<span title="()Int">length</span> <a href="../Int.scala.html#54804" title="(x: Int)Int">+</a> <span title="Int(1)" class="int">1</span>
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#1053240" title="Int">i</a> <a href="../Int.scala.html#54782" title="(x: Int)Boolean">&gt;=</a> <a href="#1053238" title="String">value</a>.<span title="()Int">length</span> <a href="../Boolean.scala.html#55579" title="(x: Boolean)Boolean">||</a> <a href="#1053238" title="String">value</a>.<span title="(x$1: Int)Char">charAt</span><span class="delimiter">(</span><a href="#1053240" title="Int">i</a><span class="delimiter">)</span> <a href="../Char.scala.html#54909" title="(x: Char)Boolean">!=</a> <span title="Char(\';\')" class="char">';'</span><span class="delimiter">)</span>
            <span title="Nothing" class="keyword">return</span> <span title="java.lang.String(&quot;malformed entity reference in attribute value [&quot;)" class="string">&quot;malformed entity reference in attribute value [&quot;</span><span title="(x$1: Any)java.lang.String">+</span><a href="#1053238" title="String">value</a><span title="(x$1: Any)java.lang.String">+</span><span title="java.lang.String(&quot;]&quot;)" class="string">&quot;]&quot;</span>;
        <span class="keyword">case</span> <span title="Unit">_</span>   =&gt;
      <span class="delimiter">}</span>
      <a href="#1053240" title="Int">i</a> = <a href="#1053240" title="Int">i</a> <a href="../Int.scala.html#54804" title="(x: Int)Int">+</a> <span title="Int(1)" class="int">1</span>
    <span class="delimiter">}</span>
    <span title="Null(null)" class="keyword">null</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * new
   *
   * @param value ...
   * @return      ...
   */</span>
  <span class="keyword">def</span> <a title="(value: String)Seq[scala.xml.Node]" id="566092">parseAttributeValue</a><span class="delimiter">(</span><a title="String" id="587727">value</a>: <span title="String">String</span><span class="delimiter">)</span>: <a href="../collection/Seq.scala.html#8648" title="Seq[scala.xml.Node]">Seq</a><span class="delimiter">[</span>Node<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="StringBuilder" id="1053272">sb</a>  = <a href="../collection/mutable/StringBuilder.scala.html#60509" title="()StringBuilder" class="keyword">new</a> <a href="../package.scala.html#47558" title="StringBuilder">StringBuilder</a>
    <span class="keyword">var</span> <a title="StringBuilder" id="1053273">rfb</a>: <a href="../collection/mutable/StringBuilder.scala.html#15106" title="StringBuilder">StringBuilder</a> = <span title="Null(null)" class="keyword">null</span>
    <span class="keyword">val</span> <a title="scala.xml.NodeBuffer" id="1053274">nb</a> = <span title="scala.xml.NodeBuffer" class="keyword">new</span> <a href="NodeBuffer.scala.html#46221" title="scala.xml.NodeBuffer">NodeBuffer</a><span class="delimiter">(</span><span class="delimiter">)</span>

    <span class="keyword">val</span> <a title="Iterator[Char]" id="1053275">it</a> = <a href="../Predef.scala.html#9682" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">value</a>.<a href="../collection/IndexedSeqLike.scala.html#55856" title="=&gt; Iterator[Char]">iterator</a>
    <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><a href="#1053275" title="Iterator[Char]">it</a>.<a href="../collection/Iterator.scala.html#59107" title="=&gt; Boolean">hasNext</a><span class="delimiter">)</span> <a href="#1053276" title="()Unit" class="delimiter">{</a>
      <span class="keyword">var</span> <a title="Char" id="1053314">c</a> = <a href="#1053275" title="Iterator[Char]">it</a>.<a href="../collection/Iterator.scala.html#59108" title="()Char">next</a>
      <span class="comment">// entity! flush buffer into text node</span>
      <span title="Any" class="keyword">if</span> <span class="delimiter">(</span><a href="#1053314" title="Char">c</a> <a href="../Char.scala.html#54902" title="(x: Char)Boolean">==</a> <span title="Char(\'&amp;\')" class="char">'&amp;'</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#1053314" title="Char">c</a> = <a href="#1053275" title="Iterator[Char]">it</a>.<a href="../collection/Iterator.scala.html#59108" title="()Char">next</a>
        <span title="Any" class="keyword">if</span> <span class="delimiter">(</span><a href="#1053314" title="Char">c</a> <a href="../Char.scala.html#54902" title="(x: Char)Boolean">==</a> <span title="Char(\'#\')" class="char">'#'</span><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="#1053314" title="Char">c</a> = <a href="#1053275" title="Iterator[Char]">it</a>.<a href="../collection/Iterator.scala.html#59108" title="()Char">next</a>
          <span class="keyword">val</span> <a title="String" id="1053325">theChar</a> = <a href="#566093" title="(ch: () =&gt; Char, nextch: () =&gt; Unit, reportSyntaxError: String =&gt; Unit, reportTruncatedError: String =&gt; Unit)String">parseCharRef</a> <span class="delimiter">(</span><span class="delimiter">{</span> <span class="delimiter">(</span><span class="delimiter">)</span>=&gt; <a href="#1053314" title="Char">c</a> <span class="delimiter">}</span>,<span class="delimiter">{</span> <span class="delimiter">(</span><span class="delimiter">)</span> =&gt; <a href="#1053314" title="Char">c</a> = <a href="#1053275" title="Iterator[Char]">it</a>.<a href="../collection/Iterator.scala.html#59108" title="()Char">next</a> <span class="delimiter">}</span>,<span class="delimiter">{</span><a title="String" id="1053334">s</a> =&gt; <span title="Nothing" class="keyword">throw</span> <span title="(x$1: java.lang.String)java.lang.RuntimeException" class="keyword">new</span> <a href="../package.scala.html#47502" title="java.lang.RuntimeException">RuntimeException</a><span class="delimiter">(</span><a href="#1053334" title="String">s</a><span class="delimiter">)</span><span class="delimiter">}</span>, <span class="delimiter">{</span><a title="String" id="1053340">s</a> =&gt; <span title="Nothing" class="keyword">throw</span> <span title="(x$1: java.lang.String)java.lang.RuntimeException" class="keyword">new</span> <a href="../package.scala.html#47502" title="java.lang.RuntimeException">RuntimeException</a><span class="delimiter">(</span><a href="#1053340" title="String">s</a><span class="delimiter">)</span><span class="delimiter">}</span><span class="delimiter">)</span>
          <a href="#1053272" title="StringBuilder">sb</a>.<a href="../collection/mutable/StringBuilder.scala.html#60531" title="(s: String)StringBuilder">append</a><span class="delimiter">(</span><a href="#1053325" title="String">theChar</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
        <span class="keyword">else</span> <span class="delimiter">{</span>
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#1053273" title="StringBuilder">rfb</a> <span title="(x$1: AnyRef)Boolean">eq</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <a href="#1053273" title="StringBuilder">rfb</a> = <a href="../collection/mutable/StringBuilder.scala.html#60509" title="()StringBuilder" class="keyword">new</a> <a href="../package.scala.html#47558" title="StringBuilder">StringBuilder</a><span class="delimiter">(</span><span class="delimiter">)</span>
          <a href="#1053273" title="StringBuilder">rfb</a> <a href="../collection/mutable/StringBuilder.scala.html#60543" title="(x: Char)StringBuilder">append</a> <a href="#1053314" title="Char">c</a>
          <a href="#1053314" title="Char">c</a> = <a href="#1053275" title="Iterator[Char]">it</a>.<a href="../collection/Iterator.scala.html#59108" title="()Char">next</a>
          <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><a href="#1053314" title="Char">c</a> <a href="../Char.scala.html#54909" title="(x: Char)Boolean">!=</a> <span title="Char(\';\')" class="char">';'</span><span class="delimiter">)</span> <a href="#1053350" title="()Unit" class="delimiter">{</a>
            <a href="#1053273" title="StringBuilder">rfb</a>.<a href="../collection/mutable/StringBuilder.scala.html#60543" title="(x: Char)StringBuilder">append</a><span class="delimiter">(</span><a href="#1053314" title="Char">c</a><span class="delimiter">)</span>
            <a href="#1053314" title="Char">c</a> = <a href="#1053275" title="Iterator[Char]">it</a>.<a href="../collection/Iterator.scala.html#59108" title="()Char">next</a>
          <span class="delimiter">}</span>
          <span class="keyword">val</span> <a title="java.lang.String" id="1053349">ref</a> = <a href="#1053273" title="StringBuilder">rfb</a>.<a href="../collection/mutable/StringBuilder.scala.html#60572" title="()java.lang.String">toString</a><span class="delimiter">(</span><span class="delimiter">)</span>
          <a href="#1053273" title="StringBuilder">rfb</a>.<a href="../collection/mutable/StringBuilder.scala.html#60516" title="(len: Int)Unit">setLength</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
          <a href="#566080" title="(ref: String, s: StringBuilder)StringBuilder">unescape</a><span class="delimiter">(</span><a href="#1053349" title="java.lang.String">ref</a>,<a href="#1053272" title="StringBuilder">sb</a><span class="delimiter">)</span> <span title="Any" class="keyword">match</span> <span class="delimiter">{</span>
            <span class="keyword">case</span> <span title="nb.type" class="keyword">null</span> =&gt;
              <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#1053272" title="StringBuilder">sb</a>.<a href="../collection/mutable/StringBuilder.scala.html#60513" title="=&gt; Int">length</a> <a href="../Int.scala.html#54775" title="(x: Int)Boolean">&gt;</a> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span class="delimiter">{</span>          <span class="comment">// flush buffer</span>
                <a href="#1053274" title="scala.xml.NodeBuffer">nb</a> <a href="../collection/mutable/ArrayBuffer.scala.html#66119" title="(elem: scala.xml.Node)nb.type">+=</a> <a href="Text.scala.html#567616" title="(_data: String)scala.xml.Text">Text</a><span class="delimiter">(</span><a href="#1053272" title="StringBuilder">sb</a>.<a href="../collection/mutable/StringBuilder.scala.html#60572" title="()java.lang.String">toString</a><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
                <a href="#1053272" title="StringBuilder">sb</a>.<a href="../collection/mutable/StringBuilder.scala.html#60516" title="(len: Int)Unit">setLength</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
              <span class="delimiter">}</span>
              <a href="#1053274" title="scala.xml.NodeBuffer">nb</a> <a href="../collection/mutable/ArrayBuffer.scala.html#66119" title="(elem: scala.xml.Node)nb.type">+=</a> <a href="EntityRef.scala.html#587771" title="(entityName: String)scala.xml.EntityRef">EntityRef</a><span class="delimiter">(</span><a href="#1053272" title="StringBuilder">sb</a>.<a href="../collection/mutable/StringBuilder.scala.html#60572" title="()java.lang.String">toString</a><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="comment">// add entityref</span>
            <span class="keyword">case</span> <span title="Unit">_</span> =&gt;
          <span class="delimiter">}</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>
      <span class="keyword">else</span> <a href="#1053272" title="StringBuilder">sb</a> <a href="../collection/mutable/StringBuilder.scala.html#60543" title="(x: Char)StringBuilder">append</a> <a href="#1053314" title="Char">c</a>
    <span class="delimiter">}</span>
    <span title="Any" class="keyword">if</span> <span class="delimiter">(</span><a href="#1053272" title="StringBuilder">sb</a>.<a href="../collection/mutable/StringBuilder.scala.html#60513" title="=&gt; Int">length</a> <a href="../Int.scala.html#54775" title="(x: Int)Boolean">&gt;</a> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span class="delimiter">{</span> <span class="comment">// flush buffer</span>
      <span class="keyword">val</span> <a title="scala.xml.Text" id="1053400">x</a> = <a href="Text.scala.html#567616" title="(_data: String)scala.xml.Text">Text</a><span class="delimiter">(</span><a href="#1053272" title="StringBuilder">sb</a>.<a href="../collection/mutable/StringBuilder.scala.html#60572" title="()java.lang.String">toString</a><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span title="nb.type" class="keyword">if</span> <span class="delimiter">(</span><a href="#1053274" title="scala.xml.NodeBuffer">nb</a>.<a href="../collection/mutable/ResizableArray.scala.html#66152" title="=&gt; Int">length</a> <a href="../Int.scala.html#54747" title="(x: Int)Boolean">==</a> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
        <span title="Nothing" class="keyword">return</span> <a href="#1053400" title="scala.xml.Text">x</a>
      <span class="keyword">else</span>
        <a href="#1053274" title="scala.xml.NodeBuffer">nb</a> <a href="../collection/mutable/ArrayBuffer.scala.html#66119" title="(elem: scala.xml.Node)nb.type">+=</a> <a href="#1053400" title="scala.xml.Text">x</a>
    <span class="delimiter">}</span>
    <a href="#1053274" title="scala.xml.NodeBuffer">nb</a>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * &lt;pre&gt;
   *   CharRef ::= &quot;&amp;amp;#&quot; '0'..'9' {'0'..'9'} &quot;;&quot;
   *             | &quot;&amp;amp;#x&quot; '0'..'9'|'A'..'F'|'a'..'f' { hexdigit } &quot;;&quot;
   * &lt;/pre&gt;
   * &lt;p&gt;
   *   see [66]
   * &lt;p&gt;
   *
   * @param ch                ...
   * @param nextch            ...
   * @param reportSyntaxError ...
   * @return                  ...
   */</span>
  <span class="keyword">def</span> <a title="(ch: () =&gt; Char, nextch: () =&gt; Unit, reportSyntaxError: String =&gt; Unit, reportTruncatedError: String =&gt; Unit)String" id="566093">parseCharRef</a><span class="delimiter">(</span><a title="() =&gt; Char" id="1053326">ch</a>: <span class="delimiter">(</span><span class="delimiter">)</span> =&gt; Char, <a title="() =&gt; Unit" id="1053327">nextch</a>: <span class="delimiter">(</span><span class="delimiter">)</span> =&gt; Unit, <a title="String =&gt; Unit" id="1053328">reportSyntaxError</a>: String =&gt; Unit, <a title="String =&gt; Unit" id="1053329">reportTruncatedError</a>: String =&gt; Unit<span class="delimiter">)</span>: <span title="String">String</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Boolean" id="1053417">hex</a>  = <span class="delimiter">(</span><a href="../Function0.scala.html#62187" title="()Char">ch</a><span class="delimiter">(</span><span class="delimiter">)</span> <a href="../Char.scala.html#54902" title="(x: Char)Boolean">==</a> <span title="Char(\'x\')" class="char">'x'</span><span class="delimiter">)</span> <a href="../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a> <span class="delimiter">{</span> <a href="../Function0.scala.html#62187" title="()Unit">nextch</a><span class="delimiter">(</span><span class="delimiter">)</span>; <span title="Boolean(true)" class="keyword">true</span> <span class="delimiter">}</span>
    <span class="keyword">val</span> <a title="Int" id="1053418">base</a> = <span title="Int" class="keyword">if</span> <span class="delimiter">(</span><a href="#1053417" title="Boolean">hex</a><span class="delimiter">)</span> <span title="Int(16)" class="int">16</span> <span class="keyword">else</span> <span title="Int(10)" class="int">10</span>
    <span class="keyword">var</span> <a title="Int" id="1053419">i</a> = <span title="Int(0)" class="int">0</span>
    <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><a href="../Function0.scala.html#62187" title="()Char">ch</a><span class="delimiter">(</span><span class="delimiter">)</span> <a href="../Char.scala.html#54909" title="(x: Char)Boolean">!=</a> <span title="Char(\';\')" class="char">';'</span><span class="delimiter">)</span> <a href="#1053420" title="()Unit" class="delimiter">{</a>
      <a href="../Function0.scala.html#62187" title="()Char">ch</a><span class="delimiter">(</span><span class="delimiter">)</span> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <span title="Unit" class="char">'0'</span> | <span title="Char(\'1\')" class="char">'1'</span> | <span title="Char(\'2\')" class="char">'2'</span> | <span title="Char(\'3\')" class="char">'3'</span> | <span title="Char(\'4\')" class="char">'4'</span> | <span title="Char(\'5\')" class="char">'5'</span> | <span title="Char(\'6\')" class="char">'6'</span> | <span title="Char(\'7\')" class="char">'7'</span> | <span title="Char(\'8\')" class="char">'8'</span> | <span title="Char(\'9\')" class="char">'9'</span> =&gt;
          <a href="#1053419" title="Int">i</a> = <a href="#1053419" title="Int">i</a> <a href="../Int.scala.html#54818" title="(x: Int)Int">*</a> <a href="#1053418" title="Int">base</a> <a href="../Int.scala.html#54804" title="(x: Int)Int">+</a> <a href="../Function0.scala.html#62187" title="()Char">ch</a><a href="../LowPriorityImplicits.scala.html#9475" title="implicit scala.LowPriorityImplicits.charWrapper : (c: Char)scala.runtime.RichChar" class="delimiter">(</a><span class="delimiter">)</span>.<a href="../runtime/RichChar.scala.html#54854" title="=&gt; Int">asDigit</a>
        <span class="keyword">case</span> <span title="Unit" class="char">'a'</span> | <span title="Char(\'b\')" class="char">'b'</span> | <span title="Char(\'c\')" class="char">'c'</span> | <span title="Char(\'d\')" class="char">'d'</span> | <span title="Char(\'e\')" class="char">'e'</span> | <span title="Char(\'f\')" class="char">'f'</span>
           | <span title="Char(\'A\')" class="char">'A'</span> | <span title="Char(\'B\')" class="char">'B'</span> | <span title="Char(\'C\')" class="char">'C'</span> | <span title="Char(\'D\')" class="char">'D'</span> | <span title="Char(\'E\')" class="char">'E'</span> | <span title="Char(\'F\')" class="char">'F'</span> =&gt;
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../Boolean.scala.html#55576" title="=&gt; Boolean">!</a> <a href="#1053417" title="Boolean">hex</a><span class="delimiter">)</span>
            <a href="../Function1.scala.html#53453" title="(v1: String)Unit">reportSyntaxError</a><span class="delimiter">(</span><span class="string">&quot;hex char not allowed in decimal char ref\n&quot;</span> <span title="java.lang.String(&quot;hex char not allowed in decimal char ref\012Did you mean to write &amp;#x ?&quot;)">+</span>
                              <span class="string">&quot;Did you mean to write &amp;#x ?&quot;</span><span class="delimiter">)</span>
          <span class="keyword">else</span>
            <a href="#1053419" title="Int">i</a> = <a href="#1053419" title="Int">i</a> <a href="../Int.scala.html#54818" title="(x: Int)Int">*</a> <a href="#1053418" title="Int">base</a> <a href="../Int.scala.html#54804" title="(x: Int)Int">+</a> <a href="../Function0.scala.html#62187" title="()Char">ch</a><a href="../LowPriorityImplicits.scala.html#9475" title="implicit scala.LowPriorityImplicits.charWrapper : (c: Char)scala.runtime.RichChar" class="delimiter">(</a><span class="delimiter">)</span>.<a href="../runtime/RichChar.scala.html#54854" title="=&gt; Int">asDigit</a>
        <span class="keyword">case</span> <span title="Unit">SU</span> =&gt;
          <a href="../Function1.scala.html#53453" title="(v1: String)Unit">reportTruncatedError</a><span class="delimiter">(</span><span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span>
        <span class="keyword">case</span> <span title="Unit">_</span> =&gt;
          <a href="../Function1.scala.html#53453" title="(v1: String)Unit">reportSyntaxError</a><span class="delimiter">(</span><span title="java.lang.String(&quot;character \'&quot;)" class="string">&quot;character '&quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="../Function0.scala.html#62187" title="()Char">ch</a><span class="delimiter">(</span><span class="delimiter">)</span> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;\' not allowed in char ref\012&quot;)" class="string">&quot;' not allowed in char ref\n&quot;</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
      <a href="../Function0.scala.html#62187" title="()Unit">nextch</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
    <span title="(x$1: Array[Int], x$2: Int, x$3: Int)java.lang.String" class="keyword">new</span> <a href="../Predef.scala.html#9512" title="java.lang.String">String</a><span class="delimiter">(</span><a href="../Array.scala.html#62688" title="(x: Int, xs: Int*)Array[Int]">Array</a><span class="delimiter">(</span><a href="#1053419" title="Int">i</a><span class="delimiter">)</span>, <span title="Int(0)" class="int">0</span>, <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>