<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>scala/xml/parsing/MarkupParser.scala</title>
        <script type="text/javascript" src="../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/*                     __                                               *\
**     ________ ___   / /  ___     Scala API                            **
**    / __/ __// _ | / /  / _ |    (c) 2003-2011, LAMP/EPFL             **
**  __\ \/ /__/ __ |/ /__/ __ |    http://scala-lang.org/               **
** /____/\___/_/ |_/____/_/ | |                                         **
**                          |/                                          **
\*                                                                      */</span>

<span class="keyword">package</span> scala.xml
<span class="keyword">package</span> parsing

<span class="keyword">import</span> scala.io.Source
<span class="keyword">import</span> scala.xml.dtd._
<span class="keyword">import</span> <a href="../Utility.scala.html#46093" title="object scala.xml.Utility">Utility</a>.<a href="../Utility.scala.html#566076" title="object scala.xml.Utility.Escapes">Escapes</a>.<span class="delimiter">{</span> pairs =&gt; unescape <span class="delimiter">}</span>

<span class="comment">/**
 * An XML parser.
 *
 * Parses XML 1.0, invokes callback methods of a MarkupHandler
 * and returns whatever the markup handler returns. Use
 * &lt;code&gt;ConstructingParser&lt;/code&gt; if you just want to parse XML to
 * construct instances of &lt;code&gt;scala.xml.Node&lt;/code&gt;.
 *
 * While XML elements are returned, DTD declarations - if handled - are
 * collected using side-effects.
 *
 * @author  Burak Emir
 * @version 1.0
 */</span>
<span class="keyword">trait</span> <a title="trait MarkupParser extends java.lang.Object with scala.xml.parsing.MarkupParserCommon with scala.xml.parsing.TokenTests with ScalaObject" id="47057">MarkupParser</a> <a href="../../ScalaObject.scala.html#464" title="ScalaObject" class="keyword">extends</a> <a href="MarkupParserCommon.scala.html#47069" title="scala.xml.parsing.MarkupParserCommon">MarkupParserCommon</a> <span class="keyword">with</span> <a href="TokenTests.scala.html#47105" title="scala.xml.parsing.TokenTests">TokenTests</a>
<span class="delimiter">{</span>
  self: MarkupParser <span class="keyword">with</span> MarkupHandler =&gt;

  <span class="keyword">type</span> <a title="Int" id="1060984">PositionType</a> = <a href="../../Int.scala.html#386" title="Int">Int</a>
  <span class="keyword">type</span> <a title="scala.io.Source" id="1060985">InputType</a>    = <a href="../../io/Source.scala.html#18816" title="scala.io.Source">Source</a>
  <span class="keyword">type</span> <a title="scala.xml.NodeSeq" id="1060986">ElementType</a>  = <a href="../NodeSeq.scala.html#46257" title="scala.xml.NodeSeq">NodeSeq</a>
  <span class="keyword">type</span> <a title="(scala.xml.MetaData, scala.xml.NamespaceBinding)" id="1060987">AttributesType</a> = <a href="../../Tuple2.scala.html#1520" title="(scala.xml.MetaData, scala.xml.NamespaceBinding)" class="delimiter">(</a>MetaData, NamespaceBinding<span class="delimiter">)</span>
  <span class="keyword">type</span> <a title="scala.xml.NamespaceBinding" id="1060988">NamespaceType</a> = <a href="../NamespaceBinding.scala.html#46320" title="scala.xml.NamespaceBinding">NamespaceBinding</a>

  <span class="keyword">def</span> <a title="(msg: String)Nothing" id="1060989">truncatedError</a><span class="delimiter">(</span><a title="String" id="1062479">msg</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="Nothing">Nothing</span> = <span title="Nothing" class="keyword">throw</span> <a href="FatalError.scala.html#1062298" title="(msg: String)scala.xml.parsing.FatalError">FatalError</a><span class="delimiter">(</span><a href="#1062479" title="String">msg</a><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="(tag: String)Nothing" id="1060990">errorNoEnd</a><span class="delimiter">(</span><a title="String" id="1062482">tag</a>: <span title="String">String</span><span class="delimiter">)</span> = <span title="Nothing" class="keyword">throw</span> <a href="FatalError.scala.html#1062298" title="(msg: String)scala.xml.parsing.FatalError">FatalError</a><span class="delimiter">(</span><span title="java.lang.String(&quot;expected closing tag of &quot;)" class="string">&quot;expected closing tag of &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#1062482" title="String">tag</a><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(that: Char, msg: String)Unit" id="1060991">xHandleError</a><span class="delimiter">(</span><a title="Char" id="1062485">that</a>: <a href="../../Char.scala.html#2189" title="Char">Char</a>, <a title="String" id="1062486">msg</a>: <span title="String">String</span><span class="delimiter">)</span> = <a href="#1061062" title="(str: String)Unit">reportSyntaxError</a><span class="delimiter">(</span><a href="#1062486" title="String">msg</a><span class="delimiter">)</span>

  <span class="keyword">val</span> <a title="=&gt; scala.io.Source" id="1060992">input</a>: <a href="../../io/Source.scala.html#18816" title="scala.io.Source">Source</a>

  <span class="comment">/** if true, does not remove surplus whitespace */</span>
  <span class="keyword">val</span> <a title="=&gt; Boolean" id="1060993">preserveWS</a>: <a href="../../Boolean.scala.html#65" title="Boolean">Boolean</a>

  <span class="keyword">def</span> <a title="(systemLiteral: String)scala.io.Source" id="1060994">externalSource</a><span class="delimiter">(</span><a title="String" id="1062500">systemLiteral</a>: <span title="String">String</span><span class="delimiter">)</span>: <a href="../../io/Source.scala.html#18816" title="scala.io.Source">Source</a>

  <span class="comment">//</span>
  <span class="comment">// variables, values</span>
  <span class="comment">//</span>

  <span class="keyword">var</span> <a title="scala.io.Source" id="1060996">curInput</a>: <a href="../../io/Source.scala.html#18816" title="scala.io.Source">Source</a> = <a href="#1060992" title="=&gt; scala.io.Source">input</a>

  <span class="comment">// See ticket #3720 for motivations.</span>
  <span class="keyword">private</span> <span class="keyword">class</span> <a title="class WithLookAhead extends scala.io.Source with ScalaObject" id="1060998">WithLookAhead</a><a href="../../ScalaObject.scala.html#464" title="ScalaObject" class="delimiter">(</a><a title="scala.io.Source" id="1062532">underlying</a>: <a href="../../io/Source.scala.html#18816" title="scala.io.Source">Source</a><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="../../io/Source.scala.html#18816" title="scala.io.Source">Source</a> <span class="delimiter">{</span>
    <span class="keyword">private</span> <span class="keyword">val</span> <a title="scala.collection.mutable.Queue[Char]" id="1062505">queue</a> = collection.mutable.<a href="../../collection/generic/GenericCompanion.scala.html#48813" title="[A](elems: A*)scala.collection.mutable.Queue[A]">Queue</a><span title="(elems: Char*)scala.collection.mutable.Queue[Char]" class="delimiter">[</span><a href="../../Char.scala.html#2189" title="Char">Char</a><span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="keyword">def</span> <a title="()BufferedIterator[Char]" id="1062507">lookahead</a><span class="delimiter">(</span><span class="delimiter">)</span>: <a href="../../collection/BufferedIterator.scala.html#8975" title="BufferedIterator[Char]">BufferedIterator</a><span class="delimiter">[</span>Char<span class="delimiter">]</span> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="Iterator[Char]" id="1062538">iter</a> = <a href="#1062505" title="=&gt; scala.collection.mutable.Queue[Char]">queue</a>.<a href="../../collection/mutable/MutableList.scala.html#110554" title="=&gt; Iterator[Char]">iterator</a> <a href="../../collection/Iterator.scala.html#59118" title="(that: =&gt; scala.collection.GenTraversableOnce[Char])Iterator[Char]">++</a> <a href="#1062543" title="java.lang.Object with Iterator[Char]" class="keyword">new</a> <a title="anonymous class $anon extends java.lang.Object with Iterator[Char]" id="1062543">Iterator</a><span class="delimiter">[</span>Char<span class="delimiter">]</span> <span class="delimiter">{</span>
        <span class="keyword">def</span> <a title="=&gt; Boolean" id="1062547">hasNext</a> = <a href="#1062532" title="scala.io.Source">underlying</a>.<a href="../../io/Source.scala.html#204279" title="=&gt; Boolean">hasNext</a>
        <span class="keyword">def</span> <a title="()Char" id="1062548">next</a><span class="delimiter">(</span><span class="delimiter">)</span> = <span class="delimiter">{</span> <span class="keyword">val</span> <a title="Char" id="1062554">x</a> = <a href="#1062532" title="scala.io.Source">underlying</a>.<a href="../../io/Source.scala.html#204280" title="()Char">next</a><span class="delimiter">(</span><span class="delimiter">)</span>; <a href="#1062505" title="=&gt; scala.collection.mutable.Queue[Char]">queue</a> <a href="../../collection/mutable/MutableList.scala.html#110558" title="(elem: Char)WithLookAhead.this.queue.type">+=</a> <a href="#1062554" title="Char">x</a>; <a href="#1062554" title="Char">x</a> <span class="delimiter">}</span>
      <span class="delimiter">}</span>
      <a href="#1062538" title="Iterator[Char]">iter</a>.<a href="../../collection/Iterator.scala.html#59165" title="=&gt; java.lang.Object with scala.collection.BufferedIterator[Char]">buffered</a>
    <span class="delimiter">}</span>
    <span class="keyword">val</span> <a title="iter extends java.lang.Object with Iterator[Char]" id="1062508">iter</a> = <a href="#1062513" title="java.lang.Object with Iterator[Char]" class="keyword">new</a> <a title="anonymous class $anon extends java.lang.Object with Iterator[Char]" id="1062513">Iterator</a><span class="delimiter">[</span>Char<span class="delimiter">]</span> <span class="delimiter">{</span>
      <span class="keyword">def</span> <a title="=&gt; Boolean" id="1062515">hasNext</a> = <a href="#1062532" title="scala.io.Source">underlying</a>.<a href="../../io/Source.scala.html#204279" title="=&gt; Boolean">hasNext</a> <a href="../../Boolean.scala.html#55579" title="(x: Boolean)Boolean">||</a> <a href="../../Boolean.scala.html#55576" title="=&gt; Boolean">!</a><a href="#1062505" title="=&gt; scala.collection.mutable.Queue[Char]">queue</a>.<a href="../../collection/mutable/MutableList.scala.html#110543" title="=&gt; Boolean">isEmpty</a>
      <span class="keyword">def</span> <a title="()Char" id="1062516">next</a><span class="delimiter">(</span><span class="delimiter">)</span> = <span title="Char" class="keyword">if</span> <span class="delimiter">(</span><a href="../../Boolean.scala.html#55576" title="=&gt; Boolean">!</a><a href="#1062505" title="=&gt; scala.collection.mutable.Queue[Char]">queue</a>.<a href="../../collection/mutable/MutableList.scala.html#110543" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <a href="#1062505" title="=&gt; scala.collection.mutable.Queue[Char]">queue</a>.<a href="../../collection/mutable/Queue.scala.html#110566" title="()Char">dequeue</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="keyword">else</span> <a href="#1062532" title="scala.io.Source">underlying</a>.<a href="../../io/Source.scala.html#204280" title="()Char">next</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="()BufferedIterator[Char]" id="1060999">lookahead</a><span class="delimiter">(</span><span class="delimiter">)</span>: <a href="../../collection/BufferedIterator.scala.html#8975" title="BufferedIterator[Char]">BufferedIterator</a><span class="delimiter">[</span>Char<span class="delimiter">]</span> = <a href="#1060996" title="=&gt; scala.io.Source">curInput</a> <span title="BufferedIterator[Char]" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <a title="BufferedIterator[Char]" id="1062571">curInputWLA</a>:<a href="#1060998" title="MarkupParser.this.WithLookAhead">WithLookAhead</a> =&gt; <a href="#1062571" title="MarkupParser.this.WithLookAhead">curInputWLA</a>.<a href="#1062507" title="()BufferedIterator[Char]">lookahead</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="keyword">case</span> <span title="BufferedIterator[Char]">_</span> =&gt;
      <span class="keyword">val</span> <a title="MarkupParser.this.WithLookAhead" id="1062572">newInput</a> = <span title="MarkupParser.this.WithLookAhead" class="keyword">new</span> <a href="#1060998" title="MarkupParser.this.WithLookAhead">WithLookAhead</a><span class="delimiter">(</span><a href="#1060996" title="=&gt; scala.io.Source">curInput</a><span class="delimiter">)</span>
      <a href="#1060996" title="(x$1: scala.io.Source)Unit">curInput</a> = <a href="#1062572" title="MarkupParser.this.WithLookAhead">newInput</a>
      <a href="#1062572" title="MarkupParser.this.WithLookAhead">newInput</a>.<a href="#1062507" title="()BufferedIterator[Char]">lookahead</a><span class="delimiter">(</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>


  <span class="comment">/** the handler of the markup, returns this */</span>
  <span class="keyword">private</span> <span class="keyword">val</span> <a title="scala.xml.parsing.MarkupHandler" id="1061000">handle</a>: <a href="MarkupHandler.scala.html#47144" title="scala.xml.parsing.MarkupHandler">MarkupHandler</a> = <a href="#47057" title="parsing extends scala.xml.parsing.MarkupParser with scala.xml.parsing.MarkupHandler" class="keyword">this</a>

  <span class="comment">/** stack of inputs */</span>
  <span class="keyword">var</span> <a title="List[scala.io.Source]" id="1061003">inpStack</a>: <a href="../../collection/immutable/List.scala.html#14047" title="List[scala.io.Source]">List</a><span class="delimiter">[</span>Source<span class="delimiter">]</span> = <a href="../../collection/immutable/List.scala.html#13700" title="object Nil">Nil</a>

  <span class="comment">/** holds the position in the source file */</span>
  <span class="keyword">var</span> <a title="Int" id="1061006">pos</a>: <a href="../../Int.scala.html#386" title="Int">Int</a> = _

  <span class="comment">/* used when reading external subset */</span>
  <span class="keyword">var</span> <a title="Int" id="1061009">extIndex</a> = -<span title="Int(-1)" class="int">1</span>

  <span class="comment">/** holds temporary values of pos */</span>
  <span class="keyword">var</span> <a title="Int" id="1061012">tmppos</a>: <a href="../../Int.scala.html#386" title="Int">Int</a> = _

  <span class="comment">/** holds the next character */</span>
  <span class="keyword">var</span> <a title="Char" id="1061015">ch</a>: <a href="../../Char.scala.html#2189" title="Char">Char</a> = _

  <span class="comment">/** character buffer, for names */</span>
  <span class="keyword">protected</span> <span class="keyword">val</span> <a title="StringBuilder" id="1061017">cbuf</a> = <a href="../../collection/mutable/StringBuilder.scala.html#60509" title="()StringBuilder" class="keyword">new</a> <a href="../../package.scala.html#47558" title="StringBuilder">StringBuilder</a><span class="delimiter">(</span><span class="delimiter">)</span>

  <span class="keyword">var</span> <a title="scala.xml.dtd.DTD" id="1061020">dtd</a>: <a href="../dtd/DTD.scala.html#46589" title="scala.xml.dtd.DTD">DTD</a> = <span title="Null(null)" class="keyword">null</span>

  <span class="keyword">protected</span> <span class="keyword">var</span> <a title="scala.xml.Document" id="1061023">doc</a>: <a href="../Document.scala.html#46404" title="scala.xml.Document">Document</a> = <span title="Null(null)" class="keyword">null</span>

  <span class="keyword">var</span> <a title="Boolean" id="1061026">eof</a>: <a href="../../Boolean.scala.html#65" title="Boolean">Boolean</a> = <span title="Boolean(false)" class="keyword">false</span>

  <span class="comment">//</span>
  <span class="comment">// methods</span>
  <span class="comment">//</span>

  <span class="comment">/** &amp;lt;? prolog ::= xml S ... ?&amp;gt;
   */</span>
  <span class="keyword">def</span> <a title="()scala.xml.MetaData" id="1061028">xmlProcInstr</a><span class="delimiter">(</span><span class="delimiter">)</span>: <a href="../MetaData.scala.html#46083" title="scala.xml.MetaData">MetaData</a> = <span class="delimiter">{</span>
    <a href="MarkupParserCommon.scala.html#566203" title="(that: Seq[Char])Unit">xToken</a><span class="delimiter">(</span><a href="../../LowPriorityImplicits.scala.html#9503" title="implicit scala.LowPriorityImplicits.wrapString : (s: String)scala.collection.immutable.WrappedString" class="string">&quot;xml&quot;</a><span class="delimiter">)</span>
    <a href="MarkupParserCommon.scala.html#566206" title="()Unit">xSpace</a>
    <span class="keyword">val</span> <a href="../../Tuple2.scala.html#53390" title="(scala.xml.MetaData, scala.xml.NamespaceBinding)" class="delimiter">(</a><a href="../../Tuple2.scala.html#53402" title="scala.xml.MetaData" id="1062575">md</a>,<a href="../../Tuple2.scala.html#53404" title="scala.xml.NamespaceBinding" id="1062576">scp</a><span class="delimiter">)</span> = <a href="#1061039" title="(pscope: scala.xml.NamespaceBinding)(scala.xml.MetaData, scala.xml.NamespaceBinding)">xAttributes</a><a href="../../Tuple2.scala.html#1520" title="(scala.xml.MetaData, scala.xml.NamespaceBinding) @unchecked" class="delimiter">(</a><a href="../TopScope.scala.html#46183" title="object scala.xml.TopScope">TopScope</a><span class="delimiter">)</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#1062576" title="scala.xml.NamespaceBinding">scp</a> <span title="(x$1: AnyRef)Boolean">!=</span> <a href="../TopScope.scala.html#46183" title="object scala.xml.TopScope">TopScope</a><span class="delimiter">)</span>
      <a href="#1061062" title="(str: String)Unit">reportSyntaxError</a><span class="delimiter">(</span><span title="java.lang.String(&quot;no xmlns definitions here, please.&quot;)" class="string">&quot;no xmlns definitions here, please.&quot;</span><span class="delimiter">)</span>;
    <a href="MarkupParserCommon.scala.html#566202" title="(that: Char)Unit">xToken</a><span class="delimiter">(</span><span title="Char(\'?\')" class="char">'?'</span><span class="delimiter">)</span>
    <a href="MarkupParserCommon.scala.html#566202" title="(that: Char)Unit">xToken</a><span class="delimiter">(</span><span title="Char(\'&gt;\')" class="char">'&gt;'</span><span class="delimiter">)</span>
    <a href="#1062575" title="scala.xml.MetaData">md</a>
  <span class="delimiter">}</span>

  <span class="comment">/** Factored out common code.
   */</span>
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(isProlog: Boolean)(Option[String], Option[String], Option[Boolean])" id="1061029">prologOrTextDecl</a><span class="delimiter">(</span><a title="Boolean" id="1062616">isProlog</a>: <a href="../../Boolean.scala.html#65" title="Boolean">Boolean</a><span class="delimiter">)</span>: <a href="../../Tuple3.scala.html#317" title="(Option[String], Option[String], Option[Boolean])" class="delimiter">(</a>Option<span class="delimiter">[</span>String<span class="delimiter">]</span>, Option<span class="delimiter">[</span>String<span class="delimiter">]</span>, Option<span class="delimiter">[</span>Boolean<span class="delimiter">]</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span class="keyword">var</span> <a title="Option[String]" id="1062618">info_ver</a>: <a href="../../Option.scala.html#560" title="Option[String]">Option</a><span class="delimiter">[</span>String<span class="delimiter">]</span> = <a href="../../Option.scala.html#1737" title="object None">None</a>
    <span class="keyword">var</span> <a title="Option[String]" id="1062619">info_enc</a>: <a href="../../Option.scala.html#560" title="Option[String]">Option</a><span class="delimiter">[</span>String<span class="delimiter">]</span> = <a href="../../Option.scala.html#1737" title="object None">None</a>
    <span class="keyword">var</span> <a title="Option[Boolean]" id="1062620">info_stdl</a>: <a href="../../Option.scala.html#560" title="Option[Boolean]">Option</a><span class="delimiter">[</span>Boolean<span class="delimiter">]</span> = <a href="../../Option.scala.html#1737" title="object None">None</a>

    <span class="keyword">var</span> <a title="scala.xml.MetaData" id="1062621">m</a> = <a href="#1061028" title="()scala.xml.MetaData">xmlProcInstr</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="keyword">var</span> <a title="Int" id="1062622">n</a> = <span title="Int(0)" class="int">0</span>

    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#1062616" title="Boolean">isProlog</a><span class="delimiter">)</span>
      <a href="MarkupParserCommon.scala.html#566205" title="()Unit">xSpaceOpt</a>

    <a href="../MetaData.scala.html#460210" title="(key: String)Seq[scala.xml.Node]">m</a><span class="delimiter">(</span><span title="java.lang.String(&quot;version&quot;)" class="string">&quot;version&quot;</span><span class="delimiter">)</span> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <span title="Unit" class="keyword">null</span> =&gt; ;
      <span class="keyword">case</span> <span title="Unit">Text</span><span class="delimiter">(</span><span title="java.lang.String(&quot;1.0&quot;)" class="string">&quot;1.0&quot;</span><span class="delimiter">)</span> =&gt; <a href="#1062618" title="Option[String]">info_ver</a> = <a href="../../Option.scala.html#57885" title="(x: java.lang.String)Some[java.lang.String]">Some</a><span class="delimiter">(</span><span title="java.lang.String(&quot;1.0&quot;)" class="string">&quot;1.0&quot;</span><span class="delimiter">)</span>; <a href="#1062622" title="Int">n</a> <a href="../../Int.scala.html#54804" title="(x: Int)Int">+=</a> <span title="Int(1)" class="int">1</span>
      <span class="keyword">case</span> <span title="Unit">_</span>     =&gt; <a href="#1061062" title="(str: String)Unit">reportSyntaxError</a><span class="delimiter">(</span><span title="java.lang.String(&quot;cannot deal with versions != 1.0&quot;)" class="string">&quot;cannot deal with versions != 1.0&quot;</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <a href="../MetaData.scala.html#460210" title="(key: String)Seq[scala.xml.Node]">m</a><span class="delimiter">(</span><span title="java.lang.String(&quot;encoding&quot;)" class="string">&quot;encoding&quot;</span><span class="delimiter">)</span> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <span title="Unit" class="keyword">null</span> =&gt; ;
      <span class="keyword">case</span> <span title="Unit">Text</span><span class="delimiter">(</span><a title="String" id="1062646">enc</a><span class="delimiter">)</span>  =&gt;
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../Boolean.scala.html#55576" title="=&gt; Boolean">!</a><a href="TokenTests.scala.html#566103" title="(ianaEncoding: Seq[Char])Boolean">isValidIANAEncoding</a><span class="delimiter">(</span><a href="../../LowPriorityImplicits.scala.html#9503" title="implicit scala.LowPriorityImplicits.wrapString : (s: String)scala.collection.immutable.WrappedString">enc</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <a href="#1061062" title="(str: String)Unit">reportSyntaxError</a><span class="delimiter">(</span><span title="java.lang.String(&quot;\&quot;&quot;)" class="string">&quot;\&quot;&quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#1062646" title="String">enc</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;\&quot; is not a valid encoding&quot;)" class="string">&quot;\&quot; is not a valid encoding&quot;</span><span class="delimiter">)</span>
        <span class="keyword">else</span> <span class="delimiter">{</span>
          <a href="#1062619" title="Option[String]">info_enc</a> = <a href="../../Option.scala.html#57885" title="(x: String)Some[String]">Some</a><span class="delimiter">(</span><a href="#1062646" title="String">enc</a><span class="delimiter">)</span>
          <a href="#1062622" title="Int">n</a> <a href="../../Int.scala.html#54804" title="(x: Int)Int">+=</a> <span title="Int(1)" class="int">1</span>
        <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#1062616" title="Boolean">isProlog</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="../MetaData.scala.html#460210" title="(key: String)Seq[scala.xml.Node]">m</a><span class="delimiter">(</span><span title="java.lang.String(&quot;standalone&quot;)" class="string">&quot;standalone&quot;</span><span class="delimiter">)</span> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <span title="Unit" class="keyword">null</span> =&gt; ;
        <span class="keyword">case</span> <span title="Unit">Text</span><span class="delimiter">(</span><span title="java.lang.String(&quot;yes&quot;)" class="string">&quot;yes&quot;</span><span class="delimiter">)</span> =&gt; <a href="#1062620" title="Option[Boolean]">info_stdl</a> = <a href="../../Option.scala.html#57885" title="(x: Boolean)Some[Boolean]">Some</a><span class="delimiter">(</span><span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span>;  <a href="#1062622" title="Int">n</a> <a href="../../Int.scala.html#54804" title="(x: Int)Int">+=</a> <span title="Int(1)" class="int">1</span>
        <span class="keyword">case</span> <span title="Unit">Text</span><span class="delimiter">(</span><span title="java.lang.String(&quot;no&quot;)" class="string">&quot;no&quot;</span><span class="delimiter">)</span>  =&gt; <a href="#1062620" title="Option[Boolean]">info_stdl</a> = <a href="../../Option.scala.html#57885" title="(x: Boolean)Some[Boolean]">Some</a><span class="delimiter">(</span><span title="Boolean(false)" class="keyword">false</span><span class="delimiter">)</span>; <a href="#1062622" title="Int">n</a> <a href="../../Int.scala.html#54804" title="(x: Int)Int">+=</a> <span title="Int(1)" class="int">1</span>
        <span class="keyword">case</span> <span title="Unit">_</span>     =&gt; <a href="#1061062" title="(str: String)Unit">reportSyntaxError</a><span class="delimiter">(</span><span title="java.lang.String(&quot;either \'yes\' or \'no\' expected&quot;)" class="string">&quot;either 'yes' or 'no' expected&quot;</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#1062621" title="scala.xml.MetaData">m</a>.<a href="../MetaData.scala.html#460216" title="=&gt; Int">length</a> <a href="../../Int.scala.html#54811" title="(x: Int)Int">-</a> <a href="#1062622" title="Int">n</a> <a href="../../Int.scala.html#54754" title="(x: Int)Boolean">!=</a> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="java.lang.String" id="1062743">s</a> = <span title="java.lang.String" class="keyword">if</span> <span class="delimiter">(</span><a href="#1062616" title="Boolean">isProlog</a><span class="delimiter">)</span> <span title="java.lang.String(&quot;SDDecl? &quot;)" class="string">&quot;SDDecl? &quot;</span> <span class="keyword">else</span> <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span>
      <a href="#1061062" title="(str: String)Unit">reportSyntaxError</a><span class="delimiter">(</span><a href="../../Predef.scala.html#9682" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;VersionInfo EncodingDecl? %sor '?&gt;' expected!&quot;</a> <a href="../../collection/immutable/StringLike.scala.html#56577" title="(args: Any*)String">format</a> <a href="#1062743" title="java.lang.String">s</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <a href="../../Tuple3.scala.html#53296" title="(_1: Option[String], _2: Option[String], _3: Option[Boolean])(Option[String], Option[String], Option[Boolean])" class="delimiter">(</a><a href="#1062618" title="Option[String]">info_ver</a>, <a href="#1062619" title="Option[String]">info_enc</a>, <a href="#1062620" title="Option[Boolean]">info_stdl</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/** &amp;lt;? prolog ::= xml S?
   *  // this is a bit more lenient than necessary...
   */</span>
  <span class="keyword">def</span> <a title="()(Option[String], Option[String], Option[Boolean])" id="1061030">prolog</a><span class="delimiter">(</span><span class="delimiter">)</span>: <a href="../../Tuple3.scala.html#317" title="(Option[String], Option[String], Option[Boolean])" class="delimiter">(</a>Option<span class="delimiter">[</span>String<span class="delimiter">]</span>, Option<span class="delimiter">[</span>String<span class="delimiter">]</span>, Option<span class="delimiter">[</span>Boolean<span class="delimiter">]</span><span class="delimiter">)</span> =
    <a href="#1061029" title="(isProlog: Boolean)(Option[String], Option[String], Option[Boolean])">prologOrTextDecl</a><span class="delimiter">(</span><span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span>

  <span class="comment">/** prolog, but without standalone */</span>
  <span class="keyword">def</span> <a title="()(Option[String], Option[String])" id="1061031">textDecl</a><span class="delimiter">(</span><span class="delimiter">)</span>: <a href="../../Tuple2.scala.html#1520" title="(Option[String], Option[String])" class="delimiter">(</a>Option<span class="delimiter">[</span>String<span class="delimiter">]</span>, Option<span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">)</span> =
    <a href="#1061029" title="(isProlog: Boolean)(Option[String], Option[String], Option[Boolean])">prologOrTextDecl</a><span class="delimiter">(</span><span title="Boolean(false)" class="keyword">false</span><span class="delimiter">)</span> <span title="(Option[String], Option[String])" class="keyword">match</span> <span class="delimiter">{</span> <span class="keyword">case</span> <span title="(Option[String], Option[String])" class="delimiter">(</span><a title="Option[String]" id="1062766">x1</a>, <a title="Option[String]" id="1062767">x2</a>, _<span class="delimiter">)</span>  =&gt; <a href="../../Tuple2.scala.html#53390" title="(_1: Option[String], _2: Option[String])(Option[String], Option[String])" class="delimiter">(</a><a href="#1062766" title="Option[String]">x1</a>, <a href="#1062767" title="Option[String]">x2</a><span class="delimiter">)</span> <span class="delimiter">}</span>

  <span class="comment">/**
   *[22]        prolog     ::=          XMLDecl? Misc* (doctypedecl Misc*)?
   *[23]        XMLDecl    ::=          '&amp;lt;?xml' VersionInfo EncodingDecl? SDDecl? S? '?&gt;'
   *[24]        VersionInfo        ::=          S 'version' Eq (&quot;'&quot; VersionNum &quot;'&quot; | '&quot;' VersionNum '&quot;')
   *[25]        Eq         ::=          S? '=' S?
   *[26]        VersionNum         ::=          '1.0'
   *[27]        Misc       ::=          Comment | PI | S
   */</span>

  <span class="keyword">def</span> <a title="()scala.xml.Document" id="1061032">document</a><span class="delimiter">(</span><span class="delimiter">)</span>: <a href="../Document.scala.html#46404" title="scala.xml.Document">Document</a> = <span class="delimiter">{</span>
    <a href="#1061023" title="(x$1: scala.xml.Document)Unit">doc</a> = <span title="scala.xml.Document" class="keyword">new</span> <a href="../Document.scala.html#46404" title="scala.xml.Document">Document</a><span class="delimiter">(</span><span class="delimiter">)</span>

    <a href="#47057" title="MarkupParser.this.type" class="keyword">this</a>.<a href="#1061020" title="(x$1: scala.xml.dtd.DTD)Unit">dtd</a> = <span title="Null(null)" class="keyword">null</span>
    <span class="keyword">var</span> <a title="(Option[String], Option[String], Option[Boolean])" id="1062775">info_prolog</a>: <a href="../../Tuple3.scala.html#317" title="(Option[String], Option[String], Option[Boolean])">Tuple3</a><span class="delimiter">[</span>Option<span class="delimiter">[</span>String<span class="delimiter">]</span>, Option<span class="delimiter">[</span>String<span class="delimiter">]</span>, Option<span class="delimiter">[</span>Boolean<span class="delimiter">]</span><span class="delimiter">]</span> = <a href="../../Tuple3.scala.html#53296" title="(_1: None.type, _2: None.type, _3: None.type)(None.type, None.type, None.type)">Tuple3</a><span class="delimiter">(</span><a href="../../Option.scala.html#1737" title="object None">None</a>, <a href="../../Option.scala.html#1737" title="object None">None</a>, <a href="../../Option.scala.html#1737" title="object None">None</a><span class="delimiter">)</span>;
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><span title="Char(\'&lt;\')" class="char">'&lt;'</span> <a href="../../Char.scala.html#54909" title="(x: Char)Boolean">!=</a> <a href="#1061015" title="=&gt; Char">ch</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#1061062" title="(str: String)Unit">reportSyntaxError</a><span class="delimiter">(</span><span title="java.lang.String(&quot;&lt; expected&quot;)" class="string">&quot;&lt; expected&quot;</span><span class="delimiter">)</span>
      <span title="Nothing" class="keyword">return</span> <span title="Null(null)" class="keyword">null</span>
    <span class="delimiter">}</span>

    <a href="#1061038" title="=&gt; Char">nextch</a> <span class="comment">// is prolog ?</span>
    <span class="keyword">var</span> <a title="scala.xml.NodeSeq" id="1062776">children</a>: <a href="../NodeSeq.scala.html#46257" title="scala.xml.NodeSeq">NodeSeq</a> = <span title="Null(null)" class="keyword">null</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><span title="Char(\'?\')" class="char">'?'</span> <a href="../../Char.scala.html#54902" title="(x: Char)Boolean">==</a> <a href="#1061015" title="=&gt; Char">ch</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#1061038" title="=&gt; Char">nextch</a>;
      <a href="#1062775" title="(Option[String], Option[String], Option[Boolean])">info_prolog</a> = <a href="#1061030" title="()(Option[String], Option[String], Option[Boolean])">prolog</a><span class="delimiter">(</span><span class="delimiter">)</span>
      <a href="#1061023" title="=&gt; scala.xml.Document">doc</a>.<a href="../Document.scala.html#1035379" title="(x$1: Option[String])Unit">version</a>    = <a href="#1062775" title="(Option[String], Option[String], Option[Boolean])">info_prolog</a>.<a href="../../Tuple3.scala.html#53312" title="=&gt; Option[String]">_1</a>
      <a href="#1061023" title="=&gt; scala.xml.Document">doc</a>.<a href="../Document.scala.html#1035373" title="(x$1: Option[String])Unit">encoding</a>   = <a href="#1062775" title="(Option[String], Option[String], Option[Boolean])">info_prolog</a>.<a href="../../Tuple3.scala.html#53314" title="=&gt; Option[String]">_2</a>
      <a href="#1061023" title="=&gt; scala.xml.Document">doc</a>.<a href="../Document.scala.html#1035376" title="(x$1: Option[Boolean])Unit">standAlone</a> = <a href="#1062775" title="(Option[String], Option[String], Option[Boolean])">info_prolog</a>.<a href="../../Tuple3.scala.html#53316" title="=&gt; Option[Boolean]">_3</a>

      <a href="#1062776" title="scala.xml.NodeSeq">children</a> = <a href="#1061045" title="(pscope: scala.xml.NamespaceBinding)scala.xml.NodeSeq">content</a><span class="delimiter">(</span><a href="../TopScope.scala.html#46183" title="object scala.xml.TopScope">TopScope</a><span class="delimiter">)</span> <span class="comment">// DTD handled as side effect</span>
    <span class="delimiter">}</span>
    <span class="keyword">else</span> <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="scala.xml.NodeBuffer" id="1062827">ts</a> = <span title="scala.xml.NodeBuffer" class="keyword">new</span> <a href="../NodeBuffer.scala.html#46221" title="scala.xml.NodeBuffer">NodeBuffer</a><span class="delimiter">(</span><span class="delimiter">)</span>;
      <a href="#1061044" title="(pscope: scala.xml.NamespaceBinding, ts: scala.xml.NodeBuffer)Unit">content1</a><span class="delimiter">(</span><a href="../TopScope.scala.html#46183" title="object scala.xml.TopScope">TopScope</a>, <a href="#1062827" title="scala.xml.NodeBuffer">ts</a><span class="delimiter">)</span>; <span class="comment">// DTD handled as side effect</span>
      <a href="#1062827" title="scala.xml.NodeBuffer">ts</a> <a href="../NodeBuffer.scala.html#475527" title="(o: Any)scala.xml.NodeBuffer">&amp;+</a> <a href="#1061045" title="(pscope: scala.xml.NamespaceBinding)scala.xml.NodeSeq">content</a><span class="delimiter">(</span><a href="../TopScope.scala.html#46183" title="object scala.xml.TopScope">TopScope</a><span class="delimiter">)</span>;
      <a href="#1062776" title="scala.xml.NodeSeq">children</a> = <a href="../NodeSeq.scala.html#46258" title="object scala.xml.NodeSeq">NodeSeq</a>.<a href="../NodeSeq.scala.html#462421" title="(s: Seq[scala.xml.Node])scala.xml.NodeSeq">fromSeq</a><span class="delimiter">(</span><a href="#1062827" title="scala.xml.NodeBuffer">ts</a><span class="delimiter">)</span>;
    <span class="delimiter">}</span>
    <span class="comment">//Console.println(&quot;[MarkupParser::document] children now: &quot;+children.toList);</span>
    <span class="keyword">var</span> <a title="Int" id="1062777">elemCount</a> = <span title="Int(0)" class="int">0</span>;
    <span class="keyword">var</span> <a title="scala.xml.Node" id="1062778">theNode</a>: <a href="../Node.scala.html#46155" title="scala.xml.Node">Node</a> = <span title="Null(null)" class="keyword">null</span>;
    <span class="keyword">for</span> <span class="delimiter">(</span><a title="scala.xml.Node" id="1062849">c</a> &lt;- <a href="../../collection/IterableLike.scala.html#53856" title="(f: scala.xml.Node =&gt; Unit)Unit">children</a><span class="delimiter">)</span> <a href="#1062849" title="scala.xml.Node">c</a> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <span title="Unit">_</span>:<a href="../ProcInstr.scala.html#46413" title="scala.xml.ProcInstr">ProcInstr</a> =&gt; ;
      <span class="keyword">case</span> <span title="Unit">_</span>:<a href="../Comment.scala.html#46143" title="scala.xml.Comment">Comment</a> =&gt; ;
      <span class="keyword">case</span> <span title="Unit">_</span>:<a href="../EntityRef.scala.html#46374" title="scala.xml.EntityRef">EntityRef</a> =&gt; <span class="comment">// todo: fix entities, shouldn't be &quot;special&quot;</span>
        <a href="#1061062" title="(str: String)Unit">reportSyntaxError</a><span class="delimiter">(</span><span title="java.lang.String(&quot;no entity references allowed here&quot;)" class="string">&quot;no entity references allowed here&quot;</span><span class="delimiter">)</span>;
      <span class="keyword">case</span> <a title="Unit" id="1062854">s</a>:<a href="../SpecialNode.scala.html#46281" title="scala.xml.SpecialNode">SpecialNode</a> =&gt;
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#1062854" title="scala.xml.SpecialNode">s</a>.<a href="../Node.scala.html#460179" title="()String">toString</a><span class="delimiter">(</span><span class="delimiter">)</span>.<span title="()java.lang.String">trim</span><span class="delimiter">(</span><span class="delimiter">)</span>.<span title="()Int">length</span> <a href="../../Int.scala.html#54775" title="(x: Int)Boolean">&gt;</a> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span class="comment">//non-empty text nodes not allowed</span>
          <a href="#1062777" title="Int">elemCount</a> = <a href="#1062777" title="Int">elemCount</a> <a href="../../Int.scala.html#54804" title="(x: Int)Int">+</a> <span title="Int(2)" class="int">2</span>;
      <span class="keyword">case</span> <a title="Unit" id="1062864">m</a>:<a href="../Node.scala.html#46155" title="scala.xml.Node">Node</a> =&gt;
        <a href="#1062777" title="Int">elemCount</a> = <a href="#1062777" title="Int">elemCount</a> <a href="../../Int.scala.html#54804" title="(x: Int)Int">+</a> <span title="Int(1)" class="int">1</span>;
        <a href="#1062778" title="scala.xml.Node">theNode</a> = <a href="#1062864" title="scala.xml.Node">m</a>;
    <span class="delimiter">}</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><span title="Int(1)" class="int">1</span> <a href="../../Int.scala.html#54754" title="(x: Int)Boolean">!=</a> <a href="#1062777" title="Int">elemCount</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#1061062" title="(str: String)Unit">reportSyntaxError</a><span class="delimiter">(</span><span title="java.lang.String(&quot;document must contain exactly one element&quot;)" class="string">&quot;document must contain exactly one element&quot;</span><span class="delimiter">)</span>
      <a href="../../Console.scala.html#507" title="object Console">Console</a>.<a href="../../Console.scala.html#58055" title="(x: Any)Unit">println</a><span class="delimiter">(</span><a href="#1062776" title="scala.xml.NodeSeq">children</a>.<a href="../../collection/TraversableOnce.scala.html#53691" title="=&gt; List[scala.xml.Node]">toList</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <a href="#1061023" title="=&gt; scala.xml.Document">doc</a>.<a href="../Document.scala.html#1035359" title="(x$1: Seq[scala.xml.Node])Unit">children</a> = <a href="#1062776" title="scala.xml.NodeSeq">children</a>
    <a href="#1061023" title="=&gt; scala.xml.Document">doc</a>.<a href="../Document.scala.html#1035362" title="(x$1: scala.xml.Node)Unit">docElem</a> = <a href="#1062778" title="scala.xml.Node">theNode</a>
    <a href="#1061023" title="=&gt; scala.xml.Document">doc</a>
  <span class="delimiter">}</span>

  <span class="comment">/** append Unicode character to name buffer*/</span>
  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="(c: Char)StringBuilder" id="1061033">putChar</a><span class="delimiter">(</span><a title="Char" id="1062882">c</a>: <a href="../../Char.scala.html#2189" title="Char">Char</a><span class="delimiter">)</span> = <a href="#1061017" title="=&gt; StringBuilder">cbuf</a>.<a href="../../collection/mutable/StringBuilder.scala.html#60543" title="(x: Char)StringBuilder">append</a><span class="delimiter">(</span><a href="#1062882" title="Char">c</a><span class="delimiter">)</span>

  <span class="comment">/** As the current code requires you to call nextch once manually
   *  after construction, this method formalizes that suboptimal reality.
   */</span>
  <span class="keyword">def</span> <a title="=&gt; MarkupParser.this.type" id="1061034">initialize</a>: <span class="keyword">this</span>.<span class="keyword">type</span> = <span class="delimiter">{</span>
    <a href="#1061038" title="=&gt; Char">nextch</a>
    <a href="#47057" title="MarkupParser.this.type" class="keyword">this</a>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="=&gt; Char" id="1061035">ch_returning_nextch</a> = <span class="delimiter">{</span> <span class="keyword">val</span> <a title="Char" id="1062892">res</a> = <a href="#1061015" title="=&gt; Char">ch</a> ; <a href="#1061038" title="=&gt; Char">nextch</a> ; <a href="#1062892" title="Char">res</a> <span class="delimiter">}</span>
  <span class="keyword">def</span> <a title="(position: Int, name: String, text: String)scala.xml.NodeSeq" id="1061036">mkProcInstr</a><span class="delimiter">(</span><a title="Int" id="1062893">position</a>: <a href="../../Int.scala.html#386" title="Int">Int</a>, <a title="String" id="1062894">name</a>: <span title="String">String</span>, <a title="String" id="1062895">text</a>: <span title="String">String</span><span class="delimiter">)</span>: <a href="../NodeSeq.scala.html#46257" title="scala.xml.NodeSeq">NodeSeq</a> =
    <a href="#1061000" title="=&gt; scala.xml.parsing.MarkupHandler">handle</a>.<a href="MarkupHandler.scala.html#1057522" title="(pos: Int, target: String, txt: String)scala.xml.NodeSeq">procInstr</a><span class="delimiter">(</span><a href="#1062893" title="Int">position</a>, <a href="#1062894" title="String">name</a>, <a href="#1062895" title="String">text</a><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(name: String, pscope: scala.xml.NamespaceBinding)(scala.xml.MetaData, scala.xml.NamespaceBinding)" id="1061037">mkAttributes</a><span class="delimiter">(</span><a title="String" id="1062900">name</a>: <span title="String">String</span>, <a title="scala.xml.NamespaceBinding" id="1062901">pscope</a>: <a href="../NamespaceBinding.scala.html#46320" title="scala.xml.NamespaceBinding">NamespaceBinding</a><span class="delimiter">)</span> =
    <span title="(scala.xml.MetaData, scala.xml.NamespaceBinding)" class="keyword">if</span> <span class="delimiter">(</span><a href="TokenTests.scala.html#566100" title="(ch: Char)Boolean">isNameStart</a> <span class="delimiter">(</span><a href="#1061015" title="=&gt; Char">ch</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="#1061039" title="(pscope: scala.xml.NamespaceBinding)(scala.xml.MetaData, scala.xml.NamespaceBinding)">xAttributes</a><span class="delimiter">(</span><a href="#1062901" title="scala.xml.NamespaceBinding">pscope</a><span class="delimiter">)</span>
    <span class="keyword">else</span> <a href="../../Tuple2.scala.html#53390" title="(_1: scala.xml.Null.type, _2: scala.xml.NamespaceBinding)(scala.xml.Null.type, scala.xml.NamespaceBinding)" class="delimiter">(</a><a href="../Null.scala.html#46435" title="object scala.xml.Null">Null</a>, <a href="#1062901" title="scala.xml.NamespaceBinding">pscope</a><span class="delimiter">)</span>

  <span class="comment">/** this method assign the next character to ch and advances in input */</span>
  <span class="keyword">def</span> <a title="=&gt; Char" id="1061038">nextch</a> = <span class="delimiter">{</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#1060996" title="=&gt; scala.io.Source">curInput</a>.<a href="../../io/Source.scala.html#204279" title="=&gt; Boolean">hasNext</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#1061015" title="(x$1: Char)Unit">ch</a> = <a href="#1060996" title="=&gt; scala.io.Source">curInput</a>.<a href="../../io/Source.scala.html#204280" title="()Char">next</a>
      <a href="#1061006" title="(x$1: Int)Unit">pos</a> = <a href="#1060996" title="=&gt; scala.io.Source">curInput</a>.<a href="../../io/Source.scala.html#204289" title="=&gt; Int">pos</a>
    <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="Int" id="1062802">ilen</a> = <a href="#1061003" title="=&gt; List[scala.io.Source]">inpStack</a>.<a href="../../collection/LinearSeqOptimized.scala.html#71030" title="=&gt; Int">length</a>;
      <span class="comment">//Console.println(&quot;  ilen = &quot;+ilen+ &quot; extIndex = &quot;+extIndex);</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><span class="delimiter">(</span><a href="#1062802" title="Int">ilen</a> <a href="../../Int.scala.html#54754" title="(x: Int)Boolean">!=</a> <a href="#1061009" title="=&gt; Int">extIndex</a><span class="delimiter">)</span> <a href="../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a> <span class="delimiter">(</span><a href="#1062802" title="Int">ilen</a> <a href="../../Int.scala.html#54775" title="(x: Int)Boolean">&gt;</a> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="comment">/** for external source, inpStack == Nil ! need notify of eof! */</span>
        <a href="#1061066" title="()Unit">pop</a><span class="delimiter">(</span><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
        <a href="#1061026" title="(x$1: Boolean)Unit">eof</a> = <span title="Boolean(true)" class="keyword">true</span>
        <a href="#1061015" title="(x$1: Char)Unit">ch</a> = <span title="Int(0)" class="int">0</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="Char" class="delimiter">[</span><a href="../../Char.scala.html#2189" title="Char">Char</a><span class="delimiter">]</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
    <a href="#1061015" title="=&gt; Char">ch</a>
  <span class="delimiter">}</span>

  <span class="comment">/** parse attribute and create namespace scope, metadata
   *  [41] Attributes    ::= { S Name Eq AttValue }
   */</span>
  <span class="keyword">def</span> <a title="(pscope: scala.xml.NamespaceBinding)(scala.xml.MetaData, scala.xml.NamespaceBinding)" id="1061039">xAttributes</a><span class="delimiter">(</span><a title="scala.xml.NamespaceBinding" id="1062584">pscope</a>:<a href="../NamespaceBinding.scala.html#46320" title="scala.xml.NamespaceBinding">NamespaceBinding</a><span class="delimiter">)</span>: <a href="../../Tuple2.scala.html#1520" title="(scala.xml.MetaData, scala.xml.NamespaceBinding)" class="delimiter">(</a>MetaData,NamespaceBinding<span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span class="keyword">var</span> <a title="scala.xml.NamespaceBinding" id="1062912">scope</a>: <a href="../NamespaceBinding.scala.html#46320" title="scala.xml.NamespaceBinding">NamespaceBinding</a> = <a href="#1062584" title="scala.xml.NamespaceBinding">pscope</a>
    <span class="keyword">var</span> <a title="scala.xml.MetaData" id="1062913">aMap</a>: <a href="../MetaData.scala.html#46083" title="scala.xml.MetaData">MetaData</a> = <a href="../Null.scala.html#46435" title="object scala.xml.Null">Null</a>
    <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><a href="TokenTests.scala.html#566100" title="(ch: Char)Boolean">isNameStart</a><span class="delimiter">(</span><a href="#1061015" title="=&gt; Char">ch</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="#1062914" title="()Unit" class="delimiter">{</a>
      <span class="keyword">val</span> <a title="Int" id="1062915">pos</a> = <a href="#47057" title="MarkupParser.this.type" class="keyword">this</a>.<a href="#1061006" title="=&gt; Int">pos</a>

      <span class="keyword">val</span> <a title="String" id="1062916">qname</a> = <a href="MarkupParserCommon.scala.html#566181" title="=&gt; String">xName</a>
      <span class="keyword">val</span> <a title="Unit" id="1062917">_</a>     = <a href="MarkupParserCommon.scala.html#566204" title="()Unit">xEQ</a>
      <span class="keyword">val</span> <a title="String" id="1062918">value</a> = <a href="MarkupParserCommon.scala.html#566178" title="()String">xAttributeValue</a><span class="delimiter">(</span><span class="delimiter">)</span>

      <a href="../Utility.scala.html#46093" title="object scala.xml.Utility">Utility</a>.<a href="../Utility.scala.html#566085" title="(name: String)Option[String]">prefix</a><span class="delimiter">(</span><a href="#1062916" title="String">qname</a><span class="delimiter">)</span> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <span title="Unit">Some</span><span class="delimiter">(</span><span title="java.lang.String(&quot;xmlns&quot;)" class="string">&quot;xmlns&quot;</span><span class="delimiter">)</span> =&gt;
          <span class="keyword">val</span> <a title="java.lang.String" id="1062924">prefix</a> = <a href="#1062916" title="String">qname</a>.<span title="(x$1: Int, x$2: Int)java.lang.String">substring</span><span class="delimiter">(</span><span title="Int(6)" class="int">6</span> <span class="comment">/*xmlns:*/</span> , <a href="#1062916" title="String">qname</a>.<span title="()Int">length</span><span class="delimiter">)</span>;
          <a href="#1062912" title="scala.xml.NamespaceBinding">scope</a> = <span title="scala.xml.NamespaceBinding" class="keyword">new</span> <a href="../NamespaceBinding.scala.html#46320" title="scala.xml.NamespaceBinding">NamespaceBinding</a><span class="delimiter">(</span><a href="#1062924" title="java.lang.String">prefix</a>, <a href="#1062918" title="String">value</a>, <a href="#1062912" title="scala.xml.NamespaceBinding">scope</a><span class="delimiter">)</span>;

        <span class="keyword">case</span> <span title="Unit">Some</span><span class="delimiter">(</span><a title="String" id="1062928">prefix</a><span class="delimiter">)</span>       =&gt;
          <span class="keyword">val</span> <a title="java.lang.String" id="1062929">key</a> = <a href="#1062916" title="String">qname</a>.<span title="(x$1: Int, x$2: Int)java.lang.String">substring</span><span class="delimiter">(</span><a href="#1062928" title="String">prefix</a>.<span title="()Int">length</span><a href="../../Int.scala.html#54804" title="(x: Int)Int">+</a><span title="Int(1)" class="int">1</span>, <a href="#1062916" title="String">qname</a>.<span title="()Int">length</span><span class="delimiter">)</span>;
          <a href="#1062913" title="scala.xml.MetaData">aMap</a> = <span title="scala.xml.PrefixedAttribute" class="keyword">new</span> <a href="../PrefixedAttribute.scala.html#46140" title="scala.xml.PrefixedAttribute">PrefixedAttribute</a><span class="delimiter">(</span><a href="#1062928" title="String">prefix</a>, <a href="#1062929" title="java.lang.String">key</a>, <a href="../Text.scala.html#567616" title="(_data: String)scala.xml.Text">Text</a><span class="delimiter">(</span><a href="#1062918" title="String">value</a><span class="delimiter">)</span>, <a href="#1062913" title="scala.xml.MetaData">aMap</a><span class="delimiter">)</span>;

        <span class="keyword">case</span> <span title="Unit">_</span>             =&gt;
          <span title="Unit" class="keyword">if</span><span class="delimiter">(</span> <a href="#1062916" title="String">qname</a> <span title="(x$1: AnyRef)Boolean">==</span> <span title="java.lang.String(&quot;xmlns&quot;)" class="string">&quot;xmlns&quot;</span> <span class="delimiter">)</span>
            <a href="#1062912" title="scala.xml.NamespaceBinding">scope</a> = <span title="scala.xml.NamespaceBinding" class="keyword">new</span> <a href="../NamespaceBinding.scala.html#46320" title="scala.xml.NamespaceBinding">NamespaceBinding</a><span class="delimiter">(</span><span title="Null(null)" class="keyword">null</span>, <a href="#1062918" title="String">value</a>, <a href="#1062912" title="scala.xml.NamespaceBinding">scope</a><span class="delimiter">)</span>;
          <span class="keyword">else</span>
            <a href="#1062913" title="scala.xml.MetaData">aMap</a> = <span title="scala.xml.UnprefixedAttribute" class="keyword">new</span> <a href="../UnprefixedAttribute.scala.html#46275" title="scala.xml.UnprefixedAttribute">UnprefixedAttribute</a><span class="delimiter">(</span><a href="#1062916" title="String">qname</a>, <a href="../Text.scala.html#567616" title="(_data: String)scala.xml.Text">Text</a><span class="delimiter">(</span><a href="#1062918" title="String">value</a><span class="delimiter">)</span>, <a href="#1062913" title="scala.xml.MetaData">aMap</a><span class="delimiter">)</span>;
      <span class="delimiter">}</span>

      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><span class="delimiter">(</span><a href="#1061015" title="=&gt; Char">ch</a> <a href="../../Char.scala.html#54909" title="(x: Char)Boolean">!=</a> <span title="Char(\'/\')" class="char">'/'</span><span class="delimiter">)</span> <a href="../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a> <span class="delimiter">(</span><a href="#1061015" title="=&gt; Char">ch</a> <a href="../../Char.scala.html#54909" title="(x: Char)Boolean">!=</a> <span title="Char(\'&gt;\')" class="char">'&gt;'</span><span class="delimiter">)</span> <a href="../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a> <span class="delimiter">(</span><span title="Char(\'?\')" class="char">'?'</span> <a href="../../Char.scala.html#54909" title="(x: Char)Boolean">!=</a> <a href="#1061015" title="=&gt; Char">ch</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <a href="MarkupParserCommon.scala.html#566206" title="()Unit">xSpace</a>;
    <span class="delimiter">}</span>

    <span title="Unit" class="keyword">if</span><span class="delimiter">(</span><a href="../../Boolean.scala.html#55576" title="=&gt; Boolean">!</a><a href="#1062913" title="scala.xml.MetaData">aMap</a>.<a href="../MetaData.scala.html#460235" title="(scope: scala.xml.NamespaceBinding)Boolean">wellformed</a><span class="delimiter">(</span><a href="#1062912" title="scala.xml.NamespaceBinding">scope</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <a href="#1061062" title="(str: String)Unit">reportSyntaxError</a><span class="delimiter">(</span> <span title="java.lang.String(&quot;double attribute&quot;)" class="string">&quot;double attribute&quot;</span><span class="delimiter">)</span>;

    <a href="../../Tuple2.scala.html#53390" title="(_1: scala.xml.MetaData, _2: scala.xml.NamespaceBinding)(scala.xml.MetaData, scala.xml.NamespaceBinding)" class="delimiter">(</a><a href="#1062913" title="scala.xml.MetaData">aMap</a>,<a href="#1062912" title="scala.xml.NamespaceBinding">scope</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/** entity value, terminated by either ' or &quot;. value may not contain &amp;lt;.
   *       AttValue     ::= `'` { _  } `'`
   *                      | `&quot;` { _ } `&quot;`
   */</span>
  <span class="keyword">def</span> <a title="()String" id="1061040">xEntityValue</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="String">String</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Char" id="1062975">endch</a> = <a href="#1061015" title="=&gt; Char">ch</a>
    <a href="#1061038" title="=&gt; Char">nextch</a>
    <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><a href="#1061015" title="=&gt; Char">ch</a> <a href="../../Char.scala.html#54909" title="(x: Char)Boolean">!=</a> <a href="#1062975" title="Char">endch</a> <a href="../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../Boolean.scala.html#55576" title="=&gt; Boolean">!</a><a href="#1061026" title="=&gt; Boolean">eof</a><span class="delimiter">)</span> <a href="#1062977" title="()Unit" class="delimiter">{</a>
      <a href="#1061033" title="(c: Char)StringBuilder">putChar</a><span class="delimiter">(</span><a href="#1061015" title="=&gt; Char">ch</a><span class="delimiter">)</span>
      <a href="#1061038" title="=&gt; Char">nextch</a>
    <span class="delimiter">}</span>
    <a href="#1061038" title="=&gt; Char">nextch</a>
    <span class="keyword">val</span> <a title="java.lang.String" id="1062976">str</a> = <a href="#1061017" title="=&gt; StringBuilder">cbuf</a>.<a href="../../collection/mutable/StringBuilder.scala.html#60572" title="()java.lang.String">toString</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <a href="#1061017" title="=&gt; StringBuilder">cbuf</a>.<a href="../../collection/mutable/StringBuilder.scala.html#60514" title="(n: Int)Unit">length</a> = <span title="Int(0)" class="int">0</span>
    <a href="#1062976" title="java.lang.String">str</a>
  <span class="delimiter">}</span>

  <span class="comment">/** '&amp;lt;! CharData ::= [CDATA[ ( {char} - {char}&quot;]]&amp;gt;&quot;{char} ) ']]&amp;gt;'
   *
   * see [15]
   */</span>
  <span class="keyword">def</span> <a title="=&gt; scala.xml.NodeSeq" id="1061041">xCharData</a>: <a href="../NodeSeq.scala.html#46257" title="scala.xml.NodeSeq">NodeSeq</a> = <span class="delimiter">{</span>
    <a href="MarkupParserCommon.scala.html#566203" title="(that: Seq[Char])Unit">xToken</a><span class="delimiter">(</span><a href="../../LowPriorityImplicits.scala.html#9503" title="implicit scala.LowPriorityImplicits.wrapString : (s: String)scala.collection.immutable.WrappedString" class="string">&quot;[CDATA[&quot;</a><span class="delimiter">)</span>
    <span class="keyword">def</span> <a title="(pos: Int, s: String)scala.xml.NodeSeq" id="1062985">mkResult</a><span class="delimiter">(</span><a title="Int" id="1062992">pos</a>: <a href="../../Int.scala.html#386" title="Int">Int</a>, <a title="String" id="1062993">s</a>: <span title="String">String</span><span class="delimiter">)</span>: <a href="../NodeSeq.scala.html#46257" title="scala.xml.NodeSeq">NodeSeq</a> = <span class="delimiter">{</span>
      <a href="#1061000" title="=&gt; scala.xml.parsing.MarkupHandler">handle</a>.<a href="MarkupHandler.scala.html#1057525" title="(pos: Int, txt: String)scala.xml.NodeSeq">text</a><span class="delimiter">(</span><a href="#1062992" title="Int">pos</a>, <a href="#1062993" title="String">s</a><span class="delimiter">)</span>
      <a href="../PCData.scala.html#1049257" title="(_data: String)scala.xml.PCData">PCData</a><span class="delimiter">(</span><a href="#1062993" title="String">s</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
    <a href="MarkupParserCommon.scala.html#566215" title="(handler: (MarkupParser.this.PositionType, String) =&gt; scala.xml.NodeSeq, positioner: () =&gt; MarkupParser.this.PositionType, until: String)scala.xml.NodeSeq">xTakeUntil</a><span class="delimiter">(</span><a href="#1062985" title="(pos: Int, s: String)scala.xml.NodeSeq">mkResult</a>, <span class="delimiter">(</span><span class="delimiter">)</span> =&gt; <a href="#1061006" title="=&gt; Int">pos</a>, <span title="java.lang.String(&quot;]]&gt;&quot;)" class="string">&quot;]]&gt;&quot;</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/** Comment ::= '&amp;lt;!--' ((Char - '-') | ('-' (Char - '-')))* '--&amp;gt;'
   *
   * see [15]
   */</span>
  <span class="keyword">def</span> <a title="=&gt; scala.xml.NodeSeq" id="1061042">xComment</a>: <a href="../NodeSeq.scala.html#46257" title="scala.xml.NodeSeq">NodeSeq</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="StringBuilder" id="1063011">sb</a>: <a href="../../collection/mutable/StringBuilder.scala.html#15106" title="StringBuilder">StringBuilder</a> = <a href="../../collection/mutable/StringBuilder.scala.html#60509" title="()StringBuilder" class="keyword">new</a> <a href="../../package.scala.html#47558" title="StringBuilder">StringBuilder</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <a href="MarkupParserCommon.scala.html#566203" title="(that: Seq[Char])Unit">xToken</a><span class="delimiter">(</span><a href="../../LowPriorityImplicits.scala.html#9503" title="implicit scala.LowPriorityImplicits.wrapString : (s: String)scala.collection.immutable.WrappedString" class="string">&quot;--&quot;</a><span class="delimiter">)</span>
    <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span> <a href="#1063012" title="()Unit" class="delimiter">{</a>
      <span title="StringBuilder" class="keyword">if</span> <span class="delimiter">(</span><a href="#1061015" title="=&gt; Char">ch</a> <a href="../../Char.scala.html#54902" title="(x: Char)Boolean">==</a> <span title="Char(\'-\')" class="char">'-'</span>  <a href="../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a> <span class="delimiter">{</span> <a href="#1063011" title="StringBuilder">sb</a>.<a href="../../collection/mutable/StringBuilder.scala.html#60543" title="(x: Char)StringBuilder">append</a><span class="delimiter">(</span><a href="#1061015" title="=&gt; Char">ch</a><span class="delimiter">)</span>; <a href="#1061038" title="=&gt; Char">nextch</a>; <a href="#1061015" title="=&gt; Char">ch</a> <a href="../../Char.scala.html#54902" title="(x: Char)Boolean">==</a> <span title="Char(\'-\')" class="char">'-'</span> <span class="delimiter">}</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#1063011" title="StringBuilder">sb</a>.<a href="../../collection/mutable/StringBuilder.scala.html#60514" title="(n: Int)Unit">length</a> = <a href="#1063011" title="StringBuilder">sb</a>.<a href="../../collection/mutable/StringBuilder.scala.html#60513" title="=&gt; Int">length</a> <a href="../../Int.scala.html#54811" title="(x: Int)Int">-</a> <span title="Int(1)" class="int">1</span>
        <a href="#1061038" title="=&gt; Char">nextch</a>
        <a href="MarkupParserCommon.scala.html#566202" title="(that: Char)Unit">xToken</a><span class="delimiter">(</span><span title="Char(\'&gt;\')" class="char">'&gt;'</span><span class="delimiter">)</span>
        <span title="Nothing" class="keyword">return</span> <a href="#1061000" title="=&gt; scala.xml.parsing.MarkupHandler">handle</a>.<a href="MarkupHandler.scala.html#1057523" title="(pos: Int, comment: String)scala.xml.NodeSeq">comment</a><span class="delimiter">(</span><a href="#1061006" title="=&gt; Int">pos</a>, <a href="#1063011" title="StringBuilder">sb</a>.<a href="../../collection/mutable/StringBuilder.scala.html#60572" title="()java.lang.String">toString</a><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">else</span> <a href="#1063011" title="StringBuilder">sb</a>.<a href="../../collection/mutable/StringBuilder.scala.html#60543" title="(x: Char)StringBuilder">append</a><span class="delimiter">(</span><a href="#1061015" title="=&gt; Char">ch</a><span class="delimiter">)</span>
      <a href="#1061038" title="=&gt; Char">nextch</a>
    <span class="delimiter">}</span>
    <span title="Nothing" class="keyword">throw</span> <a href="FatalError.scala.html#1062298" title="(msg: String)scala.xml.parsing.FatalError">FatalError</a><span class="delimiter">(</span><span title="java.lang.String(&quot;this cannot happen&quot;)" class="string">&quot;this cannot happen&quot;</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/* todo: move this into the NodeBuilder class */</span>
  <span class="keyword">def</span> <a title="(pos: Int, ts: scala.xml.NodeBuffer, txt: String)Unit" id="1061043">appendText</a><span class="delimiter">(</span><a title="Int" id="1063050">pos</a>: <a href="../../Int.scala.html#386" title="Int">Int</a>, <a title="scala.xml.NodeBuffer" id="1063051">ts</a>: <a href="../NodeBuffer.scala.html#46221" title="scala.xml.NodeBuffer">NodeBuffer</a>, <a title="String" id="1063052">txt</a>: <span title="String">String</span><span class="delimiter">)</span>: <a href="../../Unit.scala.html#461" title="Unit">Unit</a> = <span class="delimiter">{</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#1060993" title="=&gt; Boolean">preserveWS</a><span class="delimiter">)</span>
      <a href="#1063051" title="scala.xml.NodeBuffer">ts</a> <a href="../NodeBuffer.scala.html#475527" title="(o: Any)scala.xml.NodeBuffer">&amp;+</a> <a href="#1061000" title="=&gt; scala.xml.parsing.MarkupHandler">handle</a>.<a href="MarkupHandler.scala.html#1057525" title="(pos: Int, txt: String)scala.xml.NodeSeq">text</a><span class="delimiter">(</span><a href="#1063050" title="Int">pos</a>, <a href="#1063052" title="String">txt</a><span class="delimiter">)</span>;
    <span class="keyword">else</span>
      <span class="keyword">for</span> <span class="delimiter">(</span><a title="scala.xml.Text" id="1063072">t</a> &lt;- <a href="../TextBuffer.scala.html#46201" title="object scala.xml.TextBuffer">TextBuffer</a>.<a href="../TextBuffer.scala.html#567576" title="(str: String)scala.xml.TextBuffer">fromString</a><span class="delimiter">(</span><a href="#1063052" title="String">txt</a><span class="delimiter">)</span>.<a href="../../collection/IterableLike.scala.html#53856" title="(f: scala.xml.Text =&gt; scala.xml.NodeBuffer)Unit">toText</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#1063051" title="scala.xml.NodeBuffer">ts</a> <a href="../NodeBuffer.scala.html#475527" title="(o: Any)scala.xml.NodeBuffer">&amp;+</a> <a href="#1061000" title="=&gt; scala.xml.parsing.MarkupHandler">handle</a>.<a href="MarkupHandler.scala.html#1057525" title="(pos: Int, txt: String)scala.xml.NodeSeq">text</a><span class="delimiter">(</span><a href="#1063050" title="Int">pos</a>, <a href="#1063072" title="scala.xml.Text">t</a>.<a href="../Atom.scala.html#475550" title="=&gt; String">text</a><span class="delimiter">)</span>;
      <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="comment">/** '&amp;lt;' content1 ::=  ... */</span>
  <span class="keyword">def</span> <a title="(pscope: scala.xml.NamespaceBinding, ts: scala.xml.NodeBuffer)Unit" id="1061044">content1</a><span class="delimiter">(</span><a title="scala.xml.NamespaceBinding" id="1062828">pscope</a>: <a href="../NamespaceBinding.scala.html#46320" title="scala.xml.NamespaceBinding">NamespaceBinding</a>, <a title="scala.xml.NodeBuffer" id="1062829">ts</a>: <a href="../NodeBuffer.scala.html#46221" title="scala.xml.NodeBuffer">NodeBuffer</a><span class="delimiter">)</span>: <a href="../../Unit.scala.html#461" title="Unit">Unit</a> =
    <a href="#1061015" title="=&gt; Char">ch</a> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <span title="Unit" class="char">'!'</span> =&gt;
        <a href="#1061038" title="=&gt; Char">nextch</a>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><span title="Char(\'[\')" class="char">'['</span> <a href="../../Char.scala.html#54902" title="(x: Char)Boolean">==</a> <a href="#1061015" title="=&gt; Char">ch</a><span class="delimiter">)</span>                 <span class="comment">// CDATA</span>
        <a href="#1062829" title="scala.xml.NodeBuffer">ts</a> <a href="../NodeBuffer.scala.html#475527" title="(o: Any)scala.xml.NodeBuffer">&amp;+</a> <a href="#1061041" title="=&gt; scala.xml.NodeSeq">xCharData</a>
      <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><span title="Char(\'D\')" class="char">'D'</span> <a href="../../Char.scala.html#54902" title="(x: Char)Boolean">==</a> <a href="#1061015" title="=&gt; Char">ch</a><span class="delimiter">)</span> <span class="comment">// doctypedecl, parse DTD // @todo REMOVE HACK</span>
        <a href="#1061047" title="()Unit">parseDTD</a><span class="delimiter">(</span><span class="delimiter">)</span>
      <span class="keyword">else</span> <span class="comment">// comment</span>
        <a href="#1062829" title="scala.xml.NodeBuffer">ts</a> <a href="../NodeBuffer.scala.html#475527" title="(o: Any)scala.xml.NodeBuffer">&amp;+</a> <a href="#1061042" title="=&gt; scala.xml.NodeSeq">xComment</a>
      <span class="keyword">case</span> <span title="Unit" class="char">'?'</span> =&gt;                    <span class="comment">// PI</span>
        <a href="#1061038" title="=&gt; Char">nextch</a>
        <a href="#1062829" title="scala.xml.NodeBuffer">ts</a> <a href="../NodeBuffer.scala.html#475527" title="(o: Any)scala.xml.NodeBuffer">&amp;+</a> <a href="MarkupParserCommon.scala.html#566176" title="=&gt; MarkupParser.this.ElementType">xProcInstr</a>
      <span class="keyword">case</span> <span title="Unit">_</span>   =&gt;
        <a href="#1062829" title="scala.xml.NodeBuffer">ts</a> <a href="../NodeBuffer.scala.html#475527" title="(o: Any)scala.xml.NodeBuffer">&amp;+</a> <a href="#1061049" title="(pscope: scala.xml.NamespaceBinding)scala.xml.NodeSeq">element1</a><span class="delimiter">(</span><a href="#1062828" title="scala.xml.NamespaceBinding">pscope</a><span class="delimiter">)</span>      <span class="comment">// child</span>
    <span class="delimiter">}</span>

  <span class="comment">/** content1 ::=  '&amp;lt;' content1 | '&amp;amp;' charref ... */</span>
  <span class="keyword">def</span> <a title="(pscope: scala.xml.NamespaceBinding)scala.xml.NodeSeq" id="1061045">content</a><span class="delimiter">(</span><a title="scala.xml.NamespaceBinding" id="1062825">pscope</a>: <a href="../NamespaceBinding.scala.html#46320" title="scala.xml.NamespaceBinding">NamespaceBinding</a><span class="delimiter">)</span>: <a href="../NodeSeq.scala.html#46257" title="scala.xml.NodeSeq">NodeSeq</a> = <span class="delimiter">{</span>
    <span class="keyword">var</span> <a title="scala.xml.NodeBuffer" id="1063087">ts</a> = <span title="scala.xml.NodeBuffer" class="keyword">new</span> <a href="../NodeBuffer.scala.html#46221" title="scala.xml.NodeBuffer">NodeBuffer</a>
    <span class="keyword">var</span> <a title="Boolean" id="1063088">exit</a> = <a href="#1061026" title="=&gt; Boolean">eof</a>
    <span class="comment">// todo: optimize seq repr.</span>
    <span class="keyword">def</span> <a title="=&gt; scala.xml.NodeSeq{val theSeq: List[scala.xml.Node]}" id="1063089">done</a> = <a href="#1063091" title="scala.xml.NodeSeq{}" class="keyword">new</a> <a href="../NodeSeq.scala.html#46257" title="anonymous class $anon extends scala.xml.NodeSeq" id="1063091">NodeSeq</a> <span class="delimiter">{</span> <span class="keyword">val</span> <a title="List[scala.xml.Node]" id="1063093">theSeq</a> = <a href="#1063087" title="scala.xml.NodeBuffer">ts</a>.<a href="../../collection/TraversableOnce.scala.html#53691" title="=&gt; List[scala.xml.Node]">toList</a> <span class="delimiter">}</span>

    <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><a href="../../Boolean.scala.html#55576" title="=&gt; Boolean">!</a><a href="#1063088" title="Boolean">exit</a><span class="delimiter">)</span> <a href="#1063090" title="()Unit" class="delimiter">{</a>
      <a href="#1061012" title="(x$1: Int)Unit">tmppos</a> = <a href="#1061006" title="=&gt; Int">pos</a>
      <a href="#1063088" title="Boolean">exit</a> = <a href="#1061026" title="=&gt; Boolean">eof</a>

      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#1061026" title="=&gt; Boolean">eof</a><span class="delimiter">)</span>
        <span title="Nothing" class="keyword">return</span> <a href="#1063089" title="=&gt; scala.xml.NodeSeq{val theSeq: List[scala.xml.Node]}">done</a>

      <a href="#1061015" title="=&gt; Char">ch</a> <span title="Any" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <span title="Unit" class="char">'&lt;'</span> =&gt; <span class="comment">// another tag</span>
          <a href="#1061038" title="=&gt; Char">nextch</a> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
            <span class="keyword">case</span> <span title="Unit" class="char">'/'</span>    =&gt; <a href="#1063088" title="Boolean">exit</a> = <span title="Boolean(true)" class="keyword">true</span>  <span class="comment">// end tag</span>
            <span class="keyword">case</span> <span title="Unit">_</span>      =&gt; <a href="#1061044" title="(pscope: scala.xml.NamespaceBinding, ts: scala.xml.NodeBuffer)Unit">content1</a><span class="delimiter">(</span><a href="#1062825" title="scala.xml.NamespaceBinding">pscope</a>, <a href="#1063087" title="scala.xml.NodeBuffer">ts</a><span class="delimiter">)</span>
          <span class="delimiter">}</span>

        <span class="comment">// postcond: xEmbeddedBlock == false!</span>
        <span class="keyword">case</span> <span title="Any" class="char">'&amp;'</span> =&gt; <span class="comment">// EntityRef or CharRef</span>
          <a href="#1061038" title="=&gt; Char">nextch</a> <span title="Any" class="keyword">match</span> <span class="delimiter">{</span>
            <span class="keyword">case</span> <span title="scala.xml.NodeBuffer" class="char">'#'</span>  =&gt;  <span class="comment">// CharacterRef</span>
              <a href="#1061038" title="=&gt; Char">nextch</a>
              <span class="keyword">val</span> <a title="scala.xml.NodeSeq" id="1063105">theChar</a> = <a href="#1061000" title="=&gt; scala.xml.parsing.MarkupHandler">handle</a>.<a href="MarkupHandler.scala.html#1057525" title="(pos: Int, txt: String)scala.xml.NodeSeq">text</a><span class="delimiter">(</span><a href="#1061012" title="=&gt; Int">tmppos</a>, <a href="MarkupParserCommon.scala.html#566184" title="(ch: () =&gt; Char, nextch: () =&gt; Unit)String">xCharRef</a><span class="delimiter">(</span><span class="delimiter">(</span><span class="delimiter">)</span> =&gt; <a href="#1061015" title="=&gt; Char">ch</a>, <span class="delimiter">(</span><span class="delimiter">)</span> =&gt; <a href="#1061038" title="=&gt; Char">nextch</a><span class="delimiter">)</span><span class="delimiter">)</span>
              <a href="MarkupParserCommon.scala.html#566202" title="(that: Char)Unit">xToken</a><span class="delimiter">(</span><span title="Char(\';\')" class="char">';'</span><span class="delimiter">)</span>;
              <a href="#1063087" title="scala.xml.NodeBuffer">ts</a> <a href="../NodeBuffer.scala.html#475527" title="(o: Any)scala.xml.NodeBuffer">&amp;+</a> <a href="#1063105" title="scala.xml.NodeSeq">theChar</a>
            <span class="keyword">case</span> <span title="Any">_</span> =&gt;     <span class="comment">// EntityRef</span>
              <span class="keyword">val</span> <a title="String" id="1063118">n</a> = <a href="MarkupParserCommon.scala.html#566181" title="=&gt; String">xName</a>
              <a href="MarkupParserCommon.scala.html#566202" title="(that: Char)Unit">xToken</a><span class="delimiter">(</span><span title="Char(\';\')" class="char">';'</span><span class="delimiter">)</span>

              <span title="Any" class="keyword">if</span> <span class="delimiter">(</span><a href="../Utility.scala.html#1035238" title="=&gt; scala.collection.immutable.Map[java.lang.String,Char]">unescape</a> <a href="../../collection/MapLike.scala.html#73205" title="(key: java.lang.String)Boolean">contains</a> <a href="#1063118" title="String">n</a><span class="delimiter">)</span> <span class="delimiter">{</span>
                <a href="#1061000" title="=&gt; scala.xml.parsing.MarkupHandler">handle</a>.<a href="MarkupHandler.scala.html#1057524" title="(pos: Int, n: String)scala.xml.NodeSeq">entityRef</a><span class="delimiter">(</span><a href="#1061012" title="=&gt; Int">tmppos</a>, <a href="#1063118" title="String">n</a><span class="delimiter">)</span>
                <a href="#1063087" title="scala.xml.NodeBuffer">ts</a> <a href="../NodeBuffer.scala.html#475527" title="(o: Any)scala.xml.NodeBuffer">&amp;+</a> <a href="../../collection/MapLike.scala.html#73204" title="(key: java.lang.String)Char">unescape</a><span class="delimiter">(</span><a href="#1063118" title="String">n</a><span class="delimiter">)</span>
              <span class="delimiter">}</span> <span class="keyword">else</span> <a href="#1061064" title="(entityName: String)Unit">push</a><span class="delimiter">(</span><a href="#1063118" title="String">n</a><span class="delimiter">)</span>
          <span class="delimiter">}</span>
        <span class="keyword">case</span> <span title="Unit">_</span> =&gt; <span class="comment">// text content</span>
          <a href="#1061043" title="(pos: Int, ts: scala.xml.NodeBuffer, txt: String)Unit">appendText</a><span class="delimiter">(</span><a href="#1061012" title="=&gt; Int">tmppos</a>, <a href="#1063087" title="scala.xml.NodeBuffer">ts</a>, <a href="#1061050" title="=&gt; String">xText</a><span class="delimiter">)</span>;
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
    <a href="#1063089" title="=&gt; scala.xml.NodeSeq{val theSeq: List[scala.xml.Node]}">done</a>
  <span class="delimiter">}</span> <span class="comment">// content(NamespaceBinding)</span>

  <span class="comment">/** externalID ::= SYSTEM S syslit
   *                 PUBLIC S pubid S syslit
   */</span>

  <span class="keyword">def</span> <a title="()scala.xml.dtd.ExternalID" id="1061046">externalID</a><span class="delimiter">(</span><span class="delimiter">)</span>: <a href="../dtd/ExternalID.scala.html#46598" title="scala.xml.dtd.ExternalID">ExternalID</a> = <a href="#1061015" title="=&gt; Char">ch</a> <span title="scala.xml.dtd.ExternalID" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <span title="scala.xml.dtd.SystemID" class="char">'S'</span> =&gt;
      <a href="#1061038" title="=&gt; Char">nextch</a>
      <a href="MarkupParserCommon.scala.html#566203" title="(that: Seq[Char])Unit">xToken</a><span class="delimiter">(</span><a href="../../LowPriorityImplicits.scala.html#9503" title="implicit scala.LowPriorityImplicits.wrapString : (s: String)scala.collection.immutable.WrappedString" class="string">&quot;YSTEM&quot;</a><span class="delimiter">)</span>
      <a href="MarkupParserCommon.scala.html#566206" title="()Unit">xSpace</a>
      <span class="keyword">val</span> <a title="String" id="1063156">sysID</a> = <a href="#1061051" title="()String">systemLiteral</a><span class="delimiter">(</span><span class="delimiter">)</span>
      <span title="scala.xml.dtd.SystemID" class="keyword">new</span> <a href="../dtd/ExternalID.scala.html#46727" title="scala.xml.dtd.SystemID">SystemID</a><span class="delimiter">(</span><a href="#1063156" title="String">sysID</a><span class="delimiter">)</span>
    <span class="keyword">case</span> <span title="scala.xml.dtd.PublicID" class="char">'P'</span> =&gt;
      <a href="#1061038" title="=&gt; Char">nextch</a>; <a href="MarkupParserCommon.scala.html#566203" title="(that: Seq[Char])Unit">xToken</a><span class="delimiter">(</span><a href="../../LowPriorityImplicits.scala.html#9503" title="implicit scala.LowPriorityImplicits.wrapString : (s: String)scala.collection.immutable.WrappedString" class="string">&quot;UBLIC&quot;</a><span class="delimiter">)</span>
      <a href="MarkupParserCommon.scala.html#566206" title="()Unit">xSpace</a>
      <span class="keyword">val</span> <a title="String" id="1063164">pubID</a> = <a href="#1061052" title="()String">pubidLiteral</a><span class="delimiter">(</span><span class="delimiter">)</span>
      <a href="MarkupParserCommon.scala.html#566206" title="()Unit">xSpace</a>
      <span class="keyword">val</span> <a title="String" id="1063165">sysID</a> = <a href="#1061051" title="()String">systemLiteral</a><span class="delimiter">(</span><span class="delimiter">)</span>
      <span title="scala.xml.dtd.PublicID" class="keyword">new</span> <a href="../dtd/ExternalID.scala.html#46595" title="scala.xml.dtd.PublicID">PublicID</a><span class="delimiter">(</span><a href="#1063164" title="String">pubID</a>, <a href="#1063165" title="String">sysID</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>


  <span class="comment">/** parses document type declaration and assigns it to instance variable
   *  dtd.
   *
   *  &amp;lt;! parseDTD ::= DOCTYPE name ... &gt;
   */</span>
  <span class="keyword">def</span> <a title="()Unit" id="1061047">parseDTD</a><span class="delimiter">(</span><span class="delimiter">)</span>: <a href="../../Unit.scala.html#461" title="Unit">Unit</a> = <span class="delimiter">{</span> <span class="comment">// dirty but fast</span>
    <span class="comment">//Console.println(&quot;(DEBUG) parseDTD&quot;);</span>
    <span class="keyword">var</span> <a title="scala.xml.dtd.ExternalID" id="1063173">extID</a>: <a href="../dtd/ExternalID.scala.html#46598" title="scala.xml.dtd.ExternalID">ExternalID</a> = <span title="Null(null)" class="keyword">null</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#47057" title="MarkupParser.this.type" class="keyword">this</a>.<a href="#1061020" title="=&gt; scala.xml.dtd.DTD">dtd</a> <span title="(x$1: AnyRef)Boolean">ne</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span>
      <a href="#1061062" title="(str: String)Unit">reportSyntaxError</a><span class="delimiter">(</span><span title="java.lang.String(&quot;unexpected character (DOCTYPE already defined&quot;)" class="string">&quot;unexpected character (DOCTYPE already defined&quot;</span><span class="delimiter">)</span>;
    <a href="MarkupParserCommon.scala.html#566203" title="(that: Seq[Char])Unit">xToken</a><span class="delimiter">(</span><a href="../../LowPriorityImplicits.scala.html#9503" title="implicit scala.LowPriorityImplicits.wrapString : (s: String)scala.collection.immutable.WrappedString" class="string">&quot;DOCTYPE&quot;</a><span class="delimiter">)</span>
    <a href="MarkupParserCommon.scala.html#566206" title="()Unit">xSpace</a>
    <span class="keyword">val</span> <a title="String" id="1063174">n</a> = <a href="MarkupParserCommon.scala.html#566181" title="=&gt; String">xName</a>
    <a href="MarkupParserCommon.scala.html#566206" title="()Unit">xSpace</a>
    <span class="comment">//external ID</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><span title="Char(\'S\')" class="char">'S'</span> <a href="../../Char.scala.html#54902" title="(x: Char)Boolean">==</a> <a href="#1061015" title="=&gt; Char">ch</a> <a href="../../Boolean.scala.html#55579" title="(x: Boolean)Boolean">||</a> <span title="Char(\'P\')" class="char">'P'</span> <a href="../../Char.scala.html#54902" title="(x: Char)Boolean">==</a> <a href="#1061015" title="=&gt; Char">ch</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#1063173" title="scala.xml.dtd.ExternalID">extID</a> = <a href="#1061046" title="()scala.xml.dtd.ExternalID">externalID</a><span class="delimiter">(</span><span class="delimiter">)</span>
      <a href="MarkupParserCommon.scala.html#566205" title="()Unit">xSpaceOpt</a>
    <span class="delimiter">}</span>

    <span class="comment">/* parse external subset of DTD
     */</span>

    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><span class="delimiter">(</span><span title="Null(null)" class="keyword">null</span> <span title="(x$1: AnyRef)Boolean">!=</span> <a href="#1063173" title="scala.xml.dtd.ExternalID">extID</a><span class="delimiter">)</span> <a href="../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="MarkupHandler.scala.html#1057508" title="=&gt; Boolean">isValidating</a><span class="delimiter">)</span> <span class="delimiter">{</span>

      <a href="#1061065" title="(systemId: String)Unit">pushExternal</a><span class="delimiter">(</span><a href="#1063173" title="scala.xml.dtd.ExternalID">extID</a>.<a href="../dtd/ExternalID.scala.html#658257" title="=&gt; String">systemId</a><span class="delimiter">)</span>
      <a href="#1061009" title="(x$1: Int)Unit">extIndex</a> = <a href="#1061003" title="=&gt; List[scala.io.Source]">inpStack</a>.<a href="../../collection/LinearSeqOptimized.scala.html#71030" title="=&gt; Int">length</a>

      <a href="#1061053" title="()Unit">extSubset</a><span class="delimiter">(</span><span class="delimiter">)</span>
      <a href="#1061066" title="()Unit">pop</a><span class="delimiter">(</span><span class="delimiter">)</span>
      <a href="#1061009" title="(x$1: Int)Unit">extIndex</a> = -<span title="Int(-1)" class="int">1</span>
    <span class="delimiter">}</span>

    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><span title="Char(\'[\')" class="char">'['</span> <a href="../../Char.scala.html#54902" title="(x: Char)Boolean">==</a> <a href="#1061015" title="=&gt; Char">ch</a><span class="delimiter">)</span> <span class="delimiter">{</span> <span class="comment">// internal subset</span>
      <a href="#1061038" title="=&gt; Char">nextch</a>
      <span class="comment">/* TODO */</span>
      <a href="#1061056" title="()Unit">intSubset</a><span class="delimiter">(</span><span class="delimiter">)</span>
      <span class="comment">// TODO: do the DTD parsing?? ?!?!?!?!!</span>
      <a href="MarkupParserCommon.scala.html#566202" title="(that: Char)Unit">xToken</a><span class="delimiter">(</span><span title="Char(\']\')" class="char">']'</span><span class="delimiter">)</span>
      <a href="MarkupParserCommon.scala.html#566205" title="()Unit">xSpaceOpt</a>
    <span class="delimiter">}</span>
    <a href="MarkupParserCommon.scala.html#566202" title="(that: Char)Unit">xToken</a><span class="delimiter">(</span><span title="Char(\'&gt;\')" class="char">'&gt;'</span><span class="delimiter">)</span>
    <a href="#47057" title="MarkupParser.this.type" class="keyword">this</a>.<a href="#1061020" title="(x$1: scala.xml.dtd.DTD)Unit">dtd</a> = <a href="#1063222" title="scala.xml.dtd.DTD" class="keyword">new</a> <a href="../dtd/DTD.scala.html#46589" title="anonymous class $anon extends scala.xml.dtd.DTD" id="1063222">DTD</a> <span class="delimiter">{</span>
      <span class="comment">/*override var*/</span> <a href="../dtd/DTD.scala.html#1035391" title="(x$1: scala.xml.dtd.ExternalID)Unit">externalID</a> = <a href="#1063173" title="scala.xml.dtd.ExternalID">extID</a>
      <span class="comment">/*override val */</span><a href="../dtd/DTD.scala.html#1035394" title="(x$1: List[scala.xml.dtd.Decl])Unit">decls</a>      = <a href="#1061000" title="=&gt; scala.xml.parsing.MarkupHandler">handle</a>.<a href="MarkupHandler.scala.html#1057510" title="=&gt; List[scala.xml.dtd.Decl]">decls</a>.<a href="../../collection/immutable/List.scala.html#49171" title="=&gt; List[scala.xml.dtd.Decl]">reverse</a>
    <span class="delimiter">}</span>
    <span class="comment">//this.dtd.initializeEntities();</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#1061023" title="=&gt; scala.xml.Document">doc</a> <span title="(x$1: AnyRef)Boolean">ne</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span>
      <a href="#1061023" title="=&gt; scala.xml.Document">doc</a>.<a href="../Document.scala.html#1035365" title="(x$1: scala.xml.dtd.DTD)Unit">dtd</a> = <a href="#47057" title="MarkupParser.this.type" class="keyword">this</a>.<a href="#1061020" title="=&gt; scala.xml.dtd.DTD">dtd</a>

    <a href="#1061000" title="=&gt; scala.xml.parsing.MarkupHandler">handle</a>.<a href="MarkupHandler.scala.html#1057518" title="(n: String)Unit">endDTD</a><span class="delimiter">(</span><a href="#1063174" title="String">n</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(pscope: scala.xml.NamespaceBinding)scala.xml.NodeSeq" id="1061048">element</a><span class="delimiter">(</span><a title="scala.xml.NamespaceBinding" id="1063228">pscope</a>: <a href="../NamespaceBinding.scala.html#46320" title="scala.xml.NamespaceBinding">NamespaceBinding</a><span class="delimiter">)</span>: <a href="../NodeSeq.scala.html#46257" title="scala.xml.NodeSeq">NodeSeq</a> = <span class="delimiter">{</span>
    <a href="MarkupParserCommon.scala.html#566202" title="(that: Char)Unit">xToken</a><span class="delimiter">(</span><span title="Char(\'&lt;\')" class="char">'&lt;'</span><span class="delimiter">)</span>
    <a href="#1061049" title="(pscope: scala.xml.NamespaceBinding)scala.xml.NodeSeq">element1</a><span class="delimiter">(</span><a href="#1063228" title="scala.xml.NamespaceBinding">pscope</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/** '&amp;lt;' element ::= xmlTag1 '&amp;gt;'  { xmlExpr | '{' simpleExpr '}' } ETag
   *               | xmlTag1 '/' '&amp;gt;'
   */</span>
  <span class="keyword">def</span> <a title="(pscope: scala.xml.NamespaceBinding)scala.xml.NodeSeq" id="1061049">element1</a><span class="delimiter">(</span><a title="scala.xml.NamespaceBinding" id="1063085">pscope</a>: <a href="../NamespaceBinding.scala.html#46320" title="scala.xml.NamespaceBinding">NamespaceBinding</a><span class="delimiter">)</span>: <a href="../NodeSeq.scala.html#46257" title="scala.xml.NodeSeq">NodeSeq</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Int" id="1063236">pos</a> = <a href="#47057" title="MarkupParser.this.type" class="keyword">this</a>.<a href="#1061006" title="=&gt; Int">pos</a>
    <span class="keyword">val</span> <a href="../../Tuple3.scala.html#53296" title="(String, scala.xml.MetaData, scala.xml.NamespaceBinding)" class="delimiter">(</a><a href="../../Tuple3.scala.html#53312" title="String" id="1063238">qname</a>, <span class="delimiter">(</span><a href="../../Tuple3.scala.html#53314" title="scala.xml.MetaData" id="1063239">aMap</a>, <a href="../../Tuple3.scala.html#53316" title="scala.xml.NamespaceBinding" id="1063240">scope</a><span class="delimiter">)</span><span class="delimiter">)</span> = <a href="MarkupParserCommon.scala.html#566175" title="(pscope: MarkupParser.this.NamespaceType)(String, (scala.xml.MetaData, scala.xml.NamespaceBinding))">xTag</a><a href="../../Tuple2.scala.html#1520" title="(String, (scala.xml.MetaData, scala.xml.NamespaceBinding)) @unchecked" class="delimiter">(</a><a href="#1063085" title="scala.xml.NamespaceBinding">pscope</a><span class="delimiter">)</span>
    <span class="keyword">val</span> <a href="../../Tuple2.scala.html#53390" title="(String, String)" class="delimiter">(</a><a href="../../Tuple2.scala.html#53402" title="String" id="1063242">pre</a>, <a href="../../Tuple2.scala.html#53404" title="String" id="1063243">local</a><span class="delimiter">)</span> = <a href="../Utility.scala.html#46093" title="object scala.xml.Utility">Utility</a>.<a href="../Utility.scala.html#566085" title="(name: String)Option[String]">prefix</a><span class="delimiter">(</span><a href="#1063238" title="String">qname</a><span class="delimiter">)</span> <span title="(String, String)" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <span title="(String, String)">Some</span><span class="delimiter">(</span><a title="String" id="1063264">p</a><span class="delimiter">)</span> =&gt; <a href="../../Tuple2.scala.html#53390" title="(_1: String, _2: String)(String, String)" class="delimiter">(</a><a href="#1063264" title="String">p</a>, <a href="../../Predef.scala.html#9682" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">qname</a> <a href="../../collection/IndexedSeqOptimized.scala.html#55968" title="(n: Int)String">drop</a> <a href="#1063264" title="String">p</a>.<span title="()Int">length</span><a href="../../Int.scala.html#54804" title="(x: Int)Int">+</a><span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="(Null, String)">_</span>       =&gt; <a href="../../Tuple2.scala.html#53390" title="(_1: Null, _2: String)(Null, String)" class="delimiter">(</a><span title="Null(null)" class="keyword">null</span>, <a href="#1063238" title="String">qname</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
    <span class="keyword">val</span> <a title="scala.xml.NodeSeq" id="1063244">ts</a> = <span class="delimiter">{</span>
      <span title="scala.xml.NodeSeq" class="keyword">if</span> <span class="delimiter">(</span><a href="#1061015" title="=&gt; Char">ch</a> <a href="../../Char.scala.html#54902" title="(x: Char)Boolean">==</a> <span title="Char(\'/\')" class="char">'/'</span><span class="delimiter">)</span> <span class="delimiter">{</span>  <span class="comment">// empty element</span>
        <a href="MarkupParserCommon.scala.html#566203" title="(that: Seq[Char])Unit">xToken</a><span class="delimiter">(</span><a href="../../LowPriorityImplicits.scala.html#9503" title="implicit scala.LowPriorityImplicits.wrapString : (s: String)scala.collection.immutable.WrappedString" class="string">&quot;/&gt;&quot;</a><span class="delimiter">)</span>
        <a href="#1061000" title="=&gt; scala.xml.parsing.MarkupHandler">handle</a>.<a href="MarkupHandler.scala.html#1057519" title="(pos: Int, pre: String, label: String, attrs: scala.xml.MetaData, scope: scala.xml.NamespaceBinding)Unit">elemStart</a><span class="delimiter">(</span><a href="#1063236" title="Int">pos</a>, <a href="#1063242" title="String">pre</a>, <a href="#1063243" title="String">local</a>, <a href="#1063239" title="scala.xml.MetaData">aMap</a>, <a href="#1063240" title="scala.xml.NamespaceBinding">scope</a><span class="delimiter">)</span>
        <a href="../NodeSeq.scala.html#46258" title="object scala.xml.NodeSeq">NodeSeq</a>.<a href="../NodeSeq.scala.html#462419" title="=&gt; scala.xml.NodeSeq">Empty</a>
      <span class="delimiter">}</span>
      <span class="keyword">else</span> <span class="delimiter">{</span>           <span class="comment">// element with content</span>
        <a href="MarkupParserCommon.scala.html#566202" title="(that: Char)Unit">xToken</a><span class="delimiter">(</span><span title="Char(\'&gt;\')" class="char">'&gt;'</span><span class="delimiter">)</span>
        <a href="#1061000" title="=&gt; scala.xml.parsing.MarkupHandler">handle</a>.<a href="MarkupHandler.scala.html#1057519" title="(pos: Int, pre: String, label: String, attrs: scala.xml.MetaData, scope: scala.xml.NamespaceBinding)Unit">elemStart</a><span class="delimiter">(</span><a href="#1063236" title="Int">pos</a>, <a href="#1063242" title="String">pre</a>, <a href="#1063243" title="String">local</a>, <a href="#1063239" title="scala.xml.MetaData">aMap</a>, <a href="#1063240" title="scala.xml.NamespaceBinding">scope</a><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="scala.xml.NodeSeq" id="1063413">tmp</a> = <a href="#1061045" title="(pscope: scala.xml.NamespaceBinding)scala.xml.NodeSeq">content</a><span class="delimiter">(</span><a href="#1063240" title="scala.xml.NamespaceBinding">scope</a><span class="delimiter">)</span>
        <a href="MarkupParserCommon.scala.html#566180" title="(startName: String)Unit">xEndTag</a><span class="delimiter">(</span><a href="#1063238" title="String">qname</a><span class="delimiter">)</span>
        <a href="#1063413" title="scala.xml.NodeSeq">tmp</a>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
    <span class="keyword">val</span> <a title="scala.xml.NodeSeq" id="1063245">res</a> = <a href="#1061000" title="=&gt; scala.xml.parsing.MarkupHandler">handle</a>.<a href="MarkupHandler.scala.html#1057521" title="(pos: Int, pre: String, label: String, attrs: scala.xml.MetaData, scope: scala.xml.NamespaceBinding, args: scala.xml.NodeSeq)scala.xml.NodeSeq">elem</a><span class="delimiter">(</span><a href="#1063236" title="Int">pos</a>, <a href="#1063242" title="String">pre</a>, <a href="#1063243" title="String">local</a>, <a href="#1063239" title="scala.xml.MetaData">aMap</a>, <a href="#1063240" title="scala.xml.NamespaceBinding">scope</a>, <a href="#1063244" title="scala.xml.NodeSeq">ts</a><span class="delimiter">)</span>
    <a href="#1061000" title="=&gt; scala.xml.parsing.MarkupHandler">handle</a>.<a href="MarkupHandler.scala.html#1057520" title="(pos: Int, pre: String, label: String)Unit">elemEnd</a><span class="delimiter">(</span><a href="#1063236" title="Int">pos</a>, <a href="#1063242" title="String">pre</a>, <a href="#1063243" title="String">local</a><span class="delimiter">)</span>
    <a href="#1063245" title="scala.xml.NodeSeq">res</a>
  <span class="delimiter">}</span>

  <span class="comment">/** parse character data.
   *   precondition: xEmbeddedBlock == false (we are not in a scala block)
   */</span>
  <span class="keyword">def</span> <a title="=&gt; String" id="1061050">xText</a>: <span title="String">String</span> = <span class="delimiter">{</span>
    <span class="keyword">var</span> <a title="Boolean" id="1063420">exit</a> = <span title="Boolean(false)" class="keyword">false</span>;
    <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><a href="../../Boolean.scala.html#55576" title="=&gt; Boolean">!</a> <a href="#1063420" title="Boolean">exit</a><span class="delimiter">)</span> <a href="#1063422" title="()Unit" class="delimiter">{</a>
      <a href="#1061033" title="(c: Char)StringBuilder">putChar</a><span class="delimiter">(</span><a href="#1061015" title="=&gt; Char">ch</a><span class="delimiter">)</span>;
      <span class="keyword">val</span> <a title="Int" id="1063423">opos</a> = <a href="#1061006" title="=&gt; Int">pos</a>;
      <a href="#1061038" title="=&gt; Char">nextch</a>;

      <a href="#1063420" title="Boolean">exit</a> = <a href="#1061026" title="=&gt; Boolean">eof</a> <a href="../../Boolean.scala.html#55579" title="(x: Boolean)Boolean">||</a> <span class="delimiter">(</span> <a href="#1061015" title="=&gt; Char">ch</a> <a href="../../Char.scala.html#54902" title="(x: Char)Boolean">==</a> <span title="Char(\'&lt;\')" class="char">'&lt;'</span> <span class="delimiter">)</span> <a href="../../Boolean.scala.html#55579" title="(x: Boolean)Boolean">||</a> <span class="delimiter">(</span> <a href="#1061015" title="=&gt; Char">ch</a> <a href="../../Char.scala.html#54902" title="(x: Char)Boolean">==</a> <span title="Char(\'&amp;\')" class="char">'&amp;'</span> <span class="delimiter">)</span>
    <span class="delimiter">}</span>
    <span class="keyword">val</span> <a title="java.lang.String" id="1063421">str</a> = <a href="#1061017" title="=&gt; StringBuilder">cbuf</a>.<a href="../../collection/mutable/StringBuilder.scala.html#60572" title="()java.lang.String">toString</a><span class="delimiter">(</span><span class="delimiter">)</span>;
    <a href="#1061017" title="=&gt; StringBuilder">cbuf</a>.<a href="../../collection/mutable/StringBuilder.scala.html#60514" title="(n: Int)Unit">length</a> = <span title="Int(0)" class="int">0</span>;
    <a href="#1063421" title="java.lang.String">str</a>
  <span class="delimiter">}</span>

  <span class="comment">/** attribute value, terminated by either ' or &quot;. value may not contain &amp;lt;.
   *       AttValue     ::= `'` { _ } `'`
   *                      | `&quot;` { _ } `&quot;`
   */</span>
  <span class="keyword">def</span> <a title="()String" id="1061051">systemLiteral</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="String">String</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Char" id="1063434">endch</a> = <a href="#1061015" title="=&gt; Char">ch</a>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#1061015" title="=&gt; Char">ch</a> <a href="../../Char.scala.html#54909" title="(x: Char)Boolean">!=</a> <span title="Char(\'\\\'\')" class="char">'\''</span> <a href="../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#1061015" title="=&gt; Char">ch</a> <a href="../../Char.scala.html#54909" title="(x: Char)Boolean">!=</a> <span title="Char(\'\\\&quot;\')" class="char">'&quot;'</span><span class="delimiter">)</span>
      <a href="#1061062" title="(str: String)Unit">reportSyntaxError</a><span class="delimiter">(</span><span title="java.lang.String(&quot;quote \' or \&quot; expected&quot;)" class="string">&quot;quote ' or \&quot; expected&quot;</span><span class="delimiter">)</span>;
    <a href="#1061038" title="=&gt; Char">nextch</a>
    <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><a href="#1061015" title="=&gt; Char">ch</a> <a href="../../Char.scala.html#54909" title="(x: Char)Boolean">!=</a> <a href="#1063434" title="Char">endch</a> <a href="../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../Boolean.scala.html#55576" title="=&gt; Boolean">!</a><a href="#1061026" title="=&gt; Boolean">eof</a><span class="delimiter">)</span> <a href="#1063436" title="()Unit" class="delimiter">{</a>
      <a href="#1061033" title="(c: Char)StringBuilder">putChar</a><span class="delimiter">(</span><a href="#1061015" title="=&gt; Char">ch</a><span class="delimiter">)</span>
      <a href="#1061038" title="=&gt; Char">nextch</a>
    <span class="delimiter">}</span>
    <a href="#1061038" title="=&gt; Char">nextch</a>
    <span class="keyword">val</span> <a title="java.lang.String" id="1063435">str</a> = <a href="#1061017" title="=&gt; StringBuilder">cbuf</a>.<a href="../../collection/mutable/StringBuilder.scala.html#60572" title="()java.lang.String">toString</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <a href="#1061017" title="=&gt; StringBuilder">cbuf</a>.<a href="../../collection/mutable/StringBuilder.scala.html#60514" title="(n: Int)Unit">length</a> = <span title="Int(0)" class="int">0</span>
    <a href="#1063435" title="java.lang.String">str</a>
  <span class="delimiter">}</span>

  <span class="comment">/* [12]       PubidLiteral ::=        '&quot;' PubidChar* '&quot;' | &quot;'&quot; (PubidChar - &quot;'&quot;)* &quot;'&quot; */</span>
  <span class="keyword">def</span> <a title="()String" id="1061052">pubidLiteral</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="String">String</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Char" id="1063456">endch</a> = <a href="#1061015" title="=&gt; Char">ch</a>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#1061015" title="=&gt; Char">ch</a><a href="../../Char.scala.html#54909" title="(x: Char)Boolean">!=</a><span title="Char(\'\\\'\')" class="char">'\''</span> <a href="../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#1061015" title="=&gt; Char">ch</a> <a href="../../Char.scala.html#54909" title="(x: Char)Boolean">!=</a> <span title="Char(\'\\\&quot;\')" class="char">'&quot;'</span><span class="delimiter">)</span>
      <a href="#1061062" title="(str: String)Unit">reportSyntaxError</a><span class="delimiter">(</span><span title="java.lang.String(&quot;quote \' or \&quot; expected&quot;)" class="string">&quot;quote ' or \&quot; expected&quot;</span><span class="delimiter">)</span>;
    <a href="#1061038" title="=&gt; Char">nextch</a>
    <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><a href="#1061015" title="=&gt; Char">ch</a> <a href="../../Char.scala.html#54909" title="(x: Char)Boolean">!=</a> <a href="#1063456" title="Char">endch</a> <a href="../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../Boolean.scala.html#55576" title="=&gt; Boolean">!</a><a href="#1061026" title="=&gt; Boolean">eof</a><span class="delimiter">)</span> <a href="#1063458" title="()Unit" class="delimiter">{</a>
      <a href="#1061033" title="(c: Char)StringBuilder">putChar</a><span class="delimiter">(</span><a href="#1061015" title="=&gt; Char">ch</a><span class="delimiter">)</span>
      <span class="comment">//Console.println(&quot;hello '&quot;+ch+&quot;'&quot;+isPubIDChar(ch));</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../Boolean.scala.html#55576" title="=&gt; Boolean">!</a><a href="TokenTests.scala.html#566102" title="(ch: Char)Boolean">isPubIDChar</a><span class="delimiter">(</span><a href="#1061015" title="=&gt; Char">ch</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <a href="#1061062" title="(str: String)Unit">reportSyntaxError</a><span class="delimiter">(</span><span title="java.lang.String(&quot;char \'&quot;)" class="string">&quot;char '&quot;</span><span title="(x$1: Any)java.lang.String">+</span><a href="#1061015" title="=&gt; Char">ch</a><span title="(x$1: Any)java.lang.String">+</span><span title="java.lang.String(&quot;\' is not allowed in public id&quot;)" class="string">&quot;' is not allowed in public id&quot;</span><span class="delimiter">)</span>;
      <a href="#1061038" title="=&gt; Char">nextch</a>
    <span class="delimiter">}</span>
    <a href="#1061038" title="=&gt; Char">nextch</a>
    <span class="keyword">val</span> <a title="java.lang.String" id="1063457">str</a> = <a href="#1061017" title="=&gt; StringBuilder">cbuf</a>.<a href="../../collection/mutable/StringBuilder.scala.html#60572" title="()java.lang.String">toString</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <a href="#1061017" title="=&gt; StringBuilder">cbuf</a>.<a href="../../collection/mutable/StringBuilder.scala.html#60514" title="(n: Int)Unit">length</a> = <span title="Int(0)" class="int">0</span>
    <a href="#1063457" title="java.lang.String">str</a>
  <span class="delimiter">}</span>

  <span class="comment">//</span>
  <span class="comment">//  dtd parsing</span>
  <span class="comment">//</span>

  <span class="keyword">def</span> <a title="()Unit" id="1061053">extSubset</a><span class="delimiter">(</span><span class="delimiter">)</span>: <a href="../../Unit.scala.html#461" title="Unit">Unit</a> = <span class="delimiter">{</span>
    <span class="keyword">var</span> <a title="(Option[String], Option[String])" id="1063482">textdecl</a>:<a href="../../Tuple2.scala.html#1520" title="(Option[String], Option[String])">Tuple2</a><span class="delimiter">[</span>Option<span class="delimiter">[</span>String<span class="delimiter">]</span>,Option<span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">]</span> = <span title="Null(null)" class="keyword">null</span>;
    <span title="Any" class="keyword">if</span> <span class="delimiter">(</span><a href="#1061015" title="=&gt; Char">ch</a><a href="../../Char.scala.html#54902" title="(x: Char)Boolean">==</a><span title="Char(\'&lt;\')" class="char">'&lt;'</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#1061038" title="=&gt; Char">nextch</a>
      <span title="Any" class="keyword">if</span> <span class="delimiter">(</span><a href="#1061015" title="=&gt; Char">ch</a><a href="../../Char.scala.html#54902" title="(x: Char)Boolean">==</a><span title="Char(\'?\')" class="char">'?'</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#1061038" title="=&gt; Char">nextch</a>
        <a href="#1063482" title="(Option[String], Option[String])">textdecl</a> = <a href="#1061031" title="()(Option[String], Option[String])">textDecl</a><span class="delimiter">(</span><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">else</span>
        <a href="#1061054" title="()Any">markupDecl1</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
    <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><a href="../../Boolean.scala.html#55576" title="=&gt; Boolean">!</a><a href="#1061026" title="=&gt; Boolean">eof</a><span class="delimiter">)</span>
      <a href="#1061055" title="()Unit">markupDecl</a><a href="#1063743" title="()Unit" class="delimiter">(</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="()Any" id="1061054">markupDecl1</a><span class="delimiter">(</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="()Char" id="1063495">doInclude</a><span class="delimiter">(</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
      <a href="MarkupParserCommon.scala.html#566202" title="(that: Char)Unit">xToken</a><span class="delimiter">(</span><span title="Char(\'[\')" class="char">'['</span><span class="delimiter">)</span>; <span title="Unit" class="keyword">while</span><span class="delimiter">(</span><span title="Char(\']\')" class="char">']'</span> <a href="../../Char.scala.html#54909" title="(x: Char)Boolean">!=</a> <a href="#1061015" title="=&gt; Char">ch</a><span class="delimiter">)</span> <a href="#1061055" title="()Unit">markupDecl</a><a href="#1063497" title="()Unit" class="delimiter">(</a><span class="delimiter">)</span>; <a href="#1061038" title="=&gt; Char">nextch</a> <span class="comment">// ']'</span>
    <span class="delimiter">}</span>
    <span class="keyword">def</span> <a title="()Char" id="1063496">doIgnore</a><span class="delimiter">(</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
      <a href="MarkupParserCommon.scala.html#566202" title="(that: Char)Unit">xToken</a><span class="delimiter">(</span><span title="Char(\'[\')" class="char">'['</span><span class="delimiter">)</span>; <span title="Unit" class="keyword">while</span><span class="delimiter">(</span><span title="Char(\']\')" class="char">']'</span> <a href="../../Char.scala.html#54909" title="(x: Char)Boolean">!=</a> <a href="#1061015" title="=&gt; Char">ch</a><span class="delimiter">)</span> <a href="#1061038" title="=&gt; Char">nextch</a>; <a href="#1061038" title="=&gt; Char">nextch</a>; <span class="comment">// ']'</span>
    <span class="delimiter">}</span>
    <span title="Any" class="keyword">if</span> <span class="delimiter">(</span><span title="Char(\'?\')" class="char">'?'</span> <a href="../../Char.scala.html#54902" title="(x: Char)Boolean">==</a> <a href="#1061015" title="=&gt; Char">ch</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#1061038" title="=&gt; Char">nextch</a>
      <a href="MarkupParserCommon.scala.html#566176" title="=&gt; MarkupParser.this.ElementType">xProcInstr</a> <span class="comment">// simply ignore processing instructions!</span>
    <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
      <a href="MarkupParserCommon.scala.html#566202" title="(that: Char)Unit">xToken</a><span class="delimiter">(</span><span title="Char(\'!\')" class="char">'!'</span><span class="delimiter">)</span>
      <a href="#1061015" title="=&gt; Char">ch</a> <span title="Any" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <span title="scala.xml.NodeSeq" class="char">'-'</span> =&gt;
          <a href="#1061042" title="=&gt; scala.xml.NodeSeq">xComment</a> <span class="comment">// ignore comments</span>

        <span class="keyword">case</span> <span title="Unit" class="char">'E'</span> =&gt;
          <a href="#1061038" title="=&gt; Char">nextch</a>
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><span title="Char(\'L\')" class="char">'L'</span> <a href="../../Char.scala.html#54902" title="(x: Char)Boolean">==</a> <a href="#1061015" title="=&gt; Char">ch</a><span class="delimiter">)</span> <span class="delimiter">{</span>
            <a href="#1061038" title="=&gt; Char">nextch</a>
            <a href="#1061057" title="()Unit">elementDecl</a><span class="delimiter">(</span><span class="delimiter">)</span>
          <span class="delimiter">}</span> <span class="keyword">else</span>
            <a href="#1061059" title="()Unit">entityDecl</a><span class="delimiter">(</span><span class="delimiter">)</span>

        <span class="keyword">case</span> <span title="Unit" class="char">'A'</span> =&gt;
          <a href="#1061038" title="=&gt; Char">nextch</a>
          <a href="#1061058" title="()Unit">attrDecl</a><span class="delimiter">(</span><span class="delimiter">)</span>

        <span class="keyword">case</span> <span title="Unit" class="char">'N'</span> =&gt;
          <a href="#1061038" title="=&gt; Char">nextch</a>
          <a href="#1061060" title="()Unit">notationDecl</a><span class="delimiter">(</span><span class="delimiter">)</span>

        <span class="keyword">case</span> <span title="Unit" class="char">'['</span> <span class="keyword">if</span> <a href="#1061003" title="=&gt; List[scala.io.Source]">inpStack</a>.<a href="../../collection/LinearSeqOptimized.scala.html#71030" title="=&gt; Int">length</a> <a href="../../Int.scala.html#54782" title="(x: Int)Boolean">&gt;=</a> <a href="#1061009" title="=&gt; Int">extIndex</a> =&gt;
          <a href="#1061038" title="=&gt; Char">nextch</a>
          <a href="MarkupParserCommon.scala.html#566205" title="()Unit">xSpaceOpt</a>
          <a href="#1061015" title="=&gt; Char">ch</a> <span title="Char" class="keyword">match</span> <span class="delimiter">{</span>
            <span class="keyword">case</span> <span title="Char" class="char">'%'</span> =&gt;
              <a href="#1061038" title="=&gt; Char">nextch</a>
              <span class="keyword">val</span> <a title="String" id="1063693">ent</a> = <a href="MarkupParserCommon.scala.html#566181" title="=&gt; String">xName</a>
              <a href="MarkupParserCommon.scala.html#566202" title="(that: Char)Unit">xToken</a><span class="delimiter">(</span><span title="Char(\';\')" class="char">';'</span><span class="delimiter">)</span>
              <a href="MarkupParserCommon.scala.html#566205" title="()Unit">xSpaceOpt</a>

              <a href="#1061064" title="(entityName: String)Unit">push</a><span class="delimiter">(</span><a href="#1063693" title="String">ent</a><span class="delimiter">)</span>
              <a href="MarkupParserCommon.scala.html#566205" title="()Unit">xSpaceOpt</a>
              <span class="keyword">val</span> <a title="String" id="1063694">stmt</a> = <a href="MarkupParserCommon.scala.html#566181" title="=&gt; String">xName</a>
              <a href="MarkupParserCommon.scala.html#566205" title="()Unit">xSpaceOpt</a>

              <a href="#1063694" title="String">stmt</a> <span title="Char" class="keyword">match</span> <span class="delimiter">{</span>
                <span class="comment">// parameter entity</span>
                <span class="keyword">case</span> <span title="Char" class="string">&quot;INCLUDE&quot;</span>  =&gt; <a href="#1063495" title="()Char">doInclude</a><span class="delimiter">(</span><span class="delimiter">)</span>
                <span class="keyword">case</span> <span title="Char" class="string">&quot;IGNORE&quot;</span>   =&gt; <a href="#1063496" title="()Char">doIgnore</a><span class="delimiter">(</span><span class="delimiter">)</span>
              <span class="delimiter">}</span>
            <span class="keyword">case</span> <span title="Char" class="char">'I'</span> =&gt;
              <a href="#1061038" title="=&gt; Char">nextch</a>
              <a href="#1061015" title="=&gt; Char">ch</a> <span title="Char" class="keyword">match</span> <span class="delimiter">{</span>
                <span class="keyword">case</span> <span title="Char" class="char">'G'</span> =&gt;
                  <a href="#1061038" title="=&gt; Char">nextch</a>
                  <a href="MarkupParserCommon.scala.html#566203" title="(that: Seq[Char])Unit">xToken</a><span class="delimiter">(</span><a href="../../LowPriorityImplicits.scala.html#9503" title="implicit scala.LowPriorityImplicits.wrapString : (s: String)scala.collection.immutable.WrappedString" class="string">&quot;NORE&quot;</a><span class="delimiter">)</span>
                  <a href="MarkupParserCommon.scala.html#566205" title="()Unit">xSpaceOpt</a>
                  <a href="#1063496" title="()Char">doIgnore</a><span class="delimiter">(</span><span class="delimiter">)</span>
                <span class="keyword">case</span> <span title="Char" class="char">'N'</span> =&gt;
                  <a href="#1061038" title="=&gt; Char">nextch</a>
                  <a href="MarkupParserCommon.scala.html#566203" title="(that: Seq[Char])Unit">xToken</a><span class="delimiter">(</span><a href="../../LowPriorityImplicits.scala.html#9503" title="implicit scala.LowPriorityImplicits.wrapString : (s: String)scala.collection.immutable.WrappedString" class="string">&quot;NCLUDE&quot;</a><span class="delimiter">)</span>
                  <a href="#1063495" title="()Char">doInclude</a><span class="delimiter">(</span><span class="delimiter">)</span>
              <span class="delimiter">}</span>
          <span class="delimiter">}</span>
        <a href="MarkupParserCommon.scala.html#566202" title="(that: Char)Unit">xToken</a><span class="delimiter">(</span><span title="Char(\']\')" class="char">']'</span><span class="delimiter">)</span>
        <a href="MarkupParserCommon.scala.html#566202" title="(that: Char)Unit">xToken</a><span class="delimiter">(</span><span title="Char(\'&gt;\')" class="char">'&gt;'</span><span class="delimiter">)</span>

        <span class="keyword">case</span> <span title="Unit">_</span>  =&gt;
          <a href="#1060996" title="scala.io.Source" id="1063725">curInput</a>.<a href="../../io/Source.scala.html#419416" title="java.io.PrintStream" id="1063728">reportError</a><span class="delimiter">(</span><a href="#1061006" title="Int" id="1063726">pos</a>, <span title="java.lang.String(&quot;unexpected character \'&quot;)" class="string">&quot;unexpected character '&quot;</span><span title="(x$1: Any)java.lang.String">+</span><a href="#1061015" title="=&gt; Char">ch</a><a title="java.lang.String" id="1063727">+</a><span title="java.lang.String(&quot;\', expected some markupdecl&quot;)" class="string">&quot;', expected some markupdecl&quot;</span><span class="delimiter">)</span>
        <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><a href="#1061015" title="=&gt; Char">ch</a><a href="../../Char.scala.html#54909" title="(x: Char)Boolean">!=</a><span title="Char(\'&gt;\')" class="char">'&gt;'</span><span class="delimiter">)</span>
          <a href="#1061038" title="=&gt; Char">nextch</a>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="()Unit" id="1061055">markupDecl</a><span class="delimiter">(</span><span class="delimiter">)</span>: <a href="../../Unit.scala.html#461" title="Unit">Unit</a> = <a href="#1061015" title="=&gt; Char">ch</a> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <span title="Unit" class="char">'%'</span> =&gt;                  <span class="comment">// parameter entity reference</span>
      <a href="#1061038" title="=&gt; Char">nextch</a>
      <span class="keyword">val</span> <a title="String" id="1063744">ent</a> = <a href="MarkupParserCommon.scala.html#566181" title="=&gt; String">xName</a>
      <a href="MarkupParserCommon.scala.html#566202" title="(that: Char)Unit">xToken</a><span class="delimiter">(</span><span title="Char(\';\')" class="char">';'</span><span class="delimiter">)</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../Boolean.scala.html#55576" title="=&gt; Boolean">!</a><a href="MarkupHandler.scala.html#1057508" title="=&gt; Boolean">isValidating</a><span class="delimiter">)</span>
        <a href="#1061000" title="=&gt; scala.xml.parsing.MarkupHandler">handle</a>.<a href="MarkupHandler.scala.html#1057531" title="(name: String)Unit">peReference</a><span class="delimiter">(</span><a href="#1063744" title="String">ent</a><span class="delimiter">)</span>  <span class="comment">//  n-v: just create PE-reference</span>
      <span class="keyword">else</span>
        <a href="#1061064" title="(entityName: String)Unit">push</a><span class="delimiter">(</span><a href="#1063744" title="String">ent</a><span class="delimiter">)</span>                <span class="comment">//    v: parse replacementText</span>

    <span class="comment">//peReference</span>
    <span class="keyword">case</span> <span title="Unit" class="char">'&lt;'</span> =&gt;
      <a href="#1061038" title="=&gt; Char">nextch</a>
      <a href="#1061054" title="()Any">markupDecl1</a><span title="Unit" class="delimiter">(</span><span class="delimiter">)</span>
    <span class="keyword">case</span> <span title="Unit">_</span> <span class="keyword">if</span> <a href="TokenTests.scala.html#566095" title="(ch: Char)Boolean">isSpace</a><span class="delimiter">(</span><a href="#1061015" title="=&gt; Char">ch</a><span class="delimiter">)</span> =&gt;
      <a href="MarkupParserCommon.scala.html#566206" title="()Unit">xSpace</a>
    <span class="keyword">case</span> <span title="Unit">_</span> =&gt;
      <a href="#1061062" title="(str: String)Unit">reportSyntaxError</a><span class="delimiter">(</span><span title="java.lang.String(&quot;markupdecl: unexpected character \'&quot;)" class="string">&quot;markupdecl: unexpected character '&quot;</span><span title="(x$1: Any)java.lang.String">+</span><a href="#1061015" title="=&gt; Char">ch</a><span title="(x$1: Any)java.lang.String">+</span><span title="java.lang.String(&quot;\' #&quot;)" class="string">&quot;' #&quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#1061015" title="=&gt; Char">ch</a>.<a href="../../Char.scala.html#54886" title="=&gt; Int">toInt</a><span class="delimiter">)</span>
      <a href="#1061038" title="=&gt; Char">nextch</a>
  <span class="delimiter">}</span>

  <span class="comment">/**  &quot;rec-xml/#ExtSubset&quot; pe references may not occur within markup declarations
   */</span>
  <span class="keyword">def</span> <a title="()Unit" id="1061056">intSubset</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="comment">//Console.println(&quot;(DEBUG) intSubset()&quot;)</span>
    <a href="MarkupParserCommon.scala.html#566206" title="()Unit">xSpace</a>
    <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><span title="Char(\']\')" class="char">']'</span> <a href="../../Char.scala.html#54909" title="(x: Char)Boolean">!=</a> <a href="#1061015" title="=&gt; Char">ch</a><span class="delimiter">)</span>
      <a href="#1061055" title="()Unit">markupDecl</a><a href="#1063761" title="()Unit" class="delimiter">(</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/** &amp;lt;! element := ELEMENT
   */</span>
  <span class="keyword">def</span> <a title="()Unit" id="1061057">elementDecl</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <a href="MarkupParserCommon.scala.html#566203" title="(that: Seq[Char])Unit">xToken</a><span class="delimiter">(</span><a href="../../LowPriorityImplicits.scala.html#9503" title="implicit scala.LowPriorityImplicits.wrapString : (s: String)scala.collection.immutable.WrappedString" class="string">&quot;EMENT&quot;</a><span class="delimiter">)</span>
    <a href="MarkupParserCommon.scala.html#566206" title="()Unit">xSpace</a>
    <span class="keyword">val</span> <a title="String" id="1063767">n</a> = <a href="MarkupParserCommon.scala.html#566181" title="=&gt; String">xName</a>
    <a href="MarkupParserCommon.scala.html#566206" title="()Unit">xSpace</a>
    <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><span title="Char(\'&gt;\')" class="char">'&gt;'</span> <a href="../../Char.scala.html#54909" title="(x: Char)Boolean">!=</a> <a href="#1061015" title="=&gt; Char">ch</a><span class="delimiter">)</span> <a href="#1063769" title="()Unit" class="delimiter">{</a>
      <span class="comment">//Console.println(&quot;[&quot;+ch+&quot;]&quot;)</span>
      <a href="#1061033" title="(c: Char)StringBuilder">putChar</a><span class="delimiter">(</span><a href="#1061015" title="=&gt; Char">ch</a><span class="delimiter">)</span>
      <a href="#1061038" title="=&gt; Char">nextch</a>
    <span class="delimiter">}</span>
    <span class="comment">//Console.println(&quot;END[&quot;+ch+&quot;]&quot;)</span>
    <a href="#1061038" title="=&gt; Char">nextch</a>
    <span class="keyword">val</span> <a title="java.lang.String" id="1063768">cmstr</a> = <a href="#1061017" title="=&gt; StringBuilder">cbuf</a>.<a href="../../collection/mutable/StringBuilder.scala.html#60572" title="()java.lang.String">toString</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <a href="#1061017" title="=&gt; StringBuilder">cbuf</a>.<a href="../../collection/mutable/StringBuilder.scala.html#60514" title="(n: Int)Unit">length</a> = <span title="Int(0)" class="int">0</span>
    <a href="#1061000" title="=&gt; scala.xml.parsing.MarkupHandler">handle</a>.<a href="MarkupHandler.scala.html#1057526" title="(n: String, cmstr: String)Unit">elemDecl</a><span class="delimiter">(</span><a href="#1063767" title="String">n</a>, <a href="#1063768" title="java.lang.String">cmstr</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/** &amp;lt;! attlist := ATTLIST
   */</span>
  <span class="keyword">def</span> <a title="()Unit" id="1061058">attrDecl</a><span class="delimiter">(</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <a href="MarkupParserCommon.scala.html#566203" title="(that: Seq[Char])Unit">xToken</a><span class="delimiter">(</span><a href="../../LowPriorityImplicits.scala.html#9503" title="implicit scala.LowPriorityImplicits.wrapString : (s: String)scala.collection.immutable.WrappedString" class="string">&quot;TTLIST&quot;</a><span class="delimiter">)</span>
    <a href="MarkupParserCommon.scala.html#566206" title="()Unit">xSpace</a>
    <span class="keyword">val</span> <a title="String" id="1063597">n</a> = <a href="MarkupParserCommon.scala.html#566181" title="=&gt; String">xName</a>
    <a href="MarkupParserCommon.scala.html#566206" title="()Unit">xSpace</a>
    <span class="keyword">var</span> <a title="List[scala.xml.dtd.AttrDecl]" id="1063598">attList</a>: <a href="../../collection/immutable/List.scala.html#14047" title="List[scala.xml.dtd.AttrDecl]">List</a><span class="delimiter">[</span>AttrDecl<span class="delimiter">]</span> = <a href="../../collection/immutable/List.scala.html#13700" title="object Nil">Nil</a>

    <span class="comment">// later: find the elemDecl for n</span>
    <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><span title="Char(\'&gt;\')" class="char">'&gt;'</span> <a href="../../Char.scala.html#54909" title="(x: Char)Boolean">!=</a> <a href="#1061015" title="=&gt; Char">ch</a><span class="delimiter">)</span> <a href="#1063599" title="()Unit" class="delimiter">{</a>
      <span class="keyword">val</span> <a title="String" id="1063611">aname</a> = <a href="MarkupParserCommon.scala.html#566181" title="=&gt; String">xName</a>
      <a href="MarkupParserCommon.scala.html#566206" title="()Unit">xSpace</a>
      <span class="comment">// could be enumeration (foo,bar) parse this later :-/</span>
      <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><span title="Char(\'\\\&quot;\')" class="char">'&quot;'</span> <a href="../../Char.scala.html#54909" title="(x: Char)Boolean">!=</a> <a href="#1061015" title="=&gt; Char">ch</a> <a href="../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a> <span title="Char(\'\\\'\')" class="char">'\''</span> <a href="../../Char.scala.html#54909" title="(x: Char)Boolean">!=</a> <a href="#1061015" title="=&gt; Char">ch</a> <a href="../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a> <span title="Char(\'#\')" class="char">'#'</span> <a href="../../Char.scala.html#54909" title="(x: Char)Boolean">!=</a> <a href="#1061015" title="=&gt; Char">ch</a> <a href="../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a> <span title="Char(\'&lt;\')" class="char">'&lt;'</span> <a href="../../Char.scala.html#54909" title="(x: Char)Boolean">!=</a> <a href="#1061015" title="=&gt; Char">ch</a><span class="delimiter">)</span> <a href="#1063614" title="()Unit" class="delimiter">{</a>
        <span title="Any" class="keyword">if</span> <span class="delimiter">(</span><a href="../../Boolean.scala.html#55576" title="=&gt; Boolean">!</a><a href="TokenTests.scala.html#566095" title="(ch: Char)Boolean">isSpace</a><span class="delimiter">(</span><a href="#1061015" title="=&gt; Char">ch</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <a href="#1061017" title="=&gt; StringBuilder">cbuf</a>.<a href="../../collection/mutable/StringBuilder.scala.html#60543" title="(x: Char)StringBuilder">append</a><span class="delimiter">(</span><a href="#1061015" title="=&gt; Char">ch</a><span class="delimiter">)</span>;
        <a href="#1061038" title="=&gt; Char">nextch</a>;
      <span class="delimiter">}</span>
      <span class="keyword">val</span> <a title="java.lang.String" id="1063612">atpe</a> = <a href="#1061017" title="=&gt; StringBuilder">cbuf</a>.<a href="../../collection/mutable/StringBuilder.scala.html#60572" title="()java.lang.String">toString</a><span class="delimiter">(</span><span class="delimiter">)</span>
      <a href="#1061017" title="=&gt; StringBuilder">cbuf</a>.<a href="../../collection/mutable/StringBuilder.scala.html#60514" title="(n: Int)Unit">length</a> = <span title="Int(0)" class="int">0</span>

      <span class="keyword">val</span> <a title="scala.xml.dtd.DefaultDecl" id="1063613">defdecl</a>: <a href="../dtd/Decl.scala.html#46646" title="scala.xml.dtd.DefaultDecl">DefaultDecl</a> = <a href="#1061015" title="=&gt; Char">ch</a> <span title="scala.xml.dtd.DefaultDecl" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <span title="scala.xml.dtd.DEFAULT" class="char">'\''</span> | <span title="Char(\'\\\&quot;\')" class="char">'&quot;'</span> =&gt;
          <a href="../dtd/Decl.scala.html#1056007" title="(fixed: Boolean, attValue: String)scala.xml.dtd.DEFAULT">DEFAULT</a><span class="delimiter">(</span><span title="Boolean(false)" class="keyword">false</span>, <a href="MarkupParserCommon.scala.html#566178" title="()String">xAttributeValue</a><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>

        <span class="keyword">case</span> <span title="scala.xml.dtd.DefaultDecl" class="char">'#'</span> =&gt;
          <a href="#1061038" title="=&gt; Char">nextch</a>
          <a href="MarkupParserCommon.scala.html#566181" title="=&gt; String">xName</a> <span title="scala.xml.dtd.DefaultDecl" class="keyword">match</span> <span class="delimiter">{</span>
            <span class="keyword">case</span> <span title="scala.xml.dtd.DEFAULT" class="string">&quot;FIXED&quot;</span>    =&gt; <a href="MarkupParserCommon.scala.html#566206" title="()Unit">xSpace</a> ; <a href="../dtd/Decl.scala.html#1056007" title="(fixed: Boolean, attValue: String)scala.xml.dtd.DEFAULT">DEFAULT</a><span class="delimiter">(</span><span title="Boolean(true)" class="keyword">true</span>, <a href="MarkupParserCommon.scala.html#566178" title="()String">xAttributeValue</a><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
            <span class="keyword">case</span> <span title="scala.xml.dtd.IMPLIED.type" class="string">&quot;IMPLIED&quot;</span>  =&gt; <a href="../dtd/Decl.scala.html#46674" title="object scala.xml.dtd.IMPLIED">IMPLIED</a>
            <span class="keyword">case</span> <span title="scala.xml.dtd.REQUIRED.type" class="string">&quot;REQUIRED&quot;</span> =&gt; <a href="../dtd/Decl.scala.html#46821" title="object scala.xml.dtd.REQUIRED">REQUIRED</a>
          <span class="delimiter">}</span>
        <span class="keyword">case</span> <span title="Null(null)">_</span> =&gt;
          <span title="Null(null)" class="keyword">null</span>
      <span class="delimiter">}</span>
      <a href="MarkupParserCommon.scala.html#566205" title="()Unit">xSpaceOpt</a>

      <a href="#1063598" title="List[scala.xml.dtd.AttrDecl]">attList</a> <a href="../../collection/immutable/List.scala.html#49140" title="(x: scala.xml.dtd.AttrDecl)List[scala.xml.dtd.AttrDecl]">::=</a> <a href="../dtd/Decl.scala.html#1055237" title="(name: String, tpe: String, default: scala.xml.dtd.DefaultDecl)scala.xml.dtd.AttrDecl">AttrDecl</a><span class="delimiter">(</span><a href="#1063611" title="String">aname</a>, <a href="#1063612" title="java.lang.String">atpe</a>, <a href="#1063613" title="scala.xml.dtd.DefaultDecl">defdecl</a><span class="delimiter">)</span>
      <a href="#1061017" title="=&gt; StringBuilder">cbuf</a>.<a href="../../collection/mutable/StringBuilder.scala.html#60514" title="(n: Int)Unit">length</a> = <span title="Int(0)" class="int">0</span>
    <span class="delimiter">}</span>
    <a href="#1061038" title="=&gt; Char">nextch</a>
    <a href="#1061000" title="=&gt; scala.xml.parsing.MarkupHandler">handle</a>.<a href="MarkupHandler.scala.html#1057527" title="(name: String, attList: List[scala.xml.dtd.AttrDecl])Unit">attListDecl</a><span class="delimiter">(</span><a href="#1063597" title="String">n</a>, <a href="#1063598" title="List[scala.xml.dtd.AttrDecl]">attList</a>.<a href="../../collection/immutable/List.scala.html#49171" title="=&gt; List[scala.xml.dtd.AttrDecl]">reverse</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/** &amp;lt;! element := ELEMENT
   */</span>
  <span class="keyword">def</span> <a title="()Unit" id="1061059">entityDecl</a><span class="delimiter">(</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span class="comment">//Console.println(&quot;entityDecl()&quot;)</span>
    <span class="keyword">var</span> <a title="Boolean" id="1063541">isParameterEntity</a> = <span title="Boolean(false)" class="keyword">false</span>
    <span class="keyword">var</span> <a title="scala.xml.dtd.EntityDef" id="1063542">entdef</a>: <a href="../dtd/Decl.scala.html#46631" title="scala.xml.dtd.EntityDef">EntityDef</a> = <span title="Null(null)" class="keyword">null</span>
    <a href="MarkupParserCommon.scala.html#566203" title="(that: Seq[Char])Unit">xToken</a><span class="delimiter">(</span><a href="../../LowPriorityImplicits.scala.html#9503" title="implicit scala.LowPriorityImplicits.wrapString : (s: String)scala.collection.immutable.WrappedString" class="string">&quot;NTITY&quot;</a><span class="delimiter">)</span>
    <a href="MarkupParserCommon.scala.html#566206" title="()Unit">xSpace</a>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><span title="Char(\'%\')" class="char">'%'</span> <a href="../../Char.scala.html#54902" title="(x: Char)Boolean">==</a> <a href="#1061015" title="=&gt; Char">ch</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#1061038" title="=&gt; Char">nextch</a>
      <a href="#1063541" title="Boolean">isParameterEntity</a> = <span title="Boolean(true)" class="keyword">true</span>
      <a href="MarkupParserCommon.scala.html#566206" title="()Unit">xSpace</a>
    <span class="delimiter">}</span>
    <span class="keyword">val</span> <a title="String" id="1063543">n</a> = <a href="MarkupParserCommon.scala.html#566181" title="=&gt; String">xName</a>
    <a href="MarkupParserCommon.scala.html#566206" title="()Unit">xSpace</a>
    <a href="#1061015" title="=&gt; Char">ch</a> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <span title="Unit" class="char">'S'</span> | <span title="Char(\'P\')" class="char">'P'</span> =&gt; <span class="comment">//sy</span>
        <span class="keyword">val</span> <a title="scala.xml.dtd.ExternalID" id="1063555">extID</a> = <a href="#1061046" title="()scala.xml.dtd.ExternalID">externalID</a><span class="delimiter">(</span><span class="delimiter">)</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#1063541" title="Boolean">isParameterEntity</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="MarkupParserCommon.scala.html#566205" title="()Unit">xSpaceOpt</a>
          <a href="MarkupParserCommon.scala.html#566202" title="(that: Char)Unit">xToken</a><span class="delimiter">(</span><span title="Char(\'&gt;\')" class="char">'&gt;'</span><span class="delimiter">)</span>
          <a href="#1061000" title="=&gt; scala.xml.parsing.MarkupHandler">handle</a>.<a href="MarkupHandler.scala.html#1057529" title="(name: String, edef: scala.xml.dtd.EntityDef)Unit">parameterEntityDecl</a><span class="delimiter">(</span><a href="#1063543" title="String">n</a>, <a href="../dtd/Decl.scala.html#1055810" title="(extID: scala.xml.dtd.ExternalID)scala.xml.dtd.ExtDef">ExtDef</a><span class="delimiter">(</span><a href="#1063555" title="scala.xml.dtd.ExternalID">extID</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span> <span class="comment">// notation?</span>
          <a href="MarkupParserCommon.scala.html#566206" title="()Unit">xSpace</a>
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><span title="Char(\'&gt;\')" class="char">'&gt;'</span> <a href="../../Char.scala.html#54909" title="(x: Char)Boolean">!=</a> <a href="#1061015" title="=&gt; Char">ch</a><span class="delimiter">)</span> <span class="delimiter">{</span>
            <a href="MarkupParserCommon.scala.html#566203" title="(that: Seq[Char])Unit">xToken</a><span class="delimiter">(</span><a href="../../LowPriorityImplicits.scala.html#9503" title="implicit scala.LowPriorityImplicits.wrapString : (s: String)scala.collection.immutable.WrappedString" class="string">&quot;NDATA&quot;</a><span class="delimiter">)</span>
            <a href="MarkupParserCommon.scala.html#566206" title="()Unit">xSpace</a>
            <span class="keyword">val</span> <a title="String" id="1063569">notat</a> = <a href="MarkupParserCommon.scala.html#566181" title="=&gt; String">xName</a>
            <a href="MarkupParserCommon.scala.html#566205" title="()Unit">xSpaceOpt</a>
            <a href="MarkupParserCommon.scala.html#566202" title="(that: Char)Unit">xToken</a><span class="delimiter">(</span><span title="Char(\'&gt;\')" class="char">'&gt;'</span><span class="delimiter">)</span>
            <a href="#1061000" title="=&gt; scala.xml.parsing.MarkupHandler">handle</a>.<a href="MarkupHandler.scala.html#1057532" title="(name: String, extID: scala.xml.dtd.ExternalID, notat: String)Unit">unparsedEntityDecl</a><span class="delimiter">(</span><a href="#1063543" title="String">n</a>, <a href="#1063555" title="scala.xml.dtd.ExternalID">extID</a>, <a href="#1063569" title="String">notat</a><span class="delimiter">)</span>
          <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
            <a href="#1061038" title="=&gt; Char">nextch</a>
            <a href="#1061000" title="=&gt; scala.xml.parsing.MarkupHandler">handle</a>.<a href="MarkupHandler.scala.html#1057530" title="(name: String, edef: scala.xml.dtd.EntityDef)Unit">parsedEntityDecl</a><span class="delimiter">(</span><a href="#1063543" title="String">n</a>, <a href="../dtd/Decl.scala.html#1055810" title="(extID: scala.xml.dtd.ExternalID)scala.xml.dtd.ExtDef">ExtDef</a><span class="delimiter">(</span><a href="#1063555" title="scala.xml.dtd.ExternalID">extID</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <span class="delimiter">}</span>
        <span class="delimiter">}</span>

      <span class="keyword">case</span> <span title="Unit" class="char">'&quot;'</span> | <span title="Char(\'\\\'\')" class="char">'\''</span> =&gt;
        <span class="keyword">val</span> <a title="String" id="1063584">av</a> = <a href="#1061040" title="()String">xEntityValue</a><span class="delimiter">(</span><span class="delimiter">)</span>
        <a href="MarkupParserCommon.scala.html#566205" title="()Unit">xSpaceOpt</a>
        <a href="MarkupParserCommon.scala.html#566202" title="(that: Char)Unit">xToken</a><span class="delimiter">(</span><span title="Char(\'&gt;\')" class="char">'&gt;'</span><span class="delimiter">)</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#1063541" title="Boolean">isParameterEntity</a><span class="delimiter">)</span>
          <a href="#1061000" title="=&gt; scala.xml.parsing.MarkupHandler">handle</a>.<a href="MarkupHandler.scala.html#1057529" title="(name: String, edef: scala.xml.dtd.EntityDef)Unit">parameterEntityDecl</a><span class="delimiter">(</span><a href="#1063543" title="String">n</a>, <a href="../dtd/Decl.scala.html#1055755" title="(value: String)scala.xml.dtd.IntDef">IntDef</a><span class="delimiter">(</span><a href="#1063584" title="String">av</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="keyword">else</span>
          <a href="#1061000" title="=&gt; scala.xml.parsing.MarkupHandler">handle</a>.<a href="MarkupHandler.scala.html#1057530" title="(name: String, edef: scala.xml.dtd.EntityDef)Unit">parsedEntityDecl</a><span class="delimiter">(</span><a href="#1063543" title="String">n</a>, <a href="../dtd/Decl.scala.html#1055755" title="(value: String)scala.xml.dtd.IntDef">IntDef</a><span class="delimiter">(</span><a href="#1063584" title="String">av</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
    <span title="Unit" class="delimiter">{</span><span class="delimiter">}</span>
  <span class="delimiter">}</span> <span class="comment">// entityDecl</span>

  <span class="comment">/** 'N' notationDecl ::= &quot;OTATION&quot;
   */</span>
  <span class="keyword">def</span> <a title="()Unit" id="1061060">notationDecl</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <a href="MarkupParserCommon.scala.html#566203" title="(that: Seq[Char])Unit">xToken</a><span class="delimiter">(</span><a href="../../LowPriorityImplicits.scala.html#9503" title="implicit scala.LowPriorityImplicits.wrapString : (s: String)scala.collection.immutable.WrappedString" class="string">&quot;OTATION&quot;</a><span class="delimiter">)</span>
    <a href="MarkupParserCommon.scala.html#566206" title="()Unit">xSpace</a>
    <span class="keyword">val</span> <a title="String" id="1063781">notat</a> = <a href="MarkupParserCommon.scala.html#566181" title="=&gt; String">xName</a>
    <a href="MarkupParserCommon.scala.html#566206" title="()Unit">xSpace</a>
    <span class="keyword">val</span> <a title="scala.xml.dtd.ExternalID" id="1063782">extID</a> = <span title="scala.xml.dtd.ExternalID" class="keyword">if</span> <span class="delimiter">(</span><a href="#1061015" title="=&gt; Char">ch</a> <a href="../../Char.scala.html#54902" title="(x: Char)Boolean">==</a> <span title="Char(\'S\')" class="char">'S'</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#1061046" title="()scala.xml.dtd.ExternalID">externalID</a><span class="delimiter">(</span><span class="delimiter">)</span>;
    <span class="delimiter">}</span>
    <span class="keyword">else</span> <span title="scala.xml.dtd.PublicID" class="keyword">if</span> <span class="delimiter">(</span><a href="#1061015" title="=&gt; Char">ch</a> <a href="../../Char.scala.html#54902" title="(x: Char)Boolean">==</a> <span title="Char(\'P\')" class="char">'P'</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="comment">/** PublicID (without system, only used in NOTATION) */</span>
      <a href="#1061038" title="=&gt; Char">nextch</a>
      <a href="MarkupParserCommon.scala.html#566203" title="(that: Seq[Char])Unit">xToken</a><span class="delimiter">(</span><a href="../../LowPriorityImplicits.scala.html#9503" title="implicit scala.LowPriorityImplicits.wrapString : (s: String)scala.collection.immutable.WrappedString" class="string">&quot;UBLIC&quot;</a><span class="delimiter">)</span>
      <a href="MarkupParserCommon.scala.html#566206" title="()Unit">xSpace</a>
      <span class="keyword">val</span> <a title="String" id="1063799">pubID</a> = <a href="#1061052" title="()String">pubidLiteral</a><span class="delimiter">(</span><span class="delimiter">)</span>
      <a href="MarkupParserCommon.scala.html#566205" title="()Unit">xSpaceOpt</a>
      <span class="keyword">val</span> <a title="String" id="1063800">sysID</a> = <span title="String" class="keyword">if</span> <span class="delimiter">(</span><a href="#1061015" title="=&gt; Char">ch</a> <a href="../../Char.scala.html#54909" title="(x: Char)Boolean">!=</a> <span title="Char(\'&gt;\')" class="char">'&gt;'</span><span class="delimiter">)</span>
        <a href="#1061051" title="()String">systemLiteral</a><span class="delimiter">(</span><span class="delimiter">)</span>
      <span class="keyword">else</span>
        <span title="Null(null)" class="keyword">null</span>;
      <span title="scala.xml.dtd.PublicID" class="keyword">new</span> <a href="../dtd/ExternalID.scala.html#46595" title="scala.xml.dtd.PublicID">PublicID</a><span class="delimiter">(</span><a href="#1063799" title="String">pubID</a>, <a href="#1063800" title="String">sysID</a><span class="delimiter">)</span>;
    <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
      <a href="#1061062" title="(str: String)Unit">reportSyntaxError</a><span class="delimiter">(</span><span title="java.lang.String(&quot;PUBLIC or SYSTEM expected&quot;)" class="string">&quot;PUBLIC or SYSTEM expected&quot;</span><span class="delimiter">)</span>;
      sys.<a href="../../sys/package.scala.html#48163" title="(message: String)Nothing">error</a><span class="delimiter">(</span><span title="java.lang.String(&quot;died parsing notationdecl&quot;)" class="string">&quot;died parsing notationdecl&quot;</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
    <a href="MarkupParserCommon.scala.html#566205" title="()Unit">xSpaceOpt</a>
    <a href="MarkupParserCommon.scala.html#566202" title="(that: Char)Unit">xToken</a><span class="delimiter">(</span><span title="Char(\'&gt;\')" class="char">'&gt;'</span><span class="delimiter">)</span>
    <a href="#1061000" title="=&gt; scala.xml.parsing.MarkupHandler">handle</a>.<a href="MarkupHandler.scala.html#1057533" title="(notat: String, extID: scala.xml.dtd.ExternalID)Unit">notationDecl</a><span class="delimiter">(</span><a href="#1063781" title="String">notat</a>, <a href="#1063782" title="scala.xml.dtd.ExternalID">extID</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(pos: Int, str: String)Unit" id="1061061">reportSyntaxError</a><span class="delimiter">(</span><a title="Int" id="1062489">pos</a>: <a href="../../Int.scala.html#386" title="Int">Int</a>, <a title="String" id="1062490">str</a>: <span title="String">String</span><span class="delimiter">)</span>: <a href="../../Unit.scala.html#461" title="Unit">Unit</a> = <a href="#1060996" title="scala.io.Source" id="1063822">curInput</a>.<a href="../../io/Source.scala.html#419416" title="java.io.PrintStream" id="1063825">reportError</a><span class="delimiter">(</span><a href="#1062489" title="Int" id="1063823">pos</a>, <a href="#1062490" title="String" id="1063824">str</a><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="(str: String)Unit" id="1061062">reportSyntaxError</a><span class="delimiter">(</span><a title="String" id="1062493">str</a>: <span title="String">String</span><span class="delimiter">)</span>: <a href="../../Unit.scala.html#461" title="Unit">Unit</a> = <a href="#1061061" title="(pos: Int, str: String)Unit">reportSyntaxError</a><span class="delimiter">(</span><a href="#1061006" title="=&gt; Int">pos</a>, <a href="#1062493" title="String">str</a><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="(pos: Int, str: String)Unit" id="1061063">reportValidationError</a><span class="delimiter">(</span><a title="Int" id="1063830">pos</a>: <a href="../../Int.scala.html#386" title="Int">Int</a>, <a title="String" id="1063831">str</a>: <span title="String">String</span><span class="delimiter">)</span>: <a href="../../Unit.scala.html#461" title="Unit">Unit</a> = <a href="#1061061" title="(pos: Int, str: String)Unit">reportSyntaxError</a><span class="delimiter">(</span><a href="#1063830" title="Int">pos</a>, <a href="#1063831" title="String">str</a><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(entityName: String)Unit" id="1061064">push</a><span class="delimiter">(</span><a title="String" id="1063143">entityName</a>: <span title="String">String</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../Boolean.scala.html#55576" title="=&gt; Boolean">!</a><a href="#1061026" title="=&gt; Boolean">eof</a><span class="delimiter">)</span>
      <a href="#1061003" title="(x$1: List[scala.io.Source])Unit">inpStack</a> = <a href="#1060996" title="=&gt; scala.io.Source">curInput</a> <a href="../../collection/immutable/List.scala.html#49140" title="(x: scala.io.Source)List[scala.io.Source]">::</a> <a href="#1061003" title="=&gt; List[scala.io.Source]">inpStack</a>

    <a href="#1060996" title="(x$1: scala.io.Source)Unit">curInput</a> = <a href="MarkupHandler.scala.html#1057517" title="(entityName: String)scala.io.Source">replacementText</a><span class="delimiter">(</span><a href="#1063143" title="String">entityName</a><span class="delimiter">)</span>
    <a href="#1061038" title="=&gt; Char">nextch</a>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(systemId: String)Unit" id="1061065">pushExternal</a><span class="delimiter">(</span><a title="String" id="1063200">systemId</a>: <span title="String">String</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../Boolean.scala.html#55576" title="=&gt; Boolean">!</a><a href="#1061026" title="=&gt; Boolean">eof</a><span class="delimiter">)</span>
      <a href="#1061003" title="(x$1: List[scala.io.Source])Unit">inpStack</a> = <a href="#1060996" title="=&gt; scala.io.Source">curInput</a> <a href="../../collection/immutable/List.scala.html#49140" title="(x: scala.io.Source)List[scala.io.Source]">::</a> <a href="#1061003" title="=&gt; List[scala.io.Source]">inpStack</a>

    <a href="#1060996" title="(x$1: scala.io.Source)Unit">curInput</a> = <a href="#1060994" title="(systemLiteral: String)scala.io.Source">externalSource</a><span class="delimiter">(</span><a href="#1063200" title="String">systemId</a><span class="delimiter">)</span>
    <a href="#1061038" title="=&gt; Char">nextch</a>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="()Unit" id="1061066">pop</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <a href="#1060996" title="(x$1: scala.io.Source)Unit">curInput</a> = <a href="#1061003" title="=&gt; List[scala.io.Source]">inpStack</a>.<a href="../../collection/IterableLike.scala.html#53870" title="=&gt; scala.io.Source">head</a>
    <a href="#1061003" title="(x$1: List[scala.io.Source])Unit">inpStack</a> = <a href="#1061003" title="=&gt; List[scala.io.Source]">inpStack</a>.<a href="../../collection/TraversableLike.scala.html#49082" title="=&gt; List[scala.io.Source]">tail</a>
    <a href="#1061015" title="(x$1: Char)Unit">ch</a> = <a href="#1060996" title="=&gt; scala.io.Source">curInput</a>.<a href="../../io/Source.scala.html#204288" title="=&gt; Char">ch</a>
    <a href="#1061006" title="(x$1: Int)Unit">pos</a> = <a href="#1060996" title="=&gt; scala.io.Source">curInput</a>.<a href="../../io/Source.scala.html#204289" title="=&gt; Int">pos</a>
    <a href="#1061026" title="(x$1: Boolean)Unit">eof</a> = <span title="Boolean(false)" class="keyword">false</span> <span class="comment">// must be false, because of places where entity refs occur</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>