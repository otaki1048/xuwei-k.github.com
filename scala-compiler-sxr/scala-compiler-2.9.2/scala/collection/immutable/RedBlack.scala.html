<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>scala/collection/immutable/RedBlack.scala</title>
        <script type="text/javascript" src="../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/*                     __                                               *\
**     ________ ___   / /  ___     Scala API                            **
**    / __/ __// _ | / /  / _ |    (c) 2005-2011, LAMP/EPFL             **
**  __\ \/ /__/ __ |/ /__/ __ |    http://scala-lang.org/               **
** /____/\___/_/ |_/____/_/ | |                                         **
**                          |/                                          **
\*                                                                      */</span>



<span class="keyword">package</span> scala.collection
<span class="keyword">package</span> immutable

<span class="comment">/** A base class containing the implementations for `TreeMaps` and `TreeSets`.
 *
 *  @since 2.3
 */</span>
@SerialVersionUID<span class="delimiter">(</span><span class="long">8691885935445612921L</span><span class="delimiter">)</span>
<span class="keyword">abstract</span> <span class="keyword">class</span> <a title="class RedBlack[A] extends java.lang.Object with Serializable with ScalaObject" id="13786">RedBlack</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="14363">A</a><span class="delimiter">]</span> <a href="../../ScalaObject.scala.html#464" title="ScalaObject" class="keyword">extends</a> <a href="../../Serializable.scala.html#902" title="Serializable">Serializable</a> <span class="delimiter">{</span>

  <span class="keyword">def</span> <a title="(x: A, y: A)Boolean" id="206948">isSmaller</a><span class="delimiter">(</span><a title="A" id="206970">x</a>: <a href="#14363" title="A">A</a>, <a title="A" id="206971">y</a>: <a href="#14363" title="A">A</a><span class="delimiter">)</span>: <a href="../../Boolean.scala.html#65" title="Boolean">Boolean</a>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="[B](t: RedBlack.this.Tree[B])RedBlack.this.Tree[B]" id="206949">blacken</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="206951">B</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="RedBlack.this.Tree[B]" id="206973">t</a>: <a href="#206955" title="RedBlack.this.Tree[B]">Tree</a><span class="delimiter">[</span>B<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#206955" title="RedBlack.this.Tree[B]">Tree</a><span class="delimiter">[</span>B<span class="delimiter">]</span> = <a href="#206973" title="RedBlack.this.Tree[B]">t</a> <span title="RedBlack.this.Tree[B]" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <span title="RedBlack.this.BlackTree[B]">RedTree</span><span class="delimiter">(</span><a title="A" id="207098">k</a>, <a title="B" id="207099">v</a>, <a title="RedBlack.this.Tree[B]" id="207100">l</a>, <a title="RedBlack.this.Tree[B]" id="207101">r</a><span class="delimiter">)</span> =&gt; <a href="#207104" title="(key: A, value: B, left: RedBlack.this.Tree[B], right: RedBlack.this.Tree[B])RedBlack.this.BlackTree[B]">BlackTree</a><span class="delimiter">(</span><a href="#207098" title="A">k</a>, <a href="#207099" title="B">v</a>, <a href="#207100" title="RedBlack.this.Tree[B]">l</a>, <a href="#207101" title="RedBlack.this.Tree[B]">r</a><span class="delimiter">)</span>
    <span class="keyword">case</span> <a title="RedBlack.this.Tree[B]" id="207145">t</a> =&gt; <a href="#207145" title="RedBlack.this.Tree[B]">t</a>
  <span class="delimiter">}</span>
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="[B](isBlack: Boolean, k: A, v: B, l: RedBlack.this.Tree[B], r: RedBlack.this.Tree[B])RedBlack.this.NonEmpty[B] with Product" id="206952">mkTree</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="206954">B</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="Boolean" id="207146">isBlack</a>: <a href="../../Boolean.scala.html#65" title="Boolean">Boolean</a>, <a title="A" id="207147">k</a>: <a href="#14363" title="A">A</a>, <a title="B" id="207148">v</a>: <a href="#206954" title="B">B</a>, <a title="RedBlack.this.Tree[B]" id="207149">l</a>: <a href="#206955" title="RedBlack.this.Tree[B]">Tree</a><span class="delimiter">[</span>B<span class="delimiter">]</span>, <a title="RedBlack.this.Tree[B]" id="207150">r</a>: <a href="#206955" title="RedBlack.this.Tree[B]">Tree</a><span class="delimiter">[</span>B<span class="delimiter">]</span><span class="delimiter">)</span> =
    <span title="&lt;none&gt; extends RedBlack.this.NonEmpty[B] with Product" class="keyword">if</span> <span class="delimiter">(</span><a href="#207146" title="Boolean">isBlack</a><span class="delimiter">)</span> <a href="#207104" title="(key: A, value: B, left: RedBlack.this.Tree[B], right: RedBlack.this.Tree[B])RedBlack.this.BlackTree[B]">BlackTree</a><span class="delimiter">(</span><a href="#207147" title="A">k</a>, <a href="#207148" title="B">v</a>, <a href="#207149" title="RedBlack.this.Tree[B]">l</a>, <a href="#207150" title="RedBlack.this.Tree[B]">r</a><span class="delimiter">)</span> <span class="keyword">else</span> <a href="#207005" title="(key: A, value: B, left: RedBlack.this.Tree[B], right: RedBlack.this.Tree[B])RedBlack.this.RedTree[B]">RedTree</a><span class="delimiter">(</span><a href="#207147" title="A">k</a>, <a href="#207148" title="B">v</a>, <a href="#207149" title="RedBlack.this.Tree[B]">l</a>, <a href="#207150" title="RedBlack.this.Tree[B]">r</a><span class="delimiter">)</span>

  <span class="keyword">abstract</span> <span class="keyword">class</span> <a title="class Tree[+B] extends java.lang.Object with Serializable with ScalaObject" id="206955">Tree</a><span class="delimiter">[</span>+<a title="&gt;: Nothing &lt;: Any" id="206956">B</a><span class="delimiter">]</span> <a href="../../ScalaObject.scala.html#464" title="ScalaObject" class="keyword">extends</a> <a href="../../Serializable.scala.html#902" title="Serializable">Serializable</a> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="=&gt; Boolean" id="206977">isEmpty</a>: <a href="../../Boolean.scala.html#65" title="Boolean">Boolean</a>
    <span class="keyword">def</span> <a title="=&gt; Boolean" id="206978">isBlack</a>: <a href="../../Boolean.scala.html#65" title="Boolean">Boolean</a>
    <span class="keyword">def</span> <a title="(x: A)RedBlack.this.Tree[B]" id="206979">lookup</a><span class="delimiter">(</span><a title="A" id="207294">x</a>: <a href="#14363" title="A">A</a><span class="delimiter">)</span>: <a href="#206955" title="RedBlack.this.Tree[B]">Tree</a><span class="delimiter">[</span>B<span class="delimiter">]</span>
    <span class="keyword">def</span> <a title="[B1 &gt;: B](k: A, v: B1)RedBlack.this.Tree[B1]" id="206980">update</a><span class="delimiter">[</span><a title="&gt;: B &lt;: Any" id="206982">B1</a> &gt;: B<span class="delimiter">]</span><span class="delimiter">(</span><a title="A" id="207338">k</a>: <a href="#14363" title="A">A</a>, <a title="B1" id="207339">v</a>: <a href="#206982" title="B1">B1</a><span class="delimiter">)</span>: <a href="#206955" title="RedBlack.this.Tree[B1]">Tree</a><span class="delimiter">[</span>B1<span class="delimiter">]</span> = <a href="#206949" title="(t: RedBlack.this.Tree[B1])RedBlack.this.Tree[B1]">blacken</a><span class="delimiter">(</span><a href="#206994" title="(k: A, v: B1)RedBlack.this.Tree[B1]">upd</a><span class="delimiter">(</span><a href="#207338" title="A">k</a>, <a href="#207339" title="B1">v</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="keyword">def</span> <a title="(k: A)RedBlack.this.Tree[B]" id="206983">delete</a><span class="delimiter">(</span><a title="A" id="207351">k</a>: <a href="#14363" title="A">A</a><span class="delimiter">)</span>: <a href="#206955" title="RedBlack.this.Tree[B]">Tree</a><span class="delimiter">[</span>B<span class="delimiter">]</span> = <a href="#206949" title="(t: RedBlack.this.Tree[B])RedBlack.this.Tree[B]">blacken</a><span class="delimiter">(</span><a href="#206997" title="(k: A)RedBlack.this.Tree[B]">del</a><span class="delimiter">(</span><a href="#207351" title="A">k</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="keyword">def</span> <a title="(from: Option[A], until: Option[A])RedBlack.this.Tree[B]" id="206984">range</a><span class="delimiter">(</span><a title="Option[A]" id="207356">from</a>: <a href="../../Option.scala.html#560" title="Option[A]">Option</a><span class="delimiter">[</span>A<span class="delimiter">]</span>, <a title="Option[A]" id="207357">until</a>: <a href="../../Option.scala.html#560" title="Option[A]">Option</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#206955" title="RedBlack.this.Tree[B]">Tree</a><span class="delimiter">[</span>B<span class="delimiter">]</span> = <a href="#206949" title="(t: RedBlack.this.Tree[B])RedBlack.this.Tree[B]">blacken</a><span class="delimiter">(</span><a href="#206999" title="(from: Option[A], until: Option[A])RedBlack.this.Tree[B]">rng</a><span class="delimiter">(</span><a href="#207356" title="Option[A]">from</a>, <a href="#207357" title="Option[A]">until</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="keyword">def</span> <a title="[U](f: (A, B) =&gt; U)Unit" id="206985">foreach</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="206987">U</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="(A, B) =&gt; U" id="207282">f</a>: <span class="delimiter">(</span>A, B<span class="delimiter">)</span> =&gt;  U<span class="delimiter">)</span>
    @deprecated<span class="delimiter">(</span><span class="string">&quot;use `foreach' instead&quot;</span>, <span class="string">&quot;2.8.0&quot;</span><span class="delimiter">)</span>
    <span class="keyword">def</span> <a title="[T](input: T)(f: (T, A, B) =&gt; (Boolean, T))(Boolean, T)" id="206988">visit</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="206990">T</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="T" id="207263">input</a>: <a href="#206990" title="T">T</a><span class="delimiter">)</span><span class="delimiter">(</span><a title="(T, A, B) =&gt; (Boolean, T)" id="207264">f</a>: <span class="delimiter">(</span>T, A, B<span class="delimiter">)</span> =&gt; <span class="delimiter">(</span>Boolean, T<span class="delimiter">)</span><span class="delimiter">)</span>: <a href="../../Tuple2.scala.html#1520" title="(Boolean, T)" class="delimiter">(</a>Boolean, T<span class="delimiter">)</span>
    <span class="keyword">def</span> <a title="=&gt; scala.collection.immutable.Stream[(A, B)]" id="206991">toStream</a>: <a href="Stream.scala.html#13249" title="scala.collection.immutable.Stream[(A, B)]">Stream</a><span class="delimiter">[</span><span class="delimiter">(</span>A,B<span class="delimiter">)</span><span class="delimiter">]</span>
    <span class="keyword">def</span> <a title="=&gt; Iterator[(A, B)]" id="206992">iterator</a>: <a href="../Iterator.scala.html#8783" title="Iterator[(A, B)]">Iterator</a><span class="delimiter">[</span><span class="delimiter">(</span>A, B<span class="delimiter">)</span><span class="delimiter">]</span>
    @deprecated<span class="delimiter">(</span><span class="string">&quot;use `iterator' instead&quot;</span>, <span class="string">&quot;2.8.0&quot;</span><span class="delimiter">)</span>
    <span class="keyword">def</span> <a title="=&gt; Iterator[(A, B)]" id="206993">elements</a> = <a href="#206992" title="=&gt; Iterator[(A, B)]">iterator</a>
    <span class="keyword">def</span> <a title="[B1 &gt;: B](k: A, v: B1)RedBlack.this.Tree[B1]" id="206994">upd</a><span class="delimiter">[</span><a title="&gt;: B &lt;: Any" id="206996">B1</a> &gt;: B<span class="delimiter">]</span><span class="delimiter">(</span><a title="A" id="207230">k</a>: <a href="#14363" title="A">A</a>, <a title="B1" id="207231">v</a>: <a href="#206996" title="B1">B1</a><span class="delimiter">)</span>: <a href="#206955" title="RedBlack.this.Tree[B1]">Tree</a><span class="delimiter">[</span>B1<span class="delimiter">]</span>
    <span class="keyword">def</span> <a title="(k: A)RedBlack.this.Tree[B]" id="206997">del</a><span class="delimiter">(</span><a title="A" id="207226">k</a>: <a href="#14363" title="A">A</a><span class="delimiter">)</span>: <a href="#206955" title="RedBlack.this.Tree[B]">Tree</a><span class="delimiter">[</span>B<span class="delimiter">]</span>
    <span class="keyword">def</span> <a title="=&gt; RedBlack.this.NonEmpty[B]" id="206998">smallest</a>: <a href="#206957" title="RedBlack.this.NonEmpty[B]">NonEmpty</a><span class="delimiter">[</span>B<span class="delimiter">]</span>
    <span class="keyword">def</span> <a title="(from: Option[A], until: Option[A])RedBlack.this.Tree[B]" id="206999">rng</a><span class="delimiter">(</span><a title="Option[A]" id="207216">from</a>: <a href="../../Option.scala.html#560" title="Option[A]">Option</a><span class="delimiter">[</span>A<span class="delimiter">]</span>, <a title="Option[A]" id="207217">until</a>: <a href="../../Option.scala.html#560" title="Option[A]">Option</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#206955" title="RedBlack.this.Tree[B]">Tree</a><span class="delimiter">[</span>B<span class="delimiter">]</span>
    <span class="keyword">def</span> <a title="=&gt; A" id="207000">first</a> : <a href="#14363" title="A">A</a>
    <span class="keyword">def</span> <a title="=&gt; A" id="207001">last</a> : <a href="#14363" title="A">A</a>
    <span class="keyword">def</span> <a title="=&gt; Int" id="207002">count</a> : <a href="../../Int.scala.html#386" title="Int">Int</a>
  <span class="delimiter">}</span>
  <span class="keyword">abstract</span> <span class="keyword">class</span> <a title="class NonEmpty[+B] extends RedBlack.this.Tree[B] with Serializable with ScalaObject" id="206957">NonEmpty</a><span class="delimiter">[</span>+<a title="&gt;: Nothing &lt;: Any" id="206958">B</a><span class="delimiter">]</span> <a href="../../ScalaObject.scala.html#464" title="ScalaObject" class="keyword">extends</a> <a href="#206955" title="RedBlack.this.Tree[B]">Tree</a><span class="delimiter">[</span>B<span class="delimiter">]</span> <span class="keyword">with</span> <a href="../../Serializable.scala.html#902" title="Serializable">Serializable</a> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="=&gt; Boolean" id="207009">isEmpty</a> = <span title="Boolean(false)" class="keyword">false</span>
    <span class="keyword">def</span> <a title="=&gt; A" id="207010">key</a>: <a href="#14363" title="A">A</a>
    <span class="keyword">def</span> <a title="=&gt; B" id="207011">value</a>: <a href="#206958" title="B">B</a>
    <span class="keyword">def</span> <a title="=&gt; RedBlack.this.Tree[B]" id="207012">left</a>: <a href="#206955" title="RedBlack.this.Tree[B]">Tree</a><span class="delimiter">[</span>B<span class="delimiter">]</span>
    <span class="keyword">def</span> <a title="=&gt; RedBlack.this.Tree[B]" id="207013">right</a>: <a href="#206955" title="RedBlack.this.Tree[B]">Tree</a><span class="delimiter">[</span>B<span class="delimiter">]</span>
    <span class="keyword">def</span> <a title="(k: A)RedBlack.this.Tree[B]" id="207014">lookup</a><span class="delimiter">(</span><a title="A" id="207296">k</a>: <a href="#14363" title="A">A</a><span class="delimiter">)</span>: <a href="#206955" title="RedBlack.this.Tree[B]">Tree</a><span class="delimiter">[</span>B<span class="delimiter">]</span> =
      <span title="RedBlack.this.Tree[B]" class="keyword">if</span> <span class="delimiter">(</span><a href="#206948" title="(x: A, y: A)Boolean">isSmaller</a><span class="delimiter">(</span><a href="#207296" title="A">k</a>, <a href="#207010" title="=&gt; A">key</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="#207012" title="=&gt; RedBlack.this.Tree[B]">left</a>.<a href="#206979" title="(x: A)RedBlack.this.Tree[B]">lookup</a><span class="delimiter">(</span><a href="#207296" title="A">k</a><span class="delimiter">)</span>
      <span class="keyword">else</span> <span title="RedBlack.this.Tree[B]" class="keyword">if</span> <span class="delimiter">(</span><a href="#206948" title="(x: A, y: A)Boolean">isSmaller</a><span class="delimiter">(</span><a href="#207010" title="=&gt; A">key</a>, <a href="#207296" title="A">k</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="#207013" title="=&gt; RedBlack.this.Tree[B]">right</a>.<a href="#206979" title="(x: A)RedBlack.this.Tree[B]">lookup</a><span class="delimiter">(</span><a href="#207296" title="A">k</a><span class="delimiter">)</span>
      <span class="keyword">else</span> <a href="#206957" title="RedBlack.this.NonEmpty[B]" class="keyword">this</a>
    <span class="keyword">private</span><span class="delimiter">[</span><span class="keyword">this</span><span class="delimiter">]</span> <span class="keyword">def</span> <a title="[B1 &gt;: B](isBlack: Boolean, z: A, zv: B, l: RedBlack.this.Tree[B1], d: RedBlack.this.Tree[B1])RedBlack.this.NonEmpty[B1] with Product" id="207015">balanceLeft</a><span class="delimiter">[</span><a title="&gt;: B &lt;: Any" id="207017">B1</a> &gt;: B<span class="delimiter">]</span><span class="delimiter">(</span><a title="Boolean" id="207366">isBlack</a>: <a href="../../Boolean.scala.html#65" title="Boolean">Boolean</a>, <a title="A" id="207367">z</a>: <a href="#14363" title="A">A</a>, <a title="B" id="207368">zv</a>: <a href="#206958" title="B">B</a>, <a title="RedBlack.this.Tree[B1]" id="207369">l</a>: <a href="#206955" title="RedBlack.this.Tree[B1]">Tree</a><span class="delimiter">[</span>B1<span class="delimiter">]</span>, <a title="RedBlack.this.Tree[B1]" id="207370">d</a>: <a href="#206955" title="RedBlack.this.Tree[B1]">Tree</a><span class="delimiter">[</span>B1<span class="delimiter">]</span><span class="delimiter">)</span><span class="comment">/*: NonEmpty[B1]*/</span> = <a href="#207369" title="RedBlack.this.Tree[B1]">l</a> <span title="&lt;none&gt; extends RedBlack.this.NonEmpty[B1] with Product" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <span title="RedBlack.this.RedTree[B1]">RedTree</span><span class="delimiter">(</span><a title="A" id="207377">y</a>, <a title="B1" id="207378">yv</a>, RedTree<span class="delimiter">(</span><a title="A" id="207383">x</a>, <a title="B1" id="207384">xv</a>, <a title="RedBlack.this.Tree[B1]" id="207385">a</a>, <a title="RedBlack.this.Tree[B1]" id="207386">b</a><span class="delimiter">)</span>, <a title="RedBlack.this.Tree[B1]" id="207387">c</a><span class="delimiter">)</span> =&gt;
        <a href="#207005" title="(key: A, value: B1, left: RedBlack.this.Tree[B1], right: RedBlack.this.Tree[B1])RedBlack.this.RedTree[B1]">RedTree</a><span class="delimiter">(</span><a href="#207377" title="A">y</a>, <a href="#207378" title="B1">yv</a>, <a href="#207104" title="(key: A, value: B1, left: RedBlack.this.Tree[B1], right: RedBlack.this.Tree[B1])RedBlack.this.BlackTree[B1]">BlackTree</a><span class="delimiter">(</span><a href="#207383" title="A">x</a>, <a href="#207384" title="B1">xv</a>, <a href="#207385" title="RedBlack.this.Tree[B1]">a</a>, <a href="#207386" title="RedBlack.this.Tree[B1]">b</a><span class="delimiter">)</span>, <a href="#207104" title="(key: A, value: B1, left: RedBlack.this.Tree[B1], right: RedBlack.this.Tree[B1])RedBlack.this.BlackTree[B1]">BlackTree</a><span class="delimiter">(</span><a href="#207367" title="A">z</a>, <a href="#207368" title="B">zv</a>, <a href="#207387" title="RedBlack.this.Tree[B1]">c</a>, <a href="#207370" title="RedBlack.this.Tree[B1]">d</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="RedBlack.this.RedTree[B1]">RedTree</span><span class="delimiter">(</span><a title="A" id="207419">x</a>, <a title="B1" id="207420">xv</a>, <a title="RedBlack.this.Tree[B1]" id="207421">a</a>, RedTree<span class="delimiter">(</span><a title="A" id="207426">y</a>, <a title="B1" id="207427">yv</a>, <a title="RedBlack.this.Tree[B1]" id="207428">b</a>, <a title="RedBlack.this.Tree[B1]" id="207429">c</a><span class="delimiter">)</span><span class="delimiter">)</span> =&gt;
        <a href="#207005" title="(key: A, value: B1, left: RedBlack.this.Tree[B1], right: RedBlack.this.Tree[B1])RedBlack.this.RedTree[B1]">RedTree</a><span class="delimiter">(</span><a href="#207426" title="A">y</a>, <a href="#207427" title="B1">yv</a>, <a href="#207104" title="(key: A, value: B1, left: RedBlack.this.Tree[B1], right: RedBlack.this.Tree[B1])RedBlack.this.BlackTree[B1]">BlackTree</a><span class="delimiter">(</span><a href="#207419" title="A">x</a>, <a href="#207420" title="B1">xv</a>, <a href="#207421" title="RedBlack.this.Tree[B1]">a</a>, <a href="#207428" title="RedBlack.this.Tree[B1]">b</a><span class="delimiter">)</span>, <a href="#207104" title="(key: A, value: B1, left: RedBlack.this.Tree[B1], right: RedBlack.this.Tree[B1])RedBlack.this.BlackTree[B1]">BlackTree</a><span class="delimiter">(</span><a href="#207367" title="A">z</a>, <a href="#207368" title="B">zv</a>, <a href="#207429" title="RedBlack.this.Tree[B1]">c</a>, <a href="#207370" title="RedBlack.this.Tree[B1]">d</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="&lt;none&gt; extends RedBlack.this.NonEmpty[B1] with Product">_</span> =&gt;
        <a href="#206952" title="(isBlack: Boolean, k: A, v: B1, l: RedBlack.this.Tree[B1], r: RedBlack.this.Tree[B1])RedBlack.this.NonEmpty[B1] with Product">mkTree</a><span class="delimiter">(</span><a href="#207366" title="Boolean">isBlack</a>, <a href="#207367" title="A">z</a>, <a href="#207368" title="B">zv</a>, <a href="#207369" title="RedBlack.this.Tree[B1]">l</a>, <a href="#207370" title="RedBlack.this.Tree[B1]">d</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
    <span class="keyword">private</span><span class="delimiter">[</span><span class="keyword">this</span><span class="delimiter">]</span> <span class="keyword">def</span> <a title="[B1 &gt;: B](isBlack: Boolean, x: A, xv: B, a: RedBlack.this.Tree[B1], r: RedBlack.this.Tree[B1])RedBlack.this.NonEmpty[B1] with Product" id="207018">balanceRight</a><span class="delimiter">[</span><a title="&gt;: B &lt;: Any" id="207020">B1</a> &gt;: B<span class="delimiter">]</span><span class="delimiter">(</span><a title="Boolean" id="207478">isBlack</a>: <a href="../../Boolean.scala.html#65" title="Boolean">Boolean</a>, <a title="A" id="207479">x</a>: <a href="#14363" title="A">A</a>, <a title="B" id="207480">xv</a>: <a href="#206958" title="B">B</a>, <a title="RedBlack.this.Tree[B1]" id="207481">a</a>: <a href="#206955" title="RedBlack.this.Tree[B1]">Tree</a><span class="delimiter">[</span>B1<span class="delimiter">]</span>, <a title="RedBlack.this.Tree[B1]" id="207482">r</a>: <a href="#206955" title="RedBlack.this.Tree[B1]">Tree</a><span class="delimiter">[</span>B1<span class="delimiter">]</span><span class="delimiter">)</span><span class="comment">/*: NonEmpty[B1]*/</span> = <a href="#207482" title="RedBlack.this.Tree[B1]">r</a> <span title="&lt;none&gt; extends RedBlack.this.NonEmpty[B1] with Product" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <span title="RedBlack.this.RedTree[B1]">RedTree</span><span class="delimiter">(</span><a title="A" id="207489">z</a>, <a title="B1" id="207490">zv</a>, RedTree<span class="delimiter">(</span><a title="A" id="207495">y</a>, <a title="B1" id="207496">yv</a>, <a title="RedBlack.this.Tree[B1]" id="207497">b</a>, <a title="RedBlack.this.Tree[B1]" id="207498">c</a><span class="delimiter">)</span>, <a title="RedBlack.this.Tree[B1]" id="207499">d</a><span class="delimiter">)</span> =&gt;
        <a href="#207005" title="(key: A, value: B1, left: RedBlack.this.Tree[B1], right: RedBlack.this.Tree[B1])RedBlack.this.RedTree[B1]">RedTree</a><span class="delimiter">(</span><a href="#207495" title="A">y</a>, <a href="#207496" title="B1">yv</a>, <a href="#207104" title="(key: A, value: B1, left: RedBlack.this.Tree[B1], right: RedBlack.this.Tree[B1])RedBlack.this.BlackTree[B1]">BlackTree</a><span class="delimiter">(</span><a href="#207479" title="A">x</a>, <a href="#207480" title="B">xv</a>, <a href="#207481" title="RedBlack.this.Tree[B1]">a</a>, <a href="#207497" title="RedBlack.this.Tree[B1]">b</a><span class="delimiter">)</span>, <a href="#207104" title="(key: A, value: B1, left: RedBlack.this.Tree[B1], right: RedBlack.this.Tree[B1])RedBlack.this.BlackTree[B1]">BlackTree</a><span class="delimiter">(</span><a href="#207489" title="A">z</a>, <a href="#207490" title="B1">zv</a>, <a href="#207498" title="RedBlack.this.Tree[B1]">c</a>, <a href="#207499" title="RedBlack.this.Tree[B1]">d</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="RedBlack.this.RedTree[B1]">RedTree</span><span class="delimiter">(</span><a title="A" id="207531">y</a>, <a title="B1" id="207532">yv</a>, <a title="RedBlack.this.Tree[B1]" id="207533">b</a>, RedTree<span class="delimiter">(</span><a title="A" id="207538">z</a>, <a title="B1" id="207539">zv</a>, <a title="RedBlack.this.Tree[B1]" id="207540">c</a>, <a title="RedBlack.this.Tree[B1]" id="207541">d</a><span class="delimiter">)</span><span class="delimiter">)</span> =&gt;
        <a href="#207005" title="(key: A, value: B1, left: RedBlack.this.Tree[B1], right: RedBlack.this.Tree[B1])RedBlack.this.RedTree[B1]">RedTree</a><span class="delimiter">(</span><a href="#207531" title="A">y</a>, <a href="#207532" title="B1">yv</a>, <a href="#207104" title="(key: A, value: B1, left: RedBlack.this.Tree[B1], right: RedBlack.this.Tree[B1])RedBlack.this.BlackTree[B1]">BlackTree</a><span class="delimiter">(</span><a href="#207479" title="A">x</a>, <a href="#207480" title="B">xv</a>, <a href="#207481" title="RedBlack.this.Tree[B1]">a</a>, <a href="#207533" title="RedBlack.this.Tree[B1]">b</a><span class="delimiter">)</span>, <a href="#207104" title="(key: A, value: B1, left: RedBlack.this.Tree[B1], right: RedBlack.this.Tree[B1])RedBlack.this.BlackTree[B1]">BlackTree</a><span class="delimiter">(</span><a href="#207538" title="A">z</a>, <a href="#207539" title="B1">zv</a>, <a href="#207540" title="RedBlack.this.Tree[B1]">c</a>, <a href="#207541" title="RedBlack.this.Tree[B1]">d</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="&lt;none&gt; extends RedBlack.this.NonEmpty[B1] with Product">_</span> =&gt;
        <a href="#206952" title="(isBlack: Boolean, k: A, v: B1, l: RedBlack.this.Tree[B1], r: RedBlack.this.Tree[B1])RedBlack.this.NonEmpty[B1] with Product">mkTree</a><span class="delimiter">(</span><a href="#207478" title="Boolean">isBlack</a>, <a href="#207479" title="A">x</a>, <a href="#207480" title="B">xv</a>, <a href="#207481" title="RedBlack.this.Tree[B1]">a</a>, <a href="#207482" title="RedBlack.this.Tree[B1]">r</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
    <span class="keyword">def</span> <a title="[B1 &gt;: B](k: A, v: B1)RedBlack.this.Tree[B1]" id="207021">upd</a><span class="delimiter">[</span><a title="&gt;: B &lt;: Any" id="207023">B1</a> &gt;: B<span class="delimiter">]</span><span class="delimiter">(</span><a title="A" id="207238">k</a>: <a href="#14363" title="A">A</a>, <a title="B1" id="207239">v</a>: <a href="#207023" title="B1">B1</a><span class="delimiter">)</span>: <a href="#206955" title="RedBlack.this.Tree[B1]">Tree</a><span class="delimiter">[</span>B1<span class="delimiter">]</span> = <span class="delimiter">{</span>
      <span title="RedBlack.this.Tree[B1]" class="keyword">if</span> <span class="delimiter">(</span><a href="#206948" title="(x: A, y: A)Boolean">isSmaller</a><span class="delimiter">(</span><a href="#207238" title="A">k</a>, <a href="#207010" title="=&gt; A">key</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="#207015" title="(isBlack: Boolean, z: A, zv: B, l: RedBlack.this.Tree[B1], d: RedBlack.this.Tree[B1])RedBlack.this.NonEmpty[B1] with Product">balanceLeft</a><span class="delimiter">(</span><a href="#206978" title="=&gt; Boolean">isBlack</a>, <a href="#207010" title="=&gt; A">key</a>, <a href="#207011" title="=&gt; B">value</a>, <a href="#207012" title="=&gt; RedBlack.this.Tree[B]">left</a>.<a href="#206994" title="(k: A, v: B1)RedBlack.this.Tree[B1]">upd</a><span class="delimiter">(</span><a href="#207238" title="A">k</a>, <a href="#207239" title="B1">v</a><span class="delimiter">)</span>, <a href="#207013" title="=&gt; RedBlack.this.Tree[B]">right</a><span class="delimiter">)</span>
      <span class="keyword">else</span> <span title="RedBlack.this.Tree[B1]" class="keyword">if</span> <span class="delimiter">(</span><a href="#206948" title="(x: A, y: A)Boolean">isSmaller</a><span class="delimiter">(</span><a href="#207010" title="=&gt; A">key</a>, <a href="#207238" title="A">k</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="#207018" title="(isBlack: Boolean, x: A, xv: B, a: RedBlack.this.Tree[B1], r: RedBlack.this.Tree[B1])RedBlack.this.NonEmpty[B1] with Product">balanceRight</a><span class="delimiter">(</span><a href="#206978" title="=&gt; Boolean">isBlack</a>, <a href="#207010" title="=&gt; A">key</a>, <a href="#207011" title="=&gt; B">value</a>, <a href="#207012" title="=&gt; RedBlack.this.Tree[B]">left</a>, <a href="#207013" title="=&gt; RedBlack.this.Tree[B]">right</a>.<a href="#206994" title="(k: A, v: B1)RedBlack.this.Tree[B1]">upd</a><span class="delimiter">(</span><a href="#207238" title="A">k</a>, <a href="#207239" title="B1">v</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">else</span> <a href="#206952" title="(isBlack: Boolean, k: A, v: B1, l: RedBlack.this.Tree[B1], r: RedBlack.this.Tree[B1])RedBlack.this.NonEmpty[B1] with Product">mkTree</a><span class="delimiter">(</span><a href="#206978" title="=&gt; Boolean">isBlack</a>, <a href="#207238" title="A">k</a>, <a href="#207239" title="B1">v</a>, <a href="#207012" title="=&gt; RedBlack.this.Tree[B]">left</a>, <a href="#207013" title="=&gt; RedBlack.this.Tree[B]">right</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
    <span class="comment">// Based on Stefan Kahrs' Haskell version of Okasaki's Red&amp;Black Trees</span>
    <span class="comment">// http://www.cse.unsw.edu.au/~dons/data/RedBlackTree.html</span>
    <span class="keyword">def</span> <a title="(k: A)RedBlack.this.Tree[B]" id="207024">del</a><span class="delimiter">(</span><a title="A" id="207228">k</a>: <a href="#14363" title="A">A</a><span class="delimiter">)</span>: <a href="#206955" title="RedBlack.this.Tree[B]">Tree</a><span class="delimiter">[</span>B<span class="delimiter">]</span> = <span class="delimiter">{</span>
      <span class="keyword">def</span> <a title="(x: A, xv: B, tl: RedBlack.this.Tree[B], tr: RedBlack.this.Tree[B])RedBlack.this.NonEmpty[B] with Product" id="207648">balance</a><span class="delimiter">(</span><a title="A" id="207655">x</a>: <a href="#14363" title="A">A</a>, <a title="B" id="207656">xv</a>: <a href="#206958" title="B">B</a>, <a title="RedBlack.this.Tree[B]" id="207657">tl</a>: <a href="#206955" title="RedBlack.this.Tree[B]">Tree</a><span class="delimiter">[</span>B<span class="delimiter">]</span>, <a title="RedBlack.this.Tree[B]" id="207658">tr</a>: <a href="#206955" title="RedBlack.this.Tree[B]">Tree</a><span class="delimiter">[</span>B<span class="delimiter">]</span><span class="delimiter">)</span> = <a href="../../Tuple2.scala.html#53390" title="(_1: RedBlack.this.Tree[B], _2: RedBlack.this.Tree[B])(RedBlack.this.Tree[B], RedBlack.this.Tree[B])" class="delimiter">(</a><a href="#207657" title="RedBlack.this.Tree[B]">tl</a>, <a href="#207658" title="RedBlack.this.Tree[B]">tr</a><span class="delimiter">)</span> <span title="&lt;none&gt; extends RedBlack.this.NonEmpty[B] with Product" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <span title="RedBlack.this.RedTree[B]" class="delimiter">(</span>RedTree<span class="delimiter">(</span><a title="A" id="207671">y</a>, <a title="B" id="207672">yv</a>, <a title="RedBlack.this.Tree[B]" id="207673">a</a>, <a title="RedBlack.this.Tree[B]" id="207674">b</a><span class="delimiter">)</span>, RedTree<span class="delimiter">(</span><a title="A" id="207679">z</a>, <a title="B" id="207680">zv</a>, <a title="RedBlack.this.Tree[B]" id="207681">c</a>, <a title="RedBlack.this.Tree[B]" id="207682">d</a><span class="delimiter">)</span><span class="delimiter">)</span> =&gt;
          <a href="#207005" title="(key: A, value: B, left: RedBlack.this.Tree[B], right: RedBlack.this.Tree[B])RedBlack.this.RedTree[B]">RedTree</a><span class="delimiter">(</span><a href="#207655" title="A">x</a>, <a href="#207656" title="B">xv</a>, <a href="#207104" title="(key: A, value: B, left: RedBlack.this.Tree[B], right: RedBlack.this.Tree[B])RedBlack.this.BlackTree[B]">BlackTree</a><span class="delimiter">(</span><a href="#207671" title="A">y</a>, <a href="#207672" title="B">yv</a>, <a href="#207673" title="RedBlack.this.Tree[B]">a</a>, <a href="#207674" title="RedBlack.this.Tree[B]">b</a><span class="delimiter">)</span>, <a href="#207104" title="(key: A, value: B, left: RedBlack.this.Tree[B], right: RedBlack.this.Tree[B])RedBlack.this.BlackTree[B]">BlackTree</a><span class="delimiter">(</span><a href="#207679" title="A">z</a>, <a href="#207680" title="B">zv</a>, <a href="#207681" title="RedBlack.this.Tree[B]">c</a>, <a href="#207682" title="RedBlack.this.Tree[B]">d</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="keyword">case</span> <span title="RedBlack.this.RedTree[B]" class="delimiter">(</span>RedTree<span class="delimiter">(</span><a title="A" id="207716">y</a>, <a title="B" id="207717">yv</a>, RedTree<span class="delimiter">(</span><a title="A" id="207722">z</a>, <a title="B" id="207723">zv</a>, <a title="RedBlack.this.Tree[B]" id="207724">a</a>, <a title="RedBlack.this.Tree[B]" id="207725">b</a><span class="delimiter">)</span>, <a title="RedBlack.this.Tree[B]" id="207726">c</a><span class="delimiter">)</span>, <a title="RedBlack.this.Tree[B]" id="207727">d</a><span class="delimiter">)</span> =&gt;
          <a href="#207005" title="(key: A, value: B, left: RedBlack.this.Tree[B], right: RedBlack.this.Tree[B])RedBlack.this.RedTree[B]">RedTree</a><span class="delimiter">(</span><a href="#207716" title="A">y</a>, <a href="#207717" title="B">yv</a>, <a href="#207104" title="(key: A, value: B, left: RedBlack.this.Tree[B], right: RedBlack.this.Tree[B])RedBlack.this.BlackTree[B]">BlackTree</a><span class="delimiter">(</span><a href="#207722" title="A">z</a>, <a href="#207723" title="B">zv</a>, <a href="#207724" title="RedBlack.this.Tree[B]">a</a>, <a href="#207725" title="RedBlack.this.Tree[B]">b</a><span class="delimiter">)</span>, <a href="#207104" title="(key: A, value: B, left: RedBlack.this.Tree[B], right: RedBlack.this.Tree[B])RedBlack.this.BlackTree[B]">BlackTree</a><span class="delimiter">(</span><a href="#207655" title="A">x</a>, <a href="#207656" title="B">xv</a>, <a href="#207726" title="RedBlack.this.Tree[B]">c</a>, <a href="#207727" title="RedBlack.this.Tree[B]">d</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="keyword">case</span> <span title="RedBlack.this.RedTree[B]" class="delimiter">(</span>RedTree<span class="delimiter">(</span><a title="A" id="207761">y</a>, <a title="B" id="207762">yv</a>, <a title="RedBlack.this.Tree[B]" id="207763">a</a>, RedTree<span class="delimiter">(</span><a title="A" id="207768">z</a>, <a title="B" id="207769">zv</a>, <a title="RedBlack.this.Tree[B]" id="207770">b</a>, <a title="RedBlack.this.Tree[B]" id="207771">c</a><span class="delimiter">)</span><span class="delimiter">)</span>, <a title="RedBlack.this.Tree[B]" id="207772">d</a><span class="delimiter">)</span> =&gt;
          <a href="#207005" title="(key: A, value: B, left: RedBlack.this.Tree[B], right: RedBlack.this.Tree[B])RedBlack.this.RedTree[B]">RedTree</a><span class="delimiter">(</span><a href="#207768" title="A">z</a>, <a href="#207769" title="B">zv</a>, <a href="#207104" title="(key: A, value: B, left: RedBlack.this.Tree[B], right: RedBlack.this.Tree[B])RedBlack.this.BlackTree[B]">BlackTree</a><span class="delimiter">(</span><a href="#207761" title="A">y</a>, <a href="#207762" title="B">yv</a>, <a href="#207763" title="RedBlack.this.Tree[B]">a</a>, <a href="#207770" title="RedBlack.this.Tree[B]">b</a><span class="delimiter">)</span>, <a href="#207104" title="(key: A, value: B, left: RedBlack.this.Tree[B], right: RedBlack.this.Tree[B])RedBlack.this.BlackTree[B]">BlackTree</a><span class="delimiter">(</span><a href="#207655" title="A">x</a>, <a href="#207656" title="B">xv</a>, <a href="#207771" title="RedBlack.this.Tree[B]">c</a>, <a href="#207772" title="RedBlack.this.Tree[B]">d</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="keyword">case</span> <span title="RedBlack.this.RedTree[B]" class="delimiter">(</span><a title="RedBlack.this.Tree[B]" id="207802">a</a>, RedTree<span class="delimiter">(</span><a title="A" id="207807">y</a>, <a title="B" id="207808">yv</a>, <a title="RedBlack.this.Tree[B]" id="207809">b</a>, RedTree<span class="delimiter">(</span><a title="A" id="207814">z</a>, <a title="B" id="207815">zv</a>, <a title="RedBlack.this.Tree[B]" id="207816">c</a>, <a title="RedBlack.this.Tree[B]" id="207817">d</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span> =&gt;
          <a href="#207005" title="(key: A, value: B, left: RedBlack.this.Tree[B], right: RedBlack.this.Tree[B])RedBlack.this.RedTree[B]">RedTree</a><span class="delimiter">(</span><a href="#207807" title="A">y</a>, <a href="#207808" title="B">yv</a>, <a href="#207104" title="(key: A, value: B, left: RedBlack.this.Tree[B], right: RedBlack.this.Tree[B])RedBlack.this.BlackTree[B]">BlackTree</a><span class="delimiter">(</span><a href="#207655" title="A">x</a>, <a href="#207656" title="B">xv</a>, <a href="#207802" title="RedBlack.this.Tree[B]">a</a>, <a href="#207809" title="RedBlack.this.Tree[B]">b</a><span class="delimiter">)</span>, <a href="#207104" title="(key: A, value: B, left: RedBlack.this.Tree[B], right: RedBlack.this.Tree[B])RedBlack.this.BlackTree[B]">BlackTree</a><span class="delimiter">(</span><a href="#207814" title="A">z</a>, <a href="#207815" title="B">zv</a>, <a href="#207816" title="RedBlack.this.Tree[B]">c</a>, <a href="#207817" title="RedBlack.this.Tree[B]">d</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="keyword">case</span> <span title="RedBlack.this.RedTree[B]" class="delimiter">(</span><a title="RedBlack.this.Tree[B]" id="207847">a</a>, RedTree<span class="delimiter">(</span><a title="A" id="207852">y</a>, <a title="B" id="207853">yv</a>, RedTree<span class="delimiter">(</span><a title="A" id="207858">z</a>, <a title="B" id="207859">zv</a>, <a title="RedBlack.this.Tree[B]" id="207860">b</a>, <a title="RedBlack.this.Tree[B]" id="207861">c</a><span class="delimiter">)</span>, <a title="RedBlack.this.Tree[B]" id="207862">d</a><span class="delimiter">)</span><span class="delimiter">)</span> =&gt;
          <a href="#207005" title="(key: A, value: B, left: RedBlack.this.Tree[B], right: RedBlack.this.Tree[B])RedBlack.this.RedTree[B]">RedTree</a><span class="delimiter">(</span><a href="#207858" title="A">z</a>, <a href="#207859" title="B">zv</a>, <a href="#207104" title="(key: A, value: B, left: RedBlack.this.Tree[B], right: RedBlack.this.Tree[B])RedBlack.this.BlackTree[B]">BlackTree</a><span class="delimiter">(</span><a href="#207655" title="A">x</a>, <a href="#207656" title="B">xv</a>, <a href="#207847" title="RedBlack.this.Tree[B]">a</a>, <a href="#207860" title="RedBlack.this.Tree[B]">b</a><span class="delimiter">)</span>, <a href="#207104" title="(key: A, value: B, left: RedBlack.this.Tree[B], right: RedBlack.this.Tree[B])RedBlack.this.BlackTree[B]">BlackTree</a><span class="delimiter">(</span><a href="#207852" title="A">y</a>, <a href="#207853" title="B">yv</a>, <a href="#207861" title="RedBlack.this.Tree[B]">c</a>, <a href="#207862" title="RedBlack.this.Tree[B]">d</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="keyword">case</span> <span title="RedBlack.this.BlackTree[B]" class="delimiter">(</span><a title="RedBlack.this.Tree[B]" id="207892">a</a>, <a title="RedBlack.this.Tree[B]" id="207893">b</a><span class="delimiter">)</span> =&gt;
          <a href="#207104" title="(key: A, value: B, left: RedBlack.this.Tree[B], right: RedBlack.this.Tree[B])RedBlack.this.BlackTree[B]">BlackTree</a><span class="delimiter">(</span><a href="#207655" title="A">x</a>, <a href="#207656" title="B">xv</a>, <a href="#207892" title="RedBlack.this.Tree[B]">a</a>, <a href="#207893" title="RedBlack.this.Tree[B]">b</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
      <span class="keyword">def</span> <a title="(t: RedBlack.this.Tree[B])RedBlack.this.RedTree[B]" id="207649">subl</a><span class="delimiter">(</span><a title="RedBlack.this.Tree[B]" id="207938">t</a>: <a href="#206955" title="RedBlack.this.Tree[B]">Tree</a><span class="delimiter">[</span>B<span class="delimiter">]</span><span class="delimiter">)</span> = <a href="#207938" title="RedBlack.this.Tree[B]">t</a> <span title="RedBlack.this.RedTree[B]" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <span title="RedBlack.this.RedTree[B]">BlackTree</span><span class="delimiter">(</span><a title="A" id="207977">x</a>, <a title="B" id="207978">xv</a>, <a title="RedBlack.this.Tree[B]" id="207979">a</a>, <a title="RedBlack.this.Tree[B]" id="207980">b</a><span class="delimiter">)</span> =&gt; <a href="#207005" title="(key: A, value: B, left: RedBlack.this.Tree[B], right: RedBlack.this.Tree[B])RedBlack.this.RedTree[B]">RedTree</a><span class="delimiter">(</span><a href="#207977" title="A">x</a>, <a href="#207978" title="B">xv</a>, <a href="#207979" title="RedBlack.this.Tree[B]">a</a>, <a href="#207980" title="RedBlack.this.Tree[B]">b</a><span class="delimiter">)</span>
        <span class="keyword">case</span> <span title="Nothing">_</span> =&gt; sys.<a href="../../sys/package.scala.html#48163" title="(message: String)Nothing">error</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Defect: invariance violation; expected black, got &quot;)" class="string">&quot;Defect: invariance violation; expected black, got &quot;</span><span title="(x$1: Any)java.lang.String">+</span><a href="#207938" title="RedBlack.this.Tree[B]">t</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
      <span class="keyword">def</span> <a title="(x: A, xv: B, tl: RedBlack.this.Tree[B], tr: RedBlack.this.Tree[B])RedBlack.this.NonEmpty[B] with Product" id="207650">balLeft</a><span class="delimiter">(</span><a title="A" id="207990">x</a>: <a href="#14363" title="A">A</a>, <a title="B" id="207991">xv</a>: <a href="#206958" title="B">B</a>, <a title="RedBlack.this.Tree[B]" id="207992">tl</a>: <a href="#206955" title="RedBlack.this.Tree[B]">Tree</a><span class="delimiter">[</span>B<span class="delimiter">]</span>, <a title="RedBlack.this.Tree[B]" id="207993">tr</a>: <a href="#206955" title="RedBlack.this.Tree[B]">Tree</a><span class="delimiter">[</span>B<span class="delimiter">]</span><span class="delimiter">)</span> = <a href="../../Tuple2.scala.html#53390" title="(_1: RedBlack.this.Tree[B], _2: RedBlack.this.Tree[B])(RedBlack.this.Tree[B], RedBlack.this.Tree[B])" class="delimiter">(</a><a href="#207992" title="RedBlack.this.Tree[B]">tl</a>, <a href="#207993" title="RedBlack.this.Tree[B]">tr</a><span class="delimiter">)</span> <span title="&lt;none&gt; extends RedBlack.this.NonEmpty[B] with Product" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <span title="RedBlack.this.RedTree[B]" class="delimiter">(</span>RedTree<span class="delimiter">(</span><a title="A" id="208006">y</a>, <a title="B" id="208007">yv</a>, <a title="RedBlack.this.Tree[B]" id="208008">a</a>, <a title="RedBlack.this.Tree[B]" id="208009">b</a><span class="delimiter">)</span>, <a title="RedBlack.this.Tree[B]" id="208010">c</a><span class="delimiter">)</span> =&gt;
          <a href="#207005" title="(key: A, value: B, left: RedBlack.this.Tree[B], right: RedBlack.this.Tree[B])RedBlack.this.RedTree[B]">RedTree</a><span class="delimiter">(</span><a href="#207990" title="A">x</a>, <a href="#207991" title="B">xv</a>, <a href="#207104" title="(key: A, value: B, left: RedBlack.this.Tree[B], right: RedBlack.this.Tree[B])RedBlack.this.BlackTree[B]">BlackTree</a><span class="delimiter">(</span><a href="#208006" title="A">y</a>, <a href="#208007" title="B">yv</a>, <a href="#208008" title="RedBlack.this.Tree[B]">a</a>, <a href="#208009" title="RedBlack.this.Tree[B]">b</a><span class="delimiter">)</span>, <a href="#208010" title="RedBlack.this.Tree[B]">c</a><span class="delimiter">)</span>
        <span class="keyword">case</span> <span title="&lt;none&gt; extends RedBlack.this.NonEmpty[B] with Product" class="delimiter">(</span><a title="RedBlack.this.Tree[B]" id="208031">bl</a>, BlackTree<span class="delimiter">(</span><a title="A" id="208036">y</a>, <a title="B" id="208037">yv</a>, <a title="RedBlack.this.Tree[B]" id="208038">a</a>, <a title="RedBlack.this.Tree[B]" id="208039">b</a><span class="delimiter">)</span><span class="delimiter">)</span> =&gt;
          <a href="#207648" title="(x: A, xv: B, tl: RedBlack.this.Tree[B], tr: RedBlack.this.Tree[B])RedBlack.this.NonEmpty[B] with Product">balance</a><span class="delimiter">(</span><a href="#207990" title="A">x</a>, <a href="#207991" title="B">xv</a>, <a href="#208031" title="RedBlack.this.Tree[B]">bl</a>, <a href="#207005" title="(key: A, value: B, left: RedBlack.this.Tree[B], right: RedBlack.this.Tree[B])RedBlack.this.RedTree[B]">RedTree</a><span class="delimiter">(</span><a href="#208036" title="A">y</a>, <a href="#208037" title="B">yv</a>, <a href="#208038" title="RedBlack.this.Tree[B]">a</a>, <a href="#208039" title="RedBlack.this.Tree[B]">b</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="keyword">case</span> <span title="RedBlack.this.RedTree[B]" class="delimiter">(</span><a title="RedBlack.this.Tree[B]" id="208051">bl</a>, RedTree<span class="delimiter">(</span><a title="A" id="208056">y</a>, <a title="B" id="208057">yv</a>, BlackTree<span class="delimiter">(</span><a title="A" id="208062">z</a>, <a title="B" id="208063">zv</a>, <a title="RedBlack.this.Tree[B]" id="208064">a</a>, <a title="RedBlack.this.Tree[B]" id="208065">b</a><span class="delimiter">)</span>, <a title="RedBlack.this.Tree[B]" id="208066">c</a><span class="delimiter">)</span><span class="delimiter">)</span> =&gt;
          <a href="#207005" title="(key: A, value: B, left: RedBlack.this.Tree[B], right: RedBlack.this.Tree[B])RedBlack.this.RedTree[B]">RedTree</a><span class="delimiter">(</span><a href="#208062" title="A">z</a>, <a href="#208063" title="B">zv</a>, <a href="#207104" title="(key: A, value: B, left: RedBlack.this.Tree[B], right: RedBlack.this.Tree[B])RedBlack.this.BlackTree[B]">BlackTree</a><span class="delimiter">(</span><a href="#207990" title="A">x</a>, <a href="#207991" title="B">xv</a>, <a href="#208051" title="RedBlack.this.Tree[B]">bl</a>, <a href="#208064" title="RedBlack.this.Tree[B]">a</a><span class="delimiter">)</span>, <a href="#207648" title="(x: A, xv: B, tl: RedBlack.this.Tree[B], tr: RedBlack.this.Tree[B])RedBlack.this.NonEmpty[B] with Product">balance</a><span class="delimiter">(</span><a href="#208056" title="A">y</a>, <a href="#208057" title="B">yv</a>, <a href="#208065" title="RedBlack.this.Tree[B]">b</a>, <a href="#207649" title="(t: RedBlack.this.Tree[B])RedBlack.this.RedTree[B]">subl</a><span class="delimiter">(</span><a href="#208066" title="RedBlack.this.Tree[B]">c</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="keyword">case</span> <span title="Nothing">_</span> =&gt; sys.<a href="../../sys/package.scala.html#48163" title="(message: String)Nothing">error</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Defect: invariance violation at &quot;)" class="string">&quot;Defect: invariance violation at &quot;</span><span title="(x$1: Any)java.lang.String">+</span><a href="#207013" title="=&gt; RedBlack.this.Tree[B]">right</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
      <span class="keyword">def</span> <a title="(x: A, xv: B, tl: RedBlack.this.Tree[B], tr: RedBlack.this.Tree[B])RedBlack.this.NonEmpty[B] with Product" id="207651">balRight</a><span class="delimiter">(</span><a title="A" id="208085">x</a>: <a href="#14363" title="A">A</a>, <a title="B" id="208086">xv</a>: <a href="#206958" title="B">B</a>, <a title="RedBlack.this.Tree[B]" id="208087">tl</a>: <a href="#206955" title="RedBlack.this.Tree[B]">Tree</a><span class="delimiter">[</span>B<span class="delimiter">]</span>, <a title="RedBlack.this.Tree[B]" id="208088">tr</a>: <a href="#206955" title="RedBlack.this.Tree[B]">Tree</a><span class="delimiter">[</span>B<span class="delimiter">]</span><span class="delimiter">)</span> = <a href="../../Tuple2.scala.html#53390" title="(_1: RedBlack.this.Tree[B], _2: RedBlack.this.Tree[B])(RedBlack.this.Tree[B], RedBlack.this.Tree[B])" class="delimiter">(</a><a href="#208087" title="RedBlack.this.Tree[B]">tl</a>, <a href="#208088" title="RedBlack.this.Tree[B]">tr</a><span class="delimiter">)</span> <span title="&lt;none&gt; extends RedBlack.this.NonEmpty[B] with Product" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <span title="RedBlack.this.RedTree[B]" class="delimiter">(</span><a title="RedBlack.this.Tree[B]" id="208097">a</a>, RedTree<span class="delimiter">(</span><a title="A" id="208102">y</a>, <a title="B" id="208103">yv</a>, <a title="RedBlack.this.Tree[B]" id="208104">b</a>, <a title="RedBlack.this.Tree[B]" id="208105">c</a><span class="delimiter">)</span><span class="delimiter">)</span> =&gt;
          <a href="#207005" title="(key: A, value: B, left: RedBlack.this.Tree[B], right: RedBlack.this.Tree[B])RedBlack.this.RedTree[B]">RedTree</a><span class="delimiter">(</span><a href="#208085" title="A">x</a>, <a href="#208086" title="B">xv</a>, <a href="#208097" title="RedBlack.this.Tree[B]">a</a>, <a href="#207104" title="(key: A, value: B, left: RedBlack.this.Tree[B], right: RedBlack.this.Tree[B])RedBlack.this.BlackTree[B]">BlackTree</a><span class="delimiter">(</span><a href="#208102" title="A">y</a>, <a href="#208103" title="B">yv</a>, <a href="#208104" title="RedBlack.this.Tree[B]">b</a>, <a href="#208105" title="RedBlack.this.Tree[B]">c</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="keyword">case</span> <span title="&lt;none&gt; extends RedBlack.this.NonEmpty[B] with Product" class="delimiter">(</span>BlackTree<span class="delimiter">(</span><a title="A" id="208130">y</a>, <a title="B" id="208131">yv</a>, <a title="RedBlack.this.Tree[B]" id="208132">a</a>, <a title="RedBlack.this.Tree[B]" id="208133">b</a><span class="delimiter">)</span>, <a title="RedBlack.this.Tree[B]" id="208134">bl</a><span class="delimiter">)</span> =&gt;
          <a href="#207648" title="(x: A, xv: B, tl: RedBlack.this.Tree[B], tr: RedBlack.this.Tree[B])RedBlack.this.NonEmpty[B] with Product">balance</a><span class="delimiter">(</span><a href="#208085" title="A">x</a>, <a href="#208086" title="B">xv</a>, <a href="#207005" title="(key: A, value: B, left: RedBlack.this.Tree[B], right: RedBlack.this.Tree[B])RedBlack.this.RedTree[B]">RedTree</a><span class="delimiter">(</span><a href="#208130" title="A">y</a>, <a href="#208131" title="B">yv</a>, <a href="#208132" title="RedBlack.this.Tree[B]">a</a>, <a href="#208133" title="RedBlack.this.Tree[B]">b</a><span class="delimiter">)</span>, <a href="#208134" title="RedBlack.this.Tree[B]">bl</a><span class="delimiter">)</span>
        <span class="keyword">case</span> <span title="RedBlack.this.RedTree[B]" class="delimiter">(</span>RedTree<span class="delimiter">(</span><a title="A" id="208150">y</a>, <a title="B" id="208151">yv</a>, <a title="RedBlack.this.Tree[B]" id="208152">a</a>, BlackTree<span class="delimiter">(</span><a title="A" id="208157">z</a>, <a title="B" id="208158">zv</a>, <a title="RedBlack.this.Tree[B]" id="208159">b</a>, <a title="RedBlack.this.Tree[B]" id="208160">c</a><span class="delimiter">)</span><span class="delimiter">)</span>, <a title="RedBlack.this.Tree[B]" id="208161">bl</a><span class="delimiter">)</span> =&gt;
          <a href="#207005" title="(key: A, value: B, left: RedBlack.this.Tree[B], right: RedBlack.this.Tree[B])RedBlack.this.RedTree[B]">RedTree</a><span class="delimiter">(</span><a href="#208157" title="A">z</a>, <a href="#208158" title="B">zv</a>, <a href="#207648" title="(x: A, xv: B, tl: RedBlack.this.Tree[B], tr: RedBlack.this.Tree[B])RedBlack.this.NonEmpty[B] with Product">balance</a><span class="delimiter">(</span><a href="#208150" title="A">y</a>, <a href="#208151" title="B">yv</a>, <a href="#207649" title="(t: RedBlack.this.Tree[B])RedBlack.this.RedTree[B]">subl</a><span class="delimiter">(</span><a href="#208152" title="RedBlack.this.Tree[B]">a</a><span class="delimiter">)</span>, <a href="#208159" title="RedBlack.this.Tree[B]">b</a><span class="delimiter">)</span>, <a href="#207104" title="(key: A, value: B, left: RedBlack.this.Tree[B], right: RedBlack.this.Tree[B])RedBlack.this.BlackTree[B]">BlackTree</a><span class="delimiter">(</span><a href="#208085" title="A">x</a>, <a href="#208086" title="B">xv</a>, <a href="#208160" title="RedBlack.this.Tree[B]">c</a>, <a href="#208161" title="RedBlack.this.Tree[B]">bl</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="keyword">case</span> <span title="Nothing">_</span> =&gt; sys.<a href="../../sys/package.scala.html#48163" title="(message: String)Nothing">error</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Defect: invariance violation at &quot;)" class="string">&quot;Defect: invariance violation at &quot;</span><span title="(x$1: Any)java.lang.String">+</span><a href="#207012" title="=&gt; RedBlack.this.Tree[B]">left</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
      <span class="keyword">def</span> <a title="=&gt; RedBlack.this.NonEmpty[B] with Product" id="207652">delLeft</a> = <a href="#207012" title="=&gt; RedBlack.this.Tree[B]">left</a> <span title="&lt;none&gt; extends RedBlack.this.NonEmpty[B] with Product" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <span title="&lt;none&gt; extends RedBlack.this.NonEmpty[B] with Product">_</span>: <a href="#207104" title="RedBlack.this.BlackTree[_]">BlackTree</a><span class="delimiter">[</span>_<span class="delimiter">]</span> =&gt; <a href="#207650" title="(x: A, xv: B, tl: RedBlack.this.Tree[B], tr: RedBlack.this.Tree[B])RedBlack.this.NonEmpty[B] with Product">balLeft</a><span class="delimiter">(</span><a href="#207010" title="=&gt; A">key</a>, <a href="#207011" title="=&gt; B">value</a>, <a href="#207012" title="=&gt; RedBlack.this.Tree[B]">left</a>.<a href="#206997" title="(k: A)RedBlack.this.Tree[B]">del</a><span class="delimiter">(</span><a href="#207228" title="A">k</a><span class="delimiter">)</span>, <a href="#207013" title="=&gt; RedBlack.this.Tree[B]">right</a><span class="delimiter">)</span>
        <span class="keyword">case</span> <span title="RedBlack.this.RedTree[B]">_</span> =&gt; <a href="#207005" title="(key: A, value: B, left: RedBlack.this.Tree[B], right: RedBlack.this.Tree[B])RedBlack.this.RedTree[B]">RedTree</a><span class="delimiter">(</span><a href="#207010" title="=&gt; A">key</a>, <a href="#207011" title="=&gt; B">value</a>, <a href="#207012" title="=&gt; RedBlack.this.Tree[B]">left</a>.<a href="#206997" title="(k: A)RedBlack.this.Tree[B]">del</a><span class="delimiter">(</span><a href="#207228" title="A">k</a><span class="delimiter">)</span>, <a href="#207013" title="=&gt; RedBlack.this.Tree[B]">right</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
      <span class="keyword">def</span> <a title="=&gt; RedBlack.this.NonEmpty[B] with Product" id="207653">delRight</a> = <a href="#207013" title="=&gt; RedBlack.this.Tree[B]">right</a> <span title="&lt;none&gt; extends RedBlack.this.NonEmpty[B] with Product" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <span title="&lt;none&gt; extends RedBlack.this.NonEmpty[B] with Product">_</span>: <a href="#207104" title="RedBlack.this.BlackTree[_]">BlackTree</a><span class="delimiter">[</span>_<span class="delimiter">]</span> =&gt; <a href="#207651" title="(x: A, xv: B, tl: RedBlack.this.Tree[B], tr: RedBlack.this.Tree[B])RedBlack.this.NonEmpty[B] with Product">balRight</a><span class="delimiter">(</span><a href="#207010" title="=&gt; A">key</a>, <a href="#207011" title="=&gt; B">value</a>, <a href="#207012" title="=&gt; RedBlack.this.Tree[B]">left</a>, <a href="#207013" title="=&gt; RedBlack.this.Tree[B]">right</a>.<a href="#206997" title="(k: A)RedBlack.this.Tree[B]">del</a><span class="delimiter">(</span><a href="#207228" title="A">k</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="keyword">case</span> <span title="RedBlack.this.RedTree[B]">_</span> =&gt; <a href="#207005" title="(key: A, value: B, left: RedBlack.this.Tree[B], right: RedBlack.this.Tree[B])RedBlack.this.RedTree[B]">RedTree</a><span class="delimiter">(</span><a href="#207010" title="=&gt; A">key</a>, <a href="#207011" title="=&gt; B">value</a>, <a href="#207012" title="=&gt; RedBlack.this.Tree[B]">left</a>, <a href="#207013" title="=&gt; RedBlack.this.Tree[B]">right</a>.<a href="#206997" title="(k: A)RedBlack.this.Tree[B]">del</a><span class="delimiter">(</span><a href="#207228" title="A">k</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
      <span class="keyword">def</span> <a title="(tl: RedBlack.this.Tree[B], tr: RedBlack.this.Tree[B])RedBlack.this.Tree[B]" id="207654">append</a><span class="delimiter">(</span><a title="RedBlack.this.Tree[B]" id="208200">tl</a>: <a href="#206955" title="RedBlack.this.Tree[B]">Tree</a><span class="delimiter">[</span>B<span class="delimiter">]</span>, <a title="RedBlack.this.Tree[B]" id="208201">tr</a>: <a href="#206955" title="RedBlack.this.Tree[B]">Tree</a><span class="delimiter">[</span>B<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#206955" title="RedBlack.this.Tree[B]">Tree</a><span class="delimiter">[</span>B<span class="delimiter">]</span> = <a href="../../Tuple2.scala.html#53390" title="(_1: RedBlack.this.Tree[B], _2: RedBlack.this.Tree[B])(RedBlack.this.Tree[B], RedBlack.this.Tree[B])" class="delimiter">(</a><a href="#208200" title="RedBlack.this.Tree[B]">tl</a>, <a href="#208201" title="RedBlack.this.Tree[B]">tr</a><span class="delimiter">)</span> <span title="RedBlack.this.Tree[B]" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <span title="RedBlack.this.Tree[B]" class="delimiter">(</span><a href="#209193" title="object RedBlack.this.Empty">Empty</a>, <a title="RedBlack.this.Tree[B]" id="208231">t</a><span class="delimiter">)</span> =&gt; <a href="#208231" title="RedBlack.this.Tree[B]">t</a>
        <span class="keyword">case</span> <span title="RedBlack.this.Tree[B]" class="delimiter">(</span><a title="RedBlack.this.Tree[B]" id="208234">t</a>, <a href="#209193" title="object RedBlack.this.Empty">Empty</a><span class="delimiter">)</span> =&gt; <a href="#208234" title="RedBlack.this.Tree[B]">t</a>
        <span class="keyword">case</span> <span title="RedBlack.this.Tree[B]" class="delimiter">(</span>RedTree<span class="delimiter">(</span><a title="A" id="208241">x</a>, <a title="B" id="208242">xv</a>, <a title="RedBlack.this.Tree[B]" id="208243">a</a>, <a title="RedBlack.this.Tree[B]" id="208244">b</a><span class="delimiter">)</span>, RedTree<span class="delimiter">(</span><a title="A" id="208249">y</a>, <a title="B" id="208250">yv</a>, <a title="RedBlack.this.Tree[B]" id="208251">c</a>, <a title="RedBlack.this.Tree[B]" id="208252">d</a><span class="delimiter">)</span><span class="delimiter">)</span> =&gt;
          <a href="#207654" title="(tl: RedBlack.this.Tree[B], tr: RedBlack.this.Tree[B])RedBlack.this.Tree[B]">append</a><span class="delimiter">(</span><a href="#208244" title="RedBlack.this.Tree[B]">b</a>, <a href="#208251" title="RedBlack.this.Tree[B]">c</a><span class="delimiter">)</span> <span title="RedBlack.this.Tree[B]" class="keyword">match</span> <span class="delimiter">{</span>
            <span class="keyword">case</span> <span title="RedBlack.this.RedTree[B]">RedTree</span><span class="delimiter">(</span><a title="A" id="208257">z</a>, <a title="B" id="208258">zv</a>, <a title="RedBlack.this.Tree[B]" id="208259">bb</a>, <a title="RedBlack.this.Tree[B]" id="208260">cc</a><span class="delimiter">)</span> =&gt; <a href="#207005" title="(key: A, value: B, left: RedBlack.this.Tree[B], right: RedBlack.this.Tree[B])RedBlack.this.RedTree[B]">RedTree</a><span class="delimiter">(</span><a href="#208257" title="A">z</a>, <a href="#208258" title="B">zv</a>, <a href="#207005" title="(key: A, value: B, left: RedBlack.this.Tree[B], right: RedBlack.this.Tree[B])RedBlack.this.RedTree[B]">RedTree</a><span class="delimiter">(</span><a href="#208241" title="A">x</a>, <a href="#208242" title="B">xv</a>, <a href="#208243" title="RedBlack.this.Tree[B]">a</a>, <a href="#208259" title="RedBlack.this.Tree[B]">bb</a><span class="delimiter">)</span>, <a href="#207005" title="(key: A, value: B, left: RedBlack.this.Tree[B], right: RedBlack.this.Tree[B])RedBlack.this.RedTree[B]">RedTree</a><span class="delimiter">(</span><a href="#208249" title="A">y</a>, <a href="#208250" title="B">yv</a>, <a href="#208260" title="RedBlack.this.Tree[B]">cc</a>, <a href="#208252" title="RedBlack.this.Tree[B]">d</a><span class="delimiter">)</span><span class="delimiter">)</span>
            <span class="keyword">case</span> <a title="RedBlack.this.RedTree[B]" id="208288">bc</a> =&gt; <a href="#207005" title="(key: A, value: B, left: RedBlack.this.Tree[B], right: RedBlack.this.Tree[B])RedBlack.this.RedTree[B]">RedTree</a><span class="delimiter">(</span><a href="#208241" title="A">x</a>, <a href="#208242" title="B">xv</a>, <a href="#208243" title="RedBlack.this.Tree[B]">a</a>, <a href="#207005" title="(key: A, value: B, left: RedBlack.this.Tree[B], right: RedBlack.this.Tree[B])RedBlack.this.RedTree[B]">RedTree</a><span class="delimiter">(</span><a href="#208249" title="A">y</a>, <a href="#208250" title="B">yv</a>, <a href="#208288" title="RedBlack.this.Tree[B]">bc</a>, <a href="#208252" title="RedBlack.this.Tree[B]">d</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <span class="delimiter">}</span>
        <span class="keyword">case</span> <span title="RedBlack.this.Tree[B]" class="delimiter">(</span>BlackTree<span class="delimiter">(</span><a title="A" id="208313">x</a>, <a title="B" id="208314">xv</a>, <a title="RedBlack.this.Tree[B]" id="208315">a</a>, <a title="RedBlack.this.Tree[B]" id="208316">b</a><span class="delimiter">)</span>, BlackTree<span class="delimiter">(</span><a title="A" id="208321">y</a>, <a title="B" id="208322">yv</a>, <a title="RedBlack.this.Tree[B]" id="208323">c</a>, <a title="RedBlack.this.Tree[B]" id="208324">d</a><span class="delimiter">)</span><span class="delimiter">)</span> =&gt;
          <a href="#207654" title="(tl: RedBlack.this.Tree[B], tr: RedBlack.this.Tree[B])RedBlack.this.Tree[B]">append</a><span class="delimiter">(</span><a href="#208316" title="RedBlack.this.Tree[B]">b</a>, <a href="#208323" title="RedBlack.this.Tree[B]">c</a><span class="delimiter">)</span> <span title="RedBlack.this.Tree[B]" class="keyword">match</span> <span class="delimiter">{</span>
            <span class="keyword">case</span> <span title="RedBlack.this.RedTree[B]">RedTree</span><span class="delimiter">(</span><a title="A" id="208329">z</a>, <a title="B" id="208330">zv</a>, <a title="RedBlack.this.Tree[B]" id="208331">bb</a>, <a title="RedBlack.this.Tree[B]" id="208332">cc</a><span class="delimiter">)</span> =&gt; <a href="#207005" title="(key: A, value: B, left: RedBlack.this.Tree[B], right: RedBlack.this.Tree[B])RedBlack.this.RedTree[B]">RedTree</a><span class="delimiter">(</span><a href="#208329" title="A">z</a>, <a href="#208330" title="B">zv</a>, <a href="#207104" title="(key: A, value: B, left: RedBlack.this.Tree[B], right: RedBlack.this.Tree[B])RedBlack.this.BlackTree[B]">BlackTree</a><span class="delimiter">(</span><a href="#208313" title="A">x</a>, <a href="#208314" title="B">xv</a>, <a href="#208315" title="RedBlack.this.Tree[B]">a</a>, <a href="#208331" title="RedBlack.this.Tree[B]">bb</a><span class="delimiter">)</span>, <a href="#207104" title="(key: A, value: B, left: RedBlack.this.Tree[B], right: RedBlack.this.Tree[B])RedBlack.this.BlackTree[B]">BlackTree</a><span class="delimiter">(</span><a href="#208321" title="A">y</a>, <a href="#208322" title="B">yv</a>, <a href="#208332" title="RedBlack.this.Tree[B]">cc</a>, <a href="#208324" title="RedBlack.this.Tree[B]">d</a><span class="delimiter">)</span><span class="delimiter">)</span>
            <span class="keyword">case</span> <a title="&lt;none&gt; extends RedBlack.this.NonEmpty[B] with Product" id="208360">bc</a> =&gt; <a href="#207650" title="(x: A, xv: B, tl: RedBlack.this.Tree[B], tr: RedBlack.this.Tree[B])RedBlack.this.NonEmpty[B] with Product">balLeft</a><span class="delimiter">(</span><a href="#208313" title="A">x</a>, <a href="#208314" title="B">xv</a>, <a href="#208315" title="RedBlack.this.Tree[B]">a</a>, <a href="#207104" title="(key: A, value: B, left: RedBlack.this.Tree[B], right: RedBlack.this.Tree[B])RedBlack.this.BlackTree[B]">BlackTree</a><span class="delimiter">(</span><a href="#208321" title="A">y</a>, <a href="#208322" title="B">yv</a>, <a href="#208360" title="RedBlack.this.Tree[B]">bc</a>, <a href="#208324" title="RedBlack.this.Tree[B]">d</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <span class="delimiter">}</span>
        <span class="keyword">case</span> <span title="RedBlack.this.RedTree[B]" class="delimiter">(</span><a title="RedBlack.this.Tree[B]" id="208372">a</a>, RedTree<span class="delimiter">(</span><a title="A" id="208377">x</a>, <a title="B" id="208378">xv</a>, <a title="RedBlack.this.Tree[B]" id="208379">b</a>, <a title="RedBlack.this.Tree[B]" id="208380">c</a><span class="delimiter">)</span><span class="delimiter">)</span> =&gt; <a href="#207005" title="(key: A, value: B, left: RedBlack.this.Tree[B], right: RedBlack.this.Tree[B])RedBlack.this.RedTree[B]">RedTree</a><span class="delimiter">(</span><a href="#208377" title="A">x</a>, <a href="#208378" title="B">xv</a>, <a href="#207654" title="(tl: RedBlack.this.Tree[B], tr: RedBlack.this.Tree[B])RedBlack.this.Tree[B]">append</a><span class="delimiter">(</span><a href="#208372" title="RedBlack.this.Tree[B]">a</a>, <a href="#208379" title="RedBlack.this.Tree[B]">b</a><span class="delimiter">)</span>, <a href="#208380" title="RedBlack.this.Tree[B]">c</a><span class="delimiter">)</span>
        <span class="keyword">case</span> <span title="RedBlack.this.RedTree[B]" class="delimiter">(</span>RedTree<span class="delimiter">(</span><a title="A" id="208396">x</a>, <a title="B" id="208397">xv</a>, <a title="RedBlack.this.Tree[B]" id="208398">a</a>, <a title="RedBlack.this.Tree[B]" id="208399">b</a><span class="delimiter">)</span>, <a title="RedBlack.this.Tree[B]" id="208400">c</a><span class="delimiter">)</span> =&gt; <a href="#207005" title="(key: A, value: B, left: RedBlack.this.Tree[B], right: RedBlack.this.Tree[B])RedBlack.this.RedTree[B]">RedTree</a><span class="delimiter">(</span><a href="#208396" title="A">x</a>, <a href="#208397" title="B">xv</a>, <a href="#208398" title="RedBlack.this.Tree[B]">a</a>, <a href="#207654" title="(tl: RedBlack.this.Tree[B], tr: RedBlack.this.Tree[B])RedBlack.this.Tree[B]">append</a><span class="delimiter">(</span><a href="#208399" title="RedBlack.this.Tree[B]">b</a>, <a href="#208400" title="RedBlack.this.Tree[B]">c</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
      <span class="comment">// RedBlack is neither A : Ordering[A], nor A &lt;% Ordered[A]</span>
      <a href="#207228" title="A">k</a> <span title="RedBlack.this.Tree[B]" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <span title="&lt;none&gt; extends RedBlack.this.NonEmpty[B] with Product">_</span> <span class="keyword">if</span> <a href="#206948" title="(x: A, y: A)Boolean">isSmaller</a><span class="delimiter">(</span><a href="#207228" title="A">k</a>, <a href="#207010" title="=&gt; A">key</a><span class="delimiter">)</span> =&gt; <a href="#207652" title="=&gt; RedBlack.this.NonEmpty[B] with Product">delLeft</a>
        <span class="keyword">case</span> <span title="&lt;none&gt; extends RedBlack.this.NonEmpty[B] with Product">_</span> <span class="keyword">if</span> <a href="#206948" title="(x: A, y: A)Boolean">isSmaller</a><span class="delimiter">(</span><a href="#207010" title="=&gt; A">key</a>, <a href="#207228" title="A">k</a><span class="delimiter">)</span> =&gt; <a href="#207653" title="=&gt; RedBlack.this.NonEmpty[B] with Product">delRight</a>
        <span class="keyword">case</span> <span title="RedBlack.this.Tree[B]">_</span> =&gt; <a href="#207654" title="(tl: RedBlack.this.Tree[B], tr: RedBlack.this.Tree[B])RedBlack.this.Tree[B]">append</a><span class="delimiter">(</span><a href="#207012" title="=&gt; RedBlack.this.Tree[B]">left</a>, <a href="#207013" title="=&gt; RedBlack.this.Tree[B]">right</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="=&gt; RedBlack.this.NonEmpty[B]" id="207025">smallest</a>: <a href="#206957" title="RedBlack.this.NonEmpty[B]">NonEmpty</a><span class="delimiter">[</span>B<span class="delimiter">]</span> = <span title="RedBlack.this.NonEmpty[B]" class="keyword">if</span> <span class="delimiter">(</span><a href="#207012" title="=&gt; RedBlack.this.Tree[B]">left</a>.<a href="#206977" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <a href="#206957" title="RedBlack.this.NonEmpty[B]" class="keyword">this</a> <span class="keyword">else</span> <a href="#207012" title="=&gt; RedBlack.this.Tree[B]">left</a>.<a href="#206998" title="=&gt; RedBlack.this.NonEmpty[B]">smallest</a>

    <span class="keyword">def</span> <a title="=&gt; scala.collection.immutable.Stream[(A, B)]" id="207026">toStream</a>: <a href="Stream.scala.html#13249" title="scala.collection.immutable.Stream[(A, B)]">Stream</a><span class="delimiter">[</span><span class="delimiter">(</span>A,B<span class="delimiter">)</span><span class="delimiter">]</span> =
      <a href="#207012" title="=&gt; RedBlack.this.Tree[B]">left</a>.<a href="#206991" title="=&gt; scala.collection.immutable.Stream[(A, B)]">toStream</a> <a href="Stream.scala.html#116426" title="(that: scala.collection.GenTraversableOnce[(A, B)])(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.Stream[(A, B)],(A, B),scala.collection.immutable.Stream[(A, B)]])scala.collection.immutable.Stream[(A, B)]">++</a> <a href="Stream.scala.html#127712" title="(xs: (A, B)*)scala.collection.immutable.Stream[(A, B)]">Stream</a><span class="delimiter">(</span><a href="../../Tuple2.scala.html#53390" title="(_1: A, _2: B)(A, B)" class="delimiter">(</a><a href="#207010" title="=&gt; A">key</a>,<a href="#207011" title="=&gt; B">value</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="Stream.scala.html#116426" title="(that: scala.collection.GenTraversableOnce[(A, B)])(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.Stream[(A, B)],(A, B),scala.collection.immutable.Stream[(A, B)]])scala.collection.immutable.Stream[(A, B)]">++</a> <a href="#207013" title="=&gt; RedBlack.this.Tree[B]">right</a>.<a href="#206991" title="=&gt; scala.collection.immutable.Stream[(A, B)]">toStream</a>

    <span class="keyword">def</span> <a title="=&gt; Iterator[(A, B)]" id="207027">iterator</a>: <a href="../Iterator.scala.html#8783" title="Iterator[(A, B)]">Iterator</a><span class="delimiter">[</span><span class="delimiter">(</span>A, B<span class="delimiter">)</span><span class="delimiter">]</span> =
      <a href="#207012" title="=&gt; RedBlack.this.Tree[B]">left</a>.<a href="#206992" title="=&gt; Iterator[(A, B)]">iterator</a> <a href="../Iterator.scala.html#59118" title="(that: =&gt; scala.collection.GenTraversableOnce[(A, B)])Iterator[(A, B)]">++</a> <a href="../Iterator.scala.html#8784" title="object Iterator">Iterator</a>.<a href="../Iterator.scala.html#71475" title="(elem: (A, B))java.lang.Object with Iterator[(A, B)]">single</a><span class="delimiter">(</span><a href="../../Predef.scala.html#57855" title="(x: A, y: B)(A, B)">Pair</a><span class="delimiter">(</span><a href="#207010" title="=&gt; A">key</a>, <a href="#207011" title="=&gt; B">value</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../Iterator.scala.html#59118" title="(that: =&gt; scala.collection.GenTraversableOnce[(A, B)])Iterator[(A, B)]">++</a> <a href="#207013" title="=&gt; RedBlack.this.Tree[B]">right</a>.<a href="#206992" title="=&gt; Iterator[(A, B)]">iterator</a>

    <span class="keyword">def</span> <a title="[U](f: (A, B) =&gt; U)Unit" id="207028">foreach</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="207030">U</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="(A, B) =&gt; U" id="207286">f</a>: <span class="delimiter">(</span>A, B<span class="delimiter">)</span> =&gt; U<span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#207012" title="=&gt; RedBlack.this.Tree[B]">left</a> <a href="#206985" title="(f: (A, B) =&gt; U)Unit">foreach</a> <a href="#207286" title="(A, B) =&gt; U">f</a>
      <a href="../../Function2.scala.html#59852" title="(v1: A, v2: B)U">f</a><span class="delimiter">(</span><a href="#207010" title="=&gt; A">key</a>, <a href="#207011" title="=&gt; B">value</a><span class="delimiter">)</span>
      <a href="#207013" title="=&gt; RedBlack.this.Tree[B]">right</a> <a href="#206985" title="(f: (A, B) =&gt; U)Unit">foreach</a> <a href="#207286" title="(A, B) =&gt; U">f</a>
    <span class="delimiter">}</span>

    @deprecated<span class="delimiter">(</span><span class="string">&quot;use `foreach' instead&quot;</span>, <span class="string">&quot;2.8.0&quot;</span><span class="delimiter">)</span>
    <span class="keyword">def</span> <a title="[T](input: T)(f: (T, A, B) =&gt; (Boolean, T))(Boolean, T)" id="207031">visit</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="207033">T</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="T" id="207269">input</a>: <a href="#207033" title="T">T</a><span class="delimiter">)</span><span class="delimiter">(</span><a title="(T, A, B) =&gt; (Boolean, T)" id="207270">f</a>: <span class="delimiter">(</span>T,A,B<span class="delimiter">)</span> =&gt; <span class="delimiter">(</span>Boolean, T<span class="delimiter">)</span><span class="delimiter">)</span>: <a href="../../Tuple2.scala.html#1520" title="(Boolean, T)" class="delimiter">(</a>Boolean, T<span class="delimiter">)</span> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="(Boolean, T)" id="208714">left</a> = <a href="#206957" title="NonEmpty.this.type" class="keyword">this</a>.<a href="#207012" title="=&gt; RedBlack.this.Tree[B]">left</a>.<a href="#206988" title="(input: T)(f: (T, A, B) =&gt; (Boolean, T))(Boolean, T)">visit</a><span class="delimiter">(</span><a href="#207269" title="T">input</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#207270" title="(T, A, B) =&gt; (Boolean, T)">f</a><span class="delimiter">)</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../Boolean.scala.html#55576" title="=&gt; Boolean">!</a><a href="#208714" title="(Boolean, T)">left</a>.<a href="../../Tuple2.scala.html#53402" title="=&gt; Boolean">_1</a><span class="delimiter">)</span> <span title="Nothing" class="keyword">return</span> <a href="#208714" title="(Boolean, T)">left</a>
      <span class="keyword">val</span> <a title="(Boolean, T)" id="208715">middle</a> = <a href="../../Function3.scala.html#59883" title="(v1: T, v2: A, v3: B)(Boolean, T)">f</a><span class="delimiter">(</span><a href="#208714" title="(Boolean, T)">left</a>.<a href="../../Tuple2.scala.html#53404" title="=&gt; T">_2</a>, <a href="#207010" title="=&gt; A">key</a>, <a href="#207011" title="=&gt; B">value</a><span class="delimiter">)</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../Boolean.scala.html#55576" title="=&gt; Boolean">!</a><a href="#208715" title="(Boolean, T)">middle</a>.<a href="../../Tuple2.scala.html#53402" title="=&gt; Boolean">_1</a><span class="delimiter">)</span> <span title="Nothing" class="keyword">return</span> <a href="#208715" title="(Boolean, T)">middle</a>
      <span title="Nothing" class="keyword">return</span> <a href="#206957" title="NonEmpty.this.type" class="keyword">this</a>.<a href="#207013" title="=&gt; RedBlack.this.Tree[B]">right</a>.<a href="#206988" title="(input: T)(f: (T, A, B) =&gt; (Boolean, T))(Boolean, T)">visit</a><span class="delimiter">(</span><a href="#208715" title="(Boolean, T)">middle</a>.<a href="../../Tuple2.scala.html#53404" title="=&gt; T">_2</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#207270" title="(T, A, B) =&gt; (Boolean, T)">f</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="(from: Option[A], until: Option[A])RedBlack.this.Tree[B]" id="207034">rng</a><span class="delimiter">(</span><a title="Option[A]" id="207219">from</a>: <a href="../../Option.scala.html#560" title="Option[A]">Option</a><span class="delimiter">[</span>A<span class="delimiter">]</span>, <a title="Option[A]" id="207220">until</a>: <a href="../../Option.scala.html#560" title="Option[A]">Option</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#206955" title="RedBlack.this.Tree[B]">Tree</a><span class="delimiter">[</span>B<span class="delimiter">]</span> = <span class="delimiter">{</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#207219" title="Option[A]">from</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../Option.scala.html#1737" title="object None">None</a> <a href="../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#207220" title="Option[A]">until</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../Option.scala.html#1737" title="object None">None</a><span class="delimiter">)</span> <span title="Nothing" class="keyword">return</span> <a href="#206957" title="RedBlack.this.NonEmpty[B]" class="keyword">this</a>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#207219" title="Option[A]">from</a> <span title="(x$1: AnyRef)Boolean">!=</span> <a href="../../Option.scala.html#1737" title="object None">None</a> <a href="../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#206948" title="(x: A, y: A)Boolean">isSmaller</a><span class="delimiter">(</span><a href="#207010" title="=&gt; A">key</a>, <a href="#207219" title="Option[A]">from</a>.<a href="../../Option.scala.html#48473" title="=&gt; A">get</a><span class="delimiter">)</span><span class="delimiter">)</span> <span title="Nothing" class="keyword">return</span> <a href="#207013" title="=&gt; RedBlack.this.Tree[B]">right</a>.<a href="#206999" title="(from: Option[A], until: Option[A])RedBlack.this.Tree[B]">rng</a><span class="delimiter">(</span><a href="#207219" title="Option[A]">from</a>, <a href="#207220" title="Option[A]">until</a><span class="delimiter">)</span>;
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#207220" title="Option[A]">until</a> <span title="(x$1: AnyRef)Boolean">!=</span> <a href="../../Option.scala.html#1737" title="object None">None</a> <a href="../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a> <span class="delimiter">(</span><a href="#206948" title="(x: A, y: A)Boolean">isSmaller</a><span class="delimiter">(</span><a href="#207220" title="Option[A]">until</a>.<a href="../../Option.scala.html#48473" title="=&gt; A">get</a>,<a href="#207010" title="=&gt; A">key</a><span class="delimiter">)</span> <a href="../../Boolean.scala.html#55579" title="(x: Boolean)Boolean">||</a> <a href="../../Boolean.scala.html#55576" title="=&gt; Boolean">!</a><a href="#206948" title="(x: A, y: A)Boolean">isSmaller</a><span class="delimiter">(</span><a href="#207010" title="=&gt; A">key</a>,<a href="#207220" title="Option[A]">until</a>.<a href="../../Option.scala.html#48473" title="=&gt; A">get</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
        <span title="Nothing" class="keyword">return</span> <a href="#207012" title="=&gt; RedBlack.this.Tree[B]">left</a>.<a href="#206999" title="(from: Option[A], until: Option[A])RedBlack.this.Tree[B]">rng</a><span class="delimiter">(</span><a href="#207219" title="Option[A]">from</a>, <a href="#207220" title="Option[A]">until</a><span class="delimiter">)</span>;
      <span class="keyword">val</span> <a title="RedBlack.this.Tree[B]" id="208734">newLeft</a> = <a href="#207012" title="=&gt; RedBlack.this.Tree[B]">left</a>.<a href="#206999" title="(from: Option[A], until: Option[A])RedBlack.this.Tree[B]">rng</a><span class="delimiter">(</span><a href="#207219" title="Option[A]">from</a>, <a href="../../Option.scala.html#1737" title="object None">None</a><span class="delimiter">)</span>
      <span class="keyword">val</span> <a title="RedBlack.this.Tree[B]" id="208735">newRight</a> = <a href="#207013" title="=&gt; RedBlack.this.Tree[B]">right</a>.<a href="#206999" title="(from: Option[A], until: Option[A])RedBlack.this.Tree[B]">rng</a><span class="delimiter">(</span><a href="../../Option.scala.html#1737" title="object None">None</a>, <a href="#207220" title="Option[A]">until</a><span class="delimiter">)</span>
      <span title="RedBlack.this.Tree[B]" class="keyword">if</span> <span class="delimiter">(</span><span class="delimiter">(</span><a href="#208734" title="RedBlack.this.Tree[B]">newLeft</a> <span title="(x$1: AnyRef)Boolean">eq</span> <a href="#207012" title="=&gt; RedBlack.this.Tree[B]">left</a><span class="delimiter">)</span> <a href="../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a> <span class="delimiter">(</span><a href="#208735" title="RedBlack.this.Tree[B]">newRight</a> <span title="(x$1: AnyRef)Boolean">eq</span> <a href="#207013" title="=&gt; RedBlack.this.Tree[B]">right</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="#206957" title="RedBlack.this.NonEmpty[B]" class="keyword">this</a>
      <span class="keyword">else</span> <span title="RedBlack.this.Tree[B]" class="keyword">if</span> <span class="delimiter">(</span><a href="#208734" title="RedBlack.this.Tree[B]">newLeft</a> <span title="(x$1: AnyRef)Boolean">eq</span> <a href="#209193" title="object RedBlack.this.Empty">Empty</a><span class="delimiter">)</span> <a href="#208735" title="RedBlack.this.Tree[B]">newRight</a>.<a href="#206994" title="(k: A, v: B)RedBlack.this.Tree[B]">upd</a><span class="delimiter">(</span><a href="#207010" title="=&gt; A">key</a>, <a href="#207011" title="=&gt; B">value</a><span class="delimiter">)</span>;
      <span class="keyword">else</span> <span title="RedBlack.this.Tree[B]" class="keyword">if</span> <span class="delimiter">(</span><a href="#208735" title="RedBlack.this.Tree[B]">newRight</a> <span title="(x$1: AnyRef)Boolean">eq</span> <a href="#209193" title="object RedBlack.this.Empty">Empty</a><span class="delimiter">)</span> <a href="#208734" title="RedBlack.this.Tree[B]">newLeft</a>.<a href="#206994" title="(k: A, v: B)RedBlack.this.Tree[B]">upd</a><span class="delimiter">(</span><a href="#207010" title="=&gt; A">key</a>, <a href="#207011" title="=&gt; B">value</a><span class="delimiter">)</span>;
      <span class="keyword">else</span> <a href="#207036" title="(newLeft: RedBlack.this.Tree[B], newRight: RedBlack.this.Tree[B])RedBlack.this.Tree[B]">rebalance</a><span class="delimiter">(</span><a href="#208734" title="RedBlack.this.Tree[B]">newLeft</a>, <a href="#208735" title="RedBlack.this.Tree[B]">newRight</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="comment">// The zipper returned might have been traversed left-most (always the left child)</span>
    <span class="comment">// or right-most (always the right child). Left trees are traversed right-most,</span>
    <span class="comment">// and right trees are traversed leftmost.</span>

    <span class="comment">// Returns the zipper for the side with deepest black nodes depth, a flag</span>
    <span class="comment">// indicating whether the trees were unbalanced at all, and a flag indicating</span>
    <span class="comment">// whether the zipper was traversed left-most or right-most.</span>

    <span class="comment">// If the trees were balanced, returns an empty zipper</span>
    <span class="keyword">private</span><span class="delimiter">[</span><span class="keyword">this</span><span class="delimiter">]</span> <span class="keyword">def</span> <a title="(left: RedBlack.this.Tree[B], right: RedBlack.this.Tree[B])(List[RedBlack.this.NonEmpty[B]], Boolean, Boolean, Int)" id="207035">compareDepth</a><span class="delimiter">(</span><a title="RedBlack.this.Tree[B]" id="208808">left</a>: <a href="#206955" title="RedBlack.this.Tree[B]">Tree</a><span class="delimiter">[</span>B<span class="delimiter">]</span>, <a title="RedBlack.this.Tree[B]" id="208809">right</a>: <a href="#206955" title="RedBlack.this.Tree[B]">Tree</a><span class="delimiter">[</span>B<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../Tuple4.scala.html#1781" title="(List[RedBlack.this.NonEmpty[B]], Boolean, Boolean, Int)" class="delimiter">(</a>List<span class="delimiter">[</span>NonEmpty<span class="delimiter">[</span>B<span class="delimiter">]</span><span class="delimiter">]</span>, Boolean, Boolean, Int<span class="delimiter">)</span> = <span class="delimiter">{</span>
      <span class="comment">// Once a side is found to be deeper, unzip it to the bottom</span>
      <span class="keyword">def</span> <a title="(zipper: List[RedBlack.this.NonEmpty[B]], leftMost: Boolean)List[RedBlack.this.NonEmpty[B]]" id="208914">unzip</a><span class="delimiter">(</span><a title="List[RedBlack.this.NonEmpty[B]]" id="208916">zipper</a>: <a href="List.scala.html#14047" title="List[RedBlack.this.NonEmpty[B]]">List</a><span class="delimiter">[</span>NonEmpty<span class="delimiter">[</span>B<span class="delimiter">]</span><span class="delimiter">]</span>, <a title="Boolean" id="208917">leftMost</a>: <a href="../../Boolean.scala.html#65" title="Boolean">Boolean</a><span class="delimiter">)</span>: <a href="List.scala.html#14047" title="List[RedBlack.this.NonEmpty[B]]">List</a><span class="delimiter">[</span>NonEmpty<span class="delimiter">[</span>B<span class="delimiter">]</span><span class="delimiter">]</span> = <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="RedBlack.this.Tree[B]" id="208918">next</a> = <span title="RedBlack.this.Tree[B]" class="keyword">if</span> <span class="delimiter">(</span><a href="#208917" title="Boolean">leftMost</a><span class="delimiter">)</span> <a href="#208916" title="List[RedBlack.this.NonEmpty[B]]">zipper</a>.<a href="../IterableLike.scala.html#53870" title="=&gt; RedBlack.this.NonEmpty[B]">head</a>.<a href="#207012" title="=&gt; RedBlack.this.Tree[B]">left</a> <span class="keyword">else</span> <a href="#208916" title="List[RedBlack.this.NonEmpty[B]]">zipper</a>.<a href="../IterableLike.scala.html#53870" title="=&gt; RedBlack.this.NonEmpty[B]">head</a>.<a href="#207013" title="=&gt; RedBlack.this.Tree[B]">right</a>
        <a href="#208918" title="RedBlack.this.Tree[B]">next</a> <span title="List[RedBlack.this.NonEmpty[B]]" class="keyword">match</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> <a title="List[RedBlack.this.NonEmpty[B]]" id="208919">node</a>: <a href="#206957" title="RedBlack.this.NonEmpty[_]">NonEmpty</a><span class="delimiter">[</span>_<span class="delimiter">]</span> =&gt; <a href="#208914" title="(zipper: List[RedBlack.this.NonEmpty[B]], leftMost: Boolean)List[RedBlack.this.NonEmpty[B]]">unzip</a><span class="delimiter">(</span><a href="#208919" title="RedBlack.this.NonEmpty[_]">node</a> <a href="List.scala.html#49140" title="(x: RedBlack.this.NonEmpty[B])List[RedBlack.this.NonEmpty[B]]">::</a> <a href="#208916" title="List[RedBlack.this.NonEmpty[B]]">zipper</a>, <a href="#208917" title="Boolean">leftMost</a><span class="delimiter">)</span>
          <span class="keyword">case</span> <a href="#209193" title="List[RedBlack.this.NonEmpty[B]]">Empty</a>             =&gt; <a href="#208916" title="List[RedBlack.this.NonEmpty[B]]">zipper</a>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>

      <span class="comment">// Unzip left tree on the rightmost side and right tree on the leftmost side until one is</span>
      <span class="comment">// found to be deeper, or the bottom is reached</span>
      <span class="keyword">def</span> <a title="(left: RedBlack.this.Tree[B], right: RedBlack.this.Tree[B], leftZipper: List[RedBlack.this.NonEmpty[B]], rightZipper: List[RedBlack.this.NonEmpty[B]], smallerDepth: Int)(List[RedBlack.this.NonEmpty[B]], Boolean, Boolean, Int)" id="208915">unzipBoth</a><span class="delimiter">(</span><a title="RedBlack.this.Tree[B]" id="208927">left</a>: <a href="#206955" title="RedBlack.this.Tree[B]">Tree</a><span class="delimiter">[</span>B<span class="delimiter">]</span>,
                    <a title="RedBlack.this.Tree[B]" id="208928">right</a>: <a href="#206955" title="RedBlack.this.Tree[B]">Tree</a><span class="delimiter">[</span>B<span class="delimiter">]</span>,
                    <a title="List[RedBlack.this.NonEmpty[B]]" id="208929">leftZipper</a>: <a href="List.scala.html#14047" title="List[RedBlack.this.NonEmpty[B]]">List</a><span class="delimiter">[</span>NonEmpty<span class="delimiter">[</span>B<span class="delimiter">]</span><span class="delimiter">]</span>,
                    <a title="List[RedBlack.this.NonEmpty[B]]" id="208930">rightZipper</a>: <a href="List.scala.html#14047" title="List[RedBlack.this.NonEmpty[B]]">List</a><span class="delimiter">[</span>NonEmpty<span class="delimiter">[</span>B<span class="delimiter">]</span><span class="delimiter">]</span>,
                    <a title="Int" id="208931">smallerDepth</a>: <a href="../../Int.scala.html#386" title="Int">Int</a><span class="delimiter">)</span>: <a href="../../Tuple4.scala.html#1781" title="(List[RedBlack.this.NonEmpty[B]], Boolean, Boolean, Int)" class="delimiter">(</a>List<span class="delimiter">[</span>NonEmpty<span class="delimiter">[</span>B<span class="delimiter">]</span><span class="delimiter">]</span>, Boolean, Boolean, Int<span class="delimiter">)</span> = <a href="../../Tuple2.scala.html#53390" title="(_1: RedBlack.this.Tree[B], _2: RedBlack.this.Tree[B])(RedBlack.this.Tree[B], RedBlack.this.Tree[B])" class="delimiter">(</a><a href="#208927" title="RedBlack.this.Tree[B]">left</a>, <a href="#208928" title="RedBlack.this.Tree[B]">right</a><span class="delimiter">)</span> <span title="(List[RedBlack.this.NonEmpty[B]], Boolean, Boolean, Int)" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <span title="(List[RedBlack.this.NonEmpty[B]], Boolean, Boolean, Int)" class="delimiter">(</span><a title="RedBlack.this.BlackTree[B]" id="208940">l</a> @ BlackTree<span class="delimiter">(</span>_, _, _, _<span class="delimiter">)</span>, <a title="RedBlack.this.BlackTree[B]" id="208945">r</a> @ BlackTree<span class="delimiter">(</span>_, _, _, _<span class="delimiter">)</span><span class="delimiter">)</span> =&gt;
          <a href="#208915" title="(left: RedBlack.this.Tree[B], right: RedBlack.this.Tree[B], leftZipper: List[RedBlack.this.NonEmpty[B]], rightZipper: List[RedBlack.this.NonEmpty[B]], smallerDepth: Int)(List[RedBlack.this.NonEmpty[B]], Boolean, Boolean, Int)">unzipBoth</a><span class="delimiter">(</span><a href="#208940" title="RedBlack.this.BlackTree[B]">l</a>.<a href="#207130" title="=&gt; RedBlack.this.Tree[B]">right</a>, <a href="#208945" title="RedBlack.this.BlackTree[B]">r</a>.<a href="#207129" title="=&gt; RedBlack.this.Tree[B]">left</a>, <a href="#208940" title="RedBlack.this.BlackTree[B]">l</a> <a href="List.scala.html#49140" title="(x: RedBlack.this.NonEmpty[B])List[RedBlack.this.NonEmpty[B]]">::</a> <a href="#208929" title="List[RedBlack.this.NonEmpty[B]]">leftZipper</a>, <a href="#208945" title="RedBlack.this.BlackTree[B]">r</a> <a href="List.scala.html#49140" title="(x: RedBlack.this.NonEmpty[B])List[RedBlack.this.NonEmpty[B]]">::</a> <a href="#208930" title="List[RedBlack.this.NonEmpty[B]]">rightZipper</a>, <a href="#208931" title="Int">smallerDepth</a> <a href="../../Int.scala.html#54804" title="(x: Int)Int">+</a> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
        <span class="keyword">case</span> <span title="(List[RedBlack.this.NonEmpty[B]], Boolean, Boolean, Int)" class="delimiter">(</span><a title="RedBlack.this.RedTree[B]" id="208968">l</a> @ RedTree<span class="delimiter">(</span>_, _, _, _<span class="delimiter">)</span>, <a title="RedBlack.this.RedTree[B]" id="208973">r</a> @ RedTree<span class="delimiter">(</span>_, _, _, _<span class="delimiter">)</span><span class="delimiter">)</span> =&gt;
          <a href="#208915" title="(left: RedBlack.this.Tree[B], right: RedBlack.this.Tree[B], leftZipper: List[RedBlack.this.NonEmpty[B]], rightZipper: List[RedBlack.this.NonEmpty[B]], smallerDepth: Int)(List[RedBlack.this.NonEmpty[B]], Boolean, Boolean, Int)">unzipBoth</a><span class="delimiter">(</span><a href="#208968" title="RedBlack.this.RedTree[B]">l</a>.<a href="#207165" title="=&gt; RedBlack.this.Tree[B]">right</a>, <a href="#208973" title="RedBlack.this.RedTree[B]">r</a>.<a href="#207164" title="=&gt; RedBlack.this.Tree[B]">left</a>, <a href="#208968" title="RedBlack.this.RedTree[B]">l</a> <a href="List.scala.html#49140" title="(x: RedBlack.this.NonEmpty[B])List[RedBlack.this.NonEmpty[B]]">::</a> <a href="#208929" title="List[RedBlack.this.NonEmpty[B]]">leftZipper</a>, <a href="#208973" title="RedBlack.this.RedTree[B]">r</a> <a href="List.scala.html#49140" title="(x: RedBlack.this.NonEmpty[B])List[RedBlack.this.NonEmpty[B]]">::</a> <a href="#208930" title="List[RedBlack.this.NonEmpty[B]]">rightZipper</a>, <a href="#208931" title="Int">smallerDepth</a><span class="delimiter">)</span>
        <span class="keyword">case</span> <span title="(List[RedBlack.this.NonEmpty[B]], Boolean, Boolean, Int)" class="delimiter">(</span>_, <a title="RedBlack.this.RedTree[B]" id="208992">r</a> @ RedTree<span class="delimiter">(</span>_, _, _, _<span class="delimiter">)</span><span class="delimiter">)</span> =&gt;
          <a href="#208915" title="(left: RedBlack.this.Tree[B], right: RedBlack.this.Tree[B], leftZipper: List[RedBlack.this.NonEmpty[B]], rightZipper: List[RedBlack.this.NonEmpty[B]], smallerDepth: Int)(List[RedBlack.this.NonEmpty[B]], Boolean, Boolean, Int)">unzipBoth</a><span class="delimiter">(</span><a href="#208927" title="RedBlack.this.Tree[B]">left</a>, <a href="#208992" title="RedBlack.this.RedTree[B]">r</a>.<a href="#207164" title="=&gt; RedBlack.this.Tree[B]">left</a>, <a href="#208929" title="List[RedBlack.this.NonEmpty[B]]">leftZipper</a>, <a href="#208992" title="RedBlack.this.RedTree[B]">r</a> <a href="List.scala.html#49140" title="(x: RedBlack.this.NonEmpty[B])List[RedBlack.this.NonEmpty[B]]">::</a> <a href="#208930" title="List[RedBlack.this.NonEmpty[B]]">rightZipper</a>, <a href="#208931" title="Int">smallerDepth</a><span class="delimiter">)</span>
        <span class="keyword">case</span> <span title="(List[RedBlack.this.NonEmpty[B]], Boolean, Boolean, Int)" class="delimiter">(</span><a title="RedBlack.this.RedTree[B]" id="209003">l</a> @ RedTree<span class="delimiter">(</span>_, _, _, _<span class="delimiter">)</span>, _<span class="delimiter">)</span> =&gt;
          <a href="#208915" title="(left: RedBlack.this.Tree[B], right: RedBlack.this.Tree[B], leftZipper: List[RedBlack.this.NonEmpty[B]], rightZipper: List[RedBlack.this.NonEmpty[B]], smallerDepth: Int)(List[RedBlack.this.NonEmpty[B]], Boolean, Boolean, Int)">unzipBoth</a><span class="delimiter">(</span><a href="#209003" title="RedBlack.this.RedTree[B]">l</a>.<a href="#207165" title="=&gt; RedBlack.this.Tree[B]">right</a>, <a href="#208928" title="RedBlack.this.Tree[B]">right</a>, <a href="#209003" title="RedBlack.this.RedTree[B]">l</a> <a href="List.scala.html#49140" title="(x: RedBlack.this.NonEmpty[B])List[RedBlack.this.NonEmpty[B]]">::</a> <a href="#208929" title="List[RedBlack.this.NonEmpty[B]]">leftZipper</a>, <a href="#208930" title="List[RedBlack.this.NonEmpty[B]]">rightZipper</a>, <a href="#208931" title="Int">smallerDepth</a><span class="delimiter">)</span>
        <span class="keyword">case</span> <span title="(scala.collection.immutable.Nil.type, Boolean, Boolean, Int)" class="delimiter">(</span><a href="#209193" title="object RedBlack.this.Empty">Empty</a>, <a href="#209193" title="object RedBlack.this.Empty">Empty</a><span class="delimiter">)</span> =&gt;
          <a href="../../Tuple4.scala.html#53216" title="(_1: scala.collection.immutable.Nil.type, _2: Boolean, _3: Boolean, _4: Int)(scala.collection.immutable.Nil.type, Boolean, Boolean, Int)" class="delimiter">(</a><a href="List.scala.html#13700" title="object Nil">Nil</a>, <span title="Boolean(true)" class="keyword">true</span>, <span title="Boolean(false)" class="keyword">false</span>, <a href="#208931" title="Int">smallerDepth</a><span class="delimiter">)</span>
        <span class="keyword">case</span> <span title="(List[RedBlack.this.NonEmpty[B]], Boolean, Boolean, Int)" class="delimiter">(</span><a href="#209193" title="object RedBlack.this.Empty">Empty</a>, <a title="RedBlack.this.BlackTree[B]" id="209030">r</a> @ BlackTree<span class="delimiter">(</span>_, _, _, _<span class="delimiter">)</span><span class="delimiter">)</span> =&gt;
          <span class="keyword">val</span> <a title="Boolean" id="209035">leftMost</a> = <span title="Boolean(true)" class="keyword">true</span>
          <a href="../../Tuple4.scala.html#53216" title="(_1: List[RedBlack.this.NonEmpty[B]], _2: Boolean, _3: Boolean, _4: Int)(List[RedBlack.this.NonEmpty[B]], Boolean, Boolean, Int)" class="delimiter">(</a><a href="#208914" title="(zipper: List[RedBlack.this.NonEmpty[B]], leftMost: Boolean)List[RedBlack.this.NonEmpty[B]]">unzip</a><span class="delimiter">(</span><a href="#209030" title="RedBlack.this.BlackTree[B]">r</a> <a href="List.scala.html#49140" title="(x: RedBlack.this.NonEmpty[B])List[RedBlack.this.NonEmpty[B]]">::</a> <a href="#208930" title="List[RedBlack.this.NonEmpty[B]]">rightZipper</a>, <a href="#209035" title="Boolean">leftMost</a><span class="delimiter">)</span>, <span title="Boolean(false)" class="keyword">false</span>, <a href="#209035" title="Boolean">leftMost</a>, <a href="#208931" title="Int">smallerDepth</a><span class="delimiter">)</span>
        <span class="keyword">case</span> <span title="(List[RedBlack.this.NonEmpty[B]], Boolean, Boolean, Int)" class="delimiter">(</span><a title="RedBlack.this.BlackTree[B]" id="209056">l</a> @ BlackTree<span class="delimiter">(</span>_, _, _, _<span class="delimiter">)</span>, <a href="#209193" title="object RedBlack.this.Empty">Empty</a><span class="delimiter">)</span> =&gt;
          <span class="keyword">val</span> <a title="Boolean" id="209061">leftMost</a> = <span title="Boolean(false)" class="keyword">false</span>
          <a href="../../Tuple4.scala.html#53216" title="(_1: List[RedBlack.this.NonEmpty[B]], _2: Boolean, _3: Boolean, _4: Int)(List[RedBlack.this.NonEmpty[B]], Boolean, Boolean, Int)" class="delimiter">(</a><a href="#208914" title="(zipper: List[RedBlack.this.NonEmpty[B]], leftMost: Boolean)List[RedBlack.this.NonEmpty[B]]">unzip</a><span class="delimiter">(</span><a href="#209056" title="RedBlack.this.BlackTree[B]">l</a> <a href="List.scala.html#49140" title="(x: RedBlack.this.NonEmpty[B])List[RedBlack.this.NonEmpty[B]]">::</a> <a href="#208929" title="List[RedBlack.this.NonEmpty[B]]">leftZipper</a>, <a href="#209061" title="Boolean">leftMost</a><span class="delimiter">)</span>, <span title="Boolean(false)" class="keyword">false</span>, <a href="#209061" title="Boolean">leftMost</a>, <a href="#208931" title="Int">smallerDepth</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
      <a href="#208915" title="(left: RedBlack.this.Tree[B], right: RedBlack.this.Tree[B], leftZipper: List[RedBlack.this.NonEmpty[B]], rightZipper: List[RedBlack.this.NonEmpty[B]], smallerDepth: Int)(List[RedBlack.this.NonEmpty[B]], Boolean, Boolean, Int)">unzipBoth</a><span class="delimiter">(</span><a href="#208808" title="RedBlack.this.Tree[B]">left</a>, <a href="#208809" title="RedBlack.this.Tree[B]">right</a>, <a href="List.scala.html#13700" title="object Nil">Nil</a>, <a href="List.scala.html#13700" title="object Nil">Nil</a>, <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="keyword">private</span><span class="delimiter">[</span><span class="keyword">this</span><span class="delimiter">]</span> <span class="keyword">def</span> <a title="(newLeft: RedBlack.this.Tree[B], newRight: RedBlack.this.Tree[B])RedBlack.this.Tree[B]" id="207036">rebalance</a><span class="delimiter">(</span><a title="RedBlack.this.Tree[B]" id="208768">newLeft</a>: <a href="#206955" title="RedBlack.this.Tree[B]">Tree</a><span class="delimiter">[</span>B<span class="delimiter">]</span>, <a title="RedBlack.this.Tree[B]" id="208769">newRight</a>: <a href="#206955" title="RedBlack.this.Tree[B]">Tree</a><span class="delimiter">[</span>B<span class="delimiter">]</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
      <span class="comment">// This is like drop(n-1), but only counting black nodes</span>
      <span class="keyword">def</span>  <a title="(zipper: List[RedBlack.this.NonEmpty[B]], depth: Int)List[RedBlack.this.NonEmpty[B]]" id="208772">findDepth</a><span class="delimiter">(</span><a title="List[RedBlack.this.NonEmpty[B]]" id="208780">zipper</a>: <a href="List.scala.html#14047" title="List[RedBlack.this.NonEmpty[B]]">List</a><span class="delimiter">[</span>NonEmpty<span class="delimiter">[</span>B<span class="delimiter">]</span><span class="delimiter">]</span>, <a title="Int" id="208781">depth</a>: <a href="../../Int.scala.html#386" title="Int">Int</a><span class="delimiter">)</span>: <a href="List.scala.html#14047" title="List[RedBlack.this.NonEmpty[B]]">List</a><span class="delimiter">[</span>NonEmpty<span class="delimiter">[</span>B<span class="delimiter">]</span><span class="delimiter">]</span> = <a href="#208780" title="List[RedBlack.this.NonEmpty[B]]">zipper</a> <span title="List[RedBlack.this.NonEmpty[B]]" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <span title="List[RedBlack.this.NonEmpty[B]]">BlackTree</span><span class="delimiter">(</span>_, _, _, _<span class="delimiter">)</span> :: <a title="List[RedBlack.this.NonEmpty[B]]" id="208790">tail</a> =&gt;
          <span title="List[RedBlack.this.NonEmpty[B]]" class="keyword">if</span> <span class="delimiter">(</span><a href="#208781" title="Int">depth</a> <a href="../../Int.scala.html#54747" title="(x: Int)Boolean">==</a> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span> <a href="#208780" title="List[RedBlack.this.NonEmpty[B]]">zipper</a> <span class="keyword">else</span> <a href="#208772" title="(zipper: List[RedBlack.this.NonEmpty[B]], depth: Int)List[RedBlack.this.NonEmpty[B]]">findDepth</a><span class="delimiter">(</span><a href="#208790" title="List[RedBlack.this.NonEmpty[B]]">tail</a>, <a href="#208781" title="Int">depth</a> <a href="../../Int.scala.html#54811" title="(x: Int)Int">-</a> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
        <span class="keyword">case</span> <span title="List[RedBlack.this.NonEmpty[B]]">_</span> :: <a title="List[RedBlack.this.NonEmpty[B]]" id="208801">tail</a> =&gt; <a href="#208772" title="(zipper: List[RedBlack.this.NonEmpty[B]], depth: Int)List[RedBlack.this.NonEmpty[B]]">findDepth</a><span class="delimiter">(</span><a href="#208801" title="List[RedBlack.this.NonEmpty[B]]">tail</a>, <a href="#208781" title="Int">depth</a><span class="delimiter">)</span>
        <span class="keyword">case</span> <a href="List.scala.html#13700" title="Nothing">Nil</a> =&gt; sys.<a href="../../sys/package.scala.html#48163" title="(message: String)Nothing">error</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Defect: unexpected empty zipper while computing range&quot;)" class="string">&quot;Defect: unexpected empty zipper while computing range&quot;</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>

      <span class="comment">// Blackening the smaller tree avoids balancing problems on union;</span>
      <span class="comment">// this can't be done later, though, or it would change the result of compareDepth</span>
      <span class="keyword">val</span> <a title="RedBlack.this.Tree[B]" id="208773">blkNewLeft</a> = <a href="#206949" title="(t: RedBlack.this.Tree[B])RedBlack.this.Tree[B]">blacken</a><span class="delimiter">(</span><a href="#208768" title="RedBlack.this.Tree[B]">newLeft</a><span class="delimiter">)</span>
      <span class="keyword">val</span> <a title="RedBlack.this.Tree[B]" id="208774">blkNewRight</a> = <a href="#206949" title="(t: RedBlack.this.Tree[B])RedBlack.this.Tree[B]">blacken</a><span class="delimiter">(</span><a href="#208769" title="RedBlack.this.Tree[B]">newRight</a><span class="delimiter">)</span>
      <span class="keyword">val</span> <a href="../../Tuple4.scala.html#53216" title="(List[RedBlack.this.NonEmpty[B]], Boolean, Boolean, Int)" class="delimiter">(</a><a href="../../Tuple4.scala.html#53236" title="List[RedBlack.this.NonEmpty[B]]" id="208776">zipper</a>, <a href="../../Tuple4.scala.html#53238" title="Boolean" id="208777">levelled</a>, <a href="../../Tuple4.scala.html#53240" title="Boolean" id="208778">leftMost</a>, <a href="../../Tuple4.scala.html#53242" title="Int" id="208779">smallerDepth</a><span class="delimiter">)</span> = <a href="#207035" title="(left: RedBlack.this.Tree[B], right: RedBlack.this.Tree[B])(List[RedBlack.this.NonEmpty[B]], Boolean, Boolean, Int)">compareDepth</a><a href="../../Tuple4.scala.html#1781" title="(List[RedBlack.this.NonEmpty[B]], Boolean, Boolean, Int) @unchecked" class="delimiter">(</a><a href="#208773" title="RedBlack.this.Tree[B]">blkNewLeft</a>, <a href="#208774" title="RedBlack.this.Tree[B]">blkNewRight</a><span class="delimiter">)</span>

      <span title="RedBlack.this.Tree[B]" class="keyword">if</span> <span class="delimiter">(</span><a href="#208777" title="Boolean">levelled</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#207104" title="(key: A, value: B, left: RedBlack.this.Tree[B], right: RedBlack.this.Tree[B])RedBlack.this.BlackTree[B]">BlackTree</a><span class="delimiter">(</span><a href="#207010" title="=&gt; A">key</a>, <a href="#207011" title="=&gt; B">value</a>, <a href="#208773" title="RedBlack.this.Tree[B]">blkNewLeft</a>, <a href="#208774" title="RedBlack.this.Tree[B]">blkNewRight</a><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="List[RedBlack.this.NonEmpty[B]]" id="208840">zipFrom</a> = <a href="#208772" title="(zipper: List[RedBlack.this.NonEmpty[B]], depth: Int)List[RedBlack.this.NonEmpty[B]]">findDepth</a><span class="delimiter">(</span><a href="#208776" title="List[RedBlack.this.NonEmpty[B]]">zipper</a>, <a href="#208779" title="Int">smallerDepth</a><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="RedBlack.this.RedTree[B]" id="208841">union</a> = <span title="RedBlack.this.RedTree[B]" class="keyword">if</span> <span class="delimiter">(</span><a href="#208778" title="Boolean">leftMost</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="#207005" title="(key: A, value: B, left: RedBlack.this.Tree[B], right: RedBlack.this.Tree[B])RedBlack.this.RedTree[B]">RedTree</a><span class="delimiter">(</span><a href="#207010" title="=&gt; A">key</a>, <a href="#207011" title="=&gt; B">value</a>, <a href="#208773" title="RedBlack.this.Tree[B]">blkNewLeft</a>, <a href="#208840" title="List[RedBlack.this.NonEmpty[B]]">zipFrom</a>.<a href="../IterableLike.scala.html#53870" title="=&gt; RedBlack.this.NonEmpty[B]">head</a><span class="delimiter">)</span>
        <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
          <a href="#207005" title="(key: A, value: B, left: RedBlack.this.Tree[B], right: RedBlack.this.Tree[B])RedBlack.this.RedTree[B]">RedTree</a><span class="delimiter">(</span><a href="#207010" title="=&gt; A">key</a>, <a href="#207011" title="=&gt; B">value</a>, <a href="#208840" title="List[RedBlack.this.NonEmpty[B]]">zipFrom</a>.<a href="../IterableLike.scala.html#53870" title="=&gt; RedBlack.this.NonEmpty[B]">head</a>, <a href="#208774" title="RedBlack.this.Tree[B]">blkNewRight</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
        <span class="keyword">val</span> <a title="RedBlack.this.Tree[B]" id="208842">zippedTree</a> = <a href="#208840" title="List[RedBlack.this.NonEmpty[B]]">zipFrom</a>.<a href="../TraversableLike.scala.html#49082" title="=&gt; List[RedBlack.this.NonEmpty[B]]">tail</a>.<a href="../LinearSeqOptimized.scala.html#71039" title="(z: RedBlack.this.Tree[B])(f: (RedBlack.this.Tree[B], RedBlack.this.NonEmpty[B]) =&gt; RedBlack.this.Tree[B])RedBlack.this.Tree[B]">foldLeft</a><span class="delimiter">(</span><a href="#208841" title="RedBlack.this.RedTree[B]">union</a>: <a href="#206955" title="RedBlack.this.Tree[B]">Tree</a><span class="delimiter">[</span>B<span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span> <span class="delimiter">(</span><a title="RedBlack.this.Tree[B]" id="208882">tree</a>, <a title="RedBlack.this.NonEmpty[B]" id="208883">node</a><span class="delimiter">)</span> =&gt;
            <span title="RedBlack.this.Tree[B]" class="keyword">if</span> <span class="delimiter">(</span><a href="#208778" title="Boolean">leftMost</a><span class="delimiter">)</span>
              <a href="#207015" title="(isBlack: Boolean, z: A, zv: B, l: RedBlack.this.Tree[B], d: RedBlack.this.Tree[B])RedBlack.this.NonEmpty[B] with Product">balanceLeft</a><span class="delimiter">(</span><a href="#208883" title="RedBlack.this.NonEmpty[B]">node</a>.<a href="#206978" title="=&gt; Boolean">isBlack</a>, <a href="#208883" title="RedBlack.this.NonEmpty[B]">node</a>.<a href="#207010" title="=&gt; A">key</a>, <a href="#208883" title="RedBlack.this.NonEmpty[B]">node</a>.<a href="#207011" title="=&gt; B">value</a>, <a href="#208882" title="RedBlack.this.Tree[B]">tree</a>, <a href="#208883" title="RedBlack.this.NonEmpty[B]">node</a>.<a href="#207013" title="=&gt; RedBlack.this.Tree[B]">right</a><span class="delimiter">)</span>
            <span class="keyword">else</span>
              <a href="#207018" title="(isBlack: Boolean, x: A, xv: B, a: RedBlack.this.Tree[B], r: RedBlack.this.Tree[B])RedBlack.this.NonEmpty[B] with Product">balanceRight</a><span class="delimiter">(</span><a href="#208883" title="RedBlack.this.NonEmpty[B]">node</a>.<a href="#206978" title="=&gt; Boolean">isBlack</a>, <a href="#208883" title="RedBlack.this.NonEmpty[B]">node</a>.<a href="#207010" title="=&gt; A">key</a>, <a href="#208883" title="RedBlack.this.NonEmpty[B]">node</a>.<a href="#207011" title="=&gt; B">value</a>, <a href="#208883" title="RedBlack.this.NonEmpty[B]">node</a>.<a href="#207012" title="=&gt; RedBlack.this.Tree[B]">left</a>, <a href="#208882" title="RedBlack.this.Tree[B]">tree</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
        <a href="#208842" title="RedBlack.this.Tree[B]">zippedTree</a>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
    <span class="keyword">def</span> <a title="=&gt; A" id="207037">first</a> = <span title="A" class="keyword">if</span> <span class="delimiter">(</span><a href="#207012" title="=&gt; RedBlack.this.Tree[B]">left</a> .<a href="#206977" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <a href="#207010" title="=&gt; A">key</a> <span class="keyword">else</span> <a href="#207012" title="=&gt; RedBlack.this.Tree[B]">left</a>.<a href="#207000" title="=&gt; A">first</a>
    <span class="keyword">def</span> <a title="=&gt; A" id="207038">last</a>  = <span title="A" class="keyword">if</span> <span class="delimiter">(</span><a href="#207013" title="=&gt; RedBlack.this.Tree[B]">right</a>.<a href="#206977" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <a href="#207010" title="=&gt; A">key</a> <span class="keyword">else</span> <a href="#207013" title="=&gt; RedBlack.this.Tree[B]">right</a>.<a href="#207001" title="=&gt; A">last</a>
    <span class="keyword">def</span> <a title="=&gt; Int" id="207039">count</a> = <span title="Int(1)" class="int">1</span> <a href="../../Int.scala.html#54804" title="(x: Int)Int">+</a> <a href="#207012" title="=&gt; RedBlack.this.Tree[B]">left</a>.<a href="#207002" title="=&gt; Int">count</a> <a href="../../Int.scala.html#54804" title="(x: Int)Int">+</a> <a href="#207013" title="=&gt; RedBlack.this.Tree[B]">right</a>.<a href="#207002" title="=&gt; Int">count</a>
  <span class="delimiter">}</span>
  case <span class="keyword">object</span> <a href="#209190" title="object RedBlack.this.Empty" id="209193">Empty</a> <a href="../../ScalaObject.scala.html#464" title="ScalaObject" class="keyword">extends</a> <a href="#206955" title="RedBlack.this.Tree[Nothing]">Tree</a><span class="delimiter">[</span>Nothing<span class="delimiter">]</span> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="=&gt; Boolean" id="208211">isEmpty</a> = <span title="Boolean(true)" class="keyword">true</span>
    <span class="keyword">def</span> <a title="=&gt; Boolean" id="208212">isBlack</a> = <span title="Boolean(true)" class="keyword">true</span>
    <span class="keyword">def</span> <a title="(k: A)RedBlack.this.Tree[Nothing]" id="208213">lookup</a><span class="delimiter">(</span><a title="A" id="209087">k</a>: <a href="#14363" title="A">A</a><span class="delimiter">)</span>: <a href="#206955" title="RedBlack.this.Tree[Nothing]">Tree</a><span class="delimiter">[</span>Nothing<span class="delimiter">]</span> = <span class="keyword">this</span>
    <span class="keyword">def</span> <a title="[B](k: A, v: B)RedBlack.this.Tree[B]" id="208214">upd</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="208216">B</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="A" id="209089">k</a>: <a href="#14363" title="A">A</a>, <a title="B" id="209090">v</a>: <a href="#208216" title="B">B</a><span class="delimiter">)</span>: <a href="#206955" title="RedBlack.this.Tree[B]">Tree</a><span class="delimiter">[</span>B<span class="delimiter">]</span> = <a href="#207005" title="(key: A, value: B, left: RedBlack.this.Tree[B], right: RedBlack.this.Tree[B])RedBlack.this.RedTree[B]">RedTree</a><span class="delimiter">(</span><a href="#209089" title="A">k</a>, <a href="#209090" title="B">v</a>, <a href="#209193" title="object RedBlack.this.Empty">Empty</a>, <a href="#209193" title="object RedBlack.this.Empty">Empty</a><span class="delimiter">)</span>
    <span class="keyword">def</span> <a title="(k: A)RedBlack.this.Tree[Nothing]" id="208217">del</a><span class="delimiter">(</span><a title="A" id="209110">k</a>: <a href="#14363" title="A">A</a><span class="delimiter">)</span>: <a href="#206955" title="RedBlack.this.Tree[Nothing]">Tree</a><span class="delimiter">[</span>Nothing<span class="delimiter">]</span> = <span class="keyword">this</span>
    <span class="keyword">def</span> <a title="=&gt; RedBlack.this.NonEmpty[Nothing]" id="208218">smallest</a>: <a href="#206957" title="RedBlack.this.NonEmpty[Nothing]">NonEmpty</a><span class="delimiter">[</span>Nothing<span class="delimiter">]</span> = <span title="Nothing" class="keyword">throw</span> <span title="(x$1: java.lang.String)java.util.NoSuchElementException" class="keyword">new</span> <a href="../../package.scala.html#47510" title="java.util.NoSuchElementException">NoSuchElementException</a><span class="delimiter">(</span><span title="java.lang.String(&quot;empty map&quot;)" class="string">&quot;empty map&quot;</span><span class="delimiter">)</span>
    <span class="keyword">def</span> <a title="=&gt; Iterator[(A, Nothing)]" id="208219">iterator</a>: <a href="../Iterator.scala.html#8783" title="Iterator[(A, Nothing)]">Iterator</a><span class="delimiter">[</span><span class="delimiter">(</span>A, Nothing<span class="delimiter">)</span><span class="delimiter">]</span> = <a href="../Iterator.scala.html#8784" title="object Iterator">Iterator</a>.<a href="../Iterator.scala.html#71473" title="=&gt; java.lang.Object with Iterator[Nothing]">empty</a>
    <span class="keyword">def</span> <a title="=&gt; scala.collection.immutable.Stream[(A, Nothing)]" id="208220">toStream</a>: <a href="Stream.scala.html#13249" title="scala.collection.immutable.Stream[(A, Nothing)]">Stream</a><span class="delimiter">[</span><span class="delimiter">(</span>A,Nothing<span class="delimiter">)</span><span class="delimiter">]</span> = <a href="Stream.scala.html#13250" title="object scala.collection.immutable.Stream">Stream</a>.<a href="Stream.scala.html#127709" title="scala.collection.immutable.Stream[Nothing]">empty</a>

    <span class="keyword">def</span> <a title="[U](f: (A, Nothing) =&gt; U)Unit" id="208221">foreach</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="208223">U</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="(A, Nothing) =&gt; U" id="209139">f</a>: <span class="delimiter">(</span>A, Nothing<span class="delimiter">)</span> =&gt; U<span class="delimiter">)</span> <span title="Unit" class="delimiter">{</span><span class="delimiter">}</span>

    @deprecated<span class="delimiter">(</span><span class="string">&quot;use `foreach' instead&quot;</span>, <span class="string">&quot;2.8.0&quot;</span><span class="delimiter">)</span>
    <span class="keyword">def</span> <a title="[T](input: T)(f: (T, A, Nothing) =&gt; (Boolean, T))(Boolean, T)" id="208224">visit</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="208226">T</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="T" id="209145">input</a>: <a href="#208226" title="T">T</a><span class="delimiter">)</span><span class="delimiter">(</span><a title="(T, A, Nothing) =&gt; (Boolean, T)" id="209146">f</a>: <span class="delimiter">(</span>T, A, Nothing<span class="delimiter">)</span> =&gt; <span class="delimiter">(</span>Boolean, T<span class="delimiter">)</span><span class="delimiter">)</span> = <a href="../../Tuple2.scala.html#53390" title="(_1: Boolean, _2: T)(Boolean, T)" class="delimiter">(</a><span title="Boolean(true)" class="keyword">true</span>, <a href="#209145" title="T">input</a><span class="delimiter">)</span>

    <span class="keyword">def</span> <a title="(from: Option[A], until: Option[A])RedBlack.this.Empty.type" id="208227">rng</a><span class="delimiter">(</span><a title="Option[A]" id="209168">from</a>: <a href="../../Option.scala.html#560" title="Option[A]">Option</a><span class="delimiter">[</span>A<span class="delimiter">]</span>, <a title="Option[A]" id="209169">until</a>: <a href="../../Option.scala.html#560" title="Option[A]">Option</a><span class="delimiter">[</span>A<span class="delimiter">]</span><span class="delimiter">)</span> = <span class="keyword">this</span>
    <span class="keyword">def</span> <a title="=&gt; Nothing" id="208228">first</a> = <span title="Nothing" class="keyword">throw</span> <span title="(x$1: java.lang.String)java.util.NoSuchElementException" class="keyword">new</span> <a href="../../package.scala.html#47510" title="java.util.NoSuchElementException">NoSuchElementException</a><span class="delimiter">(</span><span title="java.lang.String(&quot;empty map&quot;)" class="string">&quot;empty map&quot;</span><span class="delimiter">)</span>
    <span class="keyword">def</span> <a title="=&gt; Nothing" id="208229">last</a> = <span title="Nothing" class="keyword">throw</span> <span title="(x$1: java.lang.String)java.util.NoSuchElementException" class="keyword">new</span> <a href="../../package.scala.html#47510" title="java.util.NoSuchElementException">NoSuchElementException</a><span class="delimiter">(</span><span title="java.lang.String(&quot;empty map&quot;)" class="string">&quot;empty map&quot;</span><span class="delimiter">)</span>
    <span class="keyword">def</span> <a title="=&gt; Int" id="208230">count</a> = <span title="Int(0)" class="int">0</span>
  <span class="delimiter">}</span>
  case <span class="keyword">class</span> <a title="class RedTree[+B] extends RedBlack.this.NonEmpty[B] with ScalaObject with Product with Serializable" id="207005">RedTree</a><span class="delimiter">[</span>+<a title="&gt;: Nothing &lt;: Any" id="207007">B</a><span class="delimiter">]</span><a href="../../ScalaObject.scala.html#464" title="ScalaObject" class="delimiter">(</a><span class="keyword">override</span> <span class="keyword">val</span> <a title="A" id="207162">key</a>: <a href="#14363" title="A">A</a>,
                         <span class="keyword">override</span> <span class="keyword">val</span> <a title="B" id="207163">value</a>: <a href="#207007" title="B">B</a>,
                         <span class="keyword">override</span> <span class="keyword">val</span> <a title="RedBlack.this.Tree[B]" id="207164">left</a>: <a href="#206955" title="RedBlack.this.Tree[B]">Tree</a><span class="delimiter">[</span>B<span class="delimiter">]</span>,
                         <span class="keyword">override</span> <span class="keyword">val</span> <a title="RedBlack.this.Tree[B]" id="207165">right</a>: <a href="#206955" title="RedBlack.this.Tree[B]">Tree</a><span class="delimiter">[</span>B<span class="delimiter">]</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#206957" title="RedBlack.this.NonEmpty[B]">NonEmpty</a><span class="delimiter">[</span>B<span class="delimiter">]</span> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="=&gt; Boolean" id="207053">isBlack</a> = <span title="Boolean(false)" class="keyword">false</span>
  <span class="delimiter">}</span>
  case <span class="keyword">class</span> <a title="class BlackTree[+B] extends RedBlack.this.NonEmpty[B] with ScalaObject with Product with Serializable" id="207104">BlackTree</a><span class="delimiter">[</span>+<a title="&gt;: Nothing &lt;: Any" id="207106">B</a><span class="delimiter">]</span><a href="../../ScalaObject.scala.html#464" title="ScalaObject" class="delimiter">(</a><span class="keyword">override</span> <span class="keyword">val</span> <a title="A" id="207127">key</a>: <a href="#14363" title="A">A</a>,
                           <span class="keyword">override</span> <span class="keyword">val</span> <a title="B" id="207128">value</a>: <a href="#207106" title="B">B</a>,
                           <span class="keyword">override</span> <span class="keyword">val</span> <a title="RedBlack.this.Tree[B]" id="207129">left</a>: <a href="#206955" title="RedBlack.this.Tree[B]">Tree</a><span class="delimiter">[</span>B<span class="delimiter">]</span>,
                           <span class="keyword">override</span> <span class="keyword">val</span> <a title="RedBlack.this.Tree[B]" id="207130">right</a>: <a href="#206955" title="RedBlack.this.Tree[B]">Tree</a><span class="delimiter">[</span>B<span class="delimiter">]</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#206957" title="RedBlack.this.NonEmpty[B]">NonEmpty</a><span class="delimiter">[</span>B<span class="delimiter">]</span> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="=&gt; Boolean" id="207120">isBlack</a> = <span title="Boolean(true)" class="keyword">true</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>



        </pre>
    </body>
</html>