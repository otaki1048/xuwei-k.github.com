<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>scala/tools/nsc/util/Exceptional.scala</title>
        <script type="text/javascript" src="../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> scala.tools.nsc
<span class="keyword">package</span> util

<span class="keyword">import</span> java.util.concurrent.ExecutionException
<span class="keyword">import</span> java.lang.reflect.<span class="delimiter">{</span> InvocationTargetException, UndeclaredThrowableException <span class="delimiter">}</span>
<span class="keyword">import</span> io.<span class="delimiter">{</span> Sources, Fileish <span class="delimiter">}</span>
<span class="keyword">import</span> scala.tools.util.<a href="../../util/StringOps.scala.html#43792" title="object scala.tools.util.StringOps">StringOps</a>._

<span class="comment">/** A simple throwable wrapper so it looks more like a parade of
 *  glittering frame-shaped beauties than the other thing.
 */</span>
<span class="keyword">class</span> <a title="class Exceptional extends java.lang.Object with ScalaObject" id="42658">Exceptional</a><a href="../../../ScalaObject.scala.html#464" title="ScalaObject" class="delimiter">(</a><span class="keyword">val</span> <a title="Throwable" id="509897">ex</a>: <span title="Throwable">Throwable</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scala.tools.nsc.util.ScalaPrefs" id="509898">prefs</a>: <a href="ScalaPrefs.scala.html#43150" title="scala.tools.nsc.util.ScalaPrefs">ScalaPrefs</a><span class="delimiter">)</span> <span class="delimiter">{</span>
  <span class="keyword">val</span> <a title="scala.tools.nsc.util.Exceptional.Calibrated" id="509868">formatter</a>  = <a href="#509898" title="scala.tools.nsc.util.ScalaPrefs">prefs</a>.<a href="#988162" title="(ex: Throwable)scala.tools.nsc.util.Exceptional.Calibrated">exceptionFormatter</a><span class="delimiter">(</span><a href="#509897" title="=&gt; Throwable">ex</a><span class="delimiter">)</span>
  <span class="keyword">val</span> <a title="Throwable" id="509870">unwrapped</a>  = <a href="#42659" title="object scala.tools.nsc.util.Exceptional">Exceptional</a>.<a href="#509857" title="(x: Throwable)Throwable">unwrap</a><span class="delimiter">(</span><a href="#509897" title="=&gt; Throwable">ex</a><span class="delimiter">)</span>
  <span class="keyword">val</span> <a title="scala.tools.nsc.util.TableDef[scala.tools.nsc.util.JavaStackFrame]#Table" id="509872">table</a>      = <a href="#509868" title="=&gt; scala.tools.nsc.util.Exceptional.Calibrated">formatter</a>.<a href="#988174" title="(ex: Throwable)scala.tools.nsc.util.TableDef[scala.tools.nsc.util.JavaStackFrame]#Table">newTable</a><span class="delimiter">(</span><a href="#509870" title="=&gt; Throwable">unwrapped</a><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="()Unit" id="509874">rawTrace</a><span class="delimiter">(</span><span class="delimiter">)</span> = <a href="#509870" title="=&gt; Throwable">unwrapped</a>.<span title="()Unit">printStackTrace</span><span class="delimiter">(</span><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="=&gt; Boolean" id="509875">isScanDone</a> = <a href="#509898" title="scala.tools.nsc.util.ScalaPrefs">prefs</a>.<a href="ScalaPrefs.scala.html#509899" title="=&gt; scala.tools.nsc.io.Sources">codeSources</a>.<a href="../../../Function0.scala.html#62187" title="()Boolean">isDone</a><span class="delimiter">(</span><span class="delimiter">)</span>

  <span class="comment">/** Block until the scanning is complete. */</span>
  <span class="keyword">def</span> <a title="()Exceptional.this.type" id="509876">force</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span class="keyword">this</span>.<span class="keyword">type</span> = <span class="delimiter">{</span>
    <a href="#509898" title="scala.tools.nsc.util.ScalaPrefs">prefs</a>.<a href="ScalaPrefs.scala.html#509899" title="=&gt; scala.tools.nsc.io.Sources">codeSources</a>.<a href="../../../Function0.scala.html#62187" title="()Unit">force</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <a href="#42658" title="Exceptional.this.type" class="keyword">this</a>
  <span class="delimiter">}</span>

  <span class="comment">/** Stack frame contexts are only shown as long as this is true. */</span>
  <span class="keyword">def</span> <a title="(frame: scala.tools.nsc.util.JavaStackFrame)Boolean" id="509877">spanFn</a><span class="delimiter">(</span><a title="scala.tools.nsc.util.JavaStackFrame" id="745214">frame</a>: <a href="JavaStackFrame.scala.html#43045" title="scala.tools.nsc.util.JavaStackFrame">JavaStackFrame</a><span class="delimiter">)</span>: <a href="../../../Boolean.scala.html#65" title="Boolean">Boolean</a> = <span title="Boolean(true)" class="keyword">true</span>

  <span class="comment">/** The result of this will be printed before a context trace. */</span>
  <span class="keyword">def</span> <a title="=&gt; String" id="509878">contextPrelude</a>: <span title="String">String</span> =
    <span title="String" class="keyword">if</span> <span class="delimiter">(</span><a href="#509875" title="=&gt; Boolean">isScanDone</a><span class="delimiter">)</span> <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span>
    <span class="keyword">else</span> <span title="java.lang.String(&quot;/* Still scanning source path: there may be more momentarily. */\012&quot;)" class="string">&quot;/* Still scanning source path: there may be more momentarily. */\n&quot;</span>

  <span class="comment">/** Frames with surrounding context. */</span>
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="=&gt; List[scala.tools.nsc.util.JavaStackFrame]" id="509879">contextFrames</a>     = <a href="#509885" title="=&gt; List[scala.tools.nsc.util.JavaStackFrame]">toList</a> <a href="../../../collection/immutable/List.scala.html#49168" title="(p: scala.tools.nsc.util.JavaStackFrame =&gt; Boolean)List[scala.tools.nsc.util.JavaStackFrame]">takeWhile</a> <a href="#509877" title="(frame: scala.tools.nsc.util.JavaStackFrame)Boolean">spanFn</a>
  <span class="keyword">def</span> <a title="()String" id="509880">contextHead</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="String">String</span>     = <a href="#509881" title="()List[String]">contextElems</a>.<a href="../../../collection/TraversableLike.scala.html#49081" title="=&gt; Option[String]">headOption</a> <a href="../../../Option.scala.html#48474" title="(default: =&gt; String)String">getOrElse</a> <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span>
  <span class="keyword">def</span> <a title="()List[String]" id="509881">contextElems</a><span class="delimiter">(</span><span class="delimiter">)</span>            = <a href="#509879" title="=&gt; List[scala.tools.nsc.util.JavaStackFrame]">contextFrames</a> <a href="../../../collection/TraversableLike.scala.html#49041" title="(f: scala.tools.nsc.util.JavaStackFrame =&gt; String)(implicit bf: scala.collection.generic.CanBuildFrom[List[scala.tools.nsc.util.JavaStackFrame],String,List[String]])List[String]">map</a> <a href="#509868" title="=&gt; scala.tools.nsc.util.Exceptional.Calibrated">formatter</a>.<a href="#988175" title="(frame: scala.tools.nsc.util.JavaStackFrame)String">inContext</a>
  <span class="keyword">def</span> <a title="()String" id="509882">context</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="String">String</span>         = <a href="#509883" title="(num: Int)String">context</a><span class="delimiter">(</span><a href="#509884" title="=&gt; Int">length</a><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="(num: Int)String" id="509883">context</a><span class="delimiter">(</span><a title="Int" id="509914">num</a>: <a href="../../../Int.scala.html#386" title="Int">Int</a><span class="delimiter">)</span>: <span title="String">String</span> = <a href="#509878" title="=&gt; String">contextPrelude</a> <span title="(x$1: Any)java.lang.String">+</span> <a href="../../util/StringOps.scala.html#482647" title="(xs: Seq[String], sep: String, orElse: String)String">ojoinOr</a><span class="delimiter">(</span><a href="#509879" title="=&gt; List[scala.tools.nsc.util.JavaStackFrame]">contextFrames</a> <a href="../../../collection/immutable/List.scala.html#49163" title="(n: Int)List[scala.tools.nsc.util.JavaStackFrame]">take</a> <a href="#509914" title="Int">num</a> <a href="../../../collection/TraversableLike.scala.html#49041" title="(f: scala.tools.nsc.util.JavaStackFrame =&gt; String)(implicit bf: scala.collection.generic.CanBuildFrom[List[scala.tools.nsc.util.JavaStackFrame],String,Seq[String]])Seq[String]">map</a> <a href="#509868" title="=&gt; scala.tools.nsc.util.Exceptional.Calibrated">formatter</a>.<a href="#988175" title="(frame: scala.tools.nsc.util.JavaStackFrame)String">inContext</a>, <span title="java.lang.String(&quot;\012&quot;)" class="string">&quot;\n&quot;</span>, <span title="java.lang.String(&quot;No stack trace.&quot;)" class="string">&quot;No stack trace.&quot;</span><span class="delimiter">)</span>

  <span class="comment">/** Exceptional doesn't extend Seq because it turns out to be super
   *  annoying in the repl: tab-completion sees all the Seq methods.
   */</span>
  <span class="keyword">def</span> <a title="=&gt; Int" id="509884">length</a>            = <a href="#509885" title="=&gt; List[scala.tools.nsc.util.JavaStackFrame]">toList</a>.<a href="../../../collection/LinearSeqOptimized.scala.html#71030" title="=&gt; Int">length</a>
  <span class="keyword">def</span> <a title="=&gt; List[scala.tools.nsc.util.JavaStackFrame]" id="509885">toList</a>            = <a href="#509872" title="=&gt; scala.tools.nsc.util.TableDef[scala.tools.nsc.util.JavaStackFrame]#Table">table</a>.<a href="../../../collection/TraversableOnce.scala.html#53691" title="=&gt; List[scala.tools.nsc.util.JavaStackFrame]">toList</a>
  <span class="keyword">def</span> <a title="=&gt; Iterator[scala.tools.nsc.util.JavaStackFrame]" id="509886">iterator</a>          = <a href="#509872" title="=&gt; scala.tools.nsc.util.TableDef[scala.tools.nsc.util.JavaStackFrame]#Table">table</a>.<a href="TableDef.scala.html#521468" title="=&gt; Iterator[scala.tools.nsc.util.JavaStackFrame]">iterator</a>
  <span class="keyword">def</span> <a title="(index: Int)scala.tools.nsc.util.JavaStackFrame" id="509887">apply</a><span class="delimiter">(</span><a title="Int" id="988351">index</a>: <a href="../../../Int.scala.html#386" title="Int">Int</a><span class="delimiter">)</span> = <a href="TableDef.scala.html#521469" title="(index: Int)scala.tools.nsc.util.JavaStackFrame">table</a><span class="delimiter">(</span><a href="#988351" title="Int">index</a><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="=&gt; List[Throwable]" id="509888">causes</a>  = <a href="#42659" title="object scala.tools.nsc.util.Exceptional">Exceptional</a>.<a href="#509856" title="(x: Throwable)List[Throwable]">causes</a><span class="delimiter">(</span><a href="#509897" title="=&gt; Throwable">ex</a><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="=&gt; java.lang.String" id="509889">summary</a> = <a href="#509870" title="=&gt; Throwable">unwrapped</a>.<span title="()java.lang.String">toString</span> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;\012  at &quot;)" class="string">&quot;\n  at &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#509887" title="(index: Int)scala.tools.nsc.util.JavaStackFrame">apply</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>.<a href="JavaStackFrame.scala.html#745236" title="=&gt; String">shortNameString</a>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(msg: Any)Unit" id="509890">println</a><span class="delimiter">(</span><a title="Any" id="988631">msg</a>: <span title="Any">Any</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <a href="../../../Console.scala.html#507" title="object Console">Console</a> <a href="../../../Console.scala.html#58055" title="(x: Any)Unit">println</a> <a href="#988631" title="Any">msg</a>
    <a href="../../../Console.scala.html#507" title="object Console">Console</a>.<a href="../../../Console.scala.html#58053" title="()Unit">flush</a><span class="delimiter">(</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="()Unit" id="509891">show</a><span class="delimiter">(</span><span class="delimiter">)</span>: <a href="../../../Unit.scala.html#461" title="Unit">Unit</a>         = <a href="#509890" title="(msg: Any)Unit">println</a><span class="delimiter">(</span><a href="#509882" title="()String">context</a><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="(num: Int)Unit" id="509892">show</a><span class="delimiter">(</span><a title="Int" id="775535">num</a>: <a href="../../../Int.scala.html#386" title="Int">Int</a><span class="delimiter">)</span>: <a href="../../../Unit.scala.html#461" title="Unit">Unit</a> = <a href="#509890" title="(msg: Any)Unit">println</a><span class="delimiter">(</span><a href="#509883" title="(num: Int)String">context</a><span class="delimiter">(</span><a href="#775535" title="Int">num</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="()Unit" id="509893">showCauses</a><span class="delimiter">(</span><span class="delimiter">)</span>         = <a href="#509890" title="(msg: Any)Unit">println</a><span class="delimiter">(</span><span class="delimiter">(</span><a href="#509897" title="=&gt; Throwable">ex</a> <a href="../../../collection/immutable/List.scala.html#49140" title="(x: Throwable)List[Throwable]">::</a> <a href="#509888" title="=&gt; List[Throwable]">causes</a><span class="delimiter">)</span>.<a href="../../../collection/TraversableOnce.scala.html#53708" title="(start: String, sep: String, end: String)String">mkString</a><span class="delimiter">(</span><span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span>, <span title="java.lang.String(&quot;\012  caused by -&gt; &quot;)" class="string">&quot;\n  caused by -&gt; &quot;</span>, <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="()Unit" id="509894">showTable</a><span class="delimiter">(</span><span class="delimiter">)</span>          = <a href="#509890" title="(msg: Any)Unit">println</a><span class="delimiter">(</span><a href="#509872" title="=&gt; scala.tools.nsc.util.TableDef[scala.tools.nsc.util.JavaStackFrame]#Table">table</a><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="()Unit" id="509895">showSummary</a><span class="delimiter">(</span><span class="delimiter">)</span>        = <a href="#509890" title="(msg: Any)Unit">println</a><span class="delimiter">(</span><a href="#509889" title="=&gt; java.lang.String">summary</a><span class="delimiter">)</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="()java.lang.String" id="509896">toString</a> = <a href="#509889" title="=&gt; java.lang.String">summary</a>
<span class="delimiter">}</span>


<span class="keyword">object</span> <a title="object scala.tools.nsc.util.Exceptional" id="42659">Exceptional</a> <a href="../../../ScalaObject.scala.html#464" title="ScalaObject" class="delimiter">{</a>
  <span class="keyword">type</span> <a title="[+T]PartialFunction[Throwable,T]" id="509837">Catcher</a><span class="delimiter">[</span>+<a title="&gt;: Nothing &lt;: Any" id="509838">T</a><span class="delimiter">]</span> = <a href="../../../PartialFunction.scala.html#335" title="PartialFunction[Throwable,T]">PartialFunction</a><span class="delimiter">[</span>Throwable, T<span class="delimiter">]</span>

  <span class="comment">/** Creates an exception handler which will only ever catch the given
   *  number of exceptions (if the given pf is defined there) and after
   *  that will disable itself.
   */</span>
  <span class="keyword">def</span> <a title="[T](numCatches: Int)(pf: scala.tools.nsc.util.Exceptional.Catcher[T])scala.tools.nsc.util.Exceptional.Catcher[T]" id="509839">expiringHandler</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="509841">T</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="Int" id="931103">numCatches</a>: <a href="../../../Int.scala.html#386" title="Int">Int</a><span class="delimiter">)</span><span class="delimiter">(</span><a title="scala.tools.nsc.util.Exceptional.Catcher[T]" id="931104">pf</a>: <a href="../../../PartialFunction.scala.html#335" title="scala.tools.nsc.util.Exceptional.Catcher[T]">Catcher</a><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../../PartialFunction.scala.html#335" title="scala.tools.nsc.util.Exceptional.Catcher[T]">Catcher</a><span class="delimiter">[</span>T<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">var</span> <a title="Int" id="988667">remaining</a> = <a href="#931103" title="Int">numCatches</a>;
    <a href="#988669" title="T" class="delimiter">{</a> <span class="keyword">case</span> <a title="T" id="988670">ex</a>: <span title="Throwable">Throwable</span> <span class="keyword">if</span> <a href="#988667" title="Int">remaining</a> <a href="../../../Int.scala.html#54775" title="(x: Int)Boolean">&gt;</a> <span title="Int(0)" class="int">0</span> <a href="../../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#931104" title="scala.tools.nsc.util.Exceptional.Catcher[T]">pf</a>.<a href="../../../PartialFunction.scala.html#53462" title="(x: Throwable)Boolean">isDefinedAt</a><span class="delimiter">(</span><a href="#988670" title="java.lang.Throwable">ex</a><span class="delimiter">)</span> =&gt;
        <a href="#988667" title="Int">remaining</a> <a href="../../../Int.scala.html#54811" title="(x: Int)Int">-=</a> <span title="Int(1)" class="int">1</span>
        <a href="../../../Function1.scala.html#53453" title="(v1: Throwable)T">pf</a><span class="delimiter">(</span><a href="#988670" title="java.lang.Throwable">ex</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="comment">/** The Throwable =&gt; Exceptional implicit plus the associated factory. */</span>
  <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="implicit scala.tools.nsc.util.Exceptional.throwableToExceptional : (ex: Throwable)(implicit prefs: scala.tools.nsc.util.ScalaPrefs)scala.tools.nsc.util.Exceptional" id="509842">throwableToExceptional</a><span class="delimiter">(</span><a title="Throwable" id="988394">ex</a>: <span title="Throwable">Throwable</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scala.tools.nsc.util.ScalaPrefs" id="988395">prefs</a>: <a href="ScalaPrefs.scala.html#43150" title="scala.tools.nsc.util.ScalaPrefs">ScalaPrefs</a><span class="delimiter">)</span>: <a href="#42658" title="scala.tools.nsc.util.Exceptional">Exceptional</a> = <a href="#509843" title="(ex: Throwable)(implicit prefs: scala.tools.nsc.util.ScalaPrefs)scala.tools.nsc.util.Exceptional">apply</a><span class="delimiter">(</span><a href="#988394" title="Throwable">ex</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#988395" title="scala.tools.nsc.util.ScalaPrefs">prefs</a><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="(ex: Throwable)(implicit prefs: scala.tools.nsc.util.ScalaPrefs)scala.tools.nsc.util.Exceptional" id="509843">apply</a><span class="delimiter">(</span><a title="Throwable" id="509858">ex</a>: <span title="Throwable">Throwable</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scala.tools.nsc.util.ScalaPrefs" id="509859">prefs</a>: <a href="ScalaPrefs.scala.html#43150" title="scala.tools.nsc.util.ScalaPrefs">ScalaPrefs</a><span class="delimiter">)</span> = <span title="scala.tools.nsc.util.Exceptional" class="keyword">new</span> <a href="#42658" title="scala.tools.nsc.util.Exceptional">Exceptional</a><span class="delimiter">(</span><a href="#509858" title="Throwable">ex</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#509859" title="scala.tools.nsc.util.ScalaPrefs">prefs</a><span class="delimiter">)</span>

  <span class="comment">/** Some handy functions. */</span>
  <span class="keyword">def</span> <a title="()Array[scala.tools.nsc.util.JavaStackFrame]" id="509844">stack</a><span class="delimiter">(</span><span class="delimiter">)</span>  = <a href="JavaStackFrame.scala.html#43046" title="object scala.tools.nsc.util.JavaStackFrame">JavaStackFrame</a> <a href="JavaStackFrame.scala.html#988237" title="(xs: Array[java.lang.StackTraceElement])Array[scala.tools.nsc.util.JavaStackFrame]">frames</a> <span class="delimiter">(</span><span class="delimiter">(</span><span title="java.lang.Throwable" class="keyword">new</span> <a href="../../../package.scala.html#47499" title="java.lang.Throwable">Throwable</a><span class="delimiter">)</span>.<a href="../../../Predef.scala.html#9626" title="(xs: Array[java.lang.StackTraceElement])scala.collection.mutable.ArrayOps[java.lang.StackTraceElement]">getStackTrace</a> <a href="../../../collection/IndexedSeqOptimized.scala.html#55973" title="(p: java.lang.StackTraceElement =&gt; Boolean)Array[java.lang.StackTraceElement]">dropWhile</a> <a href="#509855" title="(ste: java.lang.StackTraceElement)Boolean">isLocal</a><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="()Unit" id="509845">showme</a><span class="delimiter">(</span><span class="delimiter">)</span> = <a href="#509843" title="(ex: Throwable)(implicit prefs: scala.tools.nsc.util.ScalaPrefs)scala.tools.nsc.util.Exceptional">apply</a><a href="ScalaPrefs.scala.html#509902" title="object scala.tools.nsc.util.ScalaPrefs.DefaultScalaPrefs" class="delimiter">(</a><span title="java.lang.Throwable" class="keyword">new</span> <a href="../../../package.scala.html#47499" title="java.lang.Throwable">Throwable</a><span class="delimiter">)</span>.<a href="#509891" title="()Unit">show</a><span class="delimiter">(</span><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="()Unit" id="509846">showstack</a><span class="delimiter">(</span><span class="delimiter">)</span> = <a href="#509843" title="(ex: Throwable)(implicit prefs: scala.tools.nsc.util.ScalaPrefs)scala.tools.nsc.util.Exceptional">apply</a><a href="ScalaPrefs.scala.html#509902" title="object scala.tools.nsc.util.ScalaPrefs.DefaultScalaPrefs" class="delimiter">(</a><span title="java.lang.Throwable" class="keyword">new</span> <a href="../../../package.scala.html#47499" title="java.lang.Throwable">Throwable</a><span class="delimiter">)</span>.<a href="#509894" title="()Unit">showTable</a><span class="delimiter">(</span><span class="delimiter">)</span>

  <span class="comment">/** A frame formatter with more refined aesthetics than the default.
   *  Come, let us be civilized.
   */</span>
  <span class="keyword">object</span> <a title="object scala.tools.nsc.util.Exceptional.ScalaFormat" id="509847">ScalaFormat</a> <a href="../../../ScalaObject.scala.html#464" title="ScalaObject" class="keyword">extends</a> <a href="TableDef.scala.html#42451" title="scala.tools.nsc.util.TableDef[scala.tools.nsc.util.JavaStackFrame]">TableDef</a><span class="delimiter">[</span>JavaStackFrame<span class="delimiter">]</span> <span class="delimiter">{</span>
      <a href="TableDef.scala.html#521434" title="(pair: (String, scala.tools.nsc.util.JavaStackFrame =&gt; Any))scala.tools.nsc.util.TableDef[scala.tools.nsc.util.JavaStackFrame]">&gt;&gt;</a> <span class="delimiter">(</span><a href="../../../Predef.scala.html#9589" title="(x: java.lang.String)ArrowAssoc[java.lang.String]" class="string">&quot;file&quot;</a>    <a href="../../../Predef.scala.html#57653" title="(y: scala.tools.nsc.util.JavaStackFrame =&gt; String)(java.lang.String, scala.tools.nsc.util.JavaStackFrame =&gt; String)">-&gt;</a> <span class="delimiter">(</span><a href="#988929" title="scala.tools.nsc.util.JavaStackFrame">_</a>.<a href="JavaStackFrame.scala.html#745224" title="=&gt; String">fileName</a><span class="delimiter">)</span><span class="delimiter">)</span>   <a href="TableDef.scala.html#521436" title="(sep: String)scala.tools.nsc.util.TableDef[scala.tools.nsc.util.JavaStackFrame]">&gt;+</a> <span title="java.lang.String(&quot;:&quot;)" class="string">&quot;:&quot;</span>
      <a href="TableDef.scala.html#521435" title="(pair: (String, scala.tools.nsc.util.JavaStackFrame =&gt; Any))scala.tools.nsc.util.TableDef[scala.tools.nsc.util.JavaStackFrame]">&lt;&lt;</a> <span class="delimiter">(</span><a href="../../../Predef.scala.html#9589" title="(x: java.lang.String)ArrowAssoc[java.lang.String]" class="string">&quot;line&quot;</a>    <a href="../../../Predef.scala.html#57653" title="(y: scala.tools.nsc.util.JavaStackFrame =&gt; Int)(java.lang.String, scala.tools.nsc.util.JavaStackFrame =&gt; Int)">-&gt;</a> <span class="delimiter">(</span><a href="#988948" title="scala.tools.nsc.util.JavaStackFrame">_</a>.<a href="JavaStackFrame.scala.html#745225" title="=&gt; Int">line</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="TableDef.scala.html#521434" title="(pair: (String, scala.tools.nsc.util.JavaStackFrame =&gt; Any))scala.tools.nsc.util.TableDef[scala.tools.nsc.util.JavaStackFrame]">&gt;&gt;</a> <span class="delimiter">(</span><a href="../../../Predef.scala.html#9589" title="(x: java.lang.String)ArrowAssoc[java.lang.String]" class="string">&quot;class&quot;</a>   <a href="../../../Predef.scala.html#57653" title="(y: scala.tools.nsc.util.JavaStackFrame =&gt; java.lang.String)(java.lang.String, scala.tools.nsc.util.JavaStackFrame =&gt; java.lang.String)">-&gt;</a> <span class="delimiter">(</span><a href="#988966" title="scala.tools.nsc.util.JavaStackFrame">_</a>.<a href="JavaStackFrame.scala.html#745231" title="=&gt; java.lang.String">shortestName</a><span class="delimiter">)</span><span class="delimiter">)</span>  <a href="TableDef.scala.html#521436" title="(sep: String)scala.tools.nsc.util.TableDef[scala.tools.nsc.util.JavaStackFrame]">&gt;+</a> <span title="java.lang.String(&quot;.&quot;)" class="string">&quot;.&quot;</span>
      <a href="TableDef.scala.html#521435" title="(pair: (String, scala.tools.nsc.util.JavaStackFrame =&gt; Any))scala.tools.nsc.util.TableDef[scala.tools.nsc.util.JavaStackFrame]">&lt;&lt;</a> <span class="delimiter">(</span><a href="../../../Predef.scala.html#9589" title="(x: java.lang.String)ArrowAssoc[java.lang.String]" class="string">&quot;method&quot;</a>  <a href="../../../Predef.scala.html#57653" title="(y: scala.tools.nsc.util.JavaStackFrame =&gt; String)(java.lang.String, scala.tools.nsc.util.JavaStackFrame =&gt; String)">-&gt;</a> <span class="delimiter">(</span><a href="#988986" title="scala.tools.nsc.util.JavaStackFrame">_</a>.<a href="JavaStackFrame.scala.html#745223" title="=&gt; String">methodName</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">trait</span> <a title="trait Calibrated extends java.lang.Object" id="509849">Calibrated</a> <span title="java.lang.Object" class="delimiter">{</span>
    <span class="keyword">def</span> <a title="(ex: Throwable)scala.tools.nsc.util.TableDef[scala.tools.nsc.util.JavaStackFrame]#Table" id="988174">newTable</a><span class="delimiter">(</span><a title="Throwable" id="988176">ex</a>: <span title="Throwable">Throwable</span><span class="delimiter">)</span>: TableDef<span class="delimiter">[</span>JavaStackFrame<span class="delimiter">]</span>#<a href="TableDef.scala.html#521451" title="scala.tools.nsc.util.TableDef[scala.tools.nsc.util.JavaStackFrame]#Table">Table</a>
    <span class="keyword">def</span> <a title="(frame: scala.tools.nsc.util.JavaStackFrame)String" id="988175">inContext</a><span class="delimiter">(</span><a title="scala.tools.nsc.util.JavaStackFrame" id="988228">frame</a>: <a href="JavaStackFrame.scala.html#43045" title="scala.tools.nsc.util.JavaStackFrame">JavaStackFrame</a><span class="delimiter">)</span>: <span title="String">String</span>
  <span class="delimiter">}</span>
  <span class="keyword">trait</span> <a title="trait Formatter extends java.lang.Object with Throwable =&gt; scala.tools.nsc.util.Exceptional.Calibrated" id="509850">Formatter</a> <span class="keyword">extends</span> <span class="delimiter">(</span>Throwable =&gt; Calibrated<span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="(ex: Throwable)scala.tools.nsc.util.Exceptional.Calibrated" id="988162">apply</a><span class="delimiter">(</span><a title="Throwable" id="988164">ex</a>: <span title="Throwable">Throwable</span><span class="delimiter">)</span>: <a href="#509849" title="scala.tools.nsc.util.Exceptional.Calibrated">Calibrated</a>
  <span class="delimiter">}</span>
  <span class="keyword">object</span> <a title="object scala.tools.nsc.util.Exceptional.Formatter" id="509851">Formatter</a> <a href="../../../ScalaObject.scala.html#464" title="ScalaObject" class="delimiter">{</a>
    <span class="keyword">def</span> <a title="(implicit prefs: scala.tools.nsc.util.ScalaPrefs)scala.tools.nsc.util.Exceptional.Formatter" id="988993">apply</a><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scala.tools.nsc.util.ScalaPrefs" id="988995">prefs</a>: <a href="ScalaPrefs.scala.html#43150" title="scala.tools.nsc.util.ScalaPrefs">ScalaPrefs</a><span class="delimiter">)</span>: <a href="#509850" title="scala.tools.nsc.util.Exceptional.Formatter">Formatter</a> = <a href="#988997" title="java.lang.Object with scala.tools.nsc.util.Exceptional.Formatter" class="keyword">new</a> <a title="anonymous class $anon extends java.lang.Object with scala.tools.nsc.util.Exceptional.Formatter" id="988997">Formatter</a> <span class="delimiter">{</span>
      <span class="keyword">def</span> <a title="(ex: Throwable)java.lang.Object with scala.tools.nsc.util.Exceptional.Calibrated{def newTable(ex: Throwable): scala.tools.nsc.util.Exceptional.ScalaFormat.Table}" id="989002">apply</a><span class="delimiter">(</span><a title="Throwable" id="989003">ex</a>: <span title="Throwable">Throwable</span><span class="delimiter">)</span> = <a href="#989008" title="java.lang.Object with scala.tools.nsc.util.Exceptional.Calibrated" class="keyword">new</a> <a title="anonymous class $anon extends java.lang.Object with scala.tools.nsc.util.Exceptional.Calibrated" id="989008">Calibrated</a> <span class="delimiter">{</span>
        <span class="keyword">def</span> <a title="(ex: Throwable)scala.tools.nsc.util.Exceptional.ScalaFormat.Table" id="989012">newTable</a><span class="delimiter">(</span><a title="Throwable" id="989014">ex</a>: <span title="Throwable">Throwable</span><span class="delimiter">)</span>          = <span title="scala.tools.nsc.util.Exceptional.ScalaFormat.Table" class="keyword">new</span> <a href="#509847" title="object scala.tools.nsc.util.Exceptional.ScalaFormat">ScalaFormat</a>.<a href="TableDef.scala.html#521451" title="scala.tools.nsc.util.Exceptional.ScalaFormat.Table">Table</a><span class="delimiter">(</span><a href="JavaStackFrame.scala.html#43046" title="object scala.tools.nsc.util.JavaStackFrame">JavaStackFrame</a> <a href="../../../LowPriorityImplicits.scala.html#9491" title="(xs: Array[scala.tools.nsc.util.JavaStackFrame])scala.collection.mutable.WrappedArray[scala.tools.nsc.util.JavaStackFrame]">frames</a> <a href="#989014" title="Throwable">ex</a><span class="delimiter">)</span>
        <span class="keyword">def</span> <a title="(frame: scala.tools.nsc.util.JavaStackFrame)java.lang.String" id="989013">inContext</a><span class="delimiter">(</span><a title="scala.tools.nsc.util.JavaStackFrame" id="989052">frame</a>: <a href="JavaStackFrame.scala.html#43045" title="scala.tools.nsc.util.JavaStackFrame">JavaStackFrame</a><span class="delimiter">)</span> = <span title="scala.tools.nsc.util.FrameContext" class="keyword">new</span> <a href="JavaStackFrame.scala.html#42811" title="scala.tools.nsc.util.FrameContext">FrameContext</a><span class="delimiter">(</span><a href="#989052" title="scala.tools.nsc.util.JavaStackFrame">frame</a>, <a href="#988995" title="scala.tools.nsc.util.ScalaPrefs">prefs</a>.<a href="ScalaPrefs.scala.html#509899" title="=&gt; scala.tools.nsc.io.Sources">codeSources</a><span class="delimiter">)</span> <a href="JavaStackFrame.scala.html#989070" title="()java.lang.String">toString</a>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="comment">/** Java stack traces have the interesting property of using only the name
   *  of the file, no paths.  This makes it a bit of a gamble to try to associate
   *  a stack frame with a specific file.  Witness the heuristic.
   */</span>
  <span class="keyword">def</span> <a title="(sources: scala.tools.nsc.io.Sources, frame: scala.tools.nsc.util.JavaStackFrame)List[scala.tools.nsc.io.Fileish]" id="509853">locateSources</a><span class="delimiter">(</span><a title="scala.tools.nsc.io.Sources" id="989272">sources</a>: <a href="../io/Sources.scala.html#33663" title="scala.tools.nsc.io.Sources">Sources</a>, <a title="scala.tools.nsc.util.JavaStackFrame" id="989273">frame</a>: <a href="JavaStackFrame.scala.html#43045" title="scala.tools.nsc.util.JavaStackFrame">JavaStackFrame</a><span class="delimiter">)</span>: <a href="../../../collection/immutable/List.scala.html#14047" title="List[scala.tools.nsc.io.Fileish]">List</a><span class="delimiter">[</span>Fileish<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="comment">// if only one has a matching path, that's fairly sure to be the one</span>
    <span class="keyword">val</span> <a title="List[scala.tools.nsc.io.Fileish]" id="989275">matches</a> = <a href="../io/Sources.scala.html#739804" title="(name: String)List[scala.tools.nsc.io.Fileish]">sources</a><span class="delimiter">(</span><a href="#989273" title="scala.tools.nsc.util.JavaStackFrame">frame</a>.<a href="JavaStackFrame.scala.html#745224" title="=&gt; String">fileName</a><span class="delimiter">)</span> <a href="../../../collection/TraversableLike.scala.html#49051" title="(p: scala.tools.nsc.io.Fileish =&gt; Boolean)List[scala.tools.nsc.io.Fileish]">filter</a> <span class="delimiter">(</span><a href="#989281" title="scala.tools.nsc.io.Fileish">_</a>.<a href="../io/Fileish.scala.html#777645" title="=&gt; java.lang.String">pkgFromPath</a> <span title="(x$1: java.lang.String)Boolean">endsWith</span> <a href="#989273" title="scala.tools.nsc.util.JavaStackFrame">frame</a>.<a href="JavaStackFrame.scala.html#745227" title="=&gt; String">pkgName</a><span class="delimiter">)</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#989275" title="List[scala.tools.nsc.io.Fileish]">matches</a>.<a href="../../../collection/IterableLike.scala.html#53862" title="=&gt; Boolean">isEmpty</a> <a href="../../../Boolean.scala.html#55579" title="(x: Boolean)Boolean">||</a> <a href="#989275" title="List[scala.tools.nsc.io.Fileish]">matches</a>.<a href="../../../collection/TraversableLike.scala.html#49082" title="=&gt; List[scala.tools.nsc.io.Fileish]">tail</a>.<a href="../../../collection/IterableLike.scala.html#53862" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span>
      <span title="Nothing" class="keyword">return</span> <a href="#989275" title="List[scala.tools.nsc.io.Fileish]">matches</a>

    <span class="comment">// otherwise we'll drink them in and look for a package name</span>
    <a href="#989275" title="List[scala.tools.nsc.io.Fileish]">matches</a> <a href="../../../collection/TraversableLike.scala.html#49051" title="(p: scala.tools.nsc.io.Fileish =&gt; Boolean)List[scala.tools.nsc.io.Fileish]">filter</a> <span class="delimiter">(</span><a href="#989289" title="scala.tools.nsc.io.Fileish">_</a>.<a href="../io/Fileish.scala.html#777647" title="=&gt; String">pkgFromSource</a> <span title="(x$1: java.lang.String)Boolean">endsWith</span> <a href="#989273" title="scala.tools.nsc.util.JavaStackFrame">frame</a>.<a href="JavaStackFrame.scala.html#745227" title="=&gt; String">pkgName</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/** Right now this punts if more than one match and it accepts the first at random.
   */</span>
  <span class="keyword">def</span> <a title="(sources: scala.tools.nsc.io.Sources, frame: scala.tools.nsc.util.JavaStackFrame)Option[scala.tools.nsc.io.Fileish]" id="509854">locateSource</a><span class="delimiter">(</span><a title="scala.tools.nsc.io.Sources" id="989077">sources</a>: <a href="../io/Sources.scala.html#33663" title="scala.tools.nsc.io.Sources">Sources</a>, <a title="scala.tools.nsc.util.JavaStackFrame" id="989078">frame</a>: <a href="JavaStackFrame.scala.html#43045" title="scala.tools.nsc.util.JavaStackFrame">JavaStackFrame</a><span class="delimiter">)</span>: <a href="../../../Option.scala.html#560" title="Option[scala.tools.nsc.io.Fileish]">Option</a><span class="delimiter">[</span>Fileish<span class="delimiter">]</span> =
    <a href="#509853" title="(sources: scala.tools.nsc.io.Sources, frame: scala.tools.nsc.util.JavaStackFrame)List[scala.tools.nsc.io.Fileish]">locateSources</a><span class="delimiter">(</span><a href="#989077" title="scala.tools.nsc.io.Sources">sources</a>, <a href="#989078" title="scala.tools.nsc.util.JavaStackFrame">frame</a><span class="delimiter">)</span>.<a href="../../../collection/TraversableLike.scala.html#49081" title="=&gt; Option[scala.tools.nsc.io.Fileish]">headOption</a>

  <span class="keyword">def</span> <a title="(ste: java.lang.StackTraceElement)Boolean" id="509855">isLocal</a><span class="delimiter">(</span><a title="java.lang.StackTraceElement" id="988890">ste</a>: <span title="java.lang.StackTraceElement">StackTraceElement</span><span class="delimiter">)</span> = <a href="#988890" title="java.lang.StackTraceElement">ste</a>.<span title="()java.lang.String">getClassName</span> <span title="(x$1: java.lang.String)Boolean">startsWith</span> <span class="keyword">this</span>.<span title="()java.lang.Class[_]">getClass</span>.<span title="()java.lang.String">getName</span>
  <span class="keyword">def</span> <a title="(x: Throwable)List[Throwable]" id="509856">causes</a><span class="delimiter">(</span><a title="Throwable" id="988382">x</a>: <span title="Throwable">Throwable</span><span class="delimiter">)</span>: <a href="../../../collection/immutable/List.scala.html#14047" title="List[Throwable]">List</a><span class="delimiter">[</span>Throwable<span class="delimiter">]</span> = <a href="#988382" title="Throwable">x</a>.<span title="()java.lang.Throwable">getCause</span> <span title="List[Throwable]" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <span title="scala.collection.immutable.Nil.type" class="keyword">null</span> =&gt; <a href="../../../collection/immutable/List.scala.html#13700" title="object Nil">Nil</a>
    <span class="keyword">case</span> <a title="List[Throwable]" id="989290">ex</a>   =&gt; <a href="#988382" title="Throwable">x</a> <a href="../../../collection/immutable/List.scala.html#49140" title="(x: Throwable)List[Throwable]">::</a> <a href="#509856" title="(x: Throwable)List[Throwable]">causes</a><span class="delimiter">(</span><a href="#989290" title="java.lang.Throwable">ex</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>
  <span class="keyword">def</span> <a title="(x: Throwable)Throwable" id="509857">unwrap</a><span class="delimiter">(</span><a title="Throwable" id="525968">x</a>: <span title="Throwable">Throwable</span><span class="delimiter">)</span>: <span title="Throwable">Throwable</span> = <a href="#525968" title="Throwable">x</a> <span title="Throwable" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span>  <span title="Throwable">_</span>: <span title="java.lang.reflect.InvocationTargetException">InvocationTargetException</span> |
          _: <span title="java.lang.ExceptionInInitializerError">ExceptionInInitializerError</span> |
          _: <span title="java.lang.reflect.UndeclaredThrowableException">UndeclaredThrowableException</span> |
          _: <span title="java.util.concurrent.ExecutionException">ExecutionException</span>
            <span class="keyword">if</span> <a href="#525968" title="Throwable">x</a>.<span title="()java.lang.Throwable">getCause</span> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span> =&gt;
              <a href="#509857" title="(x: Throwable)Throwable">unwrap</a><span class="delimiter">(</span><a href="#525968" title="Throwable">x</a>.<span title="()java.lang.Throwable">getCause</span><span class="delimiter">)</span>

    <span class="keyword">case</span> <span title="Throwable">_</span> =&gt; <a href="#525968" title="Throwable">x</a>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>