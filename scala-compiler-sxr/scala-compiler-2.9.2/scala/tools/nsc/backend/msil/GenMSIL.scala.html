<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>scala/tools/nsc/backend/msil/GenMSIL.scala</title>
        <script type="text/javascript" src="../../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/* NSC -- new scala compiler
 * Copyright 2005-2011 LAMP/EPFL
 * @author Nikolay Mihaylov
 */</span>


<span class="keyword">package</span> scala.tools.nsc
<span class="keyword">package</span> backend.msil

<span class="keyword">import</span> java.io.<span class="delimiter">{</span>File, IOException<span class="delimiter">}</span>
<span class="keyword">import</span> java.nio.<span class="delimiter">{</span>ByteBuffer, ByteOrder<span class="delimiter">}</span>

<span class="keyword">import</span> scala.collection.mutable.<span class="delimiter">{</span>Map, HashMap, HashSet, Stack, ListBuffer<span class="delimiter">}</span>
<span class="keyword">import</span> scala.tools.nsc.symtab._

<span class="keyword">import</span> ch.epfl.lamp.compiler.msil.<span class="delimiter">{</span>Type =&gt; MsilType, _<span class="delimiter">}</span>
<span class="keyword">import</span> ch.epfl.lamp.compiler.msil.emit._
<span class="keyword">import</span> ch.epfl.lamp.compiler.msil.util.PECustomMod

<span class="keyword">abstract</span> <span class="keyword">class</span> <a title="class GenMSIL extends scala.tools.nsc.SubComponent with ScalaObject" id="27465">GenMSIL</a> <a href="../../../../ScalaObject.scala.html#464" title="ScalaObject" class="keyword">extends</a> <a href="../../SubComponent.scala.html#22920" title="scala.tools.nsc.SubComponent">SubComponent</a> <span class="delimiter">{</span>
  <span class="keyword">import</span> <a href="../../SubComponent.scala.html#500466" title="=&gt; scala.tools.nsc.Global">global</a>._
  <span class="keyword">import</span> <a href="../../Global.scala.html#478264" title="=&gt; scala.tools.nsc.symtab.SymbolLoaders{val global: GenMSIL.this.global.type}">loaders</a>.clrTypes
  <span class="keyword">import</span> <a href="../../symtab/SymbolLoaders.scala.html#506452" title="object GenMSIL.this.global.loaders.clrTypes">clrTypes</a>.<span class="delimiter">{</span>types, constructors, methods, fields<span class="delimiter">}</span>
  <span class="keyword">import</span> <a href="../../Global.scala.html#478218" title="object GenMSIL.this.global.icodes">icodes</a>._
  <span class="keyword">import</span> <a href="../../Global.scala.html#478218" title="object GenMSIL.this.global.icodes">icodes</a>.<a href="../icode/Opcodes.scala.html#501275" title="object GenMSIL.this.global.icodes.opcodes">opcodes</a>._

  <span class="comment">/** Create a new phase */</span>
  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(p: scala.tools.nsc.Phase)GenMSIL.this.MsilPhase" id="592524">newPhase</a><span class="delimiter">(</span><a title="scala.tools.nsc.Phase" id="636570">p</a>: <a href="../../Phase.scala.html#22578" title="scala.tools.nsc.Phase">Phase</a><span class="delimiter">)</span> = <span title="GenMSIL.this.MsilPhase" class="keyword">new</span> <a href="#592527" title="GenMSIL.this.MsilPhase">MsilPhase</a><span class="delimiter">(</span><a href="#636570" title="scala.tools.nsc.Phase">p</a><span class="delimiter">)</span>

  <span class="keyword">val</span> <a title="java.lang.String" id="592525">phaseName</a> = <span title="java.lang.String(&quot;msil&quot;)" class="string">&quot;msil&quot;</span>
  <span class="comment">/** MSIL code generation phase
   */</span>
  <span class="keyword">class</span> <a title="class MsilPhase extends GenMSIL.this.global.GlobalPhase with ScalaObject" id="592527">MsilPhase</a><a href="../../../../ScalaObject.scala.html#464" title="ScalaObject" class="delimiter">(</a><a title="scala.tools.nsc.Phase" id="636581">prev</a>: <a href="../../Phase.scala.html#22578" title="scala.tools.nsc.Phase">Phase</a><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="../../Global.scala.html#478273" title="GenMSIL.this.global.GlobalPhase">GlobalPhase</a><span class="delimiter">(</span><a href="#636581" title="scala.tools.nsc.Phase">prev</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="=&gt; java.lang.String" id="636576">name</a> = <a href="#592525" title="=&gt; java.lang.String">phaseName</a>
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; Long" id="636577">newFlags</a> = <a href="../../SubComponent.scala.html#500475" title="=&gt; Long">phaseNewFlags</a>

    <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; Boolean" id="636578">erasedTypes</a> = <span title="Boolean(true)" class="keyword">true</span>

    <span class="keyword">override</span> <span class="keyword">def</span> <a title="()Unit" id="636579">run</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../Global.scala.html#478200" title="=&gt; scala.tools.nsc.Settings">settings</a>.<a href="../../settings/ScalaSettings.scala.html#469727" title="=&gt; scala.tools.nsc.Settings#BooleanSetting">debug</a>.<a href="../../settings/MutableSettings.scala.html#470030" title="=&gt; Boolean">value</a><span class="delimiter">)</span> <a href="../../Global.scala.html#478244" title="(msg: String)Unit">inform</a><span class="delimiter">(</span><span title="java.lang.String(&quot;[running phase &quot;)" class="string">&quot;[running phase &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#636576" title="=&gt; java.lang.String">name</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot; on icode]&quot;)" class="string">&quot; on icode]&quot;</span><span class="delimiter">)</span>

      <span class="keyword">val</span> <a title="GenMSIL.this.BytecodeGenerator" id="636594">codeGenerator</a> = <span title="GenMSIL.this.BytecodeGenerator" class="keyword">new</span> <a href="#592528" title="GenMSIL.this.BytecodeGenerator">BytecodeGenerator</a>

      <span class="comment">//classes is ICodes.classes, a HashMap[Symbol, IClass]</span>
      <a href="../icode/ICodes.scala.html#501219" title="=&gt; scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.global.Symbol,GenMSIL.this.global.icodes.IClass]">classes</a>.<a href="../../../../collection/mutable/HashMap.scala.html#73169" title="=&gt; Iterable[GenMSIL.this.global.icodes.IClass]">values</a> <a href="../../../../collection/IterableLike.scala.html#53856" title="(f: GenMSIL.this.global.icodes.IClass =&gt; Unit)Unit">foreach</a> <a href="#636594" title="GenMSIL.this.BytecodeGenerator">codeGenerator</a>.<a href="#636761" title="(cls: GenMSIL.this.global.icodes.IClass)Unit">findEntryPoint</a>
      <span title="Unit" class="keyword">if</span><span class="delimiter">(</span> <a href="../../Global.scala.html#478259" title="object GenMSIL.this.global.opt">opt</a>.<a href="../../Global.scala.html#501760" title="=&gt; Option[GenMSIL.this.global.Name]">showClass</a>.<a href="../../../../Option.scala.html#48472" title="=&gt; Boolean">isDefined</a> <a href="../../../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a> <span class="delimiter">(</span><a href="#636594" title="GenMSIL.this.BytecodeGenerator">codeGenerator</a>.<a href="#636755" title="=&gt; GenMSIL.this.global.Symbol">entryPoint</a> <span title="(x$1: AnyRef)Boolean">==</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <span class="delimiter">)</span> <span class="delimiter">{</span> <span class="comment">// TODO introduce dedicated setting instead</span>
        <span class="keyword">val</span> <a title="String" id="636831">entryclass</a> = <a href="../../Global.scala.html#478259" title="object GenMSIL.this.global.opt">opt</a>.<a href="../../Global.scala.html#501760" title="=&gt; Option[GenMSIL.this.global.Name]">showClass</a>.<a href="../../../../Option.scala.html#48473" title="=&gt; GenMSIL.this.global.Name">get</a>.<a href="../../symtab/Names.scala.html#501123" title="()String">toString</a>
        <a href="../../Global.scala.html#478245" title="(msg: String)Unit">warning</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Couldn\'t find entry class &quot;)" class="string">&quot;Couldn't find entry class &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#636831" title="String">entryclass</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>

      <a href="#636594" title="GenMSIL.this.BytecodeGenerator">codeGenerator</a>.<a href="#636697" title="()Unit">initAssembly</a>

      <span class="keyword">val</span> <a title="List[GenMSIL.this.global.icodes.IClass]" id="636595">classesSorted</a> = <a href="../icode/ICodes.scala.html#501219" title="=&gt; scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.global.Symbol,GenMSIL.this.global.icodes.IClass]">classes</a>.<a href="../../../../collection/mutable/HashMap.scala.html#73169" title="=&gt; Iterable[GenMSIL.this.global.icodes.IClass]">values</a>.<a href="../../../../collection/TraversableOnce.scala.html#53691" title="=&gt; List[GenMSIL.this.global.icodes.IClass]">toList</a>.<a href="../../../../collection/SeqLike.scala.html#54178" title="(f: GenMSIL.this.global.icodes.IClass =&gt; Int)(implicit ord: scala.math.Ordering[Int])List[GenMSIL.this.global.icodes.IClass]">sortBy</a><a href="../../../../math/Ordering.scala.html#66780" title="object scala.math.Ordering.Int" class="delimiter">(</a><a title="GenMSIL.this.global.icodes.IClass" id="636841">c</a> =&gt; <a href="#636841" title="GenMSIL.this.global.icodes.IClass">c</a>.<a href="../icode/Members.scala.html#501663" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a>.<a href="../../symtab/Symbols.scala.html#509104" title="=&gt; Int">id</a><span class="delimiter">)</span> <span class="comment">// simplifies comparing cross-compiler vs. .exe output</span>
      <a href="#636595" title="List[GenMSIL.this.global.icodes.IClass]">classesSorted</a> <a href="../../../../collection/LinearSeqOptimized.scala.html#71032" title="(f: GenMSIL.this.global.icodes.IClass =&gt; Unit)Unit">foreach</a> <a href="#636594" title="GenMSIL.this.BytecodeGenerator">codeGenerator</a>.<a href="#636768" title="(iclass: GenMSIL.this.global.icodes.IClass)Unit">createTypeBuilder</a>
      <a href="#636595" title="List[GenMSIL.this.global.icodes.IClass]">classesSorted</a> <a href="../../../../collection/LinearSeqOptimized.scala.html#71032" title="(f: GenMSIL.this.global.icodes.IClass =&gt; Unit)Unit">foreach</a> <a href="#636594" title="GenMSIL.this.BytecodeGenerator">codeGenerator</a>.<a href="#636769" title="(iclass: GenMSIL.this.global.icodes.IClass)Unit">createClassMembers</a>

      <span class="keyword">try</span> <span class="delimiter">{</span>
        <a href="#636595" title="List[GenMSIL.this.global.icodes.IClass]">classesSorted</a> <a href="../../../../collection/LinearSeqOptimized.scala.html#71032" title="(f: GenMSIL.this.global.icodes.IClass =&gt; Unit)Unit">foreach</a> <a href="#636594" title="GenMSIL.this.BytecodeGenerator">codeGenerator</a>.<a href="#636704" title="(iclass: GenMSIL.this.global.icodes.IClass)Unit">genClass</a>
      <span class="delimiter">}</span> <span class="keyword">finally</span> <span class="delimiter">{</span>
        <a href="#636594" title="GenMSIL.this.BytecodeGenerator">codeGenerator</a>.<a href="#636701" title="()Unit">writeAssembly</a>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <span class="keyword">override</span> <span class="keyword">def</span> <a title="(unit: GenMSIL.this.global.CompilationUnit)Unit" id="636580">apply</a><span class="delimiter">(</span><a title="GenMSIL.this.global.CompilationUnit" id="636955">unit</a>: <a href="../../CompilationUnits.scala.html#479284" title="GenMSIL.this.global.CompilationUnit">CompilationUnit</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="../../symtab/SymbolTable.scala.html#478159" title="(msg: String)Nothing">abort</a><span class="delimiter">(</span><span title="java.lang.String(&quot;MSIL works on icode classes, not on compilation units!&quot;)" class="string">&quot;MSIL works on icode classes, not on compilation units!&quot;</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * MSIL bytecode generator.
   *
   */</span>
  <span class="keyword">class</span> <a title="class BytecodeGenerator extends java.lang.Object with ScalaObject" id="592528">BytecodeGenerator</a> <a href="../../../../ScalaObject.scala.html#464" title="ScalaObject" class="delimiter">{</a>

    <span class="keyword">val</span> <a title="java.lang.String" id="636605">MODULE_INSTANCE_NAME</a> = <span title="java.lang.String(&quot;MODULE$&quot;)" class="string">&quot;MODULE$&quot;</span>

    <span class="keyword">import</span> <a href="../../symtab/SymbolLoaders.scala.html#506452" title="object GenMSIL.this.global.loaders.clrTypes">clrTypes</a>.<span class="delimiter">{</span>VOID =&gt; MVOID, BOOLEAN =&gt; MBOOL, BYTE =&gt; MBYTE, SHORT =&gt; MSHORT,
                   CHAR =&gt; MCHAR, INT =&gt; MINT, LONG =&gt; MLONG, FLOAT =&gt; MFLOAT,
                   DOUBLE =&gt; MDOUBLE, OBJECT =&gt; MOBJECT, STRING =&gt; MSTRING,
                   STRING_ARRAY =&gt; MSTRING_ARRAY,
                   SYMTAB_CONSTR =&gt; SYMTAB_ATTRIBUTE_CONSTRUCTOR,
                   SYMTAB_DEFAULT_CONSTR =&gt; SYMTAB_ATTRIBUTE_EMPTY_CONSTRUCTOR<span class="delimiter">}</span>

    <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.Type" id="636608">EXCEPTION</a> = <a href="../../symtab/SymbolLoaders.scala.html#506452" title="object GenMSIL.this.global.loaders.clrTypes">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#601655" title="(name: String)ch.epfl.lamp.compiler.msil.Type">getType</a><span class="delimiter">(</span><span title="java.lang.String(&quot;System.Exception&quot;)" class="string">&quot;System.Exception&quot;</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.Type" id="636610">MBYTE_ARRAY</a> = <a href="../../symtab/SymbolLoaders.scala.html#506452" title="object GenMSIL.this.global.loaders.clrTypes">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#601657" title="(elemType: ch.epfl.lamp.compiler.msil.Type)ch.epfl.lamp.compiler.msil.Type">mkArrayType</a><span class="delimiter">(</span><a href="../../symtab/clr/CLRTypes.scala.html#601565" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MBYTE</a><span class="delimiter">)</span>

    <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.Type" id="636612">ICLONEABLE</a> = <a href="../../symtab/SymbolLoaders.scala.html#506452" title="object GenMSIL.this.global.loaders.clrTypes">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#601655" title="(name: String)ch.epfl.lamp.compiler.msil.Type">getType</a><span class="delimiter">(</span><span title="java.lang.String(&quot;System.ICloneable&quot;)" class="string">&quot;System.ICloneable&quot;</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.MethodInfo" id="636614">MEMBERWISE_CLONE</a> = <a href="../../symtab/clr/CLRTypes.scala.html#601610" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MOBJECT</a>.<span title="(x$1: java.lang.String, x$2: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.MethodInfo">GetMethod</span><span class="delimiter">(</span><span title="java.lang.String(&quot;MemberwiseClone&quot;)" class="string">&quot;MemberwiseClone&quot;</span>, <span title="object ch.epfl.lamp.compiler.msil.Type">MsilType</span>.<span title="Array[ch.epfl.lamp.compiler.msil.Type]">EmptyTypes</span><span class="delimiter">)</span>

    <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.Type" id="636616">MMONITOR</a>       = <a href="../../symtab/SymbolLoaders.scala.html#506452" title="object GenMSIL.this.global.loaders.clrTypes">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#601655" title="(name: String)ch.epfl.lamp.compiler.msil.Type">getType</a><span class="delimiter">(</span><span title="java.lang.String(&quot;System.Threading.Monitor&quot;)" class="string">&quot;System.Threading.Monitor&quot;</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.MethodInfo" id="636618">MMONITOR_ENTER</a> = <a href="#636616" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MMONITOR</a>.<span title="(x$1: java.lang.String, x$2: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.MethodInfo">GetMethod</span><span class="delimiter">(</span><span title="java.lang.String(&quot;Enter&quot;)" class="string">&quot;Enter&quot;</span>, <a href="../../../../Array.scala.html#62681" title="(xs: ch.epfl.lamp.compiler.msil.Type*)(implicit evidence$2: scala.reflect.ClassManifest[ch.epfl.lamp.compiler.msil.Type])Array[ch.epfl.lamp.compiler.msil.Type]">Array</a><a href="../../../../reflect/ClassManifest.scala.html#56840" title="(clazz: java.lang.Class[_])scala.reflect.ClassManifest[ch.epfl.lamp.compiler.msil.Type]" class="delimiter">(</a><a href="../../symtab/clr/CLRTypes.scala.html#601610" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MOBJECT</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.MethodInfo" id="636620">MMONITOR_EXIT</a>  = <a href="#636616" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MMONITOR</a>.<span title="(x$1: java.lang.String, x$2: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.MethodInfo">GetMethod</span><span class="delimiter">(</span><span title="java.lang.String(&quot;Exit&quot;)" class="string">&quot;Exit&quot;</span>, <a href="../../../../Array.scala.html#62681" title="(xs: ch.epfl.lamp.compiler.msil.Type*)(implicit evidence$2: scala.reflect.ClassManifest[ch.epfl.lamp.compiler.msil.Type])Array[ch.epfl.lamp.compiler.msil.Type]">Array</a><a href="../../../../reflect/ClassManifest.scala.html#56840" title="(clazz: java.lang.Class[_])scala.reflect.ClassManifest[ch.epfl.lamp.compiler.msil.Type]" class="delimiter">(</a><a href="../../symtab/clr/CLRTypes.scala.html#601610" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MOBJECT</a><span class="delimiter">)</span><span class="delimiter">)</span>

    <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.Type" id="636622">MSTRING_BUILDER</a> = <a href="../../symtab/SymbolLoaders.scala.html#506452" title="object GenMSIL.this.global.loaders.clrTypes">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#601655" title="(name: String)ch.epfl.lamp.compiler.msil.Type">getType</a><span class="delimiter">(</span><span title="java.lang.String(&quot;System.Text.StringBuilder&quot;)" class="string">&quot;System.Text.StringBuilder&quot;</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.ConstructorInfo" id="636624">MSTRING_BUILDER_CONSTR</a> = <a href="#636622" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MSTRING_BUILDER</a>.<span title="(x$1: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.ConstructorInfo">GetConstructor</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.Type">MsilType</span>.<span title="Array[ch.epfl.lamp.compiler.msil.Type]">EmptyTypes</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.MethodInfo" id="636626">MSTRING_BUILDER_TOSTRING</a> = <a href="#636622" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MSTRING_BUILDER</a>.<span title="(x$1: java.lang.String, x$2: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.MethodInfo">GetMethod</span><span class="delimiter">(</span><span title="java.lang.String(&quot;ToString&quot;)" class="string">&quot;ToString&quot;</span>,
                                                             <span title="object ch.epfl.lamp.compiler.msil.Type">MsilType</span>.<span title="Array[ch.epfl.lamp.compiler.msil.Type]">EmptyTypes</span><span class="delimiter">)</span>

    <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.MethodInfo" id="636628">TYPE_FROM_HANDLE</a> =
      <a href="../../symtab/SymbolLoaders.scala.html#506452" title="object GenMSIL.this.global.loaders.clrTypes">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#601655" title="(name: String)ch.epfl.lamp.compiler.msil.Type">getType</a><span class="delimiter">(</span><span title="java.lang.String(&quot;System.Type&quot;)" class="string">&quot;System.Type&quot;</span><span class="delimiter">)</span>.<span title="(x$1: java.lang.String, x$2: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.MethodInfo">GetMethod</span><span class="delimiter">(</span><span title="java.lang.String(&quot;GetTypeFromHandle&quot;)" class="string">&quot;GetTypeFromHandle&quot;</span>, <a href="../../../../Array.scala.html#62681" title="(xs: ch.epfl.lamp.compiler.msil.Type*)(implicit evidence$2: scala.reflect.ClassManifest[ch.epfl.lamp.compiler.msil.Type])Array[ch.epfl.lamp.compiler.msil.Type]">Array</a><a href="../../../../reflect/ClassManifest.scala.html#56840" title="(clazz: java.lang.Class[_])scala.reflect.ClassManifest[ch.epfl.lamp.compiler.msil.Type]" class="delimiter">(</a><a href="../../symtab/SymbolLoaders.scala.html#506452" title="object GenMSIL.this.global.loaders.clrTypes">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#601655" title="(name: String)ch.epfl.lamp.compiler.msil.Type">getType</a><span class="delimiter">(</span><span title="java.lang.String(&quot;System.RuntimeTypeHandle&quot;)" class="string">&quot;System.RuntimeTypeHandle&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>

    <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.Type" id="636630">INT_PTR</a> = <a href="../../symtab/SymbolLoaders.scala.html#506452" title="object GenMSIL.this.global.loaders.clrTypes">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#601655" title="(name: String)ch.epfl.lamp.compiler.msil.Type">getType</a><span class="delimiter">(</span><span title="java.lang.String(&quot;System.IntPtr&quot;)" class="string">&quot;System.IntPtr&quot;</span><span class="delimiter">)</span>

    <span class="keyword">val</span> <a title="GenMSIL.this.global.Symbol" id="636632">JOBJECT</a> = <a href="../../symtab/Definitions.scala.html#479030" title="object GenMSIL.this.global.definitions">definitions</a>.<a href="../../symtab/Definitions.scala.html#507925" title="=&gt; GenMSIL.this.global.Symbol">ObjectClass</a>
    <span class="keyword">val</span> <a title="GenMSIL.this.global.Symbol" id="636634">JSTRING</a> = <a href="../../symtab/Definitions.scala.html#479030" title="object GenMSIL.this.global.definitions">definitions</a>.<a href="../../symtab/Definitions.scala.html#508005" title="=&gt; GenMSIL.this.global.Symbol">StringClass</a>

    <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.Type" id="636636">SystemConvert</a> = <a href="../../symtab/SymbolLoaders.scala.html#506452" title="object GenMSIL.this.global.loaders.clrTypes">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#601655" title="(name: String)ch.epfl.lamp.compiler.msil.Type">getType</a><span class="delimiter">(</span><span title="java.lang.String(&quot;System.Convert&quot;)" class="string">&quot;System.Convert&quot;</span><span class="delimiter">)</span>

    <span class="keyword">val</span> <a title="Array[ch.epfl.lamp.compiler.msil.Type]" id="636638">objParam</a> = <a href="../../../../Array.scala.html#62681" title="(xs: ch.epfl.lamp.compiler.msil.Type*)(implicit evidence$2: scala.reflect.ClassManifest[ch.epfl.lamp.compiler.msil.Type])Array[ch.epfl.lamp.compiler.msil.Type]">Array</a><a href="../../../../reflect/ClassManifest.scala.html#56840" title="(clazz: java.lang.Class[_])scala.reflect.ClassManifest[ch.epfl.lamp.compiler.msil.Type]" class="delimiter">(</a><a href="../../symtab/clr/CLRTypes.scala.html#601610" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MOBJECT</a><span class="delimiter">)</span>

    <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.MethodInfo" id="636640">toBool</a>:   <span title="ch.epfl.lamp.compiler.msil.MethodInfo">MethodInfo</span> = <a href="#636636" title="=&gt; ch.epfl.lamp.compiler.msil.Type">SystemConvert</a>.<span title="(x$1: java.lang.String, x$2: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.MethodInfo">GetMethod</span><span class="delimiter">(</span><span title="java.lang.String(&quot;ToBoolean&quot;)" class="string">&quot;ToBoolean&quot;</span>, <a href="#636638" title="=&gt; Array[ch.epfl.lamp.compiler.msil.Type]">objParam</a><span class="delimiter">)</span> <span class="comment">// see comment in emitUnbox</span>
    <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.MethodInfo" id="636642">toSByte</a>:  <span title="ch.epfl.lamp.compiler.msil.MethodInfo">MethodInfo</span> = <a href="#636636" title="=&gt; ch.epfl.lamp.compiler.msil.Type">SystemConvert</a>.<span title="(x$1: java.lang.String, x$2: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.MethodInfo">GetMethod</span><span class="delimiter">(</span><span title="java.lang.String(&quot;ToSByte&quot;)" class="string">&quot;ToSByte&quot;</span>,   <a href="#636638" title="=&gt; Array[ch.epfl.lamp.compiler.msil.Type]">objParam</a><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.MethodInfo" id="636644">toShort</a>:  <span title="ch.epfl.lamp.compiler.msil.MethodInfo">MethodInfo</span> = <a href="#636636" title="=&gt; ch.epfl.lamp.compiler.msil.Type">SystemConvert</a>.<span title="(x$1: java.lang.String, x$2: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.MethodInfo">GetMethod</span><span class="delimiter">(</span><span title="java.lang.String(&quot;ToInt16&quot;)" class="string">&quot;ToInt16&quot;</span>,   <a href="#636638" title="=&gt; Array[ch.epfl.lamp.compiler.msil.Type]">objParam</a><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.MethodInfo" id="636646">toChar</a>:   <span title="ch.epfl.lamp.compiler.msil.MethodInfo">MethodInfo</span> = <a href="#636636" title="=&gt; ch.epfl.lamp.compiler.msil.Type">SystemConvert</a>.<span title="(x$1: java.lang.String, x$2: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.MethodInfo">GetMethod</span><span class="delimiter">(</span><span title="java.lang.String(&quot;ToChar&quot;)" class="string">&quot;ToChar&quot;</span>,    <a href="#636638" title="=&gt; Array[ch.epfl.lamp.compiler.msil.Type]">objParam</a><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.MethodInfo" id="636648">toInt</a>:    <span title="ch.epfl.lamp.compiler.msil.MethodInfo">MethodInfo</span> = <a href="#636636" title="=&gt; ch.epfl.lamp.compiler.msil.Type">SystemConvert</a>.<span title="(x$1: java.lang.String, x$2: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.MethodInfo">GetMethod</span><span class="delimiter">(</span><span title="java.lang.String(&quot;ToInt32&quot;)" class="string">&quot;ToInt32&quot;</span>,   <a href="#636638" title="=&gt; Array[ch.epfl.lamp.compiler.msil.Type]">objParam</a><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.MethodInfo" id="636650">toLong</a>:   <span title="ch.epfl.lamp.compiler.msil.MethodInfo">MethodInfo</span> = <a href="#636636" title="=&gt; ch.epfl.lamp.compiler.msil.Type">SystemConvert</a>.<span title="(x$1: java.lang.String, x$2: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.MethodInfo">GetMethod</span><span class="delimiter">(</span><span title="java.lang.String(&quot;ToInt64&quot;)" class="string">&quot;ToInt64&quot;</span>,   <a href="#636638" title="=&gt; Array[ch.epfl.lamp.compiler.msil.Type]">objParam</a><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.MethodInfo" id="636652">toFloat</a>:  <span title="ch.epfl.lamp.compiler.msil.MethodInfo">MethodInfo</span> = <a href="#636636" title="=&gt; ch.epfl.lamp.compiler.msil.Type">SystemConvert</a>.<span title="(x$1: java.lang.String, x$2: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.MethodInfo">GetMethod</span><span class="delimiter">(</span><span title="java.lang.String(&quot;ToSingle&quot;)" class="string">&quot;ToSingle&quot;</span>,  <a href="#636638" title="=&gt; Array[ch.epfl.lamp.compiler.msil.Type]">objParam</a><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.MethodInfo" id="636654">toDouble</a>: <span title="ch.epfl.lamp.compiler.msil.MethodInfo">MethodInfo</span> = <a href="#636636" title="=&gt; ch.epfl.lamp.compiler.msil.Type">SystemConvert</a>.<span title="(x$1: java.lang.String, x$2: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.MethodInfo">GetMethod</span><span class="delimiter">(</span><span title="java.lang.String(&quot;ToDouble&quot;)" class="string">&quot;ToDouble&quot;</span>,  <a href="#636638" title="=&gt; Array[ch.epfl.lamp.compiler.msil.Type]">objParam</a><span class="delimiter">)</span>

    <span class="comment">//val boxedUnit: FieldInfo = msilType(definitions.BoxedUnitModule.info).GetField(&quot;UNIT&quot;)</span>
    <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.FieldInfo" id="636656">boxedUnit</a>: <span title="ch.epfl.lamp.compiler.msil.FieldInfo">FieldInfo</span> = <a href="../../../../collection/MapLike.scala.html#73204" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol)ch.epfl.lamp.compiler.msil.FieldInfo">fields</a><span class="delimiter">(</span><a href="../../symtab/Definitions.scala.html#479030" title="object GenMSIL.this.global.definitions">definitions</a>.<a href="../../symtab/Definitions.scala.html#508305" title="=&gt; GenMSIL.this.global.Symbol">BoxedUnit_UNIT</a><span class="delimiter">)</span>

    <span class="comment">// Scala attributes</span>
    <span class="comment">// symtab.Definitions -&gt; object (singleton..)</span>
    <span class="keyword">val</span> <a title="GenMSIL.this.global.Type" id="636658">SerializableAttr</a> = <a href="../../symtab/Definitions.scala.html#479030" title="object GenMSIL.this.global.definitions">definitions</a>.<a href="../../symtab/Definitions.scala.html#508329" title="=&gt; GenMSIL.this.global.Symbol">SerializableAttr</a>.<a href="../../symtab/Symbols.scala.html#509270" title="=&gt; GenMSIL.this.global.Type">tpe</a>
    <span class="keyword">val</span> <a title="GenMSIL.this.global.Type" id="636660">CloneableAttr</a>    = <a href="../../symtab/Definitions.scala.html#479030" title="object GenMSIL.this.global.definitions">definitions</a>.<a href="../../symtab/Definitions.scala.html#508340" title="(fullname: GenMSIL.this.global.Name)GenMSIL.this.global.Symbol">getClass</a><span class="delimiter">(</span><a href="../../../../reflect/generic/StdNames.scala.html#434009" title="implicit scala.reflect.generic.StdNames.stringToTermName : (s: String)GenMSIL.this.global.TermName" class="string">&quot;scala.cloneable&quot;</a><span class="delimiter">)</span>.<a href="../../symtab/Symbols.scala.html#509270" title="=&gt; GenMSIL.this.global.Type">tpe</a>
    <span class="keyword">val</span> <a title="GenMSIL.this.global.Type" id="636662">TransientAtt</a>     = <a href="../../symtab/Definitions.scala.html#479030" title="object GenMSIL.this.global.definitions">definitions</a>.<a href="../../symtab/Definitions.scala.html#508340" title="(fullname: GenMSIL.this.global.Name)GenMSIL.this.global.Symbol">getClass</a><span class="delimiter">(</span><a href="../../../../reflect/generic/StdNames.scala.html#434009" title="implicit scala.reflect.generic.StdNames.stringToTermName : (s: String)GenMSIL.this.global.TermName" class="string">&quot;scala.transient&quot;</a><span class="delimiter">)</span>.<a href="../../symtab/Symbols.scala.html#509270" title="=&gt; GenMSIL.this.global.Type">tpe</a>
    <span class="comment">// remoting: the architectures are too different, no mapping (no portable code</span>
    <span class="comment">// possible)</span>

    <span class="comment">// java instance methods that are mapped to static methods in .net</span>
    <span class="comment">// these will need to be called with OpCodes.Call (not Callvirt)</span>
    <span class="keyword">val</span> <a title="scala.collection.mutable.HashSet[GenMSIL.this.global.Symbol]" id="636664">dynToStatMapped</a>: <a href="../../../../collection/mutable/HashSet.scala.html#14593" title="scala.collection.mutable.HashSet[GenMSIL.this.global.Symbol]">HashSet</a><span class="delimiter">[</span>Symbol<span class="delimiter">]</span> = <a href="../../../../collection/mutable/HashSet.scala.html#108311" title="()scala.collection.mutable.HashSet[GenMSIL.this.global.Symbol]" class="keyword">new</a> <a href="../../../../collection/mutable/HashSet.scala.html#14593" title="scala.collection.mutable.HashSet[GenMSIL.this.global.Symbol]">HashSet</a><span class="delimiter">(</span><span class="delimiter">)</span>

    <a href="#636666" title="()Unit">initMappings</a><span class="delimiter">(</span><span class="delimiter">)</span>

    <span class="comment">/** Create the mappings between java and .net classes and methods */</span>
    <span class="keyword">private</span> <span class="keyword">def</span> <a title="()Unit" id="636666">initMappings</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#636767" title="(sym: GenMSIL.this.global.Symbol, mType: ch.epfl.lamp.compiler.msil.Type)Unit">mapType</a><span class="delimiter">(</span><a href="../../symtab/Definitions.scala.html#479030" title="object GenMSIL.this.global.definitions">definitions</a>.<a href="../../symtab/Definitions.scala.html#507921" title="=&gt; GenMSIL.this.global.Symbol">AnyClass</a>, <a href="../../symtab/clr/CLRTypes.scala.html#601610" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MOBJECT</a><span class="delimiter">)</span>
      <a href="#636767" title="(sym: GenMSIL.this.global.Symbol, mType: ch.epfl.lamp.compiler.msil.Type)Unit">mapType</a><span class="delimiter">(</span><a href="../../symtab/Definitions.scala.html#479030" title="object GenMSIL.this.global.definitions">definitions</a>.<a href="../../symtab/Definitions.scala.html#507923" title="=&gt; GenMSIL.this.global.Symbol">AnyRefClass</a>, <a href="../../symtab/clr/CLRTypes.scala.html#601610" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MOBJECT</a><span class="delimiter">)</span>
      <span class="comment">//mapType(definitions.NullClass, clrTypes.getType(&quot;scala.AllRef$&quot;))</span>
      <span class="comment">//mapType(definitions.NothingClass, clrTypes.getType(&quot;scala.All$&quot;))</span>
      <span class="comment">// FIXME: for some reason the upper two lines map to null</span>
      <a href="#636767" title="(sym: GenMSIL.this.global.Symbol, mType: ch.epfl.lamp.compiler.msil.Type)Unit">mapType</a><span class="delimiter">(</span><a href="../../symtab/Definitions.scala.html#479030" title="object GenMSIL.this.global.definitions">definitions</a>.<a href="../../symtab/Definitions.scala.html#507931" title="=&gt; GenMSIL.this.global.Symbol">NullClass</a>, <a href="#636608" title="=&gt; ch.epfl.lamp.compiler.msil.Type">EXCEPTION</a><span class="delimiter">)</span>
      <a href="#636767" title="(sym: GenMSIL.this.global.Symbol, mType: ch.epfl.lamp.compiler.msil.Type)Unit">mapType</a><span class="delimiter">(</span><a href="../../symtab/Definitions.scala.html#479030" title="object GenMSIL.this.global.definitions">definitions</a>.<a href="../../symtab/Definitions.scala.html#507933" title="=&gt; GenMSIL.this.global.Symbol">NothingClass</a>, <a href="#636608" title="=&gt; ch.epfl.lamp.compiler.msil.Type">EXCEPTION</a><span class="delimiter">)</span>

      <a href="#636767" title="(sym: GenMSIL.this.global.Symbol, mType: ch.epfl.lamp.compiler.msil.Type)Unit">mapType</a><span class="delimiter">(</span><a href="../../symtab/Definitions.scala.html#479030" title="object GenMSIL.this.global.definitions">definitions</a>.<a href="../../symtab/Definitions.scala.html#508439" title="=&gt; GenMSIL.this.global.Symbol">BooleanClass</a>, <a href="../../symtab/clr/CLRTypes.scala.html#601598" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MBOOL</a><span class="delimiter">)</span>
      <a href="#636767" title="(sym: GenMSIL.this.global.Symbol, mType: ch.epfl.lamp.compiler.msil.Type)Unit">mapType</a><span class="delimiter">(</span><a href="../../symtab/Definitions.scala.html#479030" title="object GenMSIL.this.global.definitions">definitions</a>.<a href="../../symtab/Definitions.scala.html#508425" title="=&gt; GenMSIL.this.global.Symbol">ByteClass</a>, <a href="../../symtab/clr/CLRTypes.scala.html#601565" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MBYTE</a><span class="delimiter">)</span>
      <a href="#636767" title="(sym: GenMSIL.this.global.Symbol, mType: ch.epfl.lamp.compiler.msil.Type)Unit">mapType</a><span class="delimiter">(</span><a href="../../symtab/Definitions.scala.html#479030" title="object GenMSIL.this.global.definitions">definitions</a>.<a href="../../symtab/Definitions.scala.html#508427" title="=&gt; GenMSIL.this.global.Symbol">ShortClass</a>, <a href="../../symtab/clr/CLRTypes.scala.html#601571" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MSHORT</a><span class="delimiter">)</span>
      <a href="#636767" title="(sym: GenMSIL.this.global.Symbol, mType: ch.epfl.lamp.compiler.msil.Type)Unit">mapType</a><span class="delimiter">(</span><a href="../../symtab/Definitions.scala.html#479030" title="object GenMSIL.this.global.definitions">definitions</a>.<a href="../../symtab/Definitions.scala.html#508429" title="=&gt; GenMSIL.this.global.Symbol">CharClass</a>, <a href="../../symtab/clr/CLRTypes.scala.html#601577" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MCHAR</a><span class="delimiter">)</span>
      <a href="#636767" title="(sym: GenMSIL.this.global.Symbol, mType: ch.epfl.lamp.compiler.msil.Type)Unit">mapType</a><span class="delimiter">(</span><a href="../../symtab/Definitions.scala.html#479030" title="object GenMSIL.this.global.definitions">definitions</a>.<a href="../../symtab/Definitions.scala.html#508431" title="=&gt; GenMSIL.this.global.Symbol">IntClass</a>, <a href="../../symtab/clr/CLRTypes.scala.html#601580" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MINT</a><span class="delimiter">)</span>
      <a href="#636767" title="(sym: GenMSIL.this.global.Symbol, mType: ch.epfl.lamp.compiler.msil.Type)Unit">mapType</a><span class="delimiter">(</span><a href="../../symtab/Definitions.scala.html#479030" title="object GenMSIL.this.global.definitions">definitions</a>.<a href="../../symtab/Definitions.scala.html#508433" title="=&gt; GenMSIL.this.global.Symbol">LongClass</a>, <a href="../../symtab/clr/CLRTypes.scala.html#601586" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MLONG</a><span class="delimiter">)</span>
      <a href="#636767" title="(sym: GenMSIL.this.global.Symbol, mType: ch.epfl.lamp.compiler.msil.Type)Unit">mapType</a><span class="delimiter">(</span><a href="../../symtab/Definitions.scala.html#479030" title="object GenMSIL.this.global.definitions">definitions</a>.<a href="../../symtab/Definitions.scala.html#508435" title="=&gt; GenMSIL.this.global.Symbol">FloatClass</a>, <a href="../../symtab/clr/CLRTypes.scala.html#601592" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MFLOAT</a><span class="delimiter">)</span>
      <a href="#636767" title="(sym: GenMSIL.this.global.Symbol, mType: ch.epfl.lamp.compiler.msil.Type)Unit">mapType</a><span class="delimiter">(</span><a href="../../symtab/Definitions.scala.html#479030" title="object GenMSIL.this.global.definitions">definitions</a>.<a href="../../symtab/Definitions.scala.html#508437" title="=&gt; GenMSIL.this.global.Symbol">DoubleClass</a>, <a href="../../symtab/clr/CLRTypes.scala.html#601595" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MDOUBLE</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="keyword">var</span> <a title="GenMSIL.this.global.icodes.IClass" id="636668">clasz</a>: <a href="../icode/Members.scala.html#501261" title="GenMSIL.this.global.icodes.IClass">IClass</a> = _
    <span class="keyword">var</span> <a title="GenMSIL.this.global.icodes.IMethod" id="636671">method</a>: <a href="../icode/Members.scala.html#501263" title="GenMSIL.this.global.icodes.IMethod">IMethod</a> = _

    <span class="keyword">var</span> <a title="ch.epfl.lamp.compiler.msil.emit.AssemblyBuilder" id="636674">massembly</a>: <span title="ch.epfl.lamp.compiler.msil.emit.AssemblyBuilder">AssemblyBuilder</span> = _
    <span class="keyword">var</span> <a title="ch.epfl.lamp.compiler.msil.emit.ModuleBuilder" id="636677">mmodule</a>: <span title="ch.epfl.lamp.compiler.msil.emit.ModuleBuilder">ModuleBuilder</span> = _
    <span class="keyword">var</span> <a title="ch.epfl.lamp.compiler.msil.emit.ILGenerator" id="636680">mcode</a>: <span title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">ILGenerator</span> = _

    <span class="keyword">var</span> <a title="String" id="636683">assemName</a>: <span title="String">String</span> = _
    <span class="keyword">var</span> <a title="java.lang.String" id="636686">firstSourceName</a> = <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span>
    <span class="keyword">var</span> <a title="java.io.File" id="636689">outDir</a>: <span title="java.io.File">File</span> = _
    <span class="keyword">var</span> <a title="java.io.File" id="636692">srcPath</a>: <span title="java.io.File">File</span> = _
    <span class="keyword">var</span> <a title="String" id="636695">moduleName</a>: <span title="String">String</span> = _

    <span class="keyword">def</span> <a title="()Unit" id="636697">initAssembly</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>

      <a href="#636683" title="(x$1: String)Unit">assemName</a> = <a href="../../Global.scala.html#478200" title="=&gt; scala.tools.nsc.Settings">settings</a>.<a href="../../settings/ScalaSettings.scala.html#469639" title="=&gt; scala.tools.nsc.Settings#StringSetting">assemname</a>.<a href="../../settings/MutableSettings.scala.html#470030" title="=&gt; java.lang.String">value</a>

      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#636683" title="=&gt; String">assemName</a> <span title="(x$1: AnyRef)Boolean">==</span> <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#636755" title="=&gt; GenMSIL.this.global.Symbol">entryPoint</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="#636683" title="(x$1: String)Unit">assemName</a> = <a href="#636750" title="(sym: GenMSIL.this.global.Symbol)String">msilName</a><span class="delimiter">(</span><a href="#636755" title="=&gt; GenMSIL.this.global.Symbol">entryPoint</a>.<a href="../../../../reflect/generic/Symbols.scala.html#435409" title="=&gt; GenMSIL.this.global.Symbol">enclClass</a><span class="delimiter">)</span>
          <span class="comment">// remove the $ at the end (from module-name)</span>
          <a href="#636683" title="(x$1: String)Unit">assemName</a> = <a href="#636683" title="=&gt; String">assemName</a>.<span title="(x$1: Int, x$2: Int)java.lang.String">substring</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span>, <a href="#636683" title="=&gt; String">assemName</a>.<span title="()Int">length</span><span class="delimiter">(</span><span class="delimiter">)</span> <a href="../../../../Int.scala.html#54811" title="(x: Int)Int">-</a> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
        <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
          <span class="comment">// assuming filename of first source file</span>
          <a href="../../../../Predef.scala.html#9566" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a><span class="delimiter">(</span><a href="#636686" title="=&gt; java.lang.String">firstSourceName</a>.<span title="(x$1: java.lang.String)Boolean">endsWith</span><span class="delimiter">(</span><span title="java.lang.String(&quot;.scala&quot;)" class="string">&quot;.scala&quot;</span><span class="delimiter">)</span>, <a href="#636686" title="=&gt; java.lang.String">firstSourceName</a><span class="delimiter">)</span>
          <a href="#636683" title="(x$1: String)Unit">assemName</a> = <a href="#636686" title="=&gt; java.lang.String">firstSourceName</a>.<span title="(x$1: Int, x$2: Int)java.lang.String">substring</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span>, <a href="#636686" title="=&gt; java.lang.String">firstSourceName</a>.<span title="()Int">length</span><span class="delimiter">(</span><span class="delimiter">)</span> <a href="../../../../Int.scala.html#54811" title="(x: Int)Int">-</a> <span title="Int(6)" class="int">6</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#636683" title="=&gt; String">assemName</a>.<span title="(x$1: java.lang.String)Boolean">endsWith</span><span class="delimiter">(</span><span title="java.lang.String(&quot;.msil&quot;)" class="string">&quot;.msil&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
          <a href="#636683" title="(x$1: String)Unit">assemName</a> = <a href="#636683" title="=&gt; String">assemName</a>.<span title="(x$1: Int, x$2: Int)java.lang.String">substring</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span>, <a href="#636683" title="=&gt; String">assemName</a>.<span title="()Int">length</span><span class="delimiter">(</span><span class="delimiter">)</span><a href="../../../../Int.scala.html#54811" title="(x: Int)Int">-</a><span title="Int(5)" class="int">5</span><span class="delimiter">)</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#636683" title="=&gt; String">assemName</a>.<span title="(x$1: java.lang.String)Boolean">endsWith</span><span class="delimiter">(</span><span title="java.lang.String(&quot;.il&quot;)" class="string">&quot;.il&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
          <a href="#636683" title="(x$1: String)Unit">assemName</a> = <a href="#636683" title="=&gt; String">assemName</a>.<span title="(x$1: Int, x$2: Int)java.lang.String">substring</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span>, <a href="#636683" title="=&gt; String">assemName</a>.<span title="()Int">length</span><span class="delimiter">(</span><span class="delimiter">)</span><a href="../../../../Int.scala.html#54811" title="(x: Int)Int">-</a><span title="Int(3)" class="int">3</span><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="java.io.File" id="637675">f</a>: <span title="java.io.File">File</span> = <span title="java.io.File" class="keyword">new</span> <span title="java.io.File">File</span><span class="delimiter">(</span><a href="#636683" title="=&gt; String">assemName</a><span class="delimiter">)</span>
        <a href="#636683" title="(x$1: String)Unit">assemName</a> = <a href="#637675" title="java.io.File">f</a>.<span title="()java.lang.String">getName</span><span class="delimiter">(</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>

      <a href="#636689" title="(x$1: java.io.File)Unit">outDir</a> = <span title="java.io.File" class="keyword">new</span> <span title="java.io.File">File</span><span class="delimiter">(</span><a href="../../Global.scala.html#478200" title="=&gt; scala.tools.nsc.Settings">settings</a>.<a href="../../settings/ScalaSettings.scala.html#469709" title="=&gt; scala.tools.nsc.Settings#OutputSetting">outdir</a>.<a href="../../settings/MutableSettings.scala.html#470030" title="=&gt; java.lang.String">value</a><span class="delimiter">)</span>

      <a href="#636692" title="(x$1: java.io.File)Unit">srcPath</a> = <span title="java.io.File" class="keyword">new</span> <span title="java.io.File">File</span><span class="delimiter">(</span><a href="../../Global.scala.html#478200" title="=&gt; scala.tools.nsc.Settings">settings</a>.<a href="../../settings/ScalaSettings.scala.html#469645" title="=&gt; scala.tools.nsc.Settings#StringSetting">sourcedir</a>.<a href="../../settings/MutableSettings.scala.html#470030" title="=&gt; java.lang.String">value</a><span class="delimiter">)</span>

      <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.AssemblyName" id="637641">assemblyName</a> = <span title="ch.epfl.lamp.compiler.msil.AssemblyName" class="keyword">new</span> <span title="ch.epfl.lamp.compiler.msil.AssemblyName">AssemblyName</span><span class="delimiter">(</span><span class="delimiter">)</span>
      <a href="#637641" title="ch.epfl.lamp.compiler.msil.AssemblyName">assemblyName</a>.<span title="java.lang.String">Name</span> = <a href="#636683" title="=&gt; String">assemName</a>
      <a href="#636674" title="(x$1: ch.epfl.lamp.compiler.msil.emit.AssemblyBuilder)Unit">massembly</a> = <span title="object ch.epfl.lamp.compiler.msil.emit.AssemblyBuilderFactory">AssemblyBuilderFactory</span>.<span title="(name: ch.epfl.lamp.compiler.msil.AssemblyName)ch.epfl.lamp.compiler.msil.emit.AssemblyBuilder">DefineDynamicAssembly</span><span class="delimiter">(</span><a href="#637641" title="ch.epfl.lamp.compiler.msil.AssemblyName">assemblyName</a><span class="delimiter">)</span>

      <a href="#636695" title="(x$1: String)Unit">moduleName</a> = <a href="#636683" title="=&gt; String">assemName</a> <span class="comment">// + (if (entryPoint == null) &quot;.dll&quot; else &quot;.exe&quot;)</span>
      <span class="comment">// filename here: .dll or .exe (in both parameters), second: give absolute-path</span>
      <a href="#636677" title="(x$1: ch.epfl.lamp.compiler.msil.emit.ModuleBuilder)Unit">mmodule</a> = <a href="#636674" title="=&gt; ch.epfl.lamp.compiler.msil.emit.AssemblyBuilder">massembly</a>.<span title="(name: String, fileName: String)ch.epfl.lamp.compiler.msil.emit.ModuleBuilder">DefineDynamicModule</span><span class="delimiter">(</span><a href="#636695" title="=&gt; String">moduleName</a>,
                                              <span title="(x$1: java.io.File, x$2: java.lang.String)java.io.File" class="keyword">new</span> <span title="java.io.File">File</span><span class="delimiter">(</span><a href="#636689" title="=&gt; java.io.File">outDir</a>, <a href="#636695" title="=&gt; String">moduleName</a><span class="delimiter">)</span>.<span title="()java.lang.String">getAbsolutePath</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="../../../../Predef.scala.html#9565" title="(assertion: Boolean)Unit">assert</a> <span class="delimiter">(</span><a href="#636677" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ModuleBuilder">mmodule</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>


    <span class="comment">/**
     * Form of the custom Attribute parameter (Ecma-335.pdf)
     *      - p. 163 for CustomAttrib Form,
     *      - p. 164 for FixedArg Form (Array and Element) (if array or not is known!)
     *  !! least significant byte first if values longer than one byte !!
     *
     * 1: Prolog (unsigned int16, value 0x0001) -&gt; symtab[0] = 0x01, symtab[1] = 0x00
     * 2: FixedArgs (directly the data, get number and types from related constructor)
     *  2.1: length of the array (unsigned int32, 4 bytes, least significant first)
     *  2.2: the byte array data
     * 3: NumNamed (unsigned int16, number of named fields and properties, 0x0000)
     */</span>
    <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol, tBuilder: ch.epfl.lamp.compiler.msil.emit.TypeBuilder)Unit" id="636698">addSymtabAttribute</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="637833">sym</a>: <a href="../../symtab/Symbols.scala.html#478659" title="GenMSIL.this.global.Symbol">Symbol</a>, <a title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder" id="637834">tBuilder</a>: <span title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">TypeBuilder</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="keyword">def</span> <a title="()Unit" id="637836">addMarker</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="Array[Byte]" id="637837">markerSymtab</a> = <span title="Array[Byte]" class="keyword">new</span> <a href="../../../../Array.scala.html#1430" title="Array[Byte]">Array</a><span class="delimiter">[</span>Byte<span class="delimiter">]</span><span class="delimiter">(</span><span title="Int(4)" class="int">4</span><span class="delimiter">)</span>
        <a href="../../../../Array.scala.html#49206" title="(i: Int, x: Byte)Unit">markerSymtab</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span> = <span title="Int(1)" class="int">1</span>.<a href="../../../../Int.scala.html#54727" title="=&gt; Byte">toByte</a>
        <a href="#637834" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">tBuilder</a>.<span title="(constr: ch.epfl.lamp.compiler.msil.ConstructorInfo, value: Array[Byte])Unit">SetCustomAttribute</span><span class="delimiter">(</span><a href="../../symtab/clr/CLRTypes.scala.html#601628" title="=&gt; ch.epfl.lamp.compiler.msil.ConstructorInfo">SYMTAB_ATTRIBUTE_EMPTY_CONSTRUCTOR</a>, <a href="#637837" title="Array[Byte]">markerSymtab</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>

      <span class="comment">// both conditions are needed (why exactly..?)</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#637834" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">tBuilder</a>.<span title="java.lang.String">Name</span>.<span title="(x$1: java.lang.String)Boolean">endsWith</span><span class="delimiter">(</span><span title="java.lang.String(&quot;$&quot;)" class="string">&quot;$&quot;</span><span class="delimiter">)</span> <a href="../../../../Boolean.scala.html#55579" title="(x: Boolean)Boolean">||</a> <a href="#637833" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/generic/Symbols.scala.html#435387" title="=&gt; Boolean">isModuleClass</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#637836" title="()Unit">addMarker</a><span class="delimiter">(</span><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
        <a href="../../Global.scala.html#478362" title="=&gt; GenMSIL.this.global.Run">currentRun</a>.<a href="../../Global.scala.html#482563" title="=&gt; scala.collection.mutable.HashMap[GenMSIL.this.global.Symbol,scala.reflect.generic.PickleBuffer]">symData</a>.<a href="../../../../collection/mutable/HashMap.scala.html#73158" title="(key: GenMSIL.this.global.Symbol)Option[scala.reflect.generic.PickleBuffer]">get</a><span class="delimiter">(</span><a href="#637833" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> <span title="Unit">Some</span><span class="delimiter">(</span><a title="scala.reflect.generic.PickleBuffer" id="637854">pickle</a><span class="delimiter">)</span> =&gt;
            <span class="keyword">var</span> <a title="Int" id="637855">size</a> = <a href="#637854" title="scala.reflect.generic.PickleBuffer">pickle</a>.<a href="../../../../reflect/generic/PickleBuffer.scala.html#438983" title="=&gt; Int">writeIndex</a>
            <span class="keyword">val</span> <a title="Array[Byte]" id="637856">symtab</a> = <span title="Array[Byte]" class="keyword">new</span> <a href="../../../../Array.scala.html#1430" title="Array[Byte]">Array</a><span class="delimiter">[</span>Byte<span class="delimiter">]</span><span class="delimiter">(</span><a href="#637855" title="Int">size</a> <a href="../../../../Int.scala.html#54804" title="(x: Int)Int">+</a> <span title="Int(8)" class="int">8</span><span class="delimiter">)</span>
            <a href="../../../../Array.scala.html#49206" title="(i: Int, x: Byte)Unit">symtab</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span> = <span title="Int(1)" class="int">1</span>.<a href="../../../../Int.scala.html#54727" title="=&gt; Byte">toByte</a>
            <span class="keyword">for</span> <span class="delimiter">(</span><a title="Int" id="637997">i</a> &lt;- <a href="../../../../LowPriorityImplicits.scala.html#9474" title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">2</a> <a href="../../../../collection/immutable/Range.scala.html#63514" title="(f: Int =&gt; Unit)Unit">until</a> <span title="Int(6)" class="int">6</span><span class="delimiter">)</span> <span class="delimiter">{</span>
              <a href="../../../../Array.scala.html#49206" title="(i: Int, x: Byte)Unit">symtab</a><span class="delimiter">(</span><a href="#637997" title="Int">i</a><span class="delimiter">)</span> = <span class="delimiter">(</span><a href="#637855" title="Int">size</a> <a href="../../../../Int.scala.html#54794" title="(x: Int)Int">&amp;</a> <span title="Int(255)" class="int">0xff</span><span class="delimiter">)</span>.<a href="../../../../Int.scala.html#54727" title="=&gt; Byte">toByte</a>
              <a href="#637855" title="Int">size</a> = <a href="#637855" title="Int">size</a> <a href="../../../../Int.scala.html#54742" title="(x: Int)Int">&gt;&gt;</a> <span title="Int(8)" class="int">8</span>
            <span class="delimiter">}</span>
            java.lang.<span title="object java.lang.System">System</span>.<span title="(x$1: Any, x$2: Int, x$3: Any, x$4: Int, x$5: Int)Unit">arraycopy</span><span class="delimiter">(</span><a href="#637854" title="scala.reflect.generic.PickleBuffer">pickle</a>.<a href="../../../../reflect/generic/PickleBuffer.scala.html#438977" title="=&gt; Array[Byte]">bytes</a>, <span title="Int(0)" class="int">0</span>, <a href="#637856" title="Array[Byte]">symtab</a>, <span title="Int(6)" class="int">6</span>, <a href="#637854" title="scala.reflect.generic.PickleBuffer">pickle</a>.<a href="../../../../reflect/generic/PickleBuffer.scala.html#438983" title="=&gt; Int">writeIndex</a><span class="delimiter">)</span>

            <a href="#637834" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">tBuilder</a>.<span title="(constr: ch.epfl.lamp.compiler.msil.ConstructorInfo, value: Array[Byte])Unit">SetCustomAttribute</span><span class="delimiter">(</span><a href="../../symtab/clr/CLRTypes.scala.html#601625" title="=&gt; ch.epfl.lamp.compiler.msil.ConstructorInfo">SYMTAB_ATTRIBUTE_CONSTRUCTOR</a>, <a href="#637856" title="Array[Byte]">symtab</a><span class="delimiter">)</span>

            <a href="../../Global.scala.html#478362" title="=&gt; GenMSIL.this.global.Run">currentRun</a>.<a href="../../Global.scala.html#482563" title="=&gt; scala.collection.mutable.HashMap[GenMSIL.this.global.Symbol,scala.reflect.generic.PickleBuffer]">symData</a> <a href="../../../../collection/mutable/HashMap.scala.html#73163" title="(key: GenMSIL.this.global.Symbol)scala.collection.mutable.HashMap[GenMSIL.this.global.Symbol,scala.reflect.generic.PickleBuffer]">-=</a> <a href="#637833" title="GenMSIL.this.global.Symbol">sym</a>
            <a href="../../Global.scala.html#478362" title="=&gt; GenMSIL.this.global.Run">currentRun</a>.<a href="../../Global.scala.html#482563" title="=&gt; scala.collection.mutable.HashMap[GenMSIL.this.global.Symbol,scala.reflect.generic.PickleBuffer]">symData</a> <a href="../../../../collection/mutable/HashMap.scala.html#73163" title="(key: GenMSIL.this.global.Symbol)scala.collection.mutable.HashMap[GenMSIL.this.global.Symbol,scala.reflect.generic.PickleBuffer]">-=</a> <a href="#637833" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../symtab/Symbols.scala.html#509331" title="=&gt; GenMSIL.this.global.Symbol">companionSymbol</a>

          <span class="keyword">case</span> <span title="Unit">_</span> =&gt;
            <a href="#637836" title="()Unit">addMarker</a><span class="delimiter">(</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <span class="comment">/**
     * Mutates `member` adding CLR attributes (if any) based on sym.annotations.
     * Please notice that CLR custom modifiers are a different beast (see customModifiers below)
     * and thus shouldn't be added by this method.
     */</span>
    <span class="keyword">def</span> <a title="(member: ch.epfl.lamp.compiler.msil.emit.ICustomAttributeSetter, annotations: List[GenMSIL.this.global.AnnotationInfo])Unit" id="636699">addAttributes</a><span class="delimiter">(</span><a title="ch.epfl.lamp.compiler.msil.emit.ICustomAttributeSetter" id="638041">member</a>: <span title="ch.epfl.lamp.compiler.msil.emit.ICustomAttributeSetter">ICustomAttributeSetter</span>, <a title="List[GenMSIL.this.global.AnnotationInfo]" id="638042">annotations</a>: <a href="../../../../collection/immutable/List.scala.html#14047" title="List[GenMSIL.this.global.AnnotationInfo]">List</a><span class="delimiter">[</span>AnnotationInfo<span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="List[Null]" id="638044">attributes</a> = <a href="#638042" title="List[GenMSIL.this.global.AnnotationInfo]">annotations</a>.<a href="../../../../collection/TraversableLike.scala.html#49041" title="(f: GenMSIL.this.global.AnnotationInfo =&gt; GenMSIL.this.global.Symbol)(implicit bf: scala.collection.generic.CanBuildFrom[List[GenMSIL.this.global.AnnotationInfo],GenMSIL.this.global.Symbol,List[GenMSIL.this.global.Symbol]])List[GenMSIL.this.global.Symbol]">map</a><a href="../../../../collection/immutable/List.scala.html#48868" title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.List.Coll,GenMSIL.this.global.Symbol,List[GenMSIL.this.global.Symbol]]" class="delimiter">(</a><a href="#638061" title="GenMSIL.this.global.AnnotationInfo">_</a>.<a href="../../symtab/AnnotationInfos.scala.html#532479" title="=&gt; GenMSIL.this.global.Type">atp</a>.<a href="../../symtab/Types.scala.html#507159" title="=&gt; GenMSIL.this.global.Symbol">typeSymbol</a><span class="delimiter">)</span>.<a href="../../../../collection/TraversableLike.scala.html#49053" title="(pf: PartialFunction[GenMSIL.this.global.Symbol,Null])(implicit bf: scala.collection.generic.CanBuildFrom[List[GenMSIL.this.global.Symbol],Null,List[Null]])List[Null]">collect</a> <a href="#638108" title="Null" class="delimiter">{</a>
        <span class="keyword">case</span> <a href="../../symtab/Definitions.scala.html#479030" title="Null(null)">definitions</a>.<a href="../../symtab/Definitions.scala.html#508333" title="=&gt; GenMSIL.this.global.Symbol">TransientAttr</a> =&gt; <span title="Null(null)" class="keyword">null</span> <span class="comment">// TODO this is just an example</span>
      <span class="delimiter">}</span>
      <span title="Nothing" class="keyword">return</span> <span class="comment">// TODO: implement at some point</span>
    <span class="delimiter">}</span>

    <span class="comment">/**
     * What's a CLR custom modifier? Intro available as source comments in compiler.msil.CustomModifier.
     * It's basically a marker associated with a location (think of FieldInfo, ParameterInfo, and PropertyInfo)
     * and thus that marker (be it optional or required) becomes part of the signature of that location.
     * Some annotations will become CLR attributes (see addAttributes above), others custom modifiers (this method).
     */</span>
    <span class="keyword">def</span> <a title="(annotations: List[GenMSIL.this.global.AnnotationInfo])Array[ch.epfl.lamp.compiler.msil.CustomModifier]" id="636700">customModifiers</a><span class="delimiter">(</span><a title="List[GenMSIL.this.global.AnnotationInfo]" id="638136">annotations</a>: <a href="../../../../collection/immutable/List.scala.html#14047" title="List[GenMSIL.this.global.AnnotationInfo]">List</a><span class="delimiter">[</span>AnnotationInfo<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../../../Array.scala.html#1430" title="Array[ch.epfl.lamp.compiler.msil.CustomModifier]">Array</a><span class="delimiter">[</span>CustomModifier<span class="delimiter">]</span> = <span class="delimiter">{</span>
      <a href="#638136" title="List[GenMSIL.this.global.AnnotationInfo]">annotations</a>.<a href="../../../../collection/TraversableLike.scala.html#49041" title="(f: GenMSIL.this.global.AnnotationInfo =&gt; GenMSIL.this.global.Symbol)(implicit bf: scala.collection.generic.CanBuildFrom[List[GenMSIL.this.global.AnnotationInfo],GenMSIL.this.global.Symbol,List[GenMSIL.this.global.Symbol]])List[GenMSIL.this.global.Symbol]">map</a><a href="../../../../collection/immutable/List.scala.html#48868" title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.List.Coll,GenMSIL.this.global.Symbol,List[GenMSIL.this.global.Symbol]]" class="delimiter">(</a><a href="#638164" title="GenMSIL.this.global.AnnotationInfo">_</a>.<a href="../../symtab/AnnotationInfos.scala.html#532479" title="=&gt; GenMSIL.this.global.Type">atp</a>.<a href="../../symtab/Types.scala.html#507159" title="=&gt; GenMSIL.this.global.Symbol">typeSymbol</a><span class="delimiter">)</span>.<a href="../../../../collection/TraversableLike.scala.html#49053" title="(pf: PartialFunction[GenMSIL.this.global.Symbol,ch.epfl.lamp.compiler.msil.CustomModifier])(implicit bf: scala.collection.generic.CanBuildFrom[List[GenMSIL.this.global.Symbol],ch.epfl.lamp.compiler.msil.CustomModifier,List[ch.epfl.lamp.compiler.msil.CustomModifier]])List[ch.epfl.lamp.compiler.msil.CustomModifier]">collect</a> <a href="#638207" title="ch.epfl.lamp.compiler.msil.CustomModifier" class="delimiter">{</a>
        <span class="keyword">case</span> <a href="../../symtab/Definitions.scala.html#479030" title="ch.epfl.lamp.compiler.msil.CustomModifier">definitions</a>.<a href="../../symtab/Definitions.scala.html#508335" title="=&gt; GenMSIL.this.global.Symbol">VolatileAttr</a>  =&gt; <span title="ch.epfl.lamp.compiler.msil.CustomModifier" class="keyword">new</span> <span title="ch.epfl.lamp.compiler.msil.CustomModifier">CustomModifier</span><span class="delimiter">(</span><span title="Boolean(true)" class="keyword">true</span>, <span title="object ch.epfl.lamp.compiler.msil.CustomModifier">CustomModifier</span>.<span title="()ch.epfl.lamp.compiler.msil.Type">VolatileMarker</span><span class="delimiter">)</span>
      <span class="delimiter">}</span> <a href="../../../../collection/TraversableOnce.scala.html#53687" title="(implicit evidence$1: ClassManifest[ch.epfl.lamp.compiler.msil.CustomModifier])Array[ch.epfl.lamp.compiler.msil.CustomModifier]">toArray</a>
    <span class="delimiter">}</span>



    <span class="comment">/*
      if (settings.debug.value)
        log(&quot;creating annotations: &quot; + annotations + &quot; for member : &quot; + member)
      for (annot@ AnnotationInfo(typ, annArgs, nvPairs) &lt;- annotations ;
           if annot.isConstant)
           //!typ.typeSymbol.isJavaDefined
      {
//        assert(consts.length &lt;= 1,
//               &quot;too many constant arguments for annotations; &quot;+consts.toString())

        // Problem / TODO having the symbol of the annotations type would be nicer
        // (i hope that type.typeSymbol is the same as the one in types2create)
        // AND: this will crash if the annotations Type is already compiled (-&gt; not a typeBuilder)
        // when this is solved, types2create will be the same as icodes.classes, thus superfluous
        val annType: TypeBuilder = getType(typ.typeSymbol).asInstanceOf[TypeBuilder]
//        val annType: MsilType = getType(typ.typeSymbol)

        // Problem / TODO: i have no idea which constructor is used. This
        // information should be available in AnnotationInfo.
        annType.CreateType() // else, GetConstructors can't be used
        val constr: ConstructorInfo = annType.GetConstructors()(0)
        // prevent a second call of CreateType, only needed because there's no
        // other way than GetConstructors()(0) to get the constructor, if there's
        // no constructor symbol available.

        val args: Array[Byte] =
          getAttributeArgs(
            annArgs map (_.constant.get),
            (for((n,v) &lt;- nvPairs) yield (n, v.constant.get)))
        member.SetCustomAttribute(constr, args)
      }
    } */</span>

<span class="comment">/*    def getAttributeArgs(consts: List[Constant], nvPairs: List[(Name, Constant)]): Array[Byte] = {
      val buf = ByteBuffer.allocate(2048) // FIXME: this may be not enough!
      buf.order(ByteOrder.LITTLE_ENDIAN)
      buf.putShort(1.toShort) // signature

      def emitSerString(str: String) = {
          // this is wrong, it has to be the length of the UTF-8 byte array, which
          // may be longer (see clr-book on page 302)
//          val length: Int = str.length
            val strBytes: Array[Byte] = try {
              str.getBytes(&quot;UTF-8&quot;)
            } catch {
              case _: Error =&gt; abort(&quot;could not get byte-array for string: &quot; + str)
            }
            val length: Int = strBytes.length //this length is stored big-endian
            if (length &lt; 128)
              buf.put(length.toByte)
            else if (length &lt; (1&lt;&lt;14)) {
              buf.put(((length &gt;&gt; 8) | 0x80).toByte) // the bits 14 and 15 of length are '0'
              buf.put((length | 0xff).toByte)
            } else if (length &lt; (1 &lt;&lt; 29)) {
              buf.put(((length &gt;&gt; 24) | 0xc0).toByte)
              buf.put(((length &gt;&gt; 16) &amp; 0xff).toByte)
              buf.put(((length &gt;&gt;  8) &amp; 0xff).toByte)
              buf.put(((length      ) &amp; 0xff).toByte)
            } else
              abort(&quot;string too long for attribute parameter: &quot; + length)
            buf.put(strBytes)
      }

      def emitConst(const: Constant): Unit = const.tag match {
        case BooleanTag =&gt; buf.put((if (const.booleanValue) 1 else 0).toByte)
        case ByteTag =&gt; buf.put(const.byteValue)
        case ShortTag =&gt; buf.putShort(const.shortValue)
        case CharTag =&gt; buf.putChar(const.charValue)
        case IntTag =&gt; buf.putInt(const.intValue)
        case LongTag =&gt; buf.putLong(const.longValue)
        case FloatTag =&gt; buf.putFloat(const.floatValue)
        case DoubleTag =&gt; buf.putDouble(const.doubleValue)
        case StringTag =&gt;
          val str: String = const.stringValue
          if (str == null) {
            buf.put(0xff.toByte)
          } else {
            emitSerString(str)
          }
        case ArrayTag =&gt;
          val arr: Array[Constant] = const.arrayValue
          if (arr == null) {
            buf.putInt(0xffffffff)
          } else {
            buf.putInt(arr.length)
            arr.foreach(emitConst)
          }

        // TODO: other Tags: NoTag, UnitTag, ClassTag, EnumTag, ArrayTag ???

        case _ =&gt; abort(&quot;could not handle attribute argument: &quot; + const)
      }

      consts foreach emitConst
      buf.putShort(nvPairs.length.toShort)
      def emitNamedArg(nvPair: (Name, Constant)) {
        // the named argument is a property of the attribute (it can't be a field, since
        //  all fields in scala are private)
        buf.put(0x54.toByte)

        def emitType(c: Constant) = c.tag match { // type of the constant, Ecma-335.pdf, page 151
          case BooleanTag =&gt; buf.put(0x02.toByte)
          case ByteTag =&gt;    buf.put(0x05.toByte)
          case ShortTag =&gt;   buf.put(0x06.toByte)
          case CharTag =&gt;    buf.put(0x07.toByte)
          case IntTag =&gt;     buf.put(0x08.toByte)
          case LongTag =&gt;    buf.put(0x0a.toByte)
          case FloatTag =&gt;   buf.put(0x0c.toByte)
          case DoubleTag =&gt;  buf.put(0x0d.toByte)
          case StringTag =&gt;  buf.put(0x0e.toByte)

          // TODO: other Tags: NoTag, UnitTag, ClassTag, EnumTag ???

          // ArrayTag falls in here
          case _ =&gt; abort(&quot;could not handle attribute argument: &quot; + c)
        }

        val cnst: Constant = nvPair._2
        if (cnst.tag == ArrayTag) {
          buf.put(0x1d.toByte)
          emitType(cnst.arrayValue(0)) // FIXME: will crash if array length = 0
        } else if (cnst.tag == EnumTag) {
          buf.put(0x55.toByte)
          // TODO: put a SerString (don't know what exactly, names of the enums somehow..)
              } else {
          buf.put(0x51.toByte)
          emitType(cnst)
        }

        emitSerString(nvPair._1.toString)
        emitConst(nvPair._2)
      }

      val length = buf.position()
      buf.array().slice(0, length)
    } */</span>

    <span class="keyword">def</span> <a title="()Unit" id="636701">writeAssembly</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#636755" title="=&gt; GenMSIL.this.global.Symbol">entryPoint</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="../../../../Predef.scala.html#9566" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a><span class="delimiter">(</span><a href="#636755" title="=&gt; GenMSIL.this.global.Symbol">entryPoint</a>.<a href="../../../../reflect/generic/Symbols.scala.html#435409" title="=&gt; GenMSIL.this.global.Symbol">enclClass</a>.<a href="../../../../reflect/generic/Symbols.scala.html#435387" title="=&gt; Boolean">isModuleClass</a>, <a href="#636755" title="=&gt; GenMSIL.this.global.Symbol">entryPoint</a>.<a href="../../../../reflect/generic/Symbols.scala.html#435409" title="=&gt; GenMSIL.this.global.Symbol">enclClass</a><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.MethodInfo" id="638263">mainMethod</a> = <a href="../../../../collection/MapLike.scala.html#73204" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol)ch.epfl.lamp.compiler.msil.MethodInfo">methods</a><span class="delimiter">(</span><a href="#636755" title="=&gt; GenMSIL.this.global.Symbol">entryPoint</a><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="Array[ch.epfl.lamp.compiler.msil.Type]" id="638264">stringArrayTypes</a>: <a href="../../../../Array.scala.html#1430" title="Array[ch.epfl.lamp.compiler.msil.Type]">Array</a><span class="delimiter">[</span>MsilType<span class="delimiter">]</span> = <a href="../../../../Array.scala.html#62681" title="(xs: ch.epfl.lamp.compiler.msil.Type*)(implicit evidence$2: scala.reflect.ClassManifest[ch.epfl.lamp.compiler.msil.Type])Array[ch.epfl.lamp.compiler.msil.Type]">Array</a><a href="../../../../reflect/ClassManifest.scala.html#56840" title="(clazz: java.lang.Class[_])scala.reflect.ClassManifest[ch.epfl.lamp.compiler.msil.Type]" class="delimiter">(</a><a href="../../symtab/clr/CLRTypes.scala.html#601616" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MSTRING_ARRAY</a><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder" id="638265">globalMain</a> = <a href="#636677" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ModuleBuilder">mmodule</a>.<span title="(name: String, attributes: Int, returnType: ch.epfl.lamp.compiler.msil.Type, paramTypes: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.emit.MethodBuilder">DefineGlobalMethod</span><span class="delimiter">(</span>
          <span title="java.lang.String(&quot;Main&quot;)" class="string">&quot;Main&quot;</span>, MethodAttributes.Public <span title="Int(22)">|</span> MethodAttributes.Static,
          <a href="../../symtab/clr/CLRTypes.scala.html#601601" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MVOID</a>, <a href="#638264" title="Array[ch.epfl.lamp.compiler.msil.Type]">stringArrayTypes</a><span class="delimiter">)</span>
        <a href="#638265" title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder">globalMain</a>.<span title="(pos: Int, attr: Int, name: String)ch.epfl.lamp.compiler.msil.emit.ParameterBuilder">DefineParameter</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span>, ParameterAttributes.<span title="Int(0)">None</span>, <span title="java.lang.String(&quot;args&quot;)" class="string">&quot;args&quot;</span><span class="delimiter">)</span>
        <a href="#636674" title="=&gt; ch.epfl.lamp.compiler.msil.emit.AssemblyBuilder">massembly</a>.<span title="(entryMethod: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">SetEntryPoint</span><span class="delimiter">(</span><a href="#638265" title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder">globalMain</a><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.ILGenerator" id="638266">code</a> = <a href="#638265" title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder">globalMain</a>.<span title="()ch.epfl.lamp.compiler.msil.emit.ILGenerator">GetILGenerator</span><span class="delimiter">(</span><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.FieldInfo" id="638267">moduleField</a> = <a href="#636775" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.FieldInfo">getModuleInstanceField</a><span class="delimiter">(</span><a href="#636755" title="=&gt; GenMSIL.this.global.Symbol">entryPoint</a>.<a href="../../../../reflect/generic/Symbols.scala.html#435409" title="=&gt; GenMSIL.this.global.Symbol">enclClass</a><span class="delimiter">)</span>
        <a href="#638266" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.FieldInfo)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldsfld</span>, <a href="#638267" title="ch.epfl.lamp.compiler.msil.FieldInfo">moduleField</a><span class="delimiter">)</span>
        <a href="#638266" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldarg_0</span><span class="delimiter">)</span>
        <a href="#638266" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Callvirt</span>, <a href="#638263" title="ch.epfl.lamp.compiler.msil.MethodInfo">mainMethod</a><span class="delimiter">)</span>
        <a href="#638266" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ret</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
      <a href="#636702" title="()Unit">createTypes</a><span class="delimiter">(</span><span class="delimiter">)</span>
      <span class="keyword">var</span> <a title="String" id="638257">outDirName</a>: <span title="String">String</span> = <span title="Null(null)" class="keyword">null</span>
      <span class="keyword">try</span> <span class="delimiter">{</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../Global.scala.html#478200" title="=&gt; scala.tools.nsc.Settings">settings</a>.<a href="../../settings/ScalaSettings.scala.html#469759" title="=&gt; scala.tools.nsc.Settings#StringSetting">Ygenjavap</a>.<a href="../../settings/MutableSettings.scala.html#470029" title="=&gt; Boolean">isDefault</a><span class="delimiter">)</span> <span class="delimiter">{</span> <span class="comment">// we reuse the JVM-sounding setting because it's conceptually similar</span>
          <a href="#638257" title="String">outDirName</a> = <a href="#636689" title="=&gt; java.io.File">outDir</a>.<span title="()java.lang.String">getPath</span><span class="delimiter">(</span><span class="delimiter">)</span>
          <a href="#636674" title="=&gt; ch.epfl.lamp.compiler.msil.emit.AssemblyBuilder">massembly</a>.<span title="(fileName: String)Unit">Save</span><span class="delimiter">(</span><a href="#638257" title="String">outDirName</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;\\&quot;)" class="string">&quot;\\&quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#636683" title="=&gt; String">assemName</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;.msil&quot;)" class="string">&quot;.msil&quot;</span><span class="delimiter">)</span> <span class="comment">/* use SingleFileILPrinterVisitor */</span>
        <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
          <a href="#638257" title="String">outDirName</a> = <a href="#636692" title="=&gt; java.io.File">srcPath</a>.<span title="()java.lang.String">getPath</span><span class="delimiter">(</span><span class="delimiter">)</span>
          <a href="#636674" title="=&gt; ch.epfl.lamp.compiler.msil.emit.AssemblyBuilder">massembly</a>.<span title="(destPath: String, sourceFilesPath: String)Unit">Save</span><span class="delimiter">(</span><a href="../../Global.scala.html#478200" title="=&gt; scala.tools.nsc.Settings">settings</a>.<a href="../../settings/ScalaSettings.scala.html#469759" title="=&gt; scala.tools.nsc.Settings#StringSetting">Ygenjavap</a>.<a href="../../settings/MutableSettings.scala.html#470030" title="=&gt; java.lang.String">value</a>, <a href="#638257" title="String">outDirName</a><span class="delimiter">)</span>  <span class="comment">/* use MultipleFilesILPrinterVisitor */</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span> <span class="keyword">catch</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <a title="Nothing" id="640067">e</a>:<span title="java.io.IOException">IOException</span> =&gt; <a href="../../symtab/SymbolTable.scala.html#478159" title="(msg: String)Nothing">abort</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Could not write to &quot;)" class="string">&quot;Could not write to &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#638257" title="String">outDirName</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;: &quot;)" class="string">&quot;: &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#640067" title="java.io.IOException">e</a>.<span title="()java.lang.String">getMessage</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="()Unit" id="636702">createTypes</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="keyword">for</span> <span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.global.Symbol" id="640092">sym</a> &lt;- <a href="../icode/ICodes.scala.html#501219" title="=&gt; scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.global.Symbol,GenMSIL.this.global.icodes.IClass]">classes</a>.<a href="../../../../collection/IterableLike.scala.html#53856" title="(f: GenMSIL.this.global.icodes.global.Symbol =&gt; Unit)Unit">keys</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="GenMSIL.this.global.icodes.IClass" id="640093">iclass</a>   = <a href="../../../../collection/MapLike.scala.html#73204" title="(key: GenMSIL.this.global.icodes.global.Symbol)GenMSIL.this.global.icodes.IClass">classes</a><span class="delimiter">(</span><a href="#640092" title="GenMSIL.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder" id="640094">tBuilder</a> = <a href="../../../../collection/MapLike.scala.html#73204" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol)ch.epfl.lamp.compiler.msil.Type">types</a><span class="delimiter">(</span><a href="#640092" title="GenMSIL.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder" class="delimiter">[</span><span title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">TypeBuilder</span><span class="delimiter">]</span>

        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../Global.scala.html#478200" title="=&gt; scala.tools.nsc.Settings">settings</a>.<a href="../../settings/ScalaSettings.scala.html#469727" title="=&gt; scala.tools.nsc.Settings#BooleanSetting">debug</a>.<a href="../../settings/MutableSettings.scala.html#470030" title="=&gt; Boolean">value</a><span class="delimiter">)</span>
          <a href="../../Global.scala.html#478254" title="(msg: =&gt; AnyRef)Unit">log</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Calling CreatType for &quot;)" class="string">&quot;Calling CreatType for &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#640092" title="GenMSIL.this.global.icodes.global.Symbol">sym</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;, &quot;)" class="string">&quot;, &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#640094" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">tBuilder</a>.<span title="()java.lang.String">toString</span><span class="delimiter">)</span>

        <a href="#640094" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">tBuilder</a>.<span title="()ch.epfl.lamp.compiler.msil.Type">CreateType</span><span class="delimiter">(</span><span class="delimiter">)</span>
        <a href="#640094" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">tBuilder</a>.<span title="(sourceFilepath: String)Unit">setSourceFilepath</span><span class="delimiter">(</span><a href="#640093" title="GenMSIL.this.global.icodes.IClass">iclass</a>.<a href="../icode/Members.scala.html#501672" title="=&gt; GenMSIL.this.global.icodes.global.CompilationUnit">cunit</a>.<a href="../../CompilationUnits.scala.html#500950" title="=&gt; scala.tools.nsc.util.SourceFile">source</a>.<a href="../../util/SourceFile.scala.html#501040" title="=&gt; scala.tools.nsc.io.AbstractFile">file</a>.<a href="../../io/AbstractFile.scala.html#501001" title="=&gt; String">path</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <span class="keyword">private</span><span class="delimiter">[</span>GenMSIL<span class="delimiter">]</span> <span class="keyword">def</span> <a title="(iclass: GenMSIL.this.global.icodes.IClass)String" id="636703">ilasmFileName</a><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.IClass" id="640142">iclass</a>: <a href="../icode/Members.scala.html#501261" title="GenMSIL.this.global.icodes.IClass">IClass</a><span class="delimiter">)</span> : <span title="String">String</span> = <span class="delimiter">{</span>
      <span class="comment">// method.sourceFile contains just the filename</span>
      <a href="#640142" title="GenMSIL.this.global.icodes.IClass">iclass</a>.<a href="../icode/Members.scala.html#501672" title="=&gt; GenMSIL.this.global.icodes.global.CompilationUnit">cunit</a>.<a href="../../CompilationUnits.scala.html#500950" title="=&gt; scala.tools.nsc.util.SourceFile">source</a>.<a href="../../util/SourceFile.scala.html#501040" title="=&gt; scala.tools.nsc.io.AbstractFile">file</a>.<a href="../../io/AbstractFile.scala.html#501033" title="()String">toString</a>.<span title="(x$1: java.lang.CharSequence, x$2: java.lang.CharSequence)java.lang.String">replace</span><span class="delimiter">(</span><span title="java.lang.String(&quot;\\&quot;)" class="string">&quot;\\&quot;</span>, <span title="java.lang.String(&quot;\\\\&quot;)" class="string">&quot;\\\\&quot;</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="keyword">private</span><span class="delimiter">[</span>GenMSIL<span class="delimiter">]</span> <span class="keyword">def</span> <a title="(iclass: GenMSIL.this.global.icodes.IClass)Unit" id="636704">genClass</a><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.IClass" id="636949">iclass</a>: <a href="../icode/Members.scala.html#501261" title="GenMSIL.this.global.icodes.IClass">IClass</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="GenMSIL.this.global.icodes.global.Symbol" id="640152">sym</a> = <a href="#636949" title="GenMSIL.this.global.icodes.IClass">iclass</a>.<a href="../icode/Members.scala.html#501663" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../Global.scala.html#478200" title="=&gt; scala.tools.nsc.Settings">settings</a>.<a href="../../settings/ScalaSettings.scala.html#469727" title="=&gt; scala.tools.nsc.Settings#BooleanSetting">debug</a>.<a href="../../settings/MutableSettings.scala.html#470030" title="=&gt; Boolean">value</a><span class="delimiter">)</span>
        <a href="../../Global.scala.html#478254" title="(msg: =&gt; AnyRef)Unit">log</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Generating class &quot;)" class="string">&quot;Generating class &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#640152" title="GenMSIL.this.global.icodes.global.Symbol">sym</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot; flags: &quot;)" class="string">&quot; flags: &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="../../symtab/Flags.scala.html#36139" title="object scala.tools.nsc.symtab.Flags">Flags</a>.<a href="../../../../reflect/generic/Flags.scala.html#435634" title="(flags: Long)String">flagsToString</a><span class="delimiter">(</span><a href="#640152" title="GenMSIL.this.global.icodes.global.Symbol">sym</a>.<a href="../../symtab/Symbols.scala.html#509259" title="=&gt; Long">flags</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="#636668" title="(x$1: GenMSIL.this.global.icodes.IClass)Unit">clasz</a> = <a href="#636949" title="GenMSIL.this.global.icodes.IClass">iclass</a>

      <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder" id="640153">tBuilder</a> = <a href="#636765" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.Type">getType</a><span class="delimiter">(</span><a href="#640152" title="GenMSIL.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder" class="delimiter">[</span><span title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">TypeBuilder</span><span class="delimiter">]</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#636773" title="(sym: GenMSIL.this.global.Symbol)Boolean">isCloneable</a><span class="delimiter">(</span><a href="#640152" title="GenMSIL.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="comment">// FIXME: why there's no nme.clone_ ?</span>
        <span class="comment">// &quot;Clone&quot;: if the code is non-portable, &quot;Clone&quot; is defined, not &quot;clone&quot;</span>
        <span class="comment">// TODO: improve condition (should override AnyRef.clone)</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#636949" title="GenMSIL.this.global.icodes.IClass">iclass</a>.<a href="../icode/Members.scala.html#501669" title="=&gt; List[GenMSIL.this.global.icodes.IMethod]">methods</a>.<a href="../../../../collection/LinearSeqOptimized.scala.html#71035" title="(p: GenMSIL.this.global.icodes.IMethod =&gt; Boolean)Boolean">forall</a><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.IMethod" id="640188">m</a> =&gt; <span class="delimiter">{</span>
          <a href="../../../../Boolean.scala.html#55576" title="=&gt; Boolean">!</a><span class="delimiter">(</span><span class="delimiter">(</span><a href="#640188" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#594468" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a>.<a href="../../symtab/Symbols.scala.html#509256" title="=&gt; GenMSIL.this.global.icodes.global.Name">name</a>.<a href="../../symtab/Names.scala.html#501123" title="()String">toString</a><span class="delimiter">(</span><span class="delimiter">)</span> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="java.lang.String(&quot;clone&quot;)" class="string">&quot;clone&quot;</span> <a href="../../../../Boolean.scala.html#55579" title="(x: Boolean)Boolean">||</a> <a href="#640188" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#594468" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a>.<a href="../../symtab/Symbols.scala.html#509256" title="=&gt; GenMSIL.this.global.icodes.global.Name">name</a>.<a href="../../symtab/Names.scala.html#501123" title="()String">toString</a><span class="delimiter">(</span><span class="delimiter">)</span> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="java.lang.String(&quot;Clone&quot;)" class="string">&quot;Clone&quot;</span><span class="delimiter">)</span> <a href="../../../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a>
            <a href="#640188" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#594468" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a>.<a href="../../symtab/Symbols.scala.html#509270" title="=&gt; GenMSIL.this.global.icodes.global.Type">tpe</a>.<a href="../../symtab/Types.scala.html#507181" title="=&gt; List[GenMSIL.this.global.icodes.global.Type]">paramTypes</a>.<a href="../../../../collection/LinearSeqOptimized.scala.html#71030" title="=&gt; Int">length</a> <a href="../../../../Int.scala.html#54754" title="(x: Int)Boolean">!=</a> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
        <span class="delimiter">}</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../Global.scala.html#478200" title="=&gt; scala.tools.nsc.Settings">settings</a>.<a href="../../settings/ScalaSettings.scala.html#469727" title="=&gt; scala.tools.nsc.Settings#BooleanSetting">debug</a>.<a href="../../settings/MutableSettings.scala.html#470030" title="=&gt; Boolean">value</a><span class="delimiter">)</span>
            <a href="../../Global.scala.html#478254" title="(msg: =&gt; AnyRef)Unit">log</a><span class="delimiter">(</span><span title="java.lang.String(&quot;auto-generating cloneable method for &quot;)" class="string">&quot;auto-generating cloneable method for &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#640152" title="GenMSIL.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="Short" id="640211">attrs</a>: <a href="../../../../Short.scala.html#2039" title="Short">Short</a> = <span class="delimiter">(</span>MethodAttributes.Public | MethodAttributes.Virtual <span title="Int(198)">|</span>
                              MethodAttributes.HideBySig<span class="delimiter">)</span>.<a href="../../../../Int.scala.html#54728" title="=&gt; Short">toShort</a>
          <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder" id="640212">cloneMethod</a> = <a href="#640153" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">tBuilder</a>.<span title="(name: String, attrs: Short, returnType: ch.epfl.lamp.compiler.msil.Type, paramTypes: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.emit.MethodBuilder">DefineMethod</span><span class="delimiter">(</span><span title="java.lang.String(&quot;Clone&quot;)" class="string">&quot;Clone&quot;</span>, <a href="#640211" title="Short">attrs</a>, <a href="../../symtab/clr/CLRTypes.scala.html#601610" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MOBJECT</a>,
                                                  <span title="object ch.epfl.lamp.compiler.msil.Type">MsilType</span>.<span title="Array[ch.epfl.lamp.compiler.msil.Type]">EmptyTypes</span><span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.ILGenerator" id="640213">clCode</a> = <a href="#640212" title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder">cloneMethod</a>.<span title="()ch.epfl.lamp.compiler.msil.emit.ILGenerator">GetILGenerator</span><span class="delimiter">(</span><span class="delimiter">)</span>
          <a href="#640213" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">clCode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldarg_0</span><span class="delimiter">)</span>
          <a href="#640213" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">clCode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Call</span>, <a href="#636614" title="=&gt; ch.epfl.lamp.compiler.msil.MethodInfo">MEMBERWISE_CLONE</a><span class="delimiter">)</span>
          <a href="#640213" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">clCode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ret</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>

      <span class="keyword">val</span> <a title="Int" id="640154">line</a> = <a href="#640152" title="GenMSIL.this.global.icodes.global.Symbol">sym</a>.<a href="../../symtab/Symbols.scala.html#509109" title="=&gt; GenMSIL.this.global.icodes.global.Position">pos</a>.<a href="../../util/Position.scala.html#501514" title="=&gt; Int">line</a>
      <a href="#640153" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">tBuilder</a>.<span title="(sourceLine: Int, sourceFilename: String)Unit">setPosition</span><span class="delimiter">(</span><a href="#640154" title="Int">line</a>, <a href="#636703" title="(iclass: GenMSIL.this.global.icodes.IClass)String">ilasmFileName</a><span class="delimiter">(</span><a href="#636949" title="GenMSIL.this.global.icodes.IClass">iclass</a><span class="delimiter">)</span><span class="delimiter">)</span>

      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#636771" title="(sym: GenMSIL.this.global.Symbol)Boolean">isTopLevelModule</a><span class="delimiter">(</span><a href="#640152" title="GenMSIL.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#640152" title="GenMSIL.this.global.icodes.global.Symbol">sym</a>.<a href="../../symtab/Symbols.scala.html#509328" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">companionClass</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../symtab/Symbols.scala.html#478667" title="object GenMSIL.this.global.NoSymbol">NoSymbol</a><span class="delimiter">)</span>
          <a href="#636779" title="(sym: GenMSIL.this.global.Symbol)Unit">dumpMirrorClass</a><span class="delimiter">(</span><a href="#640152" title="GenMSIL.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span>
        <span class="keyword">else</span>
          <a href="../../Global.scala.html#478254" title="(msg: =&gt; AnyRef)Unit">log</a><span class="delimiter">(</span><span title="java.lang.String(&quot;No mirror class for module with linked class: &quot;)" class="string">&quot;No mirror class for module with linked class: &quot;</span> <span title="(x$1: Any)java.lang.String">+</span>
              <a href="#640152" title="GenMSIL.this.global.icodes.global.Symbol">sym</a>.<a href="../../../../reflect/generic/Symbols.scala.html#435348" title="=&gt; String">fullName</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>

      <a href="#636698" title="(sym: GenMSIL.this.global.Symbol, tBuilder: ch.epfl.lamp.compiler.msil.emit.TypeBuilder)Unit">addSymtabAttribute</a><span class="delimiter">(</span><a href="#640152" title="GenMSIL.this.global.icodes.global.Symbol">sym</a>, <a href="#640153" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">tBuilder</a><span class="delimiter">)</span>
      <a href="#636699" title="(member: ch.epfl.lamp.compiler.msil.emit.ICustomAttributeSetter, annotations: List[GenMSIL.this.global.AnnotationInfo])Unit">addAttributes</a><span class="delimiter">(</span><a href="#640153" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">tBuilder</a>, <a href="#640152" title="GenMSIL.this.global.icodes.global.Symbol">sym</a>.<a href="../../symtab/Symbols.scala.html#509116" title="=&gt; List[GenMSIL.this.global.icodes.global.AnnotationInfo]">annotations</a><span class="delimiter">)</span>

      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#636949" title="GenMSIL.this.global.icodes.IClass">iclass</a>.<a href="../icode/Members.scala.html#501663" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a> <span title="(x$1: AnyRef)Boolean">!=</span> <a href="../../symtab/Definitions.scala.html#479030" title="object GenMSIL.this.global.definitions">definitions</a>.<a href="../../symtab/Definitions.scala.html#508099" title="=&gt; GenMSIL.this.global.Symbol">ArrayClass</a><span class="delimiter">)</span>
        <a href="#636949" title="GenMSIL.this.global.icodes.IClass">iclass</a>.<a href="../icode/Members.scala.html#501669" title="=&gt; List[GenMSIL.this.global.icodes.IMethod]">methods</a> <a href="../../../../collection/LinearSeqOptimized.scala.html#71032" title="(f: GenMSIL.this.global.icodes.IMethod =&gt; Unit)Unit">foreach</a> <a href="#636705" title="(m: GenMSIL.this.global.icodes.IMethod)Unit">genMethod</a>

    <span class="delimiter">}</span> <span class="comment">//genClass</span>


    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(m: GenMSIL.this.global.icodes.IMethod)Unit" id="636705">genMethod</a><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.IMethod" id="640268">m</a>: <a href="../icode/Members.scala.html#501263" title="GenMSIL.this.global.icodes.IMethod">IMethod</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../Global.scala.html#478200" title="=&gt; scala.tools.nsc.Settings">settings</a>.<a href="../../settings/ScalaSettings.scala.html#469727" title="=&gt; scala.tools.nsc.Settings#BooleanSetting">debug</a>.<a href="../../settings/MutableSettings.scala.html#470030" title="=&gt; Boolean">value</a><span class="delimiter">)</span>
        <a href="../../Global.scala.html#478254" title="(msg: =&gt; AnyRef)Unit">log</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Generating method &quot;)" class="string">&quot;Generating method &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#640268" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#594468" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot; flags: &quot;)" class="string">&quot; flags: &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="../../symtab/Flags.scala.html#36139" title="object scala.tools.nsc.symtab.Flags">Flags</a>.<a href="../../../../reflect/generic/Flags.scala.html#435634" title="(flags: Long)String">flagsToString</a><span class="delimiter">(</span><a href="#640268" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#594468" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a>.<a href="../../symtab/Symbols.scala.html#509259" title="=&gt; Long">flags</a><span class="delimiter">)</span> <span title="(x$1: Any)java.lang.String">+</span>
            <span title="java.lang.String(&quot; owner: &quot;)" class="string">&quot; owner: &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#640268" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#594468" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a>.<a href="../../symtab/Symbols.scala.html#509249" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">owner</a><span class="delimiter">)</span>
      <a href="#636671" title="(x$1: GenMSIL.this.global.icodes.IMethod)Unit">method</a> = <a href="#640268" title="GenMSIL.this.global.icodes.IMethod">m</a>
      <a href="#636759" title="=&gt; scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.Local,ch.epfl.lamp.compiler.msil.emit.LocalBuilder]">localBuilders</a>.<a href="../../../../collection/mutable/HashMap.scala.html#73154" title="()Unit">clear</a>
      <a href="#636749" title="(m: GenMSIL.this.global.icodes.IMethod)Unit">computeLocalVarsIndex</a><span class="delimiter">(</span><a href="#640268" title="GenMSIL.this.global.icodes.IMethod">m</a><span class="delimiter">)</span>

      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#640268" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#594468" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a>.<a href="../../symtab/Symbols.scala.html#509178" title="=&gt; Boolean">isClassConstructor</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#636680" title="(x$1: ch.epfl.lamp.compiler.msil.emit.ILGenerator)Unit">mcode</a> = <a href="../../../../collection/MapLike.scala.html#73204" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol)ch.epfl.lamp.compiler.msil.ConstructorInfo">constructors</a><span class="delimiter">(</span><a href="#640268" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#594468" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="ch.epfl.lamp.compiler.msil.emit.ConstructorBuilder" class="delimiter">[</span><span title="ch.epfl.lamp.compiler.msil.emit.ConstructorBuilder">ConstructorBuilder</span><span class="delimiter">]</span>.<span title="()ch.epfl.lamp.compiler.msil.emit.ILGenerator">GetILGenerator</span><span class="delimiter">(</span><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder" id="640322">mBuilder</a> = <a href="../../../../collection/MapLike.scala.html#73204" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol)ch.epfl.lamp.compiler.msil.MethodInfo">methods</a><span class="delimiter">(</span><a href="#640268" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#594468" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder" class="delimiter">[</span><span title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder">MethodBuilder</span><span class="delimiter">]</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../../../Boolean.scala.html#55576" title="=&gt; Boolean">!</a><a href="#640322" title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder">mBuilder</a>.<span title="()Boolean">IsAbstract</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
          <span class="keyword">try</span> <span class="delimiter">{</span>
            <a href="#636680" title="(x$1: ch.epfl.lamp.compiler.msil.emit.ILGenerator)Unit">mcode</a> = <a href="#640322" title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder">mBuilder</a>.<span title="()ch.epfl.lamp.compiler.msil.emit.ILGenerator">GetILGenerator</span><span class="delimiter">(</span><span class="delimiter">)</span>
          <span class="delimiter">}</span> <span class="keyword">catch</span> <span class="delimiter">{</span>
            <span class="keyword">case</span> <a title="Nothing" id="640338">e</a>: <span title="Exception">Exception</span> =&gt;
              java.lang.<span title="object java.lang.System">System</span>.<span title="java.io.PrintStream">out</span>.<span title="(x$1: java.lang.String)Unit">println</span><span class="delimiter">(</span><span title="java.lang.String(&quot;m.symbol       = &quot;)" class="string">&quot;m.symbol       = &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="../../symtab/Flags.scala.html#36139" title="object scala.tools.nsc.symtab.Flags">Flags</a>.<a href="../../../../reflect/generic/Flags.scala.html#435634" title="(flags: Long)String">flagsToString</a><span class="delimiter">(</span><a href="#640268" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#594468" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a>.<a href="../../symtab/Symbols.scala.html#509259" title="=&gt; Long">flags</a><span class="delimiter">)</span> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot; &quot;)" class="string">&quot; &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#640268" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#594468" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a><span class="delimiter">)</span>
              java.lang.<span title="object java.lang.System">System</span>.<span title="java.io.PrintStream">out</span>.<span title="(x$1: java.lang.String)Unit">println</span><span class="delimiter">(</span><span title="java.lang.String(&quot;m.symbol.owner = &quot;)" class="string">&quot;m.symbol.owner = &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="../../symtab/Flags.scala.html#36139" title="object scala.tools.nsc.symtab.Flags">Flags</a>.<a href="../../../../reflect/generic/Flags.scala.html#435634" title="(flags: Long)String">flagsToString</a><span class="delimiter">(</span><a href="#640268" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#594468" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a>.<a href="../../symtab/Symbols.scala.html#509249" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">owner</a>.<a href="../../symtab/Symbols.scala.html#509259" title="=&gt; Long">flags</a><span class="delimiter">)</span> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot; &quot;)" class="string">&quot; &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#640268" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#594468" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a>.<a href="../../symtab/Symbols.scala.html#509249" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">owner</a><span class="delimiter">)</span>
              java.lang.<span title="object java.lang.System">System</span>.<span title="java.io.PrintStream">out</span>.<span title="(x$1: java.lang.String)Unit">println</span><span class="delimiter">(</span><span title="java.lang.String(&quot;mBuilder       = &quot;)" class="string">&quot;mBuilder       = &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#640322" title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder">mBuilder</a><span class="delimiter">)</span>
              java.lang.<span title="object java.lang.System">System</span>.<span title="java.io.PrintStream">out</span>.<span title="(x$1: java.lang.String)Unit">println</span><span class="delimiter">(</span><span title="java.lang.String(&quot;mBuilder.DeclaringType = &quot;)" class="string">&quot;mBuilder.DeclaringType = &quot;</span> <span title="(x$1: Any)java.lang.String">+</span>
                                 <span title="object ch.epfl.lamp.compiler.msil.TypeAttributes">TypeAttributes</span>.<span title="(x$1: Int)java.lang.String">toString</span><span class="delimiter">(</span><a href="#640322" title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder">mBuilder</a>.<span title="ch.epfl.lamp.compiler.msil.Type">DeclaringType</span>.<span title="Int">Attributes</span><span class="delimiter">)</span> <span title="(x$1: Any)java.lang.String">+</span>
                                 <span title="java.lang.String(&quot;::&quot;)" class="string">&quot;::&quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#640322" title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder">mBuilder</a>.<span title="ch.epfl.lamp.compiler.msil.Type">DeclaringType</span><span class="delimiter">)</span>
              <span title="Nothing" class="keyword">throw</span> <a href="#640338" title="Exception">e</a>
          <span class="delimiter">}</span>
          <span class="keyword">else</span>
            <a href="#636680" title="(x$1: ch.epfl.lamp.compiler.msil.emit.ILGenerator)Unit">mcode</a> = <span title="Null(null)" class="keyword">null</span>
      <span class="delimiter">}</span>

      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="keyword">for</span> <span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.Local" id="640413">local</a> &lt;- <a href="#640268" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../../../../collection/generic/FilterMonadic.scala.html#53496" title="(f: GenMSIL.this.global.icodes.Local =&gt; Unit)Unit">locals</a> ; <span class="keyword">if</span> <a href="../../../../Boolean.scala.html#55576" title="=&gt; Boolean">!</a><span class="delimiter">(</span><a href="#640268" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#594492" title="=&gt; List[GenMSIL.this.global.icodes.Local]">params</a> <a href="../../../../collection/SeqLike.scala.html#54119" title="(elem: Any)Boolean">contains</a> <a href="#640413" title="GenMSIL.this.global.icodes.Local">local</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../Global.scala.html#478200" title="=&gt; scala.tools.nsc.Settings">settings</a>.<a href="../../settings/ScalaSettings.scala.html#469727" title="=&gt; scala.tools.nsc.Settings#BooleanSetting">debug</a>.<a href="../../settings/MutableSettings.scala.html#470030" title="=&gt; Boolean">value</a><span class="delimiter">)</span>
            <a href="../../Global.scala.html#478254" title="(msg: =&gt; AnyRef)Unit">log</a><span class="delimiter">(</span><span title="java.lang.String(&quot;add local var: &quot;)" class="string">&quot;add local var: &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#640413" title="GenMSIL.this.global.icodes.Local">local</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;, of kind &quot;)" class="string">&quot;, of kind &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#640413" title="GenMSIL.this.global.icodes.Local">local</a>.<a href="../icode/Members.scala.html#594661" title="=&gt; GenMSIL.this.global.icodes.TypeKind">kind</a><span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.Type" id="640414">t</a>: <span title="ch.epfl.lamp.compiler.msil.Type">MsilType</span> = <a href="#636762" title="(t: GenMSIL.this.global.icodes.TypeKind)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">(</span><a href="#640413" title="GenMSIL.this.global.icodes.Local">local</a>.<a href="../icode/Members.scala.html#594661" title="=&gt; GenMSIL.this.global.icodes.TypeKind">kind</a><span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.LocalBuilder" id="640415">localBuilder</a> = <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(localType: ch.epfl.lamp.compiler.msil.Type)ch.epfl.lamp.compiler.msil.emit.LocalBuilder">DeclareLocal</span><span class="delimiter">(</span><a href="#640414" title="ch.epfl.lamp.compiler.msil.Type">t</a><span class="delimiter">)</span>
          <a href="#640415" title="ch.epfl.lamp.compiler.msil.emit.LocalBuilder">localBuilder</a>.<span title="(name: String)Unit">SetLocalSymInfo</span><span class="delimiter">(</span><a href="#636750" title="(sym: GenMSIL.this.global.Symbol)String">msilName</a><span class="delimiter">(</span><a href="#640413" title="GenMSIL.this.global.icodes.Local">local</a>.<a href="../icode/Members.scala.html#594659" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <a href="../../../../collection/mutable/HashMap.scala.html#73160" title="(key: GenMSIL.this.global.icodes.Local, value: ch.epfl.lamp.compiler.msil.emit.LocalBuilder)Unit">localBuilders</a><span class="delimiter">(</span><a href="#640413" title="GenMSIL.this.global.icodes.Local">local</a><span class="delimiter">)</span> = <a href="#640415" title="ch.epfl.lamp.compiler.msil.emit.LocalBuilder">localBuilder</a>
        <span class="delimiter">}</span>
        <a href="#636713" title="(m: GenMSIL.this.global.icodes.IMethod)Unit">genCode</a><span class="delimiter">(</span><a href="#640268" title="GenMSIL.this.global.icodes.IMethod">m</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>

    <span class="delimiter">}</span>

    <span class="comment">/** Special linearizer for methods with at least one exception handler. This
     *  linearizer brings all basic blocks in the right order so that nested
     *  try-catch and try-finally blocks can be emitted.
     */</span>
    <span class="keyword">val</span> <a title="GenMSIL.this.global.icodes.MSILLinearizer" id="636706">msilLinearizer</a> = <span title="GenMSIL.this.global.icodes.MSILLinearizer" class="keyword">new</span> <a href="../icode/Linearizers.scala.html#501431" title="GenMSIL.this.global.icodes.MSILLinearizer">MSILLinearizer</a><span class="delimiter">(</span><span class="delimiter">)</span>

    <span class="keyword">val</span> <a title="scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.BasicBlock,ch.epfl.lamp.compiler.msil.emit.Label]" id="636708">labels</a>: <a href="../../../../collection/mutable/HashMap.scala.html#14905" title="scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.BasicBlock,ch.epfl.lamp.compiler.msil.emit.Label]">HashMap</a><span class="delimiter">[</span>BasicBlock, Label<span class="delimiter">]</span> = <a href="../../../../collection/mutable/HashMap.scala.html#73156" title="()scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.BasicBlock,ch.epfl.lamp.compiler.msil.emit.Label]" class="keyword">new</a> <a href="../../../../collection/mutable/HashMap.scala.html#14905" title="scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.BasicBlock,ch.epfl.lamp.compiler.msil.emit.Label]">HashMap</a><span class="delimiter">(</span><span class="delimiter">)</span>

    <span class="comment">/* when emitting .line, it's enough to include the full filename just once per method, thus reducing filesize.
     * this scheme relies on the fact that the entry block is emitted first. */</span>
    <span class="keyword">var</span> <a title="Boolean" id="636711">dbFilenameSeen</a> = <span title="Boolean(false)" class="keyword">false</span>

    <span class="keyword">def</span> <a title="(m: GenMSIL.this.global.icodes.IMethod)Unit" id="636713">genCode</a><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.IMethod" id="640434">m</a>: <a href="../icode/Members.scala.html#501263" title="GenMSIL.this.global.icodes.IMethod">IMethod</a><span class="delimiter">)</span> <span class="delimiter">{</span>

      <span class="keyword">def</span> <a title="(blocks: List[GenMSIL.this.global.icodes.BasicBlock])Unit" id="640440">makeLabels</a><span class="delimiter">(</span><a title="List[GenMSIL.this.global.icodes.BasicBlock]" id="640442">blocks</a>: <a href="../../../../collection/immutable/List.scala.html#14047" title="List[GenMSIL.this.global.icodes.BasicBlock]">List</a><span class="delimiter">[</span>BasicBlock<span class="delimiter">]</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../Global.scala.html#478200" title="=&gt; scala.tools.nsc.Settings">settings</a>.<a href="../../settings/ScalaSettings.scala.html#469727" title="=&gt; scala.tools.nsc.Settings#BooleanSetting">debug</a>.<a href="../../settings/MutableSettings.scala.html#470030" title="=&gt; Boolean">value</a><span class="delimiter">)</span>
          <a href="../../Global.scala.html#478254" title="(msg: =&gt; AnyRef)Unit">log</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Making labels for: &quot;)" class="string">&quot;Making labels for: &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#636671" title="=&gt; GenMSIL.this.global.icodes.IMethod">method</a><span class="delimiter">)</span>
        <span class="keyword">for</span> <span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.BasicBlock" id="640465">bb</a> &lt;- <a href="../../../../collection/LinearSeqOptimized.scala.html#71032" title="(f: GenMSIL.this.global.icodes.BasicBlock =&gt; Unit)Unit">blocks</a><span class="delimiter">)</span> <a href="../../../../collection/mutable/HashMap.scala.html#73160" title="(key: GenMSIL.this.global.icodes.BasicBlock, value: ch.epfl.lamp.compiler.msil.emit.Label)Unit">labels</a><span class="delimiter">(</span><a href="#640465" title="GenMSIL.this.global.icodes.BasicBlock">bb</a><span class="delimiter">)</span> = <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="()ch.epfl.lamp.compiler.msil.emit.Label">DefineLabel</span><span class="delimiter">(</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>

      <a href="#636708" title="=&gt; scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.BasicBlock,ch.epfl.lamp.compiler.msil.emit.Label]">labels</a>.<a href="../../../../collection/mutable/HashMap.scala.html#73154" title="()Unit">clear</a>

      <span class="keyword">var</span> <a title="List[GenMSIL.this.global.icodes.BasicBlock]" id="640441">linearization</a> = <span title="List[GenMSIL.this.global.icodes.BasicBlock]" class="keyword">if</span><span class="delimiter">(</span><a href="../../../../Boolean.scala.html#55576" title="=&gt; Boolean">!</a><a href="#640434" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#594477" title="=&gt; List[GenMSIL.this.global.icodes.ExceptionHandler]">exh</a>.<a href="../../../../collection/IterableLike.scala.html#53862" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <a href="#636706" title="=&gt; GenMSIL.this.global.icodes.MSILLinearizer">msilLinearizer</a>.<a href="../icode/Linearizers.scala.html#612104" title="(m: GenMSIL.this.global.icodes.IMethod)List[GenMSIL.this.global.icodes.BasicBlock]">linearize</a><span class="delimiter">(</span><a href="#640434" title="GenMSIL.this.global.icodes.IMethod">m</a><span class="delimiter">)</span>
                          <span class="keyword">else</span> <a href="../icode/ICodes.scala.html#501223" title="=&gt; GenMSIL.this.global.icodes.Linearizer">linearizer</a>.<a href="../icode/Linearizers.scala.html#611346" title="(c: GenMSIL.this.global.icodes.IMethod)List[GenMSIL.this.global.icodes.BasicBlock]">linearize</a><span class="delimiter">(</span><a href="#640434" title="GenMSIL.this.global.icodes.IMethod">m</a><span class="delimiter">)</span>

      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../../../Boolean.scala.html#55576" title="=&gt; Boolean">!</a><a href="#640434" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#594477" title="=&gt; List[GenMSIL.this.global.icodes.ExceptionHandler]">exh</a>.<a href="../../../../collection/IterableLike.scala.html#53862" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span>
        <a href="#640441" title="List[GenMSIL.this.global.icodes.BasicBlock]">linearization</a> = <a href="#636739" title="(blocks: List[GenMSIL.this.global.icodes.BasicBlock], m: GenMSIL.this.global.icodes.IMethod)List[GenMSIL.this.global.icodes.BasicBlock]">computeExceptionMaps</a><span class="delimiter">(</span><a href="#640441" title="List[GenMSIL.this.global.icodes.BasicBlock]">linearization</a>, <a href="#640434" title="GenMSIL.this.global.icodes.IMethod">m</a><span class="delimiter">)</span>

      <a href="#640440" title="(blocks: List[GenMSIL.this.global.icodes.BasicBlock])Unit">makeLabels</a><span class="delimiter">(</span><a href="#640441" title="List[GenMSIL.this.global.icodes.BasicBlock]">linearization</a><span class="delimiter">)</span>

      <span class="comment">// debug val blocksInM = m.code.blocks.toList.sortBy(bb =&gt; bb.label)</span>
      <span class="comment">// debug val blocksInL = linearization.sortBy(bb =&gt; bb.label)</span>
      <span class="comment">// debug val MButNotL  = (blocksInM.toSet) diff (blocksInL.toSet) // if non-empty, a jump to B fails to find a label for B (case CJUMP, case CZJUMP)</span>
      <span class="comment">// debug if(!MButNotL.isEmpty) { }</span>

      <a href="#636711" title="(x$1: Boolean)Unit">dbFilenameSeen</a> = <span title="Boolean(false)" class="keyword">false</span>
      <a href="#636714" title="(blocks: List[GenMSIL.this.global.icodes.BasicBlock], previous: GenMSIL.this.global.icodes.BasicBlock)Unit">genBlocks</a><span class="delimiter">(</span><a href="#640441" title="List[GenMSIL.this.global.icodes.BasicBlock]">linearization</a><span class="delimiter">)</span>

      <span class="comment">// RETURN inside exception blocks are replaced by Leave. The target of the</span>
      <span class="comment">// leave is a `Ret` outside any exception block (generated here).</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#636725" title="=&gt; GenMSIL.this.global.icodes.IMethod">handlerReturnMethod</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#640434" title="GenMSIL.this.global.icodes.IMethod">m</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(label: ch.epfl.lamp.compiler.msil.emit.Label)Unit">MarkLabel</span><span class="delimiter">(</span><a href="#636731" title="=&gt; ch.epfl.lamp.compiler.msil.emit.Label">handlerReturnLabel</a><span class="delimiter">)</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#636734" title="=&gt; GenMSIL.this.global.icodes.TypeKind">handlerReturnKind</a> <span title="(x$1: AnyRef)Boolean">!=</span> <a href="../icode/TypeKinds.scala.html#501297" title="object GenMSIL.this.global.icodes.UNIT">UNIT</a><span class="delimiter">)</span>
          <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.emit.LocalBuilder)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldloc</span>, <a href="#636728" title="=&gt; ch.epfl.lamp.compiler.msil.emit.LocalBuilder">handlerReturnLocal</a><span class="delimiter">)</span>
        <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ret</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>

      <a href="#636715" title="=&gt; scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.BasicBlock,List[GenMSIL.this.global.icodes.ExceptionHandler]]">beginExBlock</a>.<a href="../../../../collection/mutable/HashMap.scala.html#73154" title="()Unit">clear</a><span class="delimiter">(</span><span class="delimiter">)</span>
      <a href="#636717" title="=&gt; scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.BasicBlock,GenMSIL.this.global.icodes.ExceptionHandler]">beginCatchBlock</a>.<a href="../../../../collection/mutable/HashMap.scala.html#73154" title="()Unit">clear</a><span class="delimiter">(</span><span class="delimiter">)</span>
      <a href="#636719" title="=&gt; scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.BasicBlock,List[GenMSIL.this.global.icodes.ExceptionHandler]]">endExBlock</a>.<a href="../../../../collection/mutable/HashMap.scala.html#73154" title="()Unit">clear</a><span class="delimiter">(</span><span class="delimiter">)</span>
      <a href="#636737" title="=&gt; scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.ExceptionHandler,ch.epfl.lamp.compiler.msil.emit.Label]">endFinallyLabels</a>.<a href="../../../../collection/mutable/HashMap.scala.html#73154" title="()Unit">clear</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="(blocks: List[GenMSIL.this.global.icodes.BasicBlock], previous: GenMSIL.this.global.icodes.BasicBlock)Unit" id="636714">genBlocks</a><span class="delimiter">(</span><a title="List[GenMSIL.this.global.icodes.BasicBlock]" id="640488">blocks</a>: <a href="../../../../collection/immutable/List.scala.html#14047" title="List[GenMSIL.this.global.icodes.BasicBlock]">List</a><span class="delimiter">[</span>BasicBlock<span class="delimiter">]</span>, <a title="GenMSIL.this.global.icodes.BasicBlock" id="640491">previous</a>: <a href="../icode/BasicBlocks.scala.html#501270" title="GenMSIL.this.global.icodes.BasicBlock">BasicBlock</a> = <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#640488" title="List[GenMSIL.this.global.icodes.BasicBlock]">blocks</a> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <a href="../../../../collection/immutable/List.scala.html#13700" title="Unit">Nil</a> =&gt; <span title="Unit" class="delimiter">(</span><span class="delimiter">)</span>
        <span class="keyword">case</span> <a title="Unit" id="640516">x</a> :: <a href="../../../../collection/immutable/List.scala.html#13700" title="object Nil">Nil</a> =&gt; <a href="#636740" title="(block: GenMSIL.this.global.icodes.BasicBlock, prev: GenMSIL.this.global.icodes.BasicBlock, next: GenMSIL.this.global.icodes.BasicBlock)Unit">genBlock</a><span class="delimiter">(</span><a href="#640516" title="GenMSIL.this.global.icodes.BasicBlock">x</a>, prev = <a href="#640491" title="GenMSIL.this.global.icodes.BasicBlock">previous</a>, next = <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span>
        <span class="keyword">case</span> <a title="Unit" id="640525">x</a> :: <a title="GenMSIL.this.global.icodes.BasicBlock" id="640533">y</a> :: <a title="List[GenMSIL.this.global.icodes.BasicBlock]" id="640534">ys</a> =&gt; <a href="#636740" title="(block: GenMSIL.this.global.icodes.BasicBlock, prev: GenMSIL.this.global.icodes.BasicBlock, next: GenMSIL.this.global.icodes.BasicBlock)Unit">genBlock</a><span class="delimiter">(</span><a href="#640525" title="GenMSIL.this.global.icodes.BasicBlock">x</a>, prev = <a href="#640491" title="GenMSIL.this.global.icodes.BasicBlock">previous</a>, next = <a href="#640533" title="GenMSIL.this.global.icodes.BasicBlock">y</a><span class="delimiter">)</span>; <a href="#636714" title="(blocks: List[GenMSIL.this.global.icodes.BasicBlock], previous: GenMSIL.this.global.icodes.BasicBlock)Unit">genBlocks</a><span class="delimiter">(</span><a href="#640533" title="GenMSIL.this.global.icodes.BasicBlock">y</a> <a href="../../../../collection/immutable/List.scala.html#49140" title="(x: GenMSIL.this.global.icodes.BasicBlock)List[GenMSIL.this.global.icodes.BasicBlock]">::</a> <a href="#640534" title="List[GenMSIL.this.global.icodes.BasicBlock]">ys</a>, previous = <a href="#640525" title="GenMSIL.this.global.icodes.BasicBlock">x</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <span class="comment">// the try blocks starting at a certain BasicBlock</span>
    <span class="keyword">val</span> <a title="scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.BasicBlock,List[GenMSIL.this.global.icodes.ExceptionHandler]]" id="636715">beginExBlock</a> = <a href="../../../../collection/mutable/HashMap.scala.html#73156" title="()scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.BasicBlock,List[GenMSIL.this.global.icodes.ExceptionHandler]]" class="keyword">new</a> <a href="../../../../collection/mutable/HashMap.scala.html#14905" title="scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.BasicBlock,List[GenMSIL.this.global.icodes.ExceptionHandler]]">HashMap</a><span class="delimiter">[</span>BasicBlock, List<span class="delimiter">[</span>ExceptionHandler<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>

    <span class="comment">// the catch blocks starting / endling at a certain BasicBlock</span>
    <span class="keyword">val</span> <a title="scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.BasicBlock,GenMSIL.this.global.icodes.ExceptionHandler]" id="636717">beginCatchBlock</a> = <a href="../../../../collection/mutable/HashMap.scala.html#73156" title="()scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.BasicBlock,GenMSIL.this.global.icodes.ExceptionHandler]" class="keyword">new</a> <a href="../../../../collection/mutable/HashMap.scala.html#14905" title="scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.BasicBlock,GenMSIL.this.global.icodes.ExceptionHandler]">HashMap</a><span class="delimiter">[</span>BasicBlock, ExceptionHandler<span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.BasicBlock,List[GenMSIL.this.global.icodes.ExceptionHandler]]" id="636719">endExBlock</a> = <a href="../../../../collection/mutable/HashMap.scala.html#73156" title="()scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.BasicBlock,List[GenMSIL.this.global.icodes.ExceptionHandler]]" class="keyword">new</a> <a href="../../../../collection/mutable/HashMap.scala.html#14905" title="scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.BasicBlock,List[GenMSIL.this.global.icodes.ExceptionHandler]]">HashMap</a><span class="delimiter">[</span>BasicBlock, List<span class="delimiter">[</span>ExceptionHandler<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>

    <span class="comment">/** When emitting the code (genBlock), the number of currently active try / catch
     *  blocks. When seeing a `RETURN' inside a try / catch, we need to
     *   - store the result in a local (if it's not UNIT)
     *   - emit `Leave handlerReturnLabel` instead of the Return
     *   - emit code at the end: load the local and return its value
     */</span>
    <span class="keyword">var</span> <a title="scala.collection.mutable.Stack[GenMSIL.this.global.icodes.ExceptionHandler]" id="636722">currentHandlers</a> = <a href="../../../../collection/mutable/Stack.scala.html#301886" title="()scala.collection.mutable.Stack[GenMSIL.this.global.icodes.ExceptionHandler]" class="keyword">new</a> <a href="../../../../collection/mutable/Stack.scala.html#15307" title="scala.collection.mutable.Stack[GenMSIL.this.global.icodes.ExceptionHandler]">Stack</a><span class="delimiter">[</span>ExceptionHandler<span class="delimiter">]</span>
    <span class="comment">// The IMethod the Local/Label/Kind below belong to</span>
    <span class="keyword">var</span> <a title="GenMSIL.this.global.icodes.IMethod" id="636725">handlerReturnMethod</a>: <a href="../icode/Members.scala.html#501263" title="GenMSIL.this.global.icodes.IMethod">IMethod</a> = _
    <span class="comment">// Stores the result when returning inside an exception block</span>
    <span class="keyword">var</span> <a title="ch.epfl.lamp.compiler.msil.emit.LocalBuilder" id="636728">handlerReturnLocal</a>: <span title="ch.epfl.lamp.compiler.msil.emit.LocalBuilder">LocalBuilder</span> = _
    <span class="comment">// Label for a return instruction outside any exception block</span>
    <span class="keyword">var</span> <a title="ch.epfl.lamp.compiler.msil.emit.Label" id="636731">handlerReturnLabel</a>: <span title="ch.epfl.lamp.compiler.msil.emit.Label">Label</span> = _
    <span class="comment">// The result kind.</span>
    <span class="keyword">var</span> <a title="GenMSIL.this.global.icodes.TypeKind" id="636734">handlerReturnKind</a>: <a href="../icode/TypeKinds.scala.html#501291" title="GenMSIL.this.global.icodes.TypeKind">TypeKind</a> = _
    <span class="keyword">def</span> <a title="(kind: GenMSIL.this.global.icodes.TypeKind)(ch.epfl.lamp.compiler.msil.emit.LocalBuilder, ch.epfl.lamp.compiler.msil.emit.Label)" id="636736">returnFromHandler</a><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.TypeKind" id="640541">kind</a>: <a href="../icode/TypeKinds.scala.html#501291" title="GenMSIL.this.global.icodes.TypeKind">TypeKind</a><span class="delimiter">)</span>: <a href="../../../../Tuple2.scala.html#1520" title="(ch.epfl.lamp.compiler.msil.emit.LocalBuilder, ch.epfl.lamp.compiler.msil.emit.Label)" class="delimiter">(</a>LocalBuilder, Label<span class="delimiter">)</span> = <span class="delimiter">{</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#636725" title="=&gt; GenMSIL.this.global.icodes.IMethod">handlerReturnMethod</a> <span title="(x$1: AnyRef)Boolean">!=</span> <a href="#636671" title="=&gt; GenMSIL.this.global.icodes.IMethod">method</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#636725" title="(x$1: GenMSIL.this.global.icodes.IMethod)Unit">handlerReturnMethod</a> = <a href="#636671" title="=&gt; GenMSIL.this.global.icodes.IMethod">method</a>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#640541" title="GenMSIL.this.global.icodes.TypeKind">kind</a> <span title="(x$1: AnyRef)Boolean">!=</span> <a href="../icode/TypeKinds.scala.html#501297" title="object GenMSIL.this.global.icodes.UNIT">UNIT</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="#636728" title="(x$1: ch.epfl.lamp.compiler.msil.emit.LocalBuilder)Unit">handlerReturnLocal</a> = <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(localType: ch.epfl.lamp.compiler.msil.Type)ch.epfl.lamp.compiler.msil.emit.LocalBuilder">DeclareLocal</span><span class="delimiter">(</span><a href="#636762" title="(t: GenMSIL.this.global.icodes.TypeKind)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">(</span><a href="#640541" title="GenMSIL.this.global.icodes.TypeKind">kind</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <a href="#636728" title="=&gt; ch.epfl.lamp.compiler.msil.emit.LocalBuilder">handlerReturnLocal</a>.<span title="(name: String)Unit">SetLocalSymInfo</span><span class="delimiter">(</span><span title="java.lang.String(&quot;$handlerReturn&quot;)" class="string">&quot;$handlerReturn&quot;</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>
        <a href="#636731" title="(x$1: ch.epfl.lamp.compiler.msil.emit.Label)Unit">handlerReturnLabel</a> = <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="()ch.epfl.lamp.compiler.msil.emit.Label">DefineLabel</span><span class="delimiter">(</span><span class="delimiter">)</span>
        <a href="#636734" title="(x$1: GenMSIL.this.global.icodes.TypeKind)Unit">handlerReturnKind</a> = <a href="#640541" title="GenMSIL.this.global.icodes.TypeKind">kind</a>
      <span class="delimiter">}</span>
      <a href="../../../../Tuple2.scala.html#53390" title="(_1: ch.epfl.lamp.compiler.msil.emit.LocalBuilder, _2: ch.epfl.lamp.compiler.msil.emit.Label)(ch.epfl.lamp.compiler.msil.emit.LocalBuilder, ch.epfl.lamp.compiler.msil.emit.Label)" class="delimiter">(</a><a href="#636728" title="=&gt; ch.epfl.lamp.compiler.msil.emit.LocalBuilder">handlerReturnLocal</a>, <a href="#636731" title="=&gt; ch.epfl.lamp.compiler.msil.emit.Label">handlerReturnLabel</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="comment">/** For try/catch nested inside a finally, we can't use `Leave OutsideFinally`, the
     *  Leave target has to be inside the finally (and it has to be the `endfinally` instruction).
     *  So for every finalizer, we have a label which marks the place of the `endfinally`,
     *  nested try/catch blocks will leave there.
     */</span>
    <span class="keyword">val</span> <a title="scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.ExceptionHandler,ch.epfl.lamp.compiler.msil.emit.Label]" id="636737">endFinallyLabels</a> = <a href="../../../../collection/mutable/HashMap.scala.html#73156" title="()scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.ExceptionHandler,ch.epfl.lamp.compiler.msil.emit.Label]" class="keyword">new</a> <a href="../../../../collection/mutable/HashMap.scala.html#14905" title="scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.ExceptionHandler,ch.epfl.lamp.compiler.msil.emit.Label]">HashMap</a><span class="delimiter">[</span>ExceptionHandler, Label<span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>

    <span class="comment">/** Computes which blocks are the beginning / end of a try or catch block */</span>
    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(blocks: List[GenMSIL.this.global.icodes.BasicBlock], m: GenMSIL.this.global.icodes.IMethod)List[GenMSIL.this.global.icodes.BasicBlock]" id="636739">computeExceptionMaps</a><span class="delimiter">(</span><a title="List[GenMSIL.this.global.icodes.BasicBlock]" id="640485">blocks</a>: <a href="../../../../collection/immutable/List.scala.html#14047" title="List[GenMSIL.this.global.icodes.BasicBlock]">List</a><span class="delimiter">[</span>BasicBlock<span class="delimiter">]</span>, <a title="GenMSIL.this.global.icodes.IMethod" id="640486">m</a>: <a href="../icode/Members.scala.html#501263" title="GenMSIL.this.global.icodes.IMethod">IMethod</a><span class="delimiter">)</span>: <a href="../../../../collection/immutable/List.scala.html#14047" title="List[GenMSIL.this.global.icodes.BasicBlock]">List</a><span class="delimiter">[</span>BasicBlock<span class="delimiter">]</span> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="scala.collection.mutable.HashSet[GenMSIL.this.global.icodes.BasicBlock]" id="640564">visitedBlocks</a> = <a href="../../../../collection/mutable/HashSet.scala.html#108311" title="()scala.collection.mutable.HashSet[GenMSIL.this.global.icodes.BasicBlock]" class="keyword">new</a> <a href="../../../../collection/mutable/HashSet.scala.html#14593" title="scala.collection.mutable.HashSet[GenMSIL.this.global.icodes.BasicBlock]">HashSet</a><span class="delimiter">[</span>BasicBlock<span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>

      <span class="comment">// handlers which have not been introduced so far</span>
      <span class="keyword">var</span> <a title="List[GenMSIL.this.global.icodes.ExceptionHandler]" id="640565">openHandlers</a> = <a href="#640486" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#594477" title="=&gt; List[GenMSIL.this.global.icodes.ExceptionHandler]">exh</a>


      <span class="comment">/** Example
       *   try {
       *     try {
       *         // *1*
       *     } catch {
       *       case h1 =&gt;
       *     }
       *   } catch {
       *     case h2 =&gt;
       *     case h3 =&gt;
       *       try {
       *
       *       } catch {
       *         case h4 =&gt;  // *2*
       *         case h5 =&gt;
       *       }
       *   }
       */</span>

      <span class="comment">// Stack of nested try blocks. Each bloc has a List of ExceptionHandler (multiple</span>
      <span class="comment">// catch statements). Example *1*: Stack(List(h2, h3), List(h1))</span>
      <span class="keyword">val</span> <a title="scala.collection.mutable.Stack[List[GenMSIL.this.global.icodes.ExceptionHandler]]" id="640566">currentTryHandlers</a> = <a href="../../../../collection/mutable/Stack.scala.html#301886" title="()scala.collection.mutable.Stack[List[GenMSIL.this.global.icodes.ExceptionHandler]]" class="keyword">new</a> <a href="../../../../collection/mutable/Stack.scala.html#15307" title="scala.collection.mutable.Stack[List[GenMSIL.this.global.icodes.ExceptionHandler]]">Stack</a><span class="delimiter">[</span>List<span class="delimiter">[</span>ExceptionHandler<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>

      <span class="comment">// Stack of nested catch blocks. The head of the list is the current catch block. The</span>
      <span class="comment">// tail is all following catch blocks. Example *2*: Stack(List(h3), List(h4, h5))</span>
      <span class="keyword">val</span> <a title="scala.collection.mutable.Stack[List[GenMSIL.this.global.icodes.ExceptionHandler]]" id="640567">currentCatchHandlers</a> = <a href="../../../../collection/mutable/Stack.scala.html#301886" title="()scala.collection.mutable.Stack[List[GenMSIL.this.global.icodes.ExceptionHandler]]" class="keyword">new</a> <a href="../../../../collection/mutable/Stack.scala.html#15307" title="scala.collection.mutable.Stack[List[GenMSIL.this.global.icodes.ExceptionHandler]]">Stack</a><span class="delimiter">[</span>List<span class="delimiter">[</span>ExceptionHandler<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>

      <span class="keyword">for</span> <span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.BasicBlock" id="640592">b</a> &lt;- <a href="../../../../collection/LinearSeqOptimized.scala.html#71032" title="(f: GenMSIL.this.global.icodes.BasicBlock =&gt; scala.collection.mutable.HashSet[GenMSIL.this.global.icodes.BasicBlock])Unit">blocks</a><span class="delimiter">)</span> <span class="delimiter">{</span>

        <span class="comment">// are we past the current catch blocks?</span>
        <span class="keyword">def</span> <a title="()List[GenMSIL.this.global.icodes.ExceptionHandler]" id="640593">endHandlers</a><span class="delimiter">(</span><span class="delimiter">)</span>: <a href="../../../../collection/immutable/List.scala.html#14047" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">List</a><span class="delimiter">[</span>ExceptionHandler<span class="delimiter">]</span> = <span class="delimiter">{</span>
          <span class="keyword">var</span> <a title="List[GenMSIL.this.global.icodes.ExceptionHandler]" id="640601">res</a>: <a href="../../../../collection/immutable/List.scala.html#14047" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">List</a><span class="delimiter">[</span>ExceptionHandler<span class="delimiter">]</span> = <a href="../../../../collection/immutable/List.scala.html#13700" title="object Nil">Nil</a>
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../../../Boolean.scala.html#55576" title="=&gt; Boolean">!</a><a href="#640567" title="scala.collection.mutable.Stack[List[GenMSIL.this.global.icodes.ExceptionHandler]]">currentCatchHandlers</a>.<a href="../../../../collection/mutable/Stack.scala.html#301888" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <span class="delimiter">{</span>
            <span class="keyword">val</span> <a title="GenMSIL.this.global.icodes.ExceptionHandler" id="640602">handler</a> = <a href="#640567" title="scala.collection.mutable.Stack[List[GenMSIL.this.global.icodes.ExceptionHandler]]">currentCatchHandlers</a>.<a href="../../../../collection/mutable/Stack.scala.html#301896" title="=&gt; List[GenMSIL.this.global.icodes.ExceptionHandler]">top</a>.<a href="../../../../collection/IterableLike.scala.html#53870" title="=&gt; GenMSIL.this.global.icodes.ExceptionHandler">head</a>
            <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../../../Boolean.scala.html#55576" title="=&gt; Boolean">!</a><a href="#640602" title="GenMSIL.this.global.icodes.ExceptionHandler">handler</a>.<a href="../icode/ExceptionHandlers.scala.html#599669" title="=&gt; List[GenMSIL.this.global.icodes.BasicBlock]">blocks</a>.<a href="../../../../collection/SeqLike.scala.html#54119" title="(elem: Any)Boolean">contains</a><span class="delimiter">(</span><a href="#640592" title="GenMSIL.this.global.icodes.BasicBlock">b</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
              <span class="comment">// all blocks of the handler are either visited, or not part of the linearization (i.e. dead)</span>
              <a href="../../../../Predef.scala.html#9566" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a><span class="delimiter">(</span><a href="#640602" title="GenMSIL.this.global.icodes.ExceptionHandler">handler</a>.<a href="../icode/ExceptionHandlers.scala.html#599669" title="=&gt; List[GenMSIL.this.global.icodes.BasicBlock]">blocks</a>.<a href="../../../../collection/LinearSeqOptimized.scala.html#71035" title="(p: GenMSIL.this.global.icodes.BasicBlock =&gt; Boolean)Boolean">forall</a><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.BasicBlock" id="640617">b</a> =&gt; <a href="#640564" title="scala.collection.mutable.HashSet[GenMSIL.this.global.icodes.BasicBlock]">visitedBlocks</a>.<a href="../../../../collection/mutable/HashSet.scala.html#108314" title="(elem: GenMSIL.this.global.icodes.BasicBlock)Boolean">contains</a><span class="delimiter">(</span><a href="#640617" title="GenMSIL.this.global.icodes.BasicBlock">b</a><span class="delimiter">)</span> <a href="../../../../Boolean.scala.html#55579" title="(x: Boolean)Boolean">||</a> <a href="../../../../Boolean.scala.html#55576" title="=&gt; Boolean">!</a><a href="#640485" title="List[GenMSIL.this.global.icodes.BasicBlock]">blocks</a>.<a href="../../../../collection/SeqLike.scala.html#54119" title="(elem: Any)Boolean">contains</a><span class="delimiter">(</span><a href="#640617" title="GenMSIL.this.global.icodes.BasicBlock">b</a><span class="delimiter">)</span><span class="delimiter">)</span>,
                     <span title="java.lang.String(&quot;Bad linearization of basic blocks inside catch. Found block not part of the handler\012&quot;)" class="string">&quot;Bad linearization of basic blocks inside catch. Found block not part of the handler\n&quot;</span><span title="(x$1: Any)java.lang.String">+</span>
                     <a href="#640592" title="GenMSIL.this.global.icodes.BasicBlock">b</a>.<a href="../icode/BasicBlocks.scala.html#594457" title="=&gt; String">fullString</a> <span title="(x$1: Any)java.lang.String">+</span><span title="java.lang.String(&quot;\012while in catch-part of\012&quot;)" class="string">&quot;\nwhile in catch-part of\n&quot;</span><span title="(x$1: Any)java.lang.String">+</span> <a href="#640602" title="GenMSIL.this.global.icodes.ExceptionHandler">handler</a><span class="delimiter">)</span>

              <span class="keyword">val</span> <a title="List[GenMSIL.this.global.icodes.ExceptionHandler]" id="640604">rest</a> = <a href="#640567" title="scala.collection.mutable.Stack[List[GenMSIL.this.global.icodes.ExceptionHandler]]">currentCatchHandlers</a>.<a href="../../../../collection/mutable/Stack.scala.html#301897" title="()List[GenMSIL.this.global.icodes.ExceptionHandler]">pop</a>.<a href="../../../../collection/TraversableLike.scala.html#49082" title="=&gt; List[GenMSIL.this.global.icodes.ExceptionHandler]">tail</a>
              <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#640604" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">rest</a>.<a href="../../../../collection/IterableLike.scala.html#53862" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <span class="delimiter">{</span>
                <span class="comment">// all catch blocks of that exception handler are covered</span>
                <a href="#640601" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">res</a> = <a href="#640602" title="GenMSIL.this.global.icodes.ExceptionHandler">handler</a> <a href="../../../../collection/immutable/List.scala.html#49140" title="(x: GenMSIL.this.global.icodes.ExceptionHandler)List[GenMSIL.this.global.icodes.ExceptionHandler]">::</a> <a href="#640593" title="()List[GenMSIL.this.global.icodes.ExceptionHandler]">endHandlers</a><span class="delimiter">(</span><span class="delimiter">)</span>
              <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
                <span class="comment">// there are more catch blocks for that try (handlers covering the same)</span>
                <a href="#640567" title="scala.collection.mutable.Stack[List[GenMSIL.this.global.icodes.ExceptionHandler]]">currentCatchHandlers</a>.<a href="../../../../collection/mutable/Stack.scala.html#301892" title="(elem: List[GenMSIL.this.global.icodes.ExceptionHandler])currentCatchHandlers.type">push</a><span class="delimiter">(</span><a href="#640604" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">rest</a><span class="delimiter">)</span>
                <a href="../../../../collection/mutable/HashMap.scala.html#73160" title="(key: GenMSIL.this.global.icodes.BasicBlock, value: GenMSIL.this.global.icodes.ExceptionHandler)Unit">beginCatchBlock</a><span class="delimiter">(</span><a href="#640592" title="GenMSIL.this.global.icodes.BasicBlock">b</a><span class="delimiter">)</span> = <a href="#640604" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">rest</a>.<a href="../../../../collection/IterableLike.scala.html#53870" title="=&gt; GenMSIL.this.global.icodes.ExceptionHandler">head</a>
              <span class="delimiter">}</span>
            <span class="delimiter">}</span>
          <span class="delimiter">}</span>
          <a href="#640601" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">res</a>
        <span class="delimiter">}</span>
        <span class="keyword">val</span> <a title="List[GenMSIL.this.global.icodes.ExceptionHandler]" id="640594">end</a> = <a href="#640593" title="()List[GenMSIL.this.global.icodes.ExceptionHandler]">endHandlers</a><span class="delimiter">(</span><span class="delimiter">)</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../../../Boolean.scala.html#55576" title="=&gt; Boolean">!</a><a href="#640594" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">end</a>.<a href="../../../../collection/IterableLike.scala.html#53862" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <a href="../../../../collection/mutable/HashMap.scala.html#73160" title="(key: GenMSIL.this.global.icodes.BasicBlock, value: List[GenMSIL.this.global.icodes.ExceptionHandler])Unit">endExBlock</a><span class="delimiter">(</span><a href="#640592" title="GenMSIL.this.global.icodes.BasicBlock">b</a><span class="delimiter">)</span> = <a href="#640594" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">end</a>

        <span class="comment">// are we past the current try block?</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../../../Boolean.scala.html#55576" title="=&gt; Boolean">!</a><a href="#640566" title="scala.collection.mutable.Stack[List[GenMSIL.this.global.icodes.ExceptionHandler]]">currentTryHandlers</a>.<a href="../../../../collection/mutable/Stack.scala.html#301888" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <span class="keyword">val</span> <a title="GenMSIL.this.global.icodes.ExceptionHandler" id="640642">handler</a> = <a href="#640566" title="scala.collection.mutable.Stack[List[GenMSIL.this.global.icodes.ExceptionHandler]]">currentTryHandlers</a>.<a href="../../../../collection/mutable/Stack.scala.html#301896" title="=&gt; List[GenMSIL.this.global.icodes.ExceptionHandler]">top</a>.<a href="../../../../collection/IterableLike.scala.html#53870" title="=&gt; GenMSIL.this.global.icodes.ExceptionHandler">head</a>
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../../../Boolean.scala.html#55576" title="=&gt; Boolean">!</a><a href="#640642" title="GenMSIL.this.global.icodes.ExceptionHandler">handler</a>.<a href="../icode/ExceptionHandlers.scala.html#599668" title="(b: GenMSIL.this.global.icodes.BasicBlock)Boolean">covers</a><span class="delimiter">(</span><a href="#640592" title="GenMSIL.this.global.icodes.BasicBlock">b</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
            <span class="comment">// all of the covered blocks are visited, or not part of the linearization</span>
            <a href="../../../../Predef.scala.html#9566" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a><span class="delimiter">(</span><a href="#640642" title="GenMSIL.this.global.icodes.ExceptionHandler">handler</a>.<a href="../icode/ExceptionHandlers.scala.html#599664" title="=&gt; scala.collection.immutable.Set[GenMSIL.this.global.icodes.BasicBlock]">covered</a>.<a href="../../../../collection/IterableLike.scala.html#53859" title="(p: GenMSIL.this.global.icodes.BasicBlock =&gt; Boolean)Boolean">forall</a><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.BasicBlock" id="640657">b</a> =&gt; <a href="#640564" title="scala.collection.mutable.HashSet[GenMSIL.this.global.icodes.BasicBlock]">visitedBlocks</a>.<a href="../../../../collection/mutable/HashSet.scala.html#108314" title="(elem: GenMSIL.this.global.icodes.BasicBlock)Boolean">contains</a><span class="delimiter">(</span><a href="#640657" title="GenMSIL.this.global.icodes.BasicBlock">b</a><span class="delimiter">)</span> <a href="../../../../Boolean.scala.html#55579" title="(x: Boolean)Boolean">||</a> <a href="../../../../Boolean.scala.html#55576" title="=&gt; Boolean">!</a><a href="#640485" title="List[GenMSIL.this.global.icodes.BasicBlock]">blocks</a>.<a href="../../../../collection/SeqLike.scala.html#54119" title="(elem: Any)Boolean">contains</a><span class="delimiter">(</span><a href="#640657" title="GenMSIL.this.global.icodes.BasicBlock">b</a><span class="delimiter">)</span><span class="delimiter">)</span>,
                   <span title="java.lang.String(&quot;Bad linearization of basic blocks inside try. Found non-covered block\012&quot;)" class="string">&quot;Bad linearization of basic blocks inside try. Found non-covered block\n&quot;</span><span title="(x$1: Any)java.lang.String">+</span>
                   <a href="#640592" title="GenMSIL.this.global.icodes.BasicBlock">b</a>.<a href="../icode/BasicBlocks.scala.html#594457" title="=&gt; String">fullString</a> <span title="(x$1: Any)java.lang.String">+</span><span title="java.lang.String(&quot;\012while in try-part of\012&quot;)" class="string">&quot;\nwhile in try-part of\n&quot;</span><span title="(x$1: Any)java.lang.String">+</span> <a href="#640642" title="GenMSIL.this.global.icodes.ExceptionHandler">handler</a><span class="delimiter">)</span>

            <a href="../../../../Predef.scala.html#9566" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a><span class="delimiter">(</span><a href="#640642" title="GenMSIL.this.global.icodes.ExceptionHandler">handler</a>.<a href="../icode/ExceptionHandlers.scala.html#599663" title="=&gt; GenMSIL.this.global.icodes.BasicBlock">startBlock</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#640592" title="GenMSIL.this.global.icodes.BasicBlock">b</a>,
                   <span title="java.lang.String(&quot;Bad linearization of basic blocks. The entry block of a catch does not directly follow the try\012&quot;)" class="string">&quot;Bad linearization of basic blocks. The entry block of a catch does not directly follow the try\n&quot;</span><span title="(x$1: Any)java.lang.String">+</span>
                   <a href="#640592" title="GenMSIL.this.global.icodes.BasicBlock">b</a>.<a href="../icode/BasicBlocks.scala.html#594457" title="=&gt; String">fullString</a> <span title="(x$1: Any)java.lang.String">+</span><span title="java.lang.String(&quot;\012&quot;)" class="string">&quot;\n&quot;</span><span title="(x$1: Any)java.lang.String">+</span> <a href="#640642" title="GenMSIL.this.global.icodes.ExceptionHandler">handler</a><span class="delimiter">)</span>

            <span class="keyword">val</span> <a title="List[GenMSIL.this.global.icodes.ExceptionHandler]" id="640645">handlers</a> = <a href="#640566" title="scala.collection.mutable.Stack[List[GenMSIL.this.global.icodes.ExceptionHandler]]">currentTryHandlers</a>.<a href="../../../../collection/mutable/Stack.scala.html#301897" title="()List[GenMSIL.this.global.icodes.ExceptionHandler]">pop</a>
            <a href="#640567" title="scala.collection.mutable.Stack[List[GenMSIL.this.global.icodes.ExceptionHandler]]">currentCatchHandlers</a>.<a href="../../../../collection/mutable/Stack.scala.html#301892" title="(elem: List[GenMSIL.this.global.icodes.ExceptionHandler])currentCatchHandlers.type">push</a><span class="delimiter">(</span><a href="#640645" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">handlers</a><span class="delimiter">)</span>
            <a href="../../../../collection/mutable/HashMap.scala.html#73160" title="(key: GenMSIL.this.global.icodes.BasicBlock, value: GenMSIL.this.global.icodes.ExceptionHandler)Unit">beginCatchBlock</a><span class="delimiter">(</span><a href="#640592" title="GenMSIL.this.global.icodes.BasicBlock">b</a><span class="delimiter">)</span> = <a href="#640642" title="GenMSIL.this.global.icodes.ExceptionHandler">handler</a>
          <span class="delimiter">}</span>
        <span class="delimiter">}</span>

        <span class="comment">// are there try blocks starting at b?</span>
        <span class="keyword">val</span> <a href="../../../../Tuple2.scala.html#53390" title="(List[GenMSIL.this.global.icodes.ExceptionHandler], List[GenMSIL.this.global.icodes.ExceptionHandler])" class="delimiter">(</a><a href="../../../../Tuple2.scala.html#53402" title="List[GenMSIL.this.global.icodes.ExceptionHandler]" id="640596">newHandlers</a>, <a href="../../../../Tuple2.scala.html#53404" title="List[GenMSIL.this.global.icodes.ExceptionHandler]" id="640597">stillOpen</a><span class="delimiter">)</span> = <a href="#640565" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">openHandlers</a>.<a href="../../../../collection/TraversableLike.scala.html#49058" title="(p: GenMSIL.this.global.icodes.ExceptionHandler =&gt; Boolean)(List[GenMSIL.this.global.icodes.ExceptionHandler], List[GenMSIL.this.global.icodes.ExceptionHandler])">partition</a><a href="../../../../Tuple2.scala.html#1520" title="(List[GenMSIL.this.global.icodes.ExceptionHandler], List[GenMSIL.this.global.icodes.ExceptionHandler]) @unchecked" class="delimiter">(</a><a href="#640676" title="GenMSIL.this.global.icodes.ExceptionHandler">_</a>.<a href="../icode/ExceptionHandlers.scala.html#599668" title="(b: GenMSIL.this.global.icodes.BasicBlock)Boolean">covers</a><span class="delimiter">(</span><a href="#640592" title="GenMSIL.this.global.icodes.BasicBlock">b</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <a href="#640565" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">openHandlers</a> = <a href="#640597" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">stillOpen</a>

        <span class="keyword">val</span> <a title="scala.collection.immutable.Map[Int,List[GenMSIL.this.global.icodes.ExceptionHandler]]" id="640598">newHandlersBySize</a> = <a href="#640596" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">newHandlers</a>.<a href="../../../../collection/TraversableLike.scala.html#49059" title="(f: GenMSIL.this.global.icodes.ExceptionHandler =&gt; Int)scala.collection.immutable.Map[Int,List[GenMSIL.this.global.icodes.ExceptionHandler]]">groupBy</a><span class="delimiter">(</span><a href="#640694" title="GenMSIL.this.global.icodes.ExceptionHandler">_</a>.<a href="../icode/ExceptionHandlers.scala.html#599664" title="=&gt; scala.collection.immutable.Set[GenMSIL.this.global.icodes.BasicBlock]">covered</a>.<a href="../../../../collection/TraversableOnce.scala.html#53618" title="=&gt; Int">size</a><span class="delimiter">)</span>
        <span class="comment">// big handlers first, smaller ones are nested inside the try of the big one</span>
        <span class="comment">// (checked by the assertions below)</span>
        <span class="keyword">val</span> <a title="List[Int]" id="640599">sizes</a> = <a href="#640598" title="scala.collection.immutable.Map[Int,List[GenMSIL.this.global.icodes.ExceptionHandler]]">newHandlersBySize</a>.<a href="../../../../collection/MapLike.scala.html#73210" title="=&gt; Iterable[Int]">keys</a>.<a href="../../../../collection/TraversableOnce.scala.html#53691" title="=&gt; List[Int]">toList</a>.<a href="../../../../collection/SeqLike.scala.html#54177" title="(lt: (Int, Int) =&gt; Boolean)List[Int]">sortWith</a><span class="delimiter">(</span><a href="#640700" title="Int">_</a> <a href="../../../../Int.scala.html#54775" title="(x: Int)Boolean">&gt;</a> <a href="#640701" title="Int">_</a><span class="delimiter">)</span>

        <span class="keyword">val</span> <a title="scala.collection.mutable.ListBuffer[GenMSIL.this.global.icodes.ExceptionHandler]" id="640600">beginHandlers</a> = <span title="scala.collection.mutable.ListBuffer[GenMSIL.this.global.icodes.ExceptionHandler]" class="keyword">new</span> <a href="../../../../collection/mutable/ListBuffer.scala.html#15373" title="scala.collection.mutable.ListBuffer[GenMSIL.this.global.icodes.ExceptionHandler]">ListBuffer</a><span class="delimiter">[</span>ExceptionHandler<span class="delimiter">]</span>
        <span class="keyword">for</span> <span class="delimiter">(</span><a title="Int" id="640725">s</a> &lt;- <a href="../../../../collection/LinearSeqOptimized.scala.html#71032" title="(f: Int =&gt; scala.collection.mutable.Stack[List[GenMSIL.this.global.icodes.ExceptionHandler]])Unit">sizes</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <span class="keyword">val</span> <a title="List[GenMSIL.this.global.icodes.ExceptionHandler]" id="640726">sHandlers</a> = <a href="../../../../collection/MapLike.scala.html#73204" title="(key: Int)List[GenMSIL.this.global.icodes.ExceptionHandler]">newHandlersBySize</a><span class="delimiter">(</span><a href="#640725" title="Int">s</a><span class="delimiter">)</span>
          <span class="keyword">for</span> <span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.ExceptionHandler" id="640771">h</a> &lt;- <a href="../../../../collection/LinearSeqOptimized.scala.html#71032" title="(f: GenMSIL.this.global.icodes.ExceptionHandler =&gt; Unit)Unit">sHandlers</a><span class="delimiter">)</span> <span class="delimiter">{</span>
            <a href="../../../../Predef.scala.html#9566" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a><span class="delimiter">(</span><a href="#640771" title="GenMSIL.this.global.icodes.ExceptionHandler">h</a>.<a href="../icode/ExceptionHandlers.scala.html#599664" title="=&gt; scala.collection.immutable.Set[GenMSIL.this.global.icodes.BasicBlock]">covered</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#640726" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">sHandlers</a>.<a href="../../../../collection/IterableLike.scala.html#53870" title="=&gt; GenMSIL.this.global.icodes.ExceptionHandler">head</a>.<a href="../icode/ExceptionHandlers.scala.html#599664" title="=&gt; scala.collection.immutable.Set[GenMSIL.this.global.icodes.BasicBlock]">covered</a>,
                   <span title="java.lang.String(&quot;bad nesting of exception handlers. same size, but not covering same blocks\012&quot;)" class="string">&quot;bad nesting of exception handlers. same size, but not covering same blocks\n&quot;</span><span title="(x$1: Any)java.lang.String">+</span>
                   <a href="#640771" title="GenMSIL.this.global.icodes.ExceptionHandler">h</a> <span title="(x$1: Any)java.lang.String">+</span><span title="java.lang.String(&quot;\012&quot;)" class="string">&quot;\n&quot;</span><span title="(x$1: Any)java.lang.String">+</span> <a href="#640726" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">sHandlers</a>.<a href="../../../../collection/IterableLike.scala.html#53870" title="=&gt; GenMSIL.this.global.icodes.ExceptionHandler">head</a><span class="delimiter">)</span>
            <a href="../../../../Predef.scala.html#9566" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a><span class="delimiter">(</span><a href="#640771" title="GenMSIL.this.global.icodes.ExceptionHandler">h</a>.<a href="../icode/ExceptionHandlers.scala.html#599659" title="=&gt; GenMSIL.this.global.icodes.TypeKind">resultKind</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#640726" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">sHandlers</a>.<a href="../../../../collection/IterableLike.scala.html#53870" title="=&gt; GenMSIL.this.global.icodes.ExceptionHandler">head</a>.<a href="../icode/ExceptionHandlers.scala.html#599659" title="=&gt; GenMSIL.this.global.icodes.TypeKind">resultKind</a>,
                   <span title="java.lang.String(&quot;bad nesting of exception handlers. same size, but the same resultKind\012&quot;)" class="string">&quot;bad nesting of exception handlers. same size, but the same resultKind\n&quot;</span><span title="(x$1: Any)java.lang.String">+</span>
                   <a href="#640771" title="GenMSIL.this.global.icodes.ExceptionHandler">h</a> <span title="(x$1: Any)java.lang.String">+</span><span title="java.lang.String(&quot;\012&quot;)" class="string">&quot;\n&quot;</span><span title="(x$1: Any)java.lang.String">+</span> <a href="#640726" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">sHandlers</a>.<a href="../../../../collection/IterableLike.scala.html#53870" title="=&gt; GenMSIL.this.global.icodes.ExceptionHandler">head</a><span class="delimiter">)</span>
          <span class="delimiter">}</span>
          <span class="keyword">for</span> <span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.ExceptionHandler" id="640806">bigger</a> &lt;- <a href="../../../../collection/generic/TraversableForwarder.scala.html#61936" title="(f: GenMSIL.this.global.icodes.ExceptionHandler =&gt; Unit)Unit">beginHandlers</a>; <a title="GenMSIL.this.global.icodes.ExceptionHandler" id="640825">h</a> &lt;- <a href="../../../../collection/LinearSeqOptimized.scala.html#71032" title="(f: GenMSIL.this.global.icodes.ExceptionHandler =&gt; Unit)Unit">sHandlers</a><span class="delimiter">)</span> <span class="delimiter">{</span>
            <a href="../../../../Predef.scala.html#9566" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a><span class="delimiter">(</span><a href="#640825" title="GenMSIL.this.global.icodes.ExceptionHandler">h</a>.<a href="../icode/ExceptionHandlers.scala.html#599664" title="=&gt; scala.collection.immutable.Set[GenMSIL.this.global.icodes.BasicBlock]">covered</a>.<a href="../../../../collection/GenSetLike.scala.html#59073" title="(that: scala.collection.GenSet[GenMSIL.this.global.icodes.BasicBlock])Boolean">subsetOf</a><span class="delimiter">(</span><a href="#640806" title="GenMSIL.this.global.icodes.ExceptionHandler">bigger</a>.<a href="../icode/ExceptionHandlers.scala.html#599664" title="=&gt; scala.collection.immutable.Set[GenMSIL.this.global.icodes.BasicBlock]">covered</a><span class="delimiter">)</span>,
                   <span title="java.lang.String(&quot;bad nesting of exception handlers. try blocks of smaller handler are not nested in bigger one.\012&quot;)" class="string">&quot;bad nesting of exception handlers. try blocks of smaller handler are not nested in bigger one.\n&quot;</span><span title="(x$1: Any)java.lang.String">+</span>
                   <a href="#640825" title="GenMSIL.this.global.icodes.ExceptionHandler">h</a> <span title="(x$1: Any)java.lang.String">+</span><span title="java.lang.String(&quot;\012&quot;)" class="string">&quot;\n&quot;</span><span title="(x$1: Any)java.lang.String">+</span> <a href="#640806" title="GenMSIL.this.global.icodes.ExceptionHandler">bigger</a><span class="delimiter">)</span>
            <a href="../../../../Predef.scala.html#9566" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a><span class="delimiter">(</span><a href="#640825" title="GenMSIL.this.global.icodes.ExceptionHandler">h</a>.<a href="../icode/ExceptionHandlers.scala.html#599669" title="=&gt; List[GenMSIL.this.global.icodes.BasicBlock]">blocks</a>.<a href="../../../../collection/TraversableOnce.scala.html#53700" title="scala.collection.immutable.Set[GenMSIL.this.global.icodes.BasicBlock]">toSet</a>.<a href="../../../../collection/GenSetLike.scala.html#59073" title="(that: scala.collection.GenSet[GenMSIL.this.global.icodes.BasicBlock])Boolean">subsetOf</a><span class="delimiter">(</span><a href="#640806" title="GenMSIL.this.global.icodes.ExceptionHandler">bigger</a>.<a href="../icode/ExceptionHandlers.scala.html#599664" title="=&gt; scala.collection.immutable.Set[GenMSIL.this.global.icodes.BasicBlock]">covered</a><span class="delimiter">)</span>,
                   <span title="java.lang.String(&quot;bad nesting of exception handlers. catch blocks of smaller handler are not nested in bigger one.\012&quot;)" class="string">&quot;bad nesting of exception handlers. catch blocks of smaller handler are not nested in bigger one.\n&quot;</span><span title="(x$1: Any)java.lang.String">+</span>
                   <a href="#640825" title="GenMSIL.this.global.icodes.ExceptionHandler">h</a> <span title="(x$1: Any)java.lang.String">+</span><span title="java.lang.String(&quot;\012&quot;)" class="string">&quot;\n&quot;</span><span title="(x$1: Any)java.lang.String">+</span> <a href="#640806" title="GenMSIL.this.global.icodes.ExceptionHandler">bigger</a><span class="delimiter">)</span>
          <span class="delimiter">}</span>
          <a href="#640600" title="scala.collection.mutable.ListBuffer[GenMSIL.this.global.icodes.ExceptionHandler]">beginHandlers</a> <a href="../../../../collection/mutable/ListBuffer.scala.html#61786" title="(x: GenMSIL.this.global.icodes.ExceptionHandler)beginHandlers.type">+=</a> <a href="#640726" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">sHandlers</a>.<a href="../../../../collection/IterableLike.scala.html#53870" title="=&gt; GenMSIL.this.global.icodes.ExceptionHandler">head</a>
          <a href="#640566" title="scala.collection.mutable.Stack[List[GenMSIL.this.global.icodes.ExceptionHandler]]">currentTryHandlers</a>.<a href="../../../../collection/mutable/Stack.scala.html#301892" title="(elem: List[GenMSIL.this.global.icodes.ExceptionHandler])currentTryHandlers.type">push</a><span class="delimiter">(</span><a href="#640726" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">sHandlers</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
        <a href="../../../../collection/mutable/HashMap.scala.html#73160" title="(key: GenMSIL.this.global.icodes.BasicBlock, value: List[GenMSIL.this.global.icodes.ExceptionHandler])Unit">beginExBlock</a><span class="delimiter">(</span><a href="#640592" title="GenMSIL.this.global.icodes.BasicBlock">b</a><span class="delimiter">)</span> = <a href="#640600" title="scala.collection.mutable.ListBuffer[GenMSIL.this.global.icodes.ExceptionHandler]">beginHandlers</a>.<a href="../../../../collection/mutable/ListBuffer.scala.html#61794" title="=&gt; List[GenMSIL.this.global.icodes.ExceptionHandler]">toList</a>
        <a href="#640564" title="scala.collection.mutable.HashSet[GenMSIL.this.global.icodes.BasicBlock]">visitedBlocks</a> <a href="../../../../collection/mutable/HashSet.scala.html#108315" title="(elem: GenMSIL.this.global.icodes.BasicBlock)visitedBlocks.type">+=</a> <a href="#640592" title="GenMSIL.this.global.icodes.BasicBlock">b</a>
      <span class="delimiter">}</span>

      <span class="comment">// if there handlers left (i.e. handlers covering nothing, or a</span>
      <span class="comment">// non-existent (dead) block), remove their catch-blocks.</span>
      <span class="keyword">val</span> <a title="List[GenMSIL.this.global.icodes.BasicBlock]" id="640568">liveBlocks</a> = <span title="List[GenMSIL.this.global.icodes.BasicBlock]" class="keyword">if</span> <span class="delimiter">(</span><a href="#640565" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">openHandlers</a>.<a href="../../../../collection/IterableLike.scala.html#53862" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <a href="#640485" title="List[GenMSIL.this.global.icodes.BasicBlock]">blocks</a> <span class="keyword">else</span> <span class="delimiter">{</span>
        <a href="#640485" title="List[GenMSIL.this.global.icodes.BasicBlock]">blocks</a>.<a href="../../../../collection/TraversableLike.scala.html#49051" title="(p: GenMSIL.this.global.icodes.BasicBlock =&gt; Boolean)List[GenMSIL.this.global.icodes.BasicBlock]">filter</a><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.BasicBlock" id="640878">b</a> =&gt; <a href="#640565" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">openHandlers</a>.<a href="../../../../collection/LinearSeqOptimized.scala.html#71035" title="(p: GenMSIL.this.global.icodes.ExceptionHandler =&gt; Boolean)Boolean">forall</a><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.ExceptionHandler" id="640887">h</a> =&gt; <a href="../../../../Boolean.scala.html#55576" title="=&gt; Boolean">!</a><a href="#640887" title="GenMSIL.this.global.icodes.ExceptionHandler">h</a>.<a href="../icode/ExceptionHandlers.scala.html#599669" title="=&gt; List[GenMSIL.this.global.icodes.BasicBlock]">blocks</a>.<a href="../../../../collection/SeqLike.scala.html#54119" title="(elem: Any)Boolean">contains</a><span class="delimiter">(</span><a href="#640878" title="GenMSIL.this.global.icodes.BasicBlock">b</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>

      <span class="comment">/** There might be open handlers, but no more blocks. happens when try/catch end
       *  with `throw` or `return`
       *     def foo() { try { .. throw } catch { _ =&gt; .. throw } }
       *
       *  In this case we need some code after the catch block for the auto-generated
       *  `leave` instruction. So we're adding a (dead) `throw new Exception`.
       */</span>
      <span class="keyword">val</span> <a title="List[GenMSIL.this.global.icodes.ExceptionHandler]" id="640569">rest</a> = <a href="#640567" title="scala.collection.mutable.Stack[List[GenMSIL.this.global.icodes.ExceptionHandler]]">currentCatchHandlers</a>.<a href="../../../../collection/TraversableLike.scala.html#49041" title="(f: List[GenMSIL.this.global.icodes.ExceptionHandler] =&gt; GenMSIL.this.global.icodes.ExceptionHandler)(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.mutable.Stack[List[GenMSIL.this.global.icodes.ExceptionHandler]],GenMSIL.this.global.icodes.ExceptionHandler,scala.collection.mutable.Stack[GenMSIL.this.global.icodes.ExceptionHandler]])scala.collection.mutable.Stack[GenMSIL.this.global.icodes.ExceptionHandler]">map</a><a href="../../../../collection/mutable/Stack.scala.html#301873" title="scala.collection.generic.CanBuildFrom[scala.collection.mutable.Stack.Coll,GenMSIL.this.global.icodes.ExceptionHandler,scala.collection.mutable.Stack[GenMSIL.this.global.icodes.ExceptionHandler]]" class="delimiter">(</a><a title="List[GenMSIL.this.global.icodes.ExceptionHandler]" id="640904">handlers</a> =&gt; <span class="delimiter">{</span>
        <a href="../../../../Predef.scala.html#9566" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a><span class="delimiter">(</span><a href="#640904" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">handlers</a>.<a href="../../../../collection/LinearSeqOptimized.scala.html#71030" title="=&gt; Int">length</a> <a href="../../../../Int.scala.html#54747" title="(x: Int)Boolean">==</a> <span title="Int(1)" class="int">1</span>, <a href="#640904" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">handlers</a><span class="delimiter">)</span>
        <a href="#640904" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">handlers</a>.<a href="../../../../collection/IterableLike.scala.html#53870" title="=&gt; GenMSIL.this.global.icodes.ExceptionHandler">head</a>
      <span class="delimiter">}</span><span class="delimiter">)</span>.<a href="../../../../collection/mutable/Stack.scala.html#301900" title="=&gt; List[GenMSIL.this.global.icodes.ExceptionHandler]">toList</a>

      <span title="List[GenMSIL.this.global.icodes.BasicBlock]" class="keyword">if</span> <span class="delimiter">(</span><a href="#640569" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">rest</a>.<a href="../../../../collection/IterableLike.scala.html#53862" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#640568" title="List[GenMSIL.this.global.icodes.BasicBlock]">liveBlocks</a>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="GenMSIL.this.global.icodes.BasicBlock" id="641011">b</a> = <a href="#640486" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#594471" title="=&gt; GenMSIL.this.global.icodes.Code">code</a>.<a href="../icode/Members.scala.html#594563" title="=&gt; GenMSIL.this.global.icodes.BasicBlock">newBlock</a>
        <a href="#641011" title="GenMSIL.this.global.icodes.BasicBlock">b</a>.<a href="../icode/BasicBlocks.scala.html#594425" title="(instrs: Seq[GenMSIL.this.global.icodes.Instruction])Unit">emit</a><span class="delimiter">(</span><a href="../../../../collection/generic/GenericCompanion.scala.html#48813" title="(elems: Product with GenMSIL.this.global.icodes.Instruction with Serializable*)Seq[Product with GenMSIL.this.global.icodes.Instruction with Serializable]">Seq</a><span class="delimiter">(</span>
          <a href="../icode/Opcodes.scala.html#604307" title="(kind: GenMSIL.this.global.icodes.REFERENCE)GenMSIL.this.global.icodes.opcodes.NEW">NEW</a><span class="delimiter">(</span><a href="../icode/TypeKinds.scala.html#593100" title="(cls: GenMSIL.this.global.icodes.global.Symbol)GenMSIL.this.global.icodes.REFERENCE">REFERENCE</a><span class="delimiter">(</span><a href="../../symtab/Definitions.scala.html#479030" title="object GenMSIL.this.global.definitions">definitions</a>.<a href="../../symtab/Definitions.scala.html#507951" title="=&gt; GenMSIL.this.global.Symbol">ThrowableClass</a><span class="delimiter">)</span><span class="delimiter">)</span>,
          <a href="../icode/Opcodes.scala.html#602320" title="(typ: GenMSIL.this.global.icodes.TypeKind)GenMSIL.this.global.icodes.opcodes.DUP">DUP</a><span class="delimiter">(</span><a href="../icode/TypeKinds.scala.html#593100" title="(cls: GenMSIL.this.global.icodes.global.Symbol)GenMSIL.this.global.icodes.REFERENCE">REFERENCE</a><span class="delimiter">(</span><a href="../../symtab/Definitions.scala.html#479030" title="object GenMSIL.this.global.definitions">definitions</a>.<a href="../../symtab/Definitions.scala.html#507925" title="=&gt; GenMSIL.this.global.Symbol">ObjectClass</a><span class="delimiter">)</span><span class="delimiter">)</span>,
          <a href="../icode/Opcodes.scala.html#604613" title="(method: GenMSIL.this.global.icodes.global.Symbol, style: GenMSIL.this.global.icodes.opcodes.InvokeStyle)GenMSIL.this.global.icodes.opcodes.CALL_METHOD">CALL_METHOD</a><span class="delimiter">(</span><a href="../../symtab/Definitions.scala.html#479030" title="object GenMSIL.this.global.definitions">definitions</a>.<a href="../../symtab/Definitions.scala.html#507951" title="=&gt; GenMSIL.this.global.Symbol">ThrowableClass</a>.<a href="../../symtab/Symbols.scala.html#509305" title="=&gt; GenMSIL.this.global.Symbol">primaryConstructor</a>, <a href="../icode/Opcodes.scala.html#604935" title="(onInstance: Boolean)GenMSIL.this.global.icodes.opcodes.Static">Static</a><span class="delimiter">(</span><span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span><span class="delimiter">)</span>,
          <a href="../icode/Opcodes.scala.html#599286" title="(clasz: GenMSIL.this.global.icodes.global.Symbol)GenMSIL.this.global.icodes.opcodes.THROW">THROW</a><span class="delimiter">(</span><a href="../../symtab/Definitions.scala.html#479030" title="object GenMSIL.this.global.definitions">definitions</a>.<a href="../../symtab/Definitions.scala.html#507951" title="=&gt; GenMSIL.this.global.Symbol">ThrowableClass</a><span class="delimiter">)</span>
        <span class="delimiter">)</span><span class="delimiter">)</span>
        <a href="#641011" title="GenMSIL.this.global.icodes.BasicBlock">b</a>.<a href="../icode/BasicBlocks.scala.html#594429" title="()Unit">close</a>
        <a href="../../../../collection/mutable/HashMap.scala.html#73160" title="(key: GenMSIL.this.global.icodes.BasicBlock, value: List[GenMSIL.this.global.icodes.ExceptionHandler])Unit">endExBlock</a><span class="delimiter">(</span><a href="#641011" title="GenMSIL.this.global.icodes.BasicBlock">b</a><span class="delimiter">)</span> = <a href="#640569" title="List[GenMSIL.this.global.icodes.ExceptionHandler]">rest</a>
        <a href="#640568" title="List[GenMSIL.this.global.icodes.BasicBlock]">liveBlocks</a> <a href="../../../../collection/immutable/List.scala.html#49143" title="(prefix: List[GenMSIL.this.global.icodes.BasicBlock])List[GenMSIL.this.global.icodes.BasicBlock]">:::</a> <a href="../../../../collection/immutable/List.scala.html#48877" title="(xs: GenMSIL.this.global.icodes.BasicBlock*)List[GenMSIL.this.global.icodes.BasicBlock]">List</a><span class="delimiter">(</span><a href="#641011" title="GenMSIL.this.global.icodes.BasicBlock">b</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <span class="comment">/**
     *  @param block the BasicBlock to emit code for
     *  @param next  the following BasicBlock, `null` if `block` is the last one
     */</span>
    <span class="keyword">def</span> <a title="(block: GenMSIL.this.global.icodes.BasicBlock, prev: GenMSIL.this.global.icodes.BasicBlock, next: GenMSIL.this.global.icodes.BasicBlock)Unit" id="636740">genBlock</a><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.BasicBlock" id="640517">block</a>: <a href="../icode/BasicBlocks.scala.html#501270" title="GenMSIL.this.global.icodes.BasicBlock">BasicBlock</a>, <a title="GenMSIL.this.global.icodes.BasicBlock" id="640518">prev</a>: <a href="../icode/BasicBlocks.scala.html#501270" title="GenMSIL.this.global.icodes.BasicBlock">BasicBlock</a>, <a title="GenMSIL.this.global.icodes.BasicBlock" id="640519">next</a>: <a href="../icode/BasicBlocks.scala.html#501270" title="GenMSIL.this.global.icodes.BasicBlock">BasicBlock</a><span class="delimiter">)</span> <span class="delimiter">{</span>

      <span class="keyword">def</span> <a title="(local: GenMSIL.this.global.icodes.Local, msg: String, loadAddr: Boolean)Unit" id="641070">loadLocalOrAddress</a><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.Local" id="641075">local</a>: <a href="../icode/Members.scala.html#501264" title="GenMSIL.this.global.icodes.Local">Local</a>, <a title="String" id="641076">msg</a> : <span title="String">String</span> , <a title="Boolean" id="641077">loadAddr</a> : <a href="../../../../Boolean.scala.html#65" title="Boolean">Boolean</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../Global.scala.html#478200" title="=&gt; scala.tools.nsc.Settings">settings</a>.<a href="../../settings/ScalaSettings.scala.html#469727" title="=&gt; scala.tools.nsc.Settings#BooleanSetting">debug</a>.<a href="../../settings/MutableSettings.scala.html#470030" title="=&gt; Boolean">value</a><span class="delimiter">)</span>
          <a href="../../Global.scala.html#478254" title="(msg: =&gt; AnyRef)Unit">log</a><span class="delimiter">(</span><a href="#641076" title="String">msg</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot; for &quot;)" class="string">&quot; for &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#641075" title="GenMSIL.this.global.icodes.Local">local</a><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="Boolean" id="641078">isArg</a> = <a href="#641075" title="GenMSIL.this.global.icodes.Local">local</a>.<a href="../icode/Members.scala.html#594663" title="=&gt; Boolean">arg</a>
        <span class="keyword">val</span> <a title="Int" id="641079">i</a> = <a href="#641075" title="GenMSIL.this.global.icodes.Local">local</a>.<a href="../icode/Members.scala.html#594666" title="=&gt; Int">index</a>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#641078" title="Boolean">isArg</a><span class="delimiter">)</span>
          <a href="#636743" title="(code: ch.epfl.lamp.compiler.msil.emit.ILGenerator, loadAddr: Boolean)(i: Int)Unit">loadArg</a><span class="delimiter">(</span><a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>, <a href="#641077" title="Boolean">loadAddr</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#641079" title="Int">i</a><span class="delimiter">)</span>
        <span class="keyword">else</span>
          <a href="#636744" title="(i: Int, local: GenMSIL.this.global.icodes.Local, code: ch.epfl.lamp.compiler.msil.emit.ILGenerator, loadAddr: Boolean)Unit">loadLocal</a><span class="delimiter">(</span><a href="#641079" title="Int">i</a>, <a href="#641075" title="GenMSIL.this.global.icodes.Local">local</a>, <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>, <a href="#641077" title="Boolean">loadAddr</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>

      <span class="keyword">def</span> <a title="(field: GenMSIL.this.global.Symbol, isStatic: Boolean, msg: String, loadAddr: Boolean)Unit" id="641071">loadFieldOrAddress</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="641240">field</a>: <a href="../../symtab/Symbols.scala.html#478659" title="GenMSIL.this.global.Symbol">Symbol</a>, <a title="Boolean" id="641241">isStatic</a>: <a href="../../../../Boolean.scala.html#65" title="Boolean">Boolean</a>, <a title="String" id="641242">msg</a>: <span title="String">String</span>, <a title="Boolean" id="641243">loadAddr</a> : <a href="../../../../Boolean.scala.html#65" title="Boolean">Boolean</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../Global.scala.html#478200" title="=&gt; scala.tools.nsc.Settings">settings</a>.<a href="../../settings/ScalaSettings.scala.html#469727" title="=&gt; scala.tools.nsc.Settings#BooleanSetting">debug</a>.<a href="../../settings/MutableSettings.scala.html#470030" title="=&gt; Boolean">value</a><span class="delimiter">)</span>
          <a href="../../Global.scala.html#478254" title="(msg: =&gt; AnyRef)Unit">log</a><span class="delimiter">(</span><a href="#641242" title="String">msg</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot; with owner: &quot;)" class="string">&quot; with owner: &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#641240" title="GenMSIL.this.global.Symbol">field</a>.<a href="../../symtab/Symbols.scala.html#509249" title="=&gt; GenMSIL.this.global.Symbol">owner</a> <span title="(x$1: Any)java.lang.String">+</span>
              <span title="java.lang.String(&quot; flags: &quot;)" class="string">&quot; flags: &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="../../symtab/Flags.scala.html#36139" title="object scala.tools.nsc.symtab.Flags">Flags</a>.<a href="../../../../reflect/generic/Flags.scala.html#435634" title="(flags: Long)String">flagsToString</a><span class="delimiter">(</span><a href="#641240" title="GenMSIL.this.global.Symbol">field</a>.<a href="../../symtab/Symbols.scala.html#509249" title="=&gt; GenMSIL.this.global.Symbol">owner</a>.<a href="../../symtab/Symbols.scala.html#509259" title="=&gt; Long">flags</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="keyword">var</span> <a title="ch.epfl.lamp.compiler.msil.FieldInfo" id="641244">fieldInfo</a> = <a href="../../symtab/clr/CLRTypes.scala.html#601643" title="=&gt; scala.collection.mutable.Map[GenMSIL.this.global.loaders.clrTypes.global.Symbol,ch.epfl.lamp.compiler.msil.FieldInfo]">fields</a>.<a href="../../../../collection/MapLike.scala.html#73194" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol)Option[ch.epfl.lamp.compiler.msil.FieldInfo]">get</a><span class="delimiter">(</span><a href="#641240" title="GenMSIL.this.global.Symbol">field</a><span class="delimiter">)</span> <span title="ch.epfl.lamp.compiler.msil.FieldInfo" class="keyword">match</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> <span title="ch.epfl.lamp.compiler.msil.FieldInfo">Some</span><span class="delimiter">(</span><a title="ch.epfl.lamp.compiler.msil.FieldInfo" id="641254">fInfo</a><span class="delimiter">)</span> =&gt; <a href="#641254" title="ch.epfl.lamp.compiler.msil.FieldInfo">fInfo</a>
          <span class="keyword">case</span> <a href="../../../../Option.scala.html#1737" title="ch.epfl.lamp.compiler.msil.FieldInfo">None</a> =&gt;
            <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.FieldInfo" id="641255">fInfo</a> = <a href="#636765" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.Type">getType</a><span class="delimiter">(</span><a href="#641240" title="GenMSIL.this.global.Symbol">field</a>.<a href="../../symtab/Symbols.scala.html#509249" title="=&gt; GenMSIL.this.global.Symbol">owner</a><span class="delimiter">)</span>.<span title="(x$1: java.lang.String)ch.epfl.lamp.compiler.msil.FieldInfo">GetField</span><span class="delimiter">(</span><a href="#636750" title="(sym: GenMSIL.this.global.Symbol)String">msilName</a><span class="delimiter">(</span><a href="#641240" title="GenMSIL.this.global.Symbol">field</a><span class="delimiter">)</span><span class="delimiter">)</span>
            <a href="../../../../collection/mutable/MapLike.scala.html#73272" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol, value: ch.epfl.lamp.compiler.msil.FieldInfo)Unit">fields</a><span class="delimiter">(</span><a href="#641240" title="GenMSIL.this.global.Symbol">field</a><span class="delimiter">)</span> = <a href="#641255" title="ch.epfl.lamp.compiler.msil.FieldInfo">fInfo</a>
            <a href="#641255" title="ch.epfl.lamp.compiler.msil.FieldInfo">fInfo</a>
        <span class="delimiter">}</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#641244" title="ch.epfl.lamp.compiler.msil.FieldInfo">fieldInfo</a>.<span title="()Boolean">IsVolatile</span><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Volatile</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../../../Boolean.scala.html#55576" title="=&gt; Boolean">!</a><a href="#641244" title="ch.epfl.lamp.compiler.msil.FieldInfo">fieldInfo</a>.<span title="()Boolean">IsLiteral</span><span class="delimiter">)</span> <span class="delimiter">{</span>
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#641243" title="Boolean">loadAddr</a><span class="delimiter">)</span> <span class="delimiter">{</span>
            <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.FieldInfo)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCode" class="keyword">if</span> <span class="delimiter">(</span><a href="#641241" title="Boolean">isStatic</a><span class="delimiter">)</span> <span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldsflda</span> <span class="keyword">else</span> <span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldflda</span>, <a href="#641244" title="ch.epfl.lamp.compiler.msil.FieldInfo">fieldInfo</a><span class="delimiter">)</span>
          <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
            <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.FieldInfo)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCode" class="keyword">if</span> <span class="delimiter">(</span><a href="#641241" title="Boolean">isStatic</a><span class="delimiter">)</span> <span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldsfld</span> <span class="keyword">else</span> <span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldfld</span>, <a href="#641244" title="ch.epfl.lamp.compiler.msil.FieldInfo">fieldInfo</a><span class="delimiter">)</span>
          <span class="delimiter">}</span>
        <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
          <a href="../../../../Predef.scala.html#9566" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a><span class="delimiter">(</span><a href="../../../../Boolean.scala.html#55576" title="=&gt; Boolean">!</a><a href="#641243" title="Boolean">loadAddr</a>, <span title="java.lang.String(&quot;can\'t take AddressOf a literal field (not even with readonly. prefix) because no memory was allocated to such field ...&quot;)" class="string">&quot;can't take AddressOf a literal field (not even with readonly. prefix) because no memory was allocated to such field ...&quot;</span><span class="delimiter">)</span>
          <span class="comment">// TODO the above can be overcome by loading the value, boxing, and finally unboxing. An address to a copy of the raw value will be on the stack.</span>
         <span class="comment">/*  We perform `field inlining' as required by CLR.
          *  Emit as for a CONSTANT ICode stmt, with the twist that the constant value is available
          *  as a java.lang.Object and its .NET type allows constant initialization in CLR, i.e. that type
          *  is one of I1, I2, I4, I8, R4, R8, CHAR, BOOLEAN, STRING, or CLASS (in this last case,
          *  only accepting nullref as value). See Table 9-1 in Lidin's book on ILAsm. */</span>
          <span class="keyword">val</span> <a title="java.lang.Object" id="641270">value</a> = <a href="#641244" title="ch.epfl.lamp.compiler.msil.FieldInfo">fieldInfo</a>.<span title="()java.lang.Object">getValue</span><span class="delimiter">(</span><span class="delimiter">)</span>
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#641270" title="java.lang.Object">value</a> <span title="(x$1: AnyRef)Boolean">==</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <span class="delimiter">{</span>
            <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldnull</span><span class="delimiter">)</span>
          <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
            <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.Type" id="641279">typ</a> = <span title="ch.epfl.lamp.compiler.msil.Type" class="keyword">if</span> <span class="delimiter">(</span><a href="#641244" title="ch.epfl.lamp.compiler.msil.FieldInfo">fieldInfo</a>.<span title="ch.epfl.lamp.compiler.msil.Type">FieldType</span>.<span title="()Boolean">IsEnum</span><span class="delimiter">)</span> <a href="#641244" title="ch.epfl.lamp.compiler.msil.FieldInfo">fieldInfo</a>.<span title="ch.epfl.lamp.compiler.msil.Type">FieldType</span>.<span title="()ch.epfl.lamp.compiler.msil.Type">getUnderlyingType</span>
                      <span class="keyword">else</span> <a href="#641244" title="ch.epfl.lamp.compiler.msil.FieldInfo">fieldInfo</a>.<span title="ch.epfl.lamp.compiler.msil.Type">FieldType</span>
            <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#641279" title="ch.epfl.lamp.compiler.msil.Type">typ</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../symtab/SymbolLoaders.scala.html#506452" title="object GenMSIL.this.global.loaders.clrTypes">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#601613" title="=&gt; ch.epfl.lamp.compiler.msil.Type">STRING</a><span class="delimiter">)</span> <span class="delimiter">{</span>
              <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: String)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldstr</span>, <a href="#641270" title="java.lang.Object">value</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="String" class="delimiter">[</span><span title="String">String</span><span class="delimiter">]</span><span class="delimiter">)</span>
            <span class="delimiter">}</span> <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#641279" title="ch.epfl.lamp.compiler.msil.Type">typ</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../symtab/SymbolLoaders.scala.html#506452" title="object GenMSIL.this.global.loaders.clrTypes">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#601598" title="=&gt; ch.epfl.lamp.compiler.msil.Type">BOOLEAN</a><span class="delimiter">)</span> <span class="delimiter">{</span>
                <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCode" class="keyword">if</span> <span class="delimiter">(</span><a href="#641270" title="java.lang.Object">value</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="Boolean" class="delimiter">[</span><a href="../../../../Boolean.scala.html#65" title="Boolean">Boolean</a><span class="delimiter">]</span><span class="delimiter">)</span> <span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldc_I4_1</span>
                           <span class="keyword">else</span> <span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldc_I4_0</span><span class="delimiter">)</span>
            <span class="delimiter">}</span> <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#641279" title="ch.epfl.lamp.compiler.msil.Type">typ</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../symtab/SymbolLoaders.scala.html#506452" title="object GenMSIL.this.global.loaders.clrTypes">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#601565" title="=&gt; ch.epfl.lamp.compiler.msil.Type">BYTE</a> <a href="../../../../Boolean.scala.html#55579" title="(x: Boolean)Boolean">||</a> <a href="#641279" title="ch.epfl.lamp.compiler.msil.Type">typ</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../symtab/SymbolLoaders.scala.html#506452" title="object GenMSIL.this.global.loaders.clrTypes">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#601568" title="=&gt; ch.epfl.lamp.compiler.msil.Type">UBYTE</a><span class="delimiter">)</span> <span class="delimiter">{</span>
              <a href="#636742" title="(value: Int, code: ch.epfl.lamp.compiler.msil.emit.ILGenerator)Unit">loadI4</a><span class="delimiter">(</span><a href="#641270" title="java.lang.Object">value</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><a href="../../../../Byte.scala.html#54432" title="=&gt; Int" class="delimiter">[</a><a href="../../../../Byte.scala.html#1013" title="Byte">Byte</a><span class="delimiter">]</span>, <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a><span class="delimiter">)</span>
            <span class="delimiter">}</span> <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#641279" title="ch.epfl.lamp.compiler.msil.Type">typ</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../symtab/SymbolLoaders.scala.html#506452" title="object GenMSIL.this.global.loaders.clrTypes">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#601571" title="=&gt; ch.epfl.lamp.compiler.msil.Type">SHORT</a> <a href="../../../../Boolean.scala.html#55579" title="(x: Boolean)Boolean">||</a> <a href="#641279" title="ch.epfl.lamp.compiler.msil.Type">typ</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../symtab/SymbolLoaders.scala.html#506452" title="object GenMSIL.this.global.loaders.clrTypes">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#601574" title="=&gt; ch.epfl.lamp.compiler.msil.Type">USHORT</a><span class="delimiter">)</span> <span class="delimiter">{</span>
              <a href="#636742" title="(value: Int, code: ch.epfl.lamp.compiler.msil.emit.ILGenerator)Unit">loadI4</a><span class="delimiter">(</span><a href="#641270" title="java.lang.Object">value</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="Int" class="delimiter">[</span><a href="../../../../Int.scala.html#386" title="Int">Int</a><span class="delimiter">]</span>, <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a><span class="delimiter">)</span>
            <span class="delimiter">}</span> <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#641279" title="ch.epfl.lamp.compiler.msil.Type">typ</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../symtab/SymbolLoaders.scala.html#506452" title="object GenMSIL.this.global.loaders.clrTypes">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#601577" title="=&gt; ch.epfl.lamp.compiler.msil.Type">CHAR</a><span class="delimiter">)</span> <span class="delimiter">{</span>
              <a href="#636742" title="(value: Int, code: ch.epfl.lamp.compiler.msil.emit.ILGenerator)Unit">loadI4</a><span class="delimiter">(</span><a href="#641270" title="java.lang.Object">value</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><a href="../../../../Char.scala.html#54886" title="=&gt; Int" class="delimiter">[</a><a href="../../../../Char.scala.html#2189" title="Char">Char</a><span class="delimiter">]</span>, <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a><span class="delimiter">)</span>
            <span class="delimiter">}</span> <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#641279" title="ch.epfl.lamp.compiler.msil.Type">typ</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../symtab/SymbolLoaders.scala.html#506452" title="object GenMSIL.this.global.loaders.clrTypes">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#601580" title="=&gt; ch.epfl.lamp.compiler.msil.Type">INT</a> <a href="../../../../Boolean.scala.html#55579" title="(x: Boolean)Boolean">||</a> <a href="#641279" title="ch.epfl.lamp.compiler.msil.Type">typ</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../symtab/SymbolLoaders.scala.html#506452" title="object GenMSIL.this.global.loaders.clrTypes">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#601583" title="=&gt; ch.epfl.lamp.compiler.msil.Type">UINT</a><span class="delimiter">)</span> <span class="delimiter">{</span>
              <a href="#636742" title="(value: Int, code: ch.epfl.lamp.compiler.msil.emit.ILGenerator)Unit">loadI4</a><span class="delimiter">(</span><a href="#641270" title="java.lang.Object">value</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="Int" class="delimiter">[</span><a href="../../../../Int.scala.html#386" title="Int">Int</a><span class="delimiter">]</span>, <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a><span class="delimiter">)</span>
            <span class="delimiter">}</span> <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#641279" title="ch.epfl.lamp.compiler.msil.Type">typ</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../symtab/SymbolLoaders.scala.html#506452" title="object GenMSIL.this.global.loaders.clrTypes">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#601586" title="=&gt; ch.epfl.lamp.compiler.msil.Type">LONG</a> <a href="../../../../Boolean.scala.html#55579" title="(x: Boolean)Boolean">||</a> <a href="#641279" title="ch.epfl.lamp.compiler.msil.Type">typ</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../symtab/SymbolLoaders.scala.html#506452" title="object GenMSIL.this.global.loaders.clrTypes">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#601589" title="=&gt; ch.epfl.lamp.compiler.msil.Type">ULONG</a><span class="delimiter">)</span> <span class="delimiter">{</span>
              <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: Long)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldc_I8</span>, <a href="#641270" title="java.lang.Object">value</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="Long" class="delimiter">[</span><a href="../../../../Long.scala.html#1439" title="Long">Long</a><span class="delimiter">]</span><span class="delimiter">)</span>
            <span class="delimiter">}</span> <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#641279" title="ch.epfl.lamp.compiler.msil.Type">typ</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../symtab/SymbolLoaders.scala.html#506452" title="object GenMSIL.this.global.loaders.clrTypes">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#601592" title="=&gt; ch.epfl.lamp.compiler.msil.Type">FLOAT</a><span class="delimiter">)</span> <span class="delimiter">{</span>
              <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: Float)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldc_R4</span>, <a href="#641270" title="java.lang.Object">value</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="Float" class="delimiter">[</span><a href="../../../../Float.scala.html#1157" title="Float">Float</a><span class="delimiter">]</span><span class="delimiter">)</span>
            <span class="delimiter">}</span> <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#641279" title="ch.epfl.lamp.compiler.msil.Type">typ</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../symtab/SymbolLoaders.scala.html#506452" title="object GenMSIL.this.global.loaders.clrTypes">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#601595" title="=&gt; ch.epfl.lamp.compiler.msil.Type">DOUBLE</a><span class="delimiter">)</span> <span class="delimiter">{</span>
              <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: Double)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldc_R8</span>, <a href="#641270" title="java.lang.Object">value</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="Double" class="delimiter">[</span><a href="../../../../Double.scala.html#281" title="Double">Double</a><span class="delimiter">]</span><span class="delimiter">)</span>
            <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
              <span class="comment">/* TODO one more case is described in Partition II, 16.2: bytearray(...) */</span>
              <a href="../../symtab/SymbolTable.scala.html#478159" title="(msg: String)Nothing">abort</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Unknown type for static literal field: &quot;)" class="string">&quot;Unknown type for static literal field: &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#641244" title="ch.epfl.lamp.compiler.msil.FieldInfo">fieldInfo</a><span class="delimiter">)</span>
            <span class="delimiter">}</span>
          <span class="delimiter">}</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>

      <span class="comment">/** Creating objects works differently on .NET. On the JVM
       *  - NEW(type) =&gt; reference on Stack
       *  - DUP, load arguments, CALL_METHOD(constructor)
       *
       * On .NET, the NEW and DUP are ignored, but we emit a special method call
       *  - load arguments
       *  - NewObj(constructor) =&gt; reference on stack
       *
       * This variable tells whether the previous instruction was a NEW,
       * we expect a DUP which is not emitted. */</span>
      <span class="keyword">var</span> <a title="Boolean" id="641072">previousWasNEW</a> = <span title="Boolean(false)" class="keyword">false</span>

      <span class="keyword">var</span> <a title="Int" id="641073">lastLineNr</a>: <a href="../../../../Int.scala.html#386" title="Int">Int</a> = <span title="Int(0)" class="int">0</span>
      <span class="keyword">var</span> <a title="GenMSIL.this.global.Position" id="641074">lastPos</a>: <a href="../../util/Position.scala.html#42664" title="GenMSIL.this.global.Position">Position</a> = <a href="../../symtab/Positions.scala.html#479233" title="=&gt; tools.nsc.util.NoPosition.type">NoPosition</a>


      <span class="comment">// EndExceptionBlock must happen before MarkLabel because it adds the</span>
      <span class="comment">// Leave instruction. Otherwise, labels(block) points to the Leave</span>
      <span class="comment">// (inside the catch) instead of the instruction afterwards.</span>
      <span class="keyword">for</span> <span class="delimiter">(</span><a title="List[GenMSIL.this.global.icodes.ExceptionHandler]" id="641362">handlers</a> &lt;- <a href="#636719" title="=&gt; scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.BasicBlock,List[GenMSIL.this.global.icodes.ExceptionHandler]]">endExBlock</a>.<a href="../../../../collection/mutable/HashMap.scala.html#73158" title="(key: GenMSIL.this.global.icodes.BasicBlock)Option[List[GenMSIL.this.global.icodes.ExceptionHandler]]">get</a><a href="../../../../Option.scala.html#48491" title="(f: List[GenMSIL.this.global.icodes.ExceptionHandler] =&gt; Unit)Unit" class="delimiter">(</a><a href="#640517" title="GenMSIL.this.global.icodes.BasicBlock">block</a><span class="delimiter">)</span>; <a title="GenMSIL.this.global.icodes.ExceptionHandler" id="641382">exh</a> &lt;- <a href="../../../../collection/LinearSeqOptimized.scala.html#71032" title="(f: GenMSIL.this.global.icodes.ExceptionHandler =&gt; Unit)Unit">handlers</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#636722" title="=&gt; scala.collection.mutable.Stack[GenMSIL.this.global.icodes.ExceptionHandler]">currentHandlers</a>.<a href="../../../../collection/mutable/Stack.scala.html#301897" title="()GenMSIL.this.global.icodes.ExceptionHandler">pop</a><span class="delimiter">(</span><span class="delimiter">)</span>
        <span class="keyword">for</span> <span class="delimiter">(</span><a title="ch.epfl.lamp.compiler.msil.emit.Label" id="641390">l</a> &lt;- <a href="#636737" title="=&gt; scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.ExceptionHandler,ch.epfl.lamp.compiler.msil.emit.Label]">endFinallyLabels</a>.<a href="../../../../collection/mutable/HashMap.scala.html#73158" title="(key: GenMSIL.this.global.icodes.ExceptionHandler)Option[ch.epfl.lamp.compiler.msil.emit.Label]">get</a><a href="../../../../Option.scala.html#48491" title="(f: ch.epfl.lamp.compiler.msil.emit.Label =&gt; Unit)Unit" class="delimiter">(</a><a href="#641382" title="GenMSIL.this.global.icodes.ExceptionHandler">exh</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(label: ch.epfl.lamp.compiler.msil.emit.Label)Unit">MarkLabel</span><span class="delimiter">(</span><a href="#641390" title="ch.epfl.lamp.compiler.msil.emit.Label">l</a><span class="delimiter">)</span>
        <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="()Unit">EndExceptionBlock</span><span class="delimiter">(</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>

      <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(label: ch.epfl.lamp.compiler.msil.emit.Label)Unit">MarkLabel</span><span class="delimiter">(</span><a href="../../../../collection/MapLike.scala.html#73204" title="(key: GenMSIL.this.global.icodes.BasicBlock)ch.epfl.lamp.compiler.msil.emit.Label">labels</a><span class="delimiter">(</span><a href="#640517" title="GenMSIL.this.global.icodes.BasicBlock">block</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../Global.scala.html#478200" title="=&gt; scala.tools.nsc.Settings">settings</a>.<a href="../../settings/ScalaSettings.scala.html#469727" title="=&gt; scala.tools.nsc.Settings#BooleanSetting">debug</a>.<a href="../../settings/MutableSettings.scala.html#470030" title="=&gt; Boolean">value</a><span class="delimiter">)</span>
        <a href="../../Global.scala.html#478254" title="(msg: =&gt; AnyRef)Unit">log</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Generating code for block: &quot;)" class="string">&quot;Generating code for block: &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#640517" title="GenMSIL.this.global.icodes.BasicBlock">block</a><span class="delimiter">)</span>

      <span class="keyword">for</span> <span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.ExceptionHandler" id="641425">handler</a> &lt;- <a href="#636717" title="=&gt; scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.BasicBlock,GenMSIL.this.global.icodes.ExceptionHandler]">beginCatchBlock</a>.<a href="../../../../collection/mutable/HashMap.scala.html#73158" title="(key: GenMSIL.this.global.icodes.BasicBlock)Option[GenMSIL.this.global.icodes.ExceptionHandler]">get</a><a href="../../../../Option.scala.html#48491" title="(f: GenMSIL.this.global.icodes.ExceptionHandler =&gt; Unit)Unit" class="delimiter">(</a><a href="#640517" title="GenMSIL.this.global.icodes.BasicBlock">block</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span title="Any" class="keyword">if</span> <span class="delimiter">(</span><a href="../../../../Boolean.scala.html#55576" title="=&gt; Boolean">!</a><a href="#636722" title="=&gt; scala.collection.mutable.Stack[GenMSIL.this.global.icodes.ExceptionHandler]">currentHandlers</a>.<a href="../../../../collection/mutable/Stack.scala.html#301888" title="=&gt; Boolean">isEmpty</a> <a href="../../../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#636722" title="=&gt; scala.collection.mutable.Stack[GenMSIL.this.global.icodes.ExceptionHandler]">currentHandlers</a>.<a href="../../../../collection/mutable/Stack.scala.html#301896" title="=&gt; GenMSIL.this.global.icodes.ExceptionHandler">top</a>.<a href="../icode/ExceptionHandlers.scala.html#599664" title="=&gt; scala.collection.immutable.Set[GenMSIL.this.global.icodes.BasicBlock]">covered</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#641425" title="GenMSIL.this.global.icodes.ExceptionHandler">handler</a>.<a href="../icode/ExceptionHandlers.scala.html#599664" title="=&gt; scala.collection.immutable.Set[GenMSIL.this.global.icodes.BasicBlock]">covered</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="#636722" title="=&gt; scala.collection.mutable.Stack[GenMSIL.this.global.icodes.ExceptionHandler]">currentHandlers</a>.<a href="../../../../collection/mutable/Stack.scala.html#301897" title="()GenMSIL.this.global.icodes.ExceptionHandler">pop</a><span class="delimiter">(</span><span class="delimiter">)</span>
          <a href="#636722" title="=&gt; scala.collection.mutable.Stack[GenMSIL.this.global.icodes.ExceptionHandler]">currentHandlers</a>.<a href="../../../../collection/mutable/Stack.scala.html#301892" title="(elem: GenMSIL.this.global.icodes.ExceptionHandler)scala.collection.mutable.Stack[GenMSIL.this.global.icodes.ExceptionHandler]">push</a><span class="delimiter">(</span><a href="#641425" title="GenMSIL.this.global.icodes.ExceptionHandler">handler</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#641425" title="GenMSIL.this.global.icodes.ExceptionHandler">handler</a>.<a href="../icode/ExceptionHandlers.scala.html#599647" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">cls</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../symtab/Symbols.scala.html#478667" title="object GenMSIL.this.global.NoSymbol">NoSymbol</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <span class="comment">// `finally` blocks are represented the same as `catch`, but with no catch-type</span>
          <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="()Unit">BeginFinallyBlock</span><span class="delimiter">(</span><span class="delimiter">)</span>
        <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
          <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.Type" id="641456">t</a> = <a href="#636765" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.Type">getType</a><span class="delimiter">(</span><a href="#641425" title="GenMSIL.this.global.icodes.ExceptionHandler">handler</a>.<a href="../icode/ExceptionHandlers.scala.html#599647" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">cls</a><span class="delimiter">)</span>
          <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(exceptionType: ch.epfl.lamp.compiler.msil.Type)Unit">BeginCatchBlock</span><span class="delimiter">(</span><a href="#641456" title="ch.epfl.lamp.compiler.msil.Type">t</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>
      <span class="keyword">for</span> <span class="delimiter">(</span><a title="List[GenMSIL.this.global.icodes.ExceptionHandler]" id="641465">handlers</a> &lt;- <a href="#636715" title="=&gt; scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.BasicBlock,List[GenMSIL.this.global.icodes.ExceptionHandler]]">beginExBlock</a>.<a href="../../../../collection/mutable/HashMap.scala.html#73158" title="(key: GenMSIL.this.global.icodes.BasicBlock)Option[List[GenMSIL.this.global.icodes.ExceptionHandler]]">get</a><a href="../../../../Option.scala.html#48491" title="(f: List[GenMSIL.this.global.icodes.ExceptionHandler] =&gt; Unit)Unit" class="delimiter">(</a><a href="#640517" title="GenMSIL.this.global.icodes.BasicBlock">block</a><span class="delimiter">)</span>; <a title="GenMSIL.this.global.icodes.ExceptionHandler" id="641485">exh</a> &lt;- <a href="../../../../collection/LinearSeqOptimized.scala.html#71032" title="(f: GenMSIL.this.global.icodes.ExceptionHandler =&gt; Unit)Unit">handlers</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#636722" title="=&gt; scala.collection.mutable.Stack[GenMSIL.this.global.icodes.ExceptionHandler]">currentHandlers</a>.<a href="../../../../collection/mutable/Stack.scala.html#301892" title="(elem: GenMSIL.this.global.icodes.ExceptionHandler)scala.collection.mutable.Stack[GenMSIL.this.global.icodes.ExceptionHandler]">push</a><span class="delimiter">(</span><a href="#641485" title="GenMSIL.this.global.icodes.ExceptionHandler">exh</a><span class="delimiter">)</span>
        <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="()Unit">BeginExceptionBlock</span><span class="delimiter">(</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>

      <span class="keyword">for</span> <span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.Instruction" id="641509">instr</a> &lt;- <a href="../icode/BasicBlocks.scala.html#594411" title="(f: GenMSIL.this.global.icodes.Instruction =&gt; Unit)Unit">block</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="keyword">try</span> <span class="delimiter">{</span>
          <span class="keyword">val</span> <a title="Int" id="641510">currentLineNr</a> = <a href="#641509" title="GenMSIL.this.global.icodes.Instruction">instr</a>.<a href="../icode/Opcodes.scala.html#594690" title="=&gt; scala.tools.nsc.util.Position">pos</a>.<a href="../../util/Position.scala.html#501514" title="=&gt; Int">line</a>
          <span class="keyword">val</span> <a title="Boolean" id="641511">skip</a> = <span title="Boolean" class="keyword">if</span><span class="delimiter">(</span><a href="#641509" title="GenMSIL.this.global.icodes.Instruction">instr</a>.<a href="../icode/Opcodes.scala.html#594690" title="=&gt; scala.tools.nsc.util.Position">pos</a>.<a href="../../util/Position.scala.html#501490" title="=&gt; Boolean">isRange</a><span class="delimiter">)</span> <a href="#641509" title="GenMSIL.this.global.icodes.Instruction">instr</a>.<a href="../icode/Opcodes.scala.html#594690" title="=&gt; scala.tools.nsc.util.Position">pos</a>.<a href="../../util/Position.scala.html#501513" title="(pos: scala.tools.nsc.util.Position)Boolean">sameRange</a><span class="delimiter">(</span><a href="#641074" title="GenMSIL.this.global.Position">lastPos</a><span class="delimiter">)</span> <span class="keyword">else</span> <span class="delimiter">(</span><a href="#641510" title="Int">currentLineNr</a> <a href="../../../../Int.scala.html#54747" title="(x: Int)Boolean">==</a> <a href="#641073" title="Int">lastLineNr</a><span class="delimiter">)</span>;
          <span title="Unit" class="keyword">if</span><span class="delimiter">(</span><a href="../../../../Boolean.scala.html#55576" title="=&gt; Boolean">!</a><a href="#641511" title="Boolean">skip</a> <a href="../../../../Boolean.scala.html#55579" title="(x: Boolean)Boolean">||</a> <a href="../../../../Boolean.scala.html#55576" title="=&gt; Boolean">!</a><a href="#636711" title="=&gt; Boolean">dbFilenameSeen</a><span class="delimiter">)</span> <span class="delimiter">{</span>
            <span class="keyword">val</span> <a title="java.lang.String" id="641529">fileName</a> = <span title="java.lang.String" class="keyword">if</span><span class="delimiter">(</span><a href="#636711" title="=&gt; Boolean">dbFilenameSeen</a><span class="delimiter">)</span> <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span> <span class="keyword">else</span> <span class="delimiter">{</span><a href="#636711" title="(x$1: Boolean)Unit">dbFilenameSeen</a> = <span title="Boolean(true)" class="keyword">true</span>; <a href="#636703" title="(iclass: GenMSIL.this.global.icodes.IClass)String">ilasmFileName</a><span class="delimiter">(</span><a href="#636668" title="=&gt; GenMSIL.this.global.icodes.IClass">clasz</a><span class="delimiter">)</span><span class="delimiter">}</span>;
            <span title="Unit" class="keyword">if</span><span class="delimiter">(</span><a href="#641509" title="GenMSIL.this.global.icodes.Instruction">instr</a>.<a href="../icode/Opcodes.scala.html#594690" title="=&gt; scala.tools.nsc.util.Position">pos</a>.<a href="../../util/Position.scala.html#501490" title="=&gt; Boolean">isRange</a><span class="delimiter">)</span> <span class="delimiter">{</span>
              <span class="keyword">val</span> <a title="Int" id="641530">startLine</a> = <a href="#641509" title="GenMSIL.this.global.icodes.Instruction">instr</a>.<a href="../icode/Opcodes.scala.html#594690" title="=&gt; scala.tools.nsc.util.Position">pos</a>.<a href="../../util/Position.scala.html#501505" title="=&gt; scala.tools.nsc.util.Position">focusStart</a>.<a href="../../util/Position.scala.html#501514" title="=&gt; Int">line</a>
              <span class="keyword">val</span> <a title="Int" id="641531">endLine</a>   = <a href="#641509" title="GenMSIL.this.global.icodes.Instruction">instr</a>.<a href="../icode/Opcodes.scala.html#594690" title="=&gt; scala.tools.nsc.util.Position">pos</a>.<a href="../../util/Position.scala.html#501507" title="=&gt; scala.tools.nsc.util.Position">focusEnd</a>.<a href="../../util/Position.scala.html#501514" title="=&gt; Int">line</a>
              <span class="keyword">val</span> <a title="Int" id="641532">startCol</a>  = <a href="#641509" title="GenMSIL.this.global.icodes.Instruction">instr</a>.<a href="../icode/Opcodes.scala.html#594690" title="=&gt; scala.tools.nsc.util.Position">pos</a>.<a href="../../util/Position.scala.html#501505" title="=&gt; scala.tools.nsc.util.Position">focusStart</a>.<a href="../../util/Position.scala.html#501515" title="=&gt; Int">column</a>
              <span class="keyword">val</span> <a title="Int" id="641533">endCol</a>    = <a href="#641509" title="GenMSIL.this.global.icodes.Instruction">instr</a>.<a href="../icode/Opcodes.scala.html#594690" title="=&gt; scala.tools.nsc.util.Position">pos</a>.<a href="../../util/Position.scala.html#501507" title="=&gt; scala.tools.nsc.util.Position">focusEnd</a>.<a href="../../util/Position.scala.html#501515" title="=&gt; Int">column</a>
              <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(startLine: Int, endLine: Int, startCol: Int, endCol: Int, filename: String)Unit">setPosition</span><span class="delimiter">(</span><a href="#641530" title="Int">startLine</a>, <a href="#641531" title="Int">endLine</a>, <a href="#641532" title="Int">startCol</a>, <a href="#641533" title="Int">endCol</a>, <a href="#641529" title="java.lang.String">fileName</a><span class="delimiter">)</span>
            <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
              <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(line: Int, filename: String)Unit">setPosition</span><span class="delimiter">(</span><a href="#641509" title="GenMSIL.this.global.icodes.Instruction">instr</a>.<a href="../icode/Opcodes.scala.html#594690" title="=&gt; scala.tools.nsc.util.Position">pos</a>.<a href="../../util/Position.scala.html#501514" title="=&gt; Int">line</a>, <a href="#641529" title="java.lang.String">fileName</a><span class="delimiter">)</span>
            <span class="delimiter">}</span>
            <a href="#641073" title="Int">lastLineNr</a> = <a href="#641510" title="Int">currentLineNr</a>
            <a href="#641074" title="GenMSIL.this.global.Position">lastPos</a> = <a href="#641509" title="GenMSIL.this.global.icodes.Instruction">instr</a>.<a href="../icode/Opcodes.scala.html#594690" title="=&gt; scala.tools.nsc.util.Position">pos</a>
          <span class="delimiter">}</span>
        <span class="delimiter">}</span> <span class="keyword">catch</span> <span class="delimiter">{</span> <span class="keyword">case</span> <span title="Unit">_</span>: <span title="UnsupportedOperationException">UnsupportedOperationException</span> =&gt; <span title="Unit" class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">}</span>

        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#641072" title="Boolean">previousWasNEW</a><span class="delimiter">)</span>
          <a href="../../../../Predef.scala.html#9566" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a><span class="delimiter">(</span><a href="#641509" title="GenMSIL.this.global.icodes.Instruction">instr</a>.<span title="[T0]=&gt; Boolean">isInstanceOf</span><span title="Boolean" class="delimiter">[</span><a href="../icode/Opcodes.scala.html#515009" title="GenMSIL.this.global.icodes.opcodes.DUP">DUP</a><span class="delimiter">]</span>, <a href="#640517" title="GenMSIL.this.global.icodes.BasicBlock">block</a><span class="delimiter">)</span>

        <a href="#641509" title="GenMSIL.this.global.icodes.Instruction">instr</a> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> <span title="Unit">THIS</span><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.global.Symbol" id="641549">clasz</a><span class="delimiter">)</span> =&gt;
            <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldarg_0</span><span class="delimiter">)</span>

          <span class="keyword">case</span> <span title="Unit">CONSTANT</span><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.global.Constant" id="641553">const</a><span class="delimiter">)</span> =&gt;
            <a href="#641553" title="GenMSIL.this.global.icodes.global.Constant">const</a>.<a href="../../../../reflect/generic/Constants.scala.html#434214" title="=&gt; Int">tag</a> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
              <span class="keyword">case</span> <span title="Unit">UnitTag</span>    =&gt; <span title="Unit" class="delimiter">(</span><span class="delimiter">)</span>
              <span class="keyword">case</span> <span title="Unit">BooleanTag</span> =&gt; <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCode" class="keyword">if</span> <span class="delimiter">(</span><a href="#641553" title="GenMSIL.this.global.icodes.global.Constant">const</a>.<a href="../../../../reflect/generic/Constants.scala.html#434226" title="=&gt; Boolean">booleanValue</a><span class="delimiter">)</span> <span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldc_I4_1</span>
                                            <span class="keyword">else</span> <span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldc_I4_0</span><span class="delimiter">)</span>
              <span class="keyword">case</span> <span title="Unit">ByteTag</span>    =&gt; <a href="#636742" title="(value: Int, code: ch.epfl.lamp.compiler.msil.emit.ILGenerator)Unit">loadI4</a><span class="delimiter">(</span><a href="#641553" title="GenMSIL.this.global.icodes.global.Constant">const</a>.<a href="../../../../Byte.scala.html#54432" title="=&gt; Int">byteValue</a>, <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a><span class="delimiter">)</span>
              <span class="keyword">case</span> <span title="Unit">ShortTag</span>   =&gt; <a href="#636742" title="(value: Int, code: ch.epfl.lamp.compiler.msil.emit.ILGenerator)Unit">loadI4</a><span class="delimiter">(</span><a href="#641553" title="GenMSIL.this.global.icodes.global.Constant">const</a>.<a href="../../../../Short.scala.html#54595" title="=&gt; Int">shortValue</a>, <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a><span class="delimiter">)</span>
              <span class="keyword">case</span> <span title="Unit">CharTag</span>    =&gt; <a href="#636742" title="(value: Int, code: ch.epfl.lamp.compiler.msil.emit.ILGenerator)Unit">loadI4</a><span class="delimiter">(</span><a href="#641553" title="GenMSIL.this.global.icodes.global.Constant">const</a>.<a href="../../../../Char.scala.html#54886" title="=&gt; Int">charValue</a>, <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a><span class="delimiter">)</span>
              <span class="keyword">case</span> <span title="Unit">IntTag</span>     =&gt; <a href="#636742" title="(value: Int, code: ch.epfl.lamp.compiler.msil.emit.ILGenerator)Unit">loadI4</a><span class="delimiter">(</span><a href="#641553" title="GenMSIL.this.global.icodes.global.Constant">const</a>.<a href="../../../../reflect/generic/Constants.scala.html#434230" title="=&gt; Int">intValue</a>, <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a><span class="delimiter">)</span>
              <span class="keyword">case</span> <span title="Unit">LongTag</span>    =&gt; <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: Long)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldc_I8</span>, <a href="#641553" title="GenMSIL.this.global.icodes.global.Constant">const</a>.<a href="../../../../reflect/generic/Constants.scala.html#434231" title="=&gt; Long">longValue</a><span class="delimiter">)</span>
              <span class="keyword">case</span> <span title="Unit">FloatTag</span>   =&gt; <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: Float)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldc_R4</span>, <a href="#641553" title="GenMSIL.this.global.icodes.global.Constant">const</a>.<a href="../../../../reflect/generic/Constants.scala.html#434232" title="=&gt; Float">floatValue</a><span class="delimiter">)</span>
              <span class="keyword">case</span> <span title="Unit">DoubleTag</span>  =&gt; <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: Double)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldc_R8</span>, <a href="#641553" title="GenMSIL.this.global.icodes.global.Constant">const</a>.<a href="../../../../reflect/generic/Constants.scala.html#434233" title="=&gt; Double">doubleValue</a><span class="delimiter">)</span>
              <span class="keyword">case</span> <span title="Unit">StringTag</span>  =&gt; <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: String)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldstr</span>, <a href="#641553" title="GenMSIL.this.global.icodes.global.Constant">const</a>.<a href="../../../../reflect/generic/Constants.scala.html#434235" title="=&gt; String">stringValue</a><span class="delimiter">)</span>
              <span class="keyword">case</span> <span title="Unit">NullTag</span>    =&gt; <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldnull</span><span class="delimiter">)</span>
              <span class="keyword">case</span> <span title="Unit">ClassTag</span>   =&gt;
                <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.Type)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldtoken</span>, <a href="#636763" title="(tpe: GenMSIL.this.global.Type)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">(</span><a href="#641553" title="GenMSIL.this.global.icodes.global.Constant">const</a>.<a href="../../../../reflect/generic/Constants.scala.html#434238" title="=&gt; GenMSIL.this.global.icodes.global.Type">typeValue</a><span class="delimiter">)</span><span class="delimiter">)</span>
                <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Call</span>, <a href="#636628" title="=&gt; ch.epfl.lamp.compiler.msil.MethodInfo">TYPE_FROM_HANDLE</a><span class="delimiter">)</span>
              <span class="keyword">case</span> <span title="Nothing">_</span>          =&gt; <a href="../../symtab/SymbolTable.scala.html#478159" title="(msg: String)Nothing">abort</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Unknown constant value: &quot;)" class="string">&quot;Unknown constant value: &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#641553" title="GenMSIL.this.global.icodes.global.Constant">const</a><span class="delimiter">)</span>
            <span class="delimiter">}</span>

          <span class="keyword">case</span> <span title="Unit">LOAD_ARRAY_ITEM</span><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.TypeKind" id="641591">kind</a><span class="delimiter">)</span> =&gt;
            <span class="delimiter">(</span><a href="#641591" title="GenMSIL.this.global.icodes.TypeKind">kind</a>: @<a href="../icode/TypeKinds.scala.html#501291" title="GenMSIL.this.global.icodes.TypeKind @unchecked">unchecked</a><span class="delimiter">)</span> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
              <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#501299" title="Unit">BOOL</a>           =&gt; <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldelem_I1</span><span class="delimiter">)</span>
              <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#501301" title="Unit">BYTE</a>           =&gt; <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldelem_I1</span><span class="delimiter">)</span> <span class="comment">// I1 for System.SByte, i.e. a scala.Byte</span>
              <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#501303" title="Unit">SHORT</a>          =&gt; <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldelem_I2</span><span class="delimiter">)</span>
              <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#501305" title="Unit">CHAR</a>           =&gt; <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldelem_U2</span><span class="delimiter">)</span>
              <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#501307" title="Unit">INT</a>            =&gt; <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldelem_I4</span><span class="delimiter">)</span>
              <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#501309" title="Unit">LONG</a>           =&gt; <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldelem_I8</span><span class="delimiter">)</span>
              <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#501311" title="Unit">FLOAT</a>          =&gt; <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldelem_R4</span><span class="delimiter">)</span>
              <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#501313" title="Unit">DOUBLE</a>         =&gt; <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldelem_R8</span><span class="delimiter">)</span>
              <span class="keyword">case</span> <span title="Unit">REFERENCE</span><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.global.Symbol" id="641609">cls</a><span class="delimiter">)</span> =&gt; <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldelem_Ref</span><span class="delimiter">)</span>
              <span class="keyword">case</span> <span title="Unit">ARRAY</span><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.TypeKind" id="641613">elem</a><span class="delimiter">)</span>    =&gt; <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldelem_Ref</span><span class="delimiter">)</span>

              <span class="comment">// case UNIT is not possible: an Array[Unit] will be an</span>
              <span class="comment">//  Array[scala.runtime.BoxedUnit] (-&gt; case REFERENCE)</span>
            <span class="delimiter">}</span>

          <span class="keyword">case</span> <span title="Unit">LOAD_LOCAL</span><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.Local" id="641617">local</a><span class="delimiter">)</span> =&gt; <a href="#641070" title="(local: GenMSIL.this.global.icodes.Local, msg: String, loadAddr: Boolean)Unit">loadLocalOrAddress</a><span class="delimiter">(</span><a href="#641617" title="GenMSIL.this.global.icodes.Local">local</a>, <span title="java.lang.String(&quot;load_local&quot;)" class="string">&quot;load_local&quot;</span>, <span title="Boolean(false)" class="keyword">false</span><span class="delimiter">)</span>

          <span class="keyword">case</span> <span title="Unit">CIL_LOAD_LOCAL_ADDRESS</span><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.Local" id="641619">local</a><span class="delimiter">)</span> =&gt; <a href="#641070" title="(local: GenMSIL.this.global.icodes.Local, msg: String, loadAddr: Boolean)Unit">loadLocalOrAddress</a><span class="delimiter">(</span><a href="#641619" title="GenMSIL.this.global.icodes.Local">local</a>, <span title="java.lang.String(&quot;cil_load_local_address&quot;)" class="string">&quot;cil_load_local_address&quot;</span>, <span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span>

          <span class="keyword">case</span> <span title="Unit">LOAD_FIELD</span><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.global.Symbol" id="641622">field</a>, <a title="Boolean" id="641623">isStatic</a><span class="delimiter">)</span> =&gt; <a href="#641071" title="(field: GenMSIL.this.global.Symbol, isStatic: Boolean, msg: String, loadAddr: Boolean)Unit">loadFieldOrAddress</a><span class="delimiter">(</span><a href="#641622" title="GenMSIL.this.global.icodes.global.Symbol">field</a>, <a href="#641623" title="Boolean">isStatic</a>, <span title="java.lang.String(&quot;load_field&quot;)" class="string">&quot;load_field&quot;</span>, <span title="Boolean(false)" class="keyword">false</span><span class="delimiter">)</span>

          <span class="keyword">case</span> <span title="Unit">CIL_LOAD_FIELD_ADDRESS</span><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.global.Symbol" id="641626">field</a>, <a title="Boolean" id="641627">isStatic</a><span class="delimiter">)</span> =&gt; <a href="#641071" title="(field: GenMSIL.this.global.Symbol, isStatic: Boolean, msg: String, loadAddr: Boolean)Unit">loadFieldOrAddress</a><span class="delimiter">(</span><a href="#641626" title="GenMSIL.this.global.icodes.global.Symbol">field</a>, <a href="#641627" title="Boolean">isStatic</a>, <span title="java.lang.String(&quot;cil_load_field_address&quot;)" class="string">&quot;cil_load_field_address&quot;</span>, <span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span>

          <span class="keyword">case</span> <span title="Unit">CIL_LOAD_ARRAY_ITEM_ADDRESS</span><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.TypeKind" id="641629">kind</a><span class="delimiter">)</span> =&gt; <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.Type)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldelema</span>, <a href="#636762" title="(t: GenMSIL.this.global.icodes.TypeKind)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">(</span><a href="#641629" title="GenMSIL.this.global.icodes.TypeKind">kind</a><span class="delimiter">)</span><span class="delimiter">)</span>

          <span class="keyword">case</span> <span title="Unit">CIL_NEWOBJ</span><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.global.Symbol" id="641641">msym</a><span class="delimiter">)</span> =&gt;
            <a href="../../../../Predef.scala.html#9565" title="(assertion: Boolean)Unit">assert</a><span class="delimiter">(</span><a href="#641641" title="GenMSIL.this.global.icodes.global.Symbol">msym</a>.<a href="../../symtab/Symbols.scala.html#509178" title="=&gt; Boolean">isClassConstructor</a><span class="delimiter">)</span>
            <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.ConstructorInfo" id="641642">constructorInfo</a>: <span title="ch.epfl.lamp.compiler.msil.ConstructorInfo">ConstructorInfo</span> = <a href="#636790" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.ConstructorInfo">getConstructor</a><span class="delimiter">(</span><a href="#641641" title="GenMSIL.this.global.icodes.global.Symbol">msym</a><span class="delimiter">)</span>
            <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.ConstructorInfo)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Newobj</span>, <a href="#641642" title="ch.epfl.lamp.compiler.msil.ConstructorInfo">constructorInfo</a><span class="delimiter">)</span>

          <span class="keyword">case</span> <span title="Unit">LOAD_MODULE</span><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.global.Symbol" id="641652">module</a><span class="delimiter">)</span> =&gt;
            <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../Global.scala.html#478200" title="=&gt; scala.tools.nsc.Settings">settings</a>.<a href="../../settings/ScalaSettings.scala.html#469727" title="=&gt; scala.tools.nsc.Settings#BooleanSetting">debug</a>.<a href="../../settings/MutableSettings.scala.html#470030" title="=&gt; Boolean">value</a><span class="delimiter">)</span>
              <a href="../../Global.scala.html#478254" title="(msg: =&gt; AnyRef)Unit">log</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Generating LOAD_MODULE for: &quot;)" class="string">&quot;Generating LOAD_MODULE for: &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#636799" title="(sym: GenMSIL.this.global.Symbol)String">showsym</a><span class="delimiter">(</span><a href="#641652" title="GenMSIL.this.global.icodes.global.Symbol">module</a><span class="delimiter">)</span><span class="delimiter">)</span>
            <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.FieldInfo)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldsfld</span>, <a href="#636775" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.FieldInfo">getModuleInstanceField</a><span class="delimiter">(</span><a href="#641652" title="GenMSIL.this.global.icodes.global.Symbol">module</a><span class="delimiter">)</span><span class="delimiter">)</span>

          <span class="keyword">case</span> <span title="Unit">STORE_ARRAY_ITEM</span><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.TypeKind" id="641661">kind</a><span class="delimiter">)</span> =&gt;
            <span class="delimiter">(</span><a href="#641661" title="GenMSIL.this.global.icodes.TypeKind">kind</a>: @<a href="../icode/TypeKinds.scala.html#501291" title="GenMSIL.this.global.icodes.TypeKind @unchecked">unchecked</a><span class="delimiter">)</span> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
              <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#501299" title="Unit">BOOL</a>           =&gt; <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Stelem_I1</span><span class="delimiter">)</span>
              <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#501301" title="Unit">BYTE</a>           =&gt; <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Stelem_I1</span><span class="delimiter">)</span>
              <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#501303" title="Unit">SHORT</a>          =&gt; <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Stelem_I2</span><span class="delimiter">)</span>
              <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#501305" title="Unit">CHAR</a>           =&gt; <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Stelem_I2</span><span class="delimiter">)</span>
              <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#501307" title="Unit">INT</a>            =&gt; <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Stelem_I4</span><span class="delimiter">)</span>
              <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#501309" title="Unit">LONG</a>           =&gt; <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Stelem_I8</span><span class="delimiter">)</span>
              <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#501311" title="Unit">FLOAT</a>          =&gt; <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Stelem_R4</span><span class="delimiter">)</span>
              <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#501313" title="Unit">DOUBLE</a>         =&gt; <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Stelem_R8</span><span class="delimiter">)</span>
              <span class="keyword">case</span> <span title="Unit">REFERENCE</span><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.global.Symbol" id="641679">cls</a><span class="delimiter">)</span> =&gt; <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Stelem_Ref</span><span class="delimiter">)</span>
              <span class="keyword">case</span> <span title="Unit">ARRAY</span><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.TypeKind" id="641683">elem</a><span class="delimiter">)</span>    =&gt; <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Stelem_Ref</span><span class="delimiter">)</span> <span class="comment">// @TODO: test this! (occurs when calling a Array[Object]* vararg param method)</span>

              <span class="comment">// case UNIT not possible (see comment at LOAD_ARRAY_ITEM)</span>
            <span class="delimiter">}</span>

          <span class="keyword">case</span> <span title="Unit">STORE_LOCAL</span><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.Local" id="641687">local</a><span class="delimiter">)</span> =&gt;
            <span class="keyword">val</span> <a title="Boolean" id="641688">isArg</a> = <a href="#641687" title="GenMSIL.this.global.icodes.Local">local</a>.<a href="../icode/Members.scala.html#594663" title="=&gt; Boolean">arg</a>
            <span class="keyword">val</span> <a title="Int" id="641689">i</a> = <a href="#641687" title="GenMSIL.this.global.icodes.Local">local</a>.<a href="../icode/Members.scala.html#594666" title="=&gt; Int">index</a>
            <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../Global.scala.html#478200" title="=&gt; scala.tools.nsc.Settings">settings</a>.<a href="../../settings/ScalaSettings.scala.html#469727" title="=&gt; scala.tools.nsc.Settings#BooleanSetting">debug</a>.<a href="../../settings/MutableSettings.scala.html#470030" title="=&gt; Boolean">value</a><span class="delimiter">)</span>
              <a href="../../Global.scala.html#478254" title="(msg: =&gt; AnyRef)Unit">log</a><span class="delimiter">(</span><span title="java.lang.String(&quot;store_local for &quot;)" class="string">&quot;store_local for &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#641687" title="GenMSIL.this.global.icodes.Local">local</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;, index &quot;)" class="string">&quot;, index &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#641689" title="Int">i</a><span class="delimiter">)</span>

            <span class="comment">// there are some locals defined by the compiler that</span>
            <span class="comment">// are isArg and are need to be stored.</span>
            <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#641688" title="Boolean">isArg</a><span class="delimiter">)</span> <span class="delimiter">{</span>
              <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#641689" title="Int">i</a> <a href="../../../../Int.scala.html#54782" title="(x: Int)Boolean">&gt;=</a> -<span title="Int(-128)" class="int">128</span> <a href="../../../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#641689" title="Int">i</a> <a href="../../../../Int.scala.html#54768" title="(x: Int)Boolean">&lt;=</a> <span title="Int(127)" class="int">127</span><span class="delimiter">)</span>
                <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: Int)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Starg_S</span>, <a href="#641689" title="Int">i</a><span class="delimiter">)</span>
              <span class="keyword">else</span>
                <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: Int)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Starg</span>, <a href="#641689" title="Int">i</a><span class="delimiter">)</span>
            <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
              <a href="#641689" title="Int">i</a> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
                <span class="keyword">case</span> <span title="Unit" class="int">0</span> =&gt; <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Stloc_0</span><span class="delimiter">)</span>
                <span class="keyword">case</span> <span title="Unit" class="int">1</span> =&gt; <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Stloc_1</span><span class="delimiter">)</span>
                <span class="keyword">case</span> <span title="Unit" class="int">2</span> =&gt; <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Stloc_2</span><span class="delimiter">)</span>
                <span class="keyword">case</span> <span title="Unit" class="int">3</span> =&gt; <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Stloc_3</span><span class="delimiter">)</span>
                <span class="keyword">case</span> <span title="Unit">_</span>      =&gt;
                  <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#641689" title="Int">i</a> <a href="../../../../Int.scala.html#54782" title="(x: Int)Boolean">&gt;=</a> -<span title="Int(-128)" class="int">128</span> <a href="../../../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#641689" title="Int">i</a> <a href="../../../../Int.scala.html#54768" title="(x: Int)Boolean">&lt;=</a> <span title="Int(127)" class="int">127</span><span class="delimiter">)</span>
                    <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.emit.LocalBuilder)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Stloc_S</span>, <a href="../../../../collection/MapLike.scala.html#73204" title="(key: GenMSIL.this.global.icodes.Local)ch.epfl.lamp.compiler.msil.emit.LocalBuilder">localBuilders</a><span class="delimiter">(</span><a href="#641687" title="GenMSIL.this.global.icodes.Local">local</a><span class="delimiter">)</span><span class="delimiter">)</span>
                  <span class="keyword">else</span>
                    <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.emit.LocalBuilder)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Stloc</span>, <a href="../../../../collection/MapLike.scala.html#73204" title="(key: GenMSIL.this.global.icodes.Local)ch.epfl.lamp.compiler.msil.emit.LocalBuilder">localBuilders</a><span class="delimiter">(</span><a href="#641687" title="GenMSIL.this.global.icodes.Local">local</a><span class="delimiter">)</span><span class="delimiter">)</span>
              <span class="delimiter">}</span>
            <span class="delimiter">}</span>

          <span class="keyword">case</span> <span title="Unit">STORE_THIS</span><span class="delimiter">(</span>_<span class="delimiter">)</span> =&gt;
            <span class="comment">// this only works for impl classes because the self parameter comes first</span>
            <span class="comment">// in the method signature. If that changes, this code has to be revisited.</span>
            <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: Int)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Starg_S</span>, <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>

          <span class="keyword">case</span> <span title="Unit">STORE_FIELD</span><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.global.Symbol" id="641770">field</a>, <a title="Boolean" id="641771">isStatic</a><span class="delimiter">)</span> =&gt;
            <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.FieldInfo" id="641772">fieldInfo</a> = <a href="../../symtab/clr/CLRTypes.scala.html#601643" title="=&gt; scala.collection.mutable.Map[GenMSIL.this.global.loaders.clrTypes.global.Symbol,ch.epfl.lamp.compiler.msil.FieldInfo]">fields</a>.<a href="../../../../collection/MapLike.scala.html#73194" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol)Option[ch.epfl.lamp.compiler.msil.FieldInfo]">get</a><span class="delimiter">(</span><a href="#641770" title="GenMSIL.this.global.icodes.global.Symbol">field</a><span class="delimiter">)</span> <span title="ch.epfl.lamp.compiler.msil.FieldInfo" class="keyword">match</span> <span class="delimiter">{</span>
              <span class="keyword">case</span> <span title="ch.epfl.lamp.compiler.msil.FieldInfo">Some</span><span class="delimiter">(</span><a title="ch.epfl.lamp.compiler.msil.FieldInfo" id="641776">fInfo</a><span class="delimiter">)</span> =&gt; <a href="#641776" title="ch.epfl.lamp.compiler.msil.FieldInfo">fInfo</a>
              <span class="keyword">case</span> <a href="../../../../Option.scala.html#1737" title="ch.epfl.lamp.compiler.msil.FieldInfo">None</a> =&gt;
                <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.FieldInfo" id="641777">fInfo</a> = <a href="#636765" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.Type">getType</a><span class="delimiter">(</span><a href="#641770" title="GenMSIL.this.global.icodes.global.Symbol">field</a>.<a href="../../symtab/Symbols.scala.html#509249" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">owner</a><span class="delimiter">)</span>.<span title="(x$1: java.lang.String)ch.epfl.lamp.compiler.msil.FieldInfo">GetField</span><span class="delimiter">(</span><a href="#636750" title="(sym: GenMSIL.this.global.Symbol)String">msilName</a><span class="delimiter">(</span><a href="#641770" title="GenMSIL.this.global.icodes.global.Symbol">field</a><span class="delimiter">)</span><span class="delimiter">)</span>
                <a href="../../../../collection/mutable/MapLike.scala.html#73272" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol, value: ch.epfl.lamp.compiler.msil.FieldInfo)Unit">fields</a><span class="delimiter">(</span><a href="#641770" title="GenMSIL.this.global.icodes.global.Symbol">field</a><span class="delimiter">)</span> = <a href="#641777" title="ch.epfl.lamp.compiler.msil.FieldInfo">fInfo</a>
                <a href="#641777" title="ch.epfl.lamp.compiler.msil.FieldInfo">fInfo</a>
            <span class="delimiter">}</span>
            <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.FieldInfo)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCode" class="keyword">if</span> <span class="delimiter">(</span><a href="#641771" title="Boolean">isStatic</a><span class="delimiter">)</span> <span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Stsfld</span> <span class="keyword">else</span> <span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Stfld</span>, <a href="#641772" title="ch.epfl.lamp.compiler.msil.FieldInfo">fieldInfo</a><span class="delimiter">)</span>

          <span class="keyword">case</span> <span title="Unit">CALL_PRIMITIVE</span><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.Primitive" id="641785">primitive</a><span class="delimiter">)</span> =&gt;
            <a href="#636741" title="(primitive: GenMSIL.this.global.icodes.Primitive, pos: GenMSIL.this.global.Position)Unit">genPrimitive</a><span class="delimiter">(</span><a href="#641785" title="GenMSIL.this.global.icodes.Primitive">primitive</a>, <a href="#641509" title="GenMSIL.this.global.icodes.Instruction">instr</a>.<a href="../icode/Opcodes.scala.html#594690" title="=&gt; scala.tools.nsc.util.Position">pos</a><span class="delimiter">)</span>

          <span class="keyword">case</span> <span title="Unit">CALL_METHOD</span><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.global.Symbol" id="641791">msym</a>, <a title="GenMSIL.this.global.icodes.opcodes.InvokeStyle" id="641792">style</a><span class="delimiter">)</span> =&gt;
            <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#641791" title="GenMSIL.this.global.icodes.global.Symbol">msym</a>.<a href="../../symtab/Symbols.scala.html#509178" title="=&gt; Boolean">isClassConstructor</a><span class="delimiter">)</span> <span class="delimiter">{</span>
              <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.ConstructorInfo" id="641793">constructorInfo</a>: <span title="ch.epfl.lamp.compiler.msil.ConstructorInfo">ConstructorInfo</span> = <a href="#636790" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.ConstructorInfo">getConstructor</a><span class="delimiter">(</span><a href="#641791" title="GenMSIL.this.global.icodes.global.Symbol">msym</a><span class="delimiter">)</span>
              <span class="delimiter">(</span><a href="#641792" title="GenMSIL.this.global.icodes.opcodes.InvokeStyle">style</a>: @<a href="../icode/Opcodes.scala.html#515027" title="GenMSIL.this.global.icodes.opcodes.InvokeStyle @unchecked">unchecked</a><span class="delimiter">)</span> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
                <span class="comment">// normal constructor calls are Static..</span>
                <span class="keyword">case</span> <span title="Unit">Static</span><span class="delimiter">(</span>_<span class="delimiter">)</span> =&gt;
                  <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#636671" title="=&gt; GenMSIL.this.global.icodes.IMethod">method</a>.<a href="../icode/Members.scala.html#594468" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a>.<a href="../../symtab/Symbols.scala.html#509178" title="=&gt; Boolean">isClassConstructor</a> <a href="../../../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#636671" title="=&gt; GenMSIL.this.global.icodes.IMethod">method</a>.<a href="../icode/Members.scala.html#594468" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a>.<a href="../../symtab/Symbols.scala.html#509249" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">owner</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#641791" title="GenMSIL.this.global.icodes.global.Symbol">msym</a>.<a href="../../symtab/Symbols.scala.html#509249" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">owner</a><span class="delimiter">)</span>
                    <span class="comment">// we're generating a constructor (method: IMethod is a constructor), and we're</span>
                    <span class="comment">// calling another constructor of the same class.</span>

                    <span class="comment">// @LUC TODO: this can probably break, namely when having: class A { def this() { new A() } }</span>
                    <span class="comment">// instead, we should instruct the CALL_METHOD with additional information, know whether it's</span>
                    <span class="comment">// an instance creation constructor call or not.</span>
                    <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.ConstructorInfo)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Call</span>, <a href="#641793" title="ch.epfl.lamp.compiler.msil.ConstructorInfo">constructorInfo</a><span class="delimiter">)</span>
                  <span class="keyword">else</span>
                    <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.ConstructorInfo)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Newobj</span>, <a href="#641793" title="ch.epfl.lamp.compiler.msil.ConstructorInfo">constructorInfo</a><span class="delimiter">)</span>
                <span class="keyword">case</span> <span title="Unit">SuperCall</span><span class="delimiter">(</span>_<span class="delimiter">)</span> =&gt;
                  <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.ConstructorInfo)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Call</span>, <a href="#641793" title="ch.epfl.lamp.compiler.msil.ConstructorInfo">constructorInfo</a><span class="delimiter">)</span>
                  <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#636772" title="(sym: GenMSIL.this.global.Symbol)Boolean">isStaticModule</a><span class="delimiter">(</span><a href="#636668" title="=&gt; GenMSIL.this.global.icodes.IClass">clasz</a>.<a href="../icode/Members.scala.html#501663" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a><span class="delimiter">)</span> <a href="../../../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a>
                      <a href="#636757" title="=&gt; scala.collection.mutable.HashSet[GenMSIL.this.global.Symbol]">notInitializedModules</a>.<a href="../../../../collection/mutable/HashSet.scala.html#108314" title="(elem: GenMSIL.this.global.Symbol)Boolean">contains</a><span class="delimiter">(</span><a href="#636668" title="=&gt; GenMSIL.this.global.icodes.IClass">clasz</a>.<a href="../icode/Members.scala.html#501663" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a><span class="delimiter">)</span> <a href="../../../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a>
                      <a href="#636671" title="=&gt; GenMSIL.this.global.icodes.IMethod">method</a>.<a href="../icode/Members.scala.html#594468" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a>.<a href="../../symtab/Symbols.scala.html#509178" title="=&gt; Boolean">isClassConstructor</a><span class="delimiter">)</span>
                    <span class="delimiter">{</span>
                      <a href="#636757" title="=&gt; scala.collection.mutable.HashSet[GenMSIL.this.global.Symbol]">notInitializedModules</a> <a href="../../../../collection/mutable/HashSet.scala.html#108316" title="(elem: GenMSIL.this.global.Symbol)BytecodeGenerator.this.notInitializedModules.type">-=</a> <a href="#636668" title="=&gt; GenMSIL.this.global.icodes.IClass">clasz</a>.<a href="../icode/Members.scala.html#501663" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a>
                      <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldarg_0</span><span class="delimiter">)</span>
                      <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.FieldInfo)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Stsfld</span>, <a href="#636775" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.FieldInfo">getModuleInstanceField</a><span class="delimiter">(</span><a href="#636668" title="=&gt; GenMSIL.this.global.icodes.IClass">clasz</a>.<a href="../icode/Members.scala.html#501663" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a><span class="delimiter">)</span><span class="delimiter">)</span>
                    <span class="delimiter">}</span>
              <span class="delimiter">}</span>

            <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>

              <span class="keyword">var</span> <a title="Boolean" id="641839">doEmit</a> = <span title="Boolean(true)" class="keyword">true</span>
              <a href="#636766" title="(sym: GenMSIL.this.global.Symbol)Option[ch.epfl.lamp.compiler.msil.Type]">getTypeOpt</a><span class="delimiter">(</span><a href="#641791" title="GenMSIL.this.global.icodes.global.Symbol">msym</a>.<a href="../../symtab/Symbols.scala.html#509249" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">owner</a><span class="delimiter">)</span> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
                <span class="keyword">case</span> <span title="Unit">Some</span><span class="delimiter">(</span><a title="ch.epfl.lamp.compiler.msil.Type" id="641845">typ</a><span class="delimiter">)</span> <span class="keyword">if</span> <span class="delimiter">(</span><a href="#641845" title="ch.epfl.lamp.compiler.msil.Type">typ</a>.<span title="()Boolean">IsEnum</span><span class="delimiter">)</span> =&gt; <span class="delimiter">{</span>
                  <span class="keyword">def</span> <a title="()Unit" id="641846">negBool</a><span class="delimiter">(</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
                    <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldc_I4_0</span><span class="delimiter">)</span>
                    <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ceq</span><span class="delimiter">)</span>
                  <span class="delimiter">}</span>
                  <a href="#641839" title="Boolean">doEmit</a> = <span title="Boolean(false)" class="keyword">false</span>
                  <span class="keyword">val</span> <a title="GenMSIL.this.global.icodes.global.Name" id="641847">name</a> = <a href="#641791" title="GenMSIL.this.global.icodes.global.Symbol">msym</a>.<a href="../../symtab/Symbols.scala.html#509256" title="=&gt; GenMSIL.this.global.icodes.global.Name">name</a>
                  <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#641847" title="GenMSIL.this.global.icodes.global.Name">name</a> <span title="(x$1: AnyRef)Boolean">eq</span> <a href="../../symtab/StdNames.scala.html#479055" title="object GenMSIL.this.global.nme">nme</a>.<a href="../../symtab/StdNames.scala.html#516806" title="=&gt; GenMSIL.this.global.TermName">EQ</a><span class="delimiter">)</span>       <span class="delimiter">{</span> <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ceq</span><span class="delimiter">)</span> <span class="delimiter">}</span>
                  <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#641847" title="GenMSIL.this.global.icodes.global.Name">name</a> <span title="(x$1: AnyRef)Boolean">eq</span> <a href="../../symtab/StdNames.scala.html#479055" title="object GenMSIL.this.global.nme">nme</a>.<a href="../../symtab/StdNames.scala.html#516830" title="=&gt; GenMSIL.this.global.TermName">NE</a><span class="delimiter">)</span>  <span class="delimiter">{</span> <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ceq</span><span class="delimiter">)</span>; <a href="#641846" title="()Unit">negBool</a> <span class="delimiter">}</span>
                  <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#641847" title="GenMSIL.this.global.icodes.global.Name">name</a> <span title="(x$1: AnyRef)Boolean">eq</span> <a href="../../symtab/StdNames.scala.html#479055" title="object GenMSIL.this.global.nme">nme</a>.<a href="../../symtab/StdNames.scala.html#516822" title="=&gt; GenMSIL.this.global.TermName">LT</a><span class="delimiter">)</span>  <span class="delimiter">{</span> <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Clt</span><span class="delimiter">)</span> <span class="delimiter">}</span>
                  <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#641847" title="GenMSIL.this.global.icodes.global.Name">name</a> <span title="(x$1: AnyRef)Boolean">eq</span> <a href="../../symtab/StdNames.scala.html#479055" title="object GenMSIL.this.global.nme">nme</a>.<a href="../../symtab/StdNames.scala.html#516816" title="=&gt; GenMSIL.this.global.TermName">LE</a><span class="delimiter">)</span>  <span class="delimiter">{</span> <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Cgt</span><span class="delimiter">)</span>; <a href="#641846" title="()Unit">negBool</a> <span class="delimiter">}</span>
                  <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#641847" title="GenMSIL.this.global.icodes.global.Name">name</a> <span title="(x$1: AnyRef)Boolean">eq</span> <a href="../../symtab/StdNames.scala.html#479055" title="object GenMSIL.this.global.nme">nme</a>.<a href="../../symtab/StdNames.scala.html#516812" title="=&gt; GenMSIL.this.global.TermName">GT</a><span class="delimiter">)</span>  <span class="delimiter">{</span> <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Cgt</span><span class="delimiter">)</span> <span class="delimiter">}</span>
                  <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#641847" title="GenMSIL.this.global.icodes.global.Name">name</a> <span title="(x$1: AnyRef)Boolean">eq</span> <a href="../../symtab/StdNames.scala.html#479055" title="object GenMSIL.this.global.nme">nme</a>.<a href="../../symtab/StdNames.scala.html#516810" title="=&gt; GenMSIL.this.global.TermName">GE</a><span class="delimiter">)</span>  <span class="delimiter">{</span> <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Clt</span><span class="delimiter">)</span>; <a href="#641846" title="()Unit">negBool</a> <span class="delimiter">}</span>
                  <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#641847" title="GenMSIL.this.global.icodes.global.Name">name</a> <span title="(x$1: AnyRef)Boolean">eq</span> <a href="../../symtab/StdNames.scala.html#479055" title="object GenMSIL.this.global.nme">nme</a>.<a href="../../symtab/StdNames.scala.html#516832" title="=&gt; GenMSIL.this.global.TermName">OR</a><span class="delimiter">)</span>  <span class="delimiter">{</span> <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Or</span><span class="delimiter">)</span> <span class="delimiter">}</span>
                  <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#641847" title="GenMSIL.this.global.icodes.global.Name">name</a> <span title="(x$1: AnyRef)Boolean">eq</span> <a href="../../symtab/StdNames.scala.html#479055" title="object GenMSIL.this.global.nme">nme</a>.<a href="../../symtab/StdNames.scala.html#516800" title="=&gt; GenMSIL.this.global.TermName">AND</a><span class="delimiter">)</span> <span class="delimiter">{</span> <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">And</span><span class="delimiter">)</span> <span class="delimiter">}</span>
                  <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#641847" title="GenMSIL.this.global.icodes.global.Name">name</a> <span title="(x$1: AnyRef)Boolean">eq</span> <a href="../../symtab/StdNames.scala.html#479055" title="object GenMSIL.this.global.nme">nme</a>.<a href="../../symtab/StdNames.scala.html#516838" title="=&gt; GenMSIL.this.global.TermName">XOR</a><span class="delimiter">)</span> <span class="delimiter">{</span> <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Xor</span><span class="delimiter">)</span> <span class="delimiter">}</span>
                  <span class="keyword">else</span>
                    <a href="#641839" title="Boolean">doEmit</a> = <span title="Boolean(true)" class="keyword">true</span>
                <span class="delimiter">}</span>
                <span class="keyword">case</span> <span title="Unit">_</span> =&gt; <span title="Unit" class="delimiter">(</span><span class="delimiter">)</span>
              <span class="delimiter">}</span>

              <span class="comment">// method: implicit view(FunctionX[PType0, PType1, ...,PTypeN, ResType]):DelegateType</span>
              <span class="keyword">val</span> <a href="../../../../Tuple3.scala.html#53296" title="(Boolean, GenMSIL.this.global.Type, GenMSIL.this.global.Type)" class="delimiter">(</a><a href="../../../../Tuple3.scala.html#53312" title="Boolean" id="641841">isDelegateView</a>, <a href="../../../../Tuple3.scala.html#53314" title="GenMSIL.this.global.Type" id="641842">paramType</a>, <a href="../../../../Tuple3.scala.html#53316" title="GenMSIL.this.global.Type" id="641843">resType</a><span class="delimiter">)</span> = <a href="../../symtab/SymbolTable.scala.html#478184" title="(ph: scala.tools.nsc.Phase)(op: =&gt; (Boolean, GenMSIL.this.global.Type, GenMSIL.this.global.Type))(Boolean, GenMSIL.this.global.Type, GenMSIL.this.global.Type)">atPhase</a><span class="delimiter">(</span><a href="../../Global.scala.html#478362" title="=&gt; GenMSIL.this.global.Run">currentRun</a>.<a href="../../Global.scala.html#482526" title="=&gt; scala.tools.nsc.Phase">typerPhase</a><span class="delimiter">)</span> <a href="../../../../Tuple3.scala.html#317" title="(Boolean, GenMSIL.this.global.Type, GenMSIL.this.global.Type) @unchecked" class="delimiter">{</a>
                <a href="#641791" title="GenMSIL.this.global.icodes.global.Symbol">msym</a>.<a href="../../symtab/Symbols.scala.html#509270" title="=&gt; GenMSIL.this.global.icodes.global.Type">tpe</a> <span title="(Boolean, GenMSIL.this.global.Type, GenMSIL.this.global.Type)" class="keyword">match</span> <span class="delimiter">{</span>
                  <span class="keyword">case</span> <span title="(Boolean, GenMSIL.this.global.Type, GenMSIL.this.global.Type)">MethodType</span><span class="delimiter">(</span><a title="List[GenMSIL.this.global.Symbol]" id="641876">params</a>, <a title="GenMSIL.this.global.Type" id="641877">resultType</a><span class="delimiter">)</span>
                  <span class="keyword">if</span> <span class="delimiter">(</span><a href="#641876" title="List[GenMSIL.this.global.Symbol]">params</a>.<a href="../../../../collection/LinearSeqOptimized.scala.html#71030" title="=&gt; Int">length</a> <a href="../../../../Int.scala.html#54747" title="(x: Int)Boolean">==</a> <span title="Int(1)" class="int">1</span> <a href="../../../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#641791" title="GenMSIL.this.global.icodes.global.Symbol">msym</a>.<a href="../../symtab/Symbols.scala.html#509256" title="=&gt; GenMSIL.this.global.icodes.global.Name">name</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../symtab/StdNames.scala.html#479055" title="object GenMSIL.this.global.nme">nme</a>.<a href="../../symtab/StdNames.scala.html#516734" title="=&gt; GenMSIL.this.global.nme.NameType">view_</a><span class="delimiter">)</span> =&gt;
                    <span class="keyword">val</span> <a title="GenMSIL.this.global.Type" id="641888">paramType</a> = <a href="../../../../collection/LinearSeqOptimized.scala.html#71031" title="(n: Int)GenMSIL.this.global.Symbol">params</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>.<a href="../../symtab/Symbols.scala.html#509270" title="=&gt; GenMSIL.this.global.Type">tpe</a>
                    <span class="keyword">val</span> <a title="Boolean" id="641889">isDel</a> = <a href="../../symtab/Definitions.scala.html#479030" title="object GenMSIL.this.global.definitions">definitions</a>.<a href="../../symtab/Definitions.scala.html#508216" title="(delegateType: GenMSIL.this.global.Type, functionType: GenMSIL.this.global.Type)Boolean">isCorrespondingDelegate</a><span class="delimiter">(</span><a href="#641877" title="GenMSIL.this.global.Type">resultType</a>, <a href="#641888" title="GenMSIL.this.global.Type">paramType</a><span class="delimiter">)</span>
                    <a href="../../../../Tuple3.scala.html#53296" title="(_1: Boolean, _2: GenMSIL.this.global.Type, _3: GenMSIL.this.global.Type)(Boolean, GenMSIL.this.global.Type, GenMSIL.this.global.Type)" class="delimiter">(</a><a href="#641889" title="Boolean">isDel</a>, <a href="#641888" title="GenMSIL.this.global.Type">paramType</a>, <a href="#641877" title="GenMSIL.this.global.Type">resultType</a><span class="delimiter">)</span>
                  <span class="keyword">case</span> <span title="(Boolean, Null, Null)">_</span> =&gt; <a href="../../../../Tuple3.scala.html#53296" title="(_1: Boolean, _2: Null, _3: Null)(Boolean, Null, Null)" class="delimiter">(</a><span title="Boolean(false)" class="keyword">false</span>, <span title="Null(null)" class="keyword">null</span>, <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span>
                <span class="delimiter">}</span>
              <span class="delimiter">}</span>
              <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#641839" title="Boolean">doEmit</a> <a href="../../../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#641841" title="Boolean">isDelegateView</a><span class="delimiter">)</span> <span class="delimiter">{</span>
                <a href="#641839" title="Boolean">doEmit</a> = <span title="Boolean(false)" class="keyword">false</span>
                <a href="#636787" title="(functionType: GenMSIL.this.global.Type, delegateType: GenMSIL.this.global.Type)Unit">createDelegateCaller</a><span class="delimiter">(</span><a href="#641842" title="GenMSIL.this.global.Type">paramType</a>, <a href="#641843" title="GenMSIL.this.global.Type">resType</a><span class="delimiter">)</span>
              <span class="delimiter">}</span>

              <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#641839" title="Boolean">doEmit</a> <a href="../../../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a>
                  <span class="delimiter">(</span><a href="#641791" title="GenMSIL.this.global.icodes.global.Symbol">msym</a>.<a href="../../symtab/Symbols.scala.html#509256" title="=&gt; GenMSIL.this.global.icodes.global.Name">name</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../symtab/StdNames.scala.html#479055" title="object GenMSIL.this.global.nme">nme</a>.<a href="../../symtab/StdNames.scala.html#516834" title="=&gt; GenMSIL.this.global.TermName">PLUS</a> <a href="../../../../Boolean.scala.html#55579" title="(x: Boolean)Boolean">||</a> <a href="#641791" title="GenMSIL.this.global.icodes.global.Symbol">msym</a>.<a href="../../symtab/Symbols.scala.html#509256" title="=&gt; GenMSIL.this.global.icodes.global.Name">name</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../symtab/StdNames.scala.html#479055" title="object GenMSIL.this.global.nme">nme</a>.<a href="../../symtab/StdNames.scala.html#516824" title="=&gt; GenMSIL.this.global.TermName">MINUS</a><span class="delimiter">)</span>
                  <a href="../../../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../symtab/SymbolLoaders.scala.html#506452" title="object GenMSIL.this.global.loaders.clrTypes">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#601658" title="(t: ch.epfl.lamp.compiler.msil.Type)Boolean">isDelegateType</a><span class="delimiter">(</span><a href="#636763" title="(tpe: GenMSIL.this.global.Type)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">(</span><a href="#641791" title="GenMSIL.this.global.icodes.global.Symbol">msym</a>.<a href="../../symtab/Symbols.scala.html#509249" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">owner</a>.<a href="../../symtab/Symbols.scala.html#509270" title="=&gt; GenMSIL.this.global.icodes.global.Type">tpe</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
                <span class="delimiter">{</span>
                <a href="#641839" title="Boolean">doEmit</a> = <span title="Boolean(false)" class="keyword">false</span>
                <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.MethodInfo" id="642647">methodInfo</a>: <span title="ch.epfl.lamp.compiler.msil.MethodInfo">MethodInfo</span> = <a href="#636792" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.MethodInfo">getMethod</a><span class="delimiter">(</span><a href="#641791" title="GenMSIL.this.global.icodes.global.Symbol">msym</a><span class="delimiter">)</span>
                <span class="comment">// call it as a static method, even if the compiler (symbol) thinks it's virtual</span>
                <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Call</span>, <a href="#642647" title="ch.epfl.lamp.compiler.msil.MethodInfo">methodInfo</a><span class="delimiter">)</span>
                <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.Type)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Castclass</span>, <a href="#636763" title="(tpe: GenMSIL.this.global.Type)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">(</span><a href="#641791" title="GenMSIL.this.global.icodes.global.Symbol">msym</a>.<a href="../../symtab/Symbols.scala.html#509249" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">owner</a>.<a href="../../symtab/Symbols.scala.html#509270" title="=&gt; GenMSIL.this.global.icodes.global.Type">tpe</a><span class="delimiter">)</span><span class="delimiter">)</span>
              <span class="delimiter">}</span>

              <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#641839" title="Boolean">doEmit</a> <a href="../../../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../symtab/Definitions.scala.html#479030" title="object GenMSIL.this.global.definitions">definitions</a>.<a href="../../symtab/Definitions.scala.html#508211" title="=&gt; List[GenMSIL.this.global.Symbol]">Delegate_scalaCallers</a>.<a href="../../../../collection/SeqLike.scala.html#54119" title="(elem: Any)Boolean">contains</a><span class="delimiter">(</span><a href="#641791" title="GenMSIL.this.global.icodes.global.Symbol">msym</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
                <a href="#641839" title="Boolean">doEmit</a> = <span title="Boolean(false)" class="keyword">false</span>
                <span class="keyword">val</span> <a title="GenMSIL.this.global.Symbol" id="642663">methodSym</a>: <a href="../../symtab/Symbols.scala.html#478659" title="GenMSIL.this.global.Symbol">Symbol</a> = <a href="../../symtab/Definitions.scala.html#479030" title="object GenMSIL.this.global.definitions">definitions</a>.<a href="../../../../collection/MapLike.scala.html#73204" title="(key: GenMSIL.this.global.Symbol)GenMSIL.this.global.Symbol">Delegate_scalaCallerTargets</a><span class="delimiter">(</span><a href="#641791" title="GenMSIL.this.global.icodes.global.Symbol">msym</a><span class="delimiter">)</span>
                <span class="keyword">val</span> <a title="GenMSIL.this.global.Type" id="642664">delegateType</a>: <a href="../../symtab/Types.scala.html#478720" title="GenMSIL.this.global.Type">Type</a> = <a href="#641791" title="GenMSIL.this.global.icodes.global.Symbol">msym</a>.<a href="../../symtab/Symbols.scala.html#509270" title="=&gt; GenMSIL.this.global.icodes.global.Type">tpe</a> <span title="GenMSIL.this.global.Type" class="keyword">match</span> <span class="delimiter">{</span>
                  <span class="keyword">case</span> <span title="GenMSIL.this.global.Type">MethodType</span><span class="delimiter">(</span>_, <a title="GenMSIL.this.global.Type" id="642690">retType</a><span class="delimiter">)</span> =&gt; <a href="#642690" title="GenMSIL.this.global.Type">retType</a>
                  <span class="keyword">case</span> <span title="Nothing">_</span> =&gt; <a href="../../symtab/SymbolTable.scala.html#478159" title="(msg: String)Nothing">abort</a><span class="delimiter">(</span><span title="java.lang.String(&quot;not a method type: &quot;)" class="string">&quot;not a method type: &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#641791" title="GenMSIL.this.global.icodes.global.Symbol">msym</a>.<a href="../../symtab/Symbols.scala.html#509270" title="=&gt; GenMSIL.this.global.icodes.global.Type">tpe</a><span class="delimiter">)</span>
                <span class="delimiter">}</span>
                <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.MethodInfo" id="642665">methodInfo</a>: <span title="ch.epfl.lamp.compiler.msil.MethodInfo">MethodInfo</span> = <a href="#636792" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.MethodInfo">getMethod</a><span class="delimiter">(</span><a href="#642663" title="GenMSIL.this.global.Symbol">methodSym</a><span class="delimiter">)</span>
                <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.ConstructorInfo" id="642666">delegCtor</a> = <a href="#636763" title="(tpe: GenMSIL.this.global.Type)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">(</span><a href="#642664" title="GenMSIL.this.global.Type">delegateType</a><span class="delimiter">)</span>.<span title="(x$1: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.ConstructorInfo">GetConstructor</span><span class="delimiter">(</span><a href="../../../../Array.scala.html#62681" title="(xs: ch.epfl.lamp.compiler.msil.Type*)(implicit evidence$2: scala.reflect.ClassManifest[ch.epfl.lamp.compiler.msil.Type])Array[ch.epfl.lamp.compiler.msil.Type]">Array</a><a href="../../../../reflect/ClassManifest.scala.html#56840" title="(clazz: java.lang.Class[_])scala.reflect.ClassManifest[ch.epfl.lamp.compiler.msil.Type]" class="delimiter">(</a><a href="../../symtab/clr/CLRTypes.scala.html#601610" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MOBJECT</a>, <a href="#636630" title="=&gt; ch.epfl.lamp.compiler.msil.Type">INT_PTR</a><span class="delimiter">)</span><span class="delimiter">)</span>
                <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#642663" title="GenMSIL.this.global.Symbol">methodSym</a>.<a href="../../symtab/Symbols.scala.html#509233" title="=&gt; Boolean">isStatic</a><span class="delimiter">)</span> <span class="delimiter">{</span>
                  <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldftn</span>, <a href="#642665" title="ch.epfl.lamp.compiler.msil.MethodInfo">methodInfo</a><span class="delimiter">)</span>
                <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
                  <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Dup</span><span class="delimiter">)</span>
                  <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldvirtftn</span>, <a href="#642665" title="ch.epfl.lamp.compiler.msil.MethodInfo">methodInfo</a><span class="delimiter">)</span>
                <span class="delimiter">}</span>
                <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.ConstructorInfo)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Newobj</span>, <a href="#642666" title="ch.epfl.lamp.compiler.msil.ConstructorInfo">delegCtor</a><span class="delimiter">)</span>
              <span class="delimiter">}</span>

              <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#641839" title="Boolean">doEmit</a><span class="delimiter">)</span> <span class="delimiter">{</span>
                <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.MethodInfo" id="642737">methodInfo</a>: <span title="ch.epfl.lamp.compiler.msil.MethodInfo">MethodInfo</span> = <a href="#636792" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.MethodInfo">getMethod</a><span class="delimiter">(</span><a href="#641791" title="GenMSIL.this.global.icodes.global.Symbol">msym</a><span class="delimiter">)</span>
                <span class="delimiter">(</span><a href="#641792" title="GenMSIL.this.global.icodes.opcodes.InvokeStyle">style</a>: @<a href="../icode/Opcodes.scala.html#515027" title="GenMSIL.this.global.icodes.opcodes.InvokeStyle @unchecked">unchecked</a><span class="delimiter">)</span> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
                  <span class="keyword">case</span> <span title="Unit">SuperCall</span><span class="delimiter">(</span>_<span class="delimiter">)</span> =&gt;
                    <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Call</span>, <a href="#642737" title="ch.epfl.lamp.compiler.msil.MethodInfo">methodInfo</a><span class="delimiter">)</span>
                  <span class="keyword">case</span> <a href="../icode/Opcodes.scala.html#515028" title="Unit">Dynamic</a> =&gt;
                    <span class="comment">// methodInfo.DeclaringType is null for global methods</span>
                    <span class="keyword">val</span> <a title="Boolean" id="642743">isValuetypeMethod</a> = <span class="delimiter">(</span><a href="#642737" title="ch.epfl.lamp.compiler.msil.MethodInfo">methodInfo</a>.<span title="ch.epfl.lamp.compiler.msil.Type">DeclaringType</span> <span title="(x$1: AnyRef)Boolean">ne</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <a href="../../../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a> <span class="delimiter">(</span><a href="#642737" title="ch.epfl.lamp.compiler.msil.MethodInfo">methodInfo</a>.<span title="ch.epfl.lamp.compiler.msil.Type">DeclaringType</span>.<span title="()Boolean">IsValueType</span><span class="delimiter">)</span>
                    <span class="keyword">val</span> <a title="Boolean" id="642744">isValuetypeVirtualMethod</a> = <a href="#642743" title="Boolean">isValuetypeMethod</a> <a href="../../../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a> <span class="delimiter">(</span><a href="#642737" title="ch.epfl.lamp.compiler.msil.MethodInfo">methodInfo</a>.<span title="()Boolean">IsVirtual</span><span class="delimiter">)</span>
                    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../../../collection/GenSetLike.scala.html#59062" title="(elem: GenMSIL.this.global.Symbol)Boolean">dynToStatMapped</a><span class="delimiter">(</span><a href="#641791" title="GenMSIL.this.global.icodes.global.Symbol">msym</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
                      <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Call</span>, <a href="#642737" title="ch.epfl.lamp.compiler.msil.MethodInfo">methodInfo</a><span class="delimiter">)</span>
                    <span class="delimiter">}</span> <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#642744" title="Boolean">isValuetypeVirtualMethod</a><span class="delimiter">)</span> <span class="delimiter">{</span>
                      <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.Type)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Constrained</span>, <a href="#642737" title="ch.epfl.lamp.compiler.msil.MethodInfo">methodInfo</a>.<span title="ch.epfl.lamp.compiler.msil.Type">DeclaringType</span><span class="delimiter">)</span>
                      <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Callvirt</span>, <a href="#642737" title="ch.epfl.lamp.compiler.msil.MethodInfo">methodInfo</a><span class="delimiter">)</span>
                    <span class="delimiter">}</span> <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#642743" title="Boolean">isValuetypeMethod</a><span class="delimiter">)</span> <span class="delimiter">{</span>
                      <span class="comment">// otherwise error &quot;Callvirt on a value type method&quot; ensues</span>
                      <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Call</span>, <a href="#642737" title="ch.epfl.lamp.compiler.msil.MethodInfo">methodInfo</a><span class="delimiter">)</span>
                    <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
                      <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Callvirt</span>, <a href="#642737" title="ch.epfl.lamp.compiler.msil.MethodInfo">methodInfo</a><span class="delimiter">)</span>
                    <span class="delimiter">}</span>
                  <span class="keyword">case</span> <span title="Unit">Static</span><span class="delimiter">(</span>_<span class="delimiter">)</span> =&gt;
                    <span title="Unit" class="keyword">if</span><span class="delimiter">(</span><a href="#642737" title="ch.epfl.lamp.compiler.msil.MethodInfo">methodInfo</a>.<span title="()Boolean">IsVirtual</span> <a href="../../../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../../../Boolean.scala.html#55576" title="=&gt; Boolean">!</a><a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="()Boolean">Ldarg0WasJustEmitted</span><span class="delimiter">)</span> <span class="delimiter">{</span>
                      <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Callvirt</span>, <a href="#642737" title="ch.epfl.lamp.compiler.msil.MethodInfo">methodInfo</a><span class="delimiter">)</span>
                    <span class="delimiter">}</span> <span class="keyword">else</span> <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Call</span>, <a href="#642737" title="ch.epfl.lamp.compiler.msil.MethodInfo">methodInfo</a><span class="delimiter">)</span>
              <span class="delimiter">}</span>
            <span class="delimiter">}</span>
            <span class="delimiter">}</span>

          <span class="keyword">case</span> <span title="Unit">BOX</span><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.TypeKind" id="642789">boxType</a><span class="delimiter">)</span> =&gt;
            <a href="#636788" title="(code: ch.epfl.lamp.compiler.msil.emit.ILGenerator, boxType: GenMSIL.this.global.icodes.TypeKind)Unit">emitBox</a><span class="delimiter">(</span><a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>, <a href="#642789" title="GenMSIL.this.global.icodes.TypeKind">boxType</a><span class="delimiter">)</span>

          <span class="keyword">case</span> <span title="Unit">UNBOX</span><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.TypeKind" id="642791">boxType</a><span class="delimiter">)</span> =&gt;
            <a href="#636789" title="(code: ch.epfl.lamp.compiler.msil.emit.ILGenerator, boxType: GenMSIL.this.global.icodes.TypeKind)Unit">emitUnbox</a><span class="delimiter">(</span><a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>, <a href="#642791" title="GenMSIL.this.global.icodes.TypeKind">boxType</a><span class="delimiter">)</span>

          <span class="keyword">case</span> <span title="Unit">CIL_UNBOX</span><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.TypeKind" id="642793">boxType</a><span class="delimiter">)</span> =&gt;
            <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.Type)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Unbox</span>, <a href="#636762" title="(t: GenMSIL.this.global.icodes.TypeKind)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">(</span><a href="#642793" title="GenMSIL.this.global.icodes.TypeKind">boxType</a><span class="delimiter">)</span><span class="delimiter">)</span>

          <span class="keyword">case</span> <span title="Unit">CIL_INITOBJ</span><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.TypeKind" id="642805">valueType</a><span class="delimiter">)</span> =&gt;
            <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.Type)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Initobj</span>, <a href="#636762" title="(t: GenMSIL.this.global.icodes.TypeKind)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">(</span><a href="#642805" title="GenMSIL.this.global.icodes.TypeKind">valueType</a><span class="delimiter">)</span><span class="delimiter">)</span>

          <span class="keyword">case</span> <span title="Unit">NEW</span><span class="delimiter">(</span>REFERENCE<span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.global.Symbol" id="642818">cls</a><span class="delimiter">)</span><span class="delimiter">)</span> =&gt;
            <span class="comment">// the next instruction must be a DUP, see comment on `var previousWasNEW`</span>
            <a href="#641072" title="Boolean">previousWasNEW</a> = <span title="Boolean(true)" class="keyword">true</span>

          <span class="comment">// works also for arrays and reference-types</span>
          <span class="keyword">case</span> <span title="Unit">CREATE_ARRAY</span><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.TypeKind" id="642821">elem</a>, <a title="Int" id="642822">dims</a><span class="delimiter">)</span> =&gt;
            <span class="comment">// TODO: handle multi dimensional arrays</span>
            <a href="../../../../Predef.scala.html#9566" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a><span class="delimiter">(</span><a href="#642822" title="Int">dims</a> <a href="../../../../Int.scala.html#54747" title="(x: Int)Boolean">==</a> <span title="Int(1)" class="int">1</span>, <span title="java.lang.String(&quot;Can\'t handle multi dimensional arrays&quot;)" class="string">&quot;Can't handle multi dimensional arrays&quot;</span><span class="delimiter">)</span>
            <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.Type)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Newarr</span>, <a href="#636762" title="(t: GenMSIL.this.global.icodes.TypeKind)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">(</span><a href="#642821" title="GenMSIL.this.global.icodes.TypeKind">elem</a><span class="delimiter">)</span><span class="delimiter">)</span>

          <span class="comment">// works for arrays and reference-types</span>
          <span class="keyword">case</span> <span title="Unit">IS_INSTANCE</span><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.TypeKind" id="642840">tpe</a><span class="delimiter">)</span> =&gt;
            <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.Type)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Isinst</span>, <a href="#636762" title="(t: GenMSIL.this.global.icodes.TypeKind)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">(</span><a href="#642840" title="GenMSIL.this.global.icodes.TypeKind">tpe</a><span class="delimiter">)</span><span class="delimiter">)</span>
            <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldnull</span><span class="delimiter">)</span>
            <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ceq</span><span class="delimiter">)</span>
            <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldc_I4_0</span><span class="delimiter">)</span>
            <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ceq</span><span class="delimiter">)</span>

          <span class="comment">// works for arrays and reference-types</span>
          <span class="comment">// part from the scala reference: &quot;S &lt;: T does not imply</span>
          <span class="comment">//  Array[S] &lt;: Array[T] in Scala. However, it is possible</span>
          <span class="comment">//  to cast an array of S to an array of T if such a cast</span>
          <span class="comment">//  is permitted in the host environment.&quot;</span>
          <span class="keyword">case</span> <span title="Unit">CHECK_CAST</span><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.TypeKind" id="642860">tpknd</a><span class="delimiter">)</span> =&gt;
            <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.Type" id="642861">tMSIL</a> = <a href="#636762" title="(t: GenMSIL.this.global.icodes.TypeKind)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">(</span><a href="#642860" title="GenMSIL.this.global.icodes.TypeKind">tpknd</a><span class="delimiter">)</span>
              <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.Type)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Castclass</span>, <a href="#642861" title="ch.epfl.lamp.compiler.msil.Type">tMSIL</a><span class="delimiter">)</span>

          <span class="comment">// no SWITCH is generated when there's</span>
          <span class="comment">//  - a default case (&quot;case _ =&gt; ...&quot;) in the matching expr</span>
          <span class="comment">//  - OR is used (&quot;case 1 | 2 =&gt; ...&quot;)</span>
          <span class="keyword">case</span> <span title="Unit">SWITCH</span><span class="delimiter">(</span><a title="List[List[Int]]" id="642874">tags</a>, <a title="List[GenMSIL.this.global.icodes.BasicBlock]" id="642875">branches</a><span class="delimiter">)</span> =&gt;
            <span class="comment">// tags is List[List[Int]]; a list of integers for every label.</span>
            <span class="comment">//    if the int on stack is 4, and 4 is in the second list =&gt; jump</span>
            <span class="comment">//    to second label</span>
            <span class="comment">// branches is List[BasicBlock]</span>
            <span class="comment">//    the labels to jump to (the last one is the default one)</span>

            <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.LocalBuilder" id="642876">switchLocal</a> = <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(localType: ch.epfl.lamp.compiler.msil.Type)ch.epfl.lamp.compiler.msil.emit.LocalBuilder">DeclareLocal</span><span class="delimiter">(</span><a href="../../symtab/clr/CLRTypes.scala.html#601580" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MINT</a><span class="delimiter">)</span>
            <span class="comment">// several switch variables will appear with the same name in the</span>
            <span class="comment">//  assembly code, but this makes no truble</span>
            <a href="#642876" title="ch.epfl.lamp.compiler.msil.emit.LocalBuilder">switchLocal</a>.<span title="(name: String)Unit">SetLocalSymInfo</span><span class="delimiter">(</span><span title="java.lang.String(&quot;$switch_var&quot;)" class="string">&quot;$switch_var&quot;</span><span class="delimiter">)</span>

            <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.emit.LocalBuilder)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Stloc</span>, <a href="#642876" title="ch.epfl.lamp.compiler.msil.emit.LocalBuilder">switchLocal</a><span class="delimiter">)</span>
            <span class="keyword">var</span> <a title="Int" id="642877">i</a> = <span title="Int(0)" class="int">0</span>
            <span class="keyword">for</span> <span class="delimiter">(</span><a title="List[Int]" id="642902">l</a> &lt;- <a href="../../../../collection/LinearSeqOptimized.scala.html#71032" title="(f: List[Int] =&gt; Unit)Unit">tags</a><span class="delimiter">)</span> <span class="delimiter">{</span>
              <span class="keyword">var</span> <a title="ch.epfl.lamp.compiler.msil.emit.Label" id="642903">targetLabel</a> = <a href="../../../../collection/MapLike.scala.html#73204" title="(key: GenMSIL.this.global.icodes.BasicBlock)ch.epfl.lamp.compiler.msil.emit.Label">labels</a><span class="delimiter">(</span><a href="../../../../collection/LinearSeqOptimized.scala.html#71031" title="(n: Int)GenMSIL.this.global.icodes.BasicBlock">branches</a><span class="delimiter">(</span><a href="#642877" title="Int">i</a><span class="delimiter">)</span><span class="delimiter">)</span>
              <span class="keyword">for</span> <span class="delimiter">(</span><a title="Int" id="642945">i</a> &lt;- <a href="../../../../collection/LinearSeqOptimized.scala.html#71032" title="(f: Int =&gt; Unit)Unit">l</a><span class="delimiter">)</span> <span class="delimiter">{</span>
                <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.emit.LocalBuilder)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldloc</span>, <a href="#642876" title="ch.epfl.lamp.compiler.msil.emit.LocalBuilder">switchLocal</a><span class="delimiter">)</span>
                <a href="#636742" title="(value: Int, code: ch.epfl.lamp.compiler.msil.emit.ILGenerator)Unit">loadI4</a><span class="delimiter">(</span><a href="#642945" title="Int">i</a>, <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a><span class="delimiter">)</span>
                <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, label: ch.epfl.lamp.compiler.msil.emit.Label)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Beq</span>, <a href="#642903" title="ch.epfl.lamp.compiler.msil.emit.Label">targetLabel</a><span class="delimiter">)</span>
              <span class="delimiter">}</span>
              <a href="#642877" title="Int">i</a> <a href="../../../../Int.scala.html#54804" title="(x: Int)Int">+=</a> <span title="Int(1)" class="int">1</span>
            <span class="delimiter">}</span>
            <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.Label" id="642878">defaultTarget</a> = <a href="../../../../collection/MapLike.scala.html#73204" title="(key: GenMSIL.this.global.icodes.BasicBlock)ch.epfl.lamp.compiler.msil.emit.Label">labels</a><span class="delimiter">(</span><a href="../../../../collection/LinearSeqOptimized.scala.html#71031" title="(n: Int)GenMSIL.this.global.icodes.BasicBlock">branches</a><span class="delimiter">(</span><a href="#642877" title="Int">i</a><span class="delimiter">)</span><span class="delimiter">)</span>
            <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#640519" title="GenMSIL.this.global.icodes.BasicBlock">next</a> <span title="(x$1: AnyRef)Boolean">!=</span> <a href="#642878" title="ch.epfl.lamp.compiler.msil.emit.Label">defaultTarget</a><span class="delimiter">)</span>
              <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, label: ch.epfl.lamp.compiler.msil.emit.Label)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Br</span>, <a href="#642878" title="ch.epfl.lamp.compiler.msil.emit.Label">defaultTarget</a><span class="delimiter">)</span>

          <span class="keyword">case</span> <span title="Unit">JUMP</span><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.BasicBlock" id="642991">whereto</a><span class="delimiter">)</span> =&gt;
            <span class="keyword">val</span> <a href="../../../../Tuple3.scala.html#53296" title="(Boolean, Boolean, Option[ch.epfl.lamp.compiler.msil.emit.Label])" class="delimiter">(</a><a href="../../../../Tuple3.scala.html#53312" title="Boolean" id="642993">leaveHandler</a>, <a href="../../../../Tuple3.scala.html#53314" title="Boolean" id="642994">leaveFinally</a>, <a href="../../../../Tuple3.scala.html#53316" title="Option[ch.epfl.lamp.compiler.msil.emit.Label]" id="642995">lfTarget</a><span class="delimiter">)</span> = <a href="#636745" title="(from: GenMSIL.this.global.icodes.BasicBlock, to: GenMSIL.this.global.icodes.BasicBlock)(Boolean, Boolean, Option[ch.epfl.lamp.compiler.msil.emit.Label])">leavesHandler</a><a href="../../../../Tuple3.scala.html#317" title="(Boolean, Boolean, Option[ch.epfl.lamp.compiler.msil.emit.Label]) @unchecked" class="delimiter">(</a><a href="#640517" title="GenMSIL.this.global.icodes.BasicBlock">block</a>, <a href="#642991" title="GenMSIL.this.global.icodes.BasicBlock">whereto</a><span class="delimiter">)</span>
            <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#642993" title="Boolean">leaveHandler</a><span class="delimiter">)</span> <span class="delimiter">{</span>
              <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#642994" title="Boolean">leaveFinally</a><span class="delimiter">)</span> <span class="delimiter">{</span>
                <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#642995" title="Option[ch.epfl.lamp.compiler.msil.emit.Label]">lfTarget</a>.<a href="../../../../Option.scala.html#48472" title="=&gt; Boolean">isDefined</a><span class="delimiter">)</span> <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, label: ch.epfl.lamp.compiler.msil.emit.Label)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Leave</span>, <a href="#642995" title="Option[ch.epfl.lamp.compiler.msil.emit.Label]">lfTarget</a>.<a href="../../../../Option.scala.html#48473" title="=&gt; ch.epfl.lamp.compiler.msil.emit.Label">get</a><span class="delimiter">)</span>
                <span class="keyword">else</span> <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Endfinally</span><span class="delimiter">)</span>
              <span class="delimiter">}</span> <span class="keyword">else</span>
                <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, label: ch.epfl.lamp.compiler.msil.emit.Label)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Leave</span>, <a href="../../../../collection/MapLike.scala.html#73204" title="(key: GenMSIL.this.global.icodes.BasicBlock)ch.epfl.lamp.compiler.msil.emit.Label">labels</a><span class="delimiter">(</span><a href="#642991" title="GenMSIL.this.global.icodes.BasicBlock">whereto</a><span class="delimiter">)</span><span class="delimiter">)</span>
            <span class="delimiter">}</span> <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#640519" title="GenMSIL.this.global.icodes.BasicBlock">next</a> <span title="(x$1: AnyRef)Boolean">!=</span> <a href="#642991" title="GenMSIL.this.global.icodes.BasicBlock">whereto</a><span class="delimiter">)</span>
              <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, label: ch.epfl.lamp.compiler.msil.emit.Label)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Br</span>, <a href="../../../../collection/MapLike.scala.html#73204" title="(key: GenMSIL.this.global.icodes.BasicBlock)ch.epfl.lamp.compiler.msil.emit.Label">labels</a><span class="delimiter">(</span><a href="#642991" title="GenMSIL.this.global.icodes.BasicBlock">whereto</a><span class="delimiter">)</span><span class="delimiter">)</span>

          <span class="keyword">case</span> <span title="Unit">CJUMP</span><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.BasicBlock" id="643066">success</a>, <a title="GenMSIL.this.global.icodes.BasicBlock" id="643067">failure</a>, <a title="GenMSIL.this.global.icodes.TestOp" id="643068">cond</a>, <a title="GenMSIL.this.global.icodes.TypeKind" id="643069">kind</a><span class="delimiter">)</span> =&gt;
            <span class="comment">// cond is TestOp (see Primitives.scala), and can take</span>
            <span class="comment">// values EQ, NE, LT, GE LE, GT</span>
            <span class="comment">// kind is TypeKind</span>
            <span class="keyword">val</span> <a title="Boolean" id="643070">isFloat</a> = <a href="#643069" title="GenMSIL.this.global.icodes.TypeKind">kind</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../icode/TypeKinds.scala.html#501311" title="object GenMSIL.this.global.icodes.FLOAT">FLOAT</a> <a href="../../../../Boolean.scala.html#55579" title="(x: Boolean)Boolean">||</a> <a href="#643069" title="GenMSIL.this.global.icodes.TypeKind">kind</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../icode/TypeKinds.scala.html#501313" title="object GenMSIL.this.global.icodes.DOUBLE">DOUBLE</a>
            <span class="keyword">val</span> <a title="(GenMSIL.this.global.icodes.TestOp, ch.epfl.lamp.compiler.msil.emit.Label) =&gt; Unit" id="643071">emit</a> = <span class="delimiter">(</span>c: <a href="../icode/Primitives.scala.html#501383" title="GenMSIL.this.global.icodes.TestOp">TestOp</a>, l: <span title="ch.epfl.lamp.compiler.msil.emit.Label">Label</span><span class="delimiter">)</span> =&gt; <a href="#636747" title="(condition: GenMSIL.this.global.icodes.TestOp, dest: ch.epfl.lamp.compiler.msil.emit.Label, isFloat: Boolean)Unit">emitBr</a><span class="delimiter">(</span><a href="#643081" title="GenMSIL.this.global.icodes.TestOp">c</a>, <a href="#643082" title="ch.epfl.lamp.compiler.msil.emit.Label">l</a>, <a href="#643070" title="Boolean">isFloat</a><span class="delimiter">)</span>
            <a href="#636746" title="(block: GenMSIL.this.global.icodes.BasicBlock, cond: GenMSIL.this.global.icodes.TestOp, success: GenMSIL.this.global.icodes.BasicBlock, failure: GenMSIL.this.global.icodes.BasicBlock, next: GenMSIL.this.global.icodes.BasicBlock, emitBrFun: (GenMSIL.this.global.icodes.TestOp, ch.epfl.lamp.compiler.msil.emit.Label) =&gt; Unit)Unit">emitCondBr</a><span class="delimiter">(</span><a href="#640517" title="GenMSIL.this.global.icodes.BasicBlock">block</a>, <a href="#643068" title="GenMSIL.this.global.icodes.TestOp">cond</a>, <a href="#643066" title="GenMSIL.this.global.icodes.BasicBlock">success</a>, <a href="#643067" title="GenMSIL.this.global.icodes.BasicBlock">failure</a>, <a href="#640519" title="GenMSIL.this.global.icodes.BasicBlock">next</a>, <a href="#643071" title="(GenMSIL.this.global.icodes.TestOp, ch.epfl.lamp.compiler.msil.emit.Label) =&gt; Unit">emit</a><span class="delimiter">)</span>

          <span class="keyword">case</span> <span title="Unit">CZJUMP</span><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.BasicBlock" id="643098">success</a>, <a title="GenMSIL.this.global.icodes.BasicBlock" id="643099">failure</a>, <a title="GenMSIL.this.global.icodes.TestOp" id="643100">cond</a>, <a title="GenMSIL.this.global.icodes.TypeKind" id="643101">kind</a><span class="delimiter">)</span> =&gt;
            <a href="#636746" title="(block: GenMSIL.this.global.icodes.BasicBlock, cond: GenMSIL.this.global.icodes.TestOp, success: GenMSIL.this.global.icodes.BasicBlock, failure: GenMSIL.this.global.icodes.BasicBlock, next: GenMSIL.this.global.icodes.BasicBlock, emitBrFun: (GenMSIL.this.global.icodes.TestOp, ch.epfl.lamp.compiler.msil.emit.Label) =&gt; Unit)Unit">emitCondBr</a><span class="delimiter">(</span><a href="#640517" title="GenMSIL.this.global.icodes.BasicBlock">block</a>, <a href="#643100" title="GenMSIL.this.global.icodes.TestOp">cond</a>, <a href="#643098" title="GenMSIL.this.global.icodes.BasicBlock">success</a>, <a href="#643099" title="GenMSIL.this.global.icodes.BasicBlock">failure</a>, <a href="#640519" title="GenMSIL.this.global.icodes.BasicBlock">next</a>, <a href="#636748" title="(cond: GenMSIL.this.global.icodes.TestOp, dest: ch.epfl.lamp.compiler.msil.emit.Label)Unit">emitBrBool</a><span class="delimiter">(</span><a href="#643103" title="GenMSIL.this.global.icodes.TestOp">_</a>, <a href="#643104" title="ch.epfl.lamp.compiler.msil.emit.Label">_</a><span class="delimiter">)</span><span class="delimiter">)</span>

          <span class="keyword">case</span> <span title="Unit">RETURN</span><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.TypeKind" id="643109">kind</a><span class="delimiter">)</span> =&gt;
            <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#636722" title="=&gt; scala.collection.mutable.Stack[GenMSIL.this.global.icodes.ExceptionHandler]">currentHandlers</a>.<a href="../../../../collection/mutable/Stack.scala.html#301888" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span>
              <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ret</span><span class="delimiter">)</span>
            <span class="keyword">else</span> <span class="delimiter">{</span>
              <span class="keyword">val</span> <a href="../../../../Tuple2.scala.html#53390" title="(ch.epfl.lamp.compiler.msil.emit.LocalBuilder, ch.epfl.lamp.compiler.msil.emit.Label)" class="delimiter">(</a><a href="../../../../Tuple2.scala.html#53402" title="ch.epfl.lamp.compiler.msil.emit.LocalBuilder" id="643114">local</a>, <a href="../../../../Tuple2.scala.html#53404" title="ch.epfl.lamp.compiler.msil.emit.Label" id="643115">label</a><span class="delimiter">)</span> = <a href="#636736" title="(kind: GenMSIL.this.global.icodes.TypeKind)(ch.epfl.lamp.compiler.msil.emit.LocalBuilder, ch.epfl.lamp.compiler.msil.emit.Label)">returnFromHandler</a><a href="../../../../Tuple2.scala.html#1520" title="(ch.epfl.lamp.compiler.msil.emit.LocalBuilder, ch.epfl.lamp.compiler.msil.emit.Label) @unchecked" class="delimiter">(</a><a href="#643109" title="GenMSIL.this.global.icodes.TypeKind">kind</a><span class="delimiter">)</span>
              <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#643109" title="GenMSIL.this.global.icodes.TypeKind">kind</a> <span title="(x$1: AnyRef)Boolean">!=</span> <a href="../icode/TypeKinds.scala.html#501297" title="object GenMSIL.this.global.icodes.UNIT">UNIT</a><span class="delimiter">)</span>
                <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.emit.LocalBuilder)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Stloc</span>, <a href="#643114" title="ch.epfl.lamp.compiler.msil.emit.LocalBuilder">local</a><span class="delimiter">)</span>
              <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, label: ch.epfl.lamp.compiler.msil.emit.Label)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Leave</span>, <a href="#643115" title="ch.epfl.lamp.compiler.msil.emit.Label">label</a><span class="delimiter">)</span>
            <span class="delimiter">}</span>

          <span class="keyword">case</span> <span title="Unit">THROW</span><span class="delimiter">(</span>_<span class="delimiter">)</span> =&gt;
            <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Throw</span><span class="delimiter">)</span>

          <span class="keyword">case</span> <span title="Unit">DROP</span><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.TypeKind" id="643142">kind</a><span class="delimiter">)</span> =&gt;
            <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Pop</span><span class="delimiter">)</span>

          <span class="keyword">case</span> <span title="Unit">DUP</span><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.TypeKind" id="643146">kind</a><span class="delimiter">)</span> =&gt;
            <span class="comment">// see comment on `var previousWasNEW`</span>
            <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../../../Boolean.scala.html#55576" title="=&gt; Boolean">!</a><a href="#641072" title="Boolean">previousWasNEW</a><span class="delimiter">)</span>
              <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Dup</span><span class="delimiter">)</span>
            <span class="keyword">else</span>
              <a href="#641072" title="Boolean">previousWasNEW</a> = <span title="Boolean(false)" class="keyword">false</span>

          <span class="keyword">case</span> <span title="Unit">MONITOR_ENTER</span><span class="delimiter">(</span><span class="delimiter">)</span> =&gt;
            <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Call</span>, <a href="#636618" title="=&gt; ch.epfl.lamp.compiler.msil.MethodInfo">MMONITOR_ENTER</a><span class="delimiter">)</span>

          <span class="keyword">case</span> <span title="Unit">MONITOR_EXIT</span><span class="delimiter">(</span><span class="delimiter">)</span> =&gt;
            <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Call</span>, <a href="#636620" title="=&gt; ch.epfl.lamp.compiler.msil.MethodInfo">MMONITOR_EXIT</a><span class="delimiter">)</span>

          <span class="keyword">case</span> <span title="Unit">SCOPE_ENTER</span><span class="delimiter">(</span>_<span class="delimiter">)</span> | SCOPE_EXIT<span class="delimiter">(</span>_<span class="delimiter">)</span> | LOAD_EXCEPTION<span class="delimiter">(</span>_<span class="delimiter">)</span> =&gt;
            <span title="Unit" class="delimiter">(</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>

      <span class="delimiter">}</span> <span class="comment">// end for (instr &lt;- b) { .. }</span>
    <span class="delimiter">}</span> <span class="comment">// end genBlock</span>

    <span class="keyword">def</span> <a title="(primitive: GenMSIL.this.global.icodes.Primitive, pos: GenMSIL.this.global.Position)Unit" id="636741">genPrimitive</a><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.Primitive" id="641786">primitive</a>: <a href="../icode/Primitives.scala.html#501343" title="GenMSIL.this.global.icodes.Primitive">Primitive</a>, <a title="GenMSIL.this.global.Position" id="641787">pos</a>: <a href="../../util/Position.scala.html#42664" title="GenMSIL.this.global.Position">Position</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#641786" title="GenMSIL.this.global.icodes.Primitive">primitive</a> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <span title="Unit">Negation</span><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.TypeKind" id="643162">kind</a><span class="delimiter">)</span> =&gt;
          <a href="#643162" title="GenMSIL.this.global.icodes.TypeKind">kind</a> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
            <span class="comment">// CHECK: is ist possible to get this for BOOL? in this case, verify.</span>
            <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#501299" title="Unit">BOOL</a> | <a href="../icode/TypeKinds.scala.html#501301" title="object GenMSIL.this.global.icodes.BYTE">BYTE</a> | <a href="../icode/TypeKinds.scala.html#501305" title="object GenMSIL.this.global.icodes.CHAR">CHAR</a> | <a href="../icode/TypeKinds.scala.html#501303" title="object GenMSIL.this.global.icodes.SHORT">SHORT</a> | <a href="../icode/TypeKinds.scala.html#501307" title="object GenMSIL.this.global.icodes.INT">INT</a> | <a href="../icode/TypeKinds.scala.html#501309" title="object GenMSIL.this.global.icodes.LONG">LONG</a> | <a href="../icode/TypeKinds.scala.html#501311" title="object GenMSIL.this.global.icodes.FLOAT">FLOAT</a> | <a href="../icode/TypeKinds.scala.html#501313" title="object GenMSIL.this.global.icodes.DOUBLE">DOUBLE</a> =&gt;
              <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Neg</span><span class="delimiter">)</span>

            <span class="keyword">case</span> <span title="Nothing">_</span> =&gt; <a href="../../symtab/SymbolTable.scala.html#478159" title="(msg: String)Nothing">abort</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Impossible to negate a &quot;)" class="string">&quot;Impossible to negate a &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#643162" title="GenMSIL.this.global.icodes.TypeKind">kind</a><span class="delimiter">)</span>
          <span class="delimiter">}</span>

        <span class="keyword">case</span> <span title="Unit">Arithmetic</span><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.ArithmeticOp" id="643169">op</a>, <a title="GenMSIL.this.global.icodes.TypeKind" id="643170">kind</a><span class="delimiter">)</span> =&gt;
          <a href="#643169" title="GenMSIL.this.global.icodes.ArithmeticOp">op</a> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
            <span class="keyword">case</span> <a href="../icode/Primitives.scala.html#501397" title="Unit">ADD</a> =&gt; <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Add</span><span class="delimiter">)</span>
            <span class="keyword">case</span> <a href="../icode/Primitives.scala.html#501399" title="Unit">SUB</a> =&gt; <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Sub</span><span class="delimiter">)</span>
            <span class="keyword">case</span> <a href="../icode/Primitives.scala.html#501401" title="Unit">MUL</a> =&gt; <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Mul</span><span class="delimiter">)</span>
            <span class="keyword">case</span> <a href="../icode/Primitives.scala.html#501403" title="Unit">DIV</a> =&gt; <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Div</span><span class="delimiter">)</span>
            <span class="keyword">case</span> <a href="../icode/Primitives.scala.html#501405" title="Unit">REM</a> =&gt; <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Rem</span><span class="delimiter">)</span>
            <span class="keyword">case</span> <a href="../icode/Primitives.scala.html#501407" title="Unit">NOT</a> =&gt; <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Not</span><span class="delimiter">)</span> <span class="comment">//bitwise complement (one's complement)</span>
            <span class="keyword">case</span> <span title="Nothing">_</span> =&gt; <a href="../../symtab/SymbolTable.scala.html#478159" title="(msg: String)Nothing">abort</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Unknown arithmetic primitive &quot;)" class="string">&quot;Unknown arithmetic primitive &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#641786" title="GenMSIL.this.global.icodes.Primitive">primitive</a> <span class="delimiter">)</span>
          <span class="delimiter">}</span>

        <span class="keyword">case</span> <span title="Unit">Logical</span><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.LogicalOp" id="643187">op</a>, <a title="GenMSIL.this.global.icodes.TypeKind" id="643188">kind</a><span class="delimiter">)</span> =&gt; <a href="#643187" title="GenMSIL.this.global.icodes.LogicalOp">op</a> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> <a href="../icode/Primitives.scala.html#501417" title="Unit">AND</a> =&gt; <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">And</span><span class="delimiter">)</span>
          <span class="keyword">case</span> <a href="../icode/Primitives.scala.html#501419" title="Unit">OR</a> =&gt; <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Or</span><span class="delimiter">)</span>
          <span class="keyword">case</span> <a href="../icode/Primitives.scala.html#501421" title="Unit">XOR</a> =&gt; <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Xor</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>

        <span class="keyword">case</span> <span title="Unit">Shift</span><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.ShiftOp" id="643197">op</a>, <a title="GenMSIL.this.global.icodes.TypeKind" id="643198">kind</a><span class="delimiter">)</span> =&gt; <a href="#643197" title="GenMSIL.this.global.icodes.ShiftOp">op</a> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> <a href="../icode/Primitives.scala.html#501410" title="Unit">LSL</a> =&gt; <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Shl</span><span class="delimiter">)</span>
          <span class="keyword">case</span> <a href="../icode/Primitives.scala.html#501412" title="Unit">ASR</a> =&gt; <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Shr</span><span class="delimiter">)</span>
          <span class="keyword">case</span> <a href="../icode/Primitives.scala.html#501414" title="Unit">LSR</a> =&gt; <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Shr_Un</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>

        <span class="keyword">case</span> <span title="Unit">Conversion</span><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.TypeKind" id="643207">src</a>, <a title="GenMSIL.this.global.icodes.TypeKind" id="643208">dst</a><span class="delimiter">)</span> =&gt;
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../Global.scala.html#478200" title="=&gt; scala.tools.nsc.Settings">settings</a>.<a href="../../settings/ScalaSettings.scala.html#469727" title="=&gt; scala.tools.nsc.Settings#BooleanSetting">debug</a>.<a href="../../settings/MutableSettings.scala.html#470030" title="=&gt; Boolean">value</a><span class="delimiter">)</span>
            <a href="../../Global.scala.html#478254" title="(msg: =&gt; AnyRef)Unit">log</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Converting from: &quot;)" class="string">&quot;Converting from: &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#643207" title="GenMSIL.this.global.icodes.TypeKind">src</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot; to: &quot;)" class="string">&quot; to: &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#643208" title="GenMSIL.this.global.icodes.TypeKind">dst</a><span class="delimiter">)</span>

          <a href="#643208" title="GenMSIL.this.global.icodes.TypeKind">dst</a> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
            <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#501301" title="Unit">BYTE</a> =&gt;   <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Conv_I1</span><span class="delimiter">)</span> <span class="comment">// I1 for System.SByte, i.e. a scala.Byte</span>
            <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#501303" title="Unit">SHORT</a> =&gt;  <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Conv_I2</span><span class="delimiter">)</span>
            <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#501305" title="Unit">CHAR</a> =&gt;   <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Conv_U2</span><span class="delimiter">)</span>
            <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#501307" title="Unit">INT</a> =&gt;    <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Conv_I4</span><span class="delimiter">)</span>
            <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#501309" title="Unit">LONG</a> =&gt;   <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Conv_I8</span><span class="delimiter">)</span>
            <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#501311" title="Unit">FLOAT</a> =&gt;  <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Conv_R4</span><span class="delimiter">)</span>
            <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#501313" title="Unit">DOUBLE</a> =&gt; <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Conv_R8</span><span class="delimiter">)</span>
            <span class="keyword">case</span> <span title="Unit">_</span> =&gt;
              <a href="../../../../Console.scala.html#507" title="object Console">Console</a>.<a href="../../../../Console.scala.html#58055" title="(x: Any)Unit">println</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Illegal conversion at: &quot;)" class="string">&quot;Illegal conversion at: &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#636668" title="=&gt; GenMSIL.this.global.icodes.IClass">clasz</a> <span title="(x$1: Any)java.lang.String">+</span>
                              <span title="java.lang.String(&quot; at: &quot;)" class="string">&quot; at: &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#641787" title="GenMSIL.this.global.Position">pos</a>.<a href="../../util/Position.scala.html#501487" title="=&gt; scala.tools.nsc.util.SourceFile">source</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;:&quot;)" class="string">&quot;:&quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#641787" title="GenMSIL.this.global.Position">pos</a>.<a href="../../util/Position.scala.html#501514" title="=&gt; Int">line</a><span class="delimiter">)</span>
          <span class="delimiter">}</span>

        <span class="keyword">case</span> <span title="Unit">ArrayLength</span><span class="delimiter">(</span>_<span class="delimiter">)</span> =&gt;
          <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldlen</span><span class="delimiter">)</span>

        <span class="keyword">case</span> <a href="../icode/Primitives.scala.html#501371" title="Unit">StartConcat</a> =&gt;
          <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.ConstructorInfo)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Newobj</span>, <a href="#636624" title="=&gt; ch.epfl.lamp.compiler.msil.ConstructorInfo">MSTRING_BUILDER_CONSTR</a><span class="delimiter">)</span>


        <span class="keyword">case</span> <span title="Unit">StringConcat</span><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.TypeKind" id="643236">el</a><span class="delimiter">)</span> =&gt;
          <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.Type" id="643237">elemType</a> : <span title="ch.epfl.lamp.compiler.msil.Type">MsilType</span> = <a href="#643236" title="GenMSIL.this.global.icodes.TypeKind">el</a> <span title="ch.epfl.lamp.compiler.msil.Type" class="keyword">match</span> <span class="delimiter">{</span>
            <span class="keyword">case</span> <span title="ch.epfl.lamp.compiler.msil.Type">REFERENCE</span><span class="delimiter">(</span>_<span class="delimiter">)</span> | ARRAY<span class="delimiter">(</span>_<span class="delimiter">)</span> =&gt; <a href="../../symtab/clr/CLRTypes.scala.html#601610" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MOBJECT</a>
            <span class="keyword">case</span> <span title="ch.epfl.lamp.compiler.msil.Type">_</span> =&gt; <a href="#636762" title="(t: GenMSIL.this.global.icodes.TypeKind)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">(</span><a href="#643236" title="GenMSIL.this.global.icodes.TypeKind">el</a><span class="delimiter">)</span>
          <span class="delimiter">}</span>

          <span class="keyword">val</span> <a title="Array[ch.epfl.lamp.compiler.msil.Type]" id="643238">argTypes</a>:<a href="../../../../Array.scala.html#1430" title="Array[ch.epfl.lamp.compiler.msil.Type]">Array</a><span class="delimiter">[</span>MsilType<span class="delimiter">]</span> = <a href="../../../../Array.scala.html#62681" title="(xs: ch.epfl.lamp.compiler.msil.Type*)(implicit evidence$2: scala.reflect.ClassManifest[ch.epfl.lamp.compiler.msil.Type])Array[ch.epfl.lamp.compiler.msil.Type]">Array</a><a href="../../../../reflect/ClassManifest.scala.html#56840" title="(clazz: java.lang.Class[_])scala.reflect.ClassManifest[ch.epfl.lamp.compiler.msil.Type]" class="delimiter">(</a><a href="#643237" title="ch.epfl.lamp.compiler.msil.Type">elemType</a><span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.MethodInfo" id="643239">stringBuilderAppend</a> = <a href="#636622" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MSTRING_BUILDER</a>.<span title="(x$1: java.lang.String, x$2: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.MethodInfo">GetMethod</span><span class="delimiter">(</span><span title="java.lang.String(&quot;Append&quot;)" class="string">&quot;Append&quot;</span>, <a href="#643238" title="Array[ch.epfl.lamp.compiler.msil.Type]">argTypes</a> <span class="delimiter">)</span>
          <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Callvirt</span>,  <a href="#643239" title="ch.epfl.lamp.compiler.msil.MethodInfo">stringBuilderAppend</a><span class="delimiter">)</span>

        <span class="keyword">case</span> <a href="../icode/Primitives.scala.html#501373" title="Unit">EndConcat</a> =&gt;
          <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Callvirt</span>, <a href="#636626" title="=&gt; ch.epfl.lamp.compiler.msil.MethodInfo">MSTRING_BUILDER_TOSTRING</a><span class="delimiter">)</span>

        <span class="keyword">case</span> <span title="Nothing">_</span> =&gt;
          <a href="../../symtab/SymbolTable.scala.html#478159" title="(msg: String)Nothing">abort</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Unimplemented primitive &quot;)" class="string">&quot;Unimplemented primitive &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#641786" title="GenMSIL.this.global.icodes.Primitive">primitive</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span> <span class="comment">// end genPrimitive</span>


    <span class="comment">////////////////////// loading ///////////////////////</span>

    <span class="keyword">def</span> <a title="(value: Int, code: ch.epfl.lamp.compiler.msil.emit.ILGenerator)Unit" id="636742">loadI4</a><span class="delimiter">(</span><a title="Int" id="641302">value</a>: <a href="../../../../Int.scala.html#386" title="Int">Int</a>, <a title="ch.epfl.lamp.compiler.msil.emit.ILGenerator" id="641303">code</a>: <span title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">ILGenerator</span><span class="delimiter">)</span>: <a href="../../../../Unit.scala.html#461" title="Unit">Unit</a> = <a href="#641302" title="Int">value</a> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <span title="Unit">-</span><span class="int">1</span> =&gt; <a href="#641303" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldc_I4_M1</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="Unit" class="int">0</span>  =&gt; <a href="#641303" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldc_I4_0</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="Unit" class="int">1</span>  =&gt; <a href="#641303" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldc_I4_1</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="Unit" class="int">2</span>  =&gt; <a href="#641303" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldc_I4_2</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="Unit" class="int">3</span>  =&gt; <a href="#641303" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldc_I4_3</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="Unit" class="int">4</span>  =&gt; <a href="#641303" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldc_I4_4</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="Unit" class="int">5</span>  =&gt; <a href="#641303" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldc_I4_5</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="Unit" class="int">6</span>  =&gt; <a href="#641303" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldc_I4_6</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="Unit" class="int">7</span>  =&gt; <a href="#641303" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldc_I4_7</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="Unit" class="int">8</span>  =&gt; <a href="#641303" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldc_I4_8</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="Unit">_</span>  =&gt;
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#641302" title="Int">value</a> <a href="../../../../Int.scala.html#54782" title="(x: Int)Boolean">&gt;=</a> -<span title="Int(-128)" class="int">128</span> <a href="../../../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#641302" title="Int">value</a> <a href="../../../../Int.scala.html#54768" title="(x: Int)Boolean">&lt;=</a> <span title="Int(127)" class="int">127</span><span class="delimiter">)</span>
          <a href="#641303" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: Int)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldc_I4_S</span>, <a href="#641302" title="Int">value</a><span class="delimiter">)</span>
        <span class="keyword">else</span>
          <a href="#641303" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: Int)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldc_I4</span>, <a href="#641302" title="Int">value</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="(code: ch.epfl.lamp.compiler.msil.emit.ILGenerator, loadAddr: Boolean)(i: Int)Unit" id="636743">loadArg</a><span class="delimiter">(</span><a title="ch.epfl.lamp.compiler.msil.emit.ILGenerator" id="641083">code</a>: <span title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">ILGenerator</span>, <a title="Boolean" id="641084">loadAddr</a>: <a href="../../../../Boolean.scala.html#65" title="Boolean">Boolean</a><span class="delimiter">)</span><span class="delimiter">(</span><a title="Int" id="641085">i</a>: <a href="../../../../Int.scala.html#386" title="Int">Int</a><span class="delimiter">)</span> =
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#641084" title="Boolean">loadAddr</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#641085" title="Int">i</a> <a href="../../../../Int.scala.html#54782" title="(x: Int)Boolean">&gt;=</a> -<span title="Int(-128)" class="int">128</span> <a href="../../../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#641085" title="Int">i</a> <a href="../../../../Int.scala.html#54768" title="(x: Int)Boolean">&lt;=</a> <span title="Int(127)" class="int">127</span><span class="delimiter">)</span>
          <a href="#641083" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: Int)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldarga_S</span>, <a href="#641085" title="Int">i</a><span class="delimiter">)</span>
        <span class="keyword">else</span>
          <a href="#641083" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: Int)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldarga</span>, <a href="#641085" title="Int">i</a><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
        <a href="#641085" title="Int">i</a> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> <span title="Unit" class="int">0</span> =&gt; <a href="#641083" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldarg_0</span><span class="delimiter">)</span>
          <span class="keyword">case</span> <span title="Unit" class="int">1</span> =&gt; <a href="#641083" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldarg_1</span><span class="delimiter">)</span>
          <span class="keyword">case</span> <span title="Unit" class="int">2</span> =&gt; <a href="#641083" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldarg_2</span><span class="delimiter">)</span>
          <span class="keyword">case</span> <span title="Unit" class="int">3</span> =&gt; <a href="#641083" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldarg_3</span><span class="delimiter">)</span>
          <span class="keyword">case</span> <span title="Unit">_</span>      =&gt;
            <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#641085" title="Int">i</a> <a href="../../../../Int.scala.html#54782" title="(x: Int)Boolean">&gt;=</a> -<span title="Int(-128)" class="int">128</span> <a href="../../../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#641085" title="Int">i</a> <a href="../../../../Int.scala.html#54768" title="(x: Int)Boolean">&lt;=</a> <span title="Int(127)" class="int">127</span><span class="delimiter">)</span>
              <a href="#641083" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: Int)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldarg_S</span>, <a href="#641085" title="Int">i</a><span class="delimiter">)</span>
            <span class="keyword">else</span>
              <a href="#641083" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: Int)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldarg</span>, <a href="#641085" title="Int">i</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="(i: Int, local: GenMSIL.this.global.icodes.Local, code: ch.epfl.lamp.compiler.msil.emit.ILGenerator, loadAddr: Boolean)Unit" id="636744">loadLocal</a><span class="delimiter">(</span><a title="Int" id="641128">i</a>: <a href="../../../../Int.scala.html#386" title="Int">Int</a>, <a title="GenMSIL.this.global.icodes.Local" id="641129">local</a>: <a href="../icode/Members.scala.html#501264" title="GenMSIL.this.global.icodes.Local">Local</a>, <a title="ch.epfl.lamp.compiler.msil.emit.ILGenerator" id="641130">code</a>: <span title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">ILGenerator</span>, <a title="Boolean" id="641131">loadAddr</a>: <a href="../../../../Boolean.scala.html#65" title="Boolean">Boolean</a><span class="delimiter">)</span> =
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#641131" title="Boolean">loadAddr</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#641128" title="Int">i</a> <a href="../../../../Int.scala.html#54782" title="(x: Int)Boolean">&gt;=</a> -<span title="Int(-128)" class="int">128</span> <a href="../../../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#641128" title="Int">i</a> <a href="../../../../Int.scala.html#54768" title="(x: Int)Boolean">&lt;=</a> <span title="Int(127)" class="int">127</span><span class="delimiter">)</span>
          <a href="#641130" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.emit.LocalBuilder)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldloca_S</span>, <a href="../../../../collection/MapLike.scala.html#73204" title="(key: GenMSIL.this.global.icodes.Local)ch.epfl.lamp.compiler.msil.emit.LocalBuilder">localBuilders</a><span class="delimiter">(</span><a href="#641129" title="GenMSIL.this.global.icodes.Local">local</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="keyword">else</span>
          <a href="#641130" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.emit.LocalBuilder)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldloca</span>, <a href="../../../../collection/MapLike.scala.html#73204" title="(key: GenMSIL.this.global.icodes.Local)ch.epfl.lamp.compiler.msil.emit.LocalBuilder">localBuilders</a><span class="delimiter">(</span><a href="#641129" title="GenMSIL.this.global.icodes.Local">local</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
        <a href="#641128" title="Int">i</a> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> <span title="Unit" class="int">0</span> =&gt; <a href="#641130" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldloc_0</span><span class="delimiter">)</span>
          <span class="keyword">case</span> <span title="Unit" class="int">1</span> =&gt; <a href="#641130" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldloc_1</span><span class="delimiter">)</span>
          <span class="keyword">case</span> <span title="Unit" class="int">2</span> =&gt; <a href="#641130" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldloc_2</span><span class="delimiter">)</span>
          <span class="keyword">case</span> <span title="Unit" class="int">3</span> =&gt; <a href="#641130" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldloc_3</span><span class="delimiter">)</span>
          <span class="keyword">case</span> <span title="Unit">_</span>      =&gt;
            <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#641128" title="Int">i</a> <a href="../../../../Int.scala.html#54782" title="(x: Int)Boolean">&gt;=</a> -<span title="Int(-128)" class="int">128</span> <a href="../../../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#641128" title="Int">i</a> <a href="../../../../Int.scala.html#54768" title="(x: Int)Boolean">&lt;=</a> <span title="Int(127)" class="int">127</span><span class="delimiter">)</span>
              <a href="#641130" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.emit.LocalBuilder)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldloc_S</span>, <a href="../../../../collection/MapLike.scala.html#73204" title="(key: GenMSIL.this.global.icodes.Local)ch.epfl.lamp.compiler.msil.emit.LocalBuilder">localBuilders</a><span class="delimiter">(</span><a href="#641129" title="GenMSIL.this.global.icodes.Local">local</a><span class="delimiter">)</span><span class="delimiter">)</span>
            <span class="keyword">else</span>
              <a href="#641130" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.emit.LocalBuilder)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldloc</span>, <a href="../../../../collection/MapLike.scala.html#73204" title="(key: GenMSIL.this.global.icodes.Local)ch.epfl.lamp.compiler.msil.emit.LocalBuilder">localBuilders</a><span class="delimiter">(</span><a href="#641129" title="GenMSIL.this.global.icodes.Local">local</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>

    <span class="comment">////////////////////// branches ///////////////////////</span>

    <span class="comment">/** Returns a Triple (Boolean, Boolean, Option[Label])
     *   - whether the jump leaves some exception block (try / catch / finally)
     *   - whether it leaves a finally handler (finally block, but not it's try / catch)
     *   - a label where to jump for leaving the finally handler
     *     . None to leave directly using `endfinally`
     *     . Some(label) to emit `leave label` (for try / catch inside a finally handler)
     */</span>
    <span class="keyword">def</span> <a title="(from: GenMSIL.this.global.icodes.BasicBlock, to: GenMSIL.this.global.icodes.BasicBlock)(Boolean, Boolean, Option[ch.epfl.lamp.compiler.msil.emit.Label])" id="636745">leavesHandler</a><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.BasicBlock" id="642996">from</a>: <a href="../icode/BasicBlocks.scala.html#501270" title="GenMSIL.this.global.icodes.BasicBlock">BasicBlock</a>, <a title="GenMSIL.this.global.icodes.BasicBlock" id="642997">to</a>: <a href="../icode/BasicBlocks.scala.html#501270" title="GenMSIL.this.global.icodes.BasicBlock">BasicBlock</a><span class="delimiter">)</span>: <a href="../../../../Tuple3.scala.html#317" title="(Boolean, Boolean, Option[ch.epfl.lamp.compiler.msil.emit.Label])" class="delimiter">(</a>Boolean, Boolean, Option<span class="delimiter">[</span>Label<span class="delimiter">]</span><span class="delimiter">)</span> =
      <span title="(Boolean, Boolean, Option[ch.epfl.lamp.compiler.msil.emit.Label])" class="keyword">if</span> <span class="delimiter">(</span><a href="#636722" title="=&gt; scala.collection.mutable.Stack[GenMSIL.this.global.icodes.ExceptionHandler]">currentHandlers</a>.<a href="../../../../collection/mutable/Stack.scala.html#301888" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <a href="../../../../Tuple3.scala.html#53296" title="(_1: Boolean, _2: Boolean, _3: None.type)(Boolean, Boolean, None.type)" class="delimiter">(</a><span title="Boolean(false)" class="keyword">false</span>, <span title="Boolean(false)" class="keyword">false</span>, <a href="../../../../Option.scala.html#1737" title="object None">None</a><span class="delimiter">)</span>
      <span class="keyword">else</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="GenMSIL.this.global.icodes.ExceptionHandler" id="643330">h</a> = <a href="#636722" title="=&gt; scala.collection.mutable.Stack[GenMSIL.this.global.icodes.ExceptionHandler]">currentHandlers</a>.<a href="../../../../collection/IterableLike.scala.html#53870" title="=&gt; GenMSIL.this.global.icodes.ExceptionHandler">head</a>
        <span class="keyword">val</span> <a title="Boolean" id="643331">leaveHead</a> = <span class="delimiter">{</span> <a href="#643330" title="GenMSIL.this.global.icodes.ExceptionHandler">h</a>.<a href="../icode/ExceptionHandlers.scala.html#599668" title="(b: GenMSIL.this.global.icodes.BasicBlock)Boolean">covers</a><span class="delimiter">(</span><a href="#642996" title="GenMSIL.this.global.icodes.BasicBlock">from</a><span class="delimiter">)</span> <a href="../../../../Boolean.scala.html#55578" title="(x: Boolean)Boolean">!=</a> <a href="#643330" title="GenMSIL.this.global.icodes.ExceptionHandler">h</a>.<a href="../icode/ExceptionHandlers.scala.html#599668" title="(b: GenMSIL.this.global.icodes.BasicBlock)Boolean">covers</a><span class="delimiter">(</span><a href="#642997" title="GenMSIL.this.global.icodes.BasicBlock">to</a><span class="delimiter">)</span> <a href="../../../../Boolean.scala.html#55579" title="(x: Boolean)Boolean">||</a>
                          <a href="#643330" title="GenMSIL.this.global.icodes.ExceptionHandler">h</a>.<a href="../icode/ExceptionHandlers.scala.html#599669" title="=&gt; List[GenMSIL.this.global.icodes.BasicBlock]">blocks</a>.<a href="../../../../collection/SeqLike.scala.html#54119" title="(elem: Any)Boolean">contains</a><span class="delimiter">(</span><a href="#642996" title="GenMSIL.this.global.icodes.BasicBlock">from</a><span class="delimiter">)</span> <a href="../../../../Boolean.scala.html#55578" title="(x: Boolean)Boolean">!=</a> <a href="#643330" title="GenMSIL.this.global.icodes.ExceptionHandler">h</a>.<a href="../icode/ExceptionHandlers.scala.html#599669" title="=&gt; List[GenMSIL.this.global.icodes.BasicBlock]">blocks</a>.<a href="../../../../collection/SeqLike.scala.html#54119" title="(elem: Any)Boolean">contains</a><span class="delimiter">(</span><a href="#642997" title="GenMSIL.this.global.icodes.BasicBlock">to</a><span class="delimiter">)</span> <span class="delimiter">}</span>
        <span title="(Boolean, Boolean, Option[ch.epfl.lamp.compiler.msil.emit.Label])" class="keyword">if</span> <span class="delimiter">(</span><a href="#643331" title="Boolean">leaveHead</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <span class="comment">// we leave the innermost exception block.</span>
          <span class="comment">// find out if we also leave som e `finally` handler</span>
          <a href="#636722" title="=&gt; scala.collection.mutable.Stack[GenMSIL.this.global.icodes.ExceptionHandler]">currentHandlers</a>.<a href="../../../../collection/IterableLike.scala.html#53861" title="(p: GenMSIL.this.global.icodes.ExceptionHandler =&gt; Boolean)Option[GenMSIL.this.global.icodes.ExceptionHandler]">find</a><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.ExceptionHandler" id="643351">e</a> =&gt; <span class="delimiter">{</span>
            <a href="#643351" title="GenMSIL.this.global.icodes.ExceptionHandler">e</a>.<a href="../icode/ExceptionHandlers.scala.html#599647" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">cls</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../symtab/Symbols.scala.html#478667" title="object GenMSIL.this.global.NoSymbol">NoSymbol</a> <a href="../../../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#643351" title="GenMSIL.this.global.icodes.ExceptionHandler">e</a>.<a href="../icode/ExceptionHandlers.scala.html#599669" title="=&gt; List[GenMSIL.this.global.icodes.BasicBlock]">blocks</a>.<a href="../../../../collection/SeqLike.scala.html#54119" title="(elem: Any)Boolean">contains</a><span class="delimiter">(</span><a href="#642996" title="GenMSIL.this.global.icodes.BasicBlock">from</a><span class="delimiter">)</span> <a href="../../../../Boolean.scala.html#55578" title="(x: Boolean)Boolean">!=</a> <a href="#643351" title="GenMSIL.this.global.icodes.ExceptionHandler">e</a>.<a href="../icode/ExceptionHandlers.scala.html#599669" title="=&gt; List[GenMSIL.this.global.icodes.BasicBlock]">blocks</a>.<a href="../../../../collection/SeqLike.scala.html#54119" title="(elem: Any)Boolean">contains</a><span class="delimiter">(</span><a href="#642997" title="GenMSIL.this.global.icodes.BasicBlock">to</a><span class="delimiter">)</span>
          <span class="delimiter">}</span><span class="delimiter">)</span> <span title="(Boolean, Boolean, Option[ch.epfl.lamp.compiler.msil.emit.Label])" class="keyword">match</span> <span class="delimiter">{</span>
            <span class="keyword">case</span> <span title="(Boolean, Boolean, Option[ch.epfl.lamp.compiler.msil.emit.Label])">Some</span><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.ExceptionHandler" id="643362">finallyHandler</a><span class="delimiter">)</span> =&gt;
              <span title="(Boolean, Boolean, Option[ch.epfl.lamp.compiler.msil.emit.Label])" class="keyword">if</span> <span class="delimiter">(</span><a href="#643330" title="GenMSIL.this.global.icodes.ExceptionHandler">h</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#643362" title="GenMSIL.this.global.icodes.ExceptionHandler">finallyHandler</a><span class="delimiter">)</span> <span class="delimiter">{</span>
                <span class="comment">// the finally handler is the innermost, so we can emit `endfinally` directly</span>
                <a href="../../../../Tuple3.scala.html#53296" title="(_1: Boolean, _2: Boolean, _3: None.type)(Boolean, Boolean, None.type)" class="delimiter">(</a><span title="Boolean(true)" class="keyword">true</span>, <span title="Boolean(true)" class="keyword">true</span>, <a href="../../../../Option.scala.html#1737" title="object None">None</a><span class="delimiter">)</span>
              <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
                <span class="comment">// we need to `Leave` to the `endfinally` of the next outer finally handler</span>
                <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.Label" id="643376">l</a> = <a href="#636737" title="=&gt; scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.ExceptionHandler,ch.epfl.lamp.compiler.msil.emit.Label]">endFinallyLabels</a>.<a href="../../../../collection/mutable/MapLike.scala.html#73294" title="(key: GenMSIL.this.global.icodes.ExceptionHandler, op: =&gt; ch.epfl.lamp.compiler.msil.emit.Label)ch.epfl.lamp.compiler.msil.emit.Label">getOrElseUpdate</a><span class="delimiter">(</span><a href="#643362" title="GenMSIL.this.global.icodes.ExceptionHandler">finallyHandler</a>, <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="()ch.epfl.lamp.compiler.msil.emit.Label">DefineLabel</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
                <a href="../../../../Tuple3.scala.html#53296" title="(_1: Boolean, _2: Boolean, _3: Some[ch.epfl.lamp.compiler.msil.emit.Label])(Boolean, Boolean, Some[ch.epfl.lamp.compiler.msil.emit.Label])" class="delimiter">(</a><span title="Boolean(true)" class="keyword">true</span>, <span title="Boolean(true)" class="keyword">true</span>, <a href="../../../../Option.scala.html#57885" title="(x: ch.epfl.lamp.compiler.msil.emit.Label)Some[ch.epfl.lamp.compiler.msil.emit.Label]">Some</a><span class="delimiter">(</span><a href="#643376" title="ch.epfl.lamp.compiler.msil.emit.Label">l</a><span class="delimiter">)</span><span class="delimiter">)</span>
              <span class="delimiter">}</span>
            <span class="keyword">case</span> <a href="../../../../Option.scala.html#1737" title="(Boolean, Boolean, None.type)">None</a> =&gt;
              <a href="../../../../Tuple3.scala.html#53296" title="(_1: Boolean, _2: Boolean, _3: None.type)(Boolean, Boolean, None.type)" class="delimiter">(</a><span title="Boolean(true)" class="keyword">true</span>, <span title="Boolean(false)" class="keyword">false</span>, <a href="../../../../Option.scala.html#1737" title="object None">None</a><span class="delimiter">)</span>
          <span class="delimiter">}</span>
        <span class="delimiter">}</span> <span class="keyword">else</span> <a href="../../../../Tuple3.scala.html#53296" title="(_1: Boolean, _2: Boolean, _3: None.type)(Boolean, Boolean, None.type)" class="delimiter">(</a><span title="Boolean(false)" class="keyword">false</span>, <span title="Boolean(false)" class="keyword">false</span>, <a href="../../../../Option.scala.html#1737" title="object None">None</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="(block: GenMSIL.this.global.icodes.BasicBlock, cond: GenMSIL.this.global.icodes.TestOp, success: GenMSIL.this.global.icodes.BasicBlock, failure: GenMSIL.this.global.icodes.BasicBlock, next: GenMSIL.this.global.icodes.BasicBlock, emitBrFun: (GenMSIL.this.global.icodes.TestOp, ch.epfl.lamp.compiler.msil.emit.Label) =&gt; Unit)Unit" id="636746">emitCondBr</a><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.BasicBlock" id="643087">block</a>: <a href="../icode/BasicBlocks.scala.html#501270" title="GenMSIL.this.global.icodes.BasicBlock">BasicBlock</a>, <a title="GenMSIL.this.global.icodes.TestOp" id="643088">cond</a>: <a href="../icode/Primitives.scala.html#501383" title="GenMSIL.this.global.icodes.TestOp">TestOp</a>, <a title="GenMSIL.this.global.icodes.BasicBlock" id="643089">success</a>: <a href="../icode/BasicBlocks.scala.html#501270" title="GenMSIL.this.global.icodes.BasicBlock">BasicBlock</a>, <a title="GenMSIL.this.global.icodes.BasicBlock" id="643090">failure</a>: <a href="../icode/BasicBlocks.scala.html#501270" title="GenMSIL.this.global.icodes.BasicBlock">BasicBlock</a>,
                   <a title="GenMSIL.this.global.icodes.BasicBlock" id="643091">next</a>: <a href="../icode/BasicBlocks.scala.html#501270" title="GenMSIL.this.global.icodes.BasicBlock">BasicBlock</a>, <a title="(GenMSIL.this.global.icodes.TestOp, ch.epfl.lamp.compiler.msil.emit.Label) =&gt; Unit" id="643092">emitBrFun</a>: <span class="delimiter">(</span>TestOp, Label<span class="delimiter">)</span> =&gt; Unit<span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="keyword">val</span> <a href="../../../../Tuple3.scala.html#53296" title="(Boolean, Boolean, Option[ch.epfl.lamp.compiler.msil.emit.Label])" class="delimiter">(</a><a href="../../../../Tuple3.scala.html#53312" title="Boolean" id="643410">sLeaveHandler</a>, <a href="../../../../Tuple3.scala.html#53314" title="Boolean" id="643411">sLeaveFinally</a>, <a href="../../../../Tuple3.scala.html#53316" title="Option[ch.epfl.lamp.compiler.msil.emit.Label]" id="643412">slfTarget</a><span class="delimiter">)</span> = <a href="#636745" title="(from: GenMSIL.this.global.icodes.BasicBlock, to: GenMSIL.this.global.icodes.BasicBlock)(Boolean, Boolean, Option[ch.epfl.lamp.compiler.msil.emit.Label])">leavesHandler</a><a href="../../../../Tuple3.scala.html#317" title="(Boolean, Boolean, Option[ch.epfl.lamp.compiler.msil.emit.Label]) @unchecked" class="delimiter">(</a><a href="#643087" title="GenMSIL.this.global.icodes.BasicBlock">block</a>, <a href="#643089" title="GenMSIL.this.global.icodes.BasicBlock">success</a><span class="delimiter">)</span>
      <span class="keyword">val</span> <a href="../../../../Tuple3.scala.html#53296" title="(Boolean, Boolean, Option[ch.epfl.lamp.compiler.msil.emit.Label])" class="delimiter">(</a><a href="../../../../Tuple3.scala.html#53312" title="Boolean" id="643414">fLeaveHandler</a>, <a href="../../../../Tuple3.scala.html#53314" title="Boolean" id="643415">fLeaveFinally</a>, <a href="../../../../Tuple3.scala.html#53316" title="Option[ch.epfl.lamp.compiler.msil.emit.Label]" id="643416">flfTarget</a><span class="delimiter">)</span> = <a href="#636745" title="(from: GenMSIL.this.global.icodes.BasicBlock, to: GenMSIL.this.global.icodes.BasicBlock)(Boolean, Boolean, Option[ch.epfl.lamp.compiler.msil.emit.Label])">leavesHandler</a><a href="../../../../Tuple3.scala.html#317" title="(Boolean, Boolean, Option[ch.epfl.lamp.compiler.msil.emit.Label]) @unchecked" class="delimiter">(</a><a href="#643087" title="GenMSIL.this.global.icodes.BasicBlock">block</a>, <a href="#643090" title="GenMSIL.this.global.icodes.BasicBlock">failure</a><span class="delimiter">)</span>

      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#643410" title="Boolean">sLeaveHandler</a> <a href="../../../../Boolean.scala.html#55579" title="(x: Boolean)Boolean">||</a> <a href="#643414" title="Boolean">fLeaveHandler</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="Option[ch.epfl.lamp.compiler.msil.emit.Label]" id="643447">sLabelOpt</a> = <span title="Option[ch.epfl.lamp.compiler.msil.emit.Label]" class="keyword">if</span> <span class="delimiter">(</span><a href="#643410" title="Boolean">sLeaveHandler</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.Label" id="643448">leaveSLabel</a> = <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="()ch.epfl.lamp.compiler.msil.emit.Label">DefineLabel</span><span class="delimiter">(</span><span class="delimiter">)</span>
          <a href="../../../../Function2.scala.html#59852" title="(v1: GenMSIL.this.global.icodes.TestOp, v2: ch.epfl.lamp.compiler.msil.emit.Label)Unit">emitBrFun</a><span class="delimiter">(</span><a href="#643088" title="GenMSIL.this.global.icodes.TestOp">cond</a>, <a href="#643448" title="ch.epfl.lamp.compiler.msil.emit.Label">leaveSLabel</a><span class="delimiter">)</span>
          <a href="../../../../Option.scala.html#57885" title="(x: ch.epfl.lamp.compiler.msil.emit.Label)Some[ch.epfl.lamp.compiler.msil.emit.Label]">Some</a><span class="delimiter">(</span><a href="#643448" title="ch.epfl.lamp.compiler.msil.emit.Label">leaveSLabel</a><span class="delimiter">)</span>
        <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
          <a href="../../../../Function2.scala.html#59852" title="(v1: GenMSIL.this.global.icodes.TestOp, v2: ch.epfl.lamp.compiler.msil.emit.Label)Unit">emitBrFun</a><span class="delimiter">(</span><a href="#643088" title="GenMSIL.this.global.icodes.TestOp">cond</a>, <a href="../../../../collection/MapLike.scala.html#73204" title="(key: GenMSIL.this.global.icodes.BasicBlock)ch.epfl.lamp.compiler.msil.emit.Label">labels</a><span class="delimiter">(</span><a href="#643089" title="GenMSIL.this.global.icodes.BasicBlock">success</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <a href="../../../../Option.scala.html#1737" title="object None">None</a>
        <span class="delimiter">}</span>

        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#643414" title="Boolean">fLeaveHandler</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#643415" title="Boolean">fLeaveFinally</a><span class="delimiter">)</span> <span class="delimiter">{</span>
            <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#643416" title="Option[ch.epfl.lamp.compiler.msil.emit.Label]">flfTarget</a>.<a href="../../../../Option.scala.html#48472" title="=&gt; Boolean">isDefined</a><span class="delimiter">)</span> <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, label: ch.epfl.lamp.compiler.msil.emit.Label)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Leave</span>, <a href="#643416" title="Option[ch.epfl.lamp.compiler.msil.emit.Label]">flfTarget</a>.<a href="../../../../Option.scala.html#48473" title="=&gt; ch.epfl.lamp.compiler.msil.emit.Label">get</a><span class="delimiter">)</span>
            <span class="keyword">else</span> <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Endfinally</span><span class="delimiter">)</span>
          <span class="delimiter">}</span> <span class="keyword">else</span>
            <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, label: ch.epfl.lamp.compiler.msil.emit.Label)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Leave</span>, <a href="../../../../collection/MapLike.scala.html#73204" title="(key: GenMSIL.this.global.icodes.BasicBlock)ch.epfl.lamp.compiler.msil.emit.Label">labels</a><span class="delimiter">(</span><a href="#643090" title="GenMSIL.this.global.icodes.BasicBlock">failure</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="delimiter">}</span> <span class="keyword">else</span>
          <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, label: ch.epfl.lamp.compiler.msil.emit.Label)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Br</span>, <a href="../../../../collection/MapLike.scala.html#73204" title="(key: GenMSIL.this.global.icodes.BasicBlock)ch.epfl.lamp.compiler.msil.emit.Label">labels</a><span class="delimiter">(</span><a href="#643090" title="GenMSIL.this.global.icodes.BasicBlock">failure</a><span class="delimiter">)</span><span class="delimiter">)</span>

        <a href="#643447" title="Option[ch.epfl.lamp.compiler.msil.emit.Label]">sLabelOpt</a>.<a href="../../../../Option.scala.html#48480" title="(f: ch.epfl.lamp.compiler.msil.emit.Label =&gt; Unit)Option[Unit]">map</a><span title="Unit" class="delimiter">(</span><a title="ch.epfl.lamp.compiler.msil.emit.Label" id="643528">l</a> =&gt; <span class="delimiter">{</span>
          <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(label: ch.epfl.lamp.compiler.msil.emit.Label)Unit">MarkLabel</span><span class="delimiter">(</span><a href="#643528" title="ch.epfl.lamp.compiler.msil.emit.Label">l</a><span class="delimiter">)</span>
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#643411" title="Boolean">sLeaveFinally</a><span class="delimiter">)</span> <span class="delimiter">{</span>
            <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#643412" title="Option[ch.epfl.lamp.compiler.msil.emit.Label]">slfTarget</a>.<a href="../../../../Option.scala.html#48472" title="=&gt; Boolean">isDefined</a><span class="delimiter">)</span> <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, label: ch.epfl.lamp.compiler.msil.emit.Label)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Leave</span>, <a href="#643412" title="Option[ch.epfl.lamp.compiler.msil.emit.Label]">slfTarget</a>.<a href="../../../../Option.scala.html#48473" title="=&gt; ch.epfl.lamp.compiler.msil.emit.Label">get</a><span class="delimiter">)</span>
            <span class="keyword">else</span> <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Endfinally</span><span class="delimiter">)</span>
          <span class="delimiter">}</span> <span class="keyword">else</span>
            <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, label: ch.epfl.lamp.compiler.msil.emit.Label)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Leave</span>, <a href="../../../../collection/MapLike.scala.html#73204" title="(key: GenMSIL.this.global.icodes.BasicBlock)ch.epfl.lamp.compiler.msil.emit.Label">labels</a><span class="delimiter">(</span><a href="#643089" title="GenMSIL.this.global.icodes.BasicBlock">success</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="delimiter">}</span><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#643091" title="GenMSIL.this.global.icodes.BasicBlock">next</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#643089" title="GenMSIL.this.global.icodes.BasicBlock">success</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="../../../../Function2.scala.html#59852" title="(v1: GenMSIL.this.global.icodes.TestOp, v2: ch.epfl.lamp.compiler.msil.emit.Label)Unit">emitBrFun</a><span class="delimiter">(</span><a href="#643088" title="GenMSIL.this.global.icodes.TestOp">cond</a>.<a href="../icode/Primitives.scala.html#599885" title="()GenMSIL.this.global.icodes.TestOp">negate</a>, <a href="../../../../collection/MapLike.scala.html#73204" title="(key: GenMSIL.this.global.icodes.BasicBlock)ch.epfl.lamp.compiler.msil.emit.Label">labels</a><span class="delimiter">(</span><a href="#643090" title="GenMSIL.this.global.icodes.BasicBlock">failure</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
          <a href="../../../../Function2.scala.html#59852" title="(v1: GenMSIL.this.global.icodes.TestOp, v2: ch.epfl.lamp.compiler.msil.emit.Label)Unit">emitBrFun</a><span class="delimiter">(</span><a href="#643088" title="GenMSIL.this.global.icodes.TestOp">cond</a>, <a href="../../../../collection/MapLike.scala.html#73204" title="(key: GenMSIL.this.global.icodes.BasicBlock)ch.epfl.lamp.compiler.msil.emit.Label">labels</a><span class="delimiter">(</span><a href="#643089" title="GenMSIL.this.global.icodes.BasicBlock">success</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#643091" title="GenMSIL.this.global.icodes.BasicBlock">next</a> <span title="(x$1: AnyRef)Boolean">!=</span> <a href="#643090" title="GenMSIL.this.global.icodes.BasicBlock">failure</a><span class="delimiter">)</span> <span class="delimiter">{</span>
            <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, label: ch.epfl.lamp.compiler.msil.emit.Label)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Br</span>, <a href="../../../../collection/MapLike.scala.html#73204" title="(key: GenMSIL.this.global.icodes.BasicBlock)ch.epfl.lamp.compiler.msil.emit.Label">labels</a><span class="delimiter">(</span><a href="#643090" title="GenMSIL.this.global.icodes.BasicBlock">failure</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <span class="delimiter">}</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="(condition: GenMSIL.this.global.icodes.TestOp, dest: ch.epfl.lamp.compiler.msil.emit.Label, isFloat: Boolean)Unit" id="636747">emitBr</a><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.TestOp" id="643083">condition</a>: <a href="../icode/Primitives.scala.html#501383" title="GenMSIL.this.global.icodes.TestOp">TestOp</a>, <a title="ch.epfl.lamp.compiler.msil.emit.Label" id="643084">dest</a>: <span title="ch.epfl.lamp.compiler.msil.emit.Label">Label</span>, <a title="Boolean" id="643085">isFloat</a>: <a href="../../../../Boolean.scala.html#65" title="Boolean">Boolean</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#643083" title="GenMSIL.this.global.icodes.TestOp">condition</a> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <a href="../icode/Primitives.scala.html#501384" title="Unit">EQ</a> =&gt; <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, label: ch.epfl.lamp.compiler.msil.emit.Label)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Beq</span>, <a href="#643084" title="ch.epfl.lamp.compiler.msil.emit.Label">dest</a><span class="delimiter">)</span>
        <span class="keyword">case</span> <a href="../icode/Primitives.scala.html#501386" title="Unit">NE</a> =&gt; <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, label: ch.epfl.lamp.compiler.msil.emit.Label)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Bne_Un</span>, <a href="#643084" title="ch.epfl.lamp.compiler.msil.emit.Label">dest</a><span class="delimiter">)</span>
        <span class="keyword">case</span> <a href="../icode/Primitives.scala.html#501388" title="Unit">LT</a> =&gt; <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, label: ch.epfl.lamp.compiler.msil.emit.Label)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCode" class="keyword">if</span> <span class="delimiter">(</span><a href="#643085" title="Boolean">isFloat</a><span class="delimiter">)</span> <span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Blt_Un</span> <span class="keyword">else</span> <span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Blt</span>, <a href="#643084" title="ch.epfl.lamp.compiler.msil.emit.Label">dest</a><span class="delimiter">)</span>
        <span class="keyword">case</span> <a href="../icode/Primitives.scala.html#501390" title="Unit">GE</a> =&gt; <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, label: ch.epfl.lamp.compiler.msil.emit.Label)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCode" class="keyword">if</span> <span class="delimiter">(</span><a href="#643085" title="Boolean">isFloat</a><span class="delimiter">)</span> <span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Bge_Un</span> <span class="keyword">else</span> <span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Bge</span>, <a href="#643084" title="ch.epfl.lamp.compiler.msil.emit.Label">dest</a><span class="delimiter">)</span>
        <span class="keyword">case</span> <a href="../icode/Primitives.scala.html#501392" title="Unit">LE</a> =&gt; <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, label: ch.epfl.lamp.compiler.msil.emit.Label)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCode" class="keyword">if</span> <span class="delimiter">(</span><a href="#643085" title="Boolean">isFloat</a><span class="delimiter">)</span> <span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ble_Un</span> <span class="keyword">else</span> <span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ble</span>, <a href="#643084" title="ch.epfl.lamp.compiler.msil.emit.Label">dest</a><span class="delimiter">)</span>
        <span class="keyword">case</span> <a href="../icode/Primitives.scala.html#501394" title="Unit">GT</a> =&gt; <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, label: ch.epfl.lamp.compiler.msil.emit.Label)Unit">Emit</span><span class="delimiter">(</span><span title="ch.epfl.lamp.compiler.msil.emit.OpCode" class="keyword">if</span> <span class="delimiter">(</span><a href="#643085" title="Boolean">isFloat</a><span class="delimiter">)</span> <span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Bgt_Un</span> <span class="keyword">else</span> <span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Bgt</span>, <a href="#643084" title="ch.epfl.lamp.compiler.msil.emit.Label">dest</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="(cond: GenMSIL.this.global.icodes.TestOp, dest: ch.epfl.lamp.compiler.msil.emit.Label)Unit" id="636748">emitBrBool</a><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.TestOp" id="643105">cond</a>: <a href="../icode/Primitives.scala.html#501383" title="GenMSIL.this.global.icodes.TestOp">TestOp</a>, <a title="ch.epfl.lamp.compiler.msil.emit.Label" id="643106">dest</a>: <span title="ch.epfl.lamp.compiler.msil.emit.Label">Label</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#643105" title="GenMSIL.this.global.icodes.TestOp">cond</a> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="comment">// EQ -&gt; Brfalse, NE -&gt; Brtrue; this is because we come from</span>
        <span class="comment">// a CZJUMP. If the value on the stack is 0 (e.g. a boolean</span>
        <span class="comment">// method returned false), and we are in the case EQ, then</span>
        <span class="comment">// we need to emit Brfalse (EQ Zero means false). vice versa</span>
        <span class="keyword">case</span> <a href="../icode/Primitives.scala.html#501384" title="Unit">EQ</a> =&gt; <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, label: ch.epfl.lamp.compiler.msil.emit.Label)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Brfalse</span>, <a href="#643106" title="ch.epfl.lamp.compiler.msil.emit.Label">dest</a><span class="delimiter">)</span>
        <span class="keyword">case</span> <a href="../icode/Primitives.scala.html#501386" title="Unit">NE</a> =&gt; <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, label: ch.epfl.lamp.compiler.msil.emit.Label)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Brtrue</span>, <a href="#643106" title="ch.epfl.lamp.compiler.msil.emit.Label">dest</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <span class="comment">////////////////////// local vars ///////////////////////</span>

    <span class="comment">/**
     * Compute the indexes of each local variable of the given
     * method.
     */</span>
    <span class="keyword">def</span> <a title="(m: GenMSIL.this.global.icodes.IMethod)Unit" id="636749">computeLocalVarsIndex</a><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.IMethod" id="640278">m</a>: <a href="../icode/Members.scala.html#501263" title="GenMSIL.this.global.icodes.IMethod">IMethod</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="keyword">var</span> <a title="Int" id="643644">idx</a> = <span title="Int" class="keyword">if</span> <span class="delimiter">(</span><a href="#640278" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#594468" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a>.<a href="../../symtab/Symbols.scala.html#509235" title="=&gt; Boolean">isStaticMember</a><span class="delimiter">)</span> <span title="Int(0)" class="int">0</span> <span class="keyword">else</span> <span title="Int(1)" class="int">1</span>

      <span class="keyword">val</span> <a title="List[GenMSIL.this.global.icodes.Local]" id="643645">params</a> = <a href="#640278" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#594492" title="=&gt; List[GenMSIL.this.global.icodes.Local]">params</a>
      <span class="keyword">for</span> <span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.Local" id="643666">l</a> &lt;- <a href="../../../../collection/LinearSeqOptimized.scala.html#71032" title="(f: GenMSIL.this.global.icodes.Local =&gt; Unit)Unit">params</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../Global.scala.html#478200" title="=&gt; scala.tools.nsc.Settings">settings</a>.<a href="../../settings/ScalaSettings.scala.html#469727" title="=&gt; scala.tools.nsc.Settings#BooleanSetting">debug</a>.<a href="../../settings/MutableSettings.scala.html#470030" title="=&gt; Boolean">value</a><span class="delimiter">)</span>
          <a href="../../Global.scala.html#478254" title="(msg: =&gt; AnyRef)Unit">log</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Index value for parameter &quot;)" class="string">&quot;Index value for parameter &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#643666" title="GenMSIL.this.global.icodes.Local">l</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;: &quot;)" class="string">&quot;: &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#643644" title="Int">idx</a><span class="delimiter">)</span>
        <a href="#643666" title="GenMSIL.this.global.icodes.Local">l</a>.<a href="../icode/Members.scala.html#594667" title="(x$1: Int)Unit">index</a> = <a href="#643644" title="Int">idx</a>
        <a href="#643644" title="Int">idx</a> <a href="../../../../Int.scala.html#54804" title="(x: Int)Int">+=</a> <span title="Int(1)" class="int">1</span> <span class="comment">// sizeOf(l.kind)</span>
      <span class="delimiter">}</span>

      <span class="keyword">val</span> <a title="List[GenMSIL.this.global.icodes.Local]" id="643646">locvars</a> = <a href="#640278" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#594489" title="=&gt; List[GenMSIL.this.global.icodes.Local]">locals</a> <a href="../../../../collection/TraversableLike.scala.html#49052" title="(p: GenMSIL.this.global.icodes.Local =&gt; Boolean)List[GenMSIL.this.global.icodes.Local]">filterNot</a> <span class="delimiter">(</span><a href="#643645" title="List[GenMSIL.this.global.icodes.Local]">params</a> <a href="../../../../collection/SeqLike.scala.html#54119" title="(elem: Any)Boolean">contains</a><span class="delimiter">)</span>
      <a href="#643644" title="Int">idx</a> = <span title="Int(0)" class="int">0</span>

      <span class="keyword">for</span> <span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.Local" id="643700">l</a> &lt;- <a href="../../../../collection/LinearSeqOptimized.scala.html#71032" title="(f: GenMSIL.this.global.icodes.Local =&gt; Unit)Unit">locvars</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../Global.scala.html#478200" title="=&gt; scala.tools.nsc.Settings">settings</a>.<a href="../../settings/ScalaSettings.scala.html#469727" title="=&gt; scala.tools.nsc.Settings#BooleanSetting">debug</a>.<a href="../../settings/MutableSettings.scala.html#470030" title="=&gt; Boolean">value</a><span class="delimiter">)</span>
          <a href="../../Global.scala.html#478254" title="(msg: =&gt; AnyRef)Unit">log</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Index value for local variable &quot;)" class="string">&quot;Index value for local variable &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#643700" title="GenMSIL.this.global.icodes.Local">l</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;: &quot;)" class="string">&quot;: &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#643644" title="Int">idx</a><span class="delimiter">)</span>
        <a href="#643700" title="GenMSIL.this.global.icodes.Local">l</a>.<a href="../icode/Members.scala.html#594667" title="(x$1: Int)Unit">index</a> = <a href="#643644" title="Int">idx</a>
        <a href="#643644" title="Int">idx</a> <a href="../../../../Int.scala.html#54804" title="(x: Int)Int">+=</a> <span title="Int(1)" class="int">1</span> <span class="comment">// sizeOf(l.kind)</span>
      <span class="delimiter">}</span>

    <span class="delimiter">}</span>

    <span class="comment">////////////////////// Utilities ////////////////////////</span>

    <span class="comment">/** Return the a name of this symbol that can be used on the .NET
     * platform. It removes spaces from names.
     *
     * Special handling: scala.All and scala.AllRef are 'erased' to
     * scala.All$ and scala.AllRef$. This is needed because they are
     * not real classes, and they mean 'abrupt termination upon evaluation
     * of that expression' or 'null' respectively. This handling is
     * done already in GenICode, but here we need to remove references
     * from method signatures to these types, because such classes can
     * not exist in the classpath: the type checker will be very confused.
     */</span>
    <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol)String" id="636750">msilName</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="637657">sym</a>: <a href="../../symtab/Symbols.scala.html#478659" title="GenMSIL.this.global.Symbol">Symbol</a><span class="delimiter">)</span>: <span title="String">String</span> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="String" id="643709">suffix</a>: <span title="String">String</span> = <span title="String" class="keyword">if</span> <span class="delimiter">(</span><a href="#637657" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/generic/HasFlags.scala.html#435325" title="=&gt; Boolean">hasModuleFlag</a> <a href="../../../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../../../Boolean.scala.html#55576" title="=&gt; Boolean">!</a><a href="#637657" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/generic/Symbols.scala.html#435384" title="=&gt; Boolean">isMethod</a> <a href="../../../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a>
                               <a href="../../../../Boolean.scala.html#55576" title="=&gt; Boolean">!</a><a href="#637657" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/generic/Symbols.scala.html#435382" title="=&gt; Boolean">isImplClass</a> <a href="../../../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a>
                               <a href="../../../../Boolean.scala.html#55576" title="=&gt; Boolean">!</a><a href="#637657" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/generic/HasFlags.scala.html#435334" title="=&gt; Boolean">isJavaDefined</a><span class="delimiter">)</span> <span title="java.lang.String(&quot;$&quot;)" class="string">&quot;$&quot;</span> <span class="keyword">else</span> <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span>
      <span class="comment">// Flags.JAVA: &quot;symbol was not defined by a scala-class&quot; (java, or .net-class)</span>

      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#637657" title="GenMSIL.this.global.Symbol">sym</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../symtab/Definitions.scala.html#479030" title="object GenMSIL.this.global.definitions">definitions</a>.<a href="../../symtab/Definitions.scala.html#507933" title="=&gt; GenMSIL.this.global.Symbol">NothingClass</a><span class="delimiter">)</span>
        <span title="Nothing" class="keyword">return</span> <span title="java.lang.String(&quot;scala.runtime.Nothing$&quot;)" class="string">&quot;scala.runtime.Nothing$&quot;</span>
      <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#637657" title="GenMSIL.this.global.Symbol">sym</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../symtab/Definitions.scala.html#479030" title="object GenMSIL.this.global.definitions">definitions</a>.<a href="../../symtab/Definitions.scala.html#507931" title="=&gt; GenMSIL.this.global.Symbol">NullClass</a><span class="delimiter">)</span>
        <span title="Nothing" class="keyword">return</span> <span title="java.lang.String(&quot;scala.runtime.Null$&quot;)" class="string">&quot;scala.runtime.Null$&quot;</span>

      <span class="delimiter">(</span><a href="../../../../Predef.scala.html#9681" title="implicit scala.Predef.any2stringadd : (x: Any)scala.runtime.StringAdd" class="keyword">if</a> <span class="delimiter">(</span><a href="#637657" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/generic/Symbols.scala.html#435371" title="=&gt; Boolean">isClass</a> <a href="../../../../Boolean.scala.html#55579" title="(x: Boolean)Boolean">||</a> <span class="delimiter">(</span><a href="#637657" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/generic/Symbols.scala.html#435386" title="=&gt; Boolean">isModule</a> <a href="../../../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../../../Boolean.scala.html#55576" title="=&gt; Boolean">!</a><a href="#637657" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/generic/Symbols.scala.html#435384" title="=&gt; Boolean">isMethod</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span title="java.lang.Object" class="keyword">if</span> <span class="delimiter">(</span><a href="#637657" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../symtab/Symbols.scala.html#509240" title="=&gt; Boolean">isNestedClass</a><span class="delimiter">)</span> <a href="#637657" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../symtab/Symbols.scala.html#509356" title="=&gt; GenMSIL.this.global.Name">simpleName</a>
        <span class="keyword">else</span> <a href="#637657" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/generic/Symbols.scala.html#435348" title="=&gt; String">fullName</a>
       <span class="delimiter">}</span> <span class="keyword">else</span>
         <a href="#637657" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../symtab/Symbols.scala.html#509356" title="=&gt; GenMSIL.this.global.Name">simpleName</a>.<a href="../../symtab/Names.scala.html#501123" title="()String">toString</a><span class="delimiter">(</span><span class="delimiter">)</span>.<span title="()java.lang.String">trim</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../../../runtime/StringAdd.scala.html#58450" title="(other: String)java.lang.String">+</a> <a href="#643709" title="String">suffix</a>
    <span class="delimiter">}</span>


    <span class="comment">////////////////////// flags ///////////////////////</span>

    <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol)Int" id="636751">msilTypeFlags</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="643735">sym</a>: <a href="../../symtab/Symbols.scala.html#478659" title="GenMSIL.this.global.Symbol">Symbol</a><span class="delimiter">)</span>: <a href="../../../../Int.scala.html#386" title="Int">Int</a> = <span class="delimiter">{</span>
      <span class="keyword">var</span> <a title="Int" id="643737">mf</a>: <a href="../../../../Int.scala.html#386" title="Int">Int</a> = TypeAttributes.AutoLayout <span title="Int(0)">|</span> TypeAttributes.AnsiClass

      <span title="Unit" class="keyword">if</span><span class="delimiter">(</span><a href="#643735" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../symtab/Symbols.scala.html#509240" title="=&gt; Boolean">isNestedClass</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#643737" title="Int">mf</a> = <a href="#643737" title="Int">mf</a> <a href="../../../../Int.scala.html#54789" title="(x: Int)Int">|</a> <span class="delimiter">(</span><span title="Int" class="keyword">if</span> <span class="delimiter">(</span><a href="#643735" title="GenMSIL.this.global.Symbol">sym</a> <a href="../../../../reflect/generic/Symbols.scala.html#435349" title="(mask: Long)Boolean">hasFlag</a> Flags.<span title="Long(4L)">PRIVATE</span><span class="delimiter">)</span> TypeAttributes.<span title="Int(3)">NestedPrivate</span> <span class="keyword">else</span> TypeAttributes.<span title="Int(2)">NestedPublic</span><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
        <a href="#643737" title="Int">mf</a> = <a href="#643737" title="Int">mf</a> <a href="../../../../Int.scala.html#54789" title="(x: Int)Int">|</a> <span class="delimiter">(</span><span title="Int" class="keyword">if</span> <span class="delimiter">(</span><a href="#643735" title="GenMSIL.this.global.Symbol">sym</a> <a href="../../../../reflect/generic/Symbols.scala.html#435349" title="(mask: Long)Boolean">hasFlag</a> Flags.<span title="Long(4L)">PRIVATE</span><span class="delimiter">)</span> TypeAttributes.<span title="Int(0)">NotPublic</span> <span class="keyword">else</span> TypeAttributes.<span title="Int(1)">Public</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
      <a href="#643737" title="Int">mf</a> = <a href="#643737" title="Int">mf</a> <a href="../../../../Int.scala.html#54789" title="(x: Int)Int">|</a> <span class="delimiter">(</span><span title="Int" class="keyword">if</span> <span class="delimiter">(</span><a href="#643735" title="GenMSIL.this.global.Symbol">sym</a> <a href="../../../../reflect/generic/Symbols.scala.html#435349" title="(mask: Long)Boolean">hasFlag</a> Flags.<span title="Long(8L)">ABSTRACT</span><span class="delimiter">)</span> TypeAttributes.<span title="Int(128)">Abstract</span> <span class="keyword">else</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
      <a href="#643737" title="Int">mf</a> = <a href="#643737" title="Int">mf</a> <a href="../../../../Int.scala.html#54789" title="(x: Int)Int">|</a> <span class="delimiter">(</span><span title="Int" class="keyword">if</span> <span class="delimiter">(</span><a href="#643735" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../symtab/Symbols.scala.html#509185" title="=&gt; Boolean">isTrait</a> <a href="../../../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../../../Boolean.scala.html#55576" title="=&gt; Boolean">!</a><a href="#643735" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/generic/Symbols.scala.html#435382" title="=&gt; Boolean">isImplClass</a><span class="delimiter">)</span> TypeAttributes.<span title="Int(32)">Interface</span> <span class="keyword">else</span> TypeAttributes.<span title="Int(0)">Class</span><span class="delimiter">)</span>
      <a href="#643737" title="Int">mf</a> = <a href="#643737" title="Int">mf</a> <a href="../../../../Int.scala.html#54789" title="(x: Int)Int">|</a> <span class="delimiter">(</span><span title="Int" class="keyword">if</span> <span class="delimiter">(</span><a href="#643735" title="GenMSIL.this.global.Symbol">sym</a> <a href="../../../../reflect/generic/HasFlags.scala.html#435297" title="=&gt; Boolean">isFinal</a><span class="delimiter">)</span> TypeAttributes.<span title="Int(256)">Sealed</span> <span class="keyword">else</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span>

      <a href="#643735" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../symtab/Symbols.scala.html#509116" title="=&gt; List[GenMSIL.this.global.AnnotationInfo]">annotations</a> <a href="../../../../collection/LinearSeqOptimized.scala.html#71032" title="(f: GenMSIL.this.global.AnnotationInfo =&gt; Unit)Unit">foreach</a> <span class="delimiter">{</span> <a title="GenMSIL.this.global.AnnotationInfo" id="643787">a</a> =&gt; <a href="#643787" title="GenMSIL.this.global.AnnotationInfo">a</a> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <span title="Unit">AnnotationInfo</span><span class="delimiter">(</span><a href="#636658" title="=&gt; GenMSIL.this.global.Type">SerializableAttr</a>, _, _<span class="delimiter">)</span> =&gt;
          <span class="comment">// TODO: add the Serializable TypeAttribute also if the annotation</span>
          <span class="comment">// System.SerializableAttribute is present (.net annotation, not scala)</span>
          <span class="comment">//  Best way to do it: compare with</span>
          <span class="comment">//  definitions.getClass(&quot;System.SerializableAttribute&quot;).tpe</span>
          <span class="comment">//  when frontend available</span>
          <a href="#643737" title="Int">mf</a> = <a href="#643737" title="Int">mf</a> <a href="../../../../Int.scala.html#54789" title="(x: Int)Int">|</a> TypeAttributes.<span title="Int(8192)">Serializable</span>
        <span class="keyword">case</span> <span title="Unit">_</span> =&gt; <span title="Unit" class="delimiter">(</span><span class="delimiter">)</span>
      <span class="delimiter">}</span><span class="delimiter">}</span>

      <a href="#643737" title="Int">mf</a>
      <span class="comment">// static: not possible (or?)</span>
    <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol)Short" id="636752">msilMethodFlags</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="643796">sym</a>: <a href="../../symtab/Symbols.scala.html#478659" title="GenMSIL.this.global.Symbol">Symbol</a><span class="delimiter">)</span>: <a href="../../../../Short.scala.html#2039" title="Short">Short</a> = <span class="delimiter">{</span>
      <span class="keyword">var</span> <a title="Int" id="643798">mf</a>: <a href="../../../../Int.scala.html#386" title="Int">Int</a> = MethodAttributes.<span title="Short(128)">HideBySig</span> <a href="../../../../Short.scala.html#54652" title="(x: Short)Int">|</a>
        <span class="delimiter">(</span><span title="Short" class="keyword">if</span> <span class="delimiter">(</span><a href="#643796" title="GenMSIL.this.global.Symbol">sym</a> <a href="../../../../reflect/generic/Symbols.scala.html#435349" title="(mask: Long)Boolean">hasFlag</a> Flags.<span title="Long(4L)">PRIVATE</span><span class="delimiter">)</span> MethodAttributes.<span title="Short(1)">Private</span>
         <span class="keyword">else</span> MethodAttributes.<span title="Short(6)">Public</span><span class="delimiter">)</span>

      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../../../Boolean.scala.html#55576" title="=&gt; Boolean">!</a><a href="#643796" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../symtab/Symbols.scala.html#509178" title="=&gt; Boolean">isClassConstructor</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#643796" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../symtab/Symbols.scala.html#509235" title="=&gt; Boolean">isStaticMember</a><span class="delimiter">)</span>
          <a href="#643798" title="Int">mf</a> = <a href="#643798" title="Int">mf</a> <a href="../../../../Int.scala.html#54787" title="(x: Short)Int">|</a> FieldAttributes.<span title="Short(16)">Static</span> <span class="comment">// coincidentally, same value as for MethodAttributes.Static ...</span>
        <span class="keyword">else</span> <span class="delimiter">{</span>
          <a href="#643798" title="Int">mf</a> = <a href="#643798" title="Int">mf</a> <a href="../../../../Int.scala.html#54787" title="(x: Short)Int">|</a> MethodAttributes.<span title="Short(64)">Virtual</span>
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#643796" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/generic/HasFlags.scala.html#435297" title="=&gt; Boolean">isFinal</a> <a href="../../../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../../../Boolean.scala.html#55576" title="=&gt; Boolean">!</a><a href="#636765" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.Type">getType</a><span class="delimiter">(</span><a href="#643796" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../symtab/Symbols.scala.html#509249" title="=&gt; GenMSIL.this.global.Symbol">owner</a><span class="delimiter">)</span>.<span title="()Boolean">IsInterface</span><span class="delimiter">)</span>
            <a href="#643798" title="Int">mf</a> = <a href="#643798" title="Int">mf</a> <a href="../../../../Int.scala.html#54787" title="(x: Short)Int">|</a> MethodAttributes.<span title="Short(32)">Final</span>
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#643796" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/generic/HasFlags.scala.html#435315" title="=&gt; Boolean">isDeferred</a> <a href="../../../../Boolean.scala.html#55579" title="(x: Boolean)Boolean">||</a> <a href="#636765" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.Type">getType</a><span class="delimiter">(</span><a href="#643796" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../symtab/Symbols.scala.html#509249" title="=&gt; GenMSIL.this.global.Symbol">owner</a><span class="delimiter">)</span>.<span title="()Boolean">IsInterface</span><span class="delimiter">)</span>
            <a href="#643798" title="Int">mf</a> = <a href="#643798" title="Int">mf</a> <a href="../../../../Int.scala.html#54787" title="(x: Short)Int">|</a> MethodAttributes.<span title="Short(1024)">Abstract</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>

      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#643796" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../symtab/Symbols.scala.html#509235" title="=&gt; Boolean">isStaticMember</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#643798" title="Int">mf</a> = <a href="#643798" title="Int">mf</a> <a href="../../../../Int.scala.html#54787" title="(x: Short)Int">|</a> MethodAttributes.<span title="Short(16)">Static</span>
      <span class="delimiter">}</span>

      <span class="comment">// constructors of module classes should be private</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#643796" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../symtab/Symbols.scala.html#509227" title="=&gt; Boolean">isPrimaryConstructor</a> <a href="../../../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#636771" title="(sym: GenMSIL.this.global.Symbol)Boolean">isTopLevelModule</a><span class="delimiter">(</span><a href="#643796" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../symtab/Symbols.scala.html#509249" title="=&gt; GenMSIL.this.global.Symbol">owner</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#643798" title="Int">mf</a> <a href="../../../../Int.scala.html#54787" title="(x: Short)Int">|=</a> MethodAttributes.<span title="Short(1)">Private</span>
        <a href="#643798" title="Int">mf</a> <a href="../../../../Int.scala.html#54794" title="(x: Int)Int">&amp;=</a> <a href="../../../../Short.scala.html#54601" title="=&gt; Int">~</a><span class="delimiter">(</span>MethodAttributes.<span title="Short(6)">Public</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>

      <a href="#643798" title="Int">mf</a>.<a href="../../../../Int.scala.html#54728" title="=&gt; Short">toShort</a>
    <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol)Short" id="636753">msilFieldFlags</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="643831">sym</a>: <a href="../../symtab/Symbols.scala.html#478659" title="GenMSIL.this.global.Symbol">Symbol</a><span class="delimiter">)</span>: <a href="../../../../Short.scala.html#2039" title="Short">Short</a> = <span class="delimiter">{</span>
      <span class="keyword">var</span> <a title="Int" id="643833">mf</a>: <a href="../../../../Int.scala.html#386" title="Int">Int</a> =
        <span title="Int" class="keyword">if</span> <span class="delimiter">(</span><a href="#643831" title="GenMSIL.this.global.Symbol">sym</a> <a href="../../../../reflect/generic/Symbols.scala.html#435349" title="(mask: Long)Boolean">hasFlag</a> Flags.<span title="Long(4L)">PRIVATE</span><span class="delimiter">)</span> FieldAttributes.<span title="Int(1)">Private</span>
        <span class="keyword">else</span> <span title="Int" class="keyword">if</span> <span class="delimiter">(</span><a href="#643831" title="GenMSIL.this.global.Symbol">sym</a> <a href="../../../../reflect/generic/Symbols.scala.html#435349" title="(mask: Long)Boolean">hasFlag</a> Flags.<span title="Long(1L)">PROTECTED</span><span class="delimiter">)</span> FieldAttributes.<span title="Int(5)">FamORAssem</span>
        <span class="keyword">else</span> FieldAttributes.<span title="Int(6)">Public</span>

      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#643831" title="GenMSIL.this.global.Symbol">sym</a> <a href="../../../../reflect/generic/Symbols.scala.html#435349" title="(mask: Long)Boolean">hasFlag</a> Flags.<span title="Long(32L)">FINAL</span><span class="delimiter">)</span>
        <a href="#643833" title="Int">mf</a> = <a href="#643833" title="Int">mf</a> <a href="../../../../Int.scala.html#54787" title="(x: Short)Int">|</a> FieldAttributes.<span title="Short(32)">InitOnly</span>

      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#643831" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../symtab/Symbols.scala.html#509235" title="=&gt; Boolean">isStaticMember</a><span class="delimiter">)</span>
        <a href="#643833" title="Int">mf</a> = <a href="#643833" title="Int">mf</a> <a href="../../../../Int.scala.html#54787" title="(x: Short)Int">|</a> FieldAttributes.<span title="Short(16)">Static</span>

      <span class="comment">// TRANSIENT: &quot;not serialized&quot;, VOLATILE: doesn't exist on .net</span>
      <span class="comment">// TODO: add this annotation also if the class has the custom attribute</span>
      <span class="comment">// System.NotSerializedAttribute</span>
      <a href="#643831" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../symtab/Symbols.scala.html#509116" title="=&gt; List[GenMSIL.this.global.AnnotationInfo]">annotations</a>.<a href="../../../../collection/LinearSeqOptimized.scala.html#71032" title="(f: GenMSIL.this.global.AnnotationInfo =&gt; Unit)Unit">foreach</a><span class="delimiter">(</span> <a title="GenMSIL.this.global.AnnotationInfo" id="643863">a</a> =&gt; <a href="#643863" title="GenMSIL.this.global.AnnotationInfo">a</a> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <span title="Unit">AnnotationInfo</span><span class="delimiter">(</span><a href="#636662" title="=&gt; GenMSIL.this.global.Type">TransientAtt</a>, _, _<span class="delimiter">)</span> =&gt;
          <a href="#643833" title="Int">mf</a> = <a href="#643833" title="Int">mf</a> <a href="../../../../Int.scala.html#54787" title="(x: Short)Int">|</a> FieldAttributes.<span title="Short(128)">NotSerialized</span>
        <span class="keyword">case</span> <span title="Unit">_</span> =&gt; <span title="Unit" class="delimiter">(</span><span class="delimiter">)</span>
      <span class="delimiter">}</span><span class="delimiter">)</span>

      <a href="#643833" title="Int">mf</a>.<a href="../../../../Int.scala.html#54728" title="=&gt; Short">toShort</a>
    <span class="delimiter">}</span>

    <span class="comment">////////////////////// builders, types ///////////////////////</span>

    <span class="keyword">var</span> <a title="GenMSIL.this.global.Symbol" id="636755">entryPoint</a>: <a href="../../symtab/Symbols.scala.html#478659" title="GenMSIL.this.global.Symbol">Symbol</a> = _

    <span class="keyword">val</span> <a title="scala.collection.mutable.HashSet[GenMSIL.this.global.Symbol]" id="636757">notInitializedModules</a>: <a href="../../../../collection/mutable/HashSet.scala.html#14593" title="scala.collection.mutable.HashSet[GenMSIL.this.global.Symbol]">HashSet</a><span class="delimiter">[</span>Symbol<span class="delimiter">]</span> = <a href="../../../../collection/mutable/HashSet.scala.html#108311" title="()scala.collection.mutable.HashSet[GenMSIL.this.global.Symbol]" class="keyword">new</a> <a href="../../../../collection/mutable/HashSet.scala.html#14593" title="scala.collection.mutable.HashSet[GenMSIL.this.global.Symbol]">HashSet</a><span class="delimiter">(</span><span class="delimiter">)</span>

    <span class="comment">// TODO: create fields also in def createType, and not in genClass,</span>
    <span class="comment">// add a getField method (it only works as it is because fields never</span>
    <span class="comment">// accessed from outside a class)</span>

    <span class="keyword">val</span> <a title="scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.Local,ch.epfl.lamp.compiler.msil.emit.LocalBuilder]" id="636759">localBuilders</a>: <a href="../../../../collection/mutable/HashMap.scala.html#14905" title="scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.Local,ch.epfl.lamp.compiler.msil.emit.LocalBuilder]">HashMap</a><span class="delimiter">[</span>Local, LocalBuilder<span class="delimiter">]</span> = <a href="../../../../collection/mutable/HashMap.scala.html#73156" title="()scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.Local,ch.epfl.lamp.compiler.msil.emit.LocalBuilder]" class="keyword">new</a> <a href="../../../../collection/mutable/HashMap.scala.html#14905" title="scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.Local,ch.epfl.lamp.compiler.msil.emit.LocalBuilder]">HashMap</a><span class="delimiter">(</span><span class="delimiter">)</span>

    <span class="keyword">private</span><span class="delimiter">[</span>GenMSIL<span class="delimiter">]</span> <span class="keyword">def</span> <a title="(cls: GenMSIL.this.global.icodes.IClass)Unit" id="636761">findEntryPoint</a><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.IClass" id="636821">cls</a>: <a href="../icode/Members.scala.html#501261" title="GenMSIL.this.global.icodes.IClass">IClass</a><span class="delimiter">)</span> <span class="delimiter">{</span>

      <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol)Boolean" id="643877">isEntryPoint</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="643878">sym</a>: <a href="../../symtab/Symbols.scala.html#478659" title="GenMSIL.this.global.Symbol">Symbol</a><span class="delimiter">)</span>:<a href="../../../../Boolean.scala.html#65" title="Boolean">Boolean</a> = <span class="delimiter">{</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#636772" title="(sym: GenMSIL.this.global.Symbol)Boolean">isStaticModule</a><span class="delimiter">(</span><a href="#643878" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../symtab/Symbols.scala.html#509249" title="=&gt; GenMSIL.this.global.Symbol">owner</a><span class="delimiter">)</span> <a href="../../../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#636750" title="(sym: GenMSIL.this.global.Symbol)String">msilName</a><span class="delimiter">(</span><a href="#643878" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span> <span title="(x$1: AnyRef)Boolean">==</span> <span title="java.lang.String(&quot;main&quot;)" class="string">&quot;main&quot;</span><span class="delimiter">)</span>
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#643878" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../symtab/Symbols.scala.html#509270" title="=&gt; GenMSIL.this.global.Type">tpe</a>.<a href="../../symtab/Types.scala.html#507181" title="=&gt; List[GenMSIL.this.global.Type]">paramTypes</a>.<a href="../../../../collection/LinearSeqOptimized.scala.html#71030" title="=&gt; Int">length</a> <a href="../../../../Int.scala.html#54747" title="(x: Int)Boolean">==</a> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span> <span class="delimiter">{</span>
            <a href="../icode/TypeKinds.scala.html#501327" title="(t: GenMSIL.this.global.icodes.global.Type)GenMSIL.this.global.icodes.TypeKind">toTypeKind</a><span class="delimiter">(</span><a href="#643878" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../symtab/Symbols.scala.html#509270" title="=&gt; GenMSIL.this.global.Type">tpe</a>.<a href="../../../../collection/LinearSeqOptimized.scala.html#71031" title="(n: Int)GenMSIL.this.global.Type">paramTypes</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span><span class="delimiter">)</span> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
              <span class="keyword">case</span> <span title="Unit">ARRAY</span><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.TypeKind" id="643899">elem</a><span class="delimiter">)</span> =&gt;
                <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#643899" title="GenMSIL.this.global.icodes.TypeKind">elem</a>.<a href="../icode/TypeKinds.scala.html#592710" title="=&gt; GenMSIL.this.global.icodes.global.Type">toType</a>.<a href="../../symtab/Types.scala.html#507159" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">typeSymbol</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../symtab/Definitions.scala.html#479030" title="object GenMSIL.this.global.definitions">definitions</a>.<a href="../../symtab/Definitions.scala.html#508005" title="=&gt; GenMSIL.this.global.Symbol">StringClass</a><span class="delimiter">)</span> <span class="delimiter">{</span>
                  <span title="Nothing" class="keyword">return</span> <span title="Boolean(true)" class="keyword">true</span>
                <span class="delimiter">}</span>
              <span class="keyword">case</span> <span title="Unit">_</span> =&gt; <span title="Unit" class="delimiter">(</span><span class="delimiter">)</span>
            <span class="delimiter">}</span>
          <span class="delimiter">}</span>
        <span title="Boolean(false)" class="keyword">false</span>
      <span class="delimiter">}</span>

      <span title="Unit" class="keyword">if</span><span class="delimiter">(</span><span class="delimiter">(</span><a href="#636755" title="=&gt; GenMSIL.this.global.Symbol">entryPoint</a> <span title="(x$1: AnyRef)Boolean">==</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <a href="../../../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../Global.scala.html#478259" title="object GenMSIL.this.global.opt">opt</a>.<a href="../../Global.scala.html#501760" title="=&gt; Option[GenMSIL.this.global.Name]">showClass</a>.<a href="../../../../Option.scala.html#48472" title="=&gt; Boolean">isDefined</a><span class="delimiter">)</span> <span class="delimiter">{</span>  <span class="comment">// TODO introduce dedicated setting instead</span>
        <span class="keyword">val</span> <a title="String" id="643911">entryclass</a> = <a href="../../Global.scala.html#478259" title="object GenMSIL.this.global.opt">opt</a>.<a href="../../Global.scala.html#501760" title="=&gt; Option[GenMSIL.this.global.Name]">showClass</a>.<a href="../../../../Option.scala.html#48473" title="=&gt; GenMSIL.this.global.Name">get</a>.<a href="../../symtab/Names.scala.html#501123" title="()String">toString</a>
        <span class="keyword">val</span> <a title="String" id="643912">cfn</a> = <a href="#636821" title="GenMSIL.this.global.icodes.IClass">cls</a>.<a href="../icode/Members.scala.html#501663" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a>.<a href="../../../../reflect/generic/Symbols.scala.html#435348" title="=&gt; String">fullName</a>
        <span title="Unit" class="keyword">if</span><span class="delimiter">(</span><a href="#643912" title="String">cfn</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#643911" title="String">entryclass</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <span class="keyword">for</span> <span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.IMethod" id="643930">m</a> &lt;- <a href="#636821" title="GenMSIL.this.global.icodes.IClass">cls</a>.<a href="../../../../collection/generic/FilterMonadic.scala.html#53496" title="(f: GenMSIL.this.global.icodes.IMethod =&gt; Unit)Unit">methods</a>; <span class="keyword">if</span> <a href="#643877" title="(sym: GenMSIL.this.global.Symbol)Boolean">isEntryPoint</a><span class="delimiter">(</span><a href="#643930" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#594468" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span> <a href="#636755" title="(x$1: GenMSIL.this.global.Symbol)Unit">entryPoint</a> = <a href="#643930" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#594468" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a> <span class="delimiter">}</span>
          <span title="Unit" class="keyword">if</span><span class="delimiter">(</span><a href="#636755" title="=&gt; GenMSIL.this.global.Symbol">entryPoint</a> <span title="(x$1: AnyRef)Boolean">==</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <span class="delimiter">{</span> <a href="../../Global.scala.html#478245" title="(msg: String)Unit">warning</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Couldn\'t find main method in class &quot;)" class="string">&quot;Couldn't find main method in class &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#643912" title="String">cfn</a><span class="delimiter">)</span> <span class="delimiter">}</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>

      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#636686" title="=&gt; java.lang.String">firstSourceName</a> <span title="(x$1: AnyRef)Boolean">==</span> <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#636821" title="GenMSIL.this.global.icodes.IClass">cls</a>.<a href="../icode/Members.scala.html#501663" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a>.<a href="../../symtab/Symbols.scala.html#509351" title="=&gt; scala.tools.nsc.io.AbstractFile">sourceFile</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <span class="comment">// is null for nested classes</span>
          <a href="#636686" title="(x$1: java.lang.String)Unit">firstSourceName</a> = <a href="#636821" title="GenMSIL.this.global.icodes.IClass">cls</a>.<a href="../icode/Members.scala.html#501663" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a>.<a href="../../symtab/Symbols.scala.html#509351" title="=&gt; scala.tools.nsc.io.AbstractFile">sourceFile</a>.<a href="../../io/AbstractFile.scala.html#501000" title="=&gt; String">name</a>
    <span class="delimiter">}</span>

    <span class="comment">// #####################################################################</span>
    <span class="comment">// get and create types</span>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(t: GenMSIL.this.global.icodes.TypeKind)ch.epfl.lamp.compiler.msil.Type" id="636762">msilType</a><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.TypeKind" id="640425">t</a>: <a href="../icode/TypeKinds.scala.html#501291" title="GenMSIL.this.global.icodes.TypeKind">TypeKind</a><span class="delimiter">)</span>: <span title="ch.epfl.lamp.compiler.msil.Type">MsilType</span> = <span class="delimiter">(</span><a href="#640425" title="GenMSIL.this.global.icodes.TypeKind">t</a>: @<a href="../icode/TypeKinds.scala.html#501291" title="GenMSIL.this.global.icodes.TypeKind @unchecked">unchecked</a><span class="delimiter">)</span> <span title="ch.epfl.lamp.compiler.msil.Type" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#501297" title="ch.epfl.lamp.compiler.msil.Type">UNIT</a>           =&gt; <a href="../../symtab/clr/CLRTypes.scala.html#601601" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MVOID</a>
      <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#501299" title="ch.epfl.lamp.compiler.msil.Type">BOOL</a>           =&gt; <a href="../../symtab/clr/CLRTypes.scala.html#601598" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MBOOL</a>
      <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#501301" title="ch.epfl.lamp.compiler.msil.Type">BYTE</a>           =&gt; <a href="../../symtab/clr/CLRTypes.scala.html#601565" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MBYTE</a>
      <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#501303" title="ch.epfl.lamp.compiler.msil.Type">SHORT</a>          =&gt; <a href="../../symtab/clr/CLRTypes.scala.html#601571" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MSHORT</a>
      <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#501305" title="ch.epfl.lamp.compiler.msil.Type">CHAR</a>           =&gt; <a href="../../symtab/clr/CLRTypes.scala.html#601577" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MCHAR</a>
      <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#501307" title="ch.epfl.lamp.compiler.msil.Type">INT</a>            =&gt; <a href="../../symtab/clr/CLRTypes.scala.html#601580" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MINT</a>
      <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#501309" title="ch.epfl.lamp.compiler.msil.Type">LONG</a>           =&gt; <a href="../../symtab/clr/CLRTypes.scala.html#601586" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MLONG</a>
      <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#501311" title="ch.epfl.lamp.compiler.msil.Type">FLOAT</a>          =&gt; <a href="../../symtab/clr/CLRTypes.scala.html#601592" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MFLOAT</a>
      <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#501313" title="ch.epfl.lamp.compiler.msil.Type">DOUBLE</a>         =&gt; <a href="../../symtab/clr/CLRTypes.scala.html#601595" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MDOUBLE</a>
      <span class="keyword">case</span> <span title="ch.epfl.lamp.compiler.msil.Type">REFERENCE</span><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.global.Symbol" id="643948">cls</a><span class="delimiter">)</span> =&gt; <a href="#636765" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.Type">getType</a><span class="delimiter">(</span><a href="#643948" title="GenMSIL.this.global.icodes.global.Symbol">cls</a><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="ch.epfl.lamp.compiler.msil.Type">ARRAY</span><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.TypeKind" id="643950">elem</a><span class="delimiter">)</span>    =&gt;
        <a href="#636762" title="(t: GenMSIL.this.global.icodes.TypeKind)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">(</span><a href="#643950" title="GenMSIL.this.global.icodes.TypeKind">elem</a><span class="delimiter">)</span> <span title="ch.epfl.lamp.compiler.msil.Type" class="keyword">match</span> <span class="delimiter">{</span>
          <span class="comment">// For type builders, cannot call &quot;clrTypes.mkArrayType&quot; because this looks up</span>
          <span class="comment">// the type &quot;tp&quot; in the assembly (not in the HashMap &quot;types&quot; of the backend).</span>
          <span class="comment">// This can fail for nested types because the builders are not complete yet.</span>
          <span class="keyword">case</span> <a title="ch.epfl.lamp.compiler.msil.Type" id="643957">tb</a>: <span title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">TypeBuilder</span> =&gt; <a href="#643957" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">tb</a>.<span title="()ch.epfl.lamp.compiler.msil.Type">MakeArrayType</span><span class="delimiter">(</span><span class="delimiter">)</span>
          <span class="keyword">case</span> <a title="ch.epfl.lamp.compiler.msil.Type" id="643958">tp</a>: <span title="ch.epfl.lamp.compiler.msil.Type">MsilType</span> =&gt; <a href="../../symtab/SymbolLoaders.scala.html#506452" title="object GenMSIL.this.global.loaders.clrTypes">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#601657" title="(elemType: ch.epfl.lamp.compiler.msil.Type)ch.epfl.lamp.compiler.msil.Type">mkArrayType</a><span class="delimiter">(</span><a href="#643958" title="ch.epfl.lamp.compiler.msil.Type">tp</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(tpe: GenMSIL.this.global.Type)ch.epfl.lamp.compiler.msil.Type" id="636763">msilType</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Type" id="640423">tpe</a>: <a href="../../symtab/Types.scala.html#478720" title="GenMSIL.this.global.Type">Type</a><span class="delimiter">)</span>: <span title="ch.epfl.lamp.compiler.msil.Type">MsilType</span> = <a href="#636762" title="(t: GenMSIL.this.global.icodes.TypeKind)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">(</span><a href="../icode/TypeKinds.scala.html#501327" title="(t: GenMSIL.this.global.icodes.global.Type)GenMSIL.this.global.icodes.TypeKind">toTypeKind</a><span class="delimiter">(</span><a href="#640423" title="GenMSIL.this.global.Type">tpe</a><span class="delimiter">)</span><span class="delimiter">)</span>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol)Array[ch.epfl.lamp.compiler.msil.Type]" id="636764">msilParamTypes</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="643965">sym</a>: <a href="../../symtab/Symbols.scala.html#478659" title="GenMSIL.this.global.Symbol">Symbol</a><span class="delimiter">)</span>: <a href="../../../../Array.scala.html#1430" title="Array[ch.epfl.lamp.compiler.msil.Type]">Array</a><span class="delimiter">[</span>MsilType<span class="delimiter">]</span> = <span class="delimiter">{</span>
      <a href="#643965" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../symtab/Symbols.scala.html#509270" title="=&gt; GenMSIL.this.global.Type">tpe</a>.<a href="../../symtab/Types.scala.html#507181" title="=&gt; List[GenMSIL.this.global.Type]">paramTypes</a>.<a href="../../../../collection/TraversableLike.scala.html#49041" title="(f: GenMSIL.this.global.Type =&gt; ch.epfl.lamp.compiler.msil.Type)(implicit bf: scala.collection.generic.CanBuildFrom[List[GenMSIL.this.global.Type],ch.epfl.lamp.compiler.msil.Type,List[ch.epfl.lamp.compiler.msil.Type]])List[ch.epfl.lamp.compiler.msil.Type]">map</a><a href="../../../../collection/immutable/List.scala.html#48868" title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.List.Coll,ch.epfl.lamp.compiler.msil.Type,List[ch.epfl.lamp.compiler.msil.Type]]" class="delimiter">(</a><a href="#636763" title="(tpe: GenMSIL.this.global.Type)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">)</span>.<a href="../../../../collection/TraversableOnce.scala.html#53687" title="(implicit evidence$1: ClassManifest[ch.epfl.lamp.compiler.msil.Type])Array[ch.epfl.lamp.compiler.msil.Type]">toArray</a>
    <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.Type" id="636765">getType</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="640160">sym</a>: <a href="../../symtab/Symbols.scala.html#478659" title="GenMSIL.this.global.Symbol">Symbol</a><span class="delimiter">)</span> = <a href="#636766" title="(sym: GenMSIL.this.global.Symbol)Option[ch.epfl.lamp.compiler.msil.Type]">getTypeOpt</a><span class="delimiter">(</span><a href="#640160" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span>.<a href="../../../../Option.scala.html#48474" title="(default: =&gt; ch.epfl.lamp.compiler.msil.Type)ch.epfl.lamp.compiler.msil.Type">getOrElse</a><span class="delimiter">(</span><a href="../../symtab/SymbolTable.scala.html#478159" title="(msg: String)Nothing">abort</a><span class="delimiter">(</span><a href="#636799" title="(sym: GenMSIL.this.global.Symbol)String">showsym</a><span class="delimiter">(</span><a href="#640160" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>

    <span class="comment">/**
     * Get an MSIL type from a symbol. First look in the clrTypes.types map, then
     * lookup the name using clrTypes.getType
     */</span>
    <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol)Option[ch.epfl.lamp.compiler.msil.Type]" id="636766">getTypeOpt</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="640163">sym</a>: <a href="../../symtab/Symbols.scala.html#478659" title="GenMSIL.this.global.Symbol">Symbol</a><span class="delimiter">)</span>: <a href="../../../../Option.scala.html#560" title="Option[ch.epfl.lamp.compiler.msil.Type]">Option</a><span class="delimiter">[</span>MsilType<span class="delimiter">]</span> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="Option[ch.epfl.lamp.compiler.msil.Type]" id="644040">tmp</a> = <a href="../../symtab/clr/CLRTypes.scala.html#601637" title="=&gt; scala.collection.mutable.Map[GenMSIL.this.global.loaders.clrTypes.global.Symbol,ch.epfl.lamp.compiler.msil.Type]">types</a>.<a href="../../../../collection/MapLike.scala.html#73194" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol)Option[ch.epfl.lamp.compiler.msil.Type]">get</a><span class="delimiter">(</span><a href="#640163" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span>
      <a href="#644040" title="Option[ch.epfl.lamp.compiler.msil.Type]">tmp</a> <span title="Option[ch.epfl.lamp.compiler.msil.Type]" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <a title="Some[ch.epfl.lamp.compiler.msil.Type]" id="644043">typ</a> @ Some<span class="delimiter">(</span>_<span class="delimiter">)</span> =&gt; <a href="#644043" title="Some[ch.epfl.lamp.compiler.msil.Type]">typ</a>
        <span class="keyword">case</span> <a href="../../../../Option.scala.html#1737" title="Option[ch.epfl.lamp.compiler.msil.Type]">None</a> =&gt;
          <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol)String" id="644045">typeString</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="644048">sym</a>: <a href="../../symtab/Symbols.scala.html#478659" title="GenMSIL.this.global.Symbol">Symbol</a><span class="delimiter">)</span>: <span title="String">String</span> = <span class="delimiter">{</span>
            <span class="keyword">val</span> <a title="java.lang.String" id="644049">s</a> = <span title="java.lang.String" class="keyword">if</span> <span class="delimiter">(</span><a href="#644048" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../symtab/Symbols.scala.html#509240" title="=&gt; Boolean">isNestedClass</a><span class="delimiter">)</span> <a href="#644045" title="(sym: GenMSIL.this.global.Symbol)String">typeString</a><span class="delimiter">(</span><a href="#644048" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../symtab/Symbols.scala.html#509249" title="=&gt; GenMSIL.this.global.Symbol">owner</a><span class="delimiter">)</span> <span title="(x$1: Any)java.lang.String">+</span><span title="java.lang.String(&quot;+&quot;)" class="string">&quot;+&quot;</span><span title="(x$1: Any)java.lang.String">+</span> <a href="#644048" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../symtab/Symbols.scala.html#509356" title="=&gt; GenMSIL.this.global.Name">simpleName</a>
                    <span class="keyword">else</span> <a href="#644048" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/generic/Symbols.scala.html#435348" title="=&gt; String">fullName</a>
            <span title="String" class="keyword">if</span> <span class="delimiter">(</span><a href="#644048" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/generic/Symbols.scala.html#435387" title="=&gt; Boolean">isModuleClass</a> <a href="../../../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../../../Boolean.scala.html#55576" title="=&gt; Boolean">!</a><a href="#644048" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../symtab/Symbols.scala.html#509185" title="=&gt; Boolean">isTrait</a><span class="delimiter">)</span> <a href="#644049" title="java.lang.String">s</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;$&quot;)" class="string">&quot;$&quot;</span> <span class="keyword">else</span> <a href="#644049" title="java.lang.String">s</a>
          <span class="delimiter">}</span>
          <span class="keyword">val</span> <a title="String" id="644046">name</a> = <a href="#644045" title="(sym: GenMSIL.this.global.Symbol)String">typeString</a><span class="delimiter">(</span><a href="#640163" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.Type" id="644047">typ</a> = <a href="../../symtab/SymbolLoaders.scala.html#506452" title="object GenMSIL.this.global.loaders.clrTypes">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#601655" title="(name: String)ch.epfl.lamp.compiler.msil.Type">getType</a><span class="delimiter">(</span><a href="#644046" title="String">name</a><span class="delimiter">)</span>
          <span title="Option[ch.epfl.lamp.compiler.msil.Type]" class="keyword">if</span> <span class="delimiter">(</span><a href="#644047" title="ch.epfl.lamp.compiler.msil.Type">typ</a> <span title="(x$1: AnyRef)Boolean">==</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span>
            <a href="../../../../Option.scala.html#1737" title="object None">None</a>
          <span class="keyword">else</span> <span class="delimiter">{</span>
            <a href="../../../../collection/mutable/MapLike.scala.html#73272" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol, value: ch.epfl.lamp.compiler.msil.Type)Unit">types</a><span class="delimiter">(</span><a href="#640163" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span> = <a href="#644047" title="ch.epfl.lamp.compiler.msil.Type">typ</a>
            <a href="../../../../Option.scala.html#57885" title="(x: ch.epfl.lamp.compiler.msil.Type)Some[ch.epfl.lamp.compiler.msil.Type]">Some</a><span class="delimiter">(</span><a href="#644047" title="ch.epfl.lamp.compiler.msil.Type">typ</a><span class="delimiter">)</span>
          <span class="delimiter">}</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol, mType: ch.epfl.lamp.compiler.msil.Type)Unit" id="636767">mapType</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="637638">sym</a>: <a href="../../symtab/Symbols.scala.html#478659" title="GenMSIL.this.global.Symbol">Symbol</a>, <a title="ch.epfl.lamp.compiler.msil.Type" id="637639">mType</a>: <span title="ch.epfl.lamp.compiler.msil.Type">MsilType</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="../../../../Predef.scala.html#9566" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a><span class="delimiter">(</span><a href="#637639" title="ch.epfl.lamp.compiler.msil.Type">mType</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span>, <a href="#636799" title="(sym: GenMSIL.this.global.Symbol)String">showsym</a><span class="delimiter">(</span><a href="#637638" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="../../../../collection/mutable/MapLike.scala.html#73272" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol, value: ch.epfl.lamp.compiler.msil.Type)Unit">types</a><span class="delimiter">(</span><a href="#637638" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span> = <a href="#637639" title="ch.epfl.lamp.compiler.msil.Type">mType</a>
    <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="(iclass: GenMSIL.this.global.icodes.IClass)Unit" id="636768">createTypeBuilder</a><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.IClass" id="636919">iclass</a>: <a href="../icode/Members.scala.html#501261" title="GenMSIL.this.global.icodes.IClass">IClass</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="comment">/**
       * First look in the clrTypes.types map, if that fails check if it's a class being compiled, otherwise
       * lookup by name (clrTypes.getType calls the static method msil.Type.GetType(fullname)).
       */</span>
      <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.Type" id="644067">msilTypeFromSym</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="644075">sym</a>: <a href="../../symtab/Symbols.scala.html#478659" title="GenMSIL.this.global.Symbol">Symbol</a><span class="delimiter">)</span>: <span title="ch.epfl.lamp.compiler.msil.Type">MsilType</span> = <span class="delimiter">{</span>
        <a href="../../symtab/clr/CLRTypes.scala.html#601637" title="=&gt; scala.collection.mutable.Map[GenMSIL.this.global.loaders.clrTypes.global.Symbol,ch.epfl.lamp.compiler.msil.Type]">types</a>.<a href="../../../../collection/MapLike.scala.html#73194" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol)Option[ch.epfl.lamp.compiler.msil.Type]">get</a><span class="delimiter">(</span><a href="#644075" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span>.<a href="../../../../Option.scala.html#48474" title="(default: =&gt; ch.epfl.lamp.compiler.msil.Type)ch.epfl.lamp.compiler.msil.Type">getOrElse</a> <span class="delimiter">{</span>
          <a href="../icode/ICodes.scala.html#501219" title="=&gt; scala.collection.mutable.HashMap[GenMSIL.this.global.icodes.global.Symbol,GenMSIL.this.global.icodes.IClass]">classes</a>.<a href="../../../../collection/mutable/HashMap.scala.html#73158" title="(key: GenMSIL.this.global.icodes.global.Symbol)Option[GenMSIL.this.global.icodes.IClass]">get</a><span class="delimiter">(</span><a href="#644075" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span> <span title="ch.epfl.lamp.compiler.msil.Type" class="keyword">match</span> <span class="delimiter">{</span>
            <span class="keyword">case</span> <span title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">Some</span><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.IClass" id="644082">iclass</a><span class="delimiter">)</span> =&gt;
	              <a href="#644068" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.emit.TypeBuilder">msilTypeBuilderFromSym</a><span class="delimiter">(</span><a href="#644075" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span>
            <span class="keyword">case</span> <a href="../../../../Option.scala.html#1737" title="ch.epfl.lamp.compiler.msil.Type">None</a> =&gt;
              <a href="#636765" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.Type">getType</a><span class="delimiter">(</span><a href="#644075" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span>
          <span class="delimiter">}</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>

      <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.emit.TypeBuilder" id="644068">msilTypeBuilderFromSym</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="644083">sym</a>: <a href="../../symtab/Symbols.scala.html#478659" title="GenMSIL.this.global.Symbol">Symbol</a><span class="delimiter">)</span>: <span title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">TypeBuilder</span> = <span class="delimiter">{</span>
        <span title="Unit" class="keyword">if</span><span class="delimiter">(</span><a href="../../../../Boolean.scala.html#55576" title="=&gt; Boolean">!</a><span class="delimiter">(</span><a href="../../symtab/clr/CLRTypes.scala.html#601637" title="=&gt; scala.collection.mutable.Map[GenMSIL.this.global.loaders.clrTypes.global.Symbol,ch.epfl.lamp.compiler.msil.Type]">types</a>.<a href="../../../../collection/MapLike.scala.html#73205" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol)Boolean">contains</a><span class="delimiter">(</span><a href="#644083" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span> <a href="../../../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../../../collection/MapLike.scala.html#73204" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol)ch.epfl.lamp.compiler.msil.Type">types</a><span class="delimiter">(</span><a href="#644083" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span>.<span title="[T0]=&gt; Boolean">isInstanceOf</span><span title="Boolean" class="delimiter">[</span><span title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">TypeBuilder</span><span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">{</span>
          <span class="keyword">val</span> <a title="GenMSIL.this.global.icodes.IClass" id="644101">iclass</a> = <a href="../../../../collection/MapLike.scala.html#73204" title="(key: GenMSIL.this.global.icodes.global.Symbol)GenMSIL.this.global.icodes.IClass">classes</a><span class="delimiter">(</span><a href="#644083" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span>
          <a href="../../../../Predef.scala.html#9565" title="(assertion: Boolean)Unit">assert</a><span class="delimiter">(</span><a href="#644101" title="GenMSIL.this.global.icodes.IClass">iclass</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span>
          <a href="#636768" title="(iclass: GenMSIL.this.global.icodes.IClass)Unit">createTypeBuilder</a><span class="delimiter">(</span><a href="#644101" title="GenMSIL.this.global.icodes.IClass">iclass</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
        <a href="../../../../collection/MapLike.scala.html#73204" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol)ch.epfl.lamp.compiler.msil.Type">types</a><span class="delimiter">(</span><a href="#644083" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder" class="delimiter">[</span><span title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">TypeBuilder</span><span class="delimiter">]</span>
      <span class="delimiter">}</span>

      <span class="keyword">val</span> <a title="GenMSIL.this.global.icodes.global.Symbol" id="644069">sym</a> = <a href="#636919" title="GenMSIL.this.global.icodes.IClass">iclass</a>.<a href="../icode/Members.scala.html#501663" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../symtab/clr/CLRTypes.scala.html#601637" title="=&gt; scala.collection.mutable.Map[GenMSIL.this.global.loaders.clrTypes.global.Symbol,ch.epfl.lamp.compiler.msil.Type]">types</a>.<a href="../../../../collection/MapLike.scala.html#73205" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol)Boolean">contains</a><span class="delimiter">(</span><a href="#644069" title="GenMSIL.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span> <a href="../../../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../../../collection/MapLike.scala.html#73204" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol)ch.epfl.lamp.compiler.msil.Type">types</a><span class="delimiter">(</span><a href="#644069" title="GenMSIL.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span>.<span title="[T0]=&gt; Boolean">isInstanceOf</span><span title="Boolean" class="delimiter">[</span><span title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">TypeBuilder</span><span class="delimiter">]</span><span class="delimiter">)</span>
        <span title="Nothing" class="keyword">return</span>

      <span class="keyword">def</span> <a title="(s: GenMSIL.this.global.Symbol)Boolean" id="644070">isInterface</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="644153">s</a>: <a href="../../symtab/Symbols.scala.html#478659" title="GenMSIL.this.global.Symbol">Symbol</a><span class="delimiter">)</span> = <a href="#644153" title="GenMSIL.this.global.Symbol">s</a>.<a href="../../symtab/Symbols.scala.html#509185" title="=&gt; Boolean">isTrait</a> <a href="../../../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../../../Boolean.scala.html#55576" title="=&gt; Boolean">!</a><a href="#644153" title="GenMSIL.this.global.Symbol">s</a>.<a href="../../../../reflect/generic/Symbols.scala.html#435382" title="=&gt; Boolean">isImplClass</a>
      <span class="keyword">val</span> <a title="List[GenMSIL.this.global.Type]" id="644071">parents</a>: <a href="../../../../collection/immutable/List.scala.html#14047" title="List[GenMSIL.this.global.Type]">List</a><span class="delimiter">[</span>Type<span class="delimiter">]</span> =
        <span title="List[GenMSIL.this.global.Type]" class="keyword">if</span> <span class="delimiter">(</span><a href="#644069" title="GenMSIL.this.global.icodes.global.Symbol">sym</a>.<a href="../../symtab/Symbols.scala.html#509272" title="=&gt; GenMSIL.this.global.icodes.global.Type">info</a>.<a href="../../symtab/Types.scala.html#507168" title="=&gt; List[GenMSIL.this.global.icodes.global.Type]">parents</a>.<a href="../../../../collection/IterableLike.scala.html#53862" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <a href="../../../../collection/immutable/List.scala.html#48877" title="(xs: GenMSIL.this.global.Type*)List[GenMSIL.this.global.Type]">List</a><span class="delimiter">(</span><a href="../../symtab/Definitions.scala.html#479030" title="object GenMSIL.this.global.definitions">definitions</a>.<a href="../../symtab/Definitions.scala.html#507925" title="=&gt; GenMSIL.this.global.Symbol">ObjectClass</a>.<a href="../../symtab/Symbols.scala.html#509270" title="=&gt; GenMSIL.this.global.Type">tpe</a><span class="delimiter">)</span>
        <span class="keyword">else</span> <a href="#644069" title="GenMSIL.this.global.icodes.global.Symbol">sym</a>.<a href="../../symtab/Symbols.scala.html#509272" title="=&gt; GenMSIL.this.global.icodes.global.Type">info</a>.<a href="../../symtab/Types.scala.html#507168" title="=&gt; List[GenMSIL.this.global.icodes.global.Type]">parents</a>.<a href="../../../../collection/SeqLike.scala.html#54140" title="=&gt; List[GenMSIL.this.global.icodes.global.Type]">distinct</a>

      <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.Type" id="644072">superType</a> : <span title="ch.epfl.lamp.compiler.msil.Type">MsilType</span> = <span title="ch.epfl.lamp.compiler.msil.Type" class="keyword">if</span> <span class="delimiter">(</span><a href="#644070" title="(s: GenMSIL.this.global.Symbol)Boolean">isInterface</a><span class="delimiter">(</span><a href="#644069" title="GenMSIL.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span><span class="delimiter">)</span> <span title="Null(null)" class="keyword">null</span> <span class="keyword">else</span> <a href="#644067" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.Type">msilTypeFromSym</a><span class="delimiter">(</span><a href="#644071" title="List[GenMSIL.this.global.Type]">parents</a>.<a href="../../../../collection/IterableLike.scala.html#53870" title="=&gt; GenMSIL.this.global.Type">head</a>.<a href="../../symtab/Types.scala.html#507159" title="=&gt; GenMSIL.this.global.Symbol">typeSymbol</a><span class="delimiter">)</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../Global.scala.html#478200" title="=&gt; scala.tools.nsc.Settings">settings</a>.<a href="../../settings/ScalaSettings.scala.html#469727" title="=&gt; scala.tools.nsc.Settings#BooleanSetting">debug</a>.<a href="../../settings/MutableSettings.scala.html#470030" title="=&gt; Boolean">value</a><span class="delimiter">)</span>
        <a href="../../Global.scala.html#478254" title="(msg: =&gt; AnyRef)Unit">log</a><span class="delimiter">(</span><span title="java.lang.String(&quot;super type: &quot;)" class="string">&quot;super type: &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="../../../../collection/LinearSeqOptimized.scala.html#71031" title="(n: Int)GenMSIL.this.global.Type">parents</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>.<a href="../../symtab/Types.scala.html#507159" title="=&gt; GenMSIL.this.global.Symbol">typeSymbol</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;, msil type: &quot;)" class="string">&quot;, msil type: &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#644072" title="ch.epfl.lamp.compiler.msil.Type">superType</a><span class="delimiter">)</span>

      <span class="keyword">val</span> <a title="Array[ch.epfl.lamp.compiler.msil.Type]" id="644073">interfaces</a>: <a href="../../../../Array.scala.html#1430" title="Array[ch.epfl.lamp.compiler.msil.Type]">Array</a><span class="delimiter">[</span>MsilType<span class="delimiter">]</span> =
	<a href="#644071" title="List[GenMSIL.this.global.Type]">parents</a>.<a href="../../../../collection/TraversableLike.scala.html#49082" title="=&gt; List[GenMSIL.this.global.Type]">tail</a>.<a href="../../../../collection/TraversableLike.scala.html#49041" title="(f: GenMSIL.this.global.Type =&gt; ch.epfl.lamp.compiler.msil.Type)(implicit bf: scala.collection.generic.CanBuildFrom[List[GenMSIL.this.global.Type],ch.epfl.lamp.compiler.msil.Type,List[ch.epfl.lamp.compiler.msil.Type]])List[ch.epfl.lamp.compiler.msil.Type]">map</a><a href="../../../../collection/immutable/List.scala.html#48868" title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.List.Coll,ch.epfl.lamp.compiler.msil.Type,List[ch.epfl.lamp.compiler.msil.Type]]" class="delimiter">(</a><a title="GenMSIL.this.global.Type" id="644194">p</a> =&gt; <a href="#644067" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.Type">msilTypeFromSym</a><span class="delimiter">(</span><a href="#644194" title="GenMSIL.this.global.Type">p</a>.<a href="../../symtab/Types.scala.html#507159" title="=&gt; GenMSIL.this.global.Symbol">typeSymbol</a><span class="delimiter">)</span><span class="delimiter">)</span>.<a href="../../../../collection/TraversableOnce.scala.html#53687" title="(implicit evidence$1: ClassManifest[ch.epfl.lamp.compiler.msil.Type])Array[ch.epfl.lamp.compiler.msil.Type]">toArray</a>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#644071" title="List[GenMSIL.this.global.Type]">parents</a>.<a href="../../../../collection/LinearSeqOptimized.scala.html#71030" title="=&gt; Int">length</a> <a href="../../../../Int.scala.html#54775" title="(x: Int)Boolean">&gt;</a> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../Global.scala.html#478200" title="=&gt; scala.tools.nsc.Settings">settings</a>.<a href="../../settings/ScalaSettings.scala.html#469727" title="=&gt; scala.tools.nsc.Settings#BooleanSetting">debug</a>.<a href="../../settings/MutableSettings.scala.html#470030" title="=&gt; Boolean">value</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="../../Global.scala.html#478254" title="(msg: =&gt; AnyRef)Unit">log</a><span class="delimiter">(</span><span title="java.lang.String(&quot;interfaces:&quot;)" class="string">&quot;interfaces:&quot;</span><span class="delimiter">)</span>
          <span class="keyword">for</span> <span class="delimiter">(</span><a title="Int" id="644346">i</a> &lt;- <a href="../../../../LowPriorityImplicits.scala.html#9474" title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">0</a>.<a href="../../../../runtime/RichInt.scala.html#54711" title="(end: Int)scala.collection.immutable.Range">until</a><a href="../../../../collection/immutable/Range.scala.html#63514" title="(f: Int =&gt; Unit)Unit" class="delimiter">(</a><a href="#644073" title="Array[ch.epfl.lamp.compiler.msil.Type]">interfaces</a>.<a href="../../../../Array.scala.html#49204" title="=&gt; Int">length</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
            <a href="../../Global.scala.html#478254" title="(msg: =&gt; AnyRef)Unit">log</a><span class="delimiter">(</span><span title="java.lang.String(&quot;  type: &quot;)" class="string">&quot;  type: &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="../../../../collection/LinearSeqOptimized.scala.html#71031" title="(n: Int)GenMSIL.this.global.Type">parents</a><span class="delimiter">(</span><a href="#644346" title="Int">i</a> <a href="../../../../Int.scala.html#54804" title="(x: Int)Int">+</a> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>.<a href="../../symtab/Types.scala.html#507159" title="=&gt; GenMSIL.this.global.Symbol">typeSymbol</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;, msil type: &quot;)" class="string">&quot;, msil type: &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="../../../../Array.scala.html#49205" title="(i: Int)ch.epfl.lamp.compiler.msil.Type">interfaces</a><span class="delimiter">(</span><a href="#644346" title="Int">i</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <span class="delimiter">}</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>

      <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder" id="644074">tBuilder</a> = <span title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder" class="keyword">if</span> <span class="delimiter">(</span><a href="#644069" title="GenMSIL.this.global.icodes.global.Symbol">sym</a>.<a href="../../symtab/Symbols.scala.html#509240" title="=&gt; Boolean">isNestedClass</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder" id="644360">ownerT</a> = <a href="#644068" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.emit.TypeBuilder">msilTypeBuilderFromSym</a><span class="delimiter">(</span><a href="#644069" title="GenMSIL.this.global.icodes.global.Symbol">sym</a>.<a href="../../symtab/Symbols.scala.html#509249" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">owner</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder" class="delimiter">[</span><span title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">TypeBuilder</span><span class="delimiter">]</span>
        <a href="#644360" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">ownerT</a>.<span title="(name: String, attributes: Int, baseType: ch.epfl.lamp.compiler.msil.Type, interfaces: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.emit.TypeBuilder">DefineNestedType</span><span class="delimiter">(</span><a href="#636750" title="(sym: GenMSIL.this.global.Symbol)String">msilName</a><span class="delimiter">(</span><a href="#644069" title="GenMSIL.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span>, <a href="#636751" title="(sym: GenMSIL.this.global.Symbol)Int">msilTypeFlags</a><span class="delimiter">(</span><a href="#644069" title="GenMSIL.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span>, <a href="#644072" title="ch.epfl.lamp.compiler.msil.Type">superType</a>, <a href="#644073" title="Array[ch.epfl.lamp.compiler.msil.Type]">interfaces</a><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
        <a href="#636677" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ModuleBuilder">mmodule</a>.<span title="(typeName: String, attributes: Int, baseType: ch.epfl.lamp.compiler.msil.Type, interfaces: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.emit.TypeBuilder">DefineType</span><span class="delimiter">(</span><a href="#636750" title="(sym: GenMSIL.this.global.Symbol)String">msilName</a><span class="delimiter">(</span><a href="#644069" title="GenMSIL.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span>, <a href="#636751" title="(sym: GenMSIL.this.global.Symbol)Int">msilTypeFlags</a><span class="delimiter">(</span><a href="#644069" title="GenMSIL.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span>, <a href="#644072" title="ch.epfl.lamp.compiler.msil.Type">superType</a>, <a href="#644073" title="Array[ch.epfl.lamp.compiler.msil.Type]">interfaces</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
      <a href="#636767" title="(sym: GenMSIL.this.global.Symbol, mType: ch.epfl.lamp.compiler.msil.Type)Unit">mapType</a><span class="delimiter">(</span><a href="#644069" title="GenMSIL.this.global.icodes.global.Symbol">sym</a>, <a href="#644074" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">tBuilder</a><span class="delimiter">)</span>
    <span class="delimiter">}</span> <span class="comment">// createTypeBuilder</span>

    <span class="keyword">def</span> <a title="(iclass: GenMSIL.this.global.icodes.IClass)Unit" id="636769">createClassMembers</a><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.IClass" id="636934">iclass</a>: <a href="../icode/Members.scala.html#501261" title="GenMSIL.this.global.icodes.IClass">IClass</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="keyword">try</span> <span class="delimiter">{</span>
        <a href="#636770" title="(iclass: GenMSIL.this.global.icodes.IClass)Unit">createClassMembers0</a><span class="delimiter">(</span><a href="#636934" title="GenMSIL.this.global.icodes.IClass">iclass</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
      <span class="keyword">catch</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <a title="Nothing" id="644365">e</a>: <span title="Throwable">Throwable</span> =&gt;
          java.lang.<span title="object java.lang.System">System</span>.<span title="java.io.PrintStream">err</span>.<span title="(x$1: java.lang.String)Unit">println</span><span class="delimiter">(</span><a href="#636799" title="(sym: GenMSIL.this.global.Symbol)String">showsym</a><span class="delimiter">(</span><a href="#636934" title="GenMSIL.this.global.icodes.IClass">iclass</a>.<a href="../icode/Members.scala.html#501663" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a><span class="delimiter">)</span><span class="delimiter">)</span>
          java.lang.<span title="object java.lang.System">System</span>.<span title="java.io.PrintStream">err</span>.<span title="(x$1: java.lang.String)Unit">println</span><span class="delimiter">(</span><span title="java.lang.String(&quot;with methods = &quot;)" class="string">&quot;with methods = &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#636934" title="GenMSIL.this.global.icodes.IClass">iclass</a>.<a href="../icode/Members.scala.html#501669" title="=&gt; List[GenMSIL.this.global.icodes.IMethod]">methods</a><span class="delimiter">)</span>
          <span title="Nothing" class="keyword">throw</span> <a href="#644365" title="java.lang.Throwable">e</a>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="(iclass: GenMSIL.this.global.icodes.IClass)Unit" id="636770">createClassMembers0</a><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.IClass" id="644363">iclass</a>: <a href="../icode/Members.scala.html#501261" title="GenMSIL.this.global.icodes.IClass">IClass</a><span class="delimiter">)</span> <span class="delimiter">{</span>

      <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder" id="644374">mtype</a> = <a href="#636765" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.Type">getType</a><span class="delimiter">(</span><a href="#644363" title="GenMSIL.this.global.icodes.IClass">iclass</a>.<a href="../icode/Members.scala.html#501663" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder" class="delimiter">[</span><span title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">TypeBuilder</span><span class="delimiter">]</span>

      <span class="keyword">for</span> <span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.IField" id="644400">ifield</a> &lt;- <a href="#644363" title="GenMSIL.this.global.icodes.IClass">iclass</a>.<a href="../../../../collection/LinearSeqOptimized.scala.html#71032" title="(f: GenMSIL.this.global.icodes.IField =&gt; Unit)Unit">fields</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="GenMSIL.this.global.icodes.global.Symbol" id="644401">sym</a> = <a href="#644400" title="GenMSIL.this.global.icodes.IField">ifield</a>.<a href="../icode/Members.scala.html#606745" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../Global.scala.html#478200" title="=&gt; scala.tools.nsc.Settings">settings</a>.<a href="../../settings/ScalaSettings.scala.html#469727" title="=&gt; scala.tools.nsc.Settings#BooleanSetting">debug</a>.<a href="../../settings/MutableSettings.scala.html#470030" title="=&gt; Boolean">value</a><span class="delimiter">)</span>
          <a href="../../Global.scala.html#478254" title="(msg: =&gt; AnyRef)Unit">log</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Adding field: &quot;)" class="string">&quot;Adding field: &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#644401" title="GenMSIL.this.global.icodes.global.Symbol">sym</a>.<a href="../../../../reflect/generic/Symbols.scala.html#435348" title="=&gt; String">fullName</a><span class="delimiter">)</span>

        <span class="keyword">var</span> <a title="Short" id="644402">attributes</a> = <a href="#636753" title="(sym: GenMSIL.this.global.Symbol)Short">msilFieldFlags</a><span class="delimiter">(</span><a href="#644401" title="GenMSIL.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.util.PECustomMod" id="644403">fieldTypeWithCustomMods</a> =
          <span title="ch.epfl.lamp.compiler.msil.util.PECustomMod" class="keyword">new</span> <span title="ch.epfl.lamp.compiler.msil.util.PECustomMod">PECustomMod</span><span class="delimiter">(</span><a href="#636763" title="(tpe: GenMSIL.this.global.Type)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">(</span><a href="#644401" title="GenMSIL.this.global.icodes.global.Symbol">sym</a>.<a href="../../symtab/Symbols.scala.html#509270" title="=&gt; GenMSIL.this.global.icodes.global.Type">tpe</a><span class="delimiter">)</span>,
                          <a href="#636700" title="(annotations: List[GenMSIL.this.global.AnnotationInfo])Array[ch.epfl.lamp.compiler.msil.CustomModifier]">customModifiers</a><span class="delimiter">(</span><a href="#644401" title="GenMSIL.this.global.icodes.global.Symbol">sym</a>.<a href="../../symtab/Symbols.scala.html#509116" title="=&gt; List[GenMSIL.this.global.icodes.global.AnnotationInfo]">annotations</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.FieldBuilder" id="644404">fBuilder</a> = <a href="#644374" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">mtype</a>.<span title="(name: String, fieldTypeWithMods: ch.epfl.lamp.compiler.msil.util.PECustomMod, attrs: Short)ch.epfl.lamp.compiler.msil.emit.FieldBuilder">DefineField</span><span class="delimiter">(</span><a href="#636750" title="(sym: GenMSIL.this.global.Symbol)String">msilName</a><span class="delimiter">(</span><a href="#644401" title="GenMSIL.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span>,
                                         <a href="#644403" title="ch.epfl.lamp.compiler.msil.util.PECustomMod">fieldTypeWithCustomMods</a>,
                                         <a href="#644402" title="Short">attributes</a><span class="delimiter">)</span>
        <a href="../../../../collection/mutable/MapLike.scala.html#73272" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol, value: ch.epfl.lamp.compiler.msil.FieldInfo)Unit">fields</a><span class="delimiter">(</span><a href="#644401" title="GenMSIL.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span> = <a href="#644404" title="ch.epfl.lamp.compiler.msil.emit.FieldBuilder">fBuilder</a>
        <a href="#636699" title="(member: ch.epfl.lamp.compiler.msil.emit.ICustomAttributeSetter, annotations: List[GenMSIL.this.global.AnnotationInfo])Unit">addAttributes</a><span class="delimiter">(</span><a href="#644404" title="ch.epfl.lamp.compiler.msil.emit.FieldBuilder">fBuilder</a>, <a href="#644401" title="GenMSIL.this.global.icodes.global.Symbol">sym</a>.<a href="../../symtab/Symbols.scala.html#509116" title="=&gt; List[GenMSIL.this.global.icodes.global.AnnotationInfo]">annotations</a><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="comment">// all iclass.fields iterated over</span>

      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#636772" title="(sym: GenMSIL.this.global.Symbol)Boolean">isStaticModule</a><span class="delimiter">(</span><a href="#644363" title="GenMSIL.this.global.icodes.IClass">iclass</a>.<a href="../icode/Members.scala.html#501663" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="Option[GenMSIL.this.global.icodes.IMethod]" id="644423">sc</a> = <a href="#644363" title="GenMSIL.this.global.icodes.IClass">iclass</a>.<a href="../icode/Members.scala.html#501685" title="=&gt; Option[GenMSIL.this.global.icodes.IMethod]">lookupStaticCtor</a>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#644423" title="Option[GenMSIL.this.global.icodes.IMethod]">sc</a>.<a href="../../../../Option.scala.html#48472" title="=&gt; Boolean">isDefined</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <span class="keyword">val</span> <a title="GenMSIL.this.global.icodes.IMethod" id="644424">m</a> = <a href="#644423" title="Option[GenMSIL.this.global.icodes.IMethod]">sc</a>.<a href="../../../../Option.scala.html#48473" title="=&gt; GenMSIL.this.global.icodes.IMethod">get</a>
          <span class="keyword">val</span> <a title="GenMSIL.this.global.icodes.BasicBlock" id="644425">oldLastBlock</a> = <a href="#644424" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#594471" title="=&gt; GenMSIL.this.global.icodes.Code">code</a>.<a href="../icode/Members.scala.html#594544" title="=&gt; scala.collection.mutable.ListBuffer[GenMSIL.this.global.icodes.BasicBlock]">blocks</a>.<a href="../../../../collection/generic/TraversableForwarder.scala.html#61985" title="=&gt; GenMSIL.this.global.icodes.BasicBlock">last</a>
          <span class="keyword">val</span> <a title="GenMSIL.this.global.icodes.BasicBlock" id="644426">lastBlock</a> = <a href="#644424" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#594471" title="=&gt; GenMSIL.this.global.icodes.Code">code</a>.<a href="../icode/Members.scala.html#594563" title="=&gt; GenMSIL.this.global.icodes.BasicBlock">newBlock</a>
          <a href="#644425" title="GenMSIL.this.global.icodes.BasicBlock">oldLastBlock</a>.<a href="../icode/BasicBlocks.scala.html#594416" title="(pos: Int, instr: GenMSIL.this.global.icodes.Instruction)Boolean">replaceInstruction</a><span class="delimiter">(</span><a href="#644425" title="GenMSIL.this.global.icodes.BasicBlock">oldLastBlock</a>.<a href="../icode/BasicBlocks.scala.html#594414" title="=&gt; Int">length</a> <a href="../../../../Int.scala.html#54811" title="(x: Int)Int">-</a> <span title="Int(1)" class="int">1</span>, <a href="../icode/Opcodes.scala.html#599224" title="(whereto: GenMSIL.this.global.icodes.BasicBlock)GenMSIL.this.global.icodes.opcodes.JUMP">JUMP</a><span class="delimiter">(</span><a href="#644426" title="GenMSIL.this.global.icodes.BasicBlock">lastBlock</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <span class="comment">// call object's private ctor from static ctor</span>
          <a href="#644426" title="GenMSIL.this.global.icodes.BasicBlock">lastBlock</a>.<a href="../icode/BasicBlocks.scala.html#594423" title="(instr: GenMSIL.this.global.icodes.Instruction)Unit">emit</a><span class="delimiter">(</span><a href="../icode/Opcodes.scala.html#604900" title="(method: GenMSIL.this.global.icodes.global.Symbol)GenMSIL.this.global.icodes.opcodes.CIL_NEWOBJ">CIL_NEWOBJ</a><span class="delimiter">(</span><a href="#644363" title="GenMSIL.this.global.icodes.IClass">iclass</a>.<a href="../icode/Members.scala.html#501663" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a>.<a href="../../symtab/Symbols.scala.html#509305" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">primaryConstructor</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <a href="#644426" title="GenMSIL.this.global.icodes.BasicBlock">lastBlock</a>.<a href="../icode/BasicBlocks.scala.html#594423" title="(instr: GenMSIL.this.global.icodes.Instruction)Unit">emit</a><span class="delimiter">(</span><a href="../icode/Opcodes.scala.html#603023" title="(typ: GenMSIL.this.global.icodes.TypeKind)GenMSIL.this.global.icodes.opcodes.DROP">DROP</a><span class="delimiter">(</span><a href="../icode/TypeKinds.scala.html#501327" title="(t: GenMSIL.this.global.icodes.global.Type)GenMSIL.this.global.icodes.TypeKind">toTypeKind</a><span class="delimiter">(</span><a href="#644363" title="GenMSIL.this.global.icodes.IClass">iclass</a>.<a href="../icode/Members.scala.html#501663" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a>.<a href="../../symtab/Symbols.scala.html#509270" title="=&gt; GenMSIL.this.global.icodes.global.Type">tpe</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
          <a href="#644426" title="GenMSIL.this.global.icodes.BasicBlock">lastBlock</a> <a href="../icode/BasicBlocks.scala.html#594423" title="(instr: GenMSIL.this.global.icodes.Instruction)Unit">emit</a> <a href="../icode/Opcodes.scala.html#599256" title="(kind: GenMSIL.this.global.icodes.TypeKind)GenMSIL.this.global.icodes.opcodes.RETURN">RETURN</a><span class="delimiter">(</span><a href="../icode/TypeKinds.scala.html#501297" title="object GenMSIL.this.global.icodes.UNIT">UNIT</a><span class="delimiter">)</span>
          <a href="#644426" title="GenMSIL.this.global.icodes.BasicBlock">lastBlock</a>.<a href="../icode/BasicBlocks.scala.html#594429" title="()Unit">close</a>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>

      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#644363" title="GenMSIL.this.global.icodes.IClass">iclass</a>.<a href="../icode/Members.scala.html#501663" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a> <span title="(x$1: AnyRef)Boolean">!=</span> <a href="../../symtab/Definitions.scala.html#479030" title="object GenMSIL.this.global.definitions">definitions</a>.<a href="../../symtab/Definitions.scala.html#508099" title="=&gt; GenMSIL.this.global.Symbol">ArrayClass</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="keyword">for</span> <span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.IMethod" id="644499">m</a>: <a href="../icode/Members.scala.html#501263" title="GenMSIL.this.global.icodes.IMethod">IMethod</a> &lt;- <a href="#644363" title="GenMSIL.this.global.icodes.IClass">iclass</a>.<a href="../../../../collection/LinearSeqOptimized.scala.html#71032" title="(f: GenMSIL.this.global.icodes.IMethod =&gt; Unit)Unit">methods</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="GenMSIL.this.global.icodes.global.Symbol" id="644500">sym</a> = <a href="#644499" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#594468" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../Global.scala.html#478200" title="=&gt; scala.tools.nsc.Settings">settings</a>.<a href="../../settings/ScalaSettings.scala.html#469727" title="=&gt; scala.tools.nsc.Settings#BooleanSetting">debug</a>.<a href="../../settings/MutableSettings.scala.html#470030" title="=&gt; Boolean">value</a><span class="delimiter">)</span>
          <a href="../../Global.scala.html#478254" title="(msg: =&gt; AnyRef)Unit">log</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Creating MethodBuilder for &quot;)" class="string">&quot;Creating MethodBuilder for &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="../../symtab/Flags.scala.html#36139" title="object scala.tools.nsc.symtab.Flags">Flags</a>.<a href="../../../../reflect/generic/Flags.scala.html#435634" title="(flags: Long)String">flagsToString</a><span class="delimiter">(</span><a href="#644500" title="GenMSIL.this.global.icodes.global.Symbol">sym</a>.<a href="../../symtab/Symbols.scala.html#509259" title="=&gt; Long">flags</a><span class="delimiter">)</span> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot; &quot;)" class="string">&quot; &quot;</span> <span title="(x$1: Any)java.lang.String">+</span>
              <a href="#644500" title="GenMSIL.this.global.icodes.global.Symbol">sym</a>.<a href="../../symtab/Symbols.scala.html#509249" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">owner</a>.<a href="../../../../reflect/generic/Symbols.scala.html#435348" title="=&gt; String">fullName</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;::&quot;)" class="string">&quot;::&quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#644500" title="GenMSIL.this.global.icodes.global.Symbol">sym</a>.<a href="../../symtab/Symbols.scala.html#509256" title="=&gt; GenMSIL.this.global.icodes.global.Name">name</a><span class="delimiter">)</span>

        <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder" id="644501">ownerType</a> = <a href="#636765" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.Type">getType</a><span class="delimiter">(</span><a href="#644500" title="GenMSIL.this.global.icodes.global.Symbol">sym</a>.<a href="../../../../reflect/generic/Symbols.scala.html#435409" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">enclClass</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder" class="delimiter">[</span><span title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">TypeBuilder</span><span class="delimiter">]</span>
        <a href="../../../../Predef.scala.html#9566" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a><span class="delimiter">(</span><a href="#644374" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">mtype</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#644501" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">ownerType</a>, <span title="java.lang.String(&quot;mtype = &quot;)" class="string">&quot;mtype = &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#644374" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">mtype</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;; ownerType = &quot;)" class="string">&quot;; ownerType = &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#644501" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">ownerType</a><span class="delimiter">)</span>
        <span class="keyword">var</span> <a title="Array[ch.epfl.lamp.compiler.msil.Type]" id="644502">paramTypes</a> = <a href="#636764" title="(sym: GenMSIL.this.global.Symbol)Array[ch.epfl.lamp.compiler.msil.Type]">msilParamTypes</a><span class="delimiter">(</span><a href="#644500" title="GenMSIL.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="Short" id="644503">attr</a> = <a href="#636752" title="(sym: GenMSIL.this.global.Symbol)Short">msilMethodFlags</a><span class="delimiter">(</span><a href="#644500" title="GenMSIL.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span>

        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#644499" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#594468" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a>.<a href="../../symtab/Symbols.scala.html#509178" title="=&gt; Boolean">isClassConstructor</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.ConstructorBuilder" id="644517">constr</a> =
            <a href="#644501" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">ownerType</a>.<span title="(attrs: Short, callingConvention: Short, paramTypes: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.emit.ConstructorBuilder">DefineConstructor</span><span class="delimiter">(</span><a href="#644503" title="Short">attr</a>, CallingConventions.<span title="Short(1)">Standard</span>, <a href="#644502" title="Array[ch.epfl.lamp.compiler.msil.Type]">paramTypes</a><span class="delimiter">)</span>
          <span class="keyword">for</span> <span class="delimiter">(</span><a title="Int" id="644624">i</a> &lt;- <a href="../../../../LowPriorityImplicits.scala.html#9474" title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">0</a>.<a href="../../../../runtime/RichInt.scala.html#54711" title="(end: Int)scala.collection.immutable.Range">until</a><a href="../../../../collection/immutable/Range.scala.html#63514" title="(f: Int =&gt; ch.epfl.lamp.compiler.msil.emit.ParameterBuilder)Unit" class="delimiter">(</a><a href="#644502" title="Array[ch.epfl.lamp.compiler.msil.Type]">paramTypes</a>.<a href="../../../../Array.scala.html#49204" title="=&gt; Int">length</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
            <a href="#644517" title="ch.epfl.lamp.compiler.msil.emit.ConstructorBuilder">constr</a>.<span title="(pos: Int, attr: Int, name: String)ch.epfl.lamp.compiler.msil.emit.ParameterBuilder">DefineParameter</span><span class="delimiter">(</span><a href="#644624" title="Int">i</a>, ParameterAttributes.<span title="Int(0)">None</span>, <a href="#636750" title="(sym: GenMSIL.this.global.Symbol)String">msilName</a><span class="delimiter">(</span><a href="#644499" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../../../../collection/LinearSeqOptimized.scala.html#71031" title="(n: Int)GenMSIL.this.global.icodes.Local">params</a><span class="delimiter">(</span><a href="#644624" title="Int">i</a><span class="delimiter">)</span>.<a href="../icode/Members.scala.html#594659" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <span class="delimiter">}</span>
          <a href="#636791" title="(sym: GenMSIL.this.global.Symbol, cInfo: ch.epfl.lamp.compiler.msil.ConstructorInfo)Unit">mapConstructor</a><span class="delimiter">(</span><a href="#644500" title="GenMSIL.this.global.icodes.global.Symbol">sym</a>, <a href="#644517" title="ch.epfl.lamp.compiler.msil.emit.ConstructorBuilder">constr</a><span class="delimiter">)</span>
          <a href="#636699" title="(member: ch.epfl.lamp.compiler.msil.emit.ICustomAttributeSetter, annotations: List[GenMSIL.this.global.AnnotationInfo])Unit">addAttributes</a><span class="delimiter">(</span><a href="#644517" title="ch.epfl.lamp.compiler.msil.emit.ConstructorBuilder">constr</a>, <a href="#644500" title="GenMSIL.this.global.icodes.global.Symbol">sym</a>.<a href="../../symtab/Symbols.scala.html#509116" title="=&gt; List[GenMSIL.this.global.icodes.global.AnnotationInfo]">annotations</a><span class="delimiter">)</span>
        <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
          <span class="keyword">var</span> <a title="ch.epfl.lamp.compiler.msil.Type" id="644640">resType</a> = <a href="#636762" title="(t: GenMSIL.this.global.icodes.TypeKind)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">(</span><a href="#644499" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#594483" title="=&gt; GenMSIL.this.global.icodes.TypeKind">returnType</a><span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder" id="644641">method</a> =
            <a href="#644501" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">ownerType</a>.<span title="(name: String, attrs: Short, returnType: ch.epfl.lamp.compiler.msil.Type, paramTypes: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.emit.MethodBuilder">DefineMethod</span><span class="delimiter">(</span><a href="#636750" title="(sym: GenMSIL.this.global.Symbol)String">msilName</a><span class="delimiter">(</span><a href="#644500" title="GenMSIL.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span>, <a href="#644503" title="Short">attr</a>, <a href="#644640" title="ch.epfl.lamp.compiler.msil.Type">resType</a>, <a href="#644502" title="Array[ch.epfl.lamp.compiler.msil.Type]">paramTypes</a><span class="delimiter">)</span>
          <span class="keyword">for</span> <span class="delimiter">(</span><a title="Int" id="644747">i</a> &lt;- <a href="../../../../LowPriorityImplicits.scala.html#9474" title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">0</a>.<a href="../../../../runtime/RichInt.scala.html#54711" title="(end: Int)scala.collection.immutable.Range">until</a><a href="../../../../collection/immutable/Range.scala.html#63514" title="(f: Int =&gt; ch.epfl.lamp.compiler.msil.emit.ParameterBuilder)Unit" class="delimiter">(</a><a href="#644502" title="Array[ch.epfl.lamp.compiler.msil.Type]">paramTypes</a>.<a href="../../../../Array.scala.html#49204" title="=&gt; Int">length</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
            <a href="#644641" title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder">method</a>.<span title="(pos: Int, attr: Int, name: String)ch.epfl.lamp.compiler.msil.emit.ParameterBuilder">DefineParameter</span><span class="delimiter">(</span><a href="#644747" title="Int">i</a>, ParameterAttributes.<span title="Int(0)">None</span>, <a href="#636750" title="(sym: GenMSIL.this.global.Symbol)String">msilName</a><span class="delimiter">(</span><a href="#644499" title="GenMSIL.this.global.icodes.IMethod">m</a>.<a href="../../../../collection/LinearSeqOptimized.scala.html#71031" title="(n: Int)GenMSIL.this.global.icodes.Local">params</a><span class="delimiter">(</span><a href="#644747" title="Int">i</a><span class="delimiter">)</span>.<a href="../icode/Members.scala.html#594659" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <span class="delimiter">}</span>
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../../../Boolean.scala.html#55576" title="=&gt; Boolean">!</a><a href="../../symtab/clr/CLRTypes.scala.html#601641" title="=&gt; scala.collection.mutable.Map[GenMSIL.this.global.loaders.clrTypes.global.Symbol,ch.epfl.lamp.compiler.msil.MethodInfo]">methods</a>.<a href="../../../../collection/MapLike.scala.html#73205" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol)Boolean">contains</a><span class="delimiter">(</span><a href="#644500" title="GenMSIL.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span><span class="delimiter">)</span>
            <a href="#636793" title="(sym: GenMSIL.this.global.Symbol, mInfo: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">mapMethod</a><span class="delimiter">(</span><a href="#644500" title="GenMSIL.this.global.icodes.global.Symbol">sym</a>, <a href="#644641" title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder">method</a><span class="delimiter">)</span>
          <a href="#636699" title="(member: ch.epfl.lamp.compiler.msil.emit.ICustomAttributeSetter, annotations: List[GenMSIL.this.global.AnnotationInfo])Unit">addAttributes</a><span class="delimiter">(</span><a href="#644641" title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder">method</a>, <a href="#644500" title="GenMSIL.this.global.icodes.global.Symbol">sym</a>.<a href="../../symtab/Symbols.scala.html#509116" title="=&gt; List[GenMSIL.this.global.icodes.global.AnnotationInfo]">annotations</a><span class="delimiter">)</span>
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../Global.scala.html#478200" title="=&gt; scala.tools.nsc.Settings">settings</a>.<a href="../../settings/ScalaSettings.scala.html#469727" title="=&gt; scala.tools.nsc.Settings#BooleanSetting">debug</a>.<a href="../../settings/MutableSettings.scala.html#470030" title="=&gt; Boolean">value</a><span class="delimiter">)</span>
            <a href="../../Global.scala.html#478254" title="(msg: =&gt; AnyRef)Unit">log</a><span class="delimiter">(</span><span title="java.lang.String(&quot;\011 created MethodBuilder &quot;)" class="string">&quot;\t created MethodBuilder &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#644641" title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder">method</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>
      <span class="delimiter">}</span> <span class="comment">// method builders created for non-array iclass</span>

      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#636772" title="(sym: GenMSIL.this.global.Symbol)Boolean">isStaticModule</a><span class="delimiter">(</span><a href="#644363" title="GenMSIL.this.global.icodes.IClass">iclass</a>.<a href="../icode/Members.scala.html#501663" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#636774" title="(sym: GenMSIL.this.global.Symbol)Unit">addModuleInstanceField</a><span class="delimiter">(</span><a href="#644363" title="GenMSIL.this.global.icodes.IClass">iclass</a>.<a href="../icode/Members.scala.html#501663" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a><span class="delimiter">)</span>
        <a href="#636757" title="=&gt; scala.collection.mutable.HashSet[GenMSIL.this.global.Symbol]">notInitializedModules</a> <a href="../../../../collection/mutable/HashSet.scala.html#108315" title="(elem: GenMSIL.this.global.Symbol)BytecodeGenerator.this.notInitializedModules.type">+=</a> <a href="#644363" title="GenMSIL.this.global.icodes.IClass">iclass</a>.<a href="../icode/Members.scala.html#501663" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#644363" title="GenMSIL.this.global.icodes.IClass">iclass</a>.<a href="../icode/Members.scala.html#501685" title="=&gt; Option[GenMSIL.this.global.icodes.IMethod]">lookupStaticCtor</a>.<a href="../../../../Option.scala.html#48471" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="#636778" title="(sym: GenMSIL.this.global.Symbol)Unit">addStaticInit</a><span class="delimiter">(</span><a href="#644363" title="GenMSIL.this.global.icodes.IClass">iclass</a>.<a href="../icode/Members.scala.html#501663" title="=&gt; GenMSIL.this.global.icodes.global.Symbol">symbol</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>

    <span class="delimiter">}</span> <span class="comment">// createClassMembers0</span>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol)Boolean" id="636771">isTopLevelModule</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="640233">sym</a>: <a href="../../symtab/Symbols.scala.html#478659" title="GenMSIL.this.global.Symbol">Symbol</a><span class="delimiter">)</span>: <a href="../../../../Boolean.scala.html#65" title="Boolean">Boolean</a> =
      <a href="../../symtab/SymbolTable.scala.html#478184" title="(ph: scala.tools.nsc.Phase)(op: =&gt; Boolean)Boolean">atPhase</a> <span class="delimiter">(</span><a href="../../Global.scala.html#478362" title="=&gt; GenMSIL.this.global.Run">currentRun</a>.<a href="../../Global.scala.html#482530" title="=&gt; scala.tools.nsc.Phase">refchecksPhase</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#640233" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/generic/Symbols.scala.html#435387" title="=&gt; Boolean">isModuleClass</a> <a href="../../../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../../../Boolean.scala.html#55576" title="=&gt; Boolean">!</a><a href="#640233" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/generic/Symbols.scala.html#435382" title="=&gt; Boolean">isImplClass</a> <a href="../../../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../../../Boolean.scala.html#55576" title="=&gt; Boolean">!</a><a href="#640233" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../symtab/Symbols.scala.html#509240" title="=&gt; Boolean">isNestedClass</a>
      <span class="delimiter">}</span>

    <span class="comment">// if the module is lifted it does not need to be initialized in</span>
    <span class="comment">// its static constructor, and the MODULE$ field is not required.</span>
    <span class="comment">// the outer class will care about it.</span>
    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol)Boolean" id="636772">isStaticModule</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="641815">sym</a>: <a href="../../symtab/Symbols.scala.html#478659" title="GenMSIL.this.global.Symbol">Symbol</a><span class="delimiter">)</span>: <a href="../../../../Boolean.scala.html#65" title="Boolean">Boolean</a> = <span class="delimiter">{</span>
      <span class="comment">// .net inner classes: removed '!sym.hasFlag(Flags.LIFTED)', added</span>
      <span class="comment">// 'sym.isStatic'. -&gt; no longer compatible without skipping flatten!</span>
      <a href="#641815" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/generic/Symbols.scala.html#435387" title="=&gt; Boolean">isModuleClass</a> <a href="../../../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#641815" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../symtab/Symbols.scala.html#509233" title="=&gt; Boolean">isStatic</a> <a href="../../../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../../../Boolean.scala.html#55576" title="=&gt; Boolean">!</a><a href="#641815" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/generic/Symbols.scala.html#435382" title="=&gt; Boolean">isImplClass</a>
    <span class="delimiter">}</span>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol)Boolean" id="636773">isCloneable</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="640174">sym</a>: <a href="../../symtab/Symbols.scala.html#478659" title="GenMSIL.this.global.Symbol">Symbol</a><span class="delimiter">)</span>: <a href="../../../../Boolean.scala.html#65" title="Boolean">Boolean</a> = <span class="delimiter">{</span>
      <a href="../../../../Boolean.scala.html#55576" title="=&gt; Boolean">!</a><a href="#640174" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../symtab/Symbols.scala.html#509116" title="=&gt; List[GenMSIL.this.global.AnnotationInfo]">annotations</a>.<a href="../../../../collection/LinearSeqOptimized.scala.html#71035" title="(p: GenMSIL.this.global.AnnotationInfo =&gt; Boolean)Boolean">forall</a><span class="delimiter">(</span> <a title="GenMSIL.this.global.AnnotationInfo" id="644819">a</a> =&gt; <a href="#644819" title="GenMSIL.this.global.AnnotationInfo">a</a> <span title="Boolean" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <span title="Boolean(false)">AnnotationInfo</span><span class="delimiter">(</span><a href="#636660" title="=&gt; GenMSIL.this.global.Type">CloneableAttr</a>, _, _<span class="delimiter">)</span> =&gt; <span title="Boolean(false)" class="keyword">false</span>
        <span class="keyword">case</span> <span title="Boolean(true)">_</span> =&gt; <span title="Boolean(true)" class="keyword">true</span>
      <span class="delimiter">}</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol)Unit" id="636774">addModuleInstanceField</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="644792">sym</a>: <a href="../../symtab/Symbols.scala.html#478659" title="GenMSIL.this.global.Symbol">Symbol</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../Global.scala.html#478200" title="=&gt; scala.tools.nsc.Settings">settings</a>.<a href="../../settings/ScalaSettings.scala.html#469727" title="=&gt; scala.tools.nsc.Settings#BooleanSetting">debug</a>.<a href="../../settings/MutableSettings.scala.html#470030" title="=&gt; Boolean">value</a><span class="delimiter">)</span>
        <a href="../../Global.scala.html#478254" title="(msg: =&gt; AnyRef)Unit">log</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Adding Module-Instance Field for &quot;)" class="string">&quot;Adding Module-Instance Field for &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#636799" title="(sym: GenMSIL.this.global.Symbol)String">showsym</a><span class="delimiter">(</span><a href="#644792" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder" id="644823">tBuilder</a> = <a href="#636765" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.Type">getType</a><span class="delimiter">(</span><a href="#644792" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder" class="delimiter">[</span><span title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">TypeBuilder</span><span class="delimiter">]</span>
      <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.FieldBuilder" id="644824">fb</a> = <a href="#644823" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">tBuilder</a>.<span title="(name: String, fieldType: ch.epfl.lamp.compiler.msil.Type, attrs: Short)ch.epfl.lamp.compiler.msil.emit.FieldBuilder">DefineField</span><span class="delimiter">(</span><a href="#636605" title="=&gt; java.lang.String">MODULE_INSTANCE_NAME</a>,
                           <a href="#644823" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">tBuilder</a>,
                           <span class="delimiter">(</span>FieldAttributes.Public <span title="Int(22)">|</span>
                            <span class="comment">//FieldAttributes.InitOnly |</span>
                            FieldAttributes.Static<span class="delimiter">)</span>.<a href="../../../../Int.scala.html#54728" title="=&gt; Short">toShort</a><span class="delimiter">)</span>
      <a href="../../../../collection/mutable/MapLike.scala.html#73272" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol, value: ch.epfl.lamp.compiler.msil.FieldInfo)Unit">fields</a><span class="delimiter">(</span><a href="#644792" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span> = <a href="#644824" title="ch.epfl.lamp.compiler.msil.emit.FieldBuilder">fb</a>
    <span class="delimiter">}</span>


    <span class="comment">// the symbol may be a object-symbol (module-symbol), or a module-class-symbol</span>
    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.FieldInfo" id="636775">getModuleInstanceField</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="638383">sym</a>: <a href="../../symtab/Symbols.scala.html#478659" title="GenMSIL.this.global.Symbol">Symbol</a><span class="delimiter">)</span>: <span title="ch.epfl.lamp.compiler.msil.FieldInfo">FieldInfo</span> = <span class="delimiter">{</span>
      <a href="../../../../Predef.scala.html#9566" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a><span class="delimiter">(</span><a href="#638383" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/generic/Symbols.scala.html#435386" title="=&gt; Boolean">isModule</a> <a href="../../../../Boolean.scala.html#55579" title="(x: Boolean)Boolean">||</a> <a href="#638383" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/generic/Symbols.scala.html#435387" title="=&gt; Boolean">isModuleClass</a>, <span title="java.lang.String(&quot;Expected module: &quot;)" class="string">&quot;Expected module: &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#636799" title="(sym: GenMSIL.this.global.Symbol)String">showsym</a><span class="delimiter">(</span><a href="#638383" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span><span class="delimiter">)</span>

      <span class="comment">// when called by LOAD_MODULE, the corresponding type maybe doesn't</span>
      <span class="comment">// exist yet -&gt; make a getType</span>
      <span class="keyword">val</span> <a title="GenMSIL.this.global.Symbol" id="644838">moduleClassSym</a> = <span title="GenMSIL.this.global.Symbol" class="keyword">if</span> <span class="delimiter">(</span><a href="#638383" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/generic/Symbols.scala.html#435386" title="=&gt; Boolean">isModule</a><span class="delimiter">)</span> <a href="#638383" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../symtab/Symbols.scala.html#509335" title="=&gt; GenMSIL.this.global.Symbol">moduleClass</a> <span class="keyword">else</span> <a href="#638383" title="GenMSIL.this.global.Symbol">sym</a>

      <span class="comment">// TODO: get module field for modules not defined in the</span>
      <span class="comment">// source currently compiling (e.g. Console)</span>

      <a href="../../symtab/clr/CLRTypes.scala.html#601643" title="=&gt; scala.collection.mutable.Map[GenMSIL.this.global.loaders.clrTypes.global.Symbol,ch.epfl.lamp.compiler.msil.FieldInfo]">fields</a> <a href="../../../../collection/MapLike.scala.html#73194" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol)Option[ch.epfl.lamp.compiler.msil.FieldInfo]">get</a> <a href="#644838" title="GenMSIL.this.global.Symbol">moduleClassSym</a> <span title="ch.epfl.lamp.compiler.msil.FieldInfo" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <span title="ch.epfl.lamp.compiler.msil.FieldInfo">Some</span><span class="delimiter">(</span><a title="ch.epfl.lamp.compiler.msil.FieldInfo" id="644844">sym</a><span class="delimiter">)</span> =&gt; <a href="#644844" title="ch.epfl.lamp.compiler.msil.FieldInfo">sym</a>
        <span class="keyword">case</span> <a href="../../../../Option.scala.html#1737" title="ch.epfl.lamp.compiler.msil.FieldInfo">None</a> =&gt;
          <span class="comment">//val mclass = types(moduleClassSym)</span>
          <span class="keyword">val</span> <a title="String" id="644845">nameInMetadata</a> = <a href="#636776" title="(csym: GenMSIL.this.global.Symbol)String">nestingAwareFullClassname</a><span class="delimiter">(</span><a href="#644838" title="GenMSIL.this.global.Symbol">moduleClassSym</a><span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.Type" id="644846">mClass</a> = <a href="../../symtab/SymbolLoaders.scala.html#506452" title="object GenMSIL.this.global.loaders.clrTypes">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#601655" title="(name: String)ch.epfl.lamp.compiler.msil.Type">getType</a><span class="delimiter">(</span><a href="#644845" title="String">nameInMetadata</a><span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.FieldInfo" id="644847">mfield</a> = <a href="#644846" title="ch.epfl.lamp.compiler.msil.Type">mClass</a>.<span title="(x$1: java.lang.String)ch.epfl.lamp.compiler.msil.FieldInfo">GetField</span><span class="delimiter">(</span><span title="java.lang.String(&quot;MODULE$&quot;)" class="string">&quot;MODULE$&quot;</span><span class="delimiter">)</span>
          <a href="../../../../Predef.scala.html#9566" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a><span class="delimiter">(</span><a href="#644847" title="ch.epfl.lamp.compiler.msil.FieldInfo">mfield</a> <span title="(x$1: AnyRef)Boolean">ne</span> <span title="Null(null)" class="keyword">null</span>, <span title="java.lang.String(&quot;module not found &quot;)" class="string">&quot;module not found &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#636799" title="(sym: GenMSIL.this.global.Symbol)String">showsym</a><span class="delimiter">(</span><a href="#644838" title="GenMSIL.this.global.Symbol">moduleClassSym</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <a href="../../../../collection/mutable/MapLike.scala.html#73272" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol, value: ch.epfl.lamp.compiler.msil.FieldInfo)Unit">fields</a><span class="delimiter">(</span><a href="#644838" title="GenMSIL.this.global.Symbol">moduleClassSym</a><span class="delimiter">)</span> = <a href="#644847" title="ch.epfl.lamp.compiler.msil.FieldInfo">mfield</a>
          <a href="#644847" title="ch.epfl.lamp.compiler.msil.FieldInfo">mfield</a>
      <span class="delimiter">}</span>

      <span class="comment">//fields(moduleClassSym)</span>
    <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="(csym: GenMSIL.this.global.Symbol)String" id="636776">nestingAwareFullClassname</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="644848">csym</a>: <a href="../../symtab/Symbols.scala.html#478659" title="GenMSIL.this.global.Symbol">Symbol</a><span class="delimiter">)</span> : <span title="String">String</span> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="java.lang.String" id="644854">suffix</a> = <a href="#636777" title="(sym: GenMSIL.this.global.Symbol)java.lang.String">moduleSuffix</a><span class="delimiter">(</span><a href="#644848" title="GenMSIL.this.global.Symbol">csym</a><span class="delimiter">)</span>
      <span class="keyword">val</span> <a title="java.lang.String" id="644855">res</a> = <span title="java.lang.String" class="keyword">if</span> <span class="delimiter">(</span><a href="#644848" title="GenMSIL.this.global.Symbol">csym</a>.<a href="../../symtab/Symbols.scala.html#509240" title="=&gt; Boolean">isNestedClass</a><span class="delimiter">)</span>
        <a href="#636776" title="(csym: GenMSIL.this.global.Symbol)String">nestingAwareFullClassname</a><span class="delimiter">(</span><a href="#644848" title="GenMSIL.this.global.Symbol">csym</a>.<a href="../../symtab/Symbols.scala.html#509249" title="=&gt; GenMSIL.this.global.Symbol">owner</a><span class="delimiter">)</span> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;+&quot;)" class="string">&quot;+&quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#644848" title="GenMSIL.this.global.Symbol">csym</a>.<a href="../../../../reflect/generic/Symbols.scala.html#435344" title="=&gt; String">encodedName</a>
      <span class="keyword">else</span>
        <a href="#644848" title="GenMSIL.this.global.Symbol">csym</a>.<a href="../../../../reflect/generic/Symbols.scala.html#435348" title="=&gt; String">fullName</a>
      <a href="#644855" title="java.lang.String">res</a> <span title="(x$1: Any)java.lang.String">+</span> <a href="#644854" title="java.lang.String">suffix</a>
    <span class="delimiter">}</span>

  <span class="comment">/** cut&amp;pasted from GenJVM */</span>
  <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol)java.lang.String" id="636777">moduleSuffix</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="644856">sym</a>: <a href="../../symtab/Symbols.scala.html#478659" title="GenMSIL.this.global.Symbol">Symbol</a><span class="delimiter">)</span> =
    <span title="java.lang.String" class="keyword">if</span> <span class="delimiter">(</span><a href="#644856" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/generic/Symbols.scala.html#435349" title="(mask: Long)Boolean">hasFlag</a><span class="delimiter">(</span>Flags.<span title="Long(256L)">MODULE</span><span class="delimiter">)</span> <a href="../../../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../../../Boolean.scala.html#55576" title="=&gt; Boolean">!</a><a href="#644856" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/generic/Symbols.scala.html#435384" title="=&gt; Boolean">isMethod</a> <a href="../../../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a>
       <a href="../../../../Boolean.scala.html#55576" title="=&gt; Boolean">!</a><a href="#644856" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/generic/Symbols.scala.html#435382" title="=&gt; Boolean">isImplClass</a> <a href="../../../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../../../Boolean.scala.html#55576" title="=&gt; Boolean">!</a><a href="#644856" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/generic/Symbols.scala.html#435349" title="(mask: Long)Boolean">hasFlag</a><span class="delimiter">(</span>Flags.<span title="Long(1048576L)">JAVA</span><span class="delimiter">)</span><span class="delimiter">)</span> <span title="java.lang.String(&quot;$&quot;)" class="string">&quot;$&quot;</span>
    <span class="keyword">else</span> <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span>;

    <span class="comment">/** Adds a static initializer which creates an instance of the module
     *  class (calls the primary constructor). A special primary constructor
     *  will be generated (notInitializedModules) which stores the new instance
     *  in the MODULE$ field right after the super call.
     */</span>
    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol)Unit" id="636778">addStaticInit</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="644803">sym</a>: <a href="../../symtab/Symbols.scala.html#478659" title="GenMSIL.this.global.Symbol">Symbol</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder" id="644861">tBuilder</a> = <a href="#636765" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.Type">getType</a><span class="delimiter">(</span><a href="#644803" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder" class="delimiter">[</span><span title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">TypeBuilder</span><span class="delimiter">]</span>

      <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.ConstructorBuilder" id="644862">staticInit</a> = <a href="#644861" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">tBuilder</a>.<span title="(attrs: Short, callingConvention: Short, paramTypes: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.emit.ConstructorBuilder">DefineConstructor</span><span class="delimiter">(</span>
        <span class="delimiter">(</span>MethodAttributes.Static <span title="Int(22)">|</span> MethodAttributes.Public<span class="delimiter">)</span>.<a href="../../../../Int.scala.html#54728" title="=&gt; Short">toShort</a>,
        CallingConventions.<span title="Short(1)">Standard</span>,
        <span title="object ch.epfl.lamp.compiler.msil.Type">MsilType</span>.<span title="Array[ch.epfl.lamp.compiler.msil.Type]">EmptyTypes</span><span class="delimiter">)</span>

      <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.ILGenerator" id="644863">sicode</a> = <a href="#644862" title="ch.epfl.lamp.compiler.msil.emit.ConstructorBuilder">staticInit</a>.<span title="()ch.epfl.lamp.compiler.msil.emit.ILGenerator">GetILGenerator</span><span class="delimiter">(</span><span class="delimiter">)</span>

      <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.ConstructorInfo" id="644864">instanceConstructor</a> = <a href="../../../../collection/MapLike.scala.html#73204" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol)ch.epfl.lamp.compiler.msil.ConstructorInfo">constructors</a><span class="delimiter">(</span><a href="#644803" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../symtab/Symbols.scala.html#509305" title="=&gt; GenMSIL.this.global.Symbol">primaryConstructor</a><span class="delimiter">)</span>

      <span class="comment">// there are no constructor parameters. assuming the constructor takes no parameter</span>
      <span class="comment">// is fine: we call (in the static constructor) the constructor of the module class,</span>
      <span class="comment">// which takes no arguments - an object definition cannot take constructor arguments.</span>
      <a href="#644863" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">sicode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.ConstructorInfo)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Newobj</span>, <a href="#644864" title="ch.epfl.lamp.compiler.msil.ConstructorInfo">instanceConstructor</a><span class="delimiter">)</span>
      <span class="comment">// the stsfld is done in the instance constructor, just after the super call.</span>
      <a href="#644863" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">sicode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Pop</span><span class="delimiter">)</span>

      <a href="#644863" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">sicode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ret</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol)Unit" id="636779">dumpMirrorClass</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="640240">sym</a>: <a href="../../symtab/Symbols.scala.html#478659" title="GenMSIL.this.global.Symbol">Symbol</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.Type" id="644892">tBuilder</a> = <a href="#636765" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.Type">getType</a><span class="delimiter">(</span><a href="#640240" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span>
      <a href="../../../../Predef.scala.html#9566" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a><span class="delimiter">(</span><a href="#640240" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/generic/Symbols.scala.html#435387" title="=&gt; Boolean">isModuleClass</a>, <span title="java.lang.String(&quot;Can\'t generate Mirror-Class for the Non-Module class &quot;)" class="string">&quot;Can't generate Mirror-Class for the Non-Module class &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#640240" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../Global.scala.html#478200" title="=&gt; scala.tools.nsc.Settings">settings</a>.<a href="../../settings/ScalaSettings.scala.html#469727" title="=&gt; scala.tools.nsc.Settings#BooleanSetting">debug</a>.<a href="../../settings/MutableSettings.scala.html#470030" title="=&gt; Boolean">value</a><span class="delimiter">)</span>
        <a href="../../Global.scala.html#478254" title="(msg: =&gt; AnyRef)Unit">log</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Dumping mirror class for object: &quot;)" class="string">&quot;Dumping mirror class for object: &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#640240" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span>
      <span class="keyword">val</span> <a title="String" id="644893">moduleName</a> = <a href="#636750" title="(sym: GenMSIL.this.global.Symbol)String">msilName</a><span class="delimiter">(</span><a href="#640240" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span>
      <span class="keyword">val</span> <a title="java.lang.String" id="644894">mirrorName</a> = <a href="#644893" title="String">moduleName</a>.<span title="(x$1: Int, x$2: Int)java.lang.String">substring</span><span class="delimiter">(</span><span title="Int(0)" class="int">0</span>, <a href="#644893" title="String">moduleName</a>.<span title="()Int">length</span><span class="delimiter">(</span><span class="delimiter">)</span> <a href="../../../../Int.scala.html#54811" title="(x: Int)Int">-</a> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
      <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder" id="644895">mirrorTypeBuilder</a> = <a href="#636677" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ModuleBuilder">mmodule</a>.<span title="(typeName: String, attributes: Int, baseType: ch.epfl.lamp.compiler.msil.Type, interfaces: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.emit.TypeBuilder">DefineType</span><span class="delimiter">(</span><a href="#644894" title="java.lang.String">mirrorName</a>,
                                                 TypeAttributes.Class |
                                                 TypeAttributes.Public <span title="Int(257)">|</span>
                                                 TypeAttributes.Sealed,
                                                 <a href="../../symtab/clr/CLRTypes.scala.html#601610" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MOBJECT</a>,
                                                 <span title="object ch.epfl.lamp.compiler.msil.Type">MsilType</span>.<span title="Array[ch.epfl.lamp.compiler.msil.Type]">EmptyTypes</span><span class="delimiter">)</span>

      <span class="keyword">val</span> <a title="GenMSIL.this.global.icodes.IClass" id="644896">iclass</a> = <a href="../../../../collection/MapLike.scala.html#73204" title="(key: GenMSIL.this.global.icodes.global.Symbol)GenMSIL.this.global.icodes.IClass">classes</a><span class="delimiter">(</span><a href="#640240" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span>

      <span class="keyword">for</span> <span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="644948">m</a> &lt;- <a href="#640240" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../symtab/Symbols.scala.html#509270" title="=&gt; GenMSIL.this.global.Type">tpe</a>.<a href="../../../../collection/generic/FilterMonadic.scala.html#53496" title="(f: GenMSIL.this.global.Symbol =&gt; Unit)Unit">nonPrivateMembers</a>
           <span class="keyword">if</span> <a href="#644948" title="GenMSIL.this.global.Symbol">m</a>.<a href="../../symtab/Symbols.scala.html#509249" title="=&gt; GenMSIL.this.global.Symbol">owner</a> <span title="(x$1: AnyRef)Boolean">!=</span> <a href="../../symtab/Definitions.scala.html#479030" title="object GenMSIL.this.global.definitions">definitions</a>.<a href="../../symtab/Definitions.scala.html#507925" title="=&gt; GenMSIL.this.global.Symbol">ObjectClass</a> <a href="../../../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../../../Boolean.scala.html#55576" title="=&gt; Boolean">!</a><a href="#644948" title="GenMSIL.this.global.Symbol">m</a>.<a href="../../../../reflect/generic/HasFlags.scala.html#435303" title="=&gt; Boolean">isProtected</a> <a href="../../../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a>
           <a href="#644948" title="GenMSIL.this.global.Symbol">m</a>.<a href="../../../../reflect/generic/Symbols.scala.html#435384" title="=&gt; Boolean">isMethod</a> <a href="../../../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../../../Boolean.scala.html#55576" title="=&gt; Boolean">!</a><a href="#644948" title="GenMSIL.this.global.Symbol">m</a>.<a href="../../symtab/Symbols.scala.html#509178" title="=&gt; Boolean">isClassConstructor</a> <a href="../../../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../../../Boolean.scala.html#55576" title="=&gt; Boolean">!</a><a href="#644948" title="GenMSIL.this.global.Symbol">m</a>.<a href="../../symtab/Symbols.scala.html#509235" title="=&gt; Boolean">isStaticMember</a> <a href="../../../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../../../Boolean.scala.html#55576" title="=&gt; Boolean">!</a><a href="#644948" title="GenMSIL.this.global.Symbol">m</a>.<a href="../../../../reflect/generic/HasFlags.scala.html#435296" title="=&gt; Boolean">isCase</a> <a href="../../../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a>
           <a href="../../../../Boolean.scala.html#55576" title="=&gt; Boolean">!</a><a href="#644948" title="GenMSIL.this.global.Symbol">m</a>.<a href="../../../../reflect/generic/HasFlags.scala.html#435315" title="=&gt; Boolean">isDeferred</a><span class="delimiter">)</span>
        <span class="delimiter">{</span>
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../Global.scala.html#478200" title="=&gt; scala.tools.nsc.Settings">settings</a>.<a href="../../settings/ScalaSettings.scala.html#469727" title="=&gt; scala.tools.nsc.Settings#BooleanSetting">debug</a>.<a href="../../settings/MutableSettings.scala.html#470030" title="=&gt; Boolean">value</a><span class="delimiter">)</span>
            <a href="../../Global.scala.html#478254" title="(msg: =&gt; AnyRef)Unit">log</a><span class="delimiter">(</span><span title="java.lang.String(&quot;   Mirroring method: &quot;)" class="string">&quot;   Mirroring method: &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#644948" title="GenMSIL.this.global.Symbol">m</a><span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="Array[ch.epfl.lamp.compiler.msil.Type]" id="644949">paramTypes</a> = <a href="#636764" title="(sym: GenMSIL.this.global.Symbol)Array[ch.epfl.lamp.compiler.msil.Type]">msilParamTypes</a><span class="delimiter">(</span><a href="#644948" title="GenMSIL.this.global.Symbol">m</a><span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="Array[String]" id="644950">paramNames</a>: <a href="../../../../Array.scala.html#1430" title="Array[String]">Array</a><span class="delimiter">[</span>String<span class="delimiter">]</span> = <span title="Array[String]" class="keyword">new</span> <a href="../../../../Array.scala.html#1430" title="Array[String]">Array</a><span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">(</span><a href="#644949" title="Array[ch.epfl.lamp.compiler.msil.Type]">paramTypes</a>.<a href="../../../../Array.scala.html#49204" title="=&gt; Int">length</a><span class="delimiter">)</span>
          <span class="keyword">for</span> <span class="delimiter">(</span><a title="Int" id="645060">i</a> &lt;- <a href="../../../../LowPriorityImplicits.scala.html#9474" title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">0</a> <a href="../../../../collection/immutable/Range.scala.html#63514" title="(f: Int =&gt; Unit)Unit">until</a> <a href="#644949" title="Array[ch.epfl.lamp.compiler.msil.Type]">paramTypes</a>.<a href="../../../../Array.scala.html#49204" title="=&gt; Int">length</a><span class="delimiter">)</span>
            <a href="../../../../Array.scala.html#49206" title="(i: Int, x: String)Unit">paramNames</a><span class="delimiter">(</span><a href="#645060" title="Int">i</a><span class="delimiter">)</span> = <span title="java.lang.String(&quot;x_&quot;)" class="string">&quot;x_&quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#645060" title="Int">i</a>

          <span class="comment">// CHECK: verify if getMethodName is better than msilName</span>
          <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder" id="644951">mirrorMethod</a> = <a href="#644895" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">mirrorTypeBuilder</a>.<span title="(name: String, attrs: Short, returnType: ch.epfl.lamp.compiler.msil.Type, paramTypes: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.emit.MethodBuilder">DefineMethod</span><span class="delimiter">(</span><a href="#636750" title="(sym: GenMSIL.this.global.Symbol)String">msilName</a><span class="delimiter">(</span><a href="#644948" title="GenMSIL.this.global.Symbol">m</a><span class="delimiter">)</span>,
                                                            <span class="delimiter">(</span>MethodAttributes.Public <span title="Int(22)">|</span>
                                                            MethodAttributes.Static<span class="delimiter">)</span>.<a href="../../../../Int.scala.html#54728" title="=&gt; Short">toShort</a>,
                                                            <a href="#636763" title="(tpe: GenMSIL.this.global.Type)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">(</span><a href="#644948" title="GenMSIL.this.global.Symbol">m</a>.<a href="../../symtab/Symbols.scala.html#509270" title="=&gt; GenMSIL.this.global.Type">tpe</a>.<a href="../../symtab/Types.scala.html#507173" title="=&gt; GenMSIL.this.global.Type">resultType</a><span class="delimiter">)</span>,
                                                            <a href="#644949" title="Array[ch.epfl.lamp.compiler.msil.Type]">paramTypes</a><span class="delimiter">)</span>

          <span class="keyword">var</span> <a title="Int" id="644952">i</a> = <span title="Int(0)" class="int">0</span>
          <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><a href="#644952" title="Int">i</a> <a href="../../../../Int.scala.html#54761" title="(x: Int)Boolean">&lt;</a> <a href="#644949" title="Array[ch.epfl.lamp.compiler.msil.Type]">paramTypes</a>.<a href="../../../../Array.scala.html#49204" title="=&gt; Int">length</a><span class="delimiter">)</span> <a href="#644955" title="()Unit" class="delimiter">{</a>
            <a href="#644951" title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder">mirrorMethod</a>.<span title="(pos: Int, attr: Int, name: String)ch.epfl.lamp.compiler.msil.emit.ParameterBuilder">DefineParameter</span><span class="delimiter">(</span><a href="#644952" title="Int">i</a>, ParameterAttributes.<span title="Int(0)">None</span>, <a href="../../../../Array.scala.html#49205" title="(i: Int)String">paramNames</a><span class="delimiter">(</span><a href="#644952" title="Int">i</a><span class="delimiter">)</span><span class="delimiter">)</span>
            <a href="#644952" title="Int">i</a> <a href="../../../../Int.scala.html#54804" title="(x: Int)Int">+=</a> <span title="Int(1)" class="int">1</span>
          <span class="delimiter">}</span>

          <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.ILGenerator" id="644953">mirrorCode</a> = <a href="#644951" title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder">mirrorMethod</a>.<span title="()ch.epfl.lamp.compiler.msil.emit.ILGenerator">GetILGenerator</span><span class="delimiter">(</span><span class="delimiter">)</span>
          <a href="#644953" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">mirrorCode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.FieldInfo)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldsfld</span>, <a href="#636775" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.FieldInfo">getModuleInstanceField</a><span class="delimiter">(</span><a href="#640240" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.MethodInfo" id="644954">mInfo</a> = <a href="#636792" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.MethodInfo">getMethod</a><span class="delimiter">(</span><a href="#644948" title="GenMSIL.this.global.Symbol">m</a><span class="delimiter">)</span>
          <span class="keyword">for</span> <span class="delimiter">(</span><a title="Int" id="645188">paramidx</a> &lt;- <a href="../../../../LowPriorityImplicits.scala.html#9474" title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">0</a>.<a href="../../../../runtime/RichInt.scala.html#54711" title="(end: Int)scala.collection.immutable.Range">until</a><a href="../../../../collection/immutable/Range.scala.html#63514" title="(f: Int =&gt; Unit)Unit" class="delimiter">(</a><a href="#644949" title="Array[ch.epfl.lamp.compiler.msil.Type]">paramTypes</a>.<a href="../../../../Array.scala.html#49204" title="=&gt; Int">length</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
            <span class="keyword">val</span> <a title="Array[ch.epfl.lamp.compiler.msil.ParameterInfo]" id="645189">mInfoParams</a> = <a href="#644954" title="ch.epfl.lamp.compiler.msil.MethodInfo">mInfo</a>.<span title="()Array[ch.epfl.lamp.compiler.msil.ParameterInfo]">GetParameters</span>
            <span class="keyword">val</span> <a title="Boolean" id="645190">loadAddr</a> = <a href="../../../../Array.scala.html#49205" title="(i: Int)ch.epfl.lamp.compiler.msil.ParameterInfo">mInfoParams</a><span class="delimiter">(</span><a href="#645188" title="Int">paramidx</a><span class="delimiter">)</span>.<span title="ch.epfl.lamp.compiler.msil.Type">ParameterType</span>.<span title="()Boolean">IsByRef</span>
            <a href="#636743" title="(code: ch.epfl.lamp.compiler.msil.emit.ILGenerator, loadAddr: Boolean)(i: Int)Unit">loadArg</a><span class="delimiter">(</span><a href="#644953" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">mirrorCode</a>, <a href="#645190" title="Boolean">loadAddr</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#645188" title="Int">paramidx</a><span class="delimiter">)</span>
          <span class="delimiter">}</span>

          <a href="#644953" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">mirrorCode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Callvirt</span>, <a href="#636792" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.MethodInfo">getMethod</a><span class="delimiter">(</span><a href="#644948" title="GenMSIL.this.global.Symbol">m</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <a href="#644953" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">mirrorCode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ret</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>

      <a href="#636698" title="(sym: GenMSIL.this.global.Symbol, tBuilder: ch.epfl.lamp.compiler.msil.emit.TypeBuilder)Unit">addSymtabAttribute</a><span class="delimiter">(</span><a href="#640240" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/generic/Symbols.scala.html#435366" title="=&gt; GenMSIL.this.global.Symbol">sourceModule</a>, <a href="#644895" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">mirrorTypeBuilder</a><span class="delimiter">)</span>

      <a href="#644895" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">mirrorTypeBuilder</a>.<span title="()ch.epfl.lamp.compiler.msil.Type">CreateType</span><span class="delimiter">(</span><span class="delimiter">)</span>
      <a href="#644895" title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">mirrorTypeBuilder</a>.<span title="(sourceFilepath: String)Unit">setSourceFilepath</span><span class="delimiter">(</span><a href="#644896" title="GenMSIL.this.global.icodes.IClass">iclass</a>.<a href="../icode/Members.scala.html#501672" title="=&gt; GenMSIL.this.global.icodes.global.CompilationUnit">cunit</a>.<a href="../../CompilationUnits.scala.html#500950" title="=&gt; scala.tools.nsc.util.SourceFile">source</a>.<a href="../../util/SourceFile.scala.html#501040" title="=&gt; scala.tools.nsc.io.AbstractFile">file</a>.<a href="../../io/AbstractFile.scala.html#501001" title="=&gt; String">path</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>


    <span class="comment">// #####################################################################</span>
    <span class="comment">// delegate callers</span>

    <span class="keyword">var</span> <a title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder" id="636781">delegateCallers</a>: <span title="ch.epfl.lamp.compiler.msil.emit.TypeBuilder">TypeBuilder</span> = _
    <span class="keyword">var</span> <a title="Int" id="636784">nbDelegateCallers</a>: <a href="../../../../Int.scala.html#386" title="Int">Int</a> = <span title="Int(0)" class="int">0</span>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="()Unit" id="636786">initDelegateCallers</a><span class="delimiter">(</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
      <a href="#636781" title="(x$1: ch.epfl.lamp.compiler.msil.emit.TypeBuilder)Unit">delegateCallers</a> = <a href="#636677" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ModuleBuilder">mmodule</a>.<span title="(typeName: String, attributes: Int)ch.epfl.lamp.compiler.msil.emit.TypeBuilder">DefineType</span><span class="delimiter">(</span><span title="java.lang.String(&quot;$DelegateCallers&quot;)" class="string">&quot;$DelegateCallers&quot;</span>, TypeAttributes.Public <span title="Int(257)">|</span>
                                          TypeAttributes.Sealed<span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(functionType: GenMSIL.this.global.Type, delegateType: GenMSIL.this.global.Type)Unit" id="636787">createDelegateCaller</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Type" id="641938">functionType</a>: <a href="../../symtab/Types.scala.html#478720" title="GenMSIL.this.global.Type">Type</a>, <a title="GenMSIL.this.global.Type" id="641939">delegateType</a>: <a href="../../symtab/Types.scala.html#478720" title="GenMSIL.this.global.Type">Type</a><span class="delimiter">)</span> = <span class="delimiter">{</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#636781" title="=&gt; ch.epfl.lamp.compiler.msil.emit.TypeBuilder">delegateCallers</a> <span title="(x$1: AnyRef)Boolean">==</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span>
        <a href="#636786" title="()Unit">initDelegateCallers</a><span class="delimiter">(</span><span class="delimiter">)</span>
      <span class="comment">// create a field an store the function-object</span>
      <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.Type" id="641942">mFunctionType</a>: <span title="ch.epfl.lamp.compiler.msil.Type">MsilType</span> = <a href="#636763" title="(tpe: GenMSIL.this.global.Type)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">(</span><a href="#641938" title="GenMSIL.this.global.Type">functionType</a><span class="delimiter">)</span>
      <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.FieldBuilder" id="641943">anonfunField</a>: <span title="ch.epfl.lamp.compiler.msil.emit.FieldBuilder">FieldBuilder</span> = <a href="#636781" title="=&gt; ch.epfl.lamp.compiler.msil.emit.TypeBuilder">delegateCallers</a>.<span title="(name: String, fieldType: ch.epfl.lamp.compiler.msil.Type, attrs: Short)ch.epfl.lamp.compiler.msil.emit.FieldBuilder">DefineField</span><span class="delimiter">(</span>
        <span title="java.lang.String(&quot;$anonfunField$$&quot;)" class="string">&quot;$anonfunField$$&quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#636784" title="=&gt; Int">nbDelegateCallers</a>, <a href="#641942" title="ch.epfl.lamp.compiler.msil.Type">mFunctionType</a>,
        <span class="delimiter">(</span>FieldAttributes.InitOnly | FieldAttributes.Public <span title="Int(54)">|</span> FieldAttributes.Static<span class="delimiter">)</span>.<a href="../../../../Int.scala.html#54728" title="=&gt; Short">toShort</a><span class="delimiter">)</span>
      <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.FieldInfo)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Stsfld</span>, <a href="#641943" title="ch.epfl.lamp.compiler.msil.emit.FieldBuilder">anonfunField</a><span class="delimiter">)</span>


      <span class="comment">// create the static caller method and the delegate object</span>
      <span class="keyword">val</span> <a href="../../../../Tuple2.scala.html#53390" title="(List[GenMSIL.this.global.Symbol], GenMSIL.this.global.Type)" class="delimiter">(</a><a href="../../../../Tuple2.scala.html#53402" title="List[GenMSIL.this.global.Symbol]" id="641945">params</a>, <a href="../../../../Tuple2.scala.html#53404" title="GenMSIL.this.global.Type" id="641946">returnType</a><span class="delimiter">)</span> = <a href="#641939" title="GenMSIL.this.global.Type">delegateType</a>.<a href="../../symtab/Types.scala.html#507200" title="(name: GenMSIL.this.global.Name)GenMSIL.this.global.Symbol">member</a><span class="delimiter">(</span><a href="../../symtab/StdNames.scala.html#479055" title="object GenMSIL.this.global.nme">nme</a>.<a href="../../symtab/StdNames.scala.html#516580" title="=&gt; GenMSIL.this.global.nme.NameType">apply</a><span class="delimiter">)</span>.<a href="../../symtab/Symbols.scala.html#509270" title="=&gt; GenMSIL.this.global.Type">tpe</a> <span title="(List[GenMSIL.this.global.Symbol], GenMSIL.this.global.Type)" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <span title="(List[GenMSIL.this.global.Symbol], GenMSIL.this.global.Type)">MethodType</span><span class="delimiter">(</span><a title="List[GenMSIL.this.global.Symbol]" id="642037">delParams</a>, <a title="GenMSIL.this.global.Type" id="642038">delReturn</a><span class="delimiter">)</span> =&gt; <a href="../../../../Tuple2.scala.html#53390" title="(_1: List[GenMSIL.this.global.Symbol], _2: GenMSIL.this.global.Type)(List[GenMSIL.this.global.Symbol], GenMSIL.this.global.Type)" class="delimiter">(</a><a href="#642037" title="List[GenMSIL.this.global.Symbol]">delParams</a>, <a href="#642038" title="GenMSIL.this.global.Type">delReturn</a><span class="delimiter">)</span>
        <span class="keyword">case</span> <span title="Nothing">_</span> =&gt; <a href="../../symtab/SymbolTable.scala.html#478159" title="(msg: String)Nothing">abort</a><span class="delimiter">(</span><span title="java.lang.String(&quot;not a delegate type: &quot;)" class="string">&quot;not a delegate type: &quot;</span>  <span title="(x$1: Any)java.lang.String">+</span> <a href="#641939" title="GenMSIL.this.global.Type">delegateType</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
      <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder" id="641947">caller</a>: <span title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder">MethodBuilder</span> = <a href="#636781" title="=&gt; ch.epfl.lamp.compiler.msil.emit.TypeBuilder">delegateCallers</a>.<span title="(name: String, attrs: Short, returnType: ch.epfl.lamp.compiler.msil.Type, paramTypes: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.emit.MethodBuilder">DefineMethod</span><span class="delimiter">(</span>
        <span title="java.lang.String(&quot;$delegateCaller$$&quot;)" class="string">&quot;$delegateCaller$$&quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#636784" title="=&gt; Int">nbDelegateCallers</a>,
        <span class="delimiter">(</span>MethodAttributes.Final | MethodAttributes.Public <span title="Int(54)">|</span> MethodAttributes.Static<span class="delimiter">)</span>.<a href="../../../../Int.scala.html#54728" title="=&gt; Short">toShort</a>,
        <a href="#636763" title="(tpe: GenMSIL.this.global.Type)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">(</span><a href="#641946" title="GenMSIL.this.global.Type">returnType</a><span class="delimiter">)</span>, <span class="delimiter">(</span><a href="#641945" title="List[GenMSIL.this.global.Symbol]">params</a> <a href="../../../../collection/TraversableLike.scala.html#49041" title="(f: GenMSIL.this.global.Symbol =&gt; GenMSIL.this.global.Type)(implicit bf: scala.collection.generic.CanBuildFrom[List[GenMSIL.this.global.Symbol],GenMSIL.this.global.Type,List[GenMSIL.this.global.Type]])List[GenMSIL.this.global.Type]">map</a> <span class="delimiter">(</span><a href="#642092" title="GenMSIL.this.global.Symbol">_</a>.<a href="../../symtab/Symbols.scala.html#509270" title="=&gt; GenMSIL.this.global.Type">tpe</a><span class="delimiter">)</span><span class="delimiter">)</span>.<a href="../../../../collection/TraversableLike.scala.html#49041" title="(f: GenMSIL.this.global.Type =&gt; ch.epfl.lamp.compiler.msil.Type)(implicit bf: scala.collection.generic.CanBuildFrom[List[GenMSIL.this.global.Type],ch.epfl.lamp.compiler.msil.Type,List[ch.epfl.lamp.compiler.msil.Type]])List[ch.epfl.lamp.compiler.msil.Type]">map</a><a href="../../../../collection/immutable/List.scala.html#48868" title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.List.Coll,ch.epfl.lamp.compiler.msil.Type,List[ch.epfl.lamp.compiler.msil.Type]]" class="delimiter">(</a><a href="#636763" title="(tpe: GenMSIL.this.global.Type)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">)</span>.<a href="../../../../collection/TraversableOnce.scala.html#53687" title="(implicit evidence$1: ClassManifest[ch.epfl.lamp.compiler.msil.Type])Array[ch.epfl.lamp.compiler.msil.Type]">toArray</a><span class="delimiter">)</span>
      <span class="keyword">for</span> <span class="delimiter">(</span><a title="Int" id="642333">i</a> &lt;- <a href="../../../../LowPriorityImplicits.scala.html#9474" title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">0</a> <a href="../../../../collection/immutable/Range.scala.html#63514" title="(f: Int =&gt; ch.epfl.lamp.compiler.msil.emit.ParameterBuilder)Unit">until</a> <a href="#641945" title="List[GenMSIL.this.global.Symbol]">params</a>.<a href="../../../../collection/LinearSeqOptimized.scala.html#71030" title="=&gt; Int">length</a><span class="delimiter">)</span>
        <a href="#641947" title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder">caller</a>.<span title="(pos: Int, attr: Int, name: String)ch.epfl.lamp.compiler.msil.emit.ParameterBuilder">DefineParameter</span><span class="delimiter">(</span><a href="#642333" title="Int">i</a>, ParameterAttributes.<span title="Int(0)">None</span>, <span title="java.lang.String(&quot;arg&quot;)" class="string">&quot;arg&quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#642333" title="Int">i</a><span class="delimiter">)</span> <span class="comment">// FIXME: use name of parameter symbol</span>
      <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.ConstructorInfo" id="641948">delegCtor</a> = <a href="#636763" title="(tpe: GenMSIL.this.global.Type)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">(</span><a href="#641939" title="GenMSIL.this.global.Type">delegateType</a><span class="delimiter">)</span>.<span title="(x$1: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.ConstructorInfo">GetConstructor</span><span class="delimiter">(</span><a href="../../../../Array.scala.html#62681" title="(xs: ch.epfl.lamp.compiler.msil.Type*)(implicit evidence$2: scala.reflect.ClassManifest[ch.epfl.lamp.compiler.msil.Type])Array[ch.epfl.lamp.compiler.msil.Type]">Array</a><a href="../../../../reflect/ClassManifest.scala.html#56840" title="(clazz: java.lang.Class[_])scala.reflect.ClassManifest[ch.epfl.lamp.compiler.msil.Type]" class="delimiter">(</a><a href="../../symtab/clr/CLRTypes.scala.html#601610" title="=&gt; ch.epfl.lamp.compiler.msil.Type">MOBJECT</a>, <a href="#636630" title="=&gt; ch.epfl.lamp.compiler.msil.Type">INT_PTR</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldnull</span><span class="delimiter">)</span>
      <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldftn</span>, <a href="#641947" title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder">caller</a><span class="delimiter">)</span>
      <a href="#636680" title="=&gt; ch.epfl.lamp.compiler.msil.emit.ILGenerator">mcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.ConstructorInfo)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Newobj</span>, <a href="#641948" title="ch.epfl.lamp.compiler.msil.ConstructorInfo">delegCtor</a><span class="delimiter">)</span>


      <span class="comment">// create the static caller method body</span>
      <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.MethodInfo" id="641949">functionApply</a>: <span title="ch.epfl.lamp.compiler.msil.MethodInfo">MethodInfo</span> = <a href="#636792" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.MethodInfo">getMethod</a><span class="delimiter">(</span><a href="#641938" title="GenMSIL.this.global.Type">functionType</a>.<a href="../../symtab/Types.scala.html#507200" title="(name: GenMSIL.this.global.Name)GenMSIL.this.global.Symbol">member</a><span class="delimiter">(</span><a href="../../symtab/StdNames.scala.html#479055" title="object GenMSIL.this.global.nme">nme</a>.<a href="../../symtab/StdNames.scala.html#516580" title="=&gt; GenMSIL.this.global.nme.NameType">apply</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.emit.ILGenerator" id="641950">dcode</a>: <span title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">ILGenerator</span> = <a href="#641947" title="ch.epfl.lamp.compiler.msil.emit.MethodBuilder">caller</a>.<span title="()ch.epfl.lamp.compiler.msil.emit.ILGenerator">GetILGenerator</span><span class="delimiter">(</span><span class="delimiter">)</span>
      <a href="#641950" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">dcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.FieldInfo)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldsfld</span>, <a href="#641943" title="ch.epfl.lamp.compiler.msil.emit.FieldBuilder">anonfunField</a><span class="delimiter">)</span>
      <span class="keyword">for</span> <span class="delimiter">(</span><a title="Int" id="642510">i</a> &lt;- <a href="../../../../LowPriorityImplicits.scala.html#9474" title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">0</a> <a href="../../../../collection/immutable/Range.scala.html#63514" title="(f: Int =&gt; Unit)Unit">until</a> <a href="#641945" title="List[GenMSIL.this.global.Symbol]">params</a>.<a href="../../../../collection/LinearSeqOptimized.scala.html#71030" title="=&gt; Int">length</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#636743" title="(code: ch.epfl.lamp.compiler.msil.emit.ILGenerator, loadAddr: Boolean)(i: Int)Unit">loadArg</a><span class="delimiter">(</span><a href="#641950" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">dcode</a>, <span title="Boolean(false)" class="keyword">false</span> <span class="comment">/* TODO confirm whether passing actual as-is to formal is correct wrt the ByRef attribute of the param */</span><span class="delimiter">)</span><span class="delimiter">(</span><a href="#642510" title="Int">i</a><span class="delimiter">)</span>
        <a href="#636788" title="(code: ch.epfl.lamp.compiler.msil.emit.ILGenerator, boxType: GenMSIL.this.global.icodes.TypeKind)Unit">emitBox</a><span class="delimiter">(</span><a href="#641950" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">dcode</a>, <a href="../icode/TypeKinds.scala.html#501327" title="(t: GenMSIL.this.global.icodes.global.Type)GenMSIL.this.global.icodes.TypeKind">toTypeKind</a><span class="delimiter">(</span><a href="../../../../collection/LinearSeqOptimized.scala.html#71031" title="(n: Int)GenMSIL.this.global.Symbol">params</a><span class="delimiter">(</span><a href="#642510" title="Int">i</a><span class="delimiter">)</span>.<a href="../../symtab/Symbols.scala.html#509270" title="=&gt; GenMSIL.this.global.Type">tpe</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
      <a href="#641950" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">dcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Callvirt</span>, <a href="#641949" title="ch.epfl.lamp.compiler.msil.MethodInfo">functionApply</a><span class="delimiter">)</span>
      <a href="#636789" title="(code: ch.epfl.lamp.compiler.msil.emit.ILGenerator, boxType: GenMSIL.this.global.icodes.TypeKind)Unit">emitUnbox</a><span class="delimiter">(</span><a href="#641950" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">dcode</a>, <a href="../icode/TypeKinds.scala.html#501327" title="(t: GenMSIL.this.global.icodes.global.Type)GenMSIL.this.global.icodes.TypeKind">toTypeKind</a><span class="delimiter">(</span><a href="#641946" title="GenMSIL.this.global.Type">returnType</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="#641950" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">dcode</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ret</span><span class="delimiter">)</span>

      <a href="#636784" title="(x$1: Int)Unit">nbDelegateCallers</a> = <a href="#636784" title="=&gt; Int">nbDelegateCallers</a> <a href="../../../../Int.scala.html#54804" title="(x: Int)Int">+</a> <span title="Int(1)" class="int">1</span>

    <span class="delimiter">}</span> <span class="comment">//def createDelegateCaller</span>

    <span class="keyword">def</span> <a title="(code: ch.epfl.lamp.compiler.msil.emit.ILGenerator, boxType: GenMSIL.this.global.icodes.TypeKind)Unit" id="636788">emitBox</a><span class="delimiter">(</span><a title="ch.epfl.lamp.compiler.msil.emit.ILGenerator" id="642511">code</a>: <span title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">ILGenerator</span>, <a title="GenMSIL.this.global.icodes.TypeKind" id="642512">boxType</a>: <a href="../icode/TypeKinds.scala.html#501291" title="GenMSIL.this.global.icodes.TypeKind">TypeKind</a><span class="delimiter">)</span> = <span class="delimiter">(</span><a href="#642512" title="GenMSIL.this.global.icodes.TypeKind">boxType</a>: @<a href="../icode/TypeKinds.scala.html#501291" title="GenMSIL.this.global.icodes.TypeKind @unchecked">unchecked</a><span class="delimiter">)</span> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="comment">// doesn't make sense, unit as parameter..</span>
      <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#501297" title="Unit">UNIT</a>   =&gt; <a href="#642511" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.FieldInfo)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldsfld</span>, <a href="#636656" title="=&gt; ch.epfl.lamp.compiler.msil.FieldInfo">boxedUnit</a><span class="delimiter">)</span>
      <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#501299" title="Unit">BOOL</a> | <a href="../icode/TypeKinds.scala.html#501301" title="object GenMSIL.this.global.icodes.BYTE">BYTE</a> | <a href="../icode/TypeKinds.scala.html#501303" title="object GenMSIL.this.global.icodes.SHORT">SHORT</a> | <a href="../icode/TypeKinds.scala.html#501305" title="object GenMSIL.this.global.icodes.CHAR">CHAR</a> | <a href="../icode/TypeKinds.scala.html#501307" title="object GenMSIL.this.global.icodes.INT">INT</a> | <a href="../icode/TypeKinds.scala.html#501309" title="object GenMSIL.this.global.icodes.LONG">LONG</a> | <a href="../icode/TypeKinds.scala.html#501311" title="object GenMSIL.this.global.icodes.FLOAT">FLOAT</a> | <a href="../icode/TypeKinds.scala.html#501313" title="object GenMSIL.this.global.icodes.DOUBLE">DOUBLE</a> =&gt;
        <a href="#642511" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.Type)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Box</span>, <a href="#636762" title="(t: GenMSIL.this.global.icodes.TypeKind)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">(</span><a href="#642512" title="GenMSIL.this.global.icodes.TypeKind">boxType</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="Unit">REFERENCE</span><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.global.Symbol" id="642530">cls</a><span class="delimiter">)</span> <span class="keyword">if</span> <a href="../../symtab/SymbolLoaders.scala.html#506452" title="object GenMSIL.this.global.loaders.clrTypes">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#601653" title="(cls: GenMSIL.this.global.loaders.clrTypes.global.Symbol)Boolean">isValueType</a><span class="delimiter">(</span><a href="#642530" title="GenMSIL.this.global.icodes.global.Symbol">cls</a><span class="delimiter">)</span> =&gt;
        <a href="#642511" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.Type)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Box</span>, <span class="delimiter">(</span><a href="#636762" title="(t: GenMSIL.this.global.icodes.TypeKind)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">(</span><a href="#642512" title="GenMSIL.this.global.icodes.TypeKind">boxType</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="Unit">REFERENCE</span><span class="delimiter">(</span>_<span class="delimiter">)</span> | ARRAY<span class="delimiter">(</span>_<span class="delimiter">)</span> =&gt;
        <a href="../../Global.scala.html#478245" title="(msg: String)Unit">warning</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Tried to BOX a non-valuetype.&quot;)" class="string">&quot;Tried to BOX a non-valuetype.&quot;</span><span class="delimiter">)</span>
        <span title="Unit" class="delimiter">(</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="(code: ch.epfl.lamp.compiler.msil.emit.ILGenerator, boxType: GenMSIL.this.global.icodes.TypeKind)Unit" id="636789">emitUnbox</a><span class="delimiter">(</span><a title="ch.epfl.lamp.compiler.msil.emit.ILGenerator" id="642560">code</a>: <span title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">ILGenerator</span>, <a title="GenMSIL.this.global.icodes.TypeKind" id="642561">boxType</a>: <a href="../icode/TypeKinds.scala.html#501291" title="GenMSIL.this.global.icodes.TypeKind">TypeKind</a><span class="delimiter">)</span> = <span class="delimiter">(</span><a href="#642561" title="GenMSIL.this.global.icodes.TypeKind">boxType</a>: @<a href="../icode/TypeKinds.scala.html#501291" title="GenMSIL.this.global.icodes.TypeKind @unchecked">unchecked</a><span class="delimiter">)</span> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#501297" title="Unit">UNIT</a>   =&gt; <a href="#642560" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Pop</span><span class="delimiter">)</span>
      <span class="comment">/* (1) it's essential to keep the code emitted here (as of now plain calls to System.Convert.ToBlaBla methods)
             behaviorally.equiv.wrt. BoxesRunTime.unboxToBlaBla methods
             (case null: that's easy, case boxed: track changes to unboxBlaBla)
         (2) See also: asInstanceOf to cast from Any to number,
             tracked in http://lampsvn.epfl.ch/trac/scala/ticket/4437  */</span>
      <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#501299" title="Unit">BOOL</a>   =&gt; <a href="#642560" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Call</span>, <a href="#636640" title="=&gt; ch.epfl.lamp.compiler.msil.MethodInfo">toBool</a><span class="delimiter">)</span>
      <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#501301" title="Unit">BYTE</a>   =&gt; <a href="#642560" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Call</span>, <a href="#636642" title="=&gt; ch.epfl.lamp.compiler.msil.MethodInfo">toSByte</a><span class="delimiter">)</span>
      <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#501303" title="Unit">SHORT</a>  =&gt; <a href="#642560" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Call</span>, <a href="#636644" title="=&gt; ch.epfl.lamp.compiler.msil.MethodInfo">toShort</a><span class="delimiter">)</span>
      <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#501305" title="Unit">CHAR</a>   =&gt; <a href="#642560" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Call</span>, <a href="#636646" title="=&gt; ch.epfl.lamp.compiler.msil.MethodInfo">toChar</a><span class="delimiter">)</span>
      <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#501307" title="Unit">INT</a>    =&gt; <a href="#642560" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Call</span>, <a href="#636648" title="=&gt; ch.epfl.lamp.compiler.msil.MethodInfo">toInt</a><span class="delimiter">)</span>
      <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#501309" title="Unit">LONG</a>   =&gt; <a href="#642560" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Call</span>, <a href="#636650" title="=&gt; ch.epfl.lamp.compiler.msil.MethodInfo">toLong</a><span class="delimiter">)</span>
      <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#501311" title="Unit">FLOAT</a>  =&gt; <a href="#642560" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Call</span>, <a href="#636652" title="=&gt; ch.epfl.lamp.compiler.msil.MethodInfo">toFloat</a><span class="delimiter">)</span>
      <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#501313" title="Unit">DOUBLE</a> =&gt; <a href="#642560" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Call</span>, <a href="#636654" title="=&gt; ch.epfl.lamp.compiler.msil.MethodInfo">toDouble</a><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="Unit">REFERENCE</span><span class="delimiter">(</span><a title="GenMSIL.this.global.icodes.global.Symbol" id="642599">cls</a><span class="delimiter">)</span> <span class="keyword">if</span> <a href="../../symtab/SymbolLoaders.scala.html#506452" title="object GenMSIL.this.global.loaders.clrTypes">clrTypes</a>.<a href="../../symtab/clr/CLRTypes.scala.html#601653" title="(cls: GenMSIL.this.global.loaders.clrTypes.global.Symbol)Boolean">isValueType</a><span class="delimiter">(</span><a href="#642599" title="GenMSIL.this.global.icodes.global.Symbol">cls</a><span class="delimiter">)</span> =&gt;
        <a href="#642560" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.Type)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Unbox</span>, <a href="#636762" title="(t: GenMSIL.this.global.icodes.TypeKind)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">(</span><a href="#642561" title="GenMSIL.this.global.icodes.TypeKind">boxType</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <a href="#642560" title="ch.epfl.lamp.compiler.msil.emit.ILGenerator">code</a>.<span title="(opcode: ch.epfl.lamp.compiler.msil.emit.OpCode, arg: ch.epfl.lamp.compiler.msil.Type)Unit">Emit</span><span class="delimiter">(</span><span title="object ch.epfl.lamp.compiler.msil.emit.OpCodes">OpCodes</span>.<span title="=&gt; ch.epfl.lamp.compiler.msil.emit.OpCode">Ldobj</span>, <a href="#636762" title="(t: GenMSIL.this.global.icodes.TypeKind)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">(</span><a href="#642561" title="GenMSIL.this.global.icodes.TypeKind">boxType</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="Unit">REFERENCE</span><span class="delimiter">(</span>_<span class="delimiter">)</span> | ARRAY<span class="delimiter">(</span>_<span class="delimiter">)</span> =&gt;
        <a href="../../Global.scala.html#478245" title="(msg: String)Unit">warning</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Tried to UNBOX a non-valuetype.&quot;)" class="string">&quot;Tried to UNBOX a non-valuetype.&quot;</span><span class="delimiter">)</span>
        <span title="Unit" class="delimiter">(</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="comment">// #####################################################################</span>
    <span class="comment">// get and create methods / constructors</span>

    <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.ConstructorInfo" id="636790">getConstructor</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="641645">sym</a>: <a href="../../symtab/Symbols.scala.html#478659" title="GenMSIL.this.global.Symbol">Symbol</a><span class="delimiter">)</span>: <span title="ch.epfl.lamp.compiler.msil.ConstructorInfo">ConstructorInfo</span> = <a href="../../symtab/clr/CLRTypes.scala.html#601639" title="=&gt; scala.collection.mutable.Map[GenMSIL.this.global.loaders.clrTypes.global.Symbol,ch.epfl.lamp.compiler.msil.ConstructorInfo]">constructors</a>.<a href="../../../../collection/MapLike.scala.html#73194" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol)Option[ch.epfl.lamp.compiler.msil.ConstructorInfo]">get</a><span class="delimiter">(</span><a href="#641645" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span> <span title="ch.epfl.lamp.compiler.msil.ConstructorInfo" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <span title="ch.epfl.lamp.compiler.msil.ConstructorInfo">Some</span><span class="delimiter">(</span><a title="ch.epfl.lamp.compiler.msil.ConstructorInfo" id="645203">constr</a><span class="delimiter">)</span> =&gt; <a href="#645203" title="ch.epfl.lamp.compiler.msil.ConstructorInfo">constr</a>
      <span class="keyword">case</span> <a href="../../../../Option.scala.html#1737" title="ch.epfl.lamp.compiler.msil.ConstructorInfo">None</a> =&gt;
        <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.Type" id="645204">mClass</a> = <a href="#636765" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.Type">getType</a><span class="delimiter">(</span><a href="#641645" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../symtab/Symbols.scala.html#509249" title="=&gt; GenMSIL.this.global.Symbol">owner</a><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.ConstructorInfo" id="645205">constr</a> = <a href="#645204" title="ch.epfl.lamp.compiler.msil.Type">mClass</a>.<span title="(x$1: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.ConstructorInfo">GetConstructor</span><span class="delimiter">(</span><a href="#636764" title="(sym: GenMSIL.this.global.Symbol)Array[ch.epfl.lamp.compiler.msil.Type]">msilParamTypes</a><span class="delimiter">(</span><a href="#641645" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span title="ch.epfl.lamp.compiler.msil.ConstructorInfo" class="keyword">if</span> <span class="delimiter">(</span><a href="#645205" title="ch.epfl.lamp.compiler.msil.ConstructorInfo">constr</a> <span title="(x$1: AnyRef)Boolean">eq</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <span class="delimiter">{</span>
          java.lang.<span title="object java.lang.System">System</span>.<span title="java.io.PrintStream">out</span>.<span title="(x$1: java.lang.String)Unit">println</span><span class="delimiter">(</span><span title="java.lang.String(&quot;Cannot find constructor &quot;)" class="string">&quot;Cannot find constructor &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#641645" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../symtab/Symbols.scala.html#509249" title="=&gt; GenMSIL.this.global.Symbol">owner</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;::&quot;)" class="string">&quot;::&quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#641645" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../symtab/Symbols.scala.html#509256" title="=&gt; GenMSIL.this.global.Name">name</a><span class="delimiter">)</span>
          java.lang.<span title="object java.lang.System">System</span>.<span title="java.io.PrintStream">out</span>.<span title="(x$1: java.lang.String)Unit">println</span><span class="delimiter">(</span><span title="java.lang.String(&quot;scope = &quot;)" class="string">&quot;scope = &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#641645" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../symtab/Symbols.scala.html#509249" title="=&gt; GenMSIL.this.global.Symbol">owner</a>.<a href="../../symtab/Symbols.scala.html#509270" title="=&gt; GenMSIL.this.global.Type">tpe</a>.<a href="../../symtab/Types.scala.html#507192" title="=&gt; GenMSIL.this.global.Scope">decls</a><span class="delimiter">)</span>
          <a href="../../symtab/SymbolTable.scala.html#478159" title="(msg: String)Nothing">abort</a><span class="delimiter">(</span><a href="#641645" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/generic/Symbols.scala.html#435348" title="=&gt; String">fullName</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
        <span class="keyword">else</span> <span class="delimiter">{</span>
          <a href="#636791" title="(sym: GenMSIL.this.global.Symbol, cInfo: ch.epfl.lamp.compiler.msil.ConstructorInfo)Unit">mapConstructor</a><span class="delimiter">(</span><a href="#641645" title="GenMSIL.this.global.Symbol">sym</a>, <a href="#645205" title="ch.epfl.lamp.compiler.msil.ConstructorInfo">constr</a><span class="delimiter">)</span>
          <a href="#645205" title="ch.epfl.lamp.compiler.msil.ConstructorInfo">constr</a>
        <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol, cInfo: ch.epfl.lamp.compiler.msil.ConstructorInfo)Unit" id="636791">mapConstructor</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="644634">sym</a>: <a href="../../symtab/Symbols.scala.html#478659" title="GenMSIL.this.global.Symbol">Symbol</a>, <a title="ch.epfl.lamp.compiler.msil.ConstructorInfo" id="644635">cInfo</a>: <span title="ch.epfl.lamp.compiler.msil.ConstructorInfo">ConstructorInfo</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
      <a href="../../../../collection/mutable/MapLike.scala.html#73272" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol, value: ch.epfl.lamp.compiler.msil.ConstructorInfo)Unit">constructors</a><span class="delimiter">(</span><a href="#644634" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span> = <a href="#644635" title="ch.epfl.lamp.compiler.msil.ConstructorInfo">cInfo</a>
    <span class="delimiter">}</span>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.MethodInfo" id="636792">getMethod</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="642404">sym</a>: <a href="../../symtab/Symbols.scala.html#478659" title="GenMSIL.this.global.Symbol">Symbol</a><span class="delimiter">)</span>: <span title="ch.epfl.lamp.compiler.msil.MethodInfo">MethodInfo</span> = <span class="delimiter">{</span>

        <a href="../../symtab/clr/CLRTypes.scala.html#601641" title="=&gt; scala.collection.mutable.Map[GenMSIL.this.global.loaders.clrTypes.global.Symbol,ch.epfl.lamp.compiler.msil.MethodInfo]">methods</a>.<a href="../../../../collection/MapLike.scala.html#73194" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol)Option[ch.epfl.lamp.compiler.msil.MethodInfo]">get</a><span class="delimiter">(</span><a href="#642404" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span> <span title="ch.epfl.lamp.compiler.msil.MethodInfo" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <span title="ch.epfl.lamp.compiler.msil.MethodInfo">Some</span><span class="delimiter">(</span><a title="ch.epfl.lamp.compiler.msil.MethodInfo" id="645222">method</a><span class="delimiter">)</span> =&gt; <a href="#645222" title="ch.epfl.lamp.compiler.msil.MethodInfo">method</a>
        <span class="keyword">case</span> <a href="../../../../Option.scala.html#1737" title="ch.epfl.lamp.compiler.msil.MethodInfo">None</a> =&gt;
          <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.Type" id="645223">mClass</a> = <a href="#636765" title="(sym: GenMSIL.this.global.Symbol)ch.epfl.lamp.compiler.msil.Type">getType</a><span class="delimiter">(</span><a href="#642404" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../symtab/Symbols.scala.html#509249" title="=&gt; GenMSIL.this.global.Symbol">owner</a><span class="delimiter">)</span>
          <span class="keyword">try</span> <span class="delimiter">{</span>
            <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.MethodInfo" id="645224">method</a> = <a href="#645223" title="ch.epfl.lamp.compiler.msil.Type">mClass</a>.<span title="(x$1: java.lang.String, x$2: Array[ch.epfl.lamp.compiler.msil.Type], x$3: ch.epfl.lamp.compiler.msil.Type)ch.epfl.lamp.compiler.msil.MethodInfo">GetMethod</span><span class="delimiter">(</span><a href="#636750" title="(sym: GenMSIL.this.global.Symbol)String">msilName</a><span class="delimiter">(</span><a href="#642404" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span>, <a href="#636764" title="(sym: GenMSIL.this.global.Symbol)Array[ch.epfl.lamp.compiler.msil.Type]">msilParamTypes</a><span class="delimiter">(</span><a href="#642404" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span>,
                                          <a href="#636763" title="(tpe: GenMSIL.this.global.Type)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">(</span><a href="#642404" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../symtab/Symbols.scala.html#509270" title="=&gt; GenMSIL.this.global.Type">tpe</a>.<a href="../../symtab/Types.scala.html#507173" title="=&gt; GenMSIL.this.global.Type">resultType</a><span class="delimiter">)</span><span class="delimiter">)</span>
            <span title="ch.epfl.lamp.compiler.msil.MethodInfo" class="keyword">if</span> <span class="delimiter">(</span><a href="#645224" title="ch.epfl.lamp.compiler.msil.MethodInfo">method</a> <span title="(x$1: AnyRef)Boolean">eq</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <span class="delimiter">{</span>
              java.lang.<span title="object java.lang.System">System</span>.<span title="java.io.PrintStream">out</span>.<span title="(x$1: java.lang.String)Unit">println</span><span class="delimiter">(</span><span title="java.lang.String(&quot;Cannot find method &quot;)" class="string">&quot;Cannot find method &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#642404" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../symtab/Symbols.scala.html#509249" title="=&gt; GenMSIL.this.global.Symbol">owner</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;::&quot;)" class="string">&quot;::&quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#636750" title="(sym: GenMSIL.this.global.Symbol)String">msilName</a><span class="delimiter">(</span><a href="#642404" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span><span class="delimiter">)</span>
              java.lang.<span title="object java.lang.System">System</span>.<span title="java.io.PrintStream">out</span>.<span title="(x$1: java.lang.String)Unit">println</span><span class="delimiter">(</span><span title="java.lang.String(&quot;scope = &quot;)" class="string">&quot;scope = &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#642404" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../symtab/Symbols.scala.html#509249" title="=&gt; GenMSIL.this.global.Symbol">owner</a>.<a href="../../symtab/Symbols.scala.html#509270" title="=&gt; GenMSIL.this.global.Type">tpe</a>.<a href="../../symtab/Types.scala.html#507192" title="=&gt; GenMSIL.this.global.Scope">decls</a><span class="delimiter">)</span>
              <a href="../../symtab/SymbolTable.scala.html#478159" title="(msg: String)Nothing">abort</a><span class="delimiter">(</span><a href="#642404" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../../../reflect/generic/Symbols.scala.html#435348" title="=&gt; String">fullName</a><span class="delimiter">)</span>
            <span class="delimiter">}</span>
            <span class="keyword">else</span> <span class="delimiter">{</span>
              <a href="#636793" title="(sym: GenMSIL.this.global.Symbol, mInfo: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">mapMethod</a><span class="delimiter">(</span><a href="#642404" title="GenMSIL.this.global.Symbol">sym</a>, <a href="#645224" title="ch.epfl.lamp.compiler.msil.MethodInfo">method</a><span class="delimiter">)</span>
              <a href="#645224" title="ch.epfl.lamp.compiler.msil.MethodInfo">method</a>
            <span class="delimiter">}</span>
          <span class="delimiter">}</span>
          <span class="keyword">catch</span> <span class="delimiter">{</span>
            <span class="keyword">case</span> <a title="Nothing" id="645254">e</a>: <span title="Exception">Exception</span> =&gt;
              <a href="../../../../Console.scala.html#507" title="object Console">Console</a>.<a href="../../../../Console.scala.html#58055" title="(x: Any)Unit">println</a><span class="delimiter">(</span><span title="java.lang.String(&quot;While looking up &quot;)" class="string">&quot;While looking up &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#645223" title="ch.epfl.lamp.compiler.msil.Type">mClass</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;::&quot;)" class="string">&quot;::&quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#642404" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../symtab/Symbols.scala.html#509363" title="=&gt; java.lang.String">nameString</a><span class="delimiter">)</span>
            <a href="../../../../Console.scala.html#507" title="object Console">Console</a>.<a href="../../../../Console.scala.html#58055" title="(x: Any)Unit">println</a><span class="delimiter">(</span><span title="java.lang.String(&quot;\011&quot;)" class="string">&quot;\t&quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#636799" title="(sym: GenMSIL.this.global.Symbol)String">showsym</a><span class="delimiter">(</span><a href="#642404" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span><span class="delimiter">)</span>
            <span title="Nothing" class="keyword">throw</span> <a href="#645254" title="Exception">e</a>
          <span class="delimiter">}</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <span class="comment">/*
     * add a mapping between sym and mInfo
     */</span>
    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol, mInfo: ch.epfl.lamp.compiler.msil.MethodInfo)Unit" id="636793">mapMethod</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="644785">sym</a>: <a href="../../symtab/Symbols.scala.html#478659" title="GenMSIL.this.global.Symbol">Symbol</a>, <a title="ch.epfl.lamp.compiler.msil.MethodInfo" id="644786">mInfo</a>: <span title="ch.epfl.lamp.compiler.msil.MethodInfo">MethodInfo</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="../../../../Predef.scala.html#9566" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a> <span class="delimiter">(</span><a href="#644786" title="ch.epfl.lamp.compiler.msil.MethodInfo">mInfo</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span>, <a href="#644786" title="ch.epfl.lamp.compiler.msil.MethodInfo">mInfo</a><span class="delimiter">)</span>
      <a href="../../../../collection/mutable/MapLike.scala.html#73272" title="(key: GenMSIL.this.global.loaders.clrTypes.global.Symbol, value: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">methods</a><span class="delimiter">(</span><a href="#644785" title="GenMSIL.this.global.Symbol">sym</a><span class="delimiter">)</span> = <a href="#644786" title="ch.epfl.lamp.compiler.msil.MethodInfo">mInfo</a>
    <span class="delimiter">}</span>

    <span class="comment">/*
     * add mapping between sym and method with newName, paramTypes of newClass
     */</span>
    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol, newClass: ch.epfl.lamp.compiler.msil.Type, newName: String, paramTypes: Array[ch.epfl.lamp.compiler.msil.Type])Unit" id="636794">mapMethod</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="644780">sym</a>: <a href="../../symtab/Symbols.scala.html#478659" title="GenMSIL.this.global.Symbol">Symbol</a>, <a title="ch.epfl.lamp.compiler.msil.Type" id="644781">newClass</a>: <span title="ch.epfl.lamp.compiler.msil.Type">MsilType</span>, <a title="String" id="644782">newName</a>: <span title="String">String</span>, <a title="Array[ch.epfl.lamp.compiler.msil.Type]" id="644783">paramTypes</a>: <a href="../../../../Array.scala.html#1430" title="Array[ch.epfl.lamp.compiler.msil.Type]">Array</a><span class="delimiter">[</span>MsilType<span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="ch.epfl.lamp.compiler.msil.MethodInfo" id="645267">methodInfo</a> = <a href="#644781" title="ch.epfl.lamp.compiler.msil.Type">newClass</a>.<span title="(x$1: java.lang.String, x$2: Array[ch.epfl.lamp.compiler.msil.Type])ch.epfl.lamp.compiler.msil.MethodInfo">GetMethod</span><span class="delimiter">(</span><a href="#644782" title="String">newName</a>, <a href="#644783" title="Array[ch.epfl.lamp.compiler.msil.Type]">paramTypes</a><span class="delimiter">)</span>
      <a href="../../../../Predef.scala.html#9566" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a><span class="delimiter">(</span><a href="#645267" title="ch.epfl.lamp.compiler.msil.MethodInfo">methodInfo</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span>, <span title="java.lang.String(&quot;Can\'t find mapping for &quot;)" class="string">&quot;Can't find mapping for &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#644780" title="GenMSIL.this.global.Symbol">sym</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot; -&gt; &quot;)" class="string">&quot; -&gt; &quot;</span> <span title="(x$1: Any)java.lang.String">+</span>
             <a href="#644782" title="String">newName</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;(&quot;)" class="string">&quot;(&quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#644783" title="Array[ch.epfl.lamp.compiler.msil.Type]">paramTypes</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;)&quot;)" class="string">&quot;)&quot;</span><span class="delimiter">)</span>
      <a href="#636793" title="(sym: GenMSIL.this.global.Symbol, mInfo: ch.epfl.lamp.compiler.msil.MethodInfo)Unit">mapMethod</a><span class="delimiter">(</span><a href="#644780" title="GenMSIL.this.global.Symbol">sym</a>, <a href="#645267" title="ch.epfl.lamp.compiler.msil.MethodInfo">methodInfo</a><span class="delimiter">)</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#645267" title="ch.epfl.lamp.compiler.msil.MethodInfo">methodInfo</a>.<span title="()Boolean">IsStatic</span><span class="delimiter">)</span>
        <a href="#636664" title="=&gt; scala.collection.mutable.HashSet[GenMSIL.this.global.Symbol]">dynToStatMapped</a> <a href="../../../../collection/mutable/HashSet.scala.html#108315" title="(elem: GenMSIL.this.global.Symbol)BytecodeGenerator.this.dynToStatMapped.type">+=</a> <a href="#644780" title="GenMSIL.this.global.Symbol">sym</a>
    <span class="delimiter">}</span>

    <span class="comment">/*
     * add mapping between method with name and paramTypes of clazz to
     * method with newName and newParamTypes of newClass (used for instance
     * for &quot;wait&quot;)
     */</span>
    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(clazz: GenMSIL.this.global.Symbol, name: GenMSIL.this.global.Name, paramTypes: Array[GenMSIL.this.global.Type], newClass: ch.epfl.lamp.compiler.msil.Type, newName: String, newParamTypes: Array[ch.epfl.lamp.compiler.msil.Type])Unit" id="636795">mapMethod</a><span class="delimiter">(</span>
      <a title="GenMSIL.this.global.Symbol" id="644773">clazz</a>: <a href="../../symtab/Symbols.scala.html#478659" title="GenMSIL.this.global.Symbol">Symbol</a>, <a title="GenMSIL.this.global.Name" id="644774">name</a>: <a href="../../symtab/Names.scala.html#478413" title="GenMSIL.this.global.Name">Name</a>, <a title="Array[GenMSIL.this.global.Type]" id="644775">paramTypes</a>: <a href="../../../../Array.scala.html#1430" title="Array[GenMSIL.this.global.Type]">Array</a><span class="delimiter">[</span>Type<span class="delimiter">]</span>,
      <a title="ch.epfl.lamp.compiler.msil.Type" id="644776">newClass</a>: <span title="ch.epfl.lamp.compiler.msil.Type">MsilType</span>, <a title="String" id="644777">newName</a>: <span title="String">String</span>, <a title="Array[ch.epfl.lamp.compiler.msil.Type]" id="644778">newParamTypes</a>: <a href="../../../../Array.scala.html#1430" title="Array[ch.epfl.lamp.compiler.msil.Type]">Array</a><span class="delimiter">[</span>MsilType<span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="GenMSIL.this.global.Symbol" id="645289">methodSym</a> = <a href="#636798" title="(clazz: GenMSIL.this.global.Symbol, name: GenMSIL.this.global.Name, paramTypes: Array[GenMSIL.this.global.Type])GenMSIL.this.global.Symbol">lookupMethod</a><span class="delimiter">(</span><a href="#644773" title="GenMSIL.this.global.Symbol">clazz</a>, <a href="#644774" title="GenMSIL.this.global.Name">name</a>, <a href="#644775" title="Array[GenMSIL.this.global.Type]">paramTypes</a><span class="delimiter">)</span>
        <a href="../../../../Predef.scala.html#9566" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a><span class="delimiter">(</span><a href="#645289" title="GenMSIL.this.global.Symbol">methodSym</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span>, <span title="java.lang.String(&quot;cannot find method &quot;)" class="string">&quot;cannot find method &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#644774" title="GenMSIL.this.global.Name">name</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;(&quot;)" class="string">&quot;(&quot;</span> <span title="(x$1: Any)java.lang.String">+</span>
               <a href="#644775" title="Array[GenMSIL.this.global.Type]">paramTypes</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;)&quot;)" class="string">&quot;)&quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot; in class &quot;)" class="string">&quot; in class &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#644773" title="GenMSIL.this.global.Symbol">clazz</a><span class="delimiter">)</span>
        <a href="#636794" title="(sym: GenMSIL.this.global.Symbol, newClass: ch.epfl.lamp.compiler.msil.Type, newName: String, paramTypes: Array[ch.epfl.lamp.compiler.msil.Type])Unit">mapMethod</a><span class="delimiter">(</span><a href="#645289" title="GenMSIL.this.global.Symbol">methodSym</a>, <a href="#644776" title="ch.epfl.lamp.compiler.msil.Type">newClass</a>, <a href="#644777" title="String">newName</a>, <a href="#644778" title="Array[ch.epfl.lamp.compiler.msil.Type]">newParamTypes</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>

    <span class="comment">/*
     * add mapping for member with name and paramTypes to member
     * newName of newClass (same parameters)
     */</span>
    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(clazz: GenMSIL.this.global.Symbol, name: GenMSIL.this.global.Name, paramTypes: Array[GenMSIL.this.global.Type], newClass: ch.epfl.lamp.compiler.msil.Type, newName: String)Unit" id="636796">mapMethod</a><span class="delimiter">(</span>
      <a title="GenMSIL.this.global.Symbol" id="644767">clazz</a>: <a href="../../symtab/Symbols.scala.html#478659" title="GenMSIL.this.global.Symbol">Symbol</a>, <a title="GenMSIL.this.global.Name" id="644768">name</a>: <a href="../../symtab/Names.scala.html#478413" title="GenMSIL.this.global.Name">Name</a>, <a title="Array[GenMSIL.this.global.Type]" id="644769">paramTypes</a>: <a href="../../../../Array.scala.html#1430" title="Array[GenMSIL.this.global.Type]">Array</a><span class="delimiter">[</span>Type<span class="delimiter">]</span>,
      <a title="ch.epfl.lamp.compiler.msil.Type" id="644770">newClass</a>: <span title="ch.epfl.lamp.compiler.msil.Type">MsilType</span>, <a title="String" id="644771">newName</a>: <span title="String">String</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#636795" title="(clazz: GenMSIL.this.global.Symbol, name: GenMSIL.this.global.Name, paramTypes: Array[GenMSIL.this.global.Type], newClass: ch.epfl.lamp.compiler.msil.Type, newName: String, newParamTypes: Array[ch.epfl.lamp.compiler.msil.Type])Unit">mapMethod</a><span class="delimiter">(</span><a href="#644767" title="GenMSIL.this.global.Symbol">clazz</a>, <a href="#644768" title="GenMSIL.this.global.Name">name</a>, <a href="#644769" title="Array[GenMSIL.this.global.Type]">paramTypes</a>, <a href="#644770" title="ch.epfl.lamp.compiler.msil.Type">newClass</a>, <a href="#644771" title="String">newName</a>, <a href="../../../../Predef.scala.html#9626" title="(xs: Array[GenMSIL.this.global.Type])scala.collection.mutable.ArrayOps[GenMSIL.this.global.Type]">paramTypes</a> <a href="../../../../collection/TraversableLike.scala.html#49041" title="(f: GenMSIL.this.global.Type =&gt; ch.epfl.lamp.compiler.msil.Type)(implicit bf: scala.collection.generic.CanBuildFrom[Array[GenMSIL.this.global.Type],ch.epfl.lamp.compiler.msil.Type,Array[ch.epfl.lamp.compiler.msil.Type]])Array[ch.epfl.lamp.compiler.msil.Type]">map</a> <a href="#636763" title="(tpe: GenMSIL.this.global.Type)ch.epfl.lamp.compiler.msil.Type">msilType</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>

    <span class="comment">/*
     * add mapping for all methods with name of clazz to the corresponding
     * method (same parameters) with newName of newClass
     */</span>
    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(clazz: GenMSIL.this.global.Symbol, name: GenMSIL.this.global.Name, newClass: ch.epfl.lamp.compiler.msil.Type, newName: String)Unit" id="636797">mapMethod</a><span class="delimiter">(</span>
      <a title="GenMSIL.this.global.Symbol" id="644762">clazz</a>: <a href="../../symtab/Symbols.scala.html#478659" title="GenMSIL.this.global.Symbol">Symbol</a>, <a title="GenMSIL.this.global.Name" id="644763">name</a>: <a href="../../symtab/Names.scala.html#478413" title="GenMSIL.this.global.Name">Name</a>,
      <a title="ch.epfl.lamp.compiler.msil.Type" id="644764">newClass</a>: <span title="ch.epfl.lamp.compiler.msil.Type">MsilType</span>, <a title="String" id="644765">newName</a>: <span title="String">String</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="GenMSIL.this.global.Symbol" id="645800">memberSym</a>: <a href="../../symtab/Symbols.scala.html#478659" title="GenMSIL.this.global.Symbol">Symbol</a> = <a href="#644762" title="GenMSIL.this.global.Symbol">clazz</a>.<a href="../../symtab/Symbols.scala.html#509270" title="=&gt; GenMSIL.this.global.Type">tpe</a>.<a href="../../symtab/Types.scala.html#507200" title="(name: GenMSIL.this.global.Name)GenMSIL.this.global.Symbol">member</a><span class="delimiter">(</span><a href="#644763" title="GenMSIL.this.global.Name">name</a><span class="delimiter">)</span>
        <a href="#645800" title="GenMSIL.this.global.Symbol">memberSym</a>.<a href="../../symtab/Symbols.scala.html#509270" title="=&gt; GenMSIL.this.global.Type">tpe</a> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
          <span class="comment">// alternatives: List[Symbol]</span>
          <span class="keyword">case</span> <span title="Unit">OverloadedType</span><span class="delimiter">(</span>_, <a title="List[GenMSIL.this.global.Symbol]" id="645844">alternatives</a><span class="delimiter">)</span> =&gt;
            <a href="#645844" title="List[GenMSIL.this.global.Symbol]">alternatives</a>.<a href="../../../../collection/LinearSeqOptimized.scala.html#71032" title="(f: GenMSIL.this.global.Symbol =&gt; Unit)Unit">foreach</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="645864">s</a> =&gt; <a href="#636794" title="(sym: GenMSIL.this.global.Symbol, newClass: ch.epfl.lamp.compiler.msil.Type, newName: String, paramTypes: Array[ch.epfl.lamp.compiler.msil.Type])Unit">mapMethod</a><span class="delimiter">(</span><a href="#645864" title="GenMSIL.this.global.Symbol">s</a>, <a href="#644764" title="ch.epfl.lamp.compiler.msil.Type">newClass</a>, <a href="#644765" title="String">newName</a>, <a href="#636764" title="(sym: GenMSIL.this.global.Symbol)Array[ch.epfl.lamp.compiler.msil.Type]">msilParamTypes</a><span class="delimiter">(</span><a href="#645864" title="GenMSIL.this.global.Symbol">s</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>

          <span class="comment">// paramTypes: List[Type], resType: Type</span>
          <span class="keyword">case</span> <span title="Unit">MethodType</span><span class="delimiter">(</span><a title="List[GenMSIL.this.global.Symbol]" id="645874">params</a>, <a title="GenMSIL.this.global.Type" id="645875">resType</a><span class="delimiter">)</span> =&gt;
            <a href="#636794" title="(sym: GenMSIL.this.global.Symbol, newClass: ch.epfl.lamp.compiler.msil.Type, newName: String, paramTypes: Array[ch.epfl.lamp.compiler.msil.Type])Unit">mapMethod</a><span class="delimiter">(</span><a href="#645800" title="GenMSIL.this.global.Symbol">memberSym</a>, <a href="#644764" title="ch.epfl.lamp.compiler.msil.Type">newClass</a>, <a href="#644765" title="String">newName</a>, <a href="#636764" title="(sym: GenMSIL.this.global.Symbol)Array[ch.epfl.lamp.compiler.msil.Type]">msilParamTypes</a><span class="delimiter">(</span><a href="#645800" title="GenMSIL.this.global.Symbol">memberSym</a><span class="delimiter">)</span><span class="delimiter">)</span>

          <span class="keyword">case</span> <span title="Nothing">_</span> =&gt;
            <a href="../../symtab/SymbolTable.scala.html#478159" title="(msg: String)Nothing">abort</a><span class="delimiter">(</span><span title="java.lang.String(&quot;member not found: &quot;)" class="string">&quot;member not found: &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#644762" title="GenMSIL.this.global.Symbol">clazz</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;, &quot;)" class="string">&quot;, &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#644763" title="GenMSIL.this.global.Name">name</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>


    <span class="comment">/*
     * find the method in clazz with name and paramTypes
     */</span>
    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(clazz: GenMSIL.this.global.Symbol, name: GenMSIL.this.global.Name, paramTypes: Array[GenMSIL.this.global.Type])GenMSIL.this.global.Symbol" id="636798">lookupMethod</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="645290">clazz</a>: <a href="../../symtab/Symbols.scala.html#478659" title="GenMSIL.this.global.Symbol">Symbol</a>, <a title="GenMSIL.this.global.Name" id="645291">name</a>: <a href="../../symtab/Names.scala.html#478413" title="GenMSIL.this.global.Name">Name</a>, <a title="Array[GenMSIL.this.global.Type]" id="645292">paramTypes</a>: <a href="../../../../Array.scala.html#1430" title="Array[GenMSIL.this.global.Type]">Array</a><span class="delimiter">[</span>Type<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../symtab/Symbols.scala.html#478659" title="GenMSIL.this.global.Symbol">Symbol</a> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="GenMSIL.this.global.Symbol" id="645884">memberSym</a> = <a href="#645290" title="GenMSIL.this.global.Symbol">clazz</a>.<a href="../../symtab/Symbols.scala.html#509270" title="=&gt; GenMSIL.this.global.Type">tpe</a>.<a href="../../symtab/Types.scala.html#507200" title="(name: GenMSIL.this.global.Name)GenMSIL.this.global.Symbol">member</a><span class="delimiter">(</span><a href="#645291" title="GenMSIL.this.global.Name">name</a><span class="delimiter">)</span>
      <a href="#645884" title="GenMSIL.this.global.Symbol">memberSym</a>.<a href="../../symtab/Symbols.scala.html#509270" title="=&gt; GenMSIL.this.global.Type">tpe</a> <span title="GenMSIL.this.global.Symbol" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <span title="GenMSIL.this.global.Symbol">OverloadedType</span><span class="delimiter">(</span>_, <a title="List[GenMSIL.this.global.Symbol]" id="645887">alternatives</a><span class="delimiter">)</span> =&gt;
          <a href="#645887" title="List[GenMSIL.this.global.Symbol]">alternatives</a>.<a href="../../../../collection/LinearSeqOptimized.scala.html#71038" title="(p: GenMSIL.this.global.Symbol =&gt; Boolean)Option[GenMSIL.this.global.Symbol]">find</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="645894">s</a> =&gt; <span class="delimiter">{</span>
            <span class="keyword">var</span> <a title="Int" id="645895">i</a>: <a href="../../../../Int.scala.html#386" title="Int">Int</a> = <span title="Int(0)" class="int">0</span>
            <span class="keyword">var</span> <a title="Boolean" id="645896">typesOK</a>: <a href="../../../../Boolean.scala.html#65" title="Boolean">Boolean</a> = <span title="Boolean(true)" class="keyword">true</span>
            <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#645292" title="Array[GenMSIL.this.global.Type]">paramTypes</a>.<a href="../../../../Array.scala.html#49204" title="=&gt; Int">length</a> <a href="../../../../Int.scala.html#54747" title="(x: Int)Boolean">==</a> <a href="#645894" title="GenMSIL.this.global.Symbol">s</a>.<a href="../../symtab/Symbols.scala.html#509270" title="=&gt; GenMSIL.this.global.Type">tpe</a>.<a href="../../symtab/Types.scala.html#507181" title="=&gt; List[GenMSIL.this.global.Type]">paramTypes</a>.<a href="../../../../collection/LinearSeqOptimized.scala.html#71030" title="=&gt; Int">length</a><span class="delimiter">)</span> <span class="delimiter">{</span>
              <span title="Unit" class="keyword">while</span><span class="delimiter">(</span><a href="#645895" title="Int">i</a> <a href="../../../../Int.scala.html#54761" title="(x: Int)Boolean">&lt;</a> <a href="#645292" title="Array[GenMSIL.this.global.Type]">paramTypes</a>.<a href="../../../../Array.scala.html#49204" title="=&gt; Int">length</a><span class="delimiter">)</span> <a href="#645903" title="()Unit" class="delimiter">{</a>
                <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../../../Array.scala.html#49205" title="(i: Int)GenMSIL.this.global.Type">paramTypes</a><span class="delimiter">(</span><a href="#645895" title="Int">i</a><span class="delimiter">)</span> <span title="(x$1: AnyRef)Boolean">!=</span> <a href="#645894" title="GenMSIL.this.global.Symbol">s</a>.<a href="../../symtab/Symbols.scala.html#509270" title="=&gt; GenMSIL.this.global.Type">tpe</a>.<a href="../../../../collection/LinearSeqOptimized.scala.html#71031" title="(n: Int)GenMSIL.this.global.Type">paramTypes</a><span class="delimiter">(</span><a href="#645895" title="Int">i</a><span class="delimiter">)</span><span class="delimiter">)</span>
                  <a href="#645896" title="Boolean">typesOK</a> = <span title="Boolean(false)" class="keyword">false</span>
                <a href="#645895" title="Int">i</a> <a href="../../../../Int.scala.html#54804" title="(x: Int)Int">+=</a> <span title="Int(1)" class="int">1</span>
              <span class="delimiter">}</span>
            <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
              <a href="#645896" title="Boolean">typesOK</a> = <span title="Boolean(false)" class="keyword">false</span>
            <span class="delimiter">}</span>
            <a href="#645896" title="Boolean">typesOK</a>
          <span class="delimiter">}</span><span class="delimiter">)</span> <span title="GenMSIL.this.global.Symbol" class="keyword">match</span> <span class="delimiter">{</span>
            <span class="keyword">case</span> <span title="GenMSIL.this.global.Symbol">Some</span><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="645926">sym</a><span class="delimiter">)</span> =&gt; <a href="#645926" title="GenMSIL.this.global.Symbol">sym</a>
            <span class="keyword">case</span> <a href="../../../../Option.scala.html#1737" title="Nothing">None</a> =&gt; <a href="../../symtab/SymbolTable.scala.html#478159" title="(msg: String)Nothing">abort</a><span class="delimiter">(</span><span title="java.lang.String(&quot;member of &quot;)" class="string">&quot;member of &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#645290" title="GenMSIL.this.global.Symbol">clazz</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;, &quot;)" class="string">&quot;, &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#645291" title="GenMSIL.this.global.Name">name</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;(&quot;)" class="string">&quot;(&quot;</span> <span title="(x$1: Any)java.lang.String">+</span>
                               <a href="#645292" title="Array[GenMSIL.this.global.Type]">paramTypes</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;) not found&quot;)" class="string">&quot;) not found&quot;</span><span class="delimiter">)</span>
          <span class="delimiter">}</span>

        <span class="keyword">case</span> <span title="GenMSIL.this.global.Symbol">MethodType</span><span class="delimiter">(</span>_, _<span class="delimiter">)</span> =&gt; <a href="#645884" title="GenMSIL.this.global.Symbol">memberSym</a>

        <span class="keyword">case</span> <span title="Nothing">_</span> =&gt; <a href="../../symtab/SymbolTable.scala.html#478159" title="(msg: String)Nothing">abort</a><span class="delimiter">(</span><span title="java.lang.String(&quot;member not found: &quot;)" class="string">&quot;member not found: &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#645291" title="GenMSIL.this.global.Name">name</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot; of &quot;)" class="string">&quot; of &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#645290" title="GenMSIL.this.global.Symbol">clazz</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(sym: GenMSIL.this.global.Symbol)String" id="636799">showsym</a><span class="delimiter">(</span><a title="GenMSIL.this.global.Symbol" id="640171">sym</a>: <a href="../../symtab/Symbols.scala.html#478659" title="GenMSIL.this.global.Symbol">Symbol</a><span class="delimiter">)</span>: <span title="String">String</span> = <span class="delimiter">(</span><a href="#640171" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../symtab/Symbols.scala.html#509365" title="()String">toString</a> <span title="(x$1: Any)java.lang.String">+</span>
      <span title="java.lang.String(&quot;\012  symbol = &quot;)" class="string">&quot;\n  symbol = &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="../../symtab/Flags.scala.html#36139" title="object scala.tools.nsc.symtab.Flags">Flags</a>.<a href="../../../../reflect/generic/Flags.scala.html#435634" title="(flags: Long)String">flagsToString</a><span class="delimiter">(</span><a href="#640171" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../symtab/Symbols.scala.html#509259" title="=&gt; Long">flags</a><span class="delimiter">)</span> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot; &quot;)" class="string">&quot; &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#640171" title="GenMSIL.this.global.Symbol">sym</a> <span title="(x$1: Any)java.lang.String">+</span>
      <span title="java.lang.String(&quot;\012  owner  = &quot;)" class="string">&quot;\n  owner  = &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="../../symtab/Flags.scala.html#36139" title="object scala.tools.nsc.symtab.Flags">Flags</a>.<a href="../../../../reflect/generic/Flags.scala.html#435634" title="(flags: Long)String">flagsToString</a><span class="delimiter">(</span><a href="#640171" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../symtab/Symbols.scala.html#509249" title="=&gt; GenMSIL.this.global.Symbol">owner</a>.<a href="../../symtab/Symbols.scala.html#509259" title="=&gt; Long">flags</a><span class="delimiter">)</span> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot; &quot;)" class="string">&quot; &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#640171" title="GenMSIL.this.global.Symbol">sym</a>.<a href="../../symtab/Symbols.scala.html#509249" title="=&gt; GenMSIL.this.global.Symbol">owner</a>
    <span class="delimiter">)</span>

  <span class="delimiter">}</span> <span class="comment">// class BytecodeGenerator</span>

<span class="delimiter">}</span> <span class="comment">// class GenMSIL</span>

        </pre>
    </body>
</html>