<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>scala/tools/nsc/transform/CleanUp.scala</title>
        <script type="text/javascript" src="../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/* NSC -- new Scala compiler
 * Copyrights 2005-2011 LAMP/EPFL
 * @author Martin Odersky
 */</span>

<span class="keyword">package</span> scala.tools.nsc
<span class="keyword">package</span> transform

<span class="keyword">import</span> symtab._
<span class="keyword">import</span> <a href="../symtab/Flags.scala.html#36139" title="object scala.tools.nsc.symtab.Flags">Flags</a>._
<span class="keyword">import</span> scala.collection._

<span class="keyword">abstract</span> <span class="keyword">class</span> <a title="class CleanUp extends scala.tools.nsc.SubComponent with scala.tools.nsc.transform.Transform with scala.tools.nsc.ast.TreeDSL with ScalaObject" id="38833">CleanUp</a> <a href="../../../ScalaObject.scala.html#464" title="ScalaObject" class="keyword">extends</a> <a href="Transform.scala.html#39274" title="scala.tools.nsc.transform.Transform">Transform</a> <span class="keyword">with</span> ast.<a href="../ast/TreeDSL.scala.html#23679" title="scala.tools.nsc.ast.TreeDSL">TreeDSL</a> <span class="delimiter">{</span>
  <span class="keyword">import</span> <a href="../ast/TreeDSL.scala.html#507538" title="=&gt; scala.tools.nsc.Global">global</a>._
  <span class="keyword">import</span> <a href="../symtab/Definitions.scala.html#479030" title="object CleanUp.this.global.definitions">definitions</a>._
  <span class="keyword">import</span> <a href="../ast/TreeDSL.scala.html#507542" title="object CleanUp.this.CODE">CODE</a>._

  <span class="comment">/** the following two members override abstract members in Transform */</span>
  <span class="keyword">val</span> <a title="String" id="513435">phaseName</a>: <span title="String">String</span> = <span title="java.lang.String(&quot;cleanup&quot;)" class="string">&quot;cleanup&quot;</span>

  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="(unit: CleanUp.this.global.CompilationUnit)CleanUp.this.global.Transformer" id="513437">newTransformer</a><span class="delimiter">(</span><a title="CleanUp.this.global.CompilationUnit" id="885000">unit</a>: <a href="../CompilationUnits.scala.html#479284" title="CleanUp.this.global.CompilationUnit">CompilationUnit</a><span class="delimiter">)</span>: <a href="../ast/Trees.scala.html#479167" title="CleanUp.this.global.Transformer">Transformer</a> =
    <span title="CleanUp.this.CleanUpTransformer" class="keyword">new</span> <a href="#513438" title="CleanUp.this.CleanUpTransformer">CleanUpTransformer</a><span class="delimiter">(</span><a href="#885000" title="CleanUp.this.global.CompilationUnit">unit</a><span class="delimiter">)</span>

  <span class="keyword">class</span> <a title="class CleanUpTransformer extends CleanUp.this.global.Transformer with ScalaObject" id="513438">CleanUpTransformer</a><a href="../../../ScalaObject.scala.html#464" title="ScalaObject" class="delimiter">(</a><a title="CleanUp.this.global.CompilationUnit" id="885031">unit</a>: <a href="../CompilationUnits.scala.html#479284" title="CleanUp.this.global.CompilationUnit">CompilationUnit</a><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="../ast/Trees.scala.html#479167" title="CleanUp.this.global.Transformer">Transformer</a> <span class="delimiter">{</span>
    <span class="keyword">private</span> <span class="keyword">val</span> <a title="scala.collection.mutable.Buffer[CleanUp.this.global.Tree]" id="885008">newStaticMembers</a> = mutable.<a href="../../../collection/mutable/Buffer.scala.html#14723" title="object scala.collection.mutable.Buffer">Buffer</a>.<a href="../../../collection/generic/GenericCompanion.scala.html#48810" title="[A]=&gt; scala.collection.mutable.Buffer[A]">empty</a><span title="scala.collection.mutable.Buffer[CleanUp.this.global.Tree]" class="delimiter">[</span><a href="../../../reflect/generic/Trees.scala.html#434028" title="CleanUp.this.global.Tree">Tree</a><span class="delimiter">]</span>
    <span class="keyword">private</span> <span class="keyword">val</span> <a title="scala.collection.mutable.Buffer[CleanUp.this.global.Tree]" id="885010">newStaticInits</a> = mutable.<a href="../../../collection/mutable/Buffer.scala.html#14723" title="object scala.collection.mutable.Buffer">Buffer</a>.<a href="../../../collection/generic/GenericCompanion.scala.html#48810" title="[A]=&gt; scala.collection.mutable.Buffer[A]">empty</a><span title="scala.collection.mutable.Buffer[CleanUp.this.global.Tree]" class="delimiter">[</span><a href="../../../reflect/generic/Trees.scala.html#434028" title="CleanUp.this.global.Tree">Tree</a><span class="delimiter">]</span>
    <span class="keyword">private</span> <span class="keyword">val</span> <a title="scala.collection.mutable.Map[String,CleanUp.this.global.Symbol]" id="885012">symbolsStoredAsStatic</a> = mutable.<a href="../../../collection/mutable/Map.scala.html#14768" title="object scala.collection.mutable.Map">Map</a>.<a href="../../../collection/mutable/Map.scala.html#166033" title="[A, B]=&gt; scala.collection.mutable.Map[A,B]">empty</a><span title="scala.collection.mutable.Map[String,CleanUp.this.global.Symbol]" class="delimiter">[</span><span title="String">String</span>, <a href="../symtab/Symbols.scala.html#478659" title="CleanUp.this.global.Symbol">Symbol</a><span class="delimiter">]</span>
    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(prefix: String)CleanUp.this.global.TermName" id="885014">mkTerm</a><span class="delimiter">(</span><a title="String" id="885035">prefix</a>: <span title="String">String</span><span class="delimiter">)</span>: <a href="../symtab/Names.scala.html#478414" title="CleanUp.this.global.TermName">TermName</a> = <a href="#885031" title="CleanUp.this.global.CompilationUnit">unit</a>.<a href="../CompilationUnits.scala.html#500956" title="(prefix: String)CleanUp.this.global.TermName">freshTermName</a><span class="delimiter">(</span><a href="#885035" title="String">prefix</a><span class="delimiter">)</span>

    <span class="comment">/** Kludge to provide a safe fix for #4560:
     *  If we generate a reference in an implementation class, we
     *  watch out for embedded This(..) nodes that point to the interface.
     *  These must be wrong. We fix them by setting symbol and type to
     *  the enclosing implementation class instead.
     */</span>
    <span class="keyword">def</span> <a title="(sym: CleanUp.this.global.Symbol)CleanUp.this.global.gen.global.Tree" id="885015">safeREF</a><span class="delimiter">(</span><a title="CleanUp.this.global.Symbol" id="885037">sym</a>: <a href="../symtab/Symbols.scala.html#478659" title="CleanUp.this.global.Symbol">Symbol</a><span class="delimiter">)</span> = <span class="delimiter">{</span>
      <span class="keyword">def</span> <a title="(tree: CleanUp.this.global.Tree)Unit" id="885040">fix</a><span class="delimiter">(</span><a title="CleanUp.this.global.Tree" id="885042">tree</a>: <a href="../../../reflect/generic/Trees.scala.html#434028" title="CleanUp.this.global.Tree">Tree</a><span class="delimiter">)</span>: <a href="../../../Unit.scala.html#461" title="Unit">Unit</a> = <a href="#885042" title="CleanUp.this.global.Tree">tree</a> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <span title="Unit">Select</span><span class="delimiter">(</span><a title="CleanUp.this.global.This" id="885049">qual</a> @ This<span class="delimiter">(</span>_<span class="delimiter">)</span>, <a title="CleanUp.this.global.Name" id="885054">name</a><span class="delimiter">)</span> <span class="keyword">if</span> <a href="#885049" title="CleanUp.this.global.This">qual</a>.<a href="../../../reflect/generic/Trees.scala.html#441600" title="=&gt; CleanUp.this.global.Symbol">symbol</a> <span title="(x$1: AnyRef)Boolean">!=</span> <a href="../ast/Trees.scala.html#560337" title="=&gt; CleanUp.this.global.Symbol">currentClass</a> =&gt;
          <a href="#885049" title="CleanUp.this.global.This">qual</a>.<a href="../../../reflect/generic/Trees.scala.html#441034" title="(sym: CleanUp.this.global.Symbol)qual.type">setSymbol</a><span class="delimiter">(</span><a href="../ast/Trees.scala.html#560337" title="=&gt; CleanUp.this.global.Symbol">currentClass</a><span class="delimiter">)</span>.<a href="../../../reflect/generic/Trees.scala.html#441030" title="(tp: CleanUp.this.global.Type)qual.type">setType</a><span title="Unit" class="delimiter">(</span><a href="../ast/Trees.scala.html#560337" title="=&gt; CleanUp.this.global.Symbol">currentClass</a>.<a href="../symtab/Symbols.scala.html#509270" title="=&gt; CleanUp.this.global.Type">tpe</a><span class="delimiter">)</span>
        <span class="keyword">case</span> <span title="Unit">_</span> =&gt;
      <span class="delimiter">}</span>
      <span class="keyword">val</span> <a title="CleanUp.this.global.gen.global.Tree" id="885041">tree</a> = <a href="../ast/TreeDSL.scala.html#515243" title="(sym: CleanUp.this.global.Symbol)CleanUp.this.global.gen.global.Tree">REF</a><span class="delimiter">(</span><a href="#885037" title="CleanUp.this.global.Symbol">sym</a><span class="delimiter">)</span>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../ast/Trees.scala.html#560337" title="=&gt; CleanUp.this.global.Symbol">currentClass</a>.<a href="../../../reflect/generic/Symbols.scala.html#435382" title="=&gt; Boolean">isImplClass</a> <a href="../../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#885037" title="CleanUp.this.global.Symbol">sym</a>.<a href="../symtab/Symbols.scala.html#509249" title="=&gt; CleanUp.this.global.Symbol">owner</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../ast/Trees.scala.html#560337" title="=&gt; CleanUp.this.global.Symbol">currentClass</a><span class="delimiter">)</span> <a href="#885040" title="(tree: CleanUp.this.global.Tree)Unit">fix</a><span class="delimiter">(</span><a href="#885041" title="CleanUp.this.global.gen.global.Tree">tree</a><span class="delimiter">)</span>
      <a href="#885041" title="CleanUp.this.global.gen.global.Tree">tree</a>
    <span class="delimiter">}</span>

    <span class="comment">//private val classConstantMeth = new HashMap[String, Symbol]</span>
    <span class="comment">//private val symbolStaticFields = new HashMap[String, (Symbol, Tree, Tree)]</span>

    <span class="keyword">private</span> <span class="keyword">var</span> <a title="CleanUp.this.global.analyzer.Typer" id="885017">localTyper</a>: analyzer.<a href="../typechecker/Typers.scala.html#507454" title="CleanUp.this.global.analyzer.Typer">Typer</a> = <span title="Null(null)" class="keyword">null</span>

    <span class="keyword">private</span> <span class="keyword">object</span> <a title="object CleanUpTransformer.this.MethodDispatchType" id="885019">MethodDispatchType</a> <a href="../../../ScalaObject.scala.html#464" title="ScalaObject" class="keyword">extends</a> scala.<a href="../../../Enumeration.scala.html#956" title="Enumeration">Enumeration</a> <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="scala.tools.nsc.transform.CleanUp.CleanUpTransformer.MethodDispatchType.Value" id="885074">NO_CACHE</a>, <a title="scala.tools.nsc.transform.CleanUp.CleanUpTransformer.MethodDispatchType.Value" id="885076">MONO_CACHE</a>, <a title="scala.tools.nsc.transform.CleanUp.CleanUpTransformer.MethodDispatchType.Value" id="885078">POLY_CACHE</a> = <a href="../../../Enumeration.scala.html#72677" title="=&gt; scala.tools.nsc.transform.CleanUp.CleanUpTransformer.MethodDispatchType.Value">Value</a>
    <span class="delimiter">}</span>
    <span class="keyword">import</span> <a href="#885019" title="object CleanUpTransformer.this.MethodDispatchType">MethodDispatchType</a>.<span class="delimiter">{</span> NO_CACHE, MONO_CACHE, POLY_CACHE <span class="delimiter">}</span>
    <span class="keyword">private</span> <span class="keyword">def</span> <a title="()CleanUpTransformer.this.MethodDispatchType.Value" id="885022">dispatchType</a><span class="delimiter">(</span><span class="delimiter">)</span> = <a href="../Global.scala.html#478200" title="=&gt; scala.tools.nsc.Settings">settings</a>.<a href="../settings/ScalaSettings.scala.html#469769" title="=&gt; scala.tools.nsc.Settings#ChoiceSetting">refinementMethodDispatch</a>.<a href="../settings/MutableSettings.scala.html#470030" title="=&gt; java.lang.String">value</a> <span title="CleanUpTransformer.this.MethodDispatchType.Value" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <span title="CleanUpTransformer.this.MethodDispatchType.Value" class="string">&quot;no-cache&quot;</span>   =&gt; <a href="#885074" title="=&gt; CleanUpTransformer.this.MethodDispatchType.Value">NO_CACHE</a>
      <span class="keyword">case</span> <span title="CleanUpTransformer.this.MethodDispatchType.Value" class="string">&quot;mono-cache&quot;</span> =&gt; <a href="#885076" title="=&gt; CleanUpTransformer.this.MethodDispatchType.Value">MONO_CACHE</a>
      <span class="keyword">case</span> <span title="CleanUpTransformer.this.MethodDispatchType.Value" class="string">&quot;poly-cache&quot;</span> =&gt; <a href="#885078" title="=&gt; CleanUpTransformer.this.MethodDispatchType.Value">POLY_CACHE</a>
    <span class="delimiter">}</span>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(pos: CleanUp.this.global.Position)(tree: CleanUp.this.global.Tree)CleanUp.this.global.analyzer.global.Tree" id="885023">typedWithPos</a><span class="delimiter">(</span><a title="CleanUp.this.global.Position" id="885112">pos</a>: <a href="../util/Position.scala.html#42664" title="CleanUp.this.global.Position">Position</a><span class="delimiter">)</span><span class="delimiter">(</span><a title="CleanUp.this.global.Tree" id="885113">tree</a>: <a href="../../../reflect/generic/Trees.scala.html#434028" title="CleanUp.this.global.Tree">Tree</a><span class="delimiter">)</span> =
      <a href="#885017" title="=&gt; CleanUp.this.global.analyzer.Typer">localTyper</a> <a href="../typechecker/Typers.scala.html#507768" title="(tree: CleanUp.this.global.analyzer.global.Tree)CleanUp.this.global.analyzer.global.Tree">typed</a> <span class="delimiter">{</span> <a href="../ast/Trees.scala.html#479182" title="(pos: CleanUp.this.global.Position)(tree: CleanUp.this.global.Tree)CleanUp.this.global.Tree">atPos</a><span class="delimiter">(</span><a href="#885112" title="CleanUp.this.global.Position">pos</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#885113" title="CleanUp.this.global.Tree">tree</a><span class="delimiter">)</span> <span class="delimiter">}</span>

    <span class="comment">/** A value class is defined to be only Java-compatible values: unit is
      * not part of it, as opposed to isValueClass in definitions. scala.Int is
      * a value class, java.lang.Integer is not. */</span>
    <span class="keyword">def</span> <a title="(sym: CleanUp.this.global.Symbol)Boolean" id="885024">isJavaValueClass</a><span class="delimiter">(</span><a title="CleanUp.this.global.Symbol" id="885133">sym</a>: <a href="../symtab/Symbols.scala.html#478659" title="CleanUp.this.global.Symbol">Symbol</a><span class="delimiter">)</span> = <a href="../symtab/Definitions.scala.html#508405" title="=&gt; Map[CleanUp.this.global.Symbol,CleanUp.this.global.Symbol]">boxedClass</a> <a href="../../../collection/MapLike.scala.html#73205" title="(key: CleanUp.this.global.Symbol)Boolean">contains</a> <a href="#885133" title="CleanUp.this.global.Symbol">sym</a>
    <span class="keyword">def</span> <a title="(tp: CleanUp.this.global.Type)Boolean" id="885025">isJavaValueType</a><span class="delimiter">(</span><a title="CleanUp.this.global.Type" id="885137">tp</a>: <a href="../symtab/Types.scala.html#478720" title="CleanUp.this.global.Type">Type</a><span class="delimiter">)</span> = <a href="#885024" title="(sym: CleanUp.this.global.Symbol)Boolean">isJavaValueClass</a><span class="delimiter">(</span><a href="#885137" title="CleanUp.this.global.Type">tp</a>.<a href="../symtab/Types.scala.html#507159" title="=&gt; CleanUp.this.global.Symbol">typeSymbol</a><span class="delimiter">)</span>

    <span class="comment">/** The boxed type if it's a primitive; identity otherwise.
     */</span>
    <span class="keyword">def</span> <a title="(tp: CleanUp.this.global.Type)CleanUp.this.global.Type" id="885026">toBoxedType</a><span class="delimiter">(</span><a title="CleanUp.this.global.Type" id="885140">tp</a>: <a href="../symtab/Types.scala.html#478720" title="CleanUp.this.global.Type">Type</a><span class="delimiter">)</span> = <span title="CleanUp.this.global.Type" class="keyword">if</span> <span class="delimiter">(</span><a href="#885025" title="(tp: CleanUp.this.global.Type)Boolean">isJavaValueType</a><span class="delimiter">(</span><a href="#885140" title="CleanUp.this.global.Type">tp</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../../collection/MapLike.scala.html#73204" title="(key: CleanUp.this.global.Symbol)CleanUp.this.global.Symbol">boxedClass</a><span class="delimiter">(</span><a href="#885140" title="CleanUp.this.global.Type">tp</a>.<a href="../symtab/Types.scala.html#507159" title="=&gt; CleanUp.this.global.Symbol">typeSymbol</a><span class="delimiter">)</span>.<a href="../symtab/Symbols.scala.html#509270" title="=&gt; CleanUp.this.global.Type">tpe</a> <span class="keyword">else</span> <a href="#885140" title="CleanUp.this.global.Type">tp</a>

    <span class="keyword">override</span> <span class="keyword">def</span> <a title="(tree: CleanUp.this.global.Tree)CleanUp.this.global.Tree" id="885027">transform</a><span class="delimiter">(</span><a title="CleanUp.this.global.Tree" id="885167">tree</a>: <a href="../../../reflect/generic/Trees.scala.html#434028" title="CleanUp.this.global.Tree">Tree</a><span class="delimiter">)</span>: <a href="../../../reflect/generic/Trees.scala.html#434028" title="CleanUp.this.global.Tree">Tree</a> = <a href="#885167" title="CleanUp.this.global.Tree">tree</a> <span title="CleanUp.this.global.Tree" class="keyword">match</span> <span class="delimiter">{</span>

      <span class="comment">/* Transforms dynamic calls (i.e. calls to methods that are undefined
       * in the erased type space) to -- dynamically -- unsafe calls using
       * reflection. This is used for structural sub-typing of refinement
       * types, but may be used for other dynamic calls in the future.
       * For 'a.f(b)' it will generate something like:
       * 'a.getClass().
       * '  getMethod(&quot;f&quot;, Array(classOf[b.type])).
       * '  invoke(a, Array(b))
       * plus all the necessary casting/boxing/etc. machinery required
       * for type-compatibility (see fixResult).
       *
       * USAGE CONTRACT:
       * There are a number of assumptions made on the way a dynamic apply
       * is used. Assumptions relative to type are handled by the erasure
       * phase.
       * - The applied arguments are compatible with AnyRef, which means
       *   that an argument tree typed as AnyVal has already been extended
       *   with the necessary boxing calls. This implies that passed
       *   arguments might not be strictly compatible with the method's
       *   parameter types (a boxed integer while int is expected).
       * - The expected return type is an AnyRef, even when the method's
       *   return type is an AnyVal. This means that the tree containing the
       *   call has already been extended with the necessary unboxing calls
       *   (or is happy with the boxed type).
       * - The type-checker has prevented dynamic applies on methods which
       *   parameter's erased types are not statically known at the call site.
       *   This is necessary to allow dispatching the call to the correct
       *   method (dispatching on parameters is static in Scala). In practice,
       *   this limitation only arises when the called method is defined as a
       *   refinement, where the refinement defines a parameter based on a
       *   type variable. */</span>
      <span class="keyword">case</span> <a title="CleanUp.this.global.Tree" id="885170">ad</a>@ApplyDynamic<span class="delimiter">(</span><a title="CleanUp.this.global.Tree" id="885173">qual0</a>, <a title="List[CleanUp.this.global.Tree]" id="885174">params</a><span class="delimiter">)</span> =&gt;
        <span class="keyword">val</span> <a title="CleanUp.this.global.Tree =&gt; CleanUp.this.global.analyzer.global.Tree" id="885175">typedPos</a> = <a href="#885023" title="(pos: CleanUp.this.global.Position)(tree: CleanUp.this.global.Tree)CleanUp.this.global.analyzer.global.Tree">typedWithPos</a><a href="#885189" title="CleanUp.this.global.Tree" class="delimiter">(</a><a href="#885170" title="CleanUp.this.global.ApplyDynamic">ad</a>.<a href="../../../reflect/generic/Trees.scala.html#441024" title="=&gt; CleanUp.this.global.Position">pos</a><span class="delimiter">)</span> _

        <a href="../../../Predef.scala.html#9565" title="(assertion: Boolean)Unit">assert</a><span class="delimiter">(</span><a href="#885170" title="CleanUp.this.global.ApplyDynamic">ad</a>.<a href="../../../reflect/generic/Trees.scala.html#441600" title="=&gt; CleanUp.this.global.Symbol">symbol</a>.<a href="../../../reflect/generic/HasFlags.scala.html#435312" title="=&gt; Boolean">isPublic</a><span class="delimiter">)</span>
        <span class="keyword">var</span> <a title="CleanUp.this.global.Tree" id="885176">qual</a>: <a href="../../../reflect/generic/Trees.scala.html#434028" title="CleanUp.this.global.Tree">Tree</a> = <a href="#885173" title="CleanUp.this.global.Tree">qual0</a>

        <span class="comment">/* ### CREATING THE METHOD CACHE ### */</span>

        <span class="keyword">def</span> <a title="(forName: String, forType: CleanUp.this.global.Type, forInit: CleanUp.this.global.Tree, isFinal: Boolean)CleanUp.this.global.Symbol" id="885177">addStaticVariableToClass</a><span class="delimiter">(</span><a title="String" id="885192">forName</a>: <span title="String">String</span>, <a title="CleanUp.this.global.Type" id="885193">forType</a>: <a href="../symtab/Types.scala.html#478720" title="CleanUp.this.global.Type">Type</a>, <a title="CleanUp.this.global.Tree" id="885194">forInit</a>: <a href="../../../reflect/generic/Trees.scala.html#434028" title="CleanUp.this.global.Tree">Tree</a>, <a title="Boolean" id="885195">isFinal</a>: <a href="../../../Boolean.scala.html#65" title="Boolean">Boolean</a><span class="delimiter">)</span>: <a href="../symtab/Symbols.scala.html#478659" title="CleanUp.this.global.Symbol">Symbol</a> = <span class="delimiter">{</span>
          <span class="keyword">val</span> <a title="CleanUp.this.global.TermSymbol" id="885196">varSym</a> = <a href="../ast/Trees.scala.html#560337" title="=&gt; CleanUp.this.global.Symbol">currentClass</a>.<a href="../symtab/Symbols.scala.html#509127" title="(pos: CleanUp.this.global.Position, name: CleanUp.this.global.TermName)CleanUp.this.global.TermSymbol">newVariable</a><span class="delimiter">(</span><a href="#885170" title="CleanUp.this.global.ApplyDynamic">ad</a>.<a href="../../../reflect/generic/Trees.scala.html#441024" title="=&gt; CleanUp.this.global.Position">pos</a>, <a href="#885014" title="(prefix: String)CleanUp.this.global.TermName">mkTerm</a><span class="delimiter">(</span><a href="#885192" title="String">forName</a><span class="delimiter">)</span><span class="delimiter">)</span>
            .<a href="../symtab/Symbols.scala.html#509261" title="(mask: Long)CleanUp.this.global.TermSymbol">setFlag</a><span class="delimiter">(</span>PRIVATE | STATIC <span title="Long(10485764L)">|</span> SYNTHETIC<span class="delimiter">)</span>
            .<a href="../symtab/Symbols.scala.html#509274" title="(info: CleanUp.this.global.Type)CleanUp.this.global.TermSymbol">setInfo</a><span class="delimiter">(</span><a href="#885193" title="CleanUp.this.global.Type">forType</a><span class="delimiter">)</span>
          <span title="Any" class="keyword">if</span> <span class="delimiter">(</span><a href="#885195" title="Boolean">isFinal</a><span class="delimiter">)</span> <a href="#885196" title="CleanUp.this.global.TermSymbol">varSym</a> <a href="../symtab/Symbols.scala.html#509261" title="(mask: Long)varSym.type">setFlag</a> <span title="Long(32L)">FINAL</span> <span class="keyword">else</span> <a href="#885196" title="CleanUp.this.global.TermSymbol">varSym</a> <a href="../symtab/Symbols.scala.html#509118" title="(annot: CleanUp.this.global.AnnotationInfo)Unit">addAnnotation</a> <a href="../symtab/AnnotationInfos.scala.html#533292" title="(atp: CleanUp.this.global.Type, args: List[CleanUp.this.global.Tree], assocs: List[(CleanUp.this.global.Name, CleanUp.this.global.ClassfileAnnotArg)])CleanUp.this.global.AnnotationInfo">AnnotationInfo</a><span class="delimiter">(</span><a href="../symtab/Definitions.scala.html#508335" title="=&gt; CleanUp.this.global.Symbol">VolatileAttr</a>.<a href="../symtab/Symbols.scala.html#509270" title="=&gt; CleanUp.this.global.Type">tpe</a>, <a href="../../../collection/immutable/List.scala.html#13700" title="object Nil">Nil</a>, <a href="../../../collection/immutable/List.scala.html#13700" title="object Nil">Nil</a><span class="delimiter">)</span>
          <a href="../ast/Trees.scala.html#560337" title="=&gt; CleanUp.this.global.Symbol">currentClass</a>.<a href="../symtab/Symbols.scala.html#509272" title="=&gt; CleanUp.this.global.Type">info</a>.<a href="../symtab/Types.scala.html#507192" title="=&gt; CleanUp.this.global.Scope">decls</a> <a href="../symtab/Scopes.scala.html#514360" title="(sym: CleanUp.this.global.Symbol)CleanUp.this.global.Symbol">enter</a> <a href="#885196" title="CleanUp.this.global.TermSymbol">varSym</a>

          <span class="keyword">val</span> <a title="CleanUp.this.global.analyzer.global.Tree" id="885197">varDef</a> = <a href="../../../Function1.scala.html#53453" title="(v1: CleanUp.this.global.Tree)CleanUp.this.global.analyzer.global.Tree">typedPos</a><span class="delimiter">(</span> <a href="../ast/TreeDSL.scala.html#515227" title="(sym: CleanUp.this.global.Symbol)CleanUp.this.CODE.ValSymStart">VAL</a><span class="delimiter">(</span><a href="#885196" title="CleanUp.this.global.TermSymbol">varSym</a><span class="delimiter">)</span> <a href="../ast/TreeDSL.scala.html#548250" title="(rhs: CleanUp.this.global.Tree)CleanUp.this.global.ValDef">===</a> <a href="#885194" title="CleanUp.this.global.Tree">forInit</a> <span class="delimiter">)</span>
          <a href="#885008" title="=&gt; scala.collection.mutable.Buffer[CleanUp.this.global.Tree]">newStaticMembers</a> <a href="../../../collection/mutable/BufferLike.scala.html#61817" title="(elems: CleanUp.this.global.Tree*)Unit">append</a> <a href="#885027" title="(tree: CleanUp.this.global.Tree)CleanUp.this.global.Tree">transform</a><span class="delimiter">(</span><a href="#885197" title="CleanUp.this.global.analyzer.global.Tree">varDef</a><span class="delimiter">)</span>

          <span class="keyword">val</span> <a title="CleanUp.this.global.analyzer.global.Tree" id="885198">varInit</a> = <a href="../../../Function1.scala.html#53453" title="(v1: CleanUp.this.global.Tree)CleanUp.this.global.analyzer.global.Tree">typedPos</a><span class="delimiter">(</span> <a href="#885015" title="(sym: CleanUp.this.global.Symbol)CleanUp.this.global.gen.global.Tree">safeREF</a><a href="../ast/TreeDSL.scala.html#515248" title="implicit scala.tools.nsc.ast.TreeDSL.CODE.mkTreeMethods : (target: CleanUp.this.global.Tree)CleanUp.this.CODE.TreeMethods" class="delimiter">(</a><a href="#885196" title="CleanUp.this.global.TermSymbol">varSym</a><span class="delimiter">)</span> <a href="../ast/TreeDSL.scala.html#547507" title="(rhs: CleanUp.this.global.Tree)CleanUp.this.global.Assign">===</a> <a href="#885194" title="CleanUp.this.global.Tree">forInit</a> <span class="delimiter">)</span>
          <a href="#885010" title="=&gt; scala.collection.mutable.Buffer[CleanUp.this.global.Tree]">newStaticInits</a> <a href="../../../collection/mutable/BufferLike.scala.html#61817" title="(elems: CleanUp.this.global.Tree*)Unit">append</a> <a href="#885027" title="(tree: CleanUp.this.global.Tree)CleanUp.this.global.Tree">transform</a><span class="delimiter">(</span><a href="#885198" title="CleanUp.this.global.analyzer.global.Tree">varInit</a><span class="delimiter">)</span>

          <a href="#885196" title="CleanUp.this.global.TermSymbol">varSym</a>
        <span class="delimiter">}</span>

        <span class="keyword">def</span> <a title="(forName: String, forArgsTypes: List[CleanUp.this.global.Type], forResultType: CleanUp.this.global.Type)(forBody: ((CleanUp.this.global.Symbol, List[CleanUp.this.global.Symbol])) =&gt; CleanUp.this.global.Tree)CleanUp.this.global.Symbol" id="885178">addStaticMethodToClass</a><span class="delimiter">(</span><a title="String" id="885276">forName</a>: <span title="String">String</span>, <a title="List[CleanUp.this.global.Type]" id="885277">forArgsTypes</a>: <a href="../../../collection/immutable/List.scala.html#14047" title="List[CleanUp.this.global.Type]">List</a><span class="delimiter">[</span>Type<span class="delimiter">]</span>, <a title="CleanUp.this.global.Type" id="885278">forResultType</a>: <a href="../symtab/Types.scala.html#478720" title="CleanUp.this.global.Type">Type</a><span class="delimiter">)</span>
                                  <span class="delimiter">(</span><a title="((CleanUp.this.global.Symbol, List[CleanUp.this.global.Symbol])) =&gt; CleanUp.this.global.Tree" id="885279">forBody</a>: Pair<span class="delimiter">[</span>Symbol, List<span class="delimiter">[</span>Symbol<span class="delimiter">]</span><span class="delimiter">]</span> =&gt; Tree<span class="delimiter">)</span>: <a href="../symtab/Symbols.scala.html#478659" title="CleanUp.this.global.Symbol">Symbol</a> = <span class="delimiter">{</span>
          <span class="keyword">val</span> <a title="CleanUp.this.global.MethodSymbol" id="885280">methSym</a> = <a href="../ast/Trees.scala.html#560337" title="=&gt; CleanUp.this.global.Symbol">currentClass</a>.<a href="../symtab/Symbols.scala.html#509130" title="(pos: CleanUp.this.global.Position, name: CleanUp.this.global.TermName)CleanUp.this.global.MethodSymbol">newMethod</a><span class="delimiter">(</span><a href="#885170" title="CleanUp.this.global.ApplyDynamic">ad</a>.<a href="../../../reflect/generic/Trees.scala.html#441024" title="=&gt; CleanUp.this.global.Position">pos</a>, <a href="#885014" title="(prefix: String)CleanUp.this.global.TermName">mkTerm</a><span class="delimiter">(</span><a href="#885276" title="String">forName</a><span class="delimiter">)</span><span class="delimiter">)</span>
            .<a href="../symtab/Symbols.scala.html#509261" title="(mask: Long)CleanUp.this.global.MethodSymbol">setFlag</a><span class="delimiter">(</span>STATIC <span title="Long(10485760L)">|</span> SYNTHETIC<span class="delimiter">)</span>

          <a href="#885280" title="CleanUp.this.global.MethodSymbol">methSym</a>.<a href="../symtab/Symbols.scala.html#509274" title="(info: CleanUp.this.global.Type)methSym.type">setInfo</a><span class="delimiter">(</span><a href="../symtab/Types.scala.html#546837" title="(params: List[CleanUp.this.global.Symbol], resultType: CleanUp.this.global.Type)CleanUp.this.global.MethodType">MethodType</a><span class="delimiter">(</span><a href="#885280" title="CleanUp.this.global.MethodSymbol">methSym</a>.<a href="../symtab/Symbols.scala.html#509151" title="(argtypes: List[CleanUp.this.global.Type])List[CleanUp.this.global.Symbol]">newSyntheticValueParams</a><span class="delimiter">(</span><a href="#885277" title="List[CleanUp.this.global.Type]">forArgsTypes</a><span class="delimiter">)</span>, <a href="#885278" title="CleanUp.this.global.Type">forResultType</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <a href="../ast/Trees.scala.html#560337" title="=&gt; CleanUp.this.global.Symbol">currentClass</a>.<a href="../symtab/Symbols.scala.html#509272" title="=&gt; CleanUp.this.global.Type">info</a>.<a href="../symtab/Types.scala.html#507192" title="=&gt; CleanUp.this.global.Scope">decls</a> <a href="../symtab/Scopes.scala.html#514360" title="(sym: CleanUp.this.global.Symbol)CleanUp.this.global.Symbol">enter</a> <a href="#885280" title="CleanUp.this.global.MethodSymbol">methSym</a>

          <span class="keyword">val</span> <a title="CleanUp.this.global.analyzer.global.Tree" id="885281">methDef</a> = <a href="../../../Function1.scala.html#53453" title="(v1: CleanUp.this.global.Tree)CleanUp.this.global.analyzer.global.Tree">typedPos</a><span class="delimiter">(</span> <a href="../ast/Trees.scala.html#479132" title="(sym: CleanUp.this.global.Symbol, rhs: CleanUp.this.global.Tree)CleanUp.this.global.DefDef">DefDef</a><span class="delimiter">(</span><a href="#885280" title="CleanUp.this.global.MethodSymbol">methSym</a>, <span class="delimiter">{</span> <a href="../../../Function1.scala.html#53453" title="(v1: (CleanUp.this.global.Symbol, List[CleanUp.this.global.Symbol]))CleanUp.this.global.Tree">forBody</a><span class="delimiter">(</span><a href="../../../Predef.scala.html#57855" title="(x: CleanUp.this.global.MethodSymbol, y: List[CleanUp.this.global.Symbol])(CleanUp.this.global.MethodSymbol, List[CleanUp.this.global.Symbol])">Pair</a><span class="delimiter">(</span><a href="#885280" title="CleanUp.this.global.MethodSymbol">methSym</a>, <a href="#885280" title="CleanUp.this.global.MethodSymbol">methSym</a>.<a href="../../../collection/LinearSeqOptimized.scala.html#71031" title="(n: Int)List[CleanUp.this.global.Symbol]">paramss</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">}</span><span class="delimiter">)</span> <span class="delimiter">)</span>
          <a href="#885008" title="=&gt; scala.collection.mutable.Buffer[CleanUp.this.global.Tree]">newStaticMembers</a> <a href="../../../collection/mutable/BufferLike.scala.html#61817" title="(elems: CleanUp.this.global.Tree*)Unit">append</a> <a href="#885027" title="(tree: CleanUp.this.global.Tree)CleanUp.this.global.Tree">transform</a><span class="delimiter">(</span><a href="#885281" title="CleanUp.this.global.analyzer.global.Tree">methDef</a><span class="delimiter">)</span>

          <a href="#885280" title="CleanUp.this.global.MethodSymbol">methSym</a>
        <span class="delimiter">}</span>

        <span class="keyword">def</span> <a title="(paramTypes: List[CleanUp.this.global.Type])CleanUp.this.global.Tree" id="885179">fromTypesToClassArrayLiteral</a><span class="delimiter">(</span><a title="List[CleanUp.this.global.Type]" id="885378">paramTypes</a>: <a href="../../../collection/immutable/List.scala.html#14047" title="List[CleanUp.this.global.Type]">List</a><span class="delimiter">[</span>Type<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../../reflect/generic/Trees.scala.html#434028" title="CleanUp.this.global.Tree">Tree</a> =
          <a href="../../../reflect/generic/Trees.scala.html#443548" title="(elemtpt: CleanUp.this.global.Tree, elems: List[CleanUp.this.global.Tree])CleanUp.this.global.ArrayValue">ArrayValue</a><span class="delimiter">(</span><a href="../ast/Trees.scala.html#479149" title="(tp: CleanUp.this.global.Type)CleanUp.this.global.TypeTree">TypeTree</a><span class="delimiter">(</span><a href="../symtab/Definitions.scala.html#508009" title="=&gt; CleanUp.this.global.Symbol">ClassClass</a>.<a href="../symtab/Symbols.scala.html#509270" title="=&gt; CleanUp.this.global.Type">tpe</a><span class="delimiter">)</span>, <a href="#885378" title="List[CleanUp.this.global.Type]">paramTypes</a> <a href="../../../collection/TraversableLike.scala.html#49041" title="(f: CleanUp.this.global.Type =&gt; CleanUp.this.global.Literal)(implicit bf: scala.collection.generic.CanBuildFrom[List[CleanUp.this.global.Type],CleanUp.this.global.Literal,List[CleanUp.this.global.Tree]])List[CleanUp.this.global.Tree]">map</a> <a href="../ast/TreeDSL.scala.html#515184" title="object CleanUp.this.CODE.LIT">LIT</a><span class="delimiter">)</span>

        <span class="keyword">def</span> <a title="=&gt; CleanUp.this.global.Type" id="885180">theTypeClassArray</a> = <a href="../symtab/Definitions.scala.html#508202" title="(arg: CleanUp.this.global.Type)CleanUp.this.global.Type">arrayType</a><span class="delimiter">(</span><a href="../symtab/Definitions.scala.html#508009" title="=&gt; CleanUp.this.global.Symbol">ClassClass</a>.<a href="../symtab/Symbols.scala.html#509270" title="=&gt; CleanUp.this.global.Type">tpe</a><span class="delimiter">)</span>

        <span class="comment">/* ... */</span>
        <span class="keyword">def</span> <a title="(method: String, paramTypes: List[CleanUp.this.global.Type])CleanUp.this.global.Symbol" id="885181">reflectiveMethodCache</a><span class="delimiter">(</span><a title="String" id="885435">method</a>: <span title="String">String</span>, <a title="List[CleanUp.this.global.Type]" id="885436">paramTypes</a>: <a href="../../../collection/immutable/List.scala.html#14047" title="List[CleanUp.this.global.Type]">List</a><span class="delimiter">[</span>Type<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../symtab/Symbols.scala.html#478659" title="CleanUp.this.global.Symbol">Symbol</a> = <a href="#885022" title="()CleanUpTransformer.this.MethodDispatchType.Value">dispatchType</a> <span title="CleanUp.this.global.Symbol" class="keyword">match</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> <a href="#885074" title="CleanUp.this.global.Symbol">NO_CACHE</a> =&gt;

              <span class="comment">/* Implementation of the cache is as follows for method &quot;def xyz(a: A, b: B)&quot;:

                var reflParams$Cache: Array[Class[_]] = Array[JClass](classOf[A], classOf[B])

                def reflMethod$Method(forReceiver: JClass[_]): JMethod =
                  forReceiver.getMethod(&quot;xyz&quot;, reflParams$Cache)

              */</span>

              <span class="keyword">val</span> <a title="CleanUp.this.global.Symbol" id="885437">reflParamsCacheSym</a>: <a href="../symtab/Symbols.scala.html#478659" title="CleanUp.this.global.Symbol">Symbol</a> =
                <a href="#885177" title="(forName: String, forType: CleanUp.this.global.Type, forInit: CleanUp.this.global.Tree, isFinal: Boolean)CleanUp.this.global.Symbol">addStaticVariableToClass</a><span class="delimiter">(</span><span title="java.lang.String(&quot;reflParams$Cache&quot;)" class="string">&quot;reflParams$Cache&quot;</span>, <a href="#885180" title="=&gt; CleanUp.this.global.Type">theTypeClassArray</a>, <a href="#885179" title="(paramTypes: List[CleanUp.this.global.Type])CleanUp.this.global.Tree">fromTypesToClassArrayLiteral</a><span class="delimiter">(</span><a href="#885436" title="List[CleanUp.this.global.Type]">paramTypes</a><span class="delimiter">)</span>, <span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span>

              <a href="#885178" title="(forName: String, forArgsTypes: List[CleanUp.this.global.Type], forResultType: CleanUp.this.global.Type)(forBody: ((CleanUp.this.global.Symbol, List[CleanUp.this.global.Symbol])) =&gt; CleanUp.this.global.Tree)CleanUp.this.global.Symbol">addStaticMethodToClass</a><span class="delimiter">(</span><span title="java.lang.String(&quot;reflMethod$Method&quot;)" class="string">&quot;reflMethod$Method&quot;</span>, <a href="../../../collection/immutable/List.scala.html#48877" title="(xs: CleanUp.this.global.Type*)List[CleanUp.this.global.Type]">List</a><span class="delimiter">(</span><a href="../symtab/Definitions.scala.html#508009" title="=&gt; CleanUp.this.global.Symbol">ClassClass</a>.<a href="../symtab/Symbols.scala.html#509270" title="=&gt; CleanUp.this.global.Type">tpe</a><span class="delimiter">)</span>, <a href="../symtab/Definitions.scala.html#508110" title="=&gt; CleanUp.this.global.Symbol">MethodClass</a>.<a href="../symtab/Symbols.scala.html#509270" title="=&gt; CleanUp.this.global.Type">tpe</a><span class="delimiter">)</span> <a href="#885446" title="CleanUp.this.global.Tree" class="delimiter">{</a>
                <span class="keyword">case</span> <a href="../../../Predef.scala.html#57860" title="CleanUp.this.global.Apply">Pair</a><span class="delimiter">(</span><a title="CleanUp.this.global.Symbol" id="885455">reflMethodSym</a>, <a href="../../../collection/generic/GenSeqFactory.scala.html#48862" title="(x: List[CleanUp.this.global.Symbol])Some[List[CleanUp.this.global.Symbol]]">List</a><span class="delimiter">(</span><a title="CleanUp.this.global.Symbol" id="885468">forReceiverSym</a><span class="delimiter">)</span><span class="delimiter">)</span> =&gt;
                  <span class="delimiter">(</span><a href="../ast/TreeDSL.scala.html#515243" title="(sym: CleanUp.this.global.Symbol)CleanUp.this.global.gen.global.Tree">REF</a><a href="../ast/TreeDSL.scala.html#515248" title="implicit scala.tools.nsc.ast.TreeDSL.CODE.mkTreeMethods : (target: CleanUp.this.global.Tree)CleanUp.this.CODE.TreeMethods" class="delimiter">(</a><a href="#885468" title="CleanUp.this.global.Symbol">forReceiverSym</a><span class="delimiter">)</span> <a href="../ast/TreeDSL.scala.html#547472" title="(args: CleanUp.this.global.Tree*)CleanUp.this.global.Apply">DOT</a> <a href="../symtab/Definitions.scala.html#508011" title="=&gt; CleanUp.this.global.Symbol">Class_getMethod</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="../ast/TreeDSL.scala.html#547417" title="(x: Any)CleanUp.this.global.Literal">LIT</a><span class="delimiter">(</span><a href="#885435" title="String">method</a><span class="delimiter">)</span>, <a href="#885015" title="(sym: CleanUp.this.global.Symbol)CleanUp.this.global.gen.global.Tree">safeREF</a><span class="delimiter">(</span><a href="#885437" title="CleanUp.this.global.Symbol">reflParamsCacheSym</a><span class="delimiter">)</span><span class="delimiter">)</span>
              <span class="delimiter">}</span>

            <span class="keyword">case</span> <a href="#885076" title="CleanUp.this.global.Symbol">MONO_CACHE</a> =&gt;

              <span class="comment">/* Implementation of the cache is as follows for method &quot;def xyz(a: A, b: B)&quot;
                 (but with a SoftReference wrapping reflClass$Cache, similarly in the poly Cache) :

                var reflParams$Cache: Array[Class[_]] = Array[JClass](classOf[A], classOf[B])

                var reflMethod$Cache: JMethod = null

                var reflClass$Cache: JClass[_] = null

                def reflMethod$Method(forReceiver: JClass[_]): JMethod = {
                  if (reflClass$Cache != forReceiver) {
                    reflMethod$Cache = forReceiver.getMethod(&quot;xyz&quot;, reflParams$Cache)
                    reflClass$Cache = forReceiver
                  }
                  reflMethod$Cache
                }

              */</span>

              <span class="keyword">val</span> <a title="CleanUp.this.global.Symbol" id="885486">reflParamsCacheSym</a>: <a href="../symtab/Symbols.scala.html#478659" title="CleanUp.this.global.Symbol">Symbol</a> =
                <a href="#885177" title="(forName: String, forType: CleanUp.this.global.Type, forInit: CleanUp.this.global.Tree, isFinal: Boolean)CleanUp.this.global.Symbol">addStaticVariableToClass</a><span class="delimiter">(</span><span title="java.lang.String(&quot;reflParams$Cache&quot;)" class="string">&quot;reflParams$Cache&quot;</span>, <a href="#885180" title="=&gt; CleanUp.this.global.Type">theTypeClassArray</a>, <a href="#885179" title="(paramTypes: List[CleanUp.this.global.Type])CleanUp.this.global.Tree">fromTypesToClassArrayLiteral</a><span class="delimiter">(</span><a href="#885436" title="List[CleanUp.this.global.Type]">paramTypes</a><span class="delimiter">)</span>, <span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span>

              <span class="keyword">val</span> <a title="CleanUp.this.global.Symbol" id="885487">reflMethodCacheSym</a>: <a href="../symtab/Symbols.scala.html#478659" title="CleanUp.this.global.Symbol">Symbol</a> =
                <a href="#885177" title="(forName: String, forType: CleanUp.this.global.Type, forInit: CleanUp.this.global.Tree, isFinal: Boolean)CleanUp.this.global.Symbol">addStaticVariableToClass</a><span class="delimiter">(</span><span title="java.lang.String(&quot;reflMethod$Cache&quot;)" class="string">&quot;reflMethod$Cache&quot;</span>, <a href="../symtab/Definitions.scala.html#508110" title="=&gt; CleanUp.this.global.Symbol">MethodClass</a>.<a href="../symtab/Symbols.scala.html#509270" title="=&gt; CleanUp.this.global.Type">tpe</a>, <a href="../ast/TreeDSL.scala.html#515192" title="=&gt; CleanUp.this.global.Literal">NULL</a>, <span title="Boolean(false)" class="keyword">false</span><span class="delimiter">)</span>

              <span class="keyword">val</span> <a title="CleanUp.this.global.Symbol" id="885488">reflClassCacheSym</a>: <a href="../symtab/Symbols.scala.html#478659" title="CleanUp.this.global.Symbol">Symbol</a> =
                <a href="#885177" title="(forName: String, forType: CleanUp.this.global.Type, forInit: CleanUp.this.global.Tree, isFinal: Boolean)CleanUp.this.global.Symbol">addStaticVariableToClass</a><span class="delimiter">(</span><span title="java.lang.String(&quot;reflClass$Cache&quot;)" class="string">&quot;reflClass$Cache&quot;</span>, <a href="../symtab/Definitions.scala.html#508106" title="=&gt; CleanUp.this.global.Symbol">SoftReferenceClass</a>.<a href="../symtab/Symbols.scala.html#509270" title="=&gt; CleanUp.this.global.Type">tpe</a>, <a href="../ast/TreeDSL.scala.html#515192" title="=&gt; CleanUp.this.global.Literal">NULL</a>, <span title="Boolean(false)" class="keyword">false</span><span class="delimiter">)</span>

              <span class="keyword">def</span> <a title="=&gt; CleanUp.this.global.Symbol" id="885489">getMethodSym</a> = <a href="../symtab/Definitions.scala.html#508009" title="=&gt; CleanUp.this.global.Symbol">ClassClass</a>.<a href="../symtab/Symbols.scala.html#509270" title="=&gt; CleanUp.this.global.Type">tpe</a> <a href="../symtab/Types.scala.html#507200" title="(name: CleanUp.this.global.Name)CleanUp.this.global.Symbol">member</a> <a href="../symtab/StdNames.scala.html#479055" title="object CleanUp.this.global.nme">nme</a>.<a href="../symtab/StdNames.scala.html#516796" title="=&gt; CleanUp.this.global.TermName">getMethod_</a>

              <span class="keyword">def</span> <a title="(receiver: CleanUp.this.global.Symbol)CleanUp.this.global.Tree" id="885490">isCacheEmpty</a><span class="delimiter">(</span><a title="CleanUp.this.global.Symbol" id="885492">receiver</a>: <a href="../symtab/Symbols.scala.html#478659" title="CleanUp.this.global.Symbol">Symbol</a><span class="delimiter">)</span>: <a href="../../../reflect/generic/Trees.scala.html#434028" title="CleanUp.this.global.Tree">Tree</a> =
                <a href="../ast/TreeDSL.scala.html#515250" title="implicit scala.tools.nsc.ast.TreeDSL.CODE.mkSymbolMethodsFromSymbol : (target: CleanUp.this.global.Symbol)CleanUp.this.CODE.SymbolMethods">reflClassCacheSym</a>.<a href="../ast/TreeDSL.scala.html#548735" title="()CleanUp.this.global.Apply">IS_NULL</a><a href="../ast/TreeDSL.scala.html#515248" title="implicit scala.tools.nsc.ast.TreeDSL.CODE.mkTreeMethods : (target: CleanUp.this.global.Tree)CleanUp.this.CODE.TreeMethods" class="delimiter">(</a><span class="delimiter">)</span> <a href="../ast/TreeDSL.scala.html#547485" title="(other: CleanUp.this.global.Tree)CleanUp.this.global.Tree">OR</a> <span class="delimiter">(</span><a href="../ast/TreeDSL.scala.html#515250" title="implicit scala.tools.nsc.ast.TreeDSL.CODE.mkSymbolMethodsFromSymbol : (target: CleanUp.this.global.Symbol)CleanUp.this.CODE.SymbolMethods">reflClassCacheSym</a>.<a href="../ast/TreeDSL.scala.html#548737" title="()CleanUp.this.global.Apply">GET</a><a href="../ast/TreeDSL.scala.html#515248" title="implicit scala.tools.nsc.ast.TreeDSL.CODE.mkTreeMethods : (target: CleanUp.this.global.Tree)CleanUp.this.CODE.TreeMethods" class="delimiter">(</a><span class="delimiter">)</span> <a href="../ast/TreeDSL.scala.html#547494" title="(other: CleanUp.this.global.Tree)CleanUp.this.global.Apply">OBJ_NE</a> <a href="../ast/TreeDSL.scala.html#515243" title="(sym: CleanUp.this.global.Symbol)CleanUp.this.global.gen.global.Tree">REF</a><span class="delimiter">(</span><a href="#885492" title="CleanUp.this.global.Symbol">receiver</a><span class="delimiter">)</span><span class="delimiter">)</span>

              <a href="#885178" title="(forName: String, forArgsTypes: List[CleanUp.this.global.Type], forResultType: CleanUp.this.global.Type)(forBody: ((CleanUp.this.global.Symbol, List[CleanUp.this.global.Symbol])) =&gt; CleanUp.this.global.Tree)CleanUp.this.global.Symbol">addStaticMethodToClass</a><span class="delimiter">(</span><span title="java.lang.String(&quot;reflMethod$Method&quot;)" class="string">&quot;reflMethod$Method&quot;</span>, <a href="../../../collection/immutable/List.scala.html#48877" title="(xs: CleanUp.this.global.Type*)List[CleanUp.this.global.Type]">List</a><span class="delimiter">(</span><a href="../symtab/Definitions.scala.html#508009" title="=&gt; CleanUp.this.global.Symbol">ClassClass</a>.<a href="../symtab/Symbols.scala.html#509270" title="=&gt; CleanUp.this.global.Type">tpe</a><span class="delimiter">)</span>, <a href="../symtab/Definitions.scala.html#508110" title="=&gt; CleanUp.this.global.Symbol">MethodClass</a>.<a href="../symtab/Symbols.scala.html#509270" title="=&gt; CleanUp.this.global.Type">tpe</a><span class="delimiter">)</span> <a href="#885523" title="CleanUp.this.global.Tree" class="delimiter">{</a>
                <span class="keyword">case</span> <a href="../../../Predef.scala.html#57860" title="CleanUp.this.global.Block">Pair</a><span class="delimiter">(</span><a title="CleanUp.this.global.Symbol" id="885532">reflMethodSym</a>, <a href="../../../collection/generic/GenSeqFactory.scala.html#48862" title="(x: List[CleanUp.this.global.Symbol])Some[List[CleanUp.this.global.Symbol]]">List</a><span class="delimiter">(</span><a title="CleanUp.this.global.Symbol" id="885545">forReceiverSym</a><span class="delimiter">)</span><span class="delimiter">)</span> =&gt;
                  <a href="../ast/TreeDSL.scala.html#515238" title="(xs: CleanUp.this.global.Tree*)CleanUp.this.global.Block">BLOCK</a><span class="delimiter">(</span>
                    <a href="../ast/TreeDSL.scala.html#515236" title="(tree: CleanUp.this.global.Tree)CleanUp.this.CODE.IfStart">IF</a> <span class="delimiter">(</span><a href="#885490" title="(receiver: CleanUp.this.global.Symbol)CleanUp.this.global.Tree">isCacheEmpty</a><span class="delimiter">(</span><a href="#885545" title="CleanUp.this.global.Symbol">forReceiverSym</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../ast/TreeDSL.scala.html#547456" title="(x: CleanUp.this.global.Tree)CleanUp.this.CODE.IfStart">THEN</a> <a href="../ast/TreeDSL.scala.html#515238" title="(xs: CleanUp.this.global.Tree*)CleanUp.this.global.Block">BLOCK</a><span class="delimiter">(</span>
                      <a href="#885015" title="(sym: CleanUp.this.global.Symbol)CleanUp.this.global.gen.global.Tree">safeREF</a><a href="../ast/TreeDSL.scala.html#515248" title="implicit scala.tools.nsc.ast.TreeDSL.CODE.mkTreeMethods : (target: CleanUp.this.global.Tree)CleanUp.this.CODE.TreeMethods" class="delimiter">(</a><a href="#885487" title="CleanUp.this.global.Symbol">reflMethodCacheSym</a><span class="delimiter">)</span> <a href="../ast/TreeDSL.scala.html#547507" title="(rhs: CleanUp.this.global.Tree)CleanUp.this.global.Assign">===</a> <span class="delimiter">(</span><span class="delimiter">(</span><a href="../ast/TreeDSL.scala.html#515243" title="(sym: CleanUp.this.global.Symbol)CleanUp.this.global.gen.global.Tree">REF</a><a href="../ast/TreeDSL.scala.html#515248" title="implicit scala.tools.nsc.ast.TreeDSL.CODE.mkTreeMethods : (target: CleanUp.this.global.Tree)CleanUp.this.CODE.TreeMethods" class="delimiter">(</a><a href="#885545" title="CleanUp.this.global.Symbol">forReceiverSym</a><span class="delimiter">)</span> <a href="../ast/TreeDSL.scala.html#547472" title="(args: CleanUp.this.global.Tree*)CleanUp.this.global.Apply">DOT</a> <a href="#885489" title="=&gt; CleanUp.this.global.Symbol">getMethodSym</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="../ast/TreeDSL.scala.html#547417" title="(x: Any)CleanUp.this.global.Literal">LIT</a><span class="delimiter">(</span><a href="#885435" title="String">method</a><span class="delimiter">)</span>, <a href="#885015" title="(sym: CleanUp.this.global.Symbol)CleanUp.this.global.gen.global.Tree">safeREF</a><span class="delimiter">(</span><a href="#885486" title="CleanUp.this.global.Symbol">reflParamsCacheSym</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span> ,
                      <a href="#885015" title="(sym: CleanUp.this.global.Symbol)CleanUp.this.global.gen.global.Tree">safeREF</a><a href="../ast/TreeDSL.scala.html#515248" title="implicit scala.tools.nsc.ast.TreeDSL.CODE.mkTreeMethods : (target: CleanUp.this.global.Tree)CleanUp.this.CODE.TreeMethods" class="delimiter">(</a><a href="#885488" title="CleanUp.this.global.Symbol">reflClassCacheSym</a><span class="delimiter">)</span> <a href="../ast/TreeDSL.scala.html#547507" title="(rhs: CleanUp.this.global.Tree)CleanUp.this.global.Assign">===</a> <a href="../Global.scala.html#478214" title="object CleanUp.this.global.gen">gen</a>.<a href="../ast/TreeGen.scala.html#507295" title="(expr: CleanUp.this.global.gen.global.Tree)CleanUp.this.global.gen.global.Tree">mkSoftRef</a><span class="delimiter">(</span><a href="../ast/TreeDSL.scala.html#515243" title="(sym: CleanUp.this.global.Symbol)CleanUp.this.global.gen.global.Tree">REF</a><span class="delimiter">(</span><a href="#885545" title="CleanUp.this.global.Symbol">forReceiverSym</a><span class="delimiter">)</span><span class="delimiter">)</span>,
                      <a href="../ast/TreeDSL.scala.html#515193" title="=&gt; CleanUp.this.global.Literal">UNIT</a>
                    <span class="delimiter">)</span> <a href="../ast/TreeDSL.scala.html#547458" title="=&gt; CleanUp.this.global.If">ENDIF</a>,
                    <a href="#885015" title="(sym: CleanUp.this.global.Symbol)CleanUp.this.global.gen.global.Tree">safeREF</a><span class="delimiter">(</span><a href="#885487" title="CleanUp.this.global.Symbol">reflMethodCacheSym</a><span class="delimiter">)</span>
                  <span class="delimiter">)</span>
              <span class="delimiter">}</span>

            <span class="keyword">case</span> <a href="#885078" title="CleanUp.this.global.Symbol">POLY_CACHE</a> =&gt;

              <span class="comment">/* Implementation of the cache is as follows for method &quot;def xyz(a: A, b: B)&quot;
                 (SoftReference so that it does not interfere with classloader garbage collection, see ticket
                 #2365 for details):

                var reflParams$Cache: Array[Class[_]] = Array[JClass](classOf[A], classOf[B])

                var reflPoly$Cache: SoftReference[scala.runtime.MethodCache] = new SoftReference(new EmptyMethodCache())

                def reflMethod$Method(forReceiver: JClass[_]): JMethod = {
                  var method: JMethod = reflPoly$Cache.find(forReceiver)
                  if (method != null)
                    return method
                  else {
                    method = ScalaRunTime.ensureAccessible(forReceiver.getMethod(&quot;xyz&quot;, reflParams$Cache))
                    reflPoly$Cache = new SoftReference(reflPoly$Cache.get.add(forReceiver, method))
                    return method
                  }
                }

              */</span>

              <span class="keyword">val</span> <a title="CleanUp.this.global.Symbol" id="885574">reflParamsCacheSym</a>: <a href="../symtab/Symbols.scala.html#478659" title="CleanUp.this.global.Symbol">Symbol</a> =
                <a href="#885177" title="(forName: String, forType: CleanUp.this.global.Type, forInit: CleanUp.this.global.Tree, isFinal: Boolean)CleanUp.this.global.Symbol">addStaticVariableToClass</a><span class="delimiter">(</span><span title="java.lang.String(&quot;reflParams$Cache&quot;)" class="string">&quot;reflParams$Cache&quot;</span>, <a href="#885180" title="=&gt; CleanUp.this.global.Type">theTypeClassArray</a>, <a href="#885179" title="(paramTypes: List[CleanUp.this.global.Type])CleanUp.this.global.Tree">fromTypesToClassArrayLiteral</a><span class="delimiter">(</span><a href="#885436" title="List[CleanUp.this.global.Type]">paramTypes</a><span class="delimiter">)</span>, <span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span>

              <span class="keyword">def</span> <a title="=&gt; CleanUp.this.global.gen.global.Tree" id="885575">mkNewPolyCache</a> = <a href="../Global.scala.html#478214" title="object CleanUp.this.global.gen">gen</a>.<a href="../ast/TreeGen.scala.html#507295" title="(expr: CleanUp.this.global.gen.global.Tree)CleanUp.this.global.gen.global.Tree">mkSoftRef</a><span class="delimiter">(</span><a href="../ast/TreeDSL.scala.html#515220" title="(tpe: CleanUp.this.global.Tree, args: CleanUp.this.global.Tree*)CleanUp.this.global.Tree">NEW</a><span class="delimiter">(</span><a href="../ast/Trees.scala.html#479149" title="(tp: CleanUp.this.global.Type)CleanUp.this.global.TypeTree">TypeTree</a><span class="delimiter">(</span><a href="../symtab/Definitions.scala.html#508113" title="=&gt; CleanUp.this.global.Symbol">EmptyMethodCacheClass</a>.<a href="../symtab/Symbols.scala.html#509270" title="=&gt; CleanUp.this.global.Type">tpe</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
              <span class="keyword">val</span> <a title="CleanUp.this.global.Symbol" id="885576">reflPolyCacheSym</a>: <a href="../symtab/Symbols.scala.html#478659" title="CleanUp.this.global.Symbol">Symbol</a> = <a href="#885177" title="(forName: String, forType: CleanUp.this.global.Type, forInit: CleanUp.this.global.Tree, isFinal: Boolean)CleanUp.this.global.Symbol">addStaticVariableToClass</a><span class="delimiter">(</span><span title="java.lang.String(&quot;reflPoly$Cache&quot;)" class="string">&quot;reflPoly$Cache&quot;</span>, <a href="../symtab/Definitions.scala.html#508106" title="=&gt; CleanUp.this.global.Symbol">SoftReferenceClass</a>.<a href="../symtab/Symbols.scala.html#509270" title="=&gt; CleanUp.this.global.Type">tpe</a>, <a href="#885575" title="=&gt; CleanUp.this.global.gen.global.Tree">mkNewPolyCache</a>, <span title="Boolean(false)" class="keyword">false</span><span class="delimiter">)</span>
              <span class="keyword">def</span> <a title="=&gt; CleanUp.this.global.Tree" id="885577">getPolyCache</a> = <a href="../ast/TreeDSL.scala.html#515196" title="(lhs: CleanUp.this.global.Tree, op: CleanUp.this.global.Name, args: CleanUp.this.global.Tree*)CleanUp.this.global.Apply">fn</a><a href="../ast/TreeDSL.scala.html#515248" title="implicit scala.tools.nsc.ast.TreeDSL.CODE.mkTreeMethods : (target: CleanUp.this.global.Tree)CleanUp.this.CODE.TreeMethods" class="delimiter">(</a><a href="#885015" title="(sym: CleanUp.this.global.Symbol)CleanUp.this.global.gen.global.Tree">safeREF</a><span class="delimiter">(</span><a href="#885576" title="CleanUp.this.global.Symbol">reflPolyCacheSym</a><span class="delimiter">)</span>, <a href="../symtab/StdNames.scala.html#479055" title="object CleanUp.this.global.nme">nme</a>.<a href="../symtab/StdNames.scala.html#516638" title="=&gt; CleanUp.this.global.nme.NameType">get</a><span class="delimiter">)</span> <a href="../ast/TreeDSL.scala.html#547511" title="(tpe: CleanUp.this.global.Type)CleanUp.this.global.Tree">AS_ATTR</a> <a href="../symtab/Definitions.scala.html#508115" title="=&gt; CleanUp.this.global.Symbol">MethodCacheClass</a>.<a href="../symtab/Symbols.scala.html#509270" title="=&gt; CleanUp.this.global.Type">tpe</a>

              <a href="#885178" title="(forName: String, forArgsTypes: List[CleanUp.this.global.Type], forResultType: CleanUp.this.global.Type)(forBody: ((CleanUp.this.global.Symbol, List[CleanUp.this.global.Symbol])) =&gt; CleanUp.this.global.Tree)CleanUp.this.global.Symbol">addStaticMethodToClass</a><span class="delimiter">(</span><span title="java.lang.String(&quot;reflMethod$Method&quot;)" class="string">&quot;reflMethod$Method&quot;</span>, <a href="../../../collection/immutable/List.scala.html#48877" title="(xs: CleanUp.this.global.Type*)List[CleanUp.this.global.Type]">List</a><span class="delimiter">(</span><a href="../symtab/Definitions.scala.html#508009" title="=&gt; CleanUp.this.global.Symbol">ClassClass</a>.<a href="../symtab/Symbols.scala.html#509270" title="=&gt; CleanUp.this.global.Type">tpe</a><span class="delimiter">)</span>, <a href="../symtab/Definitions.scala.html#508110" title="=&gt; CleanUp.this.global.Symbol">MethodClass</a>.<a href="../symtab/Symbols.scala.html#509270" title="=&gt; CleanUp.this.global.Type">tpe</a><span class="delimiter">)</span>
                <a href="#885614" title="CleanUp.this.global.Tree" class="delimiter">{</a> <span class="keyword">case</span> <a href="../../../Predef.scala.html#57860" title="CleanUp.this.global.Block">Pair</a><span class="delimiter">(</span><a title="CleanUp.this.global.Symbol" id="885623">reflMethodSym</a>, <a href="../../../collection/generic/GenSeqFactory.scala.html#48862" title="(x: List[CleanUp.this.global.Symbol])Some[List[CleanUp.this.global.Symbol]]">List</a><span class="delimiter">(</span><a title="CleanUp.this.global.Symbol" id="885636">forReceiverSym</a><span class="delimiter">)</span><span class="delimiter">)</span> =&gt;
                  <span class="keyword">val</span> <a title="CleanUp.this.global.TermSymbol" id="885637">methodSym</a> = <a href="#885623" title="CleanUp.this.global.Symbol">reflMethodSym</a>.<a href="../symtab/Symbols.scala.html#509127" title="(pos: CleanUp.this.global.Position, name: CleanUp.this.global.TermName)CleanUp.this.global.TermSymbol">newVariable</a><span class="delimiter">(</span><a href="#885170" title="CleanUp.this.global.ApplyDynamic">ad</a>.<a href="../../../reflect/generic/Trees.scala.html#441024" title="=&gt; CleanUp.this.global.Position">pos</a>, <a href="#885014" title="(prefix: String)CleanUp.this.global.TermName">mkTerm</a><span class="delimiter">(</span><span title="java.lang.String(&quot;method&quot;)" class="string">&quot;method&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../symtab/Symbols.scala.html#509274" title="(info: CleanUp.this.global.Type)CleanUp.this.global.TermSymbol">setInfo</a> <a href="../symtab/Definitions.scala.html#508110" title="=&gt; CleanUp.this.global.Symbol">MethodClass</a>.<a href="../symtab/Symbols.scala.html#509270" title="=&gt; CleanUp.this.global.Type">tpe</a>

                  <a href="../ast/TreeDSL.scala.html#515238" title="(xs: CleanUp.this.global.Tree*)CleanUp.this.global.Block">BLOCK</a><span class="delimiter">(</span>
                    <a href="../ast/TreeDSL.scala.html#515236" title="(tree: CleanUp.this.global.Tree)CleanUp.this.CODE.IfStart">IF</a> <span class="delimiter">(</span><a href="../ast/TreeDSL.scala.html#515248" title="implicit scala.tools.nsc.ast.TreeDSL.CODE.mkTreeMethods : (target: CleanUp.this.global.Tree)CleanUp.this.CODE.TreeMethods">getPolyCache</a> <a href="../ast/TreeDSL.scala.html#547493" title="(other: CleanUp.this.global.Tree)CleanUp.this.global.Apply">OBJ_EQ</a> <a href="../ast/TreeDSL.scala.html#515192" title="=&gt; CleanUp.this.global.Literal">NULL</a><span class="delimiter">)</span> <a href="../ast/TreeDSL.scala.html#547456" title="(x: CleanUp.this.global.Tree)CleanUp.this.CODE.IfStart">THEN</a> <span class="delimiter">(</span><a href="#885015" title="(sym: CleanUp.this.global.Symbol)CleanUp.this.global.gen.global.Tree">safeREF</a><a href="../ast/TreeDSL.scala.html#515248" title="implicit scala.tools.nsc.ast.TreeDSL.CODE.mkTreeMethods : (target: CleanUp.this.global.Tree)CleanUp.this.CODE.TreeMethods" class="delimiter">(</a><a href="#885576" title="CleanUp.this.global.Symbol">reflPolyCacheSym</a><span class="delimiter">)</span> <a href="../ast/TreeDSL.scala.html#547507" title="(rhs: CleanUp.this.global.Tree)CleanUp.this.global.Assign">===</a> <a href="#885575" title="=&gt; CleanUp.this.global.gen.global.Tree">mkNewPolyCache</a><span class="delimiter">)</span> <a href="../ast/TreeDSL.scala.html#547458" title="=&gt; CleanUp.this.global.If">ENDIF</a>,
                    <a href="../ast/TreeDSL.scala.html#515227" title="(sym: CleanUp.this.global.Symbol)CleanUp.this.CODE.ValSymStart">VAL</a><span class="delimiter">(</span><a href="#885637" title="CleanUp.this.global.TermSymbol">methodSym</a><span class="delimiter">)</span> <a href="../ast/TreeDSL.scala.html#548250" title="(rhs: CleanUp.this.global.Tree)CleanUp.this.global.ValDef">===</a> <span class="delimiter">(</span><span class="delimiter">(</span><a href="../ast/TreeDSL.scala.html#515248" title="implicit scala.tools.nsc.ast.TreeDSL.CODE.mkTreeMethods : (target: CleanUp.this.global.Tree)CleanUp.this.CODE.TreeMethods">getPolyCache</a> <a href="../ast/TreeDSL.scala.html#547472" title="(args: CleanUp.this.global.Tree*)CleanUp.this.global.Apply">DOT</a> <a href="../symtab/Definitions.scala.html#508117" title="=&gt; CleanUp.this.global.Symbol">methodCache_find</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="../ast/TreeDSL.scala.html#515243" title="(sym: CleanUp.this.global.Symbol)CleanUp.this.global.gen.global.Tree">REF</a><span class="delimiter">(</span><a href="#885636" title="CleanUp.this.global.Symbol">forReceiverSym</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span> ,
                    <a href="../ast/TreeDSL.scala.html#515236" title="(tree: CleanUp.this.global.Tree)CleanUp.this.CODE.IfStart">IF</a> <span class="delimiter">(</span><a href="../ast/TreeDSL.scala.html#515243" title="(sym: CleanUp.this.global.Symbol)CleanUp.this.global.gen.global.Tree">REF</a><a href="../ast/TreeDSL.scala.html#515248" title="implicit scala.tools.nsc.ast.TreeDSL.CODE.mkTreeMethods : (target: CleanUp.this.global.Tree)CleanUp.this.CODE.TreeMethods" class="delimiter">(</a><a href="#885637" title="CleanUp.this.global.TermSymbol">methodSym</a><span class="delimiter">)</span> <a href="../ast/TreeDSL.scala.html#547492" title="(other: CleanUp.this.global.Tree)CleanUp.this.global.Apply">OBJ_!=</a> <a href="../ast/TreeDSL.scala.html#515192" title="=&gt; CleanUp.this.global.Literal">NULL</a><span class="delimiter">)</span> .
                      <a href="../ast/TreeDSL.scala.html#547456" title="(x: CleanUp.this.global.Tree)CleanUp.this.CODE.IfStart">THEN</a> <span class="delimiter">(</span><a href="../../../reflect/generic/Trees.scala.html#443707" title="(expr: CleanUp.this.global.Tree)CleanUp.this.global.Return">Return</a><span class="delimiter">(</span><a href="../ast/TreeDSL.scala.html#515243" title="(sym: CleanUp.this.global.Symbol)CleanUp.this.global.gen.global.Tree">REF</a><span class="delimiter">(</span><a href="#885637" title="CleanUp.this.global.TermSymbol">methodSym</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
                    <a href="../ast/TreeDSL.scala.html#547457" title="(elsep: CleanUp.this.global.Tree)CleanUp.this.global.If">ELSE</a> <span class="delimiter">{</span>
                      <span class="keyword">def</span> <a title="=&gt; CleanUp.this.global.Apply" id="885689">methodSymRHS</a>  = <span class="delimiter">(</span><span class="delimiter">(</span><a href="../ast/TreeDSL.scala.html#515243" title="(sym: CleanUp.this.global.Symbol)CleanUp.this.global.gen.global.Tree">REF</a><a href="../ast/TreeDSL.scala.html#515248" title="implicit scala.tools.nsc.ast.TreeDSL.CODE.mkTreeMethods : (target: CleanUp.this.global.Tree)CleanUp.this.CODE.TreeMethods" class="delimiter">(</a><a href="#885636" title="CleanUp.this.global.Symbol">forReceiverSym</a><span class="delimiter">)</span> <a href="../ast/TreeDSL.scala.html#547472" title="(args: CleanUp.this.global.Tree*)CleanUp.this.global.Apply">DOT</a> <a href="../symtab/Definitions.scala.html#508011" title="=&gt; CleanUp.this.global.Symbol">Class_getMethod</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="../ast/TreeDSL.scala.html#547417" title="(x: Any)CleanUp.this.global.Literal">LIT</a><span class="delimiter">(</span><a href="#885435" title="String">method</a><span class="delimiter">)</span>, <a href="#885015" title="(sym: CleanUp.this.global.Symbol)CleanUp.this.global.gen.global.Tree">safeREF</a><span class="delimiter">(</span><a href="#885574" title="CleanUp.this.global.Symbol">reflParamsCacheSym</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
                      <span class="keyword">def</span> <a title="=&gt; CleanUp.this.global.Apply" id="885690">cacheRHS</a>      = <span class="delimiter">(</span><span class="delimiter">(</span><a href="../ast/TreeDSL.scala.html#515248" title="implicit scala.tools.nsc.ast.TreeDSL.CODE.mkTreeMethods : (target: CleanUp.this.global.Tree)CleanUp.this.CODE.TreeMethods">getPolyCache</a> <a href="../ast/TreeDSL.scala.html#547472" title="(args: CleanUp.this.global.Tree*)CleanUp.this.global.Apply">DOT</a> <a href="../symtab/Definitions.scala.html#508118" title="=&gt; CleanUp.this.global.Symbol">methodCache_add</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="../ast/TreeDSL.scala.html#515243" title="(sym: CleanUp.this.global.Symbol)CleanUp.this.global.gen.global.Tree">REF</a><span class="delimiter">(</span><a href="#885636" title="CleanUp.this.global.Symbol">forReceiverSym</a><span class="delimiter">)</span>, <a href="../ast/TreeDSL.scala.html#515243" title="(sym: CleanUp.this.global.Symbol)CleanUp.this.global.gen.global.Tree">REF</a><span class="delimiter">(</span><a href="#885637" title="CleanUp.this.global.TermSymbol">methodSym</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
                      <a href="../ast/TreeDSL.scala.html#515238" title="(xs: CleanUp.this.global.Tree*)CleanUp.this.global.Block">BLOCK</a><span class="delimiter">(</span>
                        <a href="../ast/TreeDSL.scala.html#515243" title="(sym: CleanUp.this.global.Symbol)CleanUp.this.global.gen.global.Tree">REF</a><a href="../ast/TreeDSL.scala.html#515248" title="implicit scala.tools.nsc.ast.TreeDSL.CODE.mkTreeMethods : (target: CleanUp.this.global.Tree)CleanUp.this.CODE.TreeMethods" class="delimiter">(</a><a href="#885637" title="CleanUp.this.global.TermSymbol">methodSym</a><span class="delimiter">)</span>        <a href="../ast/TreeDSL.scala.html#547507" title="(rhs: CleanUp.this.global.Tree)CleanUp.this.global.Assign">===</a> <span class="delimiter">(</span><a href="../ast/TreeDSL.scala.html#515243" title="(sym: CleanUp.this.global.Symbol)CleanUp.this.global.gen.global.Tree">REF</a><a href="../ast/TreeDSL.scala.html#515248" title="implicit scala.tools.nsc.ast.TreeDSL.CODE.mkTreeMethods : (target: CleanUp.this.global.Tree)CleanUp.this.CODE.TreeMethods" class="delimiter">(</a><a href="../symtab/Definitions.scala.html#508037" title="=&gt; CleanUp.this.global.Symbol">ensureAccessibleMethod</a><span class="delimiter">)</span> <a href="../ast/TreeDSL.scala.html#547502" title="(params: CleanUp.this.global.Tree*)CleanUp.this.global.Apply">APPLY</a> <span class="delimiter">(</span><a href="#885689" title="=&gt; CleanUp.this.global.Apply">methodSymRHS</a><span class="delimiter">)</span><span class="delimiter">)</span>,
                        <a href="#885015" title="(sym: CleanUp.this.global.Symbol)CleanUp.this.global.gen.global.Tree">safeREF</a><a href="../ast/TreeDSL.scala.html#515248" title="implicit scala.tools.nsc.ast.TreeDSL.CODE.mkTreeMethods : (target: CleanUp.this.global.Tree)CleanUp.this.CODE.TreeMethods" class="delimiter">(</a><a href="#885576" title="CleanUp.this.global.Symbol">reflPolyCacheSym</a><span class="delimiter">)</span> <a href="../ast/TreeDSL.scala.html#547507" title="(rhs: CleanUp.this.global.Tree)CleanUp.this.global.Assign">===</a> <a href="../Global.scala.html#478214" title="object CleanUp.this.global.gen">gen</a>.<a href="../ast/TreeGen.scala.html#507295" title="(expr: CleanUp.this.global.gen.global.Tree)CleanUp.this.global.gen.global.Tree">mkSoftRef</a><span class="delimiter">(</span><a href="#885690" title="=&gt; CleanUp.this.global.Apply">cacheRHS</a><span class="delimiter">)</span>,
                        <a href="../../../reflect/generic/Trees.scala.html#443707" title="(expr: CleanUp.this.global.Tree)CleanUp.this.global.Return">Return</a><span class="delimiter">(</span><a href="../ast/TreeDSL.scala.html#515243" title="(sym: CleanUp.this.global.Symbol)CleanUp.this.global.gen.global.Tree">REF</a><span class="delimiter">(</span><a href="#885637" title="CleanUp.this.global.TermSymbol">methodSym</a><span class="delimiter">)</span><span class="delimiter">)</span>
                      <span class="delimiter">)</span>
                    <span class="delimiter">}</span>
                  <span class="delimiter">)</span>
                <span class="delimiter">}</span>
        <span class="delimiter">}</span>

        <span class="comment">/* ### HANDLING METHODS NORMALLY COMPILED TO OPERATORS ### */</span>

        <span class="keyword">val</span> <a title="CleanUp.this.global.Tree" id="885182">testForNumber</a>: <a href="../../../reflect/generic/Trees.scala.html#434028" title="CleanUp.this.global.Tree">Tree</a>     = <span class="delimiter">(</span><a href="../ast/TreeDSL.scala.html#515248" title="implicit scala.tools.nsc.ast.TreeDSL.CODE.mkTreeMethods : (target: CleanUp.this.global.Tree)CleanUp.this.CODE.TreeMethods">qual</a> <a href="../ast/TreeDSL.scala.html#515248" title="implicit scala.tools.nsc.ast.TreeDSL.CODE.mkTreeMethods : (target: CleanUp.this.global.Tree)CleanUp.this.CODE.TreeMethods">IS_OBJ</a> <a href="../symtab/Definitions.scala.html#508283" title="=&gt; CleanUp.this.global.Symbol">BoxedNumberClass</a>.<a href="../symtab/Symbols.scala.html#509270" title="=&gt; CleanUp.this.global.Type">tpe</a><span class="delimiter">)</span> <a href="../ast/TreeDSL.scala.html#547485" title="(other: CleanUp.this.global.Tree)CleanUp.this.global.Tree">OR</a> <span class="delimiter">(</span><a href="../ast/TreeDSL.scala.html#515248" title="implicit scala.tools.nsc.ast.TreeDSL.CODE.mkTreeMethods : (target: CleanUp.this.global.Tree)CleanUp.this.CODE.TreeMethods">qual</a> <a href="../ast/TreeDSL.scala.html#547513" title="(tpe: CleanUp.this.global.Type)CleanUp.this.global.gen.global.Tree">IS_OBJ</a> <a href="../symtab/Definitions.scala.html#508285" title="=&gt; CleanUp.this.global.Symbol">BoxedCharacterClass</a>.<a href="../symtab/Symbols.scala.html#509270" title="=&gt; CleanUp.this.global.Type">tpe</a><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="CleanUp.this.global.Tree" id="885183">testForBoolean</a>: <a href="../../../reflect/generic/Trees.scala.html#434028" title="CleanUp.this.global.Tree">Tree</a>    = <span class="delimiter">(</span><a href="../ast/TreeDSL.scala.html#515248" title="implicit scala.tools.nsc.ast.TreeDSL.CODE.mkTreeMethods : (target: CleanUp.this.global.Tree)CleanUp.this.CODE.TreeMethods">qual</a> <a href="../ast/TreeDSL.scala.html#547513" title="(tpe: CleanUp.this.global.Type)CleanUp.this.global.gen.global.Tree">IS_OBJ</a> <a href="../symtab/Definitions.scala.html#508287" title="=&gt; CleanUp.this.global.Symbol">BoxedBooleanClass</a>.<a href="../symtab/Symbols.scala.html#509270" title="=&gt; CleanUp.this.global.Type">tpe</a><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="CleanUp.this.global.Tree" id="885184">testForNumberOrBoolean</a>  = <a href="../ast/TreeDSL.scala.html#515248" title="implicit scala.tools.nsc.ast.TreeDSL.CODE.mkTreeMethods : (target: CleanUp.this.global.Tree)CleanUp.this.CODE.TreeMethods">testForNumber</a> <a href="../ast/TreeDSL.scala.html#547485" title="(other: CleanUp.this.global.Tree)CleanUp.this.global.Tree">OR</a> <a href="#885183" title="CleanUp.this.global.Tree">testForBoolean</a>

        <span class="keyword">val</span> <a title="PartialFunction[CleanUp.this.global.Name,(CleanUp.this.global.Symbol, CleanUp.this.global.Tree)]" id="885185">getPrimitiveReplacementForStructuralCall</a>: <a href="../../../PartialFunction.scala.html#335" title="PartialFunction[CleanUp.this.global.Name,(CleanUp.this.global.Symbol, CleanUp.this.global.Tree)]">PartialFunction</a><span class="delimiter">[</span>Name, <span class="delimiter">(</span>Symbol, Tree<span class="delimiter">)</span><span class="delimiter">]</span> = <span class="delimiter">{</span>
          <span class="keyword">val</span> <a title="scala.collection.Map[CleanUp.this.global.TermName,java.lang.String]" id="885772">testsForNumber</a> = <a href="../../../collection/generic/GenMapFactory.scala.html#56702" title="(elems: (CleanUp.this.global.TermName, Nothing)*)scala.collection.Map[CleanUp.this.global.TermName,Nothing]">Map</a><span class="delimiter">(</span><span class="delimiter">)</span> <a href="../../../collection/MapLike.scala.html#73228" title="(xs: scala.collection.GenTraversableOnce[(CleanUp.this.global.TermName, java.lang.String)])scala.collection.Map[CleanUp.this.global.TermName,java.lang.String]">++</a> <a href="../../../collection/immutable/List.scala.html#48877" title="(xs: (CleanUp.this.global.nme.NameType, java.lang.String)*)List[(CleanUp.this.global.nme.NameType, java.lang.String)]">List</a><span class="delimiter">(</span>
            <a href="../symtab/StdNames.scala.html#479055" title="object CleanUp.this.global.nme">nme</a>.<a href="../../../Predef.scala.html#9589" title="(x: CleanUp.this.global.TermName)ArrowAssoc[CleanUp.this.global.TermName]">UNARY_+</a> <a href="../../../Predef.scala.html#57653" title="(y: java.lang.String)(CleanUp.this.global.TermName, java.lang.String)">-&gt;</a> <span title="java.lang.String(&quot;positive&quot;)" class="string">&quot;positive&quot;</span>,
            <a href="../symtab/StdNames.scala.html#479055" title="object CleanUp.this.global.nme">nme</a>.<a href="../../../Predef.scala.html#9589" title="(x: CleanUp.this.global.TermName)ArrowAssoc[CleanUp.this.global.TermName]">UNARY_-</a> <a href="../../../Predef.scala.html#57653" title="(y: java.lang.String)(CleanUp.this.global.TermName, java.lang.String)">-&gt;</a> <span title="java.lang.String(&quot;negate&quot;)" class="string">&quot;negate&quot;</span>,
            <a href="../symtab/StdNames.scala.html#479055" title="object CleanUp.this.global.nme">nme</a>.<a href="../../../Predef.scala.html#9589" title="(x: CleanUp.this.global.TermName)ArrowAssoc[CleanUp.this.global.TermName]">UNARY_~</a> <a href="../../../Predef.scala.html#57653" title="(y: java.lang.String)(CleanUp.this.global.TermName, java.lang.String)">-&gt;</a> <span title="java.lang.String(&quot;complement&quot;)" class="string">&quot;complement&quot;</span>,
            <a href="../symtab/StdNames.scala.html#479055" title="object CleanUp.this.global.nme">nme</a>.<a href="../../../Predef.scala.html#9589" title="(x: CleanUp.this.global.TermName)ArrowAssoc[CleanUp.this.global.TermName]">ADD</a>     <a href="../../../Predef.scala.html#57653" title="(y: java.lang.String)(CleanUp.this.global.TermName, java.lang.String)">-&gt;</a> <span title="java.lang.String(&quot;add&quot;)" class="string">&quot;add&quot;</span>,
            <a href="../symtab/StdNames.scala.html#479055" title="object CleanUp.this.global.nme">nme</a>.<a href="../../../Predef.scala.html#9589" title="(x: CleanUp.this.global.TermName)ArrowAssoc[CleanUp.this.global.TermName]">SUB</a>     <a href="../../../Predef.scala.html#57653" title="(y: java.lang.String)(CleanUp.this.global.TermName, java.lang.String)">-&gt;</a> <span title="java.lang.String(&quot;subtract&quot;)" class="string">&quot;subtract&quot;</span>,
            <a href="../symtab/StdNames.scala.html#479055" title="object CleanUp.this.global.nme">nme</a>.<a href="../../../Predef.scala.html#9589" title="(x: CleanUp.this.global.TermName)ArrowAssoc[CleanUp.this.global.TermName]">MUL</a>     <a href="../../../Predef.scala.html#57653" title="(y: java.lang.String)(CleanUp.this.global.TermName, java.lang.String)">-&gt;</a> <span title="java.lang.String(&quot;multiply&quot;)" class="string">&quot;multiply&quot;</span>,
            <a href="../symtab/StdNames.scala.html#479055" title="object CleanUp.this.global.nme">nme</a>.<a href="../../../Predef.scala.html#9589" title="(x: CleanUp.this.global.TermName)ArrowAssoc[CleanUp.this.global.TermName]">DIV</a>     <a href="../../../Predef.scala.html#57653" title="(y: java.lang.String)(CleanUp.this.global.TermName, java.lang.String)">-&gt;</a> <span title="java.lang.String(&quot;divide&quot;)" class="string">&quot;divide&quot;</span>,
            <a href="../symtab/StdNames.scala.html#479055" title="object CleanUp.this.global.nme">nme</a>.<a href="../../../Predef.scala.html#9589" title="(x: CleanUp.this.global.TermName)ArrowAssoc[CleanUp.this.global.TermName]">MOD</a>     <a href="../../../Predef.scala.html#57653" title="(y: java.lang.String)(CleanUp.this.global.TermName, java.lang.String)">-&gt;</a> <span title="java.lang.String(&quot;takeModulo&quot;)" class="string">&quot;takeModulo&quot;</span>,
            <a href="../symtab/StdNames.scala.html#479055" title="object CleanUp.this.global.nme">nme</a>.<a href="../../../Predef.scala.html#9589" title="(x: CleanUp.this.global.TermName)ArrowAssoc[CleanUp.this.global.TermName]">LSL</a>     <a href="../../../Predef.scala.html#57653" title="(y: java.lang.String)(CleanUp.this.global.TermName, java.lang.String)">-&gt;</a> <span title="java.lang.String(&quot;shiftSignedLeft&quot;)" class="string">&quot;shiftSignedLeft&quot;</span>,
            <a href="../symtab/StdNames.scala.html#479055" title="object CleanUp.this.global.nme">nme</a>.<a href="../../../Predef.scala.html#9589" title="(x: CleanUp.this.global.TermName)ArrowAssoc[CleanUp.this.global.TermName]">LSR</a>     <a href="../../../Predef.scala.html#57653" title="(y: java.lang.String)(CleanUp.this.global.TermName, java.lang.String)">-&gt;</a> <span title="java.lang.String(&quot;shiftLogicalRight&quot;)" class="string">&quot;shiftLogicalRight&quot;</span>,
            <a href="../symtab/StdNames.scala.html#479055" title="object CleanUp.this.global.nme">nme</a>.<a href="../../../Predef.scala.html#9589" title="(x: CleanUp.this.global.TermName)ArrowAssoc[CleanUp.this.global.TermName]">ASR</a>     <a href="../../../Predef.scala.html#57653" title="(y: java.lang.String)(CleanUp.this.global.TermName, java.lang.String)">-&gt;</a> <span title="java.lang.String(&quot;shiftSignedRight&quot;)" class="string">&quot;shiftSignedRight&quot;</span>,
            <a href="../symtab/StdNames.scala.html#479055" title="object CleanUp.this.global.nme">nme</a>.<a href="../../../Predef.scala.html#9589" title="(x: CleanUp.this.global.TermName)ArrowAssoc[CleanUp.this.global.TermName]">LT</a>      <a href="../../../Predef.scala.html#57653" title="(y: java.lang.String)(CleanUp.this.global.TermName, java.lang.String)">-&gt;</a> <span title="java.lang.String(&quot;testLessThan&quot;)" class="string">&quot;testLessThan&quot;</span>,
            <a href="../symtab/StdNames.scala.html#479055" title="object CleanUp.this.global.nme">nme</a>.<a href="../../../Predef.scala.html#9589" title="(x: CleanUp.this.global.TermName)ArrowAssoc[CleanUp.this.global.TermName]">LE</a>      <a href="../../../Predef.scala.html#57653" title="(y: java.lang.String)(CleanUp.this.global.TermName, java.lang.String)">-&gt;</a> <span title="java.lang.String(&quot;testLessOrEqualThan&quot;)" class="string">&quot;testLessOrEqualThan&quot;</span>,
            <a href="../symtab/StdNames.scala.html#479055" title="object CleanUp.this.global.nme">nme</a>.<a href="../../../Predef.scala.html#9589" title="(x: CleanUp.this.global.TermName)ArrowAssoc[CleanUp.this.global.TermName]">GE</a>      <a href="../../../Predef.scala.html#57653" title="(y: java.lang.String)(CleanUp.this.global.TermName, java.lang.String)">-&gt;</a> <span title="java.lang.String(&quot;testGreaterOrEqualThan&quot;)" class="string">&quot;testGreaterOrEqualThan&quot;</span>,
            <a href="../symtab/StdNames.scala.html#479055" title="object CleanUp.this.global.nme">nme</a>.<a href="../../../Predef.scala.html#9589" title="(x: CleanUp.this.global.TermName)ArrowAssoc[CleanUp.this.global.TermName]">GT</a>      <a href="../../../Predef.scala.html#57653" title="(y: java.lang.String)(CleanUp.this.global.TermName, java.lang.String)">-&gt;</a> <span title="java.lang.String(&quot;testGreaterThan&quot;)" class="string">&quot;testGreaterThan&quot;</span>,
            <a href="../symtab/StdNames.scala.html#479055" title="object CleanUp.this.global.nme">nme</a>.<a href="../../../Predef.scala.html#9589" title="(x: CleanUp.this.global.nme.NameType)ArrowAssoc[CleanUp.this.global.nme.NameType]">toByte</a>  <a href="../../../Predef.scala.html#57653" title="(y: java.lang.String)(CleanUp.this.global.nme.NameType, java.lang.String)">-&gt;</a> <span title="java.lang.String(&quot;toByte&quot;)" class="string">&quot;toByte&quot;</span>,
            <a href="../symtab/StdNames.scala.html#479055" title="object CleanUp.this.global.nme">nme</a>.<a href="../../../Predef.scala.html#9589" title="(x: CleanUp.this.global.nme.NameType)ArrowAssoc[CleanUp.this.global.nme.NameType]">toShort</a> <a href="../../../Predef.scala.html#57653" title="(y: java.lang.String)(CleanUp.this.global.nme.NameType, java.lang.String)">-&gt;</a> <span title="java.lang.String(&quot;toShort&quot;)" class="string">&quot;toShort&quot;</span>,
            <a href="../symtab/StdNames.scala.html#479055" title="object CleanUp.this.global.nme">nme</a>.<a href="../../../Predef.scala.html#9589" title="(x: CleanUp.this.global.nme.NameType)ArrowAssoc[CleanUp.this.global.nme.NameType]">toChar</a>  <a href="../../../Predef.scala.html#57653" title="(y: java.lang.String)(CleanUp.this.global.nme.NameType, java.lang.String)">-&gt;</a> <span title="java.lang.String(&quot;toCharacter&quot;)" class="string">&quot;toCharacter&quot;</span>,
            <a href="../symtab/StdNames.scala.html#479055" title="object CleanUp.this.global.nme">nme</a>.<a href="../../../Predef.scala.html#9589" title="(x: CleanUp.this.global.nme.NameType)ArrowAssoc[CleanUp.this.global.nme.NameType]">toInt</a>   <a href="../../../Predef.scala.html#57653" title="(y: java.lang.String)(CleanUp.this.global.nme.NameType, java.lang.String)">-&gt;</a> <span title="java.lang.String(&quot;toInteger&quot;)" class="string">&quot;toInteger&quot;</span>,
            <a href="../symtab/StdNames.scala.html#479055" title="object CleanUp.this.global.nme">nme</a>.<a href="../../../Predef.scala.html#9589" title="(x: CleanUp.this.global.nme.NameType)ArrowAssoc[CleanUp.this.global.nme.NameType]">toLong</a>  <a href="../../../Predef.scala.html#57653" title="(y: java.lang.String)(CleanUp.this.global.nme.NameType, java.lang.String)">-&gt;</a> <span title="java.lang.String(&quot;toLong&quot;)" class="string">&quot;toLong&quot;</span>,
            <a href="../symtab/StdNames.scala.html#479055" title="object CleanUp.this.global.nme">nme</a>.<a href="../../../Predef.scala.html#9589" title="(x: CleanUp.this.global.nme.NameType)ArrowAssoc[CleanUp.this.global.nme.NameType]">toFloat</a> <a href="../../../Predef.scala.html#57653" title="(y: java.lang.String)(CleanUp.this.global.nme.NameType, java.lang.String)">-&gt;</a> <span title="java.lang.String(&quot;toFloat&quot;)" class="string">&quot;toFloat&quot;</span>,
            <a href="../symtab/StdNames.scala.html#479055" title="object CleanUp.this.global.nme">nme</a>.<a href="../../../Predef.scala.html#9589" title="(x: CleanUp.this.global.nme.NameType)ArrowAssoc[CleanUp.this.global.nme.NameType]">toDouble</a><a href="../../../Predef.scala.html#57653" title="(y: java.lang.String)(CleanUp.this.global.nme.NameType, java.lang.String)">-&gt;</a> <span title="java.lang.String(&quot;toDouble&quot;)" class="string">&quot;toDouble&quot;</span>
          <span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="scala.collection.Map[CleanUp.this.global.TermName,java.lang.String]" id="885773">testsForBoolean</a> = <a href="../../../collection/generic/GenMapFactory.scala.html#56702" title="(elems: (CleanUp.this.global.TermName, Nothing)*)scala.collection.Map[CleanUp.this.global.TermName,Nothing]">Map</a><span class="delimiter">(</span><span class="delimiter">)</span> <a href="../../../collection/MapLike.scala.html#73228" title="(xs: scala.collection.GenTraversableOnce[(CleanUp.this.global.TermName, java.lang.String)])scala.collection.Map[CleanUp.this.global.TermName,java.lang.String]">++</a> <a href="../../../collection/immutable/List.scala.html#48877" title="(xs: (CleanUp.this.global.TermName, java.lang.String)*)List[(CleanUp.this.global.TermName, java.lang.String)]">List</a><span class="delimiter">(</span>
            <a href="../symtab/StdNames.scala.html#479055" title="object CleanUp.this.global.nme">nme</a>.<a href="../../../Predef.scala.html#9589" title="(x: CleanUp.this.global.TermName)ArrowAssoc[CleanUp.this.global.TermName]">UNARY_!</a> <a href="../../../Predef.scala.html#57653" title="(y: java.lang.String)(CleanUp.this.global.TermName, java.lang.String)">-&gt;</a> <span title="java.lang.String(&quot;takeNot&quot;)" class="string">&quot;takeNot&quot;</span>,
            <a href="../symtab/StdNames.scala.html#479055" title="object CleanUp.this.global.nme">nme</a>.<a href="../../../Predef.scala.html#9589" title="(x: CleanUp.this.global.TermName)ArrowAssoc[CleanUp.this.global.TermName]">ZOR</a>     <a href="../../../Predef.scala.html#57653" title="(y: java.lang.String)(CleanUp.this.global.TermName, java.lang.String)">-&gt;</a> <span title="java.lang.String(&quot;takeConditionalOr&quot;)" class="string">&quot;takeConditionalOr&quot;</span>,
            <a href="../symtab/StdNames.scala.html#479055" title="object CleanUp.this.global.nme">nme</a>.<a href="../../../Predef.scala.html#9589" title="(x: CleanUp.this.global.TermName)ArrowAssoc[CleanUp.this.global.TermName]">ZAND</a>    <a href="../../../Predef.scala.html#57653" title="(y: java.lang.String)(CleanUp.this.global.TermName, java.lang.String)">-&gt;</a> <span title="java.lang.String(&quot;takeConditionalAnd&quot;)" class="string">&quot;takeConditionalAnd&quot;</span>
          <span class="delimiter">)</span>
          <span class="keyword">val</span> <a title="scala.collection.Map[CleanUp.this.global.TermName,java.lang.String]" id="885774">testsForNumberOrBoolean</a> = <a href="../../../collection/generic/GenMapFactory.scala.html#56702" title="(elems: (CleanUp.this.global.TermName, Nothing)*)scala.collection.Map[CleanUp.this.global.TermName,Nothing]">Map</a><span class="delimiter">(</span><span class="delimiter">)</span> <a href="../../../collection/MapLike.scala.html#73228" title="(xs: scala.collection.GenTraversableOnce[(CleanUp.this.global.TermName, java.lang.String)])scala.collection.Map[CleanUp.this.global.TermName,java.lang.String]">++</a> <a href="../../../collection/immutable/List.scala.html#48877" title="(xs: (CleanUp.this.global.TermName, java.lang.String)*)List[(CleanUp.this.global.TermName, java.lang.String)]">List</a><span class="delimiter">(</span>
            <a href="../symtab/StdNames.scala.html#479055" title="object CleanUp.this.global.nme">nme</a>.<a href="../../../Predef.scala.html#9589" title="(x: CleanUp.this.global.TermName)ArrowAssoc[CleanUp.this.global.TermName]">OR</a>      <a href="../../../Predef.scala.html#57653" title="(y: java.lang.String)(CleanUp.this.global.TermName, java.lang.String)">-&gt;</a> <span title="java.lang.String(&quot;takeOr&quot;)" class="string">&quot;takeOr&quot;</span>,
            <a href="../symtab/StdNames.scala.html#479055" title="object CleanUp.this.global.nme">nme</a>.<a href="../../../Predef.scala.html#9589" title="(x: CleanUp.this.global.TermName)ArrowAssoc[CleanUp.this.global.TermName]">XOR</a>     <a href="../../../Predef.scala.html#57653" title="(y: java.lang.String)(CleanUp.this.global.TermName, java.lang.String)">-&gt;</a> <span title="java.lang.String(&quot;takeXor&quot;)" class="string">&quot;takeXor&quot;</span>,
            <a href="../symtab/StdNames.scala.html#479055" title="object CleanUp.this.global.nme">nme</a>.<a href="../../../Predef.scala.html#9589" title="(x: CleanUp.this.global.TermName)ArrowAssoc[CleanUp.this.global.TermName]">AND</a>     <a href="../../../Predef.scala.html#57653" title="(y: java.lang.String)(CleanUp.this.global.TermName, java.lang.String)">-&gt;</a> <span title="java.lang.String(&quot;takeAnd&quot;)" class="string">&quot;takeAnd&quot;</span>,
            <a href="../symtab/StdNames.scala.html#479055" title="object CleanUp.this.global.nme">nme</a>.<a href="../../../Predef.scala.html#9589" title="(x: CleanUp.this.global.TermName)ArrowAssoc[CleanUp.this.global.TermName]">EQ</a>      <a href="../../../Predef.scala.html#57653" title="(y: java.lang.String)(CleanUp.this.global.TermName, java.lang.String)">-&gt;</a> <span title="java.lang.String(&quot;testEqual&quot;)" class="string">&quot;testEqual&quot;</span>,
            <a href="../symtab/StdNames.scala.html#479055" title="object CleanUp.this.global.nme">nme</a>.<a href="../../../Predef.scala.html#9589" title="(x: CleanUp.this.global.TermName)ArrowAssoc[CleanUp.this.global.TermName]">NE</a>      <a href="../../../Predef.scala.html#57653" title="(y: java.lang.String)(CleanUp.this.global.TermName, java.lang.String)">-&gt;</a> <span title="java.lang.String(&quot;testNotEqual&quot;)" class="string">&quot;testNotEqual&quot;</span>
          <span class="delimiter">)</span>
          <span class="keyword">def</span> <a title="(name: String)CleanUp.this.global.Symbol" id="885775">get</a><span class="delimiter">(</span><a title="String" id="886435">name</a>: <span title="String">String</span><span class="delimiter">)</span> = <a href="../symtab/Definitions.scala.html#508342" title="(owner: CleanUp.this.global.Symbol, name: CleanUp.this.global.Name)CleanUp.this.global.Symbol">getMember</a><span class="delimiter">(</span><a href="../symtab/Definitions.scala.html#508281" title="=&gt; CleanUp.this.global.Symbol">BoxesRunTimeClass</a>, <a href="../../../reflect/generic/StdNames.scala.html#434009" title="implicit scala.reflect.generic.StdNames.stringToTermName : (s: String)CleanUp.this.global.TermName">name</a><span class="delimiter">)</span>

          <span class="comment">/** Begin partial function. */</span>
          <a href="#886439" title="(CleanUp.this.global.Symbol, CleanUp.this.global.Tree)" class="delimiter">{</a>
            <span class="keyword">case</span> <a title="(CleanUp.this.global.Symbol, CleanUp.this.global.Tree)" id="886440">x</a> <span class="keyword">if</span> <a href="#885772" title="scala.collection.Map[CleanUp.this.global.TermName,java.lang.String]">testsForNumber</a> <a href="../../../collection/MapLike.scala.html#73205" title="(key: CleanUp.this.global.TermName)Boolean">contains</a> <a href="../../../reflect/generic/Names.scala.html#434003" title="implicit scala.reflect.generic.Names.promoteTermNamesAsNecessary : (name: CleanUp.this.global.Name)CleanUp.this.global.TermName">x</a>           =&gt; <a href="../../../Tuple2.scala.html#53390" title="(_1: CleanUp.this.global.Symbol, _2: CleanUp.this.global.Tree)(CleanUp.this.global.Symbol, CleanUp.this.global.Tree)" class="delimiter">(</a><a href="#885775" title="(name: String)CleanUp.this.global.Symbol">get</a><span class="delimiter">(</span><a href="../../../collection/MapLike.scala.html#73204" title="(key: CleanUp.this.global.TermName)java.lang.String">testsForNumber</a><span class="delimiter">(</span><a href="../../../reflect/generic/Names.scala.html#434003" title="implicit scala.reflect.generic.Names.promoteTermNamesAsNecessary : (name: CleanUp.this.global.Name)CleanUp.this.global.TermName">x</a><span class="delimiter">)</span><span class="delimiter">)</span>, <a href="#885182" title="CleanUp.this.global.Tree">testForNumber</a><span class="delimiter">)</span>
            <span class="keyword">case</span> <a title="(CleanUp.this.global.Symbol, CleanUp.this.global.Tree)" id="886471">x</a> <span class="keyword">if</span> <a href="#885773" title="scala.collection.Map[CleanUp.this.global.TermName,java.lang.String]">testsForBoolean</a> <a href="../../../collection/MapLike.scala.html#73205" title="(key: CleanUp.this.global.TermName)Boolean">contains</a> <a href="../../../reflect/generic/Names.scala.html#434003" title="implicit scala.reflect.generic.Names.promoteTermNamesAsNecessary : (name: CleanUp.this.global.Name)CleanUp.this.global.TermName">x</a>          =&gt; <a href="../../../Tuple2.scala.html#53390" title="(_1: CleanUp.this.global.Symbol, _2: CleanUp.this.global.Tree)(CleanUp.this.global.Symbol, CleanUp.this.global.Tree)" class="delimiter">(</a><a href="#885775" title="(name: String)CleanUp.this.global.Symbol">get</a><span class="delimiter">(</span><a href="../../../collection/MapLike.scala.html#73204" title="(key: CleanUp.this.global.TermName)java.lang.String">testsForBoolean</a><span class="delimiter">(</span><a href="../../../reflect/generic/Names.scala.html#434003" title="implicit scala.reflect.generic.Names.promoteTermNamesAsNecessary : (name: CleanUp.this.global.Name)CleanUp.this.global.TermName">x</a><span class="delimiter">)</span><span class="delimiter">)</span>, <a href="#885183" title="CleanUp.this.global.Tree">testForBoolean</a><span class="delimiter">)</span>
            <span class="keyword">case</span> <a title="(CleanUp.this.global.Symbol, CleanUp.this.global.Tree)" id="886494">x</a> <span class="keyword">if</span> <a href="#885774" title="scala.collection.Map[CleanUp.this.global.TermName,java.lang.String]">testsForNumberOrBoolean</a> <a href="../../../collection/MapLike.scala.html#73205" title="(key: CleanUp.this.global.TermName)Boolean">contains</a> <a href="../../../reflect/generic/Names.scala.html#434003" title="implicit scala.reflect.generic.Names.promoteTermNamesAsNecessary : (name: CleanUp.this.global.Name)CleanUp.this.global.TermName">x</a>  =&gt; <a href="../../../Tuple2.scala.html#53390" title="(_1: CleanUp.this.global.Symbol, _2: CleanUp.this.global.Tree)(CleanUp.this.global.Symbol, CleanUp.this.global.Tree)" class="delimiter">(</a><a href="#885775" title="(name: String)CleanUp.this.global.Symbol">get</a><span class="delimiter">(</span><a href="../../../collection/MapLike.scala.html#73204" title="(key: CleanUp.this.global.TermName)java.lang.String">testsForNumberOrBoolean</a><span class="delimiter">(</span><a href="../../../reflect/generic/Names.scala.html#434003" title="implicit scala.reflect.generic.Names.promoteTermNamesAsNecessary : (name: CleanUp.this.global.Name)CleanUp.this.global.TermName">x</a><span class="delimiter">)</span><span class="delimiter">)</span>, <a href="#885184" title="CleanUp.this.global.Tree">testForNumberOrBoolean</a><span class="delimiter">)</span>
          <span class="delimiter">}</span>
        <span class="delimiter">}</span>

        <span class="comment">/* ### BOXING PARAMS &amp; UNBOXING RESULTS ### */</span>

        <span class="comment">/* Transforms the result of a reflective call (always an AnyRef) to
         * the actual result value (an AnyRef too). The transformation
         * depends on the method's static return type.
         * - for units (void), the reflective call will return null: a new
         *   boxed unit is generated.
         * - otherwise, the value is simply casted to the expected type. This
         *   is enough even for value (int et al.) values as the result of
         *   a dynamic call will box them as a side-effect. */</span>

        <span class="comment">/* ### CALLING THE APPLY ### */</span>
        <span class="keyword">def</span> <a title="(paramTypes: List[CleanUp.this.global.Type], resType: CleanUp.this.global.Type)CleanUp.this.global.Tree" id="885186">callAsReflective</a><span class="delimiter">(</span><a title="List[CleanUp.this.global.Type]" id="886517">paramTypes</a>: <a href="../../../collection/immutable/List.scala.html#14047" title="List[CleanUp.this.global.Type]">List</a><span class="delimiter">[</span>Type<span class="delimiter">]</span>, <a title="CleanUp.this.global.Type" id="886518">resType</a>: <a href="../symtab/Types.scala.html#478720" title="CleanUp.this.global.Type">Type</a><span class="delimiter">)</span>: <a href="../../../reflect/generic/Trees.scala.html#434028" title="CleanUp.this.global.Tree">Tree</a> = <span class="delimiter">{</span>
          <span class="comment">/* Some info about the type of the method being called. */</span>
          <span class="keyword">val</span> <a title="CleanUp.this.global.Symbol" id="886519">methSym</a>       = <a href="#885170" title="CleanUp.this.global.ApplyDynamic">ad</a>.<a href="../../../reflect/generic/Trees.scala.html#441600" title="=&gt; CleanUp.this.global.Symbol">symbol</a>
          <span class="keyword">val</span> <a title="CleanUp.this.global.Type" id="886520">boxedResType</a>  = <a href="#885026" title="(tp: CleanUp.this.global.Type)CleanUp.this.global.Type">toBoxedType</a><span class="delimiter">(</span><a href="#886518" title="CleanUp.this.global.Type">resType</a><span class="delimiter">)</span>      <span class="comment">// Int -&gt; Integer</span>
          <span class="keyword">val</span> <a title="CleanUp.this.global.Symbol" id="886521">resultSym</a>     = <a href="#886520" title="CleanUp.this.global.Type">boxedResType</a>.<a href="../symtab/Types.scala.html#507159" title="=&gt; CleanUp.this.global.Symbol">typeSymbol</a>
          <span class="comment">// If this is a primitive method type (like '+' in 5+5=10) then the</span>
          <span class="comment">// parameter types and the (unboxed) result type should all be primitive types,</span>
          <span class="comment">// and the method name should be in the primitive-&gt;structural map.</span>
          <span class="keyword">def</span> <a title="=&gt; Boolean" id="886522">isJavaValueMethod</a> = <span class="delimiter">(</span>
            <span class="delimiter">(</span><a href="#886518" title="CleanUp.this.global.Type">resType</a> <a href="../../../collection/immutable/List.scala.html#49140" title="(x: CleanUp.this.global.Type)List[CleanUp.this.global.Type]">::</a> <a href="#886517" title="List[CleanUp.this.global.Type]">paramTypes</a> <a href="../../../collection/LinearSeqOptimized.scala.html#71035" title="(p: CleanUp.this.global.Type =&gt; Boolean)Boolean">forall</a> <a href="#885025" title="(tp: CleanUp.this.global.Type)Boolean">isJavaValueType</a><span class="delimiter">)</span> <a href="../../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a> <span class="comment">// issue #1110</span>
            <span class="delimiter">(</span><a href="#885185" title="PartialFunction[CleanUp.this.global.Name,(CleanUp.this.global.Symbol, CleanUp.this.global.Tree)]">getPrimitiveReplacementForStructuralCall</a> <a href="../../../PartialFunction.scala.html#53462" title="(x: CleanUp.this.global.Name)Boolean">isDefinedAt</a> <a href="#886519" title="CleanUp.this.global.Symbol">methSym</a>.<a href="../symtab/Symbols.scala.html#509256" title="=&gt; CleanUp.this.global.Name">name</a><span class="delimiter">)</span>
          <span class="delimiter">)</span>
          <span class="comment">// Erasure lets Unit through as Unit, but a method returning Any will have an</span>
          <span class="comment">// erased return type of Object and should also allow Unit.</span>
          <span class="keyword">def</span> <a title="=&gt; Boolean" id="886523">isDefinitelyUnit</a>  = <span class="delimiter">(</span><a href="#886521" title="CleanUp.this.global.Symbol">resultSym</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../symtab/Definitions.scala.html#508423" title="=&gt; CleanUp.this.global.Symbol">UnitClass</a><span class="delimiter">)</span>
          <span class="keyword">def</span> <a title="=&gt; Boolean" id="886524">isMaybeUnit</a>       = <span class="delimiter">(</span><a href="#886521" title="CleanUp.this.global.Symbol">resultSym</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../symtab/Definitions.scala.html#507925" title="=&gt; CleanUp.this.global.Symbol">ObjectClass</a><span class="delimiter">)</span> <a href="../../../Boolean.scala.html#55579" title="(x: Boolean)Boolean">||</a> <a href="#886523" title="=&gt; Boolean">isDefinitelyUnit</a>
          <span class="comment">// If there's any chance this signature could be met by an Array.</span>
          <span class="keyword">val</span> <a title="Boolean" id="886525">isArrayMethodSignature</a> = <span class="delimiter">{</span>
            <span class="keyword">def</span> <a title="=&gt; Boolean" id="886565">typesMatchApply</a> = <a href="#886517" title="List[CleanUp.this.global.Type]">paramTypes</a> <span title="Boolean" class="keyword">match</span> <span class="delimiter">{</span>
              <span class="keyword">case</span> <a href="../../../collection/generic/GenSeqFactory.scala.html#48862" title="Boolean">List</a><span class="delimiter">(</span><a title="CleanUp.this.global.Type" id="886584">tp</a><span class="delimiter">)</span> =&gt; <a href="#886584" title="CleanUp.this.global.Type">tp</a> <a href="../symtab/Types.scala.html#507220" title="(that: CleanUp.this.global.Type)Boolean">&lt;:&lt;</a> <a href="../symtab/Definitions.scala.html#508431" title="=&gt; CleanUp.this.global.Symbol">IntClass</a>.<a href="../symtab/Symbols.scala.html#509270" title="=&gt; CleanUp.this.global.Type">tpe</a>
              <span class="keyword">case</span> <span title="Boolean(false)">_</span>        =&gt; <span title="Boolean(false)" class="keyword">false</span>
            <span class="delimiter">}</span>
            <span class="keyword">def</span> <a title="=&gt; Boolean" id="886566">typesMatchUpdate</a> = <a href="#886517" title="List[CleanUp.this.global.Type]">paramTypes</a> <span title="Boolean" class="keyword">match</span> <span class="delimiter">{</span>
              <span class="keyword">case</span> <a href="../../../collection/generic/GenSeqFactory.scala.html#48862" title="Boolean">List</a><span class="delimiter">(</span><a title="CleanUp.this.global.Type" id="886598">tp1</a>, <a title="CleanUp.this.global.Type" id="886599">tp2</a><span class="delimiter">)</span> =&gt; <span class="delimiter">(</span><a href="#886598" title="CleanUp.this.global.Type">tp1</a> <a href="../symtab/Types.scala.html#507220" title="(that: CleanUp.this.global.Type)Boolean">&lt;:&lt;</a> <a href="../symtab/Definitions.scala.html#508431" title="=&gt; CleanUp.this.global.Symbol">IntClass</a>.<a href="../symtab/Symbols.scala.html#509270" title="=&gt; CleanUp.this.global.Type">tpe</a><span class="delimiter">)</span> <a href="../../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#886524" title="=&gt; Boolean">isMaybeUnit</a>
              <span class="keyword">case</span> <span title="Boolean(false)">_</span>              =&gt; <span title="Boolean(false)" class="keyword">false</span>
            <span class="delimiter">}</span>

            <span class="delimiter">(</span><a href="#886519" title="CleanUp.this.global.Symbol">methSym</a>.<a href="../symtab/Symbols.scala.html#509256" title="=&gt; CleanUp.this.global.Name">name</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../symtab/StdNames.scala.html#479055" title="object CleanUp.this.global.nme">nme</a>.<a href="../symtab/StdNames.scala.html#516666" title="=&gt; CleanUp.this.global.nme.NameType">length</a> <a href="../../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#885174" title="List[CleanUp.this.global.Tree]">params</a>.<a href="../../../collection/IterableLike.scala.html#53862" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <a href="../../../Boolean.scala.html#55579" title="(x: Boolean)Boolean">||</a>
            <span class="delimiter">(</span><a href="#886519" title="CleanUp.this.global.Symbol">methSym</a>.<a href="../symtab/Symbols.scala.html#509256" title="=&gt; CleanUp.this.global.Name">name</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../symtab/StdNames.scala.html#479055" title="object CleanUp.this.global.nme">nme</a>.<a href="../symtab/StdNames.scala.html#516602" title="=&gt; CleanUp.this.global.nme.NameType">clone_</a> <a href="../../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#885174" title="List[CleanUp.this.global.Tree]">params</a>.<a href="../../../collection/IterableLike.scala.html#53862" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <a href="../../../Boolean.scala.html#55579" title="(x: Boolean)Boolean">||</a>
            <span class="delimiter">(</span><a href="#886519" title="CleanUp.this.global.Symbol">methSym</a>.<a href="../symtab/Symbols.scala.html#509256" title="=&gt; CleanUp.this.global.Name">name</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../symtab/StdNames.scala.html#479055" title="object CleanUp.this.global.nme">nme</a>.<a href="../symtab/StdNames.scala.html#516580" title="=&gt; CleanUp.this.global.nme.NameType">apply</a>  <a href="../../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#886565" title="=&gt; Boolean">typesMatchApply</a><span class="delimiter">)</span> <a href="../../../Boolean.scala.html#55579" title="(x: Boolean)Boolean">||</a>
            <span class="delimiter">(</span><a href="#886519" title="CleanUp.this.global.Symbol">methSym</a>.<a href="../symtab/Symbols.scala.html#509256" title="=&gt; CleanUp.this.global.Name">name</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../symtab/StdNames.scala.html#479055" title="object CleanUp.this.global.nme">nme</a>.<a href="../symtab/StdNames.scala.html#516730" title="=&gt; CleanUp.this.global.nme.NameType">update</a> <a href="../../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#886566" title="=&gt; Boolean">typesMatchUpdate</a><span class="delimiter">)</span>
          <span class="delimiter">}</span>

          <span class="comment">/* Some info about the argument at the call site. */</span>
          <span class="keyword">val</span> <a title="CleanUp.this.global.Symbol" id="886526">qualSym</a>           = <a href="#885176" title="CleanUp.this.global.Tree">qual</a>.<a href="../../../reflect/generic/Trees.scala.html#441028" title="=&gt; CleanUp.this.global.Type">tpe</a>.<a href="../symtab/Types.scala.html#507159" title="=&gt; CleanUp.this.global.Symbol">typeSymbol</a>
          <span class="keyword">val</span> <a title="List[CleanUp.this.global.Tree]" id="886527">args</a>              = <a href="#885176" title="CleanUp.this.global.Tree">qual</a> <a href="../../../collection/immutable/List.scala.html#49140" title="(x: CleanUp.this.global.Tree)List[CleanUp.this.global.Tree]">::</a> <a href="#885174" title="List[CleanUp.this.global.Tree]">params</a>
          <span class="keyword">def</span> <a title="=&gt; Boolean" id="886528">isDefinitelyArray</a> = <span class="delimiter">(</span><a href="#886526" title="CleanUp.this.global.Symbol">qualSym</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../symtab/Definitions.scala.html#508099" title="=&gt; CleanUp.this.global.Symbol">ArrayClass</a><span class="delimiter">)</span>
          <span class="keyword">def</span> <a title="=&gt; Boolean" id="886529">isMaybeArray</a>      = <span class="delimiter">(</span><a href="#886526" title="CleanUp.this.global.Symbol">qualSym</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../symtab/Definitions.scala.html#507925" title="=&gt; CleanUp.this.global.Symbol">ObjectClass</a><span class="delimiter">)</span> <a href="../../../Boolean.scala.html#55579" title="(x: Boolean)Boolean">||</a> <a href="#886528" title="=&gt; Boolean">isDefinitelyArray</a>
          <span class="keyword">def</span> <a title="=&gt; Boolean" id="886530">isMaybeBoxed</a>      = <a href="../Global.scala.html#478210" title="=&gt; CleanUp.this.global.ThisPlatform">platform</a> <a href="../backend/Platform.scala.html#506703" title="(sym: CleanUp.this.global.platform.global.Symbol)Boolean">isMaybeBoxed</a> <a href="#886526" title="CleanUp.this.global.Symbol">qualSym</a>

          <span class="comment">// This is complicated a bit by trying to handle Arrays correctly.</span>
          <span class="comment">// Under normal circumstances if the erased return type is Object then</span>
          <span class="comment">// we're not going to box it to Unit, but that is the situation with</span>
          <span class="comment">// a signature like def f(x: { def update(x: Int, y: Long): Any })</span>
          <span class="comment">//</span>
          <span class="comment">// However we only want to do that boxing if it has been determined</span>
          <span class="comment">// to be an Array and a method returning Unit.  But for this fixResult</span>
          <span class="comment">// could be called in one place: instead it is called separately from the</span>
          <span class="comment">// unconditional outcomes (genValueCall, genArrayCall, genDefaultCall.)</span>
          <span class="keyword">def</span> <a title="(tree: CleanUp.this.global.Tree, mustBeUnit: Boolean)CleanUp.this.global.Tree" id="886531">fixResult</a><span class="delimiter">(</span><a title="CleanUp.this.global.Tree" id="886649">tree</a>: <a href="../../../reflect/generic/Trees.scala.html#434028" title="CleanUp.this.global.Tree">Tree</a>, <a title="Boolean" id="886651">mustBeUnit</a>: <a href="../../../Boolean.scala.html#65" title="Boolean">Boolean</a> = <span title="Boolean(false)" class="keyword">false</span><span class="delimiter">)</span> =
            <span title="CleanUp.this.global.Tree" class="keyword">if</span> <span class="delimiter">(</span><a href="#886651" title="Boolean">mustBeUnit</a> <a href="../../../Boolean.scala.html#55579" title="(x: Boolean)Boolean">||</a> <a href="#886521" title="CleanUp.this.global.Symbol">resultSym</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../symtab/Definitions.scala.html#508423" title="=&gt; CleanUp.this.global.Symbol">UnitClass</a><span class="delimiter">)</span> <a href="../ast/TreeDSL.scala.html#515238" title="(xs: CleanUp.this.global.Tree*)CleanUp.this.global.Block">BLOCK</a><span class="delimiter">(</span><a href="#886649" title="CleanUp.this.global.Tree">tree</a>, <a href="../ast/TreeDSL.scala.html#515243" title="(sym: CleanUp.this.global.Symbol)CleanUp.this.global.gen.global.Tree">REF</a><span class="delimiter">(</span><a href="../symtab/Definitions.scala.html#508305" title="=&gt; CleanUp.this.global.Symbol">BoxedUnit_UNIT</a><span class="delimiter">)</span><span class="delimiter">)</span>  <span class="comment">// boxed unit</span>
            <span class="keyword">else</span> <span title="CleanUp.this.global.Tree" class="keyword">if</span> <span class="delimiter">(</span><a href="#886521" title="CleanUp.this.global.Symbol">resultSym</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../symtab/Definitions.scala.html#507925" title="=&gt; CleanUp.this.global.Symbol">ObjectClass</a><span class="delimiter">)</span> <a href="#886649" title="CleanUp.this.global.Tree">tree</a>                                     <span class="comment">// no cast necessary</span>
            <span class="keyword">else</span> <a href="../ast/TreeDSL.scala.html#515248" title="implicit scala.tools.nsc.ast.TreeDSL.CODE.mkTreeMethods : (target: CleanUp.this.global.Tree)CleanUp.this.CODE.TreeMethods">tree</a> <a href="../ast/TreeDSL.scala.html#547511" title="(tpe: CleanUp.this.global.Type)CleanUp.this.global.Tree">AS_ATTR</a> <a href="#886520" title="CleanUp.this.global.Type">boxedResType</a>                                              <span class="comment">// cast to expected type</span>

          <span class="comment">/** Normal non-Array call */</span>
          <span class="keyword">def</span> <a title="=&gt; CleanUp.this.global.Tree" id="886532">genDefaultCall</a> = <span class="delimiter">{</span>
            <span class="comment">// reflective method call machinery</span>
            <span class="keyword">val</span> <a title="CleanUp.this.global.Symbol" id="886666">invokeName</a>  = <a href="../symtab/Definitions.scala.html#508110" title="=&gt; CleanUp.this.global.Symbol">MethodClass</a>.<a href="../symtab/Symbols.scala.html#509270" title="=&gt; CleanUp.this.global.Type">tpe</a> <a href="../symtab/Types.scala.html#507200" title="(name: CleanUp.this.global.Name)CleanUp.this.global.Symbol">member</a> <a href="../symtab/StdNames.scala.html#479055" title="object CleanUp.this.global.nme">nme</a>.<a href="../symtab/StdNames.scala.html#516797" title="=&gt; CleanUp.this.global.TermName">invoke_</a>                                <span class="comment">// reflect.Method.invoke(...)</span>
            <span class="keyword">def</span> <a title="=&gt; CleanUp.this.global.gen.global.Tree" id="886667">cache</a>       = <a href="#885015" title="(sym: CleanUp.this.global.Symbol)CleanUp.this.global.gen.global.Tree">safeREF</a><span class="delimiter">(</span><a href="#885181" title="(method: String, paramTypes: List[CleanUp.this.global.Type])CleanUp.this.global.Symbol">reflectiveMethodCache</a><span class="delimiter">(</span><a href="#885170" title="CleanUp.this.global.ApplyDynamic">ad</a>.<a href="../../../reflect/generic/Trees.scala.html#441600" title="=&gt; CleanUp.this.global.Symbol">symbol</a>.<a href="../symtab/Symbols.scala.html#509256" title="=&gt; CleanUp.this.global.Name">name</a>.<a href="../symtab/Names.scala.html#501123" title="()String">toString</a>, <a href="#886517" title="List[CleanUp.this.global.Type]">paramTypes</a><span class="delimiter">)</span><span class="delimiter">)</span>   <span class="comment">// cache Symbol</span>
            <span class="keyword">def</span> <a title="=&gt; CleanUp.this.global.Apply" id="886668">lookup</a>      = <a href="../../../reflect/generic/Trees.scala.html#443864" title="(fun: CleanUp.this.global.Tree, args: List[CleanUp.this.global.Tree])CleanUp.this.global.Apply">Apply</a><span class="delimiter">(</span><a href="#886667" title="=&gt; CleanUp.this.global.gen.global.Tree">cache</a>, <a href="../../../collection/immutable/List.scala.html#48877" title="(xs: CleanUp.this.global.Apply*)List[CleanUp.this.global.Apply]">List</a><span class="delimiter">(</span><a href="../ast/TreeDSL.scala.html#515248" title="implicit scala.tools.nsc.ast.TreeDSL.CODE.mkTreeMethods : (target: CleanUp.this.global.Tree)CleanUp.this.CODE.TreeMethods">qual</a> <a href="../ast/TreeDSL.scala.html#547515" title="()CleanUp.this.global.Apply">GETCLASS</a><span class="delimiter">)</span><span class="delimiter">)</span>                                 <span class="comment">// get Method object from cache</span>
            <span class="keyword">def</span> <a title="=&gt; CleanUp.this.global.ArrayValue" id="886669">invokeArgs</a>  = <a href="../../../reflect/generic/Trees.scala.html#443548" title="(elemtpt: CleanUp.this.global.Tree, elems: List[CleanUp.this.global.Tree])CleanUp.this.global.ArrayValue">ArrayValue</a><span class="delimiter">(</span><a href="../ast/Trees.scala.html#479149" title="(tp: CleanUp.this.global.Type)CleanUp.this.global.TypeTree">TypeTree</a><span class="delimiter">(</span><a href="../symtab/Definitions.scala.html#507925" title="=&gt; CleanUp.this.global.Symbol">ObjectClass</a>.<a href="../symtab/Symbols.scala.html#509270" title="=&gt; CleanUp.this.global.Type">tpe</a><span class="delimiter">)</span>, <a href="#885174" title="List[CleanUp.this.global.Tree]">params</a><span class="delimiter">)</span>                     <span class="comment">// args for invocation</span>
            <span class="keyword">def</span> <a title="=&gt; CleanUp.this.global.Apply" id="886670">invocation</a>  = <span class="delimiter">(</span><a href="../ast/TreeDSL.scala.html#515248" title="implicit scala.tools.nsc.ast.TreeDSL.CODE.mkTreeMethods : (target: CleanUp.this.global.Tree)CleanUp.this.CODE.TreeMethods">lookup</a> <a href="../ast/TreeDSL.scala.html#547472" title="(args: CleanUp.this.global.Tree*)CleanUp.this.global.Apply">DOT</a> <a href="#886666" title="CleanUp.this.global.Symbol">invokeName</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#885176" title="CleanUp.this.global.Tree">qual</a>, <a href="#886669" title="=&gt; CleanUp.this.global.ArrayValue">invokeArgs</a><span class="delimiter">)</span>                         <span class="comment">// .invoke(qual, ...)</span>

            <span class="comment">// exception catching machinery</span>
            <span class="keyword">val</span> <a title="CleanUp.this.global.TermSymbol" id="886671">invokeExc</a>   = <a href="../ast/Trees.scala.html#560333" title="=&gt; CleanUp.this.global.Symbol">currentOwner</a>.<a href="../symtab/Symbols.scala.html#509125" title="(pos: CleanUp.this.global.Position, name: CleanUp.this.global.TermName)CleanUp.this.global.TermSymbol">newValue</a><span class="delimiter">(</span><a href="#885170" title="CleanUp.this.global.ApplyDynamic">ad</a>.<a href="../../../reflect/generic/Trees.scala.html#441024" title="=&gt; CleanUp.this.global.Position">pos</a>, <a href="#885014" title="(prefix: String)CleanUp.this.global.TermName">mkTerm</a><span class="delimiter">(</span><span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../symtab/Symbols.scala.html#509274" title="(info: CleanUp.this.global.Type)CleanUp.this.global.TermSymbol">setInfo</a> <a href="../symtab/Definitions.scala.html#507943" title="=&gt; CleanUp.this.global.Symbol">InvocationTargetExceptionClass</a>.<a href="../symtab/Symbols.scala.html#509270" title="=&gt; CleanUp.this.global.Type">tpe</a>
            <span class="keyword">def</span> <a title="=&gt; CleanUp.this.global.Bind" id="886672">catchVar</a>    = <a href="../ast/Trees.scala.html#479139" title="(sym: CleanUp.this.global.Symbol, body: CleanUp.this.global.Tree)CleanUp.this.global.Bind">Bind</a><span class="delimiter">(</span><a href="#886671" title="CleanUp.this.global.TermSymbol">invokeExc</a>, <a href="../../../reflect/generic/Trees.scala.html#443806" title="(expr: CleanUp.this.global.Tree, tpt: CleanUp.this.global.Tree)CleanUp.this.global.Typed">Typed</a><span class="delimiter">(</span><a href="../../../reflect/generic/Trees.scala.html#443999" title="(name: CleanUp.this.global.Name)CleanUp.this.global.Ident">Ident</a><span class="delimiter">(</span><a href="../symtab/StdNames.scala.html#479055" title="object CleanUp.this.global.nme">nme</a>.<a href="../symtab/StdNames.scala.html#516190" title="=&gt; CleanUp.this.global.nme.NameType">WILDCARD</a><span class="delimiter">)</span>, <a href="../ast/Trees.scala.html#479149" title="(tp: CleanUp.this.global.Type)CleanUp.this.global.TypeTree">TypeTree</a><span class="delimiter">(</span><a href="../symtab/Definitions.scala.html#507943" title="=&gt; CleanUp.this.global.Symbol">InvocationTargetExceptionClass</a>.<a href="../symtab/Symbols.scala.html#509270" title="=&gt; CleanUp.this.global.Type">tpe</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
            <span class="keyword">def</span> <a title="=&gt; CleanUp.this.global.Throw" id="886673">catchBody</a>   = <a href="../../../reflect/generic/Trees.scala.html#443762" title="(expr: CleanUp.this.global.Tree)CleanUp.this.global.Throw">Throw</a><span class="delimiter">(</span><a href="../../../reflect/generic/Trees.scala.html#443864" title="(fun: CleanUp.this.global.Tree, args: List[CleanUp.this.global.Tree])CleanUp.this.global.Apply">Apply</a><span class="delimiter">(</span><a href="../../../reflect/generic/Trees.scala.html#443970" title="(qualifier: CleanUp.this.global.Tree, name: CleanUp.this.global.Name)CleanUp.this.global.Select">Select</a><span class="delimiter">(</span><a href="../ast/Trees.scala.html#479144" title="(sym: CleanUp.this.global.Symbol)CleanUp.this.global.Ident">Ident</a><span class="delimiter">(</span><a href="#886671" title="CleanUp.this.global.TermSymbol">invokeExc</a><span class="delimiter">)</span>, <a href="../symtab/StdNames.scala.html#479055" title="object CleanUp.this.global.nme">nme</a>.<a href="../symtab/StdNames.scala.html#516794" title="=&gt; CleanUp.this.global.TermName">getCause</a><span class="delimiter">)</span>, <a href="../../../collection/immutable/List.scala.html#13700" title="object Nil">Nil</a><span class="delimiter">)</span><span class="delimiter">)</span>

            <span class="comment">// try { method.invoke } catch { case e: InvocationTargetExceptionClass =&gt; throw e.getCause() }</span>
            <a href="#886531" title="(tree: CleanUp.this.global.Tree, mustBeUnit: Boolean)CleanUp.this.global.Tree">fixResult</a><span class="delimiter">(</span><a href="../ast/TreeDSL.scala.html#515237" title="(tree: CleanUp.this.global.Tree)CleanUp.this.CODE.TryStart">TRY</a> <span class="delimiter">(</span><a href="#886670" title="=&gt; CleanUp.this.global.Apply">invocation</a><span class="delimiter">)</span> <a href="../ast/TreeDSL.scala.html#548702" title="(xs: CleanUp.this.global.CaseDef*)CleanUp.this.CODE.TryStart">CATCH</a> <span class="delimiter">{</span> <a href="../ast/TreeDSL.scala.html#515214" title="(pat: CleanUp.this.global.Tree)CleanUp.this.CODE.CaseStart">CASE</a> <span class="delimiter">(</span><a href="#886672" title="=&gt; CleanUp.this.global.Bind">catchVar</a><span class="delimiter">)</span> <a href="../ast/TreeDSL.scala.html#548126" title="(body: CleanUp.this.global.Tree)CleanUp.this.global.CaseDef">==&gt;</a> <a href="#886673" title="=&gt; CleanUp.this.global.Throw">catchBody</a> <span class="delimiter">}</span> <a href="../ast/TreeDSL.scala.html#548704" title="=&gt; CleanUp.this.global.Try">ENDTRY</a><span class="delimiter">)</span>
          <span class="delimiter">}</span>

          <span class="comment">/** A possible primitive method call, represented by methods in BoxesRunTime. */</span>
          <span class="keyword">def</span> <a title="(operator: CleanUp.this.global.Symbol)CleanUp.this.global.Tree" id="886533">genValueCall</a><span class="delimiter">(</span><a title="CleanUp.this.global.Symbol" id="886798">operator</a>: <a href="../symtab/Symbols.scala.html#478659" title="CleanUp.this.global.Symbol">Symbol</a><span class="delimiter">)</span> = <a href="#886531" title="(tree: CleanUp.this.global.Tree, mustBeUnit: Boolean)CleanUp.this.global.Tree">fixResult</a><span class="delimiter">(</span><a href="../ast/TreeDSL.scala.html#515243" title="(sym: CleanUp.this.global.Symbol)CleanUp.this.global.gen.global.Tree">REF</a><a href="../ast/TreeDSL.scala.html#515248" title="implicit scala.tools.nsc.ast.TreeDSL.CODE.mkTreeMethods : (target: CleanUp.this.global.Tree)CleanUp.this.CODE.TreeMethods" class="delimiter">(</a><a href="#886798" title="CleanUp.this.global.Symbol">operator</a><span class="delimiter">)</span> <a href="../ast/TreeDSL.scala.html#547503" title="(params: List[CleanUp.this.global.Tree])CleanUp.this.global.Apply">APPLY</a> <a href="#886527" title="List[CleanUp.this.global.Tree]">args</a><span class="delimiter">)</span>
          <span class="keyword">def</span> <a title="=&gt; CleanUp.this.global.If" id="886534">genValueCallWithTest</a> = <span class="delimiter">{</span>
            <span class="keyword">val</span> <a href="../../../Tuple2.scala.html#53390" title="(CleanUp.this.global.Symbol, CleanUp.this.global.Tree)" class="delimiter">(</a><a href="../../../Tuple2.scala.html#53402" title="CleanUp.this.global.Symbol" id="886813">operator</a>, <a href="../../../Tuple2.scala.html#53404" title="CleanUp.this.global.Tree" id="886814">test</a><span class="delimiter">)</span>  = <a href="../../../Function1.scala.html#53453" title="(v1: CleanUp.this.global.Name)(CleanUp.this.global.Symbol, CleanUp.this.global.Tree)">getPrimitiveReplacementForStructuralCall</a><a href="../../../Tuple2.scala.html#1520" title="(CleanUp.this.global.Symbol, CleanUp.this.global.Tree) @unchecked" class="delimiter">(</a><a href="#886519" title="CleanUp.this.global.Symbol">methSym</a>.<a href="../symtab/Symbols.scala.html#509256" title="=&gt; CleanUp.this.global.Name">name</a><span class="delimiter">)</span>
            <a href="../ast/TreeDSL.scala.html#515236" title="(tree: CleanUp.this.global.Tree)CleanUp.this.CODE.IfStart">IF</a> <span class="delimiter">(</span><a href="#886814" title="CleanUp.this.global.Tree">test</a><span class="delimiter">)</span> <a href="../ast/TreeDSL.scala.html#547456" title="(x: CleanUp.this.global.Tree)CleanUp.this.CODE.IfStart">THEN</a> <a href="#886533" title="(operator: CleanUp.this.global.Symbol)CleanUp.this.global.Tree">genValueCall</a><span class="delimiter">(</span><a href="#886813" title="CleanUp.this.global.Symbol">operator</a><span class="delimiter">)</span> <a href="../ast/TreeDSL.scala.html#547457" title="(elsep: CleanUp.this.global.Tree)CleanUp.this.global.If">ELSE</a> <a href="#886532" title="=&gt; CleanUp.this.global.Tree">genDefaultCall</a>
          <span class="delimiter">}</span>

          <span class="comment">/** A native Array call. */</span>
          <span class="keyword">def</span> <a title="=&gt; CleanUp.this.global.Tree" id="886535">genArrayCall</a> = <a href="#886531" title="(tree: CleanUp.this.global.Tree, mustBeUnit: Boolean)CleanUp.this.global.Tree">fixResult</a><span class="delimiter">(</span>
            <a href="#886519" title="CleanUp.this.global.Symbol">methSym</a>.<a href="../symtab/Symbols.scala.html#509256" title="=&gt; CleanUp.this.global.Name">name</a> <span title="CleanUp.this.global.Tree" class="keyword">match</span> <span class="delimiter">{</span>
              <span class="keyword">case</span> <a href="../symtab/StdNames.scala.html#479055" title="CleanUp.this.global.Apply">nme</a>.<a href="../symtab/StdNames.scala.html#516666" title="=&gt; CleanUp.this.global.nme.NameType">length</a> =&gt; <a href="../ast/TreeDSL.scala.html#515243" title="(sym: CleanUp.this.global.Symbol)CleanUp.this.global.gen.global.Tree">REF</a><a href="../ast/TreeDSL.scala.html#515248" title="implicit scala.tools.nsc.ast.TreeDSL.CODE.mkTreeMethods : (target: CleanUp.this.global.Tree)CleanUp.this.CODE.TreeMethods" class="delimiter">(</a><a href="../../../collection/MapLike.scala.html#73204" title="(key: CleanUp.this.global.Symbol)CleanUp.this.global.Symbol">boxMethod</a><span class="delimiter">(</span><a href="../symtab/Definitions.scala.html#508431" title="=&gt; CleanUp.this.global.Symbol">IntClass</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../ast/TreeDSL.scala.html#547502" title="(params: CleanUp.this.global.Tree*)CleanUp.this.global.Apply">APPLY</a> <span class="delimiter">(</span><a href="../ast/TreeDSL.scala.html#515243" title="(sym: CleanUp.this.global.Symbol)CleanUp.this.global.gen.global.Tree">REF</a><a href="../ast/TreeDSL.scala.html#515248" title="implicit scala.tools.nsc.ast.TreeDSL.CODE.mkTreeMethods : (target: CleanUp.this.global.Tree)CleanUp.this.CODE.TreeMethods" class="delimiter">(</a><a href="../symtab/Definitions.scala.html#508035" title="=&gt; CleanUp.this.global.Symbol">arrayLengthMethod</a><span class="delimiter">)</span> <a href="../ast/TreeDSL.scala.html#547503" title="(params: List[CleanUp.this.global.Tree])CleanUp.this.global.Apply">APPLY</a> <a href="#886527" title="List[CleanUp.this.global.Tree]">args</a><span class="delimiter">)</span>
              <span class="keyword">case</span> <a href="../symtab/StdNames.scala.html#479055" title="CleanUp.this.global.Apply">nme</a>.<a href="../symtab/StdNames.scala.html#516730" title="=&gt; CleanUp.this.global.nme.NameType">update</a> =&gt; <a href="../ast/TreeDSL.scala.html#515243" title="(sym: CleanUp.this.global.Symbol)CleanUp.this.global.gen.global.Tree">REF</a><a href="../ast/TreeDSL.scala.html#515248" title="implicit scala.tools.nsc.ast.TreeDSL.CODE.mkTreeMethods : (target: CleanUp.this.global.Tree)CleanUp.this.CODE.TreeMethods" class="delimiter">(</a><a href="../symtab/Definitions.scala.html#508034" title="=&gt; CleanUp.this.global.Symbol">arrayUpdateMethod</a><span class="delimiter">)</span> <a href="../ast/TreeDSL.scala.html#547503" title="(params: List[CleanUp.this.global.Tree])CleanUp.this.global.Apply">APPLY</a> <a href="../../../collection/immutable/List.scala.html#48877" title="(xs: CleanUp.this.global.Tree*)List[CleanUp.this.global.Tree]">List</a><span class="delimiter">(</span><a href="../../../collection/LinearSeqOptimized.scala.html#71031" title="(n: Int)CleanUp.this.global.Tree">args</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>, <span class="delimiter">(</span><a href="../ast/TreeDSL.scala.html#515243" title="(sym: CleanUp.this.global.Symbol)CleanUp.this.global.gen.global.Tree">REF</a><a href="../ast/TreeDSL.scala.html#515248" title="implicit scala.tools.nsc.ast.TreeDSL.CODE.mkTreeMethods : (target: CleanUp.this.global.Tree)CleanUp.this.CODE.TreeMethods" class="delimiter">(</a><a href="../../../collection/MapLike.scala.html#73204" title="(key: CleanUp.this.global.Symbol)CleanUp.this.global.Symbol">unboxMethod</a><span class="delimiter">(</span><a href="../symtab/Definitions.scala.html#508431" title="=&gt; CleanUp.this.global.Symbol">IntClass</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../ast/TreeDSL.scala.html#547502" title="(params: CleanUp.this.global.Tree*)CleanUp.this.global.Apply">APPLY</a> <a href="../../../collection/LinearSeqOptimized.scala.html#71031" title="(n: Int)CleanUp.this.global.Tree">args</a><span class="delimiter">(</span><span title="Int(1)" class="int">1</span><span class="delimiter">)</span><span class="delimiter">)</span>, <a href="../../../collection/LinearSeqOptimized.scala.html#71031" title="(n: Int)CleanUp.this.global.Tree">args</a><span class="delimiter">(</span><span title="Int(2)" class="int">2</span><span class="delimiter">)</span><span class="delimiter">)</span>
              <span class="keyword">case</span> <a href="../symtab/StdNames.scala.html#479055" title="CleanUp.this.global.Apply">nme</a>.<a href="../symtab/StdNames.scala.html#516580" title="=&gt; CleanUp.this.global.nme.NameType">apply</a>  =&gt; <a href="../ast/TreeDSL.scala.html#515243" title="(sym: CleanUp.this.global.Symbol)CleanUp.this.global.gen.global.Tree">REF</a><a href="../ast/TreeDSL.scala.html#515248" title="implicit scala.tools.nsc.ast.TreeDSL.CODE.mkTreeMethods : (target: CleanUp.this.global.Tree)CleanUp.this.CODE.TreeMethods" class="delimiter">(</a><a href="../symtab/Definitions.scala.html#508033" title="=&gt; CleanUp.this.global.Symbol">arrayApplyMethod</a><span class="delimiter">)</span> <a href="../ast/TreeDSL.scala.html#547503" title="(params: List[CleanUp.this.global.Tree])CleanUp.this.global.Apply">APPLY</a> <a href="../../../collection/immutable/List.scala.html#48877" title="(xs: CleanUp.this.global.Tree*)List[CleanUp.this.global.Tree]">List</a><span class="delimiter">(</span><a href="../../../collection/LinearSeqOptimized.scala.html#71031" title="(n: Int)CleanUp.this.global.Tree">args</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>, <span class="delimiter">(</span><a href="../ast/TreeDSL.scala.html#515243" title="(sym: CleanUp.this.global.Symbol)CleanUp.this.global.gen.global.Tree">REF</a><a href="../ast/TreeDSL.scala.html#515248" title="implicit scala.tools.nsc.ast.TreeDSL.CODE.mkTreeMethods : (target: CleanUp.this.global.Tree)CleanUp.this.CODE.TreeMethods" class="delimiter">(</a><a href="../../../collection/MapLike.scala.html#73204" title="(key: CleanUp.this.global.Symbol)CleanUp.this.global.Symbol">unboxMethod</a><span class="delimiter">(</span><a href="../symtab/Definitions.scala.html#508431" title="=&gt; CleanUp.this.global.Symbol">IntClass</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../ast/TreeDSL.scala.html#547502" title="(params: CleanUp.this.global.Tree*)CleanUp.this.global.Apply">APPLY</a> <a href="../../../collection/LinearSeqOptimized.scala.html#71031" title="(n: Int)CleanUp.this.global.Tree">args</a><span class="delimiter">(</span><span title="Int(1)" class="int">1</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
              <span class="keyword">case</span> <a href="../symtab/StdNames.scala.html#479055" title="CleanUp.this.global.Apply">nme</a>.<a href="../symtab/StdNames.scala.html#516602" title="=&gt; CleanUp.this.global.nme.NameType">clone_</a> =&gt; <a href="../ast/TreeDSL.scala.html#515243" title="(sym: CleanUp.this.global.Symbol)CleanUp.this.global.gen.global.Tree">REF</a><a href="../ast/TreeDSL.scala.html#515248" title="implicit scala.tools.nsc.ast.TreeDSL.CODE.mkTreeMethods : (target: CleanUp.this.global.Tree)CleanUp.this.CODE.TreeMethods" class="delimiter">(</a><a href="../symtab/Definitions.scala.html#508036" title="=&gt; CleanUp.this.global.Symbol">arrayCloneMethod</a><span class="delimiter">)</span> <a href="../ast/TreeDSL.scala.html#547503" title="(params: List[CleanUp.this.global.Tree])CleanUp.this.global.Apply">APPLY</a> <a href="../../../collection/immutable/List.scala.html#48877" title="(xs: CleanUp.this.global.Tree*)List[CleanUp.this.global.Tree]">List</a><span class="delimiter">(</span><a href="../../../collection/LinearSeqOptimized.scala.html#71031" title="(n: Int)CleanUp.this.global.Tree">args</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span><span class="delimiter">)</span>
            <span class="delimiter">}</span>,
            mustBeUnit = <a href="#886519" title="CleanUp.this.global.Symbol">methSym</a>.<a href="../symtab/Symbols.scala.html#509256" title="=&gt; CleanUp.this.global.Name">name</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../symtab/StdNames.scala.html#479055" title="object CleanUp.this.global.nme">nme</a>.<a href="../symtab/StdNames.scala.html#516730" title="=&gt; CleanUp.this.global.nme.NameType">update</a>
          <span class="delimiter">)</span>

          <span class="comment">/** A conditional Array call, when we can't determine statically if the argument is
           *  an Array, but the structural type method signature is consistent with an Array method
           *  so we have to generate both kinds of code.
           */</span>
          <span class="keyword">def</span> <a title="=&gt; CleanUp.this.global.If" id="886536">genArrayCallWithTest</a> =
            <a href="../ast/TreeDSL.scala.html#515236" title="(tree: CleanUp.this.global.Tree)CleanUp.this.CODE.IfStart">IF</a> <span class="delimiter">(</span><span class="delimiter">(</span><a href="../ast/TreeDSL.scala.html#515248" title="implicit scala.tools.nsc.ast.TreeDSL.CODE.mkTreeMethods : (target: CleanUp.this.global.Tree)CleanUp.this.CODE.TreeMethods">qual</a> <a href="../ast/TreeDSL.scala.html#515248" title="implicit scala.tools.nsc.ast.TreeDSL.CODE.mkTreeMethods : (target: CleanUp.this.global.Tree)CleanUp.this.CODE.TreeMethods">GETCLASS</a><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../ast/TreeDSL.scala.html#515251" title="implicit scala.tools.nsc.ast.TreeDSL.CODE.mkTreeFromSelectStart : (ss: CleanUp.this.CODE.SelectStart)CleanUp.this.global.Select">DOT</a> <a href="../symtab/StdNames.scala.html#479055" title="object CleanUp.this.global.nme">nme</a>.<a href="../symtab/StdNames.scala.html#516654" title="=&gt; CleanUp.this.global.nme.NameType">isArray</a><span class="delimiter">)</span> <a href="../ast/TreeDSL.scala.html#547456" title="(x: CleanUp.this.global.Tree)CleanUp.this.CODE.IfStart">THEN</a> <a href="#886535" title="=&gt; CleanUp.this.global.Tree">genArrayCall</a> <a href="../ast/TreeDSL.scala.html#547457" title="(elsep: CleanUp.this.global.Tree)CleanUp.this.global.If">ELSE</a> <a href="#886532" title="=&gt; CleanUp.this.global.Tree">genDefaultCall</a>

          <a href="#885017" title="=&gt; CleanUp.this.global.analyzer.Typer">localTyper</a> <a href="../typechecker/Typers.scala.html#507768" title="(tree: CleanUp.this.global.analyzer.global.Tree)CleanUp.this.global.analyzer.global.Tree">typed</a> <span class="delimiter">(</span>
            <span title="CleanUp.this.global.analyzer.global.Tree" class="keyword">if</span> <span class="delimiter">(</span><a href="#886530" title="=&gt; Boolean">isMaybeBoxed</a> <a href="../../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#886522" title="=&gt; Boolean">isJavaValueMethod</a><span class="delimiter">)</span> <a href="#886534" title="=&gt; CleanUp.this.global.If">genValueCallWithTest</a>
            <span class="keyword">else</span> <span title="CleanUp.this.global.analyzer.global.Tree" class="keyword">if</span> <span class="delimiter">(</span><a href="#886525" title="Boolean">isArrayMethodSignature</a> <a href="../../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#886528" title="=&gt; Boolean">isDefinitelyArray</a><span class="delimiter">)</span> <a href="#886535" title="=&gt; CleanUp.this.global.Tree">genArrayCall</a>
            <span class="keyword">else</span> <span title="CleanUp.this.global.analyzer.global.Tree" class="keyword">if</span> <span class="delimiter">(</span><a href="#886525" title="Boolean">isArrayMethodSignature</a> <a href="../../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#886529" title="=&gt; Boolean">isMaybeArray</a><span class="delimiter">)</span> <a href="#886536" title="=&gt; CleanUp.this.global.If">genArrayCallWithTest</a>
            <span class="keyword">else</span> <a href="#886532" title="=&gt; CleanUp.this.global.Tree">genDefaultCall</a>
          <span class="delimiter">)</span>
        <span class="delimiter">}</span>

        <span title="CleanUp.this.global.Tree" class="keyword">if</span> <span class="delimiter">(</span><a href="../Global.scala.html#478200" title="=&gt; scala.tools.nsc.Settings">settings</a>.<a href="../settings/ScalaSettings.scala.html#469769" title="=&gt; scala.tools.nsc.Settings#ChoiceSetting">refinementMethodDispatch</a>.<a href="../settings/MutableSettings.scala.html#470030" title="=&gt; java.lang.String">value</a> <span title="(x$1: AnyRef)Boolean">==</span> <span title="java.lang.String(&quot;invoke-dynamic&quot;)" class="string">&quot;invoke-dynamic&quot;</span><span class="delimiter">)</span> <span class="delimiter">{</span>
<span class="comment">/*          val guardCallSite: Tree = {
            val cachedClass = addStaticVariableToClass(&quot;cachedClass&quot;, definitions.ClassClass.tpe, EmptyTree)
            val tmpVar = currentOwner.newVariable(ad.pos, unit.freshTermName(ad.pos, &quot;x&quot;)).setInfo(definitions.AnyRefClass.tpe)
            atPos(ad.pos)(Block(List(
              ValDef(tmpVar, transform(qual))),
              If(Apply(Select(gen.mkAttributedRef(cachedClass), nme.EQ), List(getClass(Ident(tmpVar)))),
                 Block(List(Assign(gen.mkAttributedRef(cachedClass), getClass(Ident(tmpVar)))),
                       treeCopy.ApplyDynamic(ad, Ident(tmpVar), transformTrees(params))),
                 EmptyTree)))
          }
          //println(guardCallSite)
*/</span>
          <a href="#885017" title="=&gt; CleanUp.this.global.analyzer.Typer">localTyper</a>.<a href="../typechecker/Typers.scala.html#507768" title="(tree: CleanUp.this.global.analyzer.global.Tree)CleanUp.this.global.analyzer.global.Tree">typed</a><span class="delimiter">(</span><a href="../ast/Trees.scala.html#560331" title="=&gt; CleanUp.this.global.TreeCopier">treeCopy</a>.<a href="../ast/Trees.scala.html#560261" title="(tree: CleanUp.this.global.Tree, qual: CleanUp.this.global.Tree, args: List[CleanUp.this.global.Tree])CleanUp.this.global.ApplyDynamic">ApplyDynamic</a><span class="delimiter">(</span><a href="#885170" title="CleanUp.this.global.ApplyDynamic">ad</a>, <a href="#885027" title="(tree: CleanUp.this.global.Tree)CleanUp.this.global.Tree">transform</a><span class="delimiter">(</span><a href="#885176" title="CleanUp.this.global.Tree">qual</a><span class="delimiter">)</span>, <a href="../ast/Trees.scala.html#560340" title="(trees: List[CleanUp.this.global.Tree])List[CleanUp.this.global.Tree]">transformTrees</a><span class="delimiter">(</span><a href="#885174" title="List[CleanUp.this.global.Tree]">params</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>
        <span class="keyword">else</span> <span class="delimiter">{</span>

          <span class="comment">/* ### BODY OF THE TRANSFORMATION -&gt; remember we're in case ad@ApplyDynamic(qual, params) ### */</span>

          <span class="comment">/* This creates the tree that does the reflective call (see general comment
           * on the apply-dynamic tree for its format). This tree is simply composed
           * of three successive calls, first to getClass on the callee, then to
           * getMethod on the class, then to invoke on the method.
           * - getMethod needs an array of classes for choosing one amongst many
           *   overloaded versions of the method. This is provided by paramTypeClasses
           *   and must be done on the static type as Scala's dispatching is static on
           *   the parameters.
           * - invoke needs an array of AnyRefs that are the method's arguments. The
           *   erasure phase guarantees that any parameter passed to a dynamic apply
           *   is compatible (through boxing). Boxed ints et al. is what invoke expects
           *   when the applied method expects ints, hence no change needed there.
           * - in the end, the result of invoke must be fixed, again to deal with arrays.
           *   This is provided by fixResult. fixResult will cast the invocation's result
           *   to the method's return type, which is generally ok, except when this type
           *   is a value type (int et al.) in which case it must cast to the boxed version
           *   because invoke only returns object and erasure made sure the result is
           *   expected to be an AnyRef. */</span>
          <span class="keyword">val</span> <a title="CleanUp.this.global.Tree" id="887063">t</a>: <a href="../../../reflect/generic/Trees.scala.html#434028" title="CleanUp.this.global.Tree">Tree</a> = <a href="#885170" title="CleanUp.this.global.ApplyDynamic">ad</a>.<a href="../../../reflect/generic/Trees.scala.html#441600" title="=&gt; CleanUp.this.global.Symbol">symbol</a>.<a href="../symtab/Symbols.scala.html#509270" title="=&gt; CleanUp.this.global.Type">tpe</a> <span title="CleanUp.this.global.Tree" class="keyword">match</span> <span class="delimiter">{</span>
            <span class="keyword">case</span> <span title="CleanUp.this.global.analyzer.global.Tree">MethodType</span><span class="delimiter">(</span><a title="List[CleanUp.this.global.Symbol]" id="887067">mparams</a>, <a title="CleanUp.this.global.Type" id="887068">resType</a><span class="delimiter">)</span> =&gt;
              <a href="../../../Predef.scala.html#9565" title="(assertion: Boolean)Unit">assert</a><span class="delimiter">(</span><a href="#885174" title="List[CleanUp.this.global.Tree]">params</a>.<a href="../../../collection/LinearSeqOptimized.scala.html#71030" title="=&gt; Int">length</a> <a href="../../../Int.scala.html#54747" title="(x: Int)Boolean">==</a> <a href="#887067" title="List[CleanUp.this.global.Symbol]">mparams</a>.<a href="../../../collection/LinearSeqOptimized.scala.html#71030" title="=&gt; Int">length</a><span class="delimiter">)</span>
              <a href="../../../Function1.scala.html#53453" title="(v1: CleanUp.this.global.Tree)CleanUp.this.global.analyzer.global.Tree">typedPos</a> <span class="delimiter">{</span>
                <span class="keyword">val</span> <a title="CleanUp.this.global.TermSymbol" id="887077">sym</a> = <a href="../ast/Trees.scala.html#560333" title="=&gt; CleanUp.this.global.Symbol">currentOwner</a>.<a href="../symtab/Symbols.scala.html#509125" title="(pos: CleanUp.this.global.Position, name: CleanUp.this.global.TermName)CleanUp.this.global.TermSymbol">newValue</a><span class="delimiter">(</span><a href="#885170" title="CleanUp.this.global.ApplyDynamic">ad</a>.<a href="../../../reflect/generic/Trees.scala.html#441024" title="=&gt; CleanUp.this.global.Position">pos</a>, <a href="#885014" title="(prefix: String)CleanUp.this.global.TermName">mkTerm</a><span class="delimiter">(</span><span title="java.lang.String(&quot;qual&quot;)" class="string">&quot;qual&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../symtab/Symbols.scala.html#509274" title="(info: CleanUp.this.global.Type)CleanUp.this.global.TermSymbol">setInfo</a> <a href="#885173" title="CleanUp.this.global.Tree">qual0</a>.<a href="../../../reflect/generic/Trees.scala.html#441028" title="=&gt; CleanUp.this.global.Type">tpe</a>
                <a href="#885176" title="CleanUp.this.global.Tree">qual</a> = <a href="#885015" title="(sym: CleanUp.this.global.Symbol)CleanUp.this.global.gen.global.Tree">safeREF</a><span class="delimiter">(</span><a href="#887077" title="CleanUp.this.global.TermSymbol">sym</a><span class="delimiter">)</span>

                <a href="../ast/TreeDSL.scala.html#515238" title="(xs: CleanUp.this.global.Tree*)CleanUp.this.global.Block">BLOCK</a><span class="delimiter">(</span>
                  <a href="../ast/TreeDSL.scala.html#515227" title="(sym: CleanUp.this.global.Symbol)CleanUp.this.CODE.ValSymStart">VAL</a><span class="delimiter">(</span><a href="#887077" title="CleanUp.this.global.TermSymbol">sym</a><span class="delimiter">)</span> <a href="../ast/TreeDSL.scala.html#548250" title="(rhs: CleanUp.this.global.Tree)CleanUp.this.global.ValDef">===</a> <a href="#885173" title="CleanUp.this.global.Tree">qual0</a>,
                  <a href="#885186" title="(paramTypes: List[CleanUp.this.global.Type], resType: CleanUp.this.global.Type)CleanUp.this.global.Tree">callAsReflective</a><span class="delimiter">(</span><a href="#887067" title="List[CleanUp.this.global.Symbol]">mparams</a> <a href="../../../collection/TraversableLike.scala.html#49041" title="(f: CleanUp.this.global.Symbol =&gt; CleanUp.this.global.Type)(implicit bf: scala.collection.generic.CanBuildFrom[List[CleanUp.this.global.Symbol],CleanUp.this.global.Type,List[CleanUp.this.global.Type]])List[CleanUp.this.global.Type]">map</a> <span class="delimiter">(</span><a href="#887119" title="CleanUp.this.global.Symbol">_</a>.<a href="../symtab/Symbols.scala.html#509270" title="=&gt; CleanUp.this.global.Type">tpe</a><span class="delimiter">)</span>, <a href="#887068" title="CleanUp.this.global.Type">resType</a><span class="delimiter">)</span>
                <span class="delimiter">)</span>
              <span class="delimiter">}</span>
          <span class="delimiter">}</span>

          <span class="comment">/* For testing purposes, the dynamic application's condition
           * can be printed-out in great detail. Remove? */</span>
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../Global.scala.html#478200" title="=&gt; scala.tools.nsc.Settings">settings</a>.<a href="../settings/ScalaSettings.scala.html#469727" title="=&gt; scala.tools.nsc.Settings#BooleanSetting">debug</a>.<a href="../settings/MutableSettings.scala.html#470030" title="=&gt; Boolean">value</a><span class="delimiter">)</span> <span class="delimiter">{</span>
            <span class="keyword">def</span> <a title="(xs: Any*)String" id="887150">paramsToString</a><span class="delimiter">(</span><a title="Any*" id="887152">xs</a>: <span title="Any*">Any</span>*<span class="delimiter">)</span> = <a href="#887152" title="Any*">xs</a> <a href="../../../collection/TraversableLike.scala.html#49041" title="(f: Any =&gt; java.lang.String)(implicit bf: scala.collection.generic.CanBuildFrom[Seq[Any],java.lang.String,Seq[java.lang.String]])Seq[java.lang.String]">map</a> <span class="delimiter">(</span><a href="#887169" title="Any">_</a>.<span title="()java.lang.String">toString</span><span class="delimiter">)</span> <a href="../../../collection/TraversableOnce.scala.html#53709" title="(sep: String)String">mkString</a> <span title="java.lang.String(&quot;, &quot;)" class="string">&quot;, &quot;</span>
            <span class="keyword">val</span> <a title="String" id="887151">mstr</a> = <a href="#885170" title="CleanUp.this.global.ApplyDynamic">ad</a>.<a href="../../../reflect/generic/Trees.scala.html#441600" title="=&gt; CleanUp.this.global.Symbol">symbol</a>.<a href="../symtab/Symbols.scala.html#509270" title="=&gt; CleanUp.this.global.Type">tpe</a> <span title="String" class="keyword">match</span> <span class="delimiter">{</span>
              <span class="keyword">case</span> <span title="String">MethodType</span><span class="delimiter">(</span><a title="List[CleanUp.this.global.Symbol]" id="887195">mparams</a>, <a title="CleanUp.this.global.Type" id="887196">resType</a><span class="delimiter">)</span> =&gt;
                <a href="../../../Predef.scala.html#9682" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;&quot;&quot;|  with
                   |  - declared parameter types: '%s'
                   |  - passed argument types:    '%s'
                   |  - result type:              '%s'&quot;&quot;&quot;</a> .
                  <a href="../../../Predef.scala.html#9682" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">stripMargin</a>.<a href="../../../collection/immutable/StringLike.scala.html#56577" title="(args: Any*)String">format</a><span class="delimiter">(</span>
                     <a href="#887150" title="(xs: Any*)String">paramsToString</a><span class="delimiter">(</span><a href="#887195" title="List[CleanUp.this.global.Symbol]">mparams</a><span class="delimiter">)</span>,
                     <a href="#887150" title="(xs: Any*)String">paramsToString</a><span class="delimiter">(</span><a href="#885174" title="List[CleanUp.this.global.Tree]">params</a><span class="delimiter">)</span>,
                     <a href="#887196" title="CleanUp.this.global.Type">resType</a>.<a href="../../../reflect/generic/Types.scala.html#434192" title="()String">toString</a>
                  <span class="delimiter">)</span>
              <span class="keyword">case</span> <span title="java.lang.String(&quot;&quot;)">_</span> =&gt; <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span>
            <span class="delimiter">}</span>
            <a href="../Global.scala.html#478254" title="(msg: =&gt; AnyRef)Unit">log</a><span class="delimiter">(</span>
              <a href="../../../Predef.scala.html#9682" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;&quot;&quot;Dynamically application '%s.%s(%s)' %s - resulting code: '%s'&quot;&quot;&quot;</a>.<a href="../../../collection/immutable/StringLike.scala.html#56577" title="(args: Any*)String">format</a><span class="delimiter">(</span>
                <a href="#885176" title="CleanUp.this.global.Tree">qual</a>, <a href="#885170" title="CleanUp.this.global.ApplyDynamic">ad</a>.<a href="../../../reflect/generic/Trees.scala.html#441600" title="=&gt; CleanUp.this.global.Symbol">symbol</a>.<a href="../symtab/Symbols.scala.html#509256" title="=&gt; CleanUp.this.global.Name">name</a>, <a href="#887150" title="(xs: Any*)String">paramsToString</a><span class="delimiter">(</span><a href="#885174" title="List[CleanUp.this.global.Tree]">params</a><span class="delimiter">)</span>, <a href="#887151" title="String">mstr</a>, <a href="#887063" title="CleanUp.this.global.Tree">t</a>
              <span class="delimiter">)</span>
            <span class="delimiter">)</span>
          <span class="delimiter">}</span>

          <span class="comment">/* We return the dynamic call tree, after making sure no other
           * clean-up transformation are to be applied on it. */</span>
          <a href="#885027" title="(tree: CleanUp.this.global.Tree)CleanUp.this.global.Tree">transform</a><span class="delimiter">(</span><a href="#887063" title="CleanUp.this.global.Tree">t</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
        <span class="comment">/* ### END OF DYNAMIC APPLY TRANSFORM ### */</span>

      <span class="comment">/* Some cleanup transformations add members to templates (classes, traits, etc).
       * When inside a template (i.e. the body of one of its members), two maps
       * (newStaticMembers and newStaticInits) are available in the tree transformer. Any mapping from
       * a symbol to a MemberDef (DefDef, ValDef, etc.) that is in newStaticMembers once the
       * transformation of the template is finished will be added as a member to the
       * template. Any mapping from a symbol to a tree that is in newStaticInits, will be added
       * as a statement of the form &quot;symbol = tree&quot; to the beginning of the default
       * constructor. */</span>
      <span class="keyword">case</span> <span title="CleanUp.this.global.Template">Template</span><span class="delimiter">(</span><a title="List[CleanUp.this.global.Tree]" id="887226">parents</a>, <a title="CleanUp.this.global.ValDef" id="887227">self</a>, <a title="List[CleanUp.this.global.Tree]" id="887228">body</a><span class="delimiter">)</span> =&gt;
        <a href="#885017" title="(x$1: CleanUp.this.global.analyzer.Typer)Unit">localTyper</a> = <a href="../Global.scala.html#478336" title="object CleanUp.this.global.typer">typer</a>.<a href="../typechecker/Typers.scala.html#507767" title="(tree: CleanUp.this.global.analyzer.global.Tree, owner: CleanUp.this.global.analyzer.global.Symbol)CleanUp.this.global.analyzer.Typer">atOwner</a><span class="delimiter">(</span><a href="#885167" title="CleanUp.this.global.Tree">tree</a>, <a href="../ast/Trees.scala.html#560337" title="=&gt; CleanUp.this.global.Symbol">currentClass</a><span class="delimiter">)</span>
        <span class="keyword">var</span> <a title="scala.collection.mutable.Buffer[CleanUp.this.global.Tree]" id="887229">savedNewStaticMembers</a> : mutable.<a href="../../../collection/mutable/Buffer.scala.html#14722" title="scala.collection.mutable.Buffer[CleanUp.this.global.Tree]">Buffer</a><span class="delimiter">[</span>Tree<span class="delimiter">]</span> = <span title="Null(null)" class="keyword">null</span>
        <span class="keyword">var</span> <a title="scala.collection.mutable.Buffer[CleanUp.this.global.Tree]" id="887230">savedNewStaticInits</a>   : mutable.<a href="../../../collection/mutable/Buffer.scala.html#14722" title="scala.collection.mutable.Buffer[CleanUp.this.global.Tree]">Buffer</a><span class="delimiter">[</span>Tree<span class="delimiter">]</span> = <span title="Null(null)" class="keyword">null</span>
        <span class="keyword">var</span> <a title="scala.collection.mutable.Map[String,CleanUp.this.global.Symbol]" id="887231">savedSymbolsStoredAsStatic</a> : mutable.<a href="../../../collection/mutable/Map.scala.html#14767" title="scala.collection.mutable.Map[String,CleanUp.this.global.Symbol]">Map</a><span class="delimiter">[</span>String, Symbol<span class="delimiter">]</span> = <span title="Null(null)" class="keyword">null</span>
        <span title="Unit" class="keyword">if</span><span class="delimiter">(</span><a href="../Global.scala.html#478374" title="=&gt; Boolean">forMSIL</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="#887229" title="scala.collection.mutable.Buffer[CleanUp.this.global.Tree]">savedNewStaticMembers</a> = <a href="#885008" title="=&gt; scala.collection.mutable.Buffer[CleanUp.this.global.Tree]">newStaticMembers</a>.<a href="../../../collection/mutable/Cloneable.scala.html#55817" title="()scala.collection.mutable.Buffer[CleanUp.this.global.Tree]">clone</a>
          <a href="#887230" title="scala.collection.mutable.Buffer[CleanUp.this.global.Tree]">savedNewStaticInits</a> = <a href="#885010" title="=&gt; scala.collection.mutable.Buffer[CleanUp.this.global.Tree]">newStaticInits</a>.<a href="../../../collection/mutable/Cloneable.scala.html#55817" title="()scala.collection.mutable.Buffer[CleanUp.this.global.Tree]">clone</a>
          <a href="#887231" title="scala.collection.mutable.Map[String,CleanUp.this.global.Symbol]">savedSymbolsStoredAsStatic</a> = <a href="#885012" title="=&gt; scala.collection.mutable.Map[String,CleanUp.this.global.Symbol]">symbolsStoredAsStatic</a>.<a href="../../../collection/mutable/MapLike.scala.html#73297" title="()scala.collection.mutable.Map[String,CleanUp.this.global.Symbol]">clone</a>
        <span class="delimiter">}</span>
        <a href="#885008" title="=&gt; scala.collection.mutable.Buffer[CleanUp.this.global.Tree]">newStaticMembers</a>.<a href="../../../collection/mutable/BufferLike.scala.html#61810" title="()Unit">clear</a>
        <a href="#885010" title="=&gt; scala.collection.mutable.Buffer[CleanUp.this.global.Tree]">newStaticInits</a>.<a href="../../../collection/mutable/BufferLike.scala.html#61810" title="()Unit">clear</a>
        <a href="#885012" title="=&gt; scala.collection.mutable.Map[String,CleanUp.this.global.Symbol]">symbolsStoredAsStatic</a>.<a href="../../../collection/mutable/MapLike.scala.html#73293" title="()Unit">clear</a>
        <span class="keyword">val</span> <a title="CleanUp.this.global.Template" id="887232">transformedTemplate</a>: <a href="../../../reflect/generic/Trees.scala.html#434067" title="CleanUp.this.global.Template">Template</a> = <span class="delimiter">{</span>
          <span class="keyword">var</span> <a title="List[CleanUp.this.global.Tree]" id="887244">newBody</a> = <a href="../ast/Trees.scala.html#560340" title="(trees: List[CleanUp.this.global.Tree])List[CleanUp.this.global.Tree]">transformTrees</a><span class="delimiter">(</span><a href="#887228" title="List[CleanUp.this.global.Tree]">body</a><span class="delimiter">)</span>
          <a href="../ast/Trees.scala.html#560331" title="=&gt; CleanUp.this.global.TreeCopier">treeCopy</a>.<a href="../ast/Trees.scala.html#560241" title="(tree: CleanUp.this.global.Tree, parents: List[CleanUp.this.global.Tree], self: CleanUp.this.global.ValDef, body: List[CleanUp.this.global.Tree])CleanUp.this.global.Template">Template</a><span class="delimiter">(</span><a href="#885167" title="CleanUp.this.global.Tree">tree</a>, <a href="#887226" title="List[CleanUp.this.global.Tree]">parents</a>, <a href="#887227" title="CleanUp.this.global.ValDef">self</a>, <a href="../ast/Trees.scala.html#560340" title="(trees: List[CleanUp.this.global.Tree])List[CleanUp.this.global.Tree]">transformTrees</a><span class="delimiter">(</span><a href="#885008" title="=&gt; scala.collection.mutable.Buffer[CleanUp.this.global.Tree]">newStaticMembers</a>.<a href="../../../collection/TraversableOnce.scala.html#53691" title="=&gt; List[CleanUp.this.global.Tree]">toList</a><span class="delimiter">)</span> <a href="../../../collection/immutable/List.scala.html#49143" title="(prefix: List[CleanUp.this.global.Tree])List[CleanUp.this.global.Tree]">:::</a> <a href="#887244" title="List[CleanUp.this.global.Tree]">newBody</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
        <span class="keyword">val</span> <a title="CleanUp.this.global.Template" id="887233">res</a> = <a href="#885030" title="(template: CleanUp.this.global.Template)CleanUp.this.global.Template">addStaticInits</a><span class="delimiter">(</span><a href="#887232" title="CleanUp.this.global.Template">transformedTemplate</a><span class="delimiter">)</span> <span class="comment">// postprocess to include static ctors</span>
        <a href="#885008" title="=&gt; scala.collection.mutable.Buffer[CleanUp.this.global.Tree]">newStaticMembers</a>.<a href="../../../collection/mutable/BufferLike.scala.html#61810" title="()Unit">clear</a>
        <a href="#885010" title="=&gt; scala.collection.mutable.Buffer[CleanUp.this.global.Tree]">newStaticInits</a>.<a href="../../../collection/mutable/BufferLike.scala.html#61810" title="()Unit">clear</a>
        <a href="#885012" title="=&gt; scala.collection.mutable.Map[String,CleanUp.this.global.Symbol]">symbolsStoredAsStatic</a>.<a href="../../../collection/mutable/MapLike.scala.html#73293" title="()Unit">clear</a>
        <span title="Any" class="keyword">if</span><span class="delimiter">(</span><a href="../Global.scala.html#478374" title="=&gt; Boolean">forMSIL</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="#885008" title="=&gt; scala.collection.mutable.Buffer[CleanUp.this.global.Tree]">newStaticMembers</a>      <a href="../../../collection/generic/Growable.scala.html#56649" title="(xs: scala.collection.TraversableOnce[CleanUp.this.global.Tree])CleanUpTransformer.this.newStaticMembers.type">++=</a> <a href="#887229" title="scala.collection.mutable.Buffer[CleanUp.this.global.Tree]">savedNewStaticMembers</a>
          <a href="#885010" title="=&gt; scala.collection.mutable.Buffer[CleanUp.this.global.Tree]">newStaticInits</a>        <a href="../../../collection/generic/Growable.scala.html#56649" title="(xs: scala.collection.TraversableOnce[CleanUp.this.global.Tree])CleanUpTransformer.this.newStaticInits.type">++=</a> <a href="#887230" title="scala.collection.mutable.Buffer[CleanUp.this.global.Tree]">savedNewStaticInits</a>
          <a href="#885012" title="=&gt; scala.collection.mutable.Map[String,CleanUp.this.global.Symbol]">symbolsStoredAsStatic</a> <a href="../../../collection/generic/Growable.scala.html#56649" title="(xs: scala.collection.TraversableOnce[(String, CleanUp.this.global.Symbol)])CleanUpTransformer.this.symbolsStoredAsStatic.type">++=</a> <a href="#887231" title="scala.collection.mutable.Map[String,CleanUp.this.global.Symbol]">savedSymbolsStoredAsStatic</a>
        <span class="delimiter">}</span>
        <a href="#887233" title="CleanUp.this.global.Template">res</a>

      <span class="keyword">case</span> <span title="CleanUp.this.global.analyzer.global.Tree">Literal</span><span class="delimiter">(</span><a title="CleanUp.this.global.Constant" id="887292">c</a><span class="delimiter">)</span> <span class="keyword">if</span> <span class="delimiter">(</span><a href="#887292" title="CleanUp.this.global.Constant">c</a>.<a href="../../../reflect/generic/Constants.scala.html#434214" title="=&gt; Int">tag</a> <a href="../../../Int.scala.html#54747" title="(x: Int)Boolean">==</a> <span title="Int(12)">ClassTag</span><span class="delimiter">)</span> <a href="../../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="../../../Boolean.scala.html#55576" title="=&gt; Boolean">!</a><a href="../Global.scala.html#478374" title="=&gt; Boolean">forMSIL</a>=&gt;
        <span class="keyword">val</span> <a title="CleanUp.this.global.Type" id="887297">tpe</a> = <a href="#887292" title="CleanUp.this.global.Constant">c</a>.<a href="../../../reflect/generic/Constants.scala.html#434238" title="=&gt; CleanUp.this.global.Type">typeValue</a>
        <a href="#885023" title="(pos: CleanUp.this.global.Position)(tree: CleanUp.this.global.Tree)CleanUp.this.global.analyzer.global.Tree">typedWithPos</a><span class="delimiter">(</span><a href="#885167" title="CleanUp.this.global.Tree">tree</a>.<a href="../../../reflect/generic/Trees.scala.html#441024" title="=&gt; CleanUp.this.global.Position">pos</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <span title="CleanUp.this.global.Tree" class="keyword">if</span> <span class="delimiter">(</span><a href="../symtab/Definitions.scala.html#508366" title="(sym: CleanUp.this.global.Symbol)Boolean">isValueClass</a><span class="delimiter">(</span><a href="#887297" title="CleanUp.this.global.Type">tpe</a>.<a href="../symtab/Types.scala.html#507159" title="=&gt; CleanUp.this.global.Symbol">typeSymbol</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
            <span title="CleanUp.this.global.Tree" class="keyword">if</span> <span class="delimiter">(</span><a href="#887297" title="CleanUp.this.global.Type">tpe</a>.<a href="../symtab/Types.scala.html#507159" title="=&gt; CleanUp.this.global.Symbol">typeSymbol</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../symtab/Definitions.scala.html#508423" title="=&gt; CleanUp.this.global.Symbol">UnitClass</a><span class="delimiter">)</span>
              <a href="../ast/TreeDSL.scala.html#515243" title="(sym: CleanUp.this.global.Symbol)CleanUp.this.global.gen.global.Tree">REF</a><span class="delimiter">(</span><a href="../symtab/Definitions.scala.html#508306" title="=&gt; CleanUp.this.global.Symbol">BoxedUnit_TYPE</a><span class="delimiter">)</span>
            <span class="keyword">else</span>
              <a href="../../../reflect/generic/Trees.scala.html#443970" title="(qualifier: CleanUp.this.global.Tree, name: CleanUp.this.global.Name)CleanUp.this.global.Select">Select</a><span class="delimiter">(</span><a href="../ast/TreeDSL.scala.html#515243" title="(sym: CleanUp.this.global.Symbol)CleanUp.this.global.gen.global.Tree">REF</a><span class="delimiter">(</span><a href="../../../collection/MapLike.scala.html#73204" title="(key: CleanUp.this.global.Symbol)CleanUp.this.global.Symbol">boxedModule</a><span class="delimiter">(</span><a href="#887297" title="CleanUp.this.global.Type">tpe</a>.<a href="../symtab/Types.scala.html#507159" title="=&gt; CleanUp.this.global.Symbol">typeSymbol</a><span class="delimiter">)</span><span class="delimiter">)</span>, <a href="../symtab/StdNames.scala.html#479055" title="object CleanUp.this.global.nme">nme</a>.<a href="../symtab/StdNames.scala.html#516576" title="=&gt; CleanUp.this.global.nme.NameType">TYPE_</a><span class="delimiter">)</span>
          <span class="delimiter">}</span>

          <span class="keyword">else</span> <a href="#885167" title="CleanUp.this.global.Tree">tree</a>
        <span class="delimiter">}</span>

      <span class="comment">/* MSIL requires that the stack is empty at the end of a try-block.
       * Hence, we here rewrite all try blocks with a result != {Unit, All} such that they
       * store their result in a local variable. The catch blocks are adjusted as well.
       * The try tree is subsituted by a block whose result expression is read of that variable. */</span>
      <span class="keyword">case</span> <a title="CleanUp.this.global.analyzer.global.Tree" id="887340">theTry</a> @ Try<span class="delimiter">(</span><a title="CleanUp.this.global.Tree" id="887344">block</a>, <a title="List[CleanUp.this.global.CaseDef]" id="887345">catches</a>, <a title="CleanUp.this.global.Tree" id="887346">finalizer</a><span class="delimiter">)</span>
        <span class="keyword">if</span> <a href="#887340" title="CleanUp.this.global.Try">theTry</a>.<a href="../../../reflect/generic/Trees.scala.html#441028" title="=&gt; CleanUp.this.global.Type">tpe</a>.<a href="../symtab/Types.scala.html#507159" title="=&gt; CleanUp.this.global.Symbol">typeSymbol</a> <span title="(x$1: AnyRef)Boolean">!=</span> <a href="../symtab/Definitions.scala.html#479030" title="object CleanUp.this.global.definitions">definitions</a>.<a href="../symtab/Definitions.scala.html#508423" title="=&gt; CleanUp.this.global.Symbol">UnitClass</a> <a href="../../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a> <a href="#887340" title="CleanUp.this.global.Try">theTry</a>.<a href="../../../reflect/generic/Trees.scala.html#441028" title="=&gt; CleanUp.this.global.Type">tpe</a>.<a href="../symtab/Types.scala.html#507159" title="=&gt; CleanUp.this.global.Symbol">typeSymbol</a> <span title="(x$1: AnyRef)Boolean">!=</span> <a href="../symtab/Definitions.scala.html#479030" title="object CleanUp.this.global.definitions">definitions</a>.<a href="../symtab/Definitions.scala.html#507933" title="=&gt; CleanUp.this.global.Symbol">NothingClass</a> =&gt;
        <span class="keyword">val</span> <a title="CleanUp.this.global.Type" id="887359">tpe</a> = <a href="#887340" title="CleanUp.this.global.Try">theTry</a>.<a href="../../../reflect/generic/Trees.scala.html#441028" title="=&gt; CleanUp.this.global.Type">tpe</a>.<a href="../symtab/Types.scala.html#507163" title="=&gt; CleanUp.this.global.Type">widen</a>
        <span class="keyword">val</span> <a title="CleanUp.this.global.TermSymbol" id="887360">tempVar</a> = <a href="../ast/Trees.scala.html#560333" title="=&gt; CleanUp.this.global.Symbol">currentOwner</a>.<a href="../symtab/Symbols.scala.html#509127" title="(pos: CleanUp.this.global.Position, name: CleanUp.this.global.TermName)CleanUp.this.global.TermSymbol">newVariable</a><span class="delimiter">(</span><a href="#887340" title="CleanUp.this.global.Try">theTry</a>.<a href="../../../reflect/generic/Trees.scala.html#441024" title="=&gt; CleanUp.this.global.Position">pos</a>, <a href="#885014" title="(prefix: String)CleanUp.this.global.TermName">mkTerm</a><span class="delimiter">(</span><a href="../symtab/StdNames.scala.html#479055" title="object CleanUp.this.global.nme">nme</a>.<a href="../symtab/StdNames.scala.html#516782" title="=&gt; java.lang.String">EXCEPTION_RESULT_PREFIX</a><span class="delimiter">)</span><span class="delimiter">)</span>.<a href="../symtab/Symbols.scala.html#509274" title="(info: CleanUp.this.global.Type)CleanUp.this.global.TermSymbol">setInfo</a><span class="delimiter">(</span><a href="#887359" title="CleanUp.this.global.Type">tpe</a><span class="delimiter">)</span>
        <span class="keyword">def</span> <a title="(rhs: CleanUp.this.global.Tree)CleanUp.this.global.Tree" id="887361">assignBlock</a><span class="delimiter">(</span><a title="CleanUp.this.global.Tree" id="887367">rhs</a>: <a href="../../../reflect/generic/Trees.scala.html#434028" title="CleanUp.this.global.Tree">Tree</a><span class="delimiter">)</span> = <a href="#513438" title="CleanUp.this.CleanUpTransformer" class="keyword">super</a>.<a href="../ast/Trees.scala.html#560339" title="(tree: CleanUp.this.global.Tree)CleanUp.this.global.Tree">transform</a><span class="delimiter">(</span><a href="../ast/TreeDSL.scala.html#515238" title="(xs: CleanUp.this.global.Tree*)CleanUp.this.global.Block">BLOCK</a><span class="delimiter">(</span><a href="../ast/Trees.scala.html#479144" title="(sym: CleanUp.this.global.Symbol)CleanUp.this.global.Ident">Ident</a><a href="../ast/TreeDSL.scala.html#515248" title="implicit scala.tools.nsc.ast.TreeDSL.CODE.mkTreeMethods : (target: CleanUp.this.global.Tree)CleanUp.this.CODE.TreeMethods" class="delimiter">(</a><a href="#887360" title="CleanUp.this.global.TermSymbol">tempVar</a><span class="delimiter">)</span> <a href="../ast/TreeDSL.scala.html#547507" title="(rhs: CleanUp.this.global.Tree)CleanUp.this.global.Assign">===</a> <a href="#885027" title="(tree: CleanUp.this.global.Tree)CleanUp.this.global.Tree">transform</a><span class="delimiter">(</span><a href="#887367" title="CleanUp.this.global.Tree">rhs</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>

        <span class="keyword">val</span> <a title="CleanUp.this.global.Tree" id="887362">newBlock</a>    = <a href="#887361" title="(rhs: CleanUp.this.global.Tree)CleanUp.this.global.Tree">assignBlock</a><span class="delimiter">(</span><a href="#887344" title="CleanUp.this.global.Tree">block</a><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="List[CleanUp.this.global.CaseDef]" id="887363">newCatches</a>  = <span class="keyword">for</span> <span class="delimiter">(</span>CaseDef<span class="delimiter">(</span><a title="CleanUp.this.global.Tree" id="887429">pattern</a>, <a title="CleanUp.this.global.Tree" id="887430">guard</a>, <a title="CleanUp.this.global.Tree" id="887431">body</a><span class="delimiter">)</span> &lt;- <a href="../../../collection/TraversableLike.scala.html#49041" title="(f: CleanUp.this.global.CaseDef =&gt; CleanUp.this.global.CaseDef)(implicit bf: scala.collection.generic.CanBuildFrom[List[CleanUp.this.global.CaseDef],CleanUp.this.global.CaseDef,List[CleanUp.this.global.CaseDef]])List[CleanUp.this.global.CaseDef]">catches</a><span class="delimiter">)</span> <span class="keyword">yield</span>
          <span class="delimiter">(</span><a href="../ast/TreeDSL.scala.html#515214" title="(pat: CleanUp.this.global.Tree)CleanUp.this.CODE.CaseStart">CASE</a><span class="delimiter">(</span><a href="#513438" title="CleanUp.this.CleanUpTransformer" class="keyword">super</a>.<a href="../ast/Trees.scala.html#560339" title="(tree: CleanUp.this.global.Tree)CleanUp.this.global.Tree">transform</a><span class="delimiter">(</span><a href="#887429" title="CleanUp.this.global.Tree">pattern</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../ast/TreeDSL.scala.html#548125" title="(g: CleanUp.this.global.Tree)CleanUp.this.CODE.CaseStart">IF</a> <span class="delimiter">(</span><a href="#513438" title="CleanUp.this.CleanUpTransformer" class="keyword">super</a>.<a href="../ast/Trees.scala.html#560339" title="(tree: CleanUp.this.global.Tree)CleanUp.this.global.Tree">transform</a><span class="delimiter">(</span><a href="#887430" title="CleanUp.this.global.Tree">guard</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../ast/TreeDSL.scala.html#548126" title="(body: CleanUp.this.global.Tree)CleanUp.this.global.CaseDef">==&gt;</a> <a href="#887361" title="(rhs: CleanUp.this.global.Tree)CleanUp.this.global.Tree">assignBlock</a><span class="delimiter">(</span><a href="#887431" title="CleanUp.this.global.Tree">body</a><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="CleanUp.this.global.Try" id="887364">newTry</a>      = <a href="../../../reflect/generic/Trees.scala.html#443729" title="(block: CleanUp.this.global.Tree, catches: List[CleanUp.this.global.CaseDef], finalizer: CleanUp.this.global.Tree)CleanUp.this.global.Try">Try</a><span class="delimiter">(</span><a href="#887362" title="CleanUp.this.global.Tree">newBlock</a>, <a href="#887363" title="List[CleanUp.this.global.CaseDef]">newCatches</a>, <a href="#513438" title="CleanUp.this.CleanUpTransformer" class="keyword">super</a>.<a href="../ast/Trees.scala.html#560339" title="(tree: CleanUp.this.global.Tree)CleanUp.this.global.Tree">transform</a><span class="delimiter">(</span><a href="#887346" title="CleanUp.this.global.Tree">finalizer</a><span class="delimiter">)</span><span class="delimiter">)</span>

        <a href="#885023" title="(pos: CleanUp.this.global.Position)(tree: CleanUp.this.global.Tree)CleanUp.this.global.analyzer.global.Tree">typedWithPos</a><span class="delimiter">(</span><a href="#887340" title="CleanUp.this.global.Try">theTry</a>.<a href="../../../reflect/generic/Trees.scala.html#441024" title="=&gt; CleanUp.this.global.Position">pos</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="../ast/TreeDSL.scala.html#515238" title="(xs: CleanUp.this.global.Tree*)CleanUp.this.global.Block">BLOCK</a><span class="delimiter">(</span><a href="../ast/TreeDSL.scala.html#515227" title="(sym: CleanUp.this.global.Symbol)CleanUp.this.CODE.ValSymStart">VAL</a><span class="delimiter">(</span><a href="#887360" title="CleanUp.this.global.TermSymbol">tempVar</a><span class="delimiter">)</span> <a href="../ast/TreeDSL.scala.html#548250" title="(rhs: CleanUp.this.global.Tree)CleanUp.this.global.ValDef">===</a> <a href="../../../reflect/generic/Trees.scala.html#434035" title="object CleanUp.this.global.EmptyTree">EmptyTree</a>, <a href="#887364" title="CleanUp.this.global.Try">newTry</a>, <a href="../ast/Trees.scala.html#479144" title="(sym: CleanUp.this.global.Symbol)CleanUp.this.global.Ident">Ident</a><span class="delimiter">(</span><a href="#887360" title="CleanUp.this.global.TermSymbol">tempVar</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>

     <span class="comment">/*
      * This transformation should identify Scala symbol invocations in the tree and replace them
      * with references to a static member. Also, whenever a class has at least a single symbol invocation
      * somewhere in its methods, a new static member should be created and initialized for that symbol.
      * For instance, say we have a Scala class:
      *
      * class Cls {
      *   // ...
      *   def someSymbol = `symbolic
      *   // ...
      * }
      *
      * After transformation, this class looks like this:
      *
      * class Cls {
      *   private &quot;static&quot; val &lt;some_name&gt;$symbolic = Symbol(&quot;symbolic&quot;)
      *   // ...
      *   def someSymbol = &lt;some_name&gt;$symbolic
      *   // ...
      * }
      *
      * The reasoning behind this transformation is the following. Symbols get interned - they are stored
      * in a global map which is protected with a lock. The reason for this is making equality checks
      * quicker. But calling Symbol.apply, although it does return a unique symbol, accesses a locked object,
      * making symbol access slow. To solve this, the unique symbol from the global symbol map in Symbol
      * is accessed only once during class loading, and after that, the unique symbol is in the static
      * member. Hence, it is cheap to both reach the unique symbol and do equality checks on it.
      *
      * And, finally, be advised - scala symbol literal and the Symbol class of the compiler
      * have little in common.
      */</span>
      <span class="keyword">case</span> <a title="CleanUp.this.global.Tree" id="887492">symapp</a> @ Apply<span class="delimiter">(</span>Select<span class="delimiter">(</span>Select<span class="delimiter">(</span><a title="CleanUp.this.global.Ident" id="887503">a</a> @ Ident<span class="delimiter">(</span><a href="../symtab/StdNames.scala.html#479055" title="object CleanUp.this.global.nme">nme</a>.<a href="../symtab/StdNames.scala.html#516700" title="=&gt; CleanUp.this.global.nme.NameType">scala_</a><span class="delimiter">)</span>, <a title="CleanUp.this.global.nme.NameType" id="887507">b</a> @ <a href="../symtab/StdNames.scala.html#479055" title="object CleanUp.this.global.nme">nme</a>.<a href="../symtab/StdNames.scala.html#516184" title="=&gt; CleanUp.this.global.nme.NameType">Symbol</a><span class="delimiter">)</span>, <a href="../symtab/StdNames.scala.html#479055" title="object CleanUp.this.global.nme">nme</a>.<a href="../symtab/StdNames.scala.html#516580" title="=&gt; CleanUp.this.global.nme.NameType">apply</a><span class="delimiter">)</span>,
                          <a href="../../../collection/generic/GenSeqFactory.scala.html#48862" title="(x: List[CleanUp.this.global.Tree])Some[List[CleanUp.this.global.Tree]]">List</a><span class="delimiter">(</span>Literal<span class="delimiter">(</span>Constant<span class="delimiter">(</span><a title="String" id="887523">symname</a>: <span title="String">String</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span> =&gt;
        <span class="comment">// add the symbol name to a map if it's not there already</span>
        <span class="keyword">val</span> <a title="CleanUp.this.global.gen.global.Tree" id="887524">rhs</a> = <a href="../Global.scala.html#478214" title="object CleanUp.this.global.gen">gen</a>.<a href="../ast/TreeGen.scala.html#507277" title="(tree: CleanUp.this.global.gen.global.Tree, pt: CleanUp.this.global.gen.global.Type)CleanUp.this.global.gen.global.Tree">mkCast</a><span class="delimiter">(</span><a href="../../../reflect/generic/Trees.scala.html#443864" title="(fun: CleanUp.this.global.Tree, args: List[CleanUp.this.global.Tree])CleanUp.this.global.Apply">Apply</a><span class="delimiter">(</span><a href="../Global.scala.html#478214" title="object CleanUp.this.global.gen">gen</a>.<a href="../ast/TreeGen.scala.html#507262" title="(name: CleanUp.this.global.gen.global.Name)CleanUp.this.global.gen.global.Select">scalaDot</a><span class="delimiter">(</span><a href="../symtab/StdNames.scala.html#479055" title="object CleanUp.this.global.nme">nme</a>.<a href="../symtab/StdNames.scala.html#516184" title="=&gt; CleanUp.this.global.nme.NameType">Symbol</a><span class="delimiter">)</span>, <a href="../../../collection/immutable/List.scala.html#48877" title="(xs: CleanUp.this.global.Literal*)List[CleanUp.this.global.Literal]">List</a><span class="delimiter">(</span><a href="../../../reflect/generic/Trees.scala.html#443172" title="(value: CleanUp.this.global.Constant)CleanUp.this.global.Literal">Literal</a><span class="delimiter">(</span><a href="../../../reflect/generic/Constants.scala.html#435761" title="(value: Any)CleanUp.this.global.Constant">Constant</a><span class="delimiter">(</span><a href="#887523" title="String">symname</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>, <a href="../symtab/Definitions.scala.html#508159" title="=&gt; CleanUp.this.global.Type">symbolType</a><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="CleanUp.this.global.Symbol" id="887525">staticFieldSym</a> = <a href="#885028" title="(pos: CleanUp.this.global.Position, symname: String, rhs: CleanUp.this.global.Tree, tree: CleanUp.this.global.Tree)CleanUp.this.global.Symbol">getSymbolStaticField</a><span class="delimiter">(</span><a href="#887492" title="CleanUp.this.global.Apply">symapp</a>.<a href="../../../reflect/generic/Trees.scala.html#441024" title="=&gt; CleanUp.this.global.Position">pos</a>, <a href="#887523" title="String">symname</a>, <a href="#887524" title="CleanUp.this.global.gen.global.Tree">rhs</a>, <a href="#887492" title="CleanUp.this.global.Apply">symapp</a><span class="delimiter">)</span>

        <span class="comment">// create a reference to a static field</span>
        <span class="keyword">val</span> <a title="CleanUp.this.global.analyzer.global.Tree" id="887526">ntree</a> = <a href="#885023" title="(pos: CleanUp.this.global.Position)(tree: CleanUp.this.global.Tree)CleanUp.this.global.analyzer.global.Tree">typedWithPos</a><span class="delimiter">(</span><a href="#887492" title="CleanUp.this.global.Apply">symapp</a>.<a href="../../../reflect/generic/Trees.scala.html#441024" title="=&gt; CleanUp.this.global.Position">pos</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#885015" title="(sym: CleanUp.this.global.Symbol)CleanUp.this.global.gen.global.Tree">safeREF</a><span class="delimiter">(</span><a href="#887525" title="CleanUp.this.global.Symbol">staticFieldSym</a><span class="delimiter">)</span><span class="delimiter">)</span>

        <a href="#513438" title="CleanUp.this.CleanUpTransformer" class="keyword">super</a>.<a href="../ast/Trees.scala.html#560339" title="(tree: CleanUp.this.global.Tree)CleanUp.this.global.Tree">transform</a><span class="delimiter">(</span><a href="#887526" title="CleanUp.this.global.analyzer.global.Tree">ntree</a><span class="delimiter">)</span>

      <span class="comment">// This transform replaces Array(Predef.wrapArray(Array(...)), &lt;manifest&gt;)</span>
      <span class="comment">// with just Array(...)</span>
      <span class="keyword">case</span> <span title="CleanUp.this.global.Tree">Apply</span><span class="delimiter">(</span><a title="CleanUp.this.global.Tree" id="887569">appMeth</a>, <a href="../../../collection/generic/GenSeqFactory.scala.html#48862" title="(x: List[CleanUp.this.global.Tree])Some[List[CleanUp.this.global.Tree]]">List</a><span class="delimiter">(</span>Apply<span class="delimiter">(</span><a title="CleanUp.this.global.Tree" id="887584">wrapRefArrayMeth</a>, <a href="../../../collection/generic/GenSeqFactory.scala.html#48862" title="(x: List[CleanUp.this.global.Tree])Some[List[CleanUp.this.global.Tree]]">List</a><span class="delimiter">(</span><a title="CleanUp.this.global.Tree" id="887597">array</a><span class="delimiter">)</span><span class="delimiter">)</span>, _<span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">if</span> <span class="delimiter">(</span><a href="#887584" title="CleanUp.this.global.Tree">wrapRefArrayMeth</a>.<a href="../../../reflect/generic/Trees.scala.html#441032" title="=&gt; CleanUp.this.global.Symbol">symbol</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../symtab/Definitions.scala.html#508023" title="=&gt; CleanUp.this.global.Symbol">Predef_wrapRefArray</a> <a href="../../../Boolean.scala.html#55580" title="(x: Boolean)Boolean">&amp;&amp;</a>
          <a href="#887569" title="CleanUp.this.global.Tree">appMeth</a>.<a href="../../../reflect/generic/Trees.scala.html#441032" title="=&gt; CleanUp.this.global.Symbol">symbol</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../symtab/Definitions.scala.html#508098" title="=&gt; CleanUp.this.global.Symbol">ArrayModule_overloadedApply</a>.<a href="../symtab/Symbols.scala.html#509301" title="(cond: CleanUp.this.global.Symbol =&gt; Boolean)CleanUp.this.global.Symbol">suchThat</a> <span class="delimiter">{</span>
            <a href="#887610" title="CleanUp.this.global.Symbol">_</a>.<a href="../symtab/Symbols.scala.html#509270" title="=&gt; CleanUp.this.global.Type">tpe</a>.<a href="../symtab/Types.scala.html#507173" title="=&gt; CleanUp.this.global.Type">resultType</a>.<a href="../symtab/Types.scala.html#507189" title="=&gt; CleanUp.this.global.Type">dealias</a>.<a href="../symtab/Types.scala.html#507159" title="=&gt; CleanUp.this.global.Symbol">typeSymbol</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../symtab/Definitions.scala.html#507925" title="=&gt; CleanUp.this.global.Symbol">ObjectClass</a>
          <span class="delimiter">}</span><span class="delimiter">)</span> =&gt;
        <a href="#513438" title="CleanUp.this.CleanUpTransformer" class="keyword">super</a>.<a href="../ast/Trees.scala.html#560339" title="(tree: CleanUp.this.global.Tree)CleanUp.this.global.Tree">transform</a><span class="delimiter">(</span><a href="#887597" title="CleanUp.this.global.Tree">array</a><span class="delimiter">)</span>

      <span class="keyword">case</span> <span title="CleanUp.this.global.Tree">_</span> =&gt;
        <a href="#513438" title="CleanUp.this.CleanUpTransformer" class="keyword">super</a>.<a href="../ast/Trees.scala.html#560339" title="(tree: CleanUp.this.global.Tree)CleanUp.this.global.Tree">transform</a><span class="delimiter">(</span><a href="#885167" title="CleanUp.this.global.Tree">tree</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="comment">/* Returns the symbol and the tree for the symbol field interning a reference to a symbol 'synmname'.
     * If it doesn't exist, i.e. the symbol is encountered the first time,
     * it creates a new static field definition and initialization and returns it.
     */</span>
    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(pos: CleanUp.this.global.Position, symname: String, rhs: CleanUp.this.global.Tree, tree: CleanUp.this.global.Tree)CleanUp.this.global.Symbol" id="885028">getSymbolStaticField</a><span class="delimiter">(</span><a title="CleanUp.this.global.Position" id="887560">pos</a>: <a href="../util/Position.scala.html#42664" title="CleanUp.this.global.Position">Position</a>, <a title="String" id="887561">symname</a>: <span title="String">String</span>, <a title="CleanUp.this.global.Tree" id="887562">rhs</a>: <a href="../../../reflect/generic/Trees.scala.html#434028" title="CleanUp.this.global.Tree">Tree</a>, <a title="CleanUp.this.global.Tree" id="887563">tree</a>: <a href="../../../reflect/generic/Trees.scala.html#434028" title="CleanUp.this.global.Tree">Tree</a><span class="delimiter">)</span>: <a href="../symtab/Symbols.scala.html#478659" title="CleanUp.this.global.Symbol">Symbol</a> =
      <a href="#885012" title="=&gt; scala.collection.mutable.Map[String,CleanUp.this.global.Symbol]">symbolsStoredAsStatic</a>.<a href="../../../collection/mutable/MapLike.scala.html#73294" title="(key: String, op: =&gt; CleanUp.this.global.Symbol)CleanUp.this.global.Symbol">getOrElseUpdate</a><span class="delimiter">(</span><a href="#887561" title="String">symname</a>, <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="CleanUp.this.global.analyzer.Typer" id="887626">theTyper</a> = <a href="../Global.scala.html#478336" title="object CleanUp.this.global.typer">typer</a>.<a href="../typechecker/Typers.scala.html#507767" title="(tree: CleanUp.this.global.analyzer.global.Tree, owner: CleanUp.this.global.analyzer.global.Symbol)CleanUp.this.global.analyzer.Typer">atOwner</a><span class="delimiter">(</span><a href="#887563" title="CleanUp.this.global.Tree">tree</a>, <a href="../ast/Trees.scala.html#560337" title="=&gt; CleanUp.this.global.Symbol">currentClass</a><span class="delimiter">)</span>

        <span class="comment">// create a symbol for the static field</span>
        <span class="keyword">val</span> <a title="CleanUp.this.global.TermSymbol" id="887627">stfieldSym</a> = <a href="../ast/Trees.scala.html#560337" title="=&gt; CleanUp.this.global.Symbol">currentClass</a>.<a href="../symtab/Symbols.scala.html#509127" title="(pos: CleanUp.this.global.Position, name: CleanUp.this.global.TermName)CleanUp.this.global.TermSymbol">newVariable</a><span class="delimiter">(</span><a href="#887560" title="CleanUp.this.global.Position">pos</a>, <a href="#885014" title="(prefix: String)CleanUp.this.global.TermName">mkTerm</a><span class="delimiter">(</span><span title="java.lang.String(&quot;symbol$&quot;)" class="string">&quot;symbol$&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
          .<a href="../symtab/Symbols.scala.html#509261" title="(mask: Long)CleanUp.this.global.TermSymbol">setFlag</a><span class="delimiter">(</span>PRIVATE | STATIC | SYNTHETIC <span title="Long(10485796L)">|</span> FINAL<span class="delimiter">)</span>
          .<a href="../symtab/Symbols.scala.html#509274" title="(info: CleanUp.this.global.Type)CleanUp.this.global.TermSymbol">setInfo</a><span class="delimiter">(</span><a href="../symtab/Definitions.scala.html#508159" title="=&gt; CleanUp.this.global.Type">symbolType</a><span class="delimiter">)</span>
        <a href="../ast/Trees.scala.html#560337" title="=&gt; CleanUp.this.global.Symbol">currentClass</a>.<a href="../symtab/Symbols.scala.html#509272" title="=&gt; CleanUp.this.global.Type">info</a>.<a href="../symtab/Types.scala.html#507192" title="=&gt; CleanUp.this.global.Scope">decls</a> <a href="../symtab/Scopes.scala.html#514360" title="(sym: CleanUp.this.global.Symbol)CleanUp.this.global.Symbol">enter</a> <a href="#887627" title="CleanUp.this.global.TermSymbol">stfieldSym</a>

        <span class="comment">// create field definition and initialization</span>
        <span class="keyword">val</span> <a title="CleanUp.this.global.analyzer.global.Tree" id="887628">stfieldDef</a> = <a href="#887626" title="CleanUp.this.global.analyzer.Typer">theTyper</a>.<a href="../typechecker/Typers.scala.html#507768" title="(tree: CleanUp.this.global.analyzer.global.Tree)CleanUp.this.global.analyzer.global.Tree">typed</a> <span class="delimiter">{</span> <a href="../ast/Trees.scala.html#479182" title="(pos: CleanUp.this.global.Position)(tree: CleanUp.this.global.ValDef)CleanUp.this.global.ValDef">atPos</a><span class="delimiter">(</span><a href="#887560" title="CleanUp.this.global.Position">pos</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="../ast/TreeDSL.scala.html#515227" title="(sym: CleanUp.this.global.Symbol)CleanUp.this.CODE.ValSymStart">VAL</a><span class="delimiter">(</span><a href="#887627" title="CleanUp.this.global.TermSymbol">stfieldSym</a><span class="delimiter">)</span> <a href="../ast/TreeDSL.scala.html#548250" title="(rhs: CleanUp.this.global.Tree)CleanUp.this.global.ValDef">===</a> <a href="#887562" title="CleanUp.this.global.Tree">rhs</a><span class="delimiter">)</span> <span class="delimiter">}</span>
        <span class="keyword">val</span> <a title="CleanUp.this.global.analyzer.global.Tree" id="887629">stfieldInit</a> = <a href="#887626" title="CleanUp.this.global.analyzer.Typer">theTyper</a>.<a href="../typechecker/Typers.scala.html#507768" title="(tree: CleanUp.this.global.analyzer.global.Tree)CleanUp.this.global.analyzer.global.Tree">typed</a> <span class="delimiter">{</span> <a href="../ast/Trees.scala.html#479182" title="(pos: CleanUp.this.global.Position)(tree: CleanUp.this.global.Assign)CleanUp.this.global.Assign">atPos</a><span class="delimiter">(</span><a href="#887560" title="CleanUp.this.global.Position">pos</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#885015" title="(sym: CleanUp.this.global.Symbol)CleanUp.this.global.gen.global.Tree">safeREF</a><a href="../ast/TreeDSL.scala.html#515248" title="implicit scala.tools.nsc.ast.TreeDSL.CODE.mkTreeMethods : (target: CleanUp.this.global.Tree)CleanUp.this.CODE.TreeMethods" class="delimiter">(</a><a href="#887627" title="CleanUp.this.global.TermSymbol">stfieldSym</a><span class="delimiter">)</span> <a href="../ast/TreeDSL.scala.html#547507" title="(rhs: CleanUp.this.global.Tree)CleanUp.this.global.Assign">===</a> <a href="#887562" title="CleanUp.this.global.Tree">rhs</a><span class="delimiter">)</span> <span class="delimiter">}</span>

        <span class="comment">// add field definition to new defs</span>
        <a href="#885008" title="=&gt; scala.collection.mutable.Buffer[CleanUp.this.global.Tree]">newStaticMembers</a> <a href="../../../collection/mutable/BufferLike.scala.html#61817" title="(elems: CleanUp.this.global.Tree*)Unit">append</a> <a href="#887628" title="CleanUp.this.global.analyzer.global.Tree">stfieldDef</a>
        <a href="#885010" title="=&gt; scala.collection.mutable.Buffer[CleanUp.this.global.Tree]">newStaticInits</a> <a href="../../../collection/mutable/BufferLike.scala.html#61817" title="(elems: CleanUp.this.global.Tree*)Unit">append</a> <a href="#887629" title="CleanUp.this.global.analyzer.global.Tree">stfieldInit</a>

        <a href="#887627" title="CleanUp.this.global.TermSymbol">stfieldSym</a>
      <span class="delimiter">}</span><span class="delimiter">)</span>

    <span class="comment">/* finds the static ctor DefDef tree within the template if it exists. */</span>
    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(template: CleanUp.this.global.Template)Option[CleanUp.this.global.Tree]" id="885029">findStaticCtor</a><span class="delimiter">(</span><a title="CleanUp.this.global.Template" id="887691">template</a>: <a href="../../../reflect/generic/Trees.scala.html#434067" title="CleanUp.this.global.Template">Template</a><span class="delimiter">)</span>: <a href="../../../Option.scala.html#560" title="Option[CleanUp.this.global.Tree]">Option</a><span class="delimiter">[</span>Tree<span class="delimiter">]</span> =
      <a href="#887691" title="CleanUp.this.global.Template">template</a>.<a href="../../../reflect/generic/Trees.scala.html#441752" title="=&gt; List[CleanUp.this.global.Tree]">body</a> <a href="../../../collection/LinearSeqOptimized.scala.html#71038" title="(p: CleanUp.this.global.Tree =&gt; Boolean)Option[CleanUp.this.global.Tree]">find</a> <a href="#887699" title="Boolean" class="delimiter">{</a>
        <span class="keyword">case</span> <a title="Boolean" id="887700">defdef</a> @ DefDef<span class="delimiter">(</span>_, <a href="../symtab/StdNames.scala.html#479055" title="object CleanUp.this.global.nme">nme</a>.<a href="../symtab/StdNames.scala.html#516546" title="=&gt; CleanUp.this.global.nme.NameType">CONSTRUCTOR</a>, _, _, _, _<span class="delimiter">)</span> =&gt; <a href="#887700" title="CleanUp.this.global.DefDef">defdef</a>.<a href="../../../reflect/generic/Trees.scala.html#441600" title="=&gt; CleanUp.this.global.Symbol">symbol</a>.<a href="../../../reflect/generic/HasFlags.scala.html#435329" title="=&gt; Boolean">hasStaticFlag</a>
        <span class="keyword">case</span> <span title="Boolean(false)">_</span> =&gt; <span title="Boolean(false)" class="keyword">false</span>
      <span class="delimiter">}</span>

    <span class="comment">/* changes the template for the class so that it contains a static constructor with symbol fields inits,
     * augments an existing static ctor if one already existed.
     */</span>
    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(template: CleanUp.this.global.Template)CleanUp.this.global.Template" id="885030">addStaticInits</a><span class="delimiter">(</span><a title="CleanUp.this.global.Template" id="887257">template</a>: <a href="../../../reflect/generic/Trees.scala.html#434067" title="CleanUp.this.global.Template">Template</a><span class="delimiter">)</span>: <a href="../../../reflect/generic/Trees.scala.html#434067" title="CleanUp.this.global.Template">Template</a> =
      <span title="CleanUp.this.global.Template" class="keyword">if</span> <span class="delimiter">(</span><a href="#885010" title="=&gt; scala.collection.mutable.Buffer[CleanUp.this.global.Tree]">newStaticInits</a>.<a href="../../../collection/IterableLike.scala.html#53862" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span>
        <a href="#887257" title="CleanUp.this.global.Template">template</a>
      <span class="keyword">else</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="CleanUp.this.global.analyzer.global.Tree" id="887709">newCtor</a> = <a href="#885029" title="(template: CleanUp.this.global.Template)Option[CleanUp.this.global.Tree]">findStaticCtor</a><span class="delimiter">(</span><a href="#887257" title="CleanUp.this.global.Template">template</a><span class="delimiter">)</span> <span title="CleanUp.this.global.analyzer.global.Tree" class="keyword">match</span> <span class="delimiter">{</span>
          <span class="comment">// in case there already were static ctors - augment existing ones</span>
          <span class="comment">// currently, however, static ctors aren't being generated anywhere else</span>
          <span class="keyword">case</span> <span title="CleanUp.this.global.DefDef">Some</span><span class="delimiter">(</span><a title="CleanUp.this.global.DefDef" id="887711">ctor</a> @ DefDef<span class="delimiter">(</span><a title="CleanUp.this.global.Modifiers" id="887720">mods</a>, <a title="CleanUp.this.global.TermName" id="887721">name</a>, <a title="List[CleanUp.this.global.TypeDef]" id="887722">tparams</a>, <a title="List[List[CleanUp.this.global.ValDef]]" id="887723">vparamss</a>, <a title="CleanUp.this.global.Tree" id="887724">tpt</a>, <a title="CleanUp.this.global.Tree" id="887725">rhs</a><span class="delimiter">)</span><span class="delimiter">)</span> =&gt;
            <span class="comment">// modify existing static ctor</span>
            <span class="keyword">val</span> <a title="CleanUp.this.global.Block" id="887726">newBlock</a> = <a href="#887725" title="CleanUp.this.global.Tree">rhs</a> <span title="CleanUp.this.global.Block" class="keyword">match</span> <span class="delimiter">{</span>
              <span class="keyword">case</span> <a title="CleanUp.this.global.Block" id="887727">block</a> @ Block<span class="delimiter">(</span><a title="List[CleanUp.this.global.Tree]" id="887733">stats</a>, <a title="CleanUp.this.global.Tree" id="887734">expr</a><span class="delimiter">)</span> =&gt;
                <span class="comment">// need to add inits to existing block</span>
                <a href="../ast/Trees.scala.html#560331" title="=&gt; CleanUp.this.global.TreeCopier">treeCopy</a>.<a href="../ast/Trees.scala.html#560242" title="(tree: CleanUp.this.global.Tree, stats: List[CleanUp.this.global.Tree], expr: CleanUp.this.global.Tree)CleanUp.this.global.Block">Block</a><span class="delimiter">(</span><a href="#887727" title="CleanUp.this.global.Block">block</a>, <a href="#885010" title="=&gt; scala.collection.mutable.Buffer[CleanUp.this.global.Tree]">newStaticInits</a>.<a href="../../../collection/TraversableOnce.scala.html#53691" title="=&gt; List[CleanUp.this.global.Tree]">toList</a> <a href="../../../collection/immutable/List.scala.html#49143" title="(prefix: List[CleanUp.this.global.Tree])List[CleanUp.this.global.Tree]">:::</a> <a href="#887733" title="List[CleanUp.this.global.Tree]">stats</a>, <a href="#887734" title="CleanUp.this.global.Tree">expr</a><span class="delimiter">)</span>
              <span class="keyword">case</span> <a title="CleanUp.this.global.Block" id="887746">term</a>: <a href="../../../reflect/generic/Trees.scala.html#434033" title="CleanUp.this.global.TermTree">TermTree</a> =&gt;
                <span class="comment">// need to create a new block with inits and the old term</span>
                <a href="../ast/Trees.scala.html#560331" title="=&gt; CleanUp.this.global.TreeCopier">treeCopy</a>.<a href="../ast/Trees.scala.html#560242" title="(tree: CleanUp.this.global.Tree, stats: List[CleanUp.this.global.Tree], expr: CleanUp.this.global.Tree)CleanUp.this.global.Block">Block</a><span class="delimiter">(</span><a href="#887746" title="CleanUp.this.global.TermTree">term</a>, <a href="#885010" title="=&gt; scala.collection.mutable.Buffer[CleanUp.this.global.Tree]">newStaticInits</a>.<a href="../../../collection/TraversableOnce.scala.html#53691" title="=&gt; List[CleanUp.this.global.Tree]">toList</a>, <a href="#887746" title="CleanUp.this.global.TermTree">term</a><span class="delimiter">)</span>
            <span class="delimiter">}</span>
            <a href="../ast/Trees.scala.html#560331" title="=&gt; CleanUp.this.global.TreeCopier">treeCopy</a>.<a href="../ast/Trees.scala.html#560236" title="(tree: CleanUp.this.global.Tree, mods: CleanUp.this.global.Modifiers, name: CleanUp.this.global.Name, tparams: List[CleanUp.this.global.TypeDef], vparamss: List[List[CleanUp.this.global.ValDef]], tpt: CleanUp.this.global.Tree, rhs: CleanUp.this.global.Tree)CleanUp.this.global.DefDef">DefDef</a><span class="delimiter">(</span><a href="#887711" title="CleanUp.this.global.DefDef">ctor</a>, <a href="#887720" title="CleanUp.this.global.Modifiers">mods</a>, <a href="#887721" title="CleanUp.this.global.TermName">name</a>, <a href="#887722" title="List[CleanUp.this.global.TypeDef]">tparams</a>, <a href="#887723" title="List[List[CleanUp.this.global.ValDef]]">vparamss</a>, <a href="#887724" title="CleanUp.this.global.Tree">tpt</a>, <a href="#887726" title="CleanUp.this.global.Block">newBlock</a><span class="delimiter">)</span>
          <span class="keyword">case</span> <a href="../../../Option.scala.html#1737" title="CleanUp.this.global.analyzer.global.Tree">None</a> =&gt;
            <span class="comment">// create new static ctor</span>
            <span class="keyword">val</span> <a title="CleanUp.this.global.MethodSymbol" id="887754">staticCtorSym</a> = <a href="../ast/Trees.scala.html#560337" title="=&gt; CleanUp.this.global.Symbol">currentClass</a>.<a href="../symtab/Symbols.scala.html#509133" title="(pos: CleanUp.this.global.Position)CleanUp.this.global.MethodSymbol">newConstructor</a><span class="delimiter">(</span><a href="#887257" title="CleanUp.this.global.Template">template</a>.<a href="../../../reflect/generic/Trees.scala.html#441024" title="=&gt; CleanUp.this.global.Position">pos</a><span class="delimiter">)</span>
                                  .<a href="../symtab/Symbols.scala.html#509261" title="(mask: Long)CleanUp.this.global.MethodSymbol">setFlag</a><span class="delimiter">(</span><span title="Long(8388608L)">STATIC</span><span class="delimiter">)</span>
                                  .<a href="../symtab/Symbols.scala.html#509274" title="(info: CleanUp.this.global.Type)CleanUp.this.global.MethodSymbol">setInfo</a><span class="delimiter">(</span><a href="../symtab/Definitions.scala.html#508423" title="=&gt; CleanUp.this.global.Symbol">UnitClass</a>.<a href="../symtab/Symbols.scala.html#509270" title="=&gt; CleanUp.this.global.Type">tpe</a><span class="delimiter">)</span>
            <span class="keyword">val</span> <a title="CleanUp.this.global.Block" id="887755">rhs</a> = <a href="../../../reflect/generic/Trees.scala.html#443384" title="(stats: List[CleanUp.this.global.Tree], expr: CleanUp.this.global.Tree)CleanUp.this.global.Block">Block</a><span class="delimiter">(</span><a href="#885010" title="=&gt; scala.collection.mutable.Buffer[CleanUp.this.global.Tree]">newStaticInits</a>.<a href="../../../collection/TraversableOnce.scala.html#53691" title="=&gt; List[CleanUp.this.global.Tree]">toList</a>, <a href="../../../reflect/generic/Trees.scala.html#434144" title="(value: Any)CleanUp.this.global.Literal">Literal</a><span class="delimiter">(</span><span title="Unit" class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
            <span class="keyword">val</span> <a title="CleanUp.this.global.DefDef" id="887756">staticCtorTree</a> = <a href="../ast/Trees.scala.html#479132" title="(sym: CleanUp.this.global.Symbol, rhs: CleanUp.this.global.Tree)CleanUp.this.global.DefDef">DefDef</a><span class="delimiter">(</span><a href="#887754" title="CleanUp.this.global.MethodSymbol">staticCtorSym</a>, <a href="#887755" title="CleanUp.this.global.Block">rhs</a><span class="delimiter">)</span>
            <a href="#885017" title="=&gt; CleanUp.this.global.analyzer.Typer">localTyper</a>.<a href="../typechecker/Typers.scala.html#507768" title="(tree: CleanUp.this.global.analyzer.global.Tree)CleanUp.this.global.analyzer.global.Tree">typed</a> <span class="delimiter">{</span> <a href="../ast/Trees.scala.html#479182" title="(pos: CleanUp.this.global.Position)(tree: CleanUp.this.global.DefDef)CleanUp.this.global.DefDef">atPos</a><span class="delimiter">(</span><a href="#887257" title="CleanUp.this.global.Template">template</a>.<a href="../../../reflect/generic/Trees.scala.html#441024" title="=&gt; CleanUp.this.global.Position">pos</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#887756" title="CleanUp.this.global.DefDef">staticCtorTree</a><span class="delimiter">)</span> <span class="delimiter">}</span>
        <span class="delimiter">}</span>
        <a href="../ast/Trees.scala.html#560331" title="=&gt; CleanUp.this.global.TreeCopier">treeCopy</a>.<a href="../ast/Trees.scala.html#560241" title="(tree: CleanUp.this.global.Tree, parents: List[CleanUp.this.global.Tree], self: CleanUp.this.global.ValDef, body: List[CleanUp.this.global.Tree])CleanUp.this.global.Template">Template</a><span class="delimiter">(</span><a href="#887257" title="CleanUp.this.global.Template">template</a>, <a href="#887257" title="CleanUp.this.global.Template">template</a>.<a href="../../../reflect/generic/Trees.scala.html#441748" title="=&gt; List[CleanUp.this.global.Tree]">parents</a>, <a href="#887257" title="CleanUp.this.global.Template">template</a>.<a href="../../../reflect/generic/Trees.scala.html#441750" title="=&gt; CleanUp.this.global.ValDef">self</a>, <a href="#887709" title="CleanUp.this.global.analyzer.global.Tree">newCtor</a> <a href="../../../collection/immutable/List.scala.html#49140" title="(x: CleanUp.this.global.Tree)List[CleanUp.this.global.Tree]">::</a> <a href="#887257" title="CleanUp.this.global.Template">template</a>.<a href="../../../reflect/generic/Trees.scala.html#441752" title="=&gt; List[CleanUp.this.global.Tree]">body</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>

  <span class="delimiter">}</span> <span class="comment">// CleanUpTransformer</span>

<span class="delimiter">}</span>

        </pre>
    </body>
</html>