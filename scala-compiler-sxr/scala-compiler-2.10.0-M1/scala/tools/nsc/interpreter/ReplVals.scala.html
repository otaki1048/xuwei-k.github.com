<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>scala/tools/nsc/interpreter/ReplVals.scala</title>
        <script type="text/javascript" src="../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
/* NSC -- new Scala compiler
 * Copyright 2005-2011 LAMP/EPFL
 * @author Paul Phillips
 */

<span class="keyword">package</span> scala.tools.nsc
<span class="keyword">package</span> interpreter

/** A class which the repl utilizes to expose predefined objects.
 *  The base implementation is empty; the standard repl implementation
 *  is StdReplVals.
 */
<span class="keyword">abstract</span> <span class="keyword">class</span> <a title="class ReplVals extends Object with ScalaObject" id="24279">ReplVals</a> <a href="#24279" title="ScalaObject" class="delimiter">{</a> <span class="delimiter">}</span>

<span class="keyword">class</span> <a title="class StdReplVals extends scala.tools.nsc.interpreter.ReplVals with ScalaObject" id="22734">StdReplVals</a><a href="#22734" title="ScalaObject" class="delimiter">(</a><span class="keyword">final</span> <span class="keyword">val</span> <a title="scala.tools.nsc.interpreter.ILoop" id="459611">r</a>: <a href="ILoop.scala.html#24159" title="scala.tools.nsc.interpreter.ILoop">ILoop</a><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#24279" title="scala.tools.nsc.interpreter.ReplVals">ReplVals</a> <span class="delimiter">{</span>
  <span class="keyword">final</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="scala.tools.nsc.interpreter.ILoop" id="459581">repl</a>                     = <a href="#459611" title="=&gt; scala.tools.nsc.interpreter.ILoop">r</a>
  <span class="keyword">final</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="scala.tools.nsc.interpreter.IMain" id="459583">intp</a>                     = <a href="#459611" title="=&gt; scala.tools.nsc.interpreter.ILoop">r</a>.<a href="ILoop.scala.html#250008" title="=&gt; scala.tools.nsc.interpreter.IMain">intp</a>
  <span class="keyword">final</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="scala.tools.nsc.interpreter.Power[scala.tools.nsc.interpreter.StdReplVals]" id="459585">power</a>                    = <a href="#459611" title="=&gt; scala.tools.nsc.interpreter.ILoop">r</a>.<a href="ILoop.scala.html#250013" title="=&gt; scala.tools.nsc.interpreter.Power[scala.tools.nsc.interpreter.StdReplVals]">power</a>
  <span class="keyword">final</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="scala.tools.nsc.interpreter.InteractiveReader" id="459587">reader</a>                   = <a href="#459611" title="=&gt; scala.tools.nsc.interpreter.ILoop">r</a>.<a href="ILoop.scala.html#250002" title="=&gt; scala.tools.nsc.interpreter.InteractiveReader">in</a>
  <span class="keyword">final</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="scala.tools.nsc.interpreter.StdReplVals" id="459589">vals</a>                     = <a href="#22734" title="scala.tools.nsc.interpreter.StdReplVals" class="keyword">this</a>
  <span class="keyword">final</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="StdReplVals.this.intp.global.type" id="459591">global</a>: intp.global.<span class="keyword">type</span> = <a href="#459582" title="=&gt; scala.tools.nsc.interpreter.IMain">intp</a>.<a href="IMain.scala.html#249712" title="=&gt; scala.tools.nsc.Global">global</a>
  <span class="keyword">final</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="scala.tools.nsc.interpreter.ISettings" id="459593">isettings</a>                = <a href="#459582" title="=&gt; scala.tools.nsc.interpreter.IMain">intp</a>.<a href="IMain.scala.html#249749" title="=&gt; scala.tools.nsc.interpreter.ISettings">isettings</a>
  <span class="keyword">final</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="scala.tools.nsc.interpreter.Completion" id="459595">completion</a>               = <a href="#459586" title="=&gt; scala.tools.nsc.interpreter.InteractiveReader">reader</a>.<a href="InteractiveReader.scala.html#459485" title="=&gt; scala.tools.nsc.interpreter.Completion">completion</a>
  <span class="keyword">final</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="scala.tools.nsc.interpreter.session.History" id="459597">history</a>                  = <a href="#459586" title="=&gt; scala.tools.nsc.interpreter.InteractiveReader">reader</a>.<a href="InteractiveReader.scala.html#459484" title="=&gt; scala.tools.nsc.interpreter.session.History">history</a>
  <span class="keyword">final</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="scala.tools.nsc.interpreter.Phased" id="459599">phased</a>                   = <a href="#459584" title="=&gt; scala.tools.nsc.interpreter.Power[scala.tools.nsc.interpreter.StdReplVals]">power</a>.<a href="Power.scala.html#459559" title="=&gt; scala.tools.nsc.interpreter.Phased">phased</a>
  <span class="keyword">final</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="analyzer extends Object with scala.tools.nsc.typechecker.Analyzer" id="459601">analyzer</a>                 = <a href="#459590" title="=&gt; StdReplVals.this.intp.global.type">global</a>.<a href="../Global.scala.html#182936" title="=&gt; Object with scala.tools.nsc.typechecker.Analyzer{val global: StdReplVals.this.global.type}">analyzer</a>

  <span class="keyword">final</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="treedsl extends Object with scala.tools.nsc.ast.TreeDSL" id="459603">treedsl</a> = <a href="#505917" title="Object with scala.tools.nsc.ast.TreeDSL {}" class="keyword">new</a> <a title="anonymous class $anon extends Object with scala.tools.nsc.ast.TreeDSL" id="505917" class="delimiter">{</a> <span class="keyword">val</span> <a title="StdReplVals.this.intp.global.type" id="505925">global</a>: intp.global.<span class="keyword">type</span> = <a href="#459582" title="=&gt; scala.tools.nsc.interpreter.IMain">intp</a>.<a href="IMain.scala.html#249712" title="=&gt; scala.tools.nsc.Global">global</a> <span class="delimiter">}</span> <span class="keyword">with</span> ast.<a href="../ast/TreeDSL.scala.html#13777" title="scala.tools.nsc.ast.TreeDSL">TreeDSL</a> <span class="delimiter">{</span> <span class="delimiter">}</span>
  <span class="keyword">final</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="StdReplVals.this.analyzer.Typer" id="459605">typer</a> = <a href="#459600" title="=&gt; Object with scala.tools.nsc.typechecker.Analyzer{val global: StdReplVals.this.global.type}">analyzer</a>.<a href="../typechecker/Typers.scala.html#184057" title="(context: StdReplVals.this.analyzer.Context)StdReplVals.this.analyzer.Typer">newTyper</a><span class="delimiter">(</span>
    <a href="#459600" title="=&gt; Object with scala.tools.nsc.typechecker.Analyzer{val global: StdReplVals.this.global.type}">analyzer</a>.<a href="../typechecker/Contexts.scala.html#183952" title="(unit: StdReplVals.this.analyzer.global.CompilationUnit)StdReplVals.this.analyzer.Context">rootContext</a><span class="delimiter">(</span>
      <a href="#459584" title="=&gt; scala.tools.nsc.interpreter.Power[scala.tools.nsc.interpreter.StdReplVals]">power</a>.<a href="Power.scala.html#459563" title="(code: String)StdReplVals.this.power.intp.global.CompilationUnit">unit</a><span class="delimiter">(</span><span title="String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="StdReplVals.this.analyzer.global.CompilationUnit" class="delimiter">[</span>analyzer.global.<a href="../CompilationUnits.scala.html#183079" title="StdReplVals.this.analyzer.global.CompilationUnit">CompilationUnit</a><span class="delimiter">]</span>
    <span class="delimiter">)</span>
  <span class="delimiter">)</span>

  <span class="keyword">final</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="replImplicits extends Object with StdReplVals.this.power.Implicits2" id="459607">replImplicits</a> = <a href="#505942" title="Object with StdReplVals.this.power.Implicits2 {implicit def mkManifestToType(sym: StdReplVals.this.intp.global.Symbol): Object with ScalaObject{def apply[M](implicit m1: Manifest[M]): StdReplVals.this.global.Type; def apply[M1,M2](implicit m1: Manifest[M1],implicit m2: Manifest[M2]): StdReplVals.this.global.Type}}" class="keyword">new</a> <a title="anonymous class $anon extends Object with StdReplVals.this.power.Implicits2" id="505942">power</a>.<a href="Power.scala.html#459555" title="StdReplVals.this.power.Implicits2">Implicits2</a> <span class="delimiter">{</span>
    <span class="keyword">import</span> <a href="#459582" title="=&gt; scala.tools.nsc.interpreter.IMain">intp</a>.<a href="IMain.scala.html#249712" title="=&gt; scala.tools.nsc.Global">global</a>._

    <span class="keyword">private</span> <span class="keyword">val</span> <a title="StdReplVals.this.global.Symbol =&gt; Object with ScalaObject{def apply[M](implicit m1: Manifest[M]): StdReplVals.this.global.Type; def apply[M1,M2](implicit m1: Manifest[M1],implicit m2: Manifest[M2]): StdReplVals.this.global.Type}" id="505945">manifestFn</a> = <a href="#24280" title="object scala.tools.nsc.interpreter.ReplVals">ReplVals</a>.<a href="#505952" title="[T &lt;: scala.tools.nsc.Global](global: T)global.Symbol =&gt; Object with ScalaObject{def apply[M](implicit m1: Manifest[M]): global.Type; def apply[M1,M2](implicit m1: Manifest[M1],implicit m2: Manifest[M2]): global.Type}">mkManifestToType</a><span title="(global: StdReplVals.this.intp.global.type)global.Symbol =&gt; Object with ScalaObject{def apply[M](implicit m1: Manifest[M]): global.Type; def apply[M1,M2](implicit m1: Manifest[M1],implicit m2: Manifest[M2]): global.Type}" class="delimiter">[</span>intp.global.<span class="keyword">type</span><span class="delimiter">]</span><span class="delimiter">(</span><a href="#459590" title="=&gt; StdReplVals.this.intp.global.type">global</a><span class="delimiter">)</span>
    <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="implicit scala.tools.nsc.interpreter.StdReplVals.$anon.mkManifestToType : (sym: StdReplVals.this.intp.global.Symbol)Object with ScalaObject{def apply[M](implicit m1: Manifest[M]): StdReplVals.this.global.Type; def apply[M1,M2](implicit m1: Manifest[M1],implicit m2: Manifest[M2]): StdReplVals.this.global.Type}" id="505947">mkManifestToType</a><span class="delimiter">(</span><a title="StdReplVals.this.intp.global.Symbol" id="505948">sym</a>: <a href="../../../reflect/internal/Symbols.scala.html#40001" title="StdReplVals.this.intp.global.Symbol">Symbol</a><span class="delimiter">)</span> = <a href="#505945" title="(v1: StdReplVals.this.global.Symbol)Object with ScalaObject{def apply[M](implicit m1: Manifest[M]): StdReplVals.this.global.Type; def apply[M1,M2](implicit m1: Manifest[M1],implicit m2: Manifest[M2]): StdReplVals.this.global.Type}">manifestFn</a><span class="delimiter">(</span><a href="#505948" title="StdReplVals.this.intp.global.Symbol">sym</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="[T &lt;: StdReplVals.this.analyzer.global.Tree](tree: T)T" id="459608">typed</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: StdReplVals.this.analyzer.global.Tree" id="459610">T</a> &lt;: analyzer.global.Tree<span class="delimiter">]</span><span class="delimiter">(</span><a title="T" id="506467">tree</a>: <a href="#459610" title="T">T</a><span class="delimiter">)</span>: <a href="#459610" title="T">T</a> = <a href="#459604" title="=&gt; StdReplVals.this.analyzer.Typer">typer</a>.<a href="../typechecker/Typers.scala.html#184436" title="(tree: StdReplVals.this.analyzer.global.Tree)StdReplVals.this.analyzer.global.Tree">typed</a><span class="delimiter">(</span><a href="#506467" title="T">tree</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="T" class="delimiter">[</span><a href="#459610" title="T">T</a><span class="delimiter">]</span>
<span class="delimiter">}</span>

<span class="keyword">object</span> <a title="object scala.tools.nsc.interpreter.ReplVals" id="24280">ReplVals</a> <span title="ScalaObject" class="delimiter">{</span>
  /** Latest attempt to work around the challenge of foo.global.Type
   *  not being seen as the same type as bar.global.Type even though
   *  the globals are the same.  Dependent method types to the rescue.
   */
  <span class="keyword">def</span> <a title="[T &lt;: scala.tools.nsc.Global](global: T)global.Symbol =&gt; Object with ScalaObject{def apply[M](implicit m1: Manifest[M]): global.Type; def apply[M1,M2](implicit m1: Manifest[M1],implicit m2: Manifest[M2]): global.Type}" id="505952">mkManifestToType</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: scala.tools.nsc.Global" id="505954">T</a> &lt;: Global<span class="delimiter">]</span><span class="delimiter">(</span><a title="T" id="505955">global</a>: <a href="#505954" title="T">T</a><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span class="keyword">import</span> <a href="#505955" title="T">global</a>._
    <span class="keyword">import</span> <a href="../../../reflect/internal/Definitions.scala.html#40473" title="object global.definitions">definitions</a>._
    
    /** We can't use definitions.manifestToType directly because we're passing
     *  it to map and the compiler refuses to perform eta expansion on a method
     *  with a dependent return type.  (Can this be relaxed?) To get around this
     *  I have this forwarder which widens the type and then cast the result back
     *  to the dependent type.
     */
    <span class="keyword">def</span> <a title="(m: OptManifest[_])scala.tools.nsc.Global#Type" id="505960">manifestToType</a><span class="delimiter">(</span><a title="OptManifest[_]" id="505962">m</a>: <span title="OptManifest[_]">OptManifest</span><span class="delimiter">[</span>_<span class="delimiter">]</span><span class="delimiter">)</span>: Global#<a href="../../../reflect/internal/Types.scala.html#40083" title="scala.tools.nsc.Global#Type">Type</a> =
      <a href="../../../reflect/internal/Definitions.scala.html#40473" title="object global.definitions">definitions</a>.<a href="../../../reflect/internal/Definitions.scala.html#46503" title="(m: scala.reflect.OptManifest[_])global.Type">manifestToType</a><span class="delimiter">(</span><a href="#505962" title="OptManifest[_]">m</a><span class="delimiter">)</span>
    
    <span class="keyword">class</span> <a title="class AppliedTypeFromManifests extends Object with ScalaObject" id="505961">AppliedTypeFromManifests</a><a href="#505961" title="ScalaObject" class="delimiter">(</a><a title="global.Symbol" id="505987">sym</a>: <a href="../../../reflect/internal/Symbols.scala.html#40001" title="global.Symbol">Symbol</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="keyword">def</span> <a title="[M](implicit m1: Manifest[M])global.Type" id="505977">apply</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="505979">M</a><span class="delimiter">]</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="Manifest[M]" id="505988">m1</a>: <span title="Manifest[M]">Manifest</span><span class="delimiter">[</span>M<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../../reflect/internal/Types.scala.html#40083" title="global.Type">Type</a> =
        <a href="../../../reflect/internal/Types.scala.html#40204" title="(tycon: global.Type, args: List[global.Type])global.Type">appliedType</a><span class="delimiter">(</span><a href="#505987" title="global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#47937" title="=&gt; global.Type">typeConstructor</a>, <span title="(xs: Manifest[M]*)List[Manifest[M]]">List</span><span class="delimiter">(</span><a href="#505988" title="Manifest[M]">m1</a><span class="delimiter">)</span> <span title="(f: Manifest[M] =&gt; global.Type)(implicit bf: scala.collection.generic.CanBuildFrom[List[Manifest[M]],global.Type,List[global.Type]])List[global.Type]">map</span> <span class="delimiter">(</span><a title="Manifest[M]" id="506023">x</a> =&gt; <a href="#505960" title="(m: OptManifest[_])scala.tools.nsc.Global#Type">manifestToType</a><span class="delimiter">(</span><a href="#506023" title="Manifest[M]">x</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="global.Type" class="delimiter">[</span><a href="../../../reflect/internal/Types.scala.html#40083" title="global.Type">Type</a><span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">)</span>

      <span class="keyword">def</span> <a title="[M1, M2](implicit m1: Manifest[M1], implicit m2: Manifest[M2])global.Type" id="505980">apply</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="505983">M1</a>, <a title="&gt;: Nothing &lt;: Any" id="505984">M2</a><span class="delimiter">]</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="Manifest[M1]" id="506069">m1</a>: <span title="Manifest[M1]">Manifest</span><span class="delimiter">[</span>M1<span class="delimiter">]</span>, <a title="Manifest[M2]" id="506070">m2</a>: <span title="Manifest[M2]">Manifest</span><span class="delimiter">[</span>M2<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../../reflect/internal/Types.scala.html#40083" title="global.Type">Type</a> =
        <a href="../../../reflect/internal/Types.scala.html#40204" title="(tycon: global.Type, args: List[global.Type])global.Type">appliedType</a><span class="delimiter">(</span><a href="#505987" title="global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#47937" title="=&gt; global.Type">typeConstructor</a>, <span title="(xs: scala.reflect.Manifest[_ &gt;: M2 with M1]*)List[scala.reflect.Manifest[_ &gt;: M2 with M1]]">List</span><span class="delimiter">(</span><a href="#506069" title="Manifest[M1]">m1</a>, <a href="#506070" title="Manifest[M2]">m2</a><span class="delimiter">)</span> <span title="(f: scala.reflect.Manifest[_ &gt;: M2 with M1] =&gt; global.Type)(implicit bf: scala.collection.generic.CanBuildFrom[List[scala.reflect.Manifest[_ &gt;: M2 with M1]],global.Type,List[global.Type]])List[global.Type]">map</span> <span class="delimiter">(</span><a title="scala.reflect.Manifest[_ &gt;: M2 with M1]" id="506130">x</a> =&gt; <a href="#505960" title="(m: OptManifest[_])scala.tools.nsc.Global#Type">manifestToType</a><span class="delimiter">(</span><a href="#506130" title="scala.reflect.Manifest[_ &gt;: M2 with M1]">x</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="global.Type" class="delimiter">[</span><a href="../../../reflect/internal/Types.scala.html#40083" title="global.Type">Type</a><span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
    
    <span class="delimiter">(</span>sym: <a href="../../../reflect/internal/Symbols.scala.html#40001" title="global.Symbol">Symbol</a><span class="delimiter">)</span> =&gt; <span title="AppliedTypeFromManifests" class="keyword">new</span> <a href="#505961" title="AppliedTypeFromManifests">AppliedTypeFromManifests</a><span class="delimiter">(</span><a href="#506193" title="global.Symbol">sym</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>