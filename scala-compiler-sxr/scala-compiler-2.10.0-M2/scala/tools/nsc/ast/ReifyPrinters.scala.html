<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>scala/tools/nsc/ast/ReifyPrinters.scala</title>
        <script type="text/javascript" src="../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
/* NSC -- new Scala compiler
 * Copyright 2005-2011 LAMP/EPFL
 * @author  Martin Odersky
 */

<span class="keyword">package</span> scala.tools.nsc
<span class="keyword">package</span> ast

<span class="keyword">import</span> compat.<span title="object scala.compat.Platform">Platform</span>.EOL
<span class="keyword">import</span> symtab._
<span class="keyword">import</span> <a href="../symtab/package.scala.html#34879" title="=&gt; reflect.internal.Flags.type">Flags</a>._

<span class="keyword">trait</span> <a title="trait ReifyPrinters extends Object with ScalaObject" id="14231">ReifyPrinters</a> <span title="ScalaObject" class="delimiter">{</span> self: NodePrinters =&gt;

  <span class="keyword">val</span> <a title="=&gt; scala.tools.nsc.Global" id="238885">global</a>: <a href="../Global.scala.html#12873" title="scala.tools.nsc.Global">Global</a>
  <span class="keyword">import</span> <a href="NodePrinters.scala.html#238867" title="=&gt; scala.tools.nsc.Global">global</a>._

  <span class="keyword">object</span> <a title="object ReifyPrinters.this.reifiedNodeToString" id="238887">reifiedNodeToString</a> <span title="ScalaObject" class="keyword">extends</span> <span title="ReifyPrinters.this.global.Tree =&gt; String">Function1</span><span class="delimiter">[</span>Tree, String<span class="delimiter">]</span> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="(tree: ReifyPrinters.this.global.Tree)String" id="238897">apply</a><span class="delimiter">(</span><a title="ReifyPrinters.this.global.Tree" id="270408">tree</a>: <span title="ReifyPrinters.this.global.Tree">Tree</span><span class="delimiter">)</span>: <span title="String">String</span> = <span class="delimiter">{</span>
      <span class="keyword">import</span> scala.reflect.api.Modifier

      // @PP: I fervently hope this is a test case or something, not anything being
      // depended upon.  Of more fragile code I cannot conceive.
      // @eb: This stuff is only needed to debug-print out reifications in human-readable format
      // Rolling a full-fledged, robust TreePrinter would be several times more code.
      <span class="delimiter">(</span><span class="keyword">for</span> <span class="delimiter">(</span><a title="String" id="271069">line</a> &lt;- <span class="delimiter">(</span><a href="#270408" title="ReifyPrinters.this.global.Tree">tree</a>.<span title="()String">toString</span>.<span title="(x$1: String)Array[String]">split</span><span title="(xs: Array[String])scala.collection.mutable.ArrayOps[String]" class="delimiter">(</span><span title="=&gt; String">EOL</span><span class="delimiter">)</span> <span title="(xs: Array[String])scala.collection.mutable.ArrayOps[String]">drop</span> <span title="Int(2)" class="int">2</span> <span title="(f: String =&gt; String)(implicit bf: scala.collection.generic.CanBuildFrom[Array[String],String,Array[String]])Array[String]">dropRight</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="keyword">yield</span> <span class="delimiter">{</span>
        <span class="keyword">var</span> <a title="String" id="271070">s</a> = <a href="#271069" title="String">line</a>.<span title="()String">trim</span>
        <a href="#271070" title="String">s</a> = <a href="#271070" title="String">s</a>.<span title="(x$1: CharSequence, x$2: CharSequence)String">replace</span><span class="delimiter">(</span><span title="String(&quot;$mr.&quot;)" class="string">&quot;$mr.&quot;</span>, <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span>
        <a href="#271070" title="String">s</a> = <a href="#271070" title="String">s</a>.<span title="(x$1: CharSequence, x$2: CharSequence)String">replace</span><span class="delimiter">(</span><span title="String(&quot;.apply&quot;)" class="string">&quot;.apply&quot;</span>, <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span>
        <a href="#271070" title="String">s</a> = <a href="#271070" title="String">s</a>.<span title="(x$1: CharSequence, x$2: CharSequence)String">replace</span><span class="delimiter">(</span><span title="String(&quot;scala.collection.immutable.&quot;)" class="string">&quot;scala.collection.immutable.&quot;</span>, <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span>
        <a href="#271070" title="String">s</a> = <span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;List\\[List\\[.*?\\].*?\\]&quot;</span>.<span title="=&gt; scala.util.matching.Regex">r</span>.<span title="(target: CharSequence, replacement: String)String">replaceAllIn</span><span class="delimiter">(</span><a href="#271070" title="String">s</a>, <span title="String(&quot;List&quot;)" class="string">&quot;List&quot;</span><span class="delimiter">)</span>
        <a href="#271070" title="String">s</a> = <span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;List\\[.*?\\]&quot;</span>.<span title="=&gt; scala.util.matching.Regex">r</span>.<span title="(target: CharSequence, replacement: String)String">replaceAllIn</span><span class="delimiter">(</span><a href="#271070" title="String">s</a>, <span title="String(&quot;List&quot;)" class="string">&quot;List&quot;</span><span class="delimiter">)</span>
        <a href="#271070" title="String">s</a> = <a href="#271070" title="String">s</a>.<span title="(x$1: CharSequence, x$2: CharSequence)String">replace</span><span class="delimiter">(</span><span title="String(&quot;immutable.this.Nil&quot;)" class="string">&quot;immutable.this.Nil&quot;</span>, <span title="String(&quot;List()&quot;)" class="string">&quot;List()&quot;</span><span class="delimiter">)</span>
        <a href="#271070" title="String">s</a> = <a href="#271070" title="String">s</a>.<span title="(x$1: CharSequence, x$2: CharSequence)String">replace</span><span class="delimiter">(</span><span title="String(&quot;modifiersFromInternalFlags&quot;)" class="string">&quot;modifiersFromInternalFlags&quot;</span>, <span title="String(&quot;Modifiers&quot;)" class="string">&quot;Modifiers&quot;</span><span class="delimiter">)</span>
        <a href="#271070" title="String">s</a> = <a href="#271070" title="String">s</a>.<span title="(x$1: CharSequence, x$2: CharSequence)String">replace</span><span class="delimiter">(</span><span title="String(&quot;Modifiers(0L, newTypeName(\&quot;\&quot;), List())&quot;)" class="string">&quot;Modifiers(0L, newTypeName(\&quot;\&quot;), List())&quot;</span>, <span title="String(&quot;Modifiers()&quot;)" class="string">&quot;Modifiers()&quot;</span><span class="delimiter">)</span>
        <a href="#271070" title="String">s</a> = <span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;&quot;&quot;Modifiers\((\d+)[lL], newTypeName\(&quot;(.*?)&quot;\), List\((.*?)\)\)&quot;&quot;&quot;</span>.<span title="=&gt; scala.util.matching.Regex">r</span>.<span title="(target: CharSequence, replacer: scala.util.matching.Regex.Match =&gt; String)String">replaceAllIn</span><span class="delimiter">(</span><a href="#271070" title="String">s</a>, <a title="scala.util.matching.Regex.Match" id="271115">m</a> =&gt; <span class="delimiter">{</span>
          <span class="keyword">val</span> <a title="scala.collection.mutable.ListBuffer[String]" id="271116">buf</a> = <span title="scala.collection.mutable.ListBuffer[String]" class="keyword">new</span> collection.mutable.<span title="scala.collection.mutable.ListBuffer[String]">ListBuffer</span><span class="delimiter">[</span>String<span class="delimiter">]</span>

          <span class="keyword">val</span> <a title="String" id="271117">annotations</a> = <a href="#271115" title="scala.util.matching.Regex.Match">m</a>.<span title="(i: Int)String">group</span><span class="delimiter">(</span><span title="Int(3)" class="int">3</span><span class="delimiter">)</span>
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#271116" title="scala.collection.mutable.ListBuffer[String]">buf</a>.<span title="=&gt; Boolean">nonEmpty</span> <span title="(x: Boolean)Boolean">||</span> <a href="#271117" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">annotations</a>.<span title="=&gt; Boolean">nonEmpty</span><span class="delimiter">)</span>
            <a href="#271116" title="scala.collection.mutable.ListBuffer[String]">buf</a>.<span title="(elems: String*)Unit">append</span><span class="delimiter">(</span><span title="String(&quot;List(&quot;)" class="string">&quot;List(&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#271117" title="String">annotations</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;)&quot;)" class="string">&quot;)&quot;</span><span class="delimiter">)</span>

          <span class="keyword">val</span> <a title="String" id="271118">privateWithin</a> = <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#271115" title="scala.util.matching.Regex.Match">m</a>.<span title="(i: Int)String">group</span><span class="delimiter">(</span><span title="Int(2)" class="int">2</span><span class="delimiter">)</span>
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#271116" title="scala.collection.mutable.ListBuffer[String]">buf</a>.<span title="=&gt; Boolean">nonEmpty</span> <span title="(x: Boolean)Boolean">||</span> <a href="#271118" title="String">privateWithin</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span>
            <a href="#271116" title="scala.collection.mutable.ListBuffer[String]">buf</a>.<span title="(elems: String*)Unit">append</span><span class="delimiter">(</span><span title="String(&quot;newTypeName(\&quot;&quot;)" class="string">&quot;newTypeName(\&quot;&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#271118" title="String">privateWithin</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;\&quot;)&quot;)" class="string">&quot;\&quot;)&quot;</span><span class="delimiter">)</span>

          <span class="keyword">val</span> <a title="Long" id="271119">flags</a> = <a href="#271115" title="scala.util.matching.Regex.Match">m</a>.<span title="(i: Int)String">group</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="delimiter">(</span><span title="Int(1)" class="int">1</span><span class="delimiter">)</span>.<span title="=&gt; Long">toLong</span>
          <span class="keyword">val</span> <a title="String" id="271120">s_flags</a> = <a href="../symtab/package.scala.html#34879" title="=&gt; reflect.internal.Flags.type">Flags</a>.<a href="../../../reflect/internal/Flags.scala.html#38629" title="(flags: Long)List[scala.reflect.api.Modifier]">modifiersOfFlags</a><span class="delimiter">(</span><a href="#271119" title="Long">flags</a><span class="delimiter">)</span> <span title="(f: scala.reflect.api.Modifier =&gt; String)(implicit bf: scala.collection.generic.CanBuildFrom[List[scala.reflect.api.Modifier],String,List[String]])List[String]">map</span> <span class="delimiter">(</span><a href="#271275" title="scala.reflect.api.Modifier">_</a>.<span title="=&gt; String">sourceString</span><span class="delimiter">)</span> <span title="(sep: String)String">mkString</span> <span title="String(&quot;, &quot;)" class="string">&quot;, &quot;</span>
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#271116" title="scala.collection.mutable.ListBuffer[String]">buf</a>.<span title="=&gt; Boolean">nonEmpty</span> <span title="(x: Boolean)Boolean">||</span> <a href="#271120" title="String">s_flags</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span>
            <a href="#271116" title="scala.collection.mutable.ListBuffer[String]">buf</a>.<span title="(elems: String*)Unit">append</span><span class="delimiter">(</span><span title="String(&quot;Set(&quot;)" class="string">&quot;Set(&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#271120" title="String">s_flags</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;)&quot;)" class="string">&quot;)&quot;</span><span class="delimiter">)</span>

          <span title="String(&quot;Modifiers(&quot;)" class="string">&quot;Modifiers(&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#271116" title="scala.collection.mutable.ListBuffer[String]">buf</a>.<span title="=&gt; scala.collection.mutable.ListBuffer[String]">reverse</span>.<span title="(sep: String)String">mkString</span><span class="delimiter">(</span><span title="String(&quot;, &quot;)" class="string">&quot;, &quot;</span><span class="delimiter">)</span>  <span title="(x$1: Any)String">+</span> <span title="String(&quot;)&quot;)" class="string">&quot;)&quot;</span>
        <span class="delimiter">}</span><span class="delimiter">)</span>
        <a href="#271070" title="String">s</a> = <span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;&quot;&quot;setInternalFlags\((\d+)L\)&quot;&quot;&quot;</span>.<span title="=&gt; scala.util.matching.Regex">r</span>.<span title="(target: CharSequence, replacer: scala.util.matching.Regex.Match =&gt; String)String">replaceAllIn</span><span class="delimiter">(</span><a href="#271070" title="String">s</a>, <a title="scala.util.matching.Regex.Match" id="271319">m</a> =&gt; <span class="delimiter">{</span>
          <span class="keyword">val</span> <a title="Long" id="271320">flags</a> = <a href="#271319" title="scala.util.matching.Regex.Match">m</a>.<span title="(i: Int)String">group</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="delimiter">(</span><span title="Int(1)" class="int">1</span><span class="delimiter">)</span>.<span title="=&gt; Long">toLong</span>
          <span class="keyword">val</span> <a title="List[String]" id="271321">mods</a> = <a href="../symtab/package.scala.html#34879" title="=&gt; reflect.internal.Flags.type">Flags</a>.<a href="../../../reflect/internal/Flags.scala.html#38629" title="(flags: Long)List[scala.reflect.api.Modifier]">modifiersOfFlags</a><span class="delimiter">(</span><a href="#271320" title="Long">flags</a><span class="delimiter">)</span> <span title="(f: scala.reflect.api.Modifier =&gt; String)(implicit bf: scala.collection.generic.CanBuildFrom[List[scala.reflect.api.Modifier],String,List[String]])List[String]">map</span> <span class="delimiter">(</span><a href="#271348" title="scala.reflect.api.Modifier">_</a>.<span title="=&gt; String">sourceString</span><span class="delimiter">)</span>
          <span title="String(&quot;setInternalFlags(flagsOfModifiers(List(&quot;)" class="string">&quot;setInternalFlags(flagsOfModifiers(List(&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#271321" title="List[String]">mods</a>.<span title="(sep: String)String">mkString</span><span class="delimiter">(</span><span title="String(&quot;, &quot;)" class="string">&quot;, &quot;</span><span class="delimiter">)</span> <span title="(x$1: Any)String">+</span> <span title="String(&quot;)))&quot;)" class="string">&quot;)))&quot;</span>
        <span class="delimiter">}</span><span class="delimiter">)</span>

        <a href="#271070" title="String">s</a>
      <span class="delimiter">}</span><span class="delimiter">)</span> <span title="(sep: String)String">mkString</span> <span title="=&gt; String">EOL</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>


  <span class="keyword">def</span> <a title="(tree: ReifyPrinters.this.global.Tree)Unit" id="238889">printReifyCopypaste</a><span class="delimiter">(</span><a title="ReifyPrinters.this.global.Tree" id="271530">tree</a>: <span title="ReifyPrinters.this.global.Tree">Tree</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Boolean" id="271532">reifyDebug</a> = <a href="../Global.scala.html#186138" title="=&gt; scala.tools.nsc.Settings">settings</a>.<a href="../settings/ScalaSettings.scala.html#186842" title="=&gt; scala.tools.nsc.Settings#BooleanSetting">Yreifydebug</a>.<a href="../settings/MutableSettings.scala.html#187054" title="=&gt; Boolean">value</a>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#271532" title="Boolean">reifyDebug</a><span class="delimiter">)</span> <span title="(x: Any)Unit">println</span><span class="delimiter">(</span><span title="String(&quot;=======================&quot;)" class="string">&quot;=======================&quot;</span><span class="delimiter">)</span>
    <a href="#238890" title="(tree: ReifyPrinters.this.global.Tree)Unit">printReifyCopypaste1</a><span class="delimiter">(</span><a href="#271530" title="ReifyPrinters.this.global.Tree">tree</a><span class="delimiter">)</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#271532" title="Boolean">reifyDebug</a><span class="delimiter">)</span> <span title="(x: Any)Unit">println</span><span class="delimiter">(</span><span title="String(&quot;=======================&quot;)" class="string">&quot;=======================&quot;</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(tree: ReifyPrinters.this.global.Tree)Unit" id="238890">printReifyCopypaste1</a><span class="delimiter">(</span><a title="ReifyPrinters.this.global.Tree" id="271536">tree</a>: <span title="ReifyPrinters.this.global.Tree">Tree</span><span class="delimiter">)</span> <span title="Unit" class="delimiter">{</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>
        </pre>
    </body>
</html>