<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>scala/tools/nsc/backend/opt/Inliners.scala</title>
        <script type="text/javascript" src="../../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
/* NSC -- new Scala compiler
 * Copyright 2005-2011 LAMP/EPFL
 * @author  Iulian Dragos
 */


<span class="keyword">package</span> scala.tools.nsc
<span class="keyword">package</span> backend.opt

<span class="keyword">import</span> scala.collection.mutable
<span class="keyword">import</span> scala.tools.nsc.symtab._
<span class="keyword">import</span> scala.tools.nsc.util.<span class="delimiter">{</span> NoSourceFile <span class="delimiter">}</span>

/**
 *  @author Iulian Dragos
 */
<span class="keyword">abstract</span> <span class="keyword">class</span> <a title="class Inliners extends scala.tools.nsc.SubComponent with ScalaObject" id="18110">Inliners</a> <a href="#18110" title="ScalaObject" class="keyword">extends</a> <a href="../../SubComponent.scala.html#12666" title="scala.tools.nsc.SubComponent">SubComponent</a> <span class="delimiter">{</span>
  <span class="keyword">import</span> <a href="../../SubComponent.scala.html#231956" title="=&gt; scala.tools.nsc.Global">global</a>._
  <span class="keyword">import</span> <a href="../../Global.scala.html#186153" title="object Inliners.this.global.icodes">icodes</a>._
  <span class="keyword">import</span> <a href="../../Global.scala.html#186153" title="object Inliners.this.global.icodes">icodes</a>.<a href="../icode/Opcodes.scala.html#232654" title="object Inliners.this.global.icodes.opcodes">opcodes</a>._
  <span class="keyword">import</span> <a href="../../../../reflect/internal/Definitions.scala.html#39224" title="object Inliners.this.global.definitions">definitions</a>.<span class="delimiter">{</span>
    NullClass, NothingClass, ObjectClass,
    PredefModule, RuntimePackage, ScalaInlineClass, ScalaNoInlineClass,
    isFunctionType
  <span class="delimiter">}</span>

  <span class="keyword">val</span> <a title="String" id="243201">phaseName</a> = <span title="String(&quot;inliner&quot;)" class="string">&quot;inliner&quot;</span>

  /** Debug - for timing the inliner. */
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="[T](s: String, body: =&gt; T)T" id="243203">timed</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="243205">T</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="String" id="381295">s</a>: <span title="String">String</span>, <a title="=&gt; T" id="381296">body</a>: =&gt; T<span class="delimiter">)</span>: <a href="#243205" title="T">T</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Long" id="381300">t1</a> = <span title="object System">System</span>.<span title="()Long">currentTimeMillis</span><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="T" id="381301">res</a> = <a href="#381296" title="=&gt; T">body</a>
    <span class="keyword">val</span> <a title="Long" id="381302">t2</a> = <span title="object System">System</span>.<span title="()Long">currentTimeMillis</span><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="Int" id="381303">ms</a> = <span class="delimiter">(</span><a href="#381302" title="Long">t2</a> <span title="(x: Long)Long">-</span> <a href="#381300" title="Long">t1</a><span class="delimiter">)</span>.<span title="=&gt; Int">toInt</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#381303" title="Int">ms</a> <span title="(x: Int)Boolean">&gt;=</span> <span title="Int(2000)">MAX_INLINE_MILLIS</span><span class="delimiter">)</span>
      <span title="(x: Any)Unit">println</span><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;%s: %d milliseconds&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#381295" title="String">s</a>, <a href="#381303" title="Int">ms</a><span class="delimiter">)</span><span class="delimiter">)</span>

    <a href="#381301" title="T">res</a>
  <span class="delimiter">}</span>

  /** Look up implementation of method 'sym in 'clazz'.
   */
  <span class="keyword">def</span> <a title="(sym: Inliners.this.global.Symbol, clazz: Inliners.this.global.Symbol)Inliners.this.global.Symbol" id="243206">lookupImplFor</a><span class="delimiter">(</span><a title="Inliners.this.global.Symbol" id="354776">sym</a>: <a href="../../../../reflect/internal/Symbols.scala.html#38726" title="Inliners.this.global.Symbol">Symbol</a>, <a title="Inliners.this.global.Symbol" id="354777">clazz</a>: <a href="../../../../reflect/internal/Symbols.scala.html#38726" title="Inliners.this.global.Symbol">Symbol</a><span class="delimiter">)</span>: <a href="../../../../reflect/internal/Symbols.scala.html#38726" title="Inliners.this.global.Symbol">Symbol</a> = <span class="delimiter">{</span>
    // TODO: verify that clazz.superClass is equivalent here to clazz.tpe.parents(0).typeSymbol (.tpe vs .info)
    <span class="keyword">def</span> <a title="=&gt; Boolean" id="381322">needsLookup</a> = <span class="delimiter">(</span>
         <span class="delimiter">(</span><a href="#354777" title="Inliners.this.global.Symbol">clazz</a> <span title="(x$1: AnyRef)Boolean">!=</span> <a href="../../../../reflect/internal/Symbols.scala.html#38740" title="=&gt; Inliners.this.global.NoSymbol">NoSymbol</a><span class="delimiter">)</span>
      <span title="(x: Boolean)Boolean">&amp;&amp;</span> <span class="delimiter">(</span><a href="#354777" title="Inliners.this.global.Symbol">clazz</a> <span title="(x$1: AnyRef)Boolean">!=</span> <a href="#354776" title="Inliners.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#46564" title="=&gt; Inliners.this.global.Symbol">owner</a><span class="delimiter">)</span>
      <span title="(x: Boolean)Boolean">&amp;&amp;</span> <span title="=&gt; Boolean">!</span><a href="#354776" title="Inliners.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#46549" title="=&gt; Boolean">isEffectivelyFinal</a>
      <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#354777" title="Inliners.this.global.Symbol">clazz</a>.<a href="../../../../reflect/internal/Symbols.scala.html#46549" title="=&gt; Boolean">isEffectivelyFinal</a>
    <span class="delimiter">)</span>
    <span class="keyword">def</span> <a title="(clazz: Inliners.this.global.Symbol)Inliners.this.global.Symbol" id="381323">lookup</a><span class="delimiter">(</span><a title="Inliners.this.global.Symbol" id="381332">clazz</a>: <a href="../../../../reflect/internal/Symbols.scala.html#38726" title="Inliners.this.global.Symbol">Symbol</a><span class="delimiter">)</span>: <a href="../../../../reflect/internal/Symbols.scala.html#38726" title="Inliners.this.global.Symbol">Symbol</a> = <span class="delimiter">{</span>
      // println(&quot;\t\tlooking up &quot; + meth + &quot; in &quot; + clazz.fullName + &quot; meth.owner = &quot; + meth.owner)
      <span title="Inliners.this.global.Symbol" class="keyword">if</span> <span class="delimiter">(</span><a href="#354776" title="Inliners.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#46564" title="=&gt; Inliners.this.global.Symbol">owner</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#381332" title="Inliners.this.global.Symbol">clazz</a> <span title="(x: Boolean)Boolean">||</span> <a href="#243217" title="(sym: Inliners.this.global.Symbol)Boolean">isBottomType</a><span class="delimiter">(</span><a href="#381332" title="Inliners.this.global.Symbol">clazz</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="#354776" title="Inliners.this.global.Symbol">sym</a>
      <span class="keyword">else</span> <a href="#354776" title="Inliners.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#46702" title="(ofclazz: Inliners.this.global.Symbol)Inliners.this.global.Symbol">overridingSymbol</a><span class="delimiter">(</span><a href="#381332" title="Inliners.this.global.Symbol">clazz</a><span class="delimiter">)</span> <span title="Inliners.this.global.Symbol" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <a href="../../../../reflect/internal/Symbols.scala.html#38740" title="Inliners.this.global.Symbol">NoSymbol</a>  =&gt; <span title="Inliners.this.global.Symbol" class="keyword">if</span> <span class="delimiter">(</span><a href="#354776" title="Inliners.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#46564" title="=&gt; Inliners.this.global.Symbol">owner</a>.<a href="../../../../reflect/internal/Symbols.scala.html#46451" title="=&gt; Boolean">isTrait</a><span class="delimiter">)</span> <a href="#354776" title="Inliners.this.global.Symbol">sym</a> <span class="keyword">else</span> <a href="#381323" title="(clazz: Inliners.this.global.Symbol)Inliners.this.global.Symbol">lookup</a><span class="delimiter">(</span><a href="#381332" title="Inliners.this.global.Symbol">clazz</a>.<a href="../../../../reflect/internal/Symbols.scala.html#46680" title="=&gt; Inliners.this.global.Symbol">superClass</a><span class="delimiter">)</span>
        <span class="keyword">case</span> <a title="Inliners.this.global.Symbol" id="381351">imp</a>       =&gt; <a href="#381351" title="Inliners.this.global.Symbol">imp</a>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
    <span title="Inliners.this.global.Symbol" class="keyword">if</span> <span class="delimiter">(</span><a href="#381322" title="=&gt; Boolean">needsLookup</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="Inliners.this.global.Symbol" id="381352">concreteMethod</a> = <a href="#381323" title="(clazz: Inliners.this.global.Symbol)Inliners.this.global.Symbol">lookup</a><span class="delimiter">(</span><a href="#354777" title="Inliners.this.global.Symbol">clazz</a><span class="delimiter">)</span>
      <a href="../../Global.scala.html#186189" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><span title="String(&quot;\tlooked up method: &quot;)" class="string">&quot;\tlooked up method: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#381352" title="Inliners.this.global.Symbol">concreteMethod</a>.<a href="../../../../reflect/internal/Symbols.scala.html#46585" title="=&gt; String">fullName</a><span class="delimiter">)</span>

      <a href="#381352" title="Inliners.this.global.Symbol">concreteMethod</a>
    <span class="delimiter">}</span>
    <span class="keyword">else</span> <a href="#354776" title="Inliners.this.global.Symbol">sym</a>
  <span class="delimiter">}</span>

  /* A warning threshold */
  <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">val</span> <a title="Int(2000)" id="243207">MAX_INLINE_MILLIS</a> = <span title="Int(2000)" class="int">2000</span>

  /** The maximum size in basic blocks of methods considered for inlining. */
  <span class="keyword">final</span> <span class="keyword">val</span> <a title="Int(16)" id="243209">MAX_INLINE_SIZE</a> = <span title="Int(16)" class="int">16</span>

  /** Maximum loop iterations. */
  <span class="keyword">final</span> <span class="keyword">val</span> <a title="Int(15)" id="243211">MAX_INLINE_RETRY</a> = <span title="Int(15)" class="int">15</span>

  /** Small method size (in blocks) */
  <span class="keyword">val</span> <a title="Int" id="243213">SMALL_METHOD_SIZE</a> = <span title="Int(1)" class="int">1</span>

  /** Create a new phase */
  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(p: scala.tools.nsc.Phase)Inliners.this.InliningPhase" id="243215">newPhase</a><span class="delimiter">(</span><a title="scala.tools.nsc.Phase" id="244680">p</a>: <a href="../../../../reflect/internal/Phase.scala.html#8452" title="scala.tools.nsc.Phase">Phase</a><span class="delimiter">)</span> = <span title="Inliners.this.InliningPhase" class="keyword">new</span> <a href="#243216" title="Inliners.this.InliningPhase">InliningPhase</a><span class="delimiter">(</span><a href="#244680" title="scala.tools.nsc.Phase">p</a><span class="delimiter">)</span>

  /** The Inlining phase.
   */
  <span class="keyword">class</span> <a title="class InliningPhase extends Inliners.this.global.icodes.ICodePhase with ScalaObject" id="243216">InliningPhase</a><a href="#243216" title="ScalaObject" class="delimiter">(</a><a title="scala.tools.nsc.Phase" id="244691">prev</a>: <a href="../../../../reflect/internal/Phase.scala.html#8452" title="scala.tools.nsc.Phase">Phase</a><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="../icode/ICodes.scala.html#232623" title="Inliners.this.global.icodes.ICodePhase">ICodePhase</a><span class="delimiter">(</span><a href="#244691" title="scala.tools.nsc.Phase">prev</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="=&gt; String" id="244686">name</a> = <a href="#243201" title="=&gt; String">phaseName</a>
    <span class="keyword">val</span> <a title="Inliners.this.Inliner" id="244687">inliner</a> = <span title="Inliners.this.Inliner" class="keyword">new</span> <a href="#243223" title="Inliners.this.Inliner">Inliner</a>

    <span class="keyword">override</span> <span class="keyword">def</span> <a title="(c: Inliners.this.global.icodes.IClass)Unit" id="244689">apply</a><span class="delimiter">(</span><a title="Inliners.this.global.icodes.IClass" id="381387">c</a>: <a href="../icode/Members.scala.html#232636" title="Inliners.this.global.icodes.IClass">IClass</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#244687" title="=&gt; Inliners.this.Inliner">inliner</a> <a href="#381369" title="(cls: Inliners.this.global.icodes.IClass)Unit">analyzeClass</a> <a href="#381387" title="Inliners.this.global.icodes.IClass">c</a>
    <span class="delimiter">}</span>

    <span class="keyword">override</span> <span class="keyword">def</span> <a title="()Unit" id="244690">run</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="keyword">try</span> <span class="delimiter">{</span>
        <a href="#243216" title="Inliners.this.InliningPhase" class="keyword">super</a>.<a href="../../Global.scala.html#241864" title="()Unit">run</a><span class="delimiter">(</span><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">finally</span> <span class="delimiter">{</span>
        <a href="#244687" title="=&gt; Inliners.this.Inliner">inliner</a>.<a href="#381368" title="()Unit">clearCaches</a><span class="delimiter">(</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(sym: Inliners.this.global.Symbol)Boolean" id="243217">isBottomType</a><span class="delimiter">(</span><a title="Inliners.this.global.Symbol" id="381338">sym</a>: <a href="../../../../reflect/internal/Symbols.scala.html#38726" title="Inliners.this.global.Symbol">Symbol</a><span class="delimiter">)</span> = <a href="#381338" title="Inliners.this.global.Symbol">sym</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../../../reflect/internal/Definitions.scala.html#44998" title="object Inliners.this.global.definitions.NullClass">NullClass</a> <span title="(x: Boolean)Boolean">||</span> <a href="#381338" title="Inliners.this.global.Symbol">sym</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../../../reflect/internal/Definitions.scala.html#44996" title="object Inliners.this.global.definitions.NothingClass">NothingClass</a>
  <span class="keyword">def</span> <a title="(pos: scala.tools.nsc.util.Position)String" id="243218">posToStr</a><span class="delimiter">(</span><a title="scala.tools.nsc.util.Position" id="381409">pos</a>: util.<a href="../../util/Position.scala.html#33991" title="scala.tools.nsc.util.Position">Position</a><span class="delimiter">)</span> = <span title="String" class="keyword">if</span> <span class="delimiter">(</span><a href="#381409" title="scala.tools.nsc.util.Position">pos</a>.<a href="../../util/Position.scala.html#187129" title="=&gt; Boolean">isDefined</a><span class="delimiter">)</span> <a href="#381409" title="scala.tools.nsc.util.Position">pos</a>.<a href="../../util/Position.scala.html#187136" title="=&gt; Int">point</a>.<span title="()String">toString</span> <span class="keyword">else</span> <span title="String(&quot;&lt;nopos&gt;&quot;)" class="string">&quot;&lt;nopos&gt;&quot;</span>

  /** Is the given class a closure? */
  <span class="keyword">def</span> <a title="(cls: Inliners.this.global.Symbol)Boolean" id="243219">isClosureClass</a><span class="delimiter">(</span><a title="Inliners.this.global.Symbol" id="354781">cls</a>: <a href="../../../../reflect/internal/Symbols.scala.html#38726" title="Inliners.this.global.Symbol">Symbol</a><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> =
    <a href="#354781" title="Inliners.this.global.Symbol">cls</a>.<a href="../../../../reflect/internal/HasFlags.scala.html#46777" title="=&gt; Boolean">isFinal</a> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#354781" title="Inliners.this.global.Symbol">cls</a>.<a href="../../../../reflect/internal/HasFlags.scala.html#46784" title="=&gt; Boolean">isSynthetic</a> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <span title="=&gt; Boolean">!</span><a href="#354781" title="Inliners.this.global.Symbol">cls</a>.<a href="../../../../reflect/internal/Symbols.scala.html#46463" title="=&gt; Boolean">isModuleClass</a> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#354781" title="Inliners.this.global.Symbol">cls</a>.<a href="../../../../reflect/internal/Symbols.scala.html#46504" title="=&gt; Boolean">isAnonymousFunction</a>

  /*
      TODO now that Inliner runs faster we could consider additional &quot;monadic methods&quot; (in the limit, all those taking a closure as last arg)
      Any &quot;monadic method&quot; occurring in a given caller C that is not `isMonadicMethod()` will prevent CloseElim from eliminating
      any anonymous-closure-class any whose instances are given as argument to C invocations.
   */
  <span class="keyword">def</span> <a title="(sym: Inliners.this.global.Symbol)Boolean" id="243220">isMonadicMethod</a><span class="delimiter">(</span><a title="Inliners.this.global.Symbol" id="354900">sym</a>: <a href="../../../../reflect/internal/Symbols.scala.html#38726" title="Inliners.this.global.Symbol">Symbol</a><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <a href="../../../../reflect/internal/StdNames.scala.html#39313" title="object Inliners.this.global.nme">nme</a>.<a href="../../../../reflect/internal/NameManglers.scala.html#59429" title="(name: Inliners.this.global.Name)Inliners.this.global.Name">unspecializedName</a><span class="delimiter">(</span><a href="#354900" title="Inliners.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#46571" title="=&gt; Inliners.this.global.Name">name</a><span class="delimiter">)</span> <span title="Boolean" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <a href="../../../../reflect/internal/StdNames.scala.html#39313" title="Boolean(true)">nme</a>.<a href="../../../../reflect/internal/StdNames.scala.html#59152" title="=&gt; Inliners.this.global.nme.NameType">foreach</a> | <a href="../../../../reflect/internal/StdNames.scala.html#39313" title="object Inliners.this.global.nme">nme</a>.<a href="../../../../reflect/internal/StdNames.scala.html#59144" title="=&gt; Inliners.this.global.nme.NameType">filter</a> | <a href="../../../../reflect/internal/StdNames.scala.html#39313" title="object Inliners.this.global.nme">nme</a>.<a href="../../../../reflect/internal/StdNames.scala.html#59296" title="=&gt; Inliners.this.global.nme.NameType">withFilter</a> | <a href="../../../../reflect/internal/StdNames.scala.html#39313" title="object Inliners.this.global.nme">nme</a>.<a href="../../../../reflect/internal/StdNames.scala.html#59202" title="=&gt; Inliners.this.global.nme.NameType">map</a> | <a href="../../../../reflect/internal/StdNames.scala.html#39313" title="object Inliners.this.global.nme">nme</a>.<a href="../../../../reflect/internal/StdNames.scala.html#59150" title="=&gt; Inliners.this.global.nme.NameType">flatMap</a> =&gt; <span title="Boolean(true)" class="keyword">true</span>
      <span class="keyword">case</span> <span title="Boolean(false)">_</span>                                                                 =&gt; <span title="Boolean(false)" class="keyword">false</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(sym: Inliners.this.global.Symbol)Boolean" id="243221">hasInline</a><span class="delimiter">(</span><a title="Inliners.this.global.Symbol" id="354905">sym</a>: <a href="../../../../reflect/internal/Symbols.scala.html#38726" title="Inliners.this.global.Symbol">Symbol</a><span class="delimiter">)</span>    = <a href="#354905" title="Inliners.this.global.Symbol">sym</a> <a href="../../../../reflect/internal/AnnotationInfos.scala.html#44936" title="(cls: Inliners.this.global.Symbol)Boolean">hasAnnotation</a> <a href="../../../../reflect/internal/Definitions.scala.html#45409" title="=&gt; Inliners.this.global.Symbol">ScalaInlineClass</a>
  <span class="keyword">def</span> <a title="(sym: Inliners.this.global.Symbol)Boolean" id="243222">hasNoInline</a><span class="delimiter">(</span><a title="Inliners.this.global.Symbol" id="381412">sym</a>: <a href="../../../../reflect/internal/Symbols.scala.html#38726" title="Inliners.this.global.Symbol">Symbol</a><span class="delimiter">)</span>  = <a href="#381412" title="Inliners.this.global.Symbol">sym</a> <a href="../../../../reflect/internal/AnnotationInfos.scala.html#44936" title="(cls: Inliners.this.global.Symbol)Boolean">hasAnnotation</a> <a href="../../../../reflect/internal/Definitions.scala.html#45411" title="=&gt; Inliners.this.global.Symbol">ScalaNoInlineClass</a>

  /**
   * Simple inliner.
   */
  <span class="keyword">class</span> <a title="class Inliner extends Object with ScalaObject" id="243223">Inliner</a> <a href="#243223" title="ScalaObject" class="delimiter">{</a>
    <span class="keyword">object</span> <a title="object Inliner.this.NonPublicRefs" id="381358">NonPublicRefs</a> <span title="ScalaObject" class="keyword">extends</span> <span title="Enumeration">Enumeration</span> <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="scala.tools.nsc.backend.opt.Inliners.Inliner.NonPublicRefs.Value" id="381397">Private</a>, <a title="scala.tools.nsc.backend.opt.Inliners.Inliner.NonPublicRefs.Value" id="381399">Protected</a>, <a title="scala.tools.nsc.backend.opt.Inliners.Inliner.NonPublicRefs.Value" id="381401">Public</a> = <span title="=&gt; scala.tools.nsc.backend.opt.Inliners.Inliner.NonPublicRefs.Value">Value</span>

      /** Cache whether a method calls private members. */
      <span class="keyword">val</span> <a title="scala.collection.mutable.Map[Inliners.this.global.icodes.IMethod,scala.tools.nsc.backend.opt.Inliners.Inliner.NonPublicRefs.Value]" id="381403">usesNonPublics</a> = mutable.<span title="object scala.collection.mutable.Map">Map</span>.<span title="[A, B]=&gt; scala.collection.mutable.Map[A,B]">empty</span><span title="scala.collection.mutable.Map[Inliners.this.global.icodes.IMethod,scala.tools.nsc.backend.opt.Inliners.Inliner.NonPublicRefs.Value]" class="delimiter">[</span><a href="../icode/Members.scala.html#232640" title="Inliners.this.global.icodes.IMethod">IMethod</a>, <span title="scala.tools.nsc.backend.opt.Inliners.Inliner.NonPublicRefs.Value">Value</span><span class="delimiter">]</span>
    <span class="delimiter">}</span>
    <span class="keyword">import</span> <a href="#381358" title="object Inliner.this.NonPublicRefs">NonPublicRefs</a>._

    /** The current iclass */
    <span class="keyword">private</span> <span class="keyword">var</span> <a title="Inliners.this.global.icodes.IClass" id="381362">currentIClazz</a>: <a href="../icode/Members.scala.html#232636" title="Inliners.this.global.icodes.IClass">IClass</a> = _
    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(pos: Inliners.this.global.Position, msg: String)Unit" id="381364">warn</a><span class="delimiter">(</span><a title="Inliners.this.global.Position" id="381437">pos</a>: <a href="../../util/Position.scala.html#33991" title="Inliners.this.global.Position">Position</a>, <a title="String" id="381438">msg</a>: <span title="String">String</span><span class="delimiter">)</span> = <a href="#381362" title="=&gt; Inliners.this.global.icodes.IClass">currentIClazz</a>.<a href="../icode/Members.scala.html#232939" title="=&gt; Inliners.this.global.icodes.global.CompilationUnit">cunit</a>.<a href="../../CompilationUnits.scala.html#188715" title="(pos: Inliners.this.global.icodes.global.Position, msg: String)Unit">warning</a><span class="delimiter">(</span><a href="#381437" title="Inliners.this.global.Position">pos</a>, <a href="#381438" title="String">msg</a><span class="delimiter">)</span>

    <span class="keyword">val</span> <a title="scala.collection.mutable.Map[Inliners.this.global.Symbol,(Boolean, Inliners.this.global.analysis.MethodTFA)]" id="381365">recentTFAs</a> = mutable.<span title="object scala.collection.mutable.Map">Map</span>.<span title="[A, B]=&gt; scala.collection.mutable.Map[A,B]">empty</span><span title="scala.collection.mutable.Map[Inliners.this.global.Symbol,(Boolean, Inliners.this.global.analysis.MethodTFA)]" class="delimiter">[</span><a href="../../../../reflect/internal/Symbols.scala.html#38726" title="Inliners.this.global.Symbol">Symbol</a>, <span title="(Boolean, Inliners.this.global.analysis.MethodTFA)">Tuple2</span><span class="delimiter">[</span>Boolean, analysis.MethodTFA<span class="delimiter">]</span><span class="delimiter">]</span>
    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(incm: Inliners.this.global.icodes.IMethod)(Boolean, Inliners.this.global.analysis.MethodTFA)" id="381367">getRecentTFA</a><span class="delimiter">(</span><a title="Inliners.this.global.icodes.IMethod" id="381443">incm</a>: <a href="../icode/Members.scala.html#232640" title="Inliners.this.global.icodes.IMethod">IMethod</a><span class="delimiter">)</span>: <span title="(Boolean, Inliners.this.global.analysis.MethodTFA)" class="delimiter">(</span>Boolean, analysis.MethodTFA<span class="delimiter">)</span> = <span class="delimiter">{</span>

        <span class="keyword">def</span> <a title="(blocks: List[Inliners.this.global.icodes.BasicBlock])Boolean" id="381445">containsRETURN</a><span class="delimiter">(</span><a title="List[Inliners.this.global.icodes.BasicBlock]" id="381449">blocks</a>: <span title="List[Inliners.this.global.icodes.BasicBlock]">List</span><span class="delimiter">[</span>BasicBlock<span class="delimiter">]</span><span class="delimiter">)</span> = <a href="#381449" title="List[Inliners.this.global.icodes.BasicBlock]">blocks</a> <span title="(p: Inliners.this.global.icodes.BasicBlock =&gt; Boolean)Boolean">exists</span> <span class="delimiter">{</span> <a title="Inliners.this.global.icodes.BasicBlock" id="381456">bb</a> =&gt; <a href="#381456" title="Inliners.this.global.icodes.BasicBlock">bb</a>.<a href="../icode/BasicBlocks.scala.html#322182" title="=&gt; Inliners.this.global.icodes.Instruction">lastInstruction</a>.<span title="[T0]=&gt; Boolean">isInstanceOf</span><span title="Boolean" class="delimiter">[</span><a href="../icode/Opcodes.scala.html#244565" title="Inliners.this.global.icodes.opcodes.RETURN">RETURN</a><span class="delimiter">]</span> <span class="delimiter">}</span>

      <span class="keyword">val</span> <a title="Option[(Boolean, Inliners.this.global.analysis.MethodTFA)]" id="381446">opt</a> = <a href="#381365" title="=&gt; scala.collection.mutable.Map[Inliners.this.global.Symbol,(Boolean, Inliners.this.global.analysis.MethodTFA)]">recentTFAs</a>.<span title="(key: Inliners.this.global.Symbol)Option[(Boolean, Inliners.this.global.analysis.MethodTFA)]">get</span><span class="delimiter">(</span><a href="#381443" title="Inliners.this.global.icodes.IMethod">incm</a>.<a href="../icode/Members.scala.html#322208" title="=&gt; Inliners.this.global.icodes.global.Symbol">symbol</a><span class="delimiter">)</span>
      <span title="Unit" class="keyword">if</span><span class="delimiter">(</span><a href="#381446" title="Option[(Boolean, Inliners.this.global.analysis.MethodTFA)]">opt</a>.<span title="=&gt; Boolean">isDefined</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        // FYI val cachedBBs = opt.get._2.in.keySet
        // FYI assert(incm.blocks.toSet == cachedBBs)
        // incm.code.touched plays no role here
        <span title="Nothing" class="keyword">return</span> <a href="#381446" title="Option[(Boolean, Inliners.this.global.analysis.MethodTFA)]">opt</a>.<span title="=&gt; (Boolean, Inliners.this.global.analysis.MethodTFA)">get</span>
      <span class="delimiter">}</span>

      <span class="keyword">val</span> <a title="Boolean" id="381447">hasRETURN</a> = <a href="#381445" title="(blocks: List[Inliners.this.global.icodes.BasicBlock])Boolean">containsRETURN</a><span class="delimiter">(</span><a href="#381443" title="Inliners.this.global.icodes.IMethod">incm</a>.<a href="../icode/Members.scala.html#322211" title="=&gt; Inliners.this.global.icodes.Code">code</a>.<a href="../icode/Members.scala.html#322312" title="=&gt; List[Inliners.this.global.icodes.BasicBlock]">blocksList</a><span class="delimiter">)</span> <span title="(x: Boolean)Boolean">||</span> <span class="delimiter">(</span><a href="#381443" title="Inliners.this.global.icodes.IMethod">incm</a>.<a href="../icode/Members.scala.html#322228" title="=&gt; List[Inliners.this.global.icodes.ExceptionHandler]">exh</a> <span title="(p: Inliners.this.global.icodes.ExceptionHandler =&gt; Boolean)Boolean">exists</span> <span class="delimiter">{</span> <a title="Inliners.this.global.icodes.ExceptionHandler" id="381471">eh</a> =&gt; <a href="#381445" title="(blocks: List[Inliners.this.global.icodes.BasicBlock])Boolean">containsRETURN</a><span class="delimiter">(</span><a href="#381471" title="Inliners.this.global.icodes.ExceptionHandler">eh</a>.<a href="../icode/ExceptionHandlers.scala.html#322463" title="=&gt; List[Inliners.this.global.icodes.BasicBlock]">blocks</a><span class="delimiter">)</span> <span class="delimiter">}</span><span class="delimiter">)</span>
      <span class="keyword">var</span> <a title="Inliners.this.global.analysis.MethodTFA" id="381448">a</a>: analysis.<a href="../icode/analysis/TypeFlowAnalysis.scala.html#239593" title="Inliners.this.global.analysis.MethodTFA">MethodTFA</a> = <span title="Null(null)" class="keyword">null</span>
      <span title="Unit" class="keyword">if</span><span class="delimiter">(</span><a href="#381447" title="Boolean">hasRETURN</a><span class="delimiter">)</span> <span class="delimiter">{</span> <a href="#381448" title="Inliners.this.global.analysis.MethodTFA">a</a> = <a href="../icode/analysis/TypeFlowAnalysis.scala.html#353262" title="(m: Inliners.this.global.analysis.global.icodes.IMethod)Inliners.this.global.analysis.MethodTFA" class="keyword">new</a> <a href="../../Global.scala.html#186159" title="object Inliners.this.global.analysis">analysis</a>.<a href="../icode/analysis/TypeFlowAnalysis.scala.html#239593" title="Inliners.this.global.analysis.MethodTFA">MethodTFA</a><span class="delimiter">(</span><a href="#381443" title="Inliners.this.global.icodes.IMethod">incm</a><span class="delimiter">)</span>; <a href="#381448" title="Inliners.this.global.analysis.MethodTFA">a</a>.<a href="../icode/analysis/TypeFlowAnalysis.scala.html#353263" title="()Unit">run</a> <span class="delimiter">}</span>

      <span title="Any" class="keyword">if</span><span class="delimiter">(</span><a href="#243221" title="(sym: Inliners.this.global.Symbol)Boolean">hasInline</a><span class="delimiter">(</span><a href="#381443" title="Inliners.this.global.icodes.IMethod">incm</a>.<a href="../icode/Members.scala.html#322208" title="=&gt; Inliners.this.global.icodes.global.Symbol">symbol</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span> <a href="#381365" title="=&gt; scala.collection.mutable.Map[Inliners.this.global.Symbol,(Boolean, Inliners.this.global.analysis.MethodTFA)]">recentTFAs</a>.<span title="(key: Inliners.this.global.Symbol, value: (Boolean, Inliners.this.global.analysis.MethodTFA))Option[(Boolean, Inliners.this.global.analysis.MethodTFA)]">put</span><span class="delimiter">(</span><a href="#381443" title="Inliners.this.global.icodes.IMethod">incm</a>.<a href="../icode/Members.scala.html#322208" title="=&gt; Inliners.this.global.icodes.global.Symbol">symbol</a>, <span title="(_1: Boolean, _2: Inliners.this.global.analysis.MethodTFA)(Boolean, Inliners.this.global.analysis.MethodTFA)" class="delimiter">(</span><a href="#381447" title="Boolean">hasRETURN</a>, <a href="#381448" title="Inliners.this.global.analysis.MethodTFA">a</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">}</span>

      <span title="(_1: Boolean, _2: Inliners.this.global.analysis.MethodTFA)(Boolean, Inliners.this.global.analysis.MethodTFA)" class="delimiter">(</span><a href="#381447" title="Boolean">hasRETURN</a>, <a href="#381448" title="Inliners.this.global.analysis.MethodTFA">a</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="()Unit" id="381368">clearCaches</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      // methods
      <a href="#381358" title="object Inliner.this.NonPublicRefs">NonPublicRefs</a>.<a href="#381403" title="=&gt; scala.collection.mutable.Map[Inliners.this.global.icodes.IMethod,Inliner.this.NonPublicRefs.Value]">usesNonPublics</a>.<span title="()Unit">clear</span><span class="delimiter">(</span><span class="delimiter">)</span>
      <a href="#381365" title="=&gt; scala.collection.mutable.Map[Inliners.this.global.Symbol,(Boolean, Inliners.this.global.analysis.MethodTFA)]">recentTFAs</a>.<span title="()Unit">clear</span>
      <a href="#381370" title="=&gt; Inliners.this.global.analysis.MTFAGrowable">tfa</a>.<a href="../icode/analysis/TypeFlowAnalysis.scala.html#354567" title="=&gt; scala.collection.mutable.Set[Inliners.this.global.analysis.global.Symbol]">knownUnsafe</a>.<span title="()Unit">clear</span><span class="delimiter">(</span><span class="delimiter">)</span>
      <a href="#381370" title="=&gt; Inliners.this.global.analysis.MTFAGrowable">tfa</a>.<a href="../icode/analysis/TypeFlowAnalysis.scala.html#354569" title="=&gt; scala.collection.mutable.Set[Inliners.this.global.analysis.global.Symbol]">knownSafe</a>.<span title="()Unit">clear</span><span class="delimiter">(</span><span class="delimiter">)</span>
      <a href="#381370" title="=&gt; Inliners.this.global.analysis.MTFAGrowable">tfa</a>.<a href="../icode/analysis/TypeFlowAnalysis.scala.html#354571" title="=&gt; scala.collection.mutable.Set[Inliners.this.global.analysis.global.Symbol]">knownNever</a>.<span title="()Unit">clear</span><span class="delimiter">(</span><span class="delimiter">)</span>
      // basic blocks
      <a href="#381370" title="=&gt; Inliners.this.global.analysis.MTFAGrowable">tfa</a>.<a href="../icode/analysis/TypeFlowAnalysis.scala.html#354555" title="=&gt; scala.collection.mutable.Set[Inliners.this.global.analysis.global.icodes.BasicBlock]">preCandidates</a>.<span title="()Unit">clear</span><span class="delimiter">(</span><span class="delimiter">)</span>
      <a href="#381370" title="=&gt; Inliners.this.global.analysis.MTFAGrowable">tfa</a>.<a href="../icode/analysis/TypeFlowAnalysis.scala.html#354574" title="=&gt; scala.collection.mutable.Set[Inliners.this.global.analysis.global.icodes.BasicBlock]">relevantBBs</a>.<span title="()Unit">clear</span><span class="delimiter">(</span><span class="delimiter">)</span>
      // callsites
      <a href="#381370" title="=&gt; Inliners.this.global.analysis.MTFAGrowable">tfa</a>.<a href="../icode/analysis/TypeFlowAnalysis.scala.html#354553" title="=&gt; scala.collection.mutable.Map[Inliners.this.global.analysis.global.icodes.opcodes.CALL_METHOD,Inliners.this.global.analysis.CallsiteInfo]">remainingCALLs</a>.<span title="()Unit">clear</span><span class="delimiter">(</span><span class="delimiter">)</span>
      <a href="#381370" title="=&gt; Inliners.this.global.analysis.MTFAGrowable">tfa</a>.<a href="../icode/analysis/TypeFlowAnalysis.scala.html#354565" title="=&gt; scala.collection.mutable.Set[Inliners.this.global.analysis.global.icodes.Instruction]">isOnWatchlist</a>.<span title="()Unit">clear</span><span class="delimiter">(</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="(cls: Inliners.this.global.icodes.IClass)Unit" id="381369">analyzeClass</a><span class="delimiter">(</span><a title="Inliners.this.global.icodes.IClass" id="381395">cls</a>: <a href="../icode/Members.scala.html#232636" title="Inliners.this.global.icodes.IClass">IClass</a><span class="delimiter">)</span>: <span title="Unit">Unit</span> =
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../Global.scala.html#186138" title="=&gt; scala.tools.nsc.Settings">settings</a>.<a href="../../settings/ScalaSettings.scala.html#186772" title="=&gt; scala.tools.nsc.Settings#BooleanSetting">inline</a>.<a href="../../settings/MutableSettings.scala.html#187054" title="=&gt; Boolean">value</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="../../Global.scala.html#186189" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><span title="String(&quot;Analyzing &quot;)" class="string">&quot;Analyzing &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#381395" title="Inliners.this.global.icodes.IClass">cls</a><span class="delimiter">)</span>

        <a href="#243223" title="Inliner.this.type" class="keyword">this</a>.<a href="#381362" title="(x$1: Inliners.this.global.icodes.IClass)Unit">currentIClazz</a> = <a href="#381395" title="Inliners.this.global.icodes.IClass">cls</a>
        <span class="keyword">val</span> <a title="List[Inliners.this.global.icodes.IMethod]" id="381499">ms</a> = <a href="#381395" title="Inliners.this.global.icodes.IClass">cls</a>.<a href="../icode/Members.scala.html#232936" title="=&gt; List[Inliners.this.global.icodes.IMethod]">methods</a> <span title="(p: Inliners.this.global.icodes.IMethod =&gt; Boolean)List[Inliners.this.global.icodes.IMethod]">filterNot</span> <span class="delimiter">{</span> <a href="#381509" title="Inliners.this.global.icodes.IMethod">_</a>.<a href="../icode/Members.scala.html#322208" title="=&gt; Inliners.this.global.icodes.global.Symbol">symbol</a>.<a href="../../../../reflect/internal/Symbols.scala.html#46492" title="=&gt; Boolean">isConstructor</a> <span class="delimiter">}</span>
        <a href="#381499" title="List[Inliners.this.global.icodes.IMethod]">ms</a> <span title="(f: Inliners.this.global.icodes.IMethod =&gt; Unit)Unit">foreach</span> <span class="delimiter">{</span> <a title="Inliners.this.global.icodes.IMethod" id="381529">im</a> =&gt;
          <span title="Unit" class="keyword">if</span><span class="delimiter">(</span><a href="#243221" title="(sym: Inliners.this.global.Symbol)Boolean">hasInline</a><span class="delimiter">(</span><a href="#381529" title="Inliners.this.global.icodes.IMethod">im</a>.<a href="../icode/Members.scala.html#322208" title="=&gt; Inliners.this.global.icodes.global.Symbol">symbol</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
            <a href="../../Global.scala.html#186199" title="(msg: =&gt; AnyRef)Unit">log</a><span class="delimiter">(</span><span title="String(&quot;Not inlining into &quot;)" class="string">&quot;Not inlining into &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#381529" title="Inliners.this.global.icodes.IMethod">im</a>.<a href="../icode/Members.scala.html#322208" title="=&gt; Inliners.this.global.icodes.global.Symbol">symbol</a>.<a href="../../../../reflect/internal/Symbols.scala.html#46573" title="=&gt; Inliners.this.global.icodes.global.Name">originalName</a>.<a href="../../../../reflect/internal/Names.scala.html#52171" title="=&gt; String">decode</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; because it is marked @inline.&quot;)" class="string">&quot; because it is marked @inline.&quot;</span><span class="delimiter">)</span>
          <span class="delimiter">}</span> <span class="keyword">else</span> <span title="Unit" class="keyword">if</span><span class="delimiter">(</span><a href="#381529" title="Inliners.this.global.icodes.IMethod">im</a>.<a href="../icode/Members.scala.html#322246" title="=&gt; Boolean">hasCode</a> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <span title="=&gt; Boolean">!</span><a href="#381529" title="Inliners.this.global.icodes.IMethod">im</a>.<a href="../icode/Members.scala.html#322208" title="=&gt; Inliners.this.global.icodes.global.Symbol">symbol</a>.<a href="../../../../reflect/internal/Symbols.scala.html#46453" title="=&gt; Boolean">isBridge</a><span class="delimiter">)</span> <span class="delimiter">{</span>
            <a href="#381378" title="(m: Inliners.this.global.icodes.IMethod)Unit">analyzeMethod</a><span class="delimiter">(</span><a href="#381529" title="Inliners.this.global.icodes.IMethod">im</a><span class="delimiter">)</span>
          <span class="delimiter">}</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>

    <span class="keyword">val</span> <a title="Inliners.this.global.analysis.MTFAGrowable" id="381370">tfa</a>   = <span title="Inliners.this.global.analysis.MTFAGrowable" class="keyword">new</span> <a href="../../Global.scala.html#186159" title="object Inliners.this.global.analysis">analysis</a>.<a href="../icode/analysis/TypeFlowAnalysis.scala.html#239597" title="Inliners.this.global.analysis.MTFAGrowable">MTFAGrowable</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <a href="#381370" title="=&gt; Inliners.this.global.analysis.MTFAGrowable">tfa</a>.<a href="../icode/analysis/DataFlowAnalysis.scala.html#348034" title="(x$1: Boolean)Unit">stat</a>  = <a href="../../SubComponent.scala.html#231956" title="=&gt; scala.tools.nsc.Global">global</a>.<a href="../../Global.scala.html#186204" title="object Inliners.this.global.opt">opt</a>.<a href="../../settings/AestheticSettings.scala.html#232996" title="=&gt; Boolean">printStats</a>
    <span class="keyword">val</span> <a title="scala.collection.mutable.ListBuffer[Inliners.this.global.icodes.BasicBlock]" id="381372">staleOut</a>      = <span title="scala.collection.mutable.ListBuffer[Inliners.this.global.icodes.BasicBlock]" class="keyword">new</span> mutable.<span title="scala.collection.mutable.ListBuffer[Inliners.this.global.icodes.BasicBlock]">ListBuffer</span><span class="delimiter">[</span>BasicBlock<span class="delimiter">]</span>
    <span class="keyword">val</span> <a title="scala.collection.mutable.Set[Inliners.this.global.icodes.BasicBlock]" id="381374">splicedBlocks</a> = mutable.<span title="object scala.collection.mutable.Set">Set</span>.<span title="[A]=&gt; scala.collection.mutable.Set[A]">empty</span><span title="scala.collection.mutable.Set[Inliners.this.global.icodes.BasicBlock]" class="delimiter">[</span><a href="../icode/BasicBlocks.scala.html#232649" title="Inliners.this.global.icodes.BasicBlock">BasicBlock</a><span class="delimiter">]</span>
    <span class="keyword">val</span> <a title="scala.collection.mutable.Set[Inliners.this.global.icodes.BasicBlock]" id="381376">staleIn</a>       = mutable.<span title="object scala.collection.mutable.Set">Set</span>.<span title="[A]=&gt; scala.collection.mutable.Set[A]">empty</span><span title="scala.collection.mutable.Set[Inliners.this.global.icodes.BasicBlock]" class="delimiter">[</span><a href="../icode/BasicBlocks.scala.html#232649" title="Inliners.this.global.icodes.BasicBlock">BasicBlock</a><span class="delimiter">]</span>

    /**
     * A transformation local to the body of the argument.
     * An linining decision consists in replacing a callsite with the body of the callee.
     * Please notice that, because `analyzeMethod()` itself may modify a method body,
     * the particular callee bodies that end up being inlined depend on the particular order in which methods are visited
     * (no topological ordering over the call-graph is attempted).
     *
     * Making an inlining decision requires type-flow information for both caller and callee.
     * Regarding the caller, such information is needed only for basic blocks containing inlining candidates
     * (and their transitive predecessors). This observation leads to using a custom type-flow analysis (MTFAGrowable)
     * that can be re-inited, i.e. that reuses lattice elements (type-flow information) computed in a previous iteration
     * as starting point for faster convergence in a new iteration.
     *
     * The mechanics of inlining are iterative for a given invocation of `analyzeMethod(m)`,
     * thus considering the basic blocks that successful inlining added in a previous iteration:
     *
     *   (1) before the iterations proper start, so-called preinlining is performed.
     *       Those callsites whose (receiver, concreteMethod) are both known statically
     *       can be analyzed for inlining before computing a type-flow. Details in `preInline()`
     *
     *   (2) the first iteration computes type-flow information for basic blocks containing inlining candidates
     *       (and their transitive predecessors), so called `relevantBBs`.
     *       The ensuing analysis of each candidate (performed by `analyzeInc()`)
     *       may result in a CFG isomorphic to that of the callee being inserted where the callsite was
     *       (i.e. a CALL_METHOD instruction is replaced with a single-entry single-exit CFG, which we call &quot;successful inlining&quot;).
     *
     *   (3) following iterations have their relevant basic blocks updated to focus
     *       on the inlined basic blocks and their successors only. Details in `MTFAGrowable.reinit()`
     * */
    <span class="keyword">def</span> <a title="(m: Inliners.this.global.icodes.IMethod)Unit" id="381378">analyzeMethod</a><span class="delimiter">(</span><a title="Inliners.this.global.icodes.IMethod" id="381530">m</a>: <a href="../icode/Members.scala.html#232640" title="Inliners.this.global.icodes.IMethod">IMethod</a><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
      // m.normalize

      <span class="keyword">var</span> <a title="Int" id="381533">sizeBeforeInlining</a>  = <a href="#381530" title="Inliners.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#322211" title="=&gt; Inliners.this.global.icodes.Code">code</a>.<a href="../icode/Members.scala.html#322314" title="=&gt; Int">blockCount</a>
      <span class="keyword">var</span> <a title="Int" id="381534">instrBeforeInlining</a> = <a href="#381530" title="Inliners.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#322211" title="=&gt; Inliners.this.global.icodes.Code">code</a>.<a href="../icode/Members.scala.html#322315" title="=&gt; Int">instructionCount</a>
      <span class="keyword">var</span> <a title="Boolean" id="381535">retry</a> = <span title="Boolean(false)" class="keyword">false</span>
      <span class="keyword">var</span> <a title="Int" id="381536">count</a> = <span title="Int(0)" class="int">0</span>

      // fresh name counter
      <span class="keyword">val</span> <a title="scala.collection.mutable.Map[String,Int]" id="381537">fresh</a> = mutable.<span title="object scala.collection.mutable.HashMap">HashMap</span>.<span title="[A, B]=&gt; scala.collection.mutable.HashMap[A,B]">empty</span><span title="scala.collection.mutable.HashMap[String,Int]" class="delimiter">[</span><span title="String">String</span>, <span title="Int">Int</span><span class="delimiter">]</span> <span title="(d: Int)scala.collection.mutable.Map[String,Int]">withDefaultValue</span> <span title="Int(0)" class="int">0</span>
      // how many times have we already inlined this method here?
      <span class="keyword">val</span> <a title="scala.collection.mutable.Map[Inliners.this.global.Symbol,Int]" id="381538">inlinedMethodCount</a> = mutable.<span title="object scala.collection.mutable.HashMap">HashMap</span>.<span title="[A, B]=&gt; scala.collection.mutable.HashMap[A,B]">empty</span><span title="scala.collection.mutable.HashMap[Inliners.this.global.Symbol,Int]" class="delimiter">[</span><a href="../../../../reflect/internal/Symbols.scala.html#38726" title="Inliners.this.global.Symbol">Symbol</a>, <span title="Int">Int</span><span class="delimiter">]</span> <span title="(d: Int)scala.collection.mutable.Map[Inliners.this.global.Symbol,Int]">withDefaultValue</span> <span title="Int(0)" class="int">0</span>

      <span class="keyword">val</span> <a title="Inliner.this.IMethodInfo" id="381539">caller</a> = <span title="Inliner.this.IMethodInfo" class="keyword">new</span> <a href="#381381" title="Inliner.this.IMethodInfo">IMethodInfo</a><span class="delimiter">(</span><a href="#381530" title="Inliners.this.global.icodes.IMethod">m</a><span class="delimiter">)</span>

      <span class="keyword">def</span> <a title="(isFirstRound: Boolean)Int" id="381540">preInline</a><span class="delimiter">(</span><a title="Boolean" id="381583">isFirstRound</a>: <span title="Boolean">Boolean</span><span class="delimiter">)</span>: <span title="Int">Int</span> = <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="List[Inliners.this.global.icodes.BasicBlock]" id="381584">inputBlocks</a> = <a href="#381539" title="Inliner.this.IMethodInfo">caller</a>.<a href="#381582" title="=&gt; Inliners.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#322218" title="(lin: Inliners.this.global.icodes.Linearizer)List[Inliners.this.global.icodes.BasicBlock]">linearizedBlocks</a><span class="delimiter">(</span><span class="delimiter">)</span>
        <span class="keyword">val</span> <a title="Inliners.this.global.icodes.BasicBlock =&gt; List[Inliners.this.global.icodes.opcodes.CALL_METHOD]" id="381585">callsites</a>: <span title="Inliners.this.global.icodes.BasicBlock =&gt; List[Inliners.this.global.icodes.opcodes.CALL_METHOD]">Function1</span><span class="delimiter">[</span>BasicBlock, List<span class="delimiter">[</span>opcodes.CALL_METHOD<span class="delimiter">]</span><span class="delimiter">]</span> = <span class="delimiter">{</span>
          <span title="Inliners.this.global.icodes.BasicBlock =&gt; List[Inliners.this.global.icodes.opcodes.CALL_METHOD]" class="keyword">if</span><span class="delimiter">(</span><a href="#381583" title="Boolean">isFirstRound</a><span class="delimiter">)</span> <a href="#381370" title="=&gt; Inliners.this.global.analysis.MTFAGrowable">tfa</a>.<a href="../icode/analysis/TypeFlowAnalysis.scala.html#354578" title="(b: Inliners.this.global.analysis.global.icodes.BasicBlock)List[Inliners.this.global.analysis.global.icodes.opcodes.CALL_METHOD]">conclusives</a> <span class="keyword">else</span> <a href="#381370" title="=&gt; Inliners.this.global.analysis.MTFAGrowable">tfa</a>.<a href="../icode/analysis/TypeFlowAnalysis.scala.html#354579" title="(b: Inliners.this.global.analysis.global.icodes.BasicBlock)List[Inliners.this.global.analysis.global.icodes.opcodes.CALL_METHOD]">knownBeforehand</a>
        <span class="delimiter">}</span>
        <a href="#381541" title="(inputBlocks: Traversable[Inliners.this.global.icodes.BasicBlock], callsites: Inliners.this.global.icodes.BasicBlock =&gt; List[Inliners.this.global.icodes.opcodes.CALL_METHOD])Int">inlineWithoutTFA</a><span class="delimiter">(</span><a href="#381584" title="List[Inliners.this.global.icodes.BasicBlock]">inputBlocks</a>, <a href="#381585" title="Inliners.this.global.icodes.BasicBlock =&gt; List[Inliners.this.global.icodes.opcodes.CALL_METHOD]">callsites</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>

      /**
       *  Inline straightforward callsites (those that can be inlined without a TFA).
       *
       *  To perform inlining, all we need to know is listed as formal params in `analyzeInc()`:
       *    - callsite and block containing it
       *    - actual (ie runtime) class of the receiver
       *    - actual (ie runtime) method being invoked
       *    - stack length just before the callsite (to check whether enough arguments have been pushed).
       *  The assert below lists the conditions under which &quot;no TFA is needed&quot;
       *  (the statically known receiver and method are both final, thus, at runtime they can't be any others than those).
       *
       */
      <span class="keyword">def</span> <a title="(inputBlocks: Traversable[Inliners.this.global.icodes.BasicBlock], callsites: Inliners.this.global.icodes.BasicBlock =&gt; List[Inliners.this.global.icodes.opcodes.CALL_METHOD])Int" id="381541">inlineWithoutTFA</a><span class="delimiter">(</span><a title="Traversable[Inliners.this.global.icodes.BasicBlock]" id="381593">inputBlocks</a>: <span title="Traversable[Inliners.this.global.icodes.BasicBlock]">Traversable</span><span class="delimiter">[</span>BasicBlock<span class="delimiter">]</span>, <a title="Inliners.this.global.icodes.BasicBlock =&gt; List[Inliners.this.global.icodes.opcodes.CALL_METHOD]" id="381594">callsites</a>: <span title="Inliners.this.global.icodes.BasicBlock =&gt; List[Inliners.this.global.icodes.opcodes.CALL_METHOD]">Function1</span><span class="delimiter">[</span>BasicBlock, List<span class="delimiter">[</span>opcodes.CALL_METHOD<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span>: <span title="Int">Int</span> = <span class="delimiter">{</span>
        <span class="keyword">var</span> <a title="Int" id="381595">inlineCount</a> = <span title="Int(0)" class="int">0</span>
        <span class="keyword">import</span> scala.util.control.<span title="object scala.util.control.Breaks">Breaks</span>._
        <span class="keyword">for</span><span class="delimiter">(</span><a title="Inliners.this.global.icodes.BasicBlock" id="381679">x</a> &lt;- <a href="#381593" title="(f: Inliners.this.global.icodes.BasicBlock =&gt; (Inliners.this.global.icodes.BasicBlock, List[Inliners.this.global.icodes.opcodes.CALL_METHOD]))(implicit bf: scala.collection.generic.CanBuildFrom[Traversable[Inliners.this.global.icodes.BasicBlock],(Inliners.this.global.icodes.BasicBlock, List[Inliners.this.global.icodes.opcodes.CALL_METHOD]),Traversable[(Inliners.this.global.icodes.BasicBlock, List[Inliners.this.global.icodes.opcodes.CALL_METHOD])]])Traversable[(Inliners.this.global.icodes.BasicBlock, List[Inliners.this.global.icodes.opcodes.CALL_METHOD])]">inputBlocks</a>; <span class="keyword">val</span> <a title="List[Inliners.this.global.icodes.opcodes.CALL_METHOD]" id="381680">easyCake</a> = <a href="#381594" title="(v1: Inliners.this.global.icodes.BasicBlock)List[Inliners.this.global.icodes.opcodes.CALL_METHOD]">callsites</a><span class="delimiter">(</span><a href="#381679" title="Inliners.this.global.icodes.BasicBlock">x</a><span class="delimiter">)</span>; <span class="keyword">if</span> <a href="#381680" title="List[Inliners.this.global.icodes.opcodes.CALL_METHOD]">easyCake</a>.<span title="=&gt; Boolean">nonEmpty</span><span class="delimiter">)</span> <span class="delimiter">{</span>
          <span title="(op: =&gt; Unit)Unit">breakable</span> <span class="delimiter">{</span>
            <span class="keyword">for</span><span class="delimiter">(</span><a title="Inliners.this.global.icodes.opcodes.CALL_METHOD" id="381700">ocm</a> &lt;- <a href="#381680" title="(f: Inliners.this.global.icodes.opcodes.CALL_METHOD =&gt; Unit)Unit">easyCake</a><span class="delimiter">)</span> <span class="delimiter">{</span>
              <a href="../../Global.scala.html#186184" title="(assertion: Boolean)Unit">assert</a><span class="delimiter">(</span><a href="#381700" title="Inliners.this.global.icodes.opcodes.CALL_METHOD">ocm</a>.<a href="../icode/Opcodes.scala.html#332762" title="=&gt; Inliners.this.global.icodes.global.Symbol">method</a>.<a href="../../../../reflect/internal/Symbols.scala.html#46549" title="=&gt; Boolean">isEffectivelyFinal</a> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#381700" title="Inliners.this.global.icodes.opcodes.CALL_METHOD">ocm</a>.<a href="../icode/Opcodes.scala.html#332762" title="=&gt; Inliners.this.global.icodes.global.Symbol">method</a>.<a href="../../../../reflect/internal/Symbols.scala.html#46564" title="=&gt; Inliners.this.global.icodes.global.Symbol">owner</a>.<a href="../../../../reflect/internal/Symbols.scala.html#46549" title="=&gt; Boolean">isEffectivelyFinal</a><span class="delimiter">)</span>
              <span title="Unit" class="keyword">if</span><span class="delimiter">(</span><a href="#381542" title="(i: Inliners.this.global.icodes.opcodes.CALL_METHOD, bb: Inliners.this.global.icodes.BasicBlock, receiver: Inliners.this.global.Symbol, stackLength: Int, concreteMethod: Inliners.this.global.Symbol)Boolean">analyzeInc</a><span class="delimiter">(</span><a href="#381700" title="Inliners.this.global.icodes.opcodes.CALL_METHOD">ocm</a>, <a href="#381679" title="Inliners.this.global.icodes.BasicBlock">x</a>, <a href="#381700" title="Inliners.this.global.icodes.opcodes.CALL_METHOD">ocm</a>.<a href="../icode/Opcodes.scala.html#332762" title="=&gt; Inliners.this.global.icodes.global.Symbol">method</a>.<a href="../../../../reflect/internal/Symbols.scala.html#46564" title="=&gt; Inliners.this.global.icodes.global.Symbol">owner</a>, -<span title="Int(-1)" class="int">1</span>, <a href="#381700" title="Inliners.this.global.icodes.opcodes.CALL_METHOD">ocm</a>.<a href="../icode/Opcodes.scala.html#332762" title="=&gt; Inliners.this.global.icodes.global.Symbol">method</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
                <a href="#381595" title="Int">inlineCount</a> <span title="(x: Int)Int">+=</span> <span title="Int(1)" class="int">1</span>
                <span title="()Unit">break</span>
              <span class="delimiter">}</span>
            <span class="delimiter">}</span>
          <span class="delimiter">}</span>
        <span class="delimiter">}</span>

        <a href="#381595" title="Int">inlineCount</a>
      <span class="delimiter">}</span>

      /**
          Decides whether it's feasible and desirable to inline the body of the method given by `concreteMethod`
          at the program point given by `i` (a callsite). The boolean result indicates whether inlining was performed.

       */
      <span class="keyword">def</span> <a title="(i: Inliners.this.global.icodes.opcodes.CALL_METHOD, bb: Inliners.this.global.icodes.BasicBlock, receiver: Inliners.this.global.Symbol, stackLength: Int, concreteMethod: Inliners.this.global.Symbol)Boolean" id="381542">analyzeInc</a><span class="delimiter">(</span><a title="Inliners.this.global.icodes.opcodes.CALL_METHOD" id="381704">i</a>: <a href="../icode/Opcodes.scala.html#244532" title="Inliners.this.global.icodes.opcodes.CALL_METHOD">CALL_METHOD</a>, <a title="Inliners.this.global.icodes.BasicBlock" id="381705">bb</a>: <a href="../icode/BasicBlocks.scala.html#232649" title="Inliners.this.global.icodes.BasicBlock">BasicBlock</a>, <a title="Inliners.this.global.Symbol" id="381706">receiver</a>: <a href="../../../../reflect/internal/Symbols.scala.html#38726" title="Inliners.this.global.Symbol">Symbol</a>, <a title="Int" id="381707">stackLength</a>: <span title="Int">Int</span>, <a title="Inliners.this.global.Symbol" id="381708">concreteMethod</a>: <a href="../../../../reflect/internal/Symbols.scala.html#38726" title="Inliners.this.global.Symbol">Symbol</a><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> = <span class="delimiter">{</span>
        <span class="keyword">var</span> <a title="Boolean" id="381717">inlined</a> = <span title="Boolean(false)" class="keyword">false</span>
        <span class="keyword">val</span> <a title="Inliners.this.global.icodes.global.Symbol" id="381718">msym</a> = <a href="#381704" title="Inliners.this.global.icodes.opcodes.CALL_METHOD">i</a>.<a href="../icode/Opcodes.scala.html#332762" title="=&gt; Inliners.this.global.icodes.global.Symbol">method</a>

        <span class="keyword">def</span> <a title="(reason: String)Unit" id="381719">warnNoInline</a><span class="delimiter">(</span><a title="String" id="381724">reason</a>: <span title="String">String</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#243221" title="(sym: Inliners.this.global.Symbol)Boolean">hasInline</a><span class="delimiter">(</span><a href="#381718" title="Inliners.this.global.icodes.global.Symbol">msym</a><span class="delimiter">)</span> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <span title="=&gt; Boolean">!</span><a href="#381539" title="Inliner.this.IMethodInfo">caller</a>.<a href="#381560" title="=&gt; Boolean">isBridge</a><span class="delimiter">)</span>
            <a href="#381364" title="(pos: Inliners.this.global.Position, msg: String)Unit">warn</a><span class="delimiter">(</span><a href="#381704" title="Inliners.this.global.icodes.opcodes.CALL_METHOD">i</a>.<a href="../icode/Opcodes.scala.html#322688" title="=&gt; scala.tools.nsc.util.Position">pos</a>, <span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;Could not inline required method %s because %s.&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#381718" title="Inliners.this.global.icodes.global.Symbol">msym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#46573" title="=&gt; Inliners.this.global.icodes.global.Name">originalName</a>.<a href="../../../../reflect/internal/Names.scala.html#52171" title="=&gt; String">decode</a>, <a href="#381724" title="String">reason</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>

        <span class="keyword">def</span> <a title="=&gt; Boolean" id="381720">isAvailable</a> = <a href="../../Global.scala.html#186153" title="object Inliners.this.global.icodes">icodes</a> <a href="../icode/Repository.scala.html#232825" title="(sym: Inliners.this.global.icodes.global.Symbol)Boolean">available</a> <a href="#381708" title="Inliners.this.global.Symbol">concreteMethod</a>.<a href="../../../../reflect/internal/Symbols.scala.html#46662" title="=&gt; Inliners.this.global.Symbol">enclClass</a>

        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#381720" title="=&gt; Boolean">isAvailable</a> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#381380" title="(sym: Inliners.this.global.Symbol, receiver: Inliners.this.global.Symbol)Boolean">shouldLoadImplFor</a><span class="delimiter">(</span><a href="#381708" title="Inliners.this.global.Symbol">concreteMethod</a>, <a href="#381706" title="Inliners.this.global.Symbol">receiver</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
          // Until r22824 this line was:
          //   icodes.icode(concreteMethod.enclClass, true)
          //
          // Changing it to
          //   icodes.load(concreteMethod.enclClass)
          // was the proximate cause for SI-3882:
          //   error: Illegal index: 0 overlaps List((variable par1,LONG))
          //   error: Illegal index: 0 overlaps List((variable par1,LONG))
          <a href="../../Global.scala.html#186153" title="object Inliners.this.global.icodes">icodes</a>.<a href="../icode/Repository.scala.html#232828" title="(sym: Inliners.this.global.icodes.global.Symbol)Unit">load</a><span class="delimiter">(</span><a href="#381708" title="Inliners.this.global.Symbol">concreteMethod</a>.<a href="../../../../reflect/internal/Symbols.scala.html#46662" title="=&gt; Inliners.this.global.Symbol">enclClass</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>

        <span class="keyword">def</span> <a title="=&gt; Boolean" id="381721">isCandidate</a> = <span class="delimiter">(</span>
             <a href="#243219" title="(cls: Inliners.this.global.Symbol)Boolean">isClosureClass</a><span class="delimiter">(</span><a href="#381706" title="Inliners.this.global.Symbol">receiver</a><span class="delimiter">)</span>
          <span title="(x: Boolean)Boolean">||</span> <a href="#381708" title="Inliners.this.global.Symbol">concreteMethod</a>.<a href="../../../../reflect/internal/Symbols.scala.html#46549" title="=&gt; Boolean">isEffectivelyFinal</a>
          <span title="(x: Boolean)Boolean">||</span> <a href="#381706" title="Inliners.this.global.Symbol">receiver</a>.<a href="../../../../reflect/internal/Symbols.scala.html#46549" title="=&gt; Boolean">isEffectivelyFinal</a>
        <span class="delimiter">)</span>
        <span class="keyword">def</span> <a title="=&gt; Boolean" id="381722">isApply</a>     = <a href="#381708" title="Inliners.this.global.Symbol">concreteMethod</a>.<a href="../../../../reflect/internal/Symbols.scala.html#46571" title="=&gt; Inliners.this.global.Name">name</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../../../reflect/internal/StdNames.scala.html#39313" title="object Inliners.this.global.nme">nme</a>.<a href="../../../../reflect/internal/StdNames.scala.html#59070" title="=&gt; Inliners.this.global.nme.NameType">apply</a>
        <span class="keyword">def</span> <a title="=&gt; Boolean" id="381723">isCountable</a> = <span title="=&gt; Boolean">!</span><span class="delimiter">(</span>
             <a href="#243219" title="(cls: Inliners.this.global.Symbol)Boolean">isClosureClass</a><span class="delimiter">(</span><a href="#381706" title="Inliners.this.global.Symbol">receiver</a><span class="delimiter">)</span>
          <span title="(x: Boolean)Boolean">||</span> <a href="#381722" title="=&gt; Boolean">isApply</a>
          <span title="(x: Boolean)Boolean">||</span> <a href="#243220" title="(sym: Inliners.this.global.Symbol)Boolean">isMonadicMethod</a><span class="delimiter">(</span><a href="#381708" title="Inliners.this.global.Symbol">concreteMethod</a><span class="delimiter">)</span>
          <span title="(x: Boolean)Boolean">||</span> <a href="#381706" title="Inliners.this.global.Symbol">receiver</a>.<a href="../../../../reflect/internal/Symbols.scala.html#46685" title="=&gt; Inliners.this.global.Symbol">enclosingPackage</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../../../reflect/internal/Definitions.scala.html#39224" title="object Inliners.this.global.definitions">definitions</a>.<a href="../../../../reflect/internal/Definitions.scala.html#44964" title="=&gt; Inliners.this.global.Symbol">RuntimePackage</a>
        <span class="delimiter">)</span>   // only count non-closures

        <a href="../../Global.scala.html#186189" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><span title="String(&quot;Treating &quot;)" class="string">&quot;Treating &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#381704" title="Inliners.this.global.icodes.opcodes.CALL_METHOD">i</a>
              <span title="(x$1: Any)String">+</span> <span title="String(&quot;\n\treceiver: &quot;)" class="string">&quot;\n\treceiver: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#381706" title="Inliners.this.global.Symbol">receiver</a>
              <span title="(x$1: Any)String">+</span> <span title="String(&quot;\n\ticodes.available: &quot;)" class="string">&quot;\n\ticodes.available: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#381720" title="=&gt; Boolean">isAvailable</a>
              <span title="(x$1: Any)String">+</span> <span title="String(&quot;\n\tconcreteMethod.isEffectivelyFinal: &quot;)" class="string">&quot;\n\tconcreteMethod.isEffectivelyFinal: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#381708" title="Inliners.this.global.Symbol">concreteMethod</a>.<a href="../../../../reflect/internal/Symbols.scala.html#46549" title="=&gt; Boolean">isEffectivelyFinal</a><span class="delimiter">)</span>

        <span title="Any" class="keyword">if</span> <span class="delimiter">(</span><a href="#381720" title="=&gt; Boolean">isAvailable</a> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#381721" title="=&gt; Boolean">isCandidate</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="#381383" title="(meth: Inliners.this.global.Symbol, receiver: Inliners.this.global.Symbol)Option[Inliners.this.global.icodes.IMethod]">lookupIMethod</a><span class="delimiter">(</span><a href="#381708" title="Inliners.this.global.Symbol">concreteMethod</a>, <a href="#381706" title="Inliners.this.global.Symbol">receiver</a><span class="delimiter">)</span> <span title="Any" class="keyword">match</span> <span class="delimiter">{</span>
            <span class="keyword">case</span> <span title="Any">Some</span><span class="delimiter">(</span><a title="Inliners.this.global.icodes.IMethod" id="381750">callee</a><span class="delimiter">)</span> =&gt;
              <span class="keyword">val</span> <a title="Inliner.this.IMethodInfo" id="381751">inc</a>   = <span title="Inliner.this.IMethodInfo" class="keyword">new</span> <a href="#381381" title="Inliner.this.IMethodInfo">IMethodInfo</a><span class="delimiter">(</span><a href="#381750" title="Inliners.this.global.icodes.IMethod">callee</a><span class="delimiter">)</span>
              <span class="keyword">val</span> <a title="Inliner.this.CallerCalleeInfo" id="381752">pair</a>  = <span title="Inliner.this.CallerCalleeInfo" class="keyword">new</span> <a href="#381382" title="Inliner.this.CallerCalleeInfo">CallerCalleeInfo</a><span class="delimiter">(</span><a href="#381539" title="Inliner.this.IMethodInfo">caller</a>, <a href="#381751" title="Inliner.this.IMethodInfo">inc</a>, <a href="#381537" title="scala.collection.mutable.Map[String,Int]">fresh</a>, <a href="#381538" title="scala.collection.mutable.Map[Inliners.this.global.Symbol,Int]">inlinedMethodCount</a><span class="delimiter">)</span>

              <span title="Any" class="keyword">if</span> <span class="delimiter">(</span><a href="#381752" title="Inliner.this.CallerCalleeInfo">pair</a> <a href="#381767" title="(stackLength: Int)Boolean">isStampedForInlining</a> <a href="#381707" title="Int">stackLength</a><span class="delimiter">)</span> <span class="delimiter">{</span>
                <a href="#381535" title="Boolean">retry</a> = <span title="Boolean(true)" class="keyword">true</span>
                <a href="#381717" title="Boolean">inlined</a> = <span title="Boolean(true)" class="keyword">true</span>
                <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#381723" title="=&gt; Boolean">isCountable</a><span class="delimiter">)</span>
                  <a href="#381536" title="Int">count</a> <span title="(x: Int)Int">+=</span> <span title="Int(1)" class="int">1</span>

                <a href="#381752" title="Inliner.this.CallerCalleeInfo">pair</a>.<a href="#381766" title="(block: Inliners.this.global.icodes.BasicBlock, instr: Inliners.this.global.icodes.opcodes.CALL_METHOD)Unit">doInline</a><span class="delimiter">(</span><a href="#381705" title="Inliners.this.global.icodes.BasicBlock">bb</a>, <a href="#381704" title="Inliners.this.global.icodes.opcodes.CALL_METHOD">i</a><span class="delimiter">)</span>
                <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#381751" title="Inliner.this.IMethodInfo">inc</a>.<a href="#381558" title="=&gt; Boolean">inline</a> <span title="(x: Boolean)Boolean">||</span> <a href="#381751" title="Inliner.this.IMethodInfo">inc</a>.<a href="#381564" title="=&gt; Boolean">isMonadic</a><span class="delimiter">)</span>
                  <a href="#381539" title="Inliner.this.IMethodInfo">caller</a>.<a href="#381577" title="(x$1: Int)Unit">inlinedCalls</a> <span title="(x: Int)Int">+=</span> <span title="Int(1)" class="int">1</span>
                <a href="#381538" title="(key: Inliners.this.global.Symbol, value: Int)Unit">inlinedMethodCount</a><span class="delimiter">(</span><a href="#381751" title="Inliner.this.IMethodInfo">inc</a>.<a href="#381551" title="=&gt; Inliners.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span> <span title="(x: Int)Int">+=</span> <span title="Int(1)" class="int">1</span>

                /* Remove this method from the cache, as the calls-private relation
                 * might have changed after the inlining.
                 */
                <a href="#381403" title="=&gt; scala.collection.mutable.Map[Inliners.this.global.icodes.IMethod,Inliner.this.NonPublicRefs.Value]">usesNonPublics</a> <span title="(key: Inliners.this.global.icodes.IMethod)Inliner.this.NonPublicRefs.usesNonPublics.type">-=</span> <a href="#381530" title="Inliners.this.global.icodes.IMethod">m</a>
                <a href="#381365" title="=&gt; scala.collection.mutable.Map[Inliners.this.global.Symbol,(Boolean, Inliners.this.global.analysis.MethodTFA)]">recentTFAs</a>     <span title="(key: Inliners.this.global.Symbol)Inliner.this.recentTFAs.type">-=</span> <a href="#381530" title="Inliners.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#322208" title="=&gt; Inliners.this.global.icodes.global.Symbol">symbol</a>
              <span class="delimiter">}</span>
              <span class="keyword">else</span> <span class="delimiter">{</span>
                <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../Global.scala.html#186138" title="=&gt; scala.tools.nsc.Settings">settings</a>.<a href="../../settings/ScalaSettings.scala.html#186768" title="=&gt; scala.tools.nsc.Settings#BooleanSetting">debug</a>.<a href="../../settings/MutableSettings.scala.html#187054" title="=&gt; Boolean">value</a><span class="delimiter">)</span>
                  <a href="#381752" title="Inliner.this.CallerCalleeInfo">pair</a> <a href="#381768" title="(stackLength: Int)Unit">logFailure</a> <a href="#381707" title="Int">stackLength</a>

                <a href="#381719" title="(reason: String)Unit">warnNoInline</a><span class="delimiter">(</span><a href="#381752" title="Inliner.this.CallerCalleeInfo">pair</a> <a href="#381769" title="(stackLength: Int)String">failureReason</a> <a href="#381707" title="Int">stackLength</a><span class="delimiter">)</span>
              <span class="delimiter">}</span>
            <span class="keyword">case</span> <span title="Unit">None</span> =&gt;
              <a href="#381719" title="(reason: String)Unit">warnNoInline</a><span class="delimiter">(</span><span title="String(&quot;bytecode was not available&quot;)" class="string">&quot;bytecode was not available&quot;</span><span class="delimiter">)</span>
              <a href="../../Global.scala.html#186189" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><span title="String(&quot;could not find icode\n\treceiver: &quot;)" class="string">&quot;could not find icode\n\treceiver: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#381706" title="Inliners.this.global.Symbol">receiver</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;\n\tmethod: &quot;)" class="string">&quot;\n\tmethod: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#381708" title="Inliners.this.global.Symbol">concreteMethod</a><span class="delimiter">)</span>
          <span class="delimiter">}</span>
        <span class="delimiter">}</span>
        <span class="keyword">else</span> <a href="#381719" title="(reason: String)Unit">warnNoInline</a><span class="delimiter">(</span>
          <span title="String" class="keyword">if</span> <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#381720" title="=&gt; Boolean">isAvailable</a><span class="delimiter">)</span> <span title="String(&quot;bytecode was not available&quot;)" class="string">&quot;bytecode was not available&quot;</span>
          <span class="keyword">else</span> <span title="String(&quot;it can be overridden&quot;)" class="string">&quot;it can be overridden&quot;</span>
        <span class="delimiter">)</span>

        <a href="#381717" title="Boolean">inlined</a>
      <span class="delimiter">}</span>

      /* Pre-inlining consists in invoking the usual inlining subroutine with (receiver class, concrete method) pairs as input
       * where both method and receiver are final, which implies that the receiver computed via TFA will always match `concreteMethod.owner`.
       *
       * As with any invocation of `analyzeInc()` the inlining outcome is based on heuristics which favor inlining an isMonadicMethod before other methods.
       * That's why preInline() is invoked twice: any inlinings downplayed by the heuristics during the first round get an opportunity to rank higher during the second.
       *
       * As a whole, both `preInline()` invocations amount to priming the inlining process,
       * so that the first TFA run afterwards is able to gain more information as compared to a cold-start.
       */
      <span class="keyword">val</span> <a title="Int" id="381543">totalPreInlines</a> = <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="Int" id="381942">firstRound</a> = <a href="#381540" title="(isFirstRound: Boolean)Int">preInline</a><span class="delimiter">(</span><span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span>
        <span title="Int" class="keyword">if</span><span class="delimiter">(</span><a href="#381942" title="Int">firstRound</a> <span title="(x: Int)Boolean">==</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span title="Int(0)" class="int">0</span> <span class="keyword">else</span> <span class="delimiter">(</span><a href="#381942" title="Int">firstRound</a> <span title="(x: Int)Int">+</span> <a href="#381540" title="(isFirstRound: Boolean)Int">preInline</a><span class="delimiter">(</span><span title="Boolean(false)" class="keyword">false</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
      <a href="#381372" title="=&gt; scala.collection.mutable.ListBuffer[Inliners.this.global.icodes.BasicBlock]">staleOut</a>.<span title="()Unit">clear</span><span class="delimiter">(</span><span class="delimiter">)</span>
      <a href="#381374" title="=&gt; scala.collection.mutable.Set[Inliners.this.global.icodes.BasicBlock]">splicedBlocks</a>.<span title="()Unit">clear</span><span class="delimiter">(</span><span class="delimiter">)</span>
      <a href="#381376" title="=&gt; scala.collection.mutable.Set[Inliners.this.global.icodes.BasicBlock]">staleIn</a>.<span title="()Unit">clear</span><span class="delimiter">(</span><span class="delimiter">)</span>

      <a href="#381544" title="Unit" class="keyword">do</a> <span class="delimiter">{</span>
        <a href="#381535" title="Boolean">retry</a> = <span title="Boolean(false)" class="keyword">false</span>
        <a href="../../Global.scala.html#186199" title="(msg: =&gt; AnyRef)Unit">log</a><span class="delimiter">(</span><span title="String(&quot;Analyzing &quot;)" class="string">&quot;Analyzing &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#381530" title="Inliners.this.global.icodes.IMethod">m</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; count &quot;)" class="string">&quot; count &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#381536" title="Int">count</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; with &quot;)" class="string">&quot; with &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#381539" title="Inliner.this.IMethodInfo">caller</a>.<a href="#381568" title="=&gt; Int">length</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; blocks&quot;)" class="string">&quot; blocks&quot;</span><span class="delimiter">)</span>

        /* it's important not to inline in unreachable basic blocks. linearizedBlocks() returns only reachable ones. */
        <a href="#381370" title="=&gt; Inliners.this.global.analysis.MTFAGrowable">tfa</a>.<a href="../icode/analysis/TypeFlowAnalysis.scala.html#354558" title="(x$1: Traversable[Inliners.this.global.analysis.global.icodes.BasicBlock])Unit">callerLin</a> = <a href="#381539" title="Inliner.this.IMethodInfo">caller</a>.<a href="#381582" title="=&gt; Inliners.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#322218" title="(lin: Inliners.this.global.icodes.Linearizer)List[Inliners.this.global.icodes.BasicBlock]">linearizedBlocks</a><span class="delimiter">(</span><span class="delimiter">)</span>
           /* TODO Do we want to perform inlining in non-finally exception handlers?
           *  Seems counterproductive (the larger the method the less likely it will be JITed).
            * The alternative above would be `linearizer.linearizeAt(caller.m, caller.m.startBlock)`.
            * See also comment on the same topic in TypeFlowAnalysis. */

        <a href="#381370" title="=&gt; Inliners.this.global.analysis.MTFAGrowable">tfa</a>.<a href="../icode/analysis/TypeFlowAnalysis.scala.html#354592" title="(m: Inliners.this.global.analysis.global.icodes.IMethod, staleOut: List[Inliners.this.global.analysis.global.icodes.BasicBlock], inlined: scala.collection.Set[Inliners.this.global.analysis.global.icodes.BasicBlock], staleIn: scala.collection.Set[Inliners.this.global.analysis.global.icodes.BasicBlock])Unit">reinit</a><span class="delimiter">(</span><a href="#381530" title="Inliners.this.global.icodes.IMethod">m</a>, <a href="#381372" title="=&gt; scala.collection.mutable.ListBuffer[Inliners.this.global.icodes.BasicBlock]">staleOut</a>.<span title="=&gt; List[Inliners.this.global.icodes.BasicBlock]">toList</span>, <a href="#381374" title="=&gt; scala.collection.mutable.Set[Inliners.this.global.icodes.BasicBlock]">splicedBlocks</a>, <a href="#381376" title="=&gt; scala.collection.mutable.Set[Inliners.this.global.icodes.BasicBlock]">staleIn</a><span class="delimiter">)</span>
        <a href="#381370" title="=&gt; Inliners.this.global.analysis.MTFAGrowable">tfa</a>.<a href="../icode/analysis/TypeFlowAnalysis.scala.html#354560" title="()Unit">run</a>
        <a href="#381372" title="=&gt; scala.collection.mutable.ListBuffer[Inliners.this.global.icodes.BasicBlock]">staleOut</a>.<span title="()Unit">clear</span><span class="delimiter">(</span><span class="delimiter">)</span>
        <a href="#381374" title="=&gt; scala.collection.mutable.Set[Inliners.this.global.icodes.BasicBlock]">splicedBlocks</a>.<span title="()Unit">clear</span><span class="delimiter">(</span><span class="delimiter">)</span>
        <a href="#381376" title="=&gt; scala.collection.mutable.Set[Inliners.this.global.icodes.BasicBlock]">staleIn</a>.<span title="()Unit">clear</span><span class="delimiter">(</span><span class="delimiter">)</span>

        <span class="keyword">import</span> scala.util.control.<span title="object scala.util.control.Breaks">Breaks</span>._
        <span class="keyword">for</span><span class="delimiter">(</span><a title="Inliners.this.global.analysis.global.icodes.BasicBlock" id="381997">bb</a> &lt;- <a href="#381370" title="=&gt; Inliners.this.global.analysis.MTFAGrowable">tfa</a>.<a href="../icode/analysis/TypeFlowAnalysis.scala.html#354557" title="(f: Inliners.this.global.analysis.global.icodes.BasicBlock =&gt; Unit)Unit">callerLin</a>; <span class="keyword">if</span> <a href="#381370" title="=&gt; Inliners.this.global.analysis.MTFAGrowable">tfa</a>.<a href="../icode/analysis/TypeFlowAnalysis.scala.html#354555" title="(elem: Inliners.this.global.analysis.global.icodes.BasicBlock)Boolean">preCandidates</a><span class="delimiter">(</span><a href="#381997" title="Inliners.this.global.analysis.global.icodes.BasicBlock">bb</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
          <span class="keyword">val</span> <a title="List[Inliners.this.global.icodes.opcodes.CALL_METHOD]" id="381998">cms</a> = <a href="#381997" title="Inliners.this.global.analysis.global.icodes.BasicBlock">bb</a>.<a href="../icode/BasicBlocks.scala.html#322151" title="=&gt; List[Inliners.this.global.analysis.global.icodes.Instruction]">toList</a> <span title="(pf: PartialFunction[Inliners.this.global.analysis.global.icodes.Instruction,Inliners.this.global.icodes.opcodes.CALL_METHOD])(implicit bf: scala.collection.generic.CanBuildFrom[List[Inliners.this.global.analysis.global.icodes.Instruction],Inliners.this.global.icodes.opcodes.CALL_METHOD,List[Inliners.this.global.icodes.opcodes.CALL_METHOD]])List[Inliners.this.global.icodes.opcodes.CALL_METHOD]">collect</span> <a href="#382018" title="Inliners.this.global.icodes.opcodes.CALL_METHOD" class="delimiter">{</a> <span class="keyword">case</span> <a title="Inliners.this.global.icodes.opcodes.CALL_METHOD" id="382019">cm</a> : <a href="../icode/Opcodes.scala.html#244532" title="Inliners.this.global.icodes.opcodes.CALL_METHOD">CALL_METHOD</a> =&gt; <a href="#382019" title="Inliners.this.global.icodes.opcodes.CALL_METHOD">cm</a> <span class="delimiter">}</span>
          <span title="(op: =&gt; Unit)Unit">breakable</span> <span class="delimiter">{</span>
            <span class="keyword">for</span> <span class="delimiter">(</span><a title="Inliners.this.global.icodes.opcodes.CALL_METHOD" id="382058">cm</a> &lt;- <a href="#381998" title="(f: Inliners.this.global.icodes.opcodes.CALL_METHOD =&gt; Unit)Unit">cms</a>; <span class="keyword">if</span> <a href="#381370" title="=&gt; Inliners.this.global.analysis.MTFAGrowable">tfa</a>.<a href="../icode/analysis/TypeFlowAnalysis.scala.html#354553" title="=&gt; scala.collection.mutable.Map[Inliners.this.global.analysis.global.icodes.opcodes.CALL_METHOD,Inliners.this.global.analysis.CallsiteInfo]">remainingCALLs</a>.<span title="(key: Inliners.this.global.analysis.global.icodes.opcodes.CALL_METHOD)Boolean">isDefinedAt</span><span class="delimiter">(</span><a href="#382058" title="Inliners.this.global.icodes.opcodes.CALL_METHOD">cm</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
              <span class="keyword">val</span> analysis.CallsiteInfo<a href="#382060" title="(Inliners.this.global.analysis.global.Symbol, Int, Inliners.this.global.analysis.global.Symbol)" class="delimiter">(</a>_, <a href="#382059" title="Inliners.this.global.analysis.global.Symbol" id="382060">receiver</a>, <a href="#382059" title="Int" id="382061">stackLength</a>, <a href="#382059" title="Inliners.this.global.analysis.global.Symbol" id="382062">concreteMethod</a><span class="delimiter">)</span> = <a href="#381370" title="=&gt; Inliners.this.global.analysis.MTFAGrowable">tfa</a>.<a href="../icode/analysis/TypeFlowAnalysis.scala.html#354553" title="(key: Inliners.this.global.analysis.global.icodes.opcodes.CALL_METHOD)Inliners.this.global.analysis.CallsiteInfo">remainingCALLs</a><a href="../icode/analysis/TypeFlowAnalysis.scala.html#239594" title="Inliners.this.global.analysis.CallsiteInfo @unchecked" class="delimiter">(</a><a href="#382058" title="Inliners.this.global.icodes.opcodes.CALL_METHOD">cm</a><span class="delimiter">)</span>
              <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#381542" title="(i: Inliners.this.global.icodes.opcodes.CALL_METHOD, bb: Inliners.this.global.icodes.BasicBlock, receiver: Inliners.this.global.Symbol, stackLength: Int, concreteMethod: Inliners.this.global.Symbol)Boolean">analyzeInc</a><span class="delimiter">(</span><a href="#382058" title="Inliners.this.global.icodes.opcodes.CALL_METHOD">cm</a>, <a href="#381997" title="Inliners.this.global.analysis.global.icodes.BasicBlock">bb</a>, <a href="#382060" title="Inliners.this.global.analysis.global.Symbol">receiver</a>, <a href="#382061" title="Int">stackLength</a>, <a href="#382062" title="Inliners.this.global.analysis.global.Symbol">concreteMethod</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
                <span title="()Unit">break</span>
              <span class="delimiter">}</span>
            <span class="delimiter">}</span>
          <span class="delimiter">}</span>
        <span class="delimiter">}</span>

        /* As part of inlining, some instructions are moved to a new block.
         *     In detail: the instructions moved to a new block originally appeared after a (by now inlined) callsite.
         *     Their new home is an `afterBlock` created by `doInline()` to that effect.
         *     Each block in staleIn is one such `afterBlock`.
         *
         * Some of those instructions may be CALL_METHOD possibly tracked in `remainingCALLs`
         * (with an entry still noting the old containing block). However, that causes no problem:
         *
         *   (1) such callsites won't be analyzed for inlining by `analyzeInc()` (*in this iteration*)
         *       because of the `break` that abandons the original basic block where it was contained.
         *
         *   (2) Additionally, its new containing block won't be visited either (*in this iteration*)
         *       because the new blocks don't show up in the linearization computed before inlinings started:
         *       `for(bb &lt;- tfa.callerLin; if tfa.preCandidates(bb)) {`
         *
         * For a next iteration, the new home of any instructions that have moved
         * will be tracked properly in `remainingCALLs` after `MTFAGrowable.reinit()` puts on radar their new homes.
         *
         */
        <span title="Unit" class="keyword">if</span><span class="delimiter">(</span><a href="#381535" title="Boolean">retry</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <span class="keyword">for</span><span class="delimiter">(</span><a title="Inliners.this.global.icodes.BasicBlock" id="382120">afterBlock</a> &lt;- <a href="#381376" title="(f: Inliners.this.global.icodes.BasicBlock =&gt; Unit)Unit">staleIn</a><span class="delimiter">)</span> <span class="delimiter">{</span>
            <span class="keyword">val</span> <a title="List[Inliners.this.global.icodes.opcodes.CALL_METHOD]" id="382121">justCALLsAfter</a> = <a href="#382120" title="Inliners.this.global.icodes.BasicBlock">afterBlock</a>.<a href="../icode/BasicBlocks.scala.html#322151" title="=&gt; List[Inliners.this.global.icodes.Instruction]">toList</a> <span title="(pf: PartialFunction[Inliners.this.global.icodes.Instruction,Inliners.this.global.icodes.opcodes.CALL_METHOD])(implicit bf: scala.collection.generic.CanBuildFrom[List[Inliners.this.global.icodes.Instruction],Inliners.this.global.icodes.opcodes.CALL_METHOD,List[Inliners.this.global.icodes.opcodes.CALL_METHOD]])List[Inliners.this.global.icodes.opcodes.CALL_METHOD]">collect</span> <a href="#382141" title="Inliners.this.global.icodes.opcodes.CALL_METHOD" class="delimiter">{</a> <span class="keyword">case</span> <a title="Inliners.this.global.icodes.opcodes.CALL_METHOD" id="382142">c</a> : opcodes.<a href="../icode/Opcodes.scala.html#244532" title="Inliners.this.global.icodes.opcodes.CALL_METHOD">CALL_METHOD</a> =&gt; <a href="#382142" title="Inliners.this.global.icodes.opcodes.CALL_METHOD">c</a> <span class="delimiter">}</span>
            <span class="keyword">for</span><span class="delimiter">(</span><a title="Inliners.this.global.icodes.opcodes.CALL_METHOD" id="382189">ia</a> &lt;- <a href="#382121" title="(f: Inliners.this.global.icodes.opcodes.CALL_METHOD =&gt; Option[Inliners.this.global.analysis.CallsiteInfo])Unit">justCALLsAfter</a><span class="delimiter">)</span> <span class="delimiter">{</span> <a href="#381370" title="=&gt; Inliners.this.global.analysis.MTFAGrowable">tfa</a>.<a href="../icode/analysis/TypeFlowAnalysis.scala.html#354553" title="=&gt; scala.collection.mutable.Map[Inliners.this.global.analysis.global.icodes.opcodes.CALL_METHOD,Inliners.this.global.analysis.CallsiteInfo]">remainingCALLs</a>.<span title="(key: Inliners.this.global.analysis.global.icodes.opcodes.CALL_METHOD)Option[Inliners.this.global.analysis.CallsiteInfo]">remove</span><span class="delimiter">(</span><a href="#382189" title="Inliners.this.global.icodes.opcodes.CALL_METHOD">ia</a><span class="delimiter">)</span> <span class="delimiter">}</span>
          <span class="delimiter">}</span>
        <span class="delimiter">}</span>

        /*
        if(splicedBlocks.nonEmpty) { // TODO explore (saves time but leads to slightly different inlining decisions)
          // opportunistically perform straightforward inlinings before the next typeflow round
          val savedRetry = retry
          val savedStaleOut = staleOut.toSet; staleOut.clear()
          val savedStaleIn  = staleIn.toSet ; staleIn.clear()
          val howmany = inlineWithoutTFA(splicedBlocks, tfa.knownBeforehand)
          splicedBlocks ++= staleIn
          staleOut.clear(); staleOut ++= savedStaleOut;
          staleIn.clear();  staleIn  ++= savedStaleIn;
          retry = savedRetry
        }
        */

        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#381370" title="=&gt; Inliners.this.global.analysis.MTFAGrowable">tfa</a>.<a href="../icode/analysis/DataFlowAnalysis.scala.html#348033" title="=&gt; Boolean">stat</a><span class="delimiter">)</span>
          <a href="../../Global.scala.html#186199" title="(msg: =&gt; AnyRef)Unit">log</a><span class="delimiter">(</span><a href="#381530" title="Inliners.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#322208" title="=&gt; Inliners.this.global.icodes.global.Symbol">symbol</a>.<a href="../../../../reflect/internal/Symbols.scala.html#46585" title="=&gt; String">fullName</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; iterations: &quot;)" class="string">&quot; iterations: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#381370" title="=&gt; Inliners.this.global.analysis.MTFAGrowable">tfa</a>.<a href="../icode/analysis/DataFlowAnalysis.scala.html#348036" title="=&gt; Int">iterations</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; (size: &quot;)" class="string">&quot; (size: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#381539" title="Inliner.this.IMethodInfo">caller</a>.<a href="#381568" title="=&gt; Int">length</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;)&quot;)" class="string">&quot;)&quot;</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
      <span class="keyword">while</span> <span class="delimiter">(</span><a href="#381535" title="Boolean">retry</a> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#381536" title="Int">count</a> <span title="(x: Int)Boolean">&lt;</span> <span title="Int(15)">MAX_INLINE_RETRY</span><span class="delimiter">)</span>

      <a href="#381530" title="Inliners.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#322260" title="()Unit">normalize</a>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#381533" title="Int">sizeBeforeInlining</a> <span title="(x: Int)Boolean">&gt;</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="Int" id="382203">instrAfterInlining</a> = <a href="#381530" title="Inliners.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#322211" title="=&gt; Inliners.this.global.icodes.Code">code</a>.<a href="../icode/Members.scala.html#322315" title="=&gt; Int">instructionCount</a>
        <span class="keyword">val</span> <a title="String" id="382204">prefix</a> = <span title="String" class="keyword">if</span> <span class="delimiter">(</span><span class="delimiter">(</span><a href="#382203" title="Int">instrAfterInlining</a> <span title="(x: Int)Boolean">&gt;</span> <span title="Int(2)" class="int">2</span> <span title="(x: Int)Int">*</span> <a href="#381534" title="Int">instrBeforeInlining</a><span class="delimiter">)</span> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <span class="delimiter">(</span><a href="#382203" title="Int">instrAfterInlining</a> <span title="(x: Int)Boolean">&gt;</span> <span title="Int(200)" class="int">200</span><span class="delimiter">)</span><span class="delimiter">)</span> <span title="String(&quot; !! &quot;)" class="string">&quot; !! &quot;</span> <span class="keyword">else</span> <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span>
        <a href="../../Global.scala.html#186199" title="(msg: =&gt; AnyRef)Unit">log</a><span class="delimiter">(</span><a href="#382204" title="String">prefix</a> <span title="(x$1: Any)String">+</span> <span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot; %s blocks before inlining: %d (%d) after: %d (%d)&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span>
          <a href="#381530" title="Inliners.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#322208" title="=&gt; Inliners.this.global.icodes.global.Symbol">symbol</a>.<a href="../../../../reflect/internal/Symbols.scala.html#46585" title="=&gt; String">fullName</a>, <a href="#381533" title="Int">sizeBeforeInlining</a>, <a href="#381534" title="Int">instrBeforeInlining</a>, <a href="#381530" title="Inliners.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#322211" title="=&gt; Inliners.this.global.icodes.Code">code</a>.<a href="../icode/Members.scala.html#322314" title="=&gt; Int">blockCount</a>, <a href="#382203" title="Int">instrAfterInlining</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(sym: Inliners.this.global.Symbol)Boolean" id="381379">isHigherOrderMethod</a><span class="delimiter">(</span><a title="Inliners.this.global.Symbol" id="382222">sym</a>: <a href="../../../../reflect/internal/Symbols.scala.html#38726" title="Inliners.this.global.Symbol">Symbol</a><span class="delimiter">)</span> =
      <a href="#382222" title="Inliners.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#46461" title="=&gt; Boolean">isMethod</a> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="../../../../reflect/internal/SymbolTable.scala.html#35637" title="(ph: scala.reflect.internal.Phase)(op: =&gt; Boolean)Boolean">atPhase</a><span class="delimiter">(</span><a href="../../Global.scala.html#186319" title="=&gt; Inliners.this.global.Run">currentRun</a>.<a href="../../Global.scala.html#188848" title="=&gt; scala.tools.nsc.Phase">erasurePhase</a>.<a href="../../../../reflect/internal/Phase.scala.html#69292" title="=&gt; scala.reflect.internal.Phase">prev</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#382222" title="Inliners.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#46608" title="=&gt; Inliners.this.global.Type">info</a>.<a href="../../../../reflect/internal/Types.scala.html#41527" title="=&gt; List[Inliners.this.global.Type]">paramTypes</a> <span title="(p: Inliners.this.global.Type =&gt; Boolean)Boolean">exists</span> <a href="../../../../reflect/internal/Definitions.scala.html#45264" title="(tp: Inliners.this.global.Type)Boolean">isFunctionType</a><span class="delimiter">)</span>

    /** Should method 'sym' being called in 'receiver' be loaded from disk? */
    <span class="keyword">def</span> <a title="(sym: Inliners.this.global.Symbol, receiver: Inliners.this.global.Symbol)Boolean" id="381380">shouldLoadImplFor</a><span class="delimiter">(</span><a title="Inliners.this.global.Symbol" id="381732">sym</a>: <a href="../../../../reflect/internal/Symbols.scala.html#38726" title="Inliners.this.global.Symbol">Symbol</a>, <a title="Inliners.this.global.Symbol" id="381733">receiver</a>: <a href="../../../../reflect/internal/Symbols.scala.html#38726" title="Inliners.this.global.Symbol">Symbol</a><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> = <span class="delimiter">{</span>
      <span class="keyword">def</span> <a title="=&gt; Boolean" id="382245">alwaysLoad</a>    = <span class="delimiter">(</span><a href="#381733" title="Inliners.this.global.Symbol">receiver</a>.<a href="../../../../reflect/internal/Symbols.scala.html#46685" title="=&gt; Inliners.this.global.Symbol">enclosingPackage</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../../../reflect/internal/Definitions.scala.html#44964" title="=&gt; Inliners.this.global.Symbol">RuntimePackage</a><span class="delimiter">)</span> <span title="(x: Boolean)Boolean">||</span> <span class="delimiter">(</span><a href="#381733" title="Inliners.this.global.Symbol">receiver</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../../../reflect/internal/Definitions.scala.html#45040" title="=&gt; Inliners.this.global.Symbol">PredefModule</a>.<a href="../../../../reflect/internal/Symbols.scala.html#46698" title="=&gt; Inliners.this.global.Symbol">moduleClass</a><span class="delimiter">)</span>
      <span class="keyword">def</span> <a title="=&gt; Boolean" id="382246">loadCondition</a> = <a href="#381732" title="Inliners.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#46549" title="=&gt; Boolean">isEffectivelyFinal</a> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#243220" title="(sym: Inliners.this.global.Symbol)Boolean">isMonadicMethod</a><span class="delimiter">(</span><a href="#381732" title="Inliners.this.global.Symbol">sym</a><span class="delimiter">)</span> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#381379" title="(sym: Inliners.this.global.Symbol)Boolean">isHigherOrderMethod</a><span class="delimiter">(</span><a href="#381732" title="Inliners.this.global.Symbol">sym</a><span class="delimiter">)</span>

      <span class="keyword">val</span> <a title="Boolean" id="382247">res</a> = <a href="#243221" title="(sym: Inliners.this.global.Symbol)Boolean">hasInline</a><span class="delimiter">(</span><a href="#381732" title="Inliners.this.global.Symbol">sym</a><span class="delimiter">)</span> <span title="(x: Boolean)Boolean">||</span> <a href="#382245" title="=&gt; Boolean">alwaysLoad</a> <span title="(x: Boolean)Boolean">||</span> <a href="#382246" title="=&gt; Boolean">loadCondition</a>
      <a href="../../Global.scala.html#186189" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><span title="String(&quot;shouldLoadImplFor: &quot;)" class="string">&quot;shouldLoadImplFor: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#381733" title="Inliners.this.global.Symbol">receiver</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;.&quot;)" class="string">&quot;.&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#381732" title="Inliners.this.global.Symbol">sym</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;: &quot;)" class="string">&quot;: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#382247" title="Boolean">res</a><span class="delimiter">)</span>
      <a href="#382247" title="Boolean">res</a>
    <span class="delimiter">}</span>

    <span class="keyword">class</span> <a title="class IMethodInfo extends Object with ScalaObject" id="381381">IMethodInfo</a><a href="#381381" title="ScalaObject" class="delimiter">(</a><span class="keyword">val</span> <a title="Inliners.this.global.icodes.IMethod" id="381582">m</a>: <a href="../icode/Members.scala.html#232640" title="Inliners.this.global.icodes.IMethod">IMethod</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="Inliners.this.global.icodes.global.Symbol" id="381551">sym</a>           = <a href="#381582" title="=&gt; Inliners.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#322208" title="=&gt; Inliners.this.global.icodes.global.Symbol">symbol</a>
      <span class="keyword">val</span> <a title="Inliners.this.global.icodes.global.Name" id="381553">name</a>          = <a href="#381551" title="=&gt; Inliners.this.global.icodes.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#46571" title="=&gt; Inliners.this.global.icodes.global.Name">name</a>
      <span class="keyword">def</span> <a title="=&gt; Inliners.this.global.icodes.global.Symbol" id="381555">owner</a>         = <a href="#381551" title="=&gt; Inliners.this.global.icodes.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#46564" title="=&gt; Inliners.this.global.icodes.global.Symbol">owner</a>
      <span class="keyword">def</span> <a title="=&gt; List[Inliners.this.global.icodes.global.Type]" id="381556">paramTypes</a>    = <a href="#381551" title="=&gt; Inliners.this.global.icodes.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#46608" title="=&gt; Inliners.this.global.icodes.global.Type">info</a>.<a href="../../../../reflect/internal/Types.scala.html#41527" title="=&gt; List[Inliners.this.global.icodes.global.Type]">paramTypes</a>
      <span class="keyword">def</span> <a title="=&gt; Int" id="381557">minimumStack</a>  = <a href="#381556" title="=&gt; List[Inliners.this.global.icodes.global.Type]">paramTypes</a>.<span title="=&gt; Int">length</span> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span>

      <span class="keyword">def</span> <a title="=&gt; Boolean" id="381558">inline</a>        = <a href="#243221" title="(sym: Inliners.this.global.Symbol)Boolean">hasInline</a><span class="delimiter">(</span><a href="#381551" title="=&gt; Inliners.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span>
      <span class="keyword">def</span> <a title="=&gt; Boolean" id="381559">noinline</a>      = <a href="#243222" title="(sym: Inliners.this.global.Symbol)Boolean">hasNoInline</a><span class="delimiter">(</span><a href="#381551" title="=&gt; Inliners.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span>

      <span class="keyword">def</span> <a title="=&gt; Boolean" id="381560">isBridge</a>      = <a href="#381551" title="=&gt; Inliners.this.global.icodes.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#46453" title="=&gt; Boolean">isBridge</a>
      <span class="keyword">def</span> <a title="=&gt; Boolean" id="381561">isInClosure</a>   = <a href="#243219" title="(cls: Inliners.this.global.Symbol)Boolean">isClosureClass</a><span class="delimiter">(</span><a href="#381555" title="=&gt; Inliners.this.global.icodes.global.Symbol">owner</a><span class="delimiter">)</span>
      <span class="keyword">val</span> <a title="Boolean" id="381562">isHigherOrder</a> = <a href="#381379" title="(sym: Inliners.this.global.Symbol)Boolean">isHigherOrderMethod</a><span class="delimiter">(</span><a href="#381551" title="=&gt; Inliners.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span>
      <span class="keyword">def</span> <a title="=&gt; Boolean" id="381564">isMonadic</a>     = <a href="#243220" title="(sym: Inliners.this.global.Symbol)Boolean">isMonadicMethod</a><span class="delimiter">(</span><a href="#381551" title="=&gt; Inliners.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span>

      <span class="keyword">def</span> <a title="=&gt; List[Inliners.this.global.icodes.ExceptionHandler]" id="381565">handlers</a>      = <a href="#381582" title="=&gt; Inliners.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#322228" title="=&gt; List[Inliners.this.global.icodes.ExceptionHandler]">exh</a>
      <span class="keyword">def</span> <a title="=&gt; List[Inliners.this.global.icodes.BasicBlock]" id="381566">blocks</a>        = <a href="#381582" title="=&gt; Inliners.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#322217" title="=&gt; List[Inliners.this.global.icodes.BasicBlock]">blocks</a>
      <span class="keyword">def</span> <a title="=&gt; List[Inliners.this.global.icodes.Local]" id="381567">locals</a>        = <a href="#381582" title="=&gt; Inliners.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#322240" title="=&gt; List[Inliners.this.global.icodes.Local]">locals</a>
      <span class="keyword">def</span> <a title="=&gt; Int" id="381568">length</a>        = <a href="#381566" title="=&gt; List[Inliners.this.global.icodes.BasicBlock]">blocks</a>.<span title="=&gt; Int">length</span>
      <span class="keyword">def</span> <a title="=&gt; List[Inliners.this.global.icodes.BasicBlock]" id="381569">openBlocks</a>    = <a href="#381566" title="=&gt; List[Inliners.this.global.icodes.BasicBlock]">blocks</a> <span title="(p: Inliners.this.global.icodes.BasicBlock =&gt; Boolean)List[Inliners.this.global.icodes.BasicBlock]">filterNot</span> <span class="delimiter">(</span><a href="#382297" title="Inliners.this.global.icodes.BasicBlock">_</a>.<a href="../icode/BasicBlocks.scala.html#322129" title="=&gt; Boolean">closed</a><span class="delimiter">)</span>
      <span class="keyword">def</span> <a title="=&gt; List[Inliners.this.global.icodes.Instruction]" id="381570">instructions</a>  = <a href="#381582" title="=&gt; Inliners.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#322211" title="=&gt; Inliners.this.global.icodes.Code">code</a>.<a href="../icode/Members.scala.html#322313" title="=&gt; List[Inliners.this.global.icodes.Instruction]">instructions</a>
      // def linearized    = linearizer linearize m

      <span class="keyword">def</span> <a title="=&gt; Boolean" id="381571">isSmall</a>       = <span class="delimiter">(</span><a href="#381568" title="=&gt; Int">length</a> <span title="(x: Int)Boolean">&lt;=</span> <a href="#243213" title="=&gt; Int">SMALL_METHOD_SIZE</a><span class="delimiter">)</span> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#381566" title="(n: Int)Inliners.this.global.icodes.BasicBlock">blocks</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>.<a href="../icode/BasicBlocks.scala.html#322159" title="=&gt; Int">length</a> <span title="(x: Int)Boolean">&lt;</span> <span title="Int(10)" class="int">10</span>
      <span class="keyword">def</span> <a title="=&gt; Boolean" id="381572">isLarge</a>       = <a href="#381568" title="=&gt; Int">length</a> <span title="(x: Int)Boolean">&gt;</span> <span title="Int(16)">MAX_INLINE_SIZE</span>
      <span class="keyword">def</span> <a title="=&gt; Boolean" id="381573">isRecursive</a>   = <a href="#381582" title="=&gt; Inliners.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#322237" title="=&gt; Boolean">recursive</a>
      <span class="keyword">def</span> <a title="=&gt; Boolean" id="381574">hasHandlers</a>   = <a href="#381565" title="=&gt; List[Inliners.this.global.icodes.ExceptionHandler]">handlers</a>.<span title="=&gt; Boolean">nonEmpty</span>
      <span class="keyword">def</span> <a title="=&gt; Boolean" id="381575">hasNonFinalizerHandler</a> = <a href="#381565" title="=&gt; List[Inliners.this.global.icodes.ExceptionHandler]">handlers</a> <span title="(p: Inliners.this.global.icodes.ExceptionHandler =&gt; Boolean)Boolean">exists</span> <a href="#382345" title="Boolean" class="delimiter">{</a>
        <span class="keyword">case</span> <span title="Boolean(true)">_</span>: <a href="../icode/ExceptionHandlers.scala.html#232718" title="Inliners.this.global.icodes.Finalizer">Finalizer</a> =&gt; <span title="Boolean(true)" class="keyword">true</span>
        <span class="keyword">case</span> <span title="Boolean(false)">_</span>            =&gt; <span title="Boolean(false)" class="keyword">false</span>
      <span class="delimiter">}</span>

      // the number of inlined calls in 'm', used by 'shouldInline'
      <span class="keyword">var</span> <a title="Int" id="381577">inlinedCalls</a> = <span title="Int(0)" class="int">0</span>

      <span class="keyword">def</span> <a title="(ls: List[Inliners.this.global.icodes.Local])Unit" id="381579">addLocals</a><span class="delimiter">(</span><a title="List[Inliners.this.global.icodes.Local]" id="382346">ls</a>: <span title="List[Inliners.this.global.icodes.Local]">List</span><span class="delimiter">[</span>Local<span class="delimiter">]</span><span class="delimiter">)</span>  = <a href="#381582" title="=&gt; Inliners.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#322241" title="(x$1: List[Inliners.this.global.icodes.Local])Unit">locals</a> <span title="(that: scala.collection.GenTraversableOnce[Inliners.this.global.icodes.Local])(implicit bf: scala.collection.generic.CanBuildFrom[List[Inliners.this.global.icodes.Local],Inliners.this.global.icodes.Local,List[Inliners.this.global.icodes.Local]])List[Inliners.this.global.icodes.Local]">++=</span> <a href="#382346" title="List[Inliners.this.global.icodes.Local]">ls</a>
      <span class="keyword">def</span> <a title="(l: Inliners.this.global.icodes.Local)Unit" id="381580">addLocal</a><span class="delimiter">(</span><a title="Inliners.this.global.icodes.Local" id="382428">l</a>: <a href="../icode/Members.scala.html#232641" title="Inliners.this.global.icodes.Local">Local</a><span class="delimiter">)</span>          = <a href="#381579" title="(ls: List[Inliners.this.global.icodes.Local])Unit">addLocals</a><span class="delimiter">(</span><span title="(xs: Inliners.this.global.icodes.Local*)List[Inliners.this.global.icodes.Local]">List</span><span class="delimiter">(</span><a href="#382428" title="Inliners.this.global.icodes.Local">l</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">def</span> <a title="(exhs: List[Inliners.this.global.icodes.ExceptionHandler])Unit" id="381581">addHandlers</a><span class="delimiter">(</span><a title="List[Inliners.this.global.icodes.ExceptionHandler]" id="382438">exhs</a>: <span title="List[Inliners.this.global.icodes.ExceptionHandler]">List</span><span class="delimiter">[</span>ExceptionHandler<span class="delimiter">]</span><span class="delimiter">)</span> = <a href="#381582" title="=&gt; Inliners.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#322229" title="(x$1: List[Inliners.this.global.icodes.ExceptionHandler])Unit">exh</a> = <a href="#382438" title="List[Inliners.this.global.icodes.ExceptionHandler]">exhs</a> <a href="#382442" title="(prefix: List[Inliners.this.global.icodes.ExceptionHandler])List[Inliners.this.global.icodes.ExceptionHandler]">:::</a> <a href="#381582" title="=&gt; Inliners.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#322228" title="=&gt; List[Inliners.this.global.icodes.ExceptionHandler]">exh</a>
    <span class="delimiter">}</span>

    <span class="keyword">class</span> <a title="class CallerCalleeInfo extends Object with ScalaObject" id="381382">CallerCalleeInfo</a><a href="#381382" title="ScalaObject" class="delimiter">(</a><span class="keyword">val</span> <a title="Inliner.this.IMethodInfo" id="381778">caller</a>: <a href="#381381" title="Inliner.this.IMethodInfo">IMethodInfo</a>, <span class="keyword">val</span> <a title="Inliner.this.IMethodInfo" id="381779">inc</a>: <a href="#381381" title="Inliner.this.IMethodInfo">IMethodInfo</a>, <a title="scala.collection.mutable.Map[String,Int]" id="381780">fresh</a>: mutable.<span title="scala.collection.mutable.Map[String,Int]">Map</span><span class="delimiter">[</span>String, Int<span class="delimiter">]</span>, <a title="scala.collection.Map[Inliners.this.global.Symbol,Int]" id="381781">inlinedMethodCount</a>: collection.<span title="scala.collection.Map[Inliners.this.global.Symbol,Int]">Map</span><span class="delimiter">[</span>Symbol, Int<span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="keyword">def</span> <a title="=&gt; Boolean" id="381764">isLargeSum</a>  = <a href="#381778" title="=&gt; Inliner.this.IMethodInfo">caller</a>.<a href="#381568" title="=&gt; Int">length</a> <span title="(x: Int)Int">+</span> <a href="#381779" title="=&gt; Inliner.this.IMethodInfo">inc</a>.<a href="#381568" title="=&gt; Int">length</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span> <span title="(x: Int)Boolean">&gt;</span> <a href="#243213" title="=&gt; Int">SMALL_METHOD_SIZE</a>

      <span class="keyword">private</span> <span class="keyword">def</span> <a title="(s: String)Inliners.this.global.TermName" id="381765">freshName</a><span class="delimiter">(</span><a title="String" id="382481">s</a>: <span title="String">String</span><span class="delimiter">)</span>: <a href="../../../../reflect/internal/Names.scala.html#38409" title="Inliners.this.global.TermName">TermName</a> = <span class="delimiter">{</span>
        <a href="#381780" title="(key: String, value: Int)Unit">fresh</a><span class="delimiter">(</span><a href="#382481" title="String">s</a><span class="delimiter">)</span> <span title="(x: Int)Int">+=</span> <span title="Int(1)" class="int">1</span>
        <a href="../../../../reflect/internal/Names.scala.html#38394" title="(s: String)Inliners.this.global.TermName">newTermName</a><span class="delimiter">(</span><a href="#382481" title="String">s</a> <span title="(x$1: Any)String">+</span> <a href="#381780" title="(key: String)Int">fresh</a><span class="delimiter">(</span><a href="#382481" title="String">s</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>

      /** Inline 'inc' into 'caller' at the given block and instruction.
       *  The instruction must be a CALL_METHOD.
       */
      <span class="keyword">def</span> <a title="(block: Inliners.this.global.icodes.BasicBlock, instr: Inliners.this.global.icodes.opcodes.CALL_METHOD)Unit" id="381766">doInline</a><span class="delimiter">(</span><a title="Inliners.this.global.icodes.BasicBlock" id="381802">block</a>: <a href="../icode/BasicBlocks.scala.html#232649" title="Inliners.this.global.icodes.BasicBlock">BasicBlock</a>, <a title="Inliners.this.global.icodes.opcodes.CALL_METHOD" id="381803">instr</a>: <a href="../icode/Opcodes.scala.html#244532" title="Inliners.this.global.icodes.opcodes.CALL_METHOD">CALL_METHOD</a><span class="delimiter">)</span> <span class="delimiter">{</span>

        <a href="#381372" title="=&gt; scala.collection.mutable.ListBuffer[Inliners.this.global.icodes.BasicBlock]">staleOut</a> <span title="(x: Inliners.this.global.icodes.BasicBlock)Inliner.this.staleOut.type">+=</span> <a href="#381802" title="Inliners.this.global.icodes.BasicBlock">block</a>

        <a href="#381370" title="=&gt; Inliners.this.global.analysis.MTFAGrowable">tfa</a>.<a href="../icode/analysis/TypeFlowAnalysis.scala.html#354553" title="=&gt; scala.collection.mutable.Map[Inliners.this.global.analysis.global.icodes.opcodes.CALL_METHOD,Inliners.this.global.analysis.CallsiteInfo]">remainingCALLs</a>.<span title="(key: Inliners.this.global.analysis.global.icodes.opcodes.CALL_METHOD)Option[Inliners.this.global.analysis.CallsiteInfo]">remove</span><span class="delimiter">(</span><a href="#381803" title="Inliners.this.global.icodes.opcodes.CALL_METHOD">instr</a><span class="delimiter">)</span> // this bookkpeeping is done here and not in MTFAGrowable.reinit due to (1st) convenience and (2nd) necessity.
        <a href="#381370" title="=&gt; Inliners.this.global.analysis.MTFAGrowable">tfa</a>.<a href="../icode/analysis/TypeFlowAnalysis.scala.html#354565" title="=&gt; scala.collection.mutable.Set[Inliners.this.global.analysis.global.icodes.Instruction]">isOnWatchlist</a>.<span title="(elem: Inliners.this.global.analysis.global.icodes.Instruction)Boolean">remove</span><span class="delimiter">(</span><a href="#381803" title="Inliners.this.global.icodes.opcodes.CALL_METHOD">instr</a><span class="delimiter">)</span>  // ditto

        <span class="keyword">val</span> <a title="scala.tools.nsc.util.Position" id="382548">targetPos</a> = <a href="#381803" title="Inliners.this.global.icodes.opcodes.CALL_METHOD">instr</a>.<a href="../icode/Opcodes.scala.html#322688" title="=&gt; scala.tools.nsc.util.Position">pos</a>
        <a href="../../Global.scala.html#186199" title="(msg: =&gt; AnyRef)Unit">log</a><span class="delimiter">(</span><span title="String(&quot;Inlining &quot;)" class="string">&quot;Inlining &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#381779" title="=&gt; Inliner.this.IMethodInfo">inc</a>.<a href="#381582" title="=&gt; Inliners.this.global.icodes.IMethod">m</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; in &quot;)" class="string">&quot; in &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#381778" title="=&gt; Inliner.this.IMethodInfo">caller</a>.<a href="#381582" title="=&gt; Inliners.this.global.icodes.IMethod">m</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; at pos: &quot;)" class="string">&quot; at pos: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#243218" title="(pos: scala.tools.nsc.util.Position)String">posToStr</a><span class="delimiter">(</span><a href="#382548" title="scala.tools.nsc.util.Position">targetPos</a><span class="delimiter">)</span><span class="delimiter">)</span>

        <span class="keyword">def</span> <a title="(i: Inliners.this.global.icodes.Instruction)Unit" id="382549">blockEmit</a><span class="delimiter">(</span><a title="Inliners.this.global.icodes.Instruction" id="382580">i</a>: <a href="../icode/Opcodes.scala.html#232653" title="Inliners.this.global.icodes.Instruction">Instruction</a><span class="delimiter">)</span> = <a href="#381802" title="Inliners.this.global.icodes.BasicBlock">block</a>.<a href="../icode/BasicBlocks.scala.html#322170" title="(instr: Inliners.this.global.icodes.Instruction, pos: scala.tools.nsc.util.Position)Unit">emit</a><span class="delimiter">(</span><a href="#382580" title="Inliners.this.global.icodes.Instruction">i</a>, <a href="#382548" title="scala.tools.nsc.util.Position">targetPos</a><span class="delimiter">)</span>
        <span class="keyword">def</span> <a title="(baseName: String, kind: Inliners.this.global.icodes.TypeKind)Inliners.this.global.icodes.Local" id="382550">newLocal</a><span class="delimiter">(</span><a title="String" id="382587">baseName</a>: <span title="String">String</span>, <a title="Inliners.this.global.icodes.TypeKind" id="382588">kind</a>: <a href="../icode/TypeKinds.scala.html#232671" title="Inliners.this.global.icodes.TypeKind">TypeKind</a><span class="delimiter">)</span> =
          <span title="Inliners.this.global.icodes.Local" class="keyword">new</span> <a href="../icode/Members.scala.html#232641" title="Inliners.this.global.icodes.Local">Local</a><span class="delimiter">(</span><a href="#381778" title="=&gt; Inliner.this.IMethodInfo">caller</a>.<a href="#381551" title="=&gt; Inliners.this.global.icodes.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#46384" title="(name: Inliners.this.global.icodes.global.TermName, pos: Inliners.this.global.icodes.global.Position, newFlags: Long)Inliners.this.global.icodes.global.TermSymbol">newVariable</a><span class="delimiter">(</span><a href="#381765" title="(s: String)Inliners.this.global.TermName">freshName</a><span class="delimiter">(</span><a href="#382587" title="String">baseName</a><span class="delimiter">)</span>, <a href="#382548" title="scala.tools.nsc.util.Position">targetPos</a><span class="delimiter">)</span>, <a href="#382588" title="Inliners.this.global.icodes.TypeKind">kind</a>, <span title="Boolean(false)" class="keyword">false</span><span class="delimiter">)</span>

        <span class="keyword">val</span> <a href="#382552" title="(Boolean, Inliners.this.global.analysis.MethodTFA)" class="delimiter">(</a><a href="#382551" title="Boolean" id="382552">hasRETURN</a>, <a href="#382551" title="Inliners.this.global.analysis.MethodTFA" id="382553">a</a><span class="delimiter">)</span> = <a href="#381367" title="(incm: Inliners.this.global.icodes.IMethod)(Boolean, Inliners.this.global.analysis.MethodTFA)">getRecentTFA</a><span title="(Boolean, Inliners.this.global.analysis.MethodTFA) @unchecked" class="delimiter">(</span><a href="#381779" title="=&gt; Inliner.this.IMethodInfo">inc</a>.<a href="#381582" title="=&gt; Inliners.this.global.icodes.IMethod">m</a><span class="delimiter">)</span>

        /* The exception handlers that are active at the current block. */
        <span class="keyword">val</span> <a title="List[Inliners.this.global.icodes.ExceptionHandler]" id="382554">activeHandlers</a> = <a href="#381778" title="=&gt; Inliner.this.IMethodInfo">caller</a>.<a href="#381565" title="=&gt; List[Inliners.this.global.icodes.ExceptionHandler]">handlers</a> <span title="(p: Inliners.this.global.icodes.ExceptionHandler =&gt; Boolean)List[Inliners.this.global.icodes.ExceptionHandler]">filter</span> <span class="delimiter">(</span><a href="#382610" title="Inliners.this.global.icodes.ExceptionHandler">_</a> <a href="../icode/ExceptionHandlers.scala.html#322458" title="(elem: Inliners.this.global.icodes.BasicBlock)Boolean">covered</a> <a href="#381802" title="Inliners.this.global.icodes.BasicBlock">block</a><span class="delimiter">)</span>

        /* Map 'original' blocks to the ones inlined in the caller. */
        <span class="keyword">val</span> <a title="scala.collection.mutable.Map[Inliners.this.global.icodes.BasicBlock,Inliners.this.global.icodes.BasicBlock]" id="382555">inlinedBlock</a>: mutable.<span title="scala.collection.mutable.Map[Inliners.this.global.icodes.BasicBlock,Inliners.this.global.icodes.BasicBlock]">Map</span><span class="delimiter">[</span>BasicBlock, BasicBlock<span class="delimiter">]</span> = <span title="()scala.collection.mutable.HashMap[Inliners.this.global.icodes.BasicBlock,Inliners.this.global.icodes.BasicBlock]" class="keyword">new</span> mutable.<span title="scala.collection.mutable.HashMap[Inliners.this.global.icodes.BasicBlock,Inliners.this.global.icodes.BasicBlock]">HashMap</span>

        <span class="keyword">val</span> <a title="scala.collection.mutable.Set[Inliners.this.global.icodes.Local]" id="382556">varsInScope</a>: mutable.<span title="scala.collection.mutable.Set[Inliners.this.global.icodes.Local]">Set</span><span class="delimiter">[</span>Local<span class="delimiter">]</span> = mutable.<span title="(elems: Inliners.this.global.icodes.Local*)scala.collection.mutable.HashSet[Inliners.this.global.icodes.Local]">HashSet</span><span class="delimiter">(</span><span class="delimiter">)</span> <span title="(xs: scala.collection.TraversableOnce[Inliners.this.global.icodes.Local])scala.collection.mutable.HashSet[Inliners.this.global.icodes.Local]">++=</span> <a href="#381802" title="Inliners.this.global.icodes.BasicBlock">block</a>.<a href="../icode/BasicBlocks.scala.html#322142" title="=&gt; scala.collection.mutable.Set[Inliners.this.global.icodes.Local]">varsInScope</a>

        /** Side effects varsInScope when it sees SCOPE_ENTERs. */
        <span class="keyword">def</span> <a title="(i: Inliners.this.global.icodes.Instruction)Boolean" id="382557">instrBeforeFilter</a><span class="delimiter">(</span><a title="Inliners.this.global.icodes.Instruction" id="382646">i</a>: <a href="../icode/Opcodes.scala.html#232653" title="Inliners.this.global.icodes.Instruction">Instruction</a><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> = <span class="delimiter">{</span>
          <a href="#382646" title="Inliners.this.global.icodes.Instruction">i</a> <span title="Any" class="keyword">match</span> <span class="delimiter">{</span> <span class="keyword">case</span> <span title="varsInScope.type">SCOPE_ENTER</span><span class="delimiter">(</span><a title="Inliners.this.global.icodes.Local" id="382648">l</a><span class="delimiter">)</span> =&gt; <a href="#382556" title="scala.collection.mutable.Set[Inliners.this.global.icodes.Local]">varsInScope</a> <span title="(elem: Inliners.this.global.icodes.Local)varsInScope.type">+=</span> <a href="#382648" title="Inliners.this.global.icodes.Local">l</a> ; <span class="keyword">case</span> <span title="Unit">_</span> =&gt; <span title="Unit" class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">}</span>
          <a href="#382646" title="Inliners.this.global.icodes.Instruction">i</a> <span title="(x$1: AnyRef)Boolean">ne</span> <a href="#381803" title="Inliners.this.global.icodes.opcodes.CALL_METHOD">instr</a>
        <span class="delimiter">}</span>
        <span class="keyword">val</span> <a title="List[Inliners.this.global.icodes.Instruction]" id="382558">instrBefore</a> = <a href="#381802" title="Inliners.this.global.icodes.BasicBlock">block</a>.<a href="../icode/BasicBlocks.scala.html#322151" title="=&gt; List[Inliners.this.global.icodes.Instruction]">toList</a> <span title="(p: Inliners.this.global.icodes.Instruction =&gt; Boolean)List[Inliners.this.global.icodes.Instruction]">takeWhile</span> <a href="#382557" title="(i: Inliners.this.global.icodes.Instruction)Boolean">instrBeforeFilter</a>
        <span class="keyword">val</span> <a title="List[Inliners.this.global.icodes.Instruction]" id="382559">instrAfter</a>  = <a href="#381802" title="Inliners.this.global.icodes.BasicBlock">block</a>.<a href="../icode/BasicBlocks.scala.html#322151" title="=&gt; List[Inliners.this.global.icodes.Instruction]">toList</a> <span title="(n: Int)List[Inliners.this.global.icodes.Instruction]">drop</span> <span class="delimiter">(</span><a href="#382558" title="List[Inliners.this.global.icodes.Instruction]">instrBefore</a>.<span title="=&gt; Int">length</span> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>

        <a href="../../Global.scala.html#186183" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a><span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#382559" title="List[Inliners.this.global.icodes.Instruction]">instrAfter</a>.<span title="=&gt; Boolean">isEmpty</span>, <span title="String(&quot;CALL_METHOD cannot be the last instruction in block!&quot;)" class="string">&quot;CALL_METHOD cannot be the last instruction in block!&quot;</span><span class="delimiter">)</span>

        // store the '$this' into the special local
        <span class="keyword">val</span> <a title="Inliners.this.global.icodes.Local" id="382560">inlinedThis</a> = <a href="#382550" title="(baseName: String, kind: Inliners.this.global.icodes.TypeKind)Inliners.this.global.icodes.Local">newLocal</a><span class="delimiter">(</span><span title="String(&quot;$inlThis&quot;)" class="string">&quot;$inlThis&quot;</span>, <a href="../icode/TypeKinds.scala.html#320867" title="(cls: Inliners.this.global.icodes.global.Symbol)Inliners.this.global.icodes.REFERENCE">REFERENCE</a><span class="delimiter">(</span><a href="../../../../reflect/internal/Definitions.scala.html#44986" title="=&gt; Inliners.this.global.Symbol">ObjectClass</a><span class="delimiter">)</span><span class="delimiter">)</span>

        /** buffer for the returned value */
        <span class="keyword">val</span> <a title="Inliners.this.global.icodes.Local" id="382561">retVal</a> = <a href="#381779" title="=&gt; Inliner.this.IMethodInfo">inc</a>.<a href="#381582" title="=&gt; Inliners.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#322234" title="=&gt; Inliners.this.global.icodes.TypeKind">returnType</a> <span title="Inliners.this.global.icodes.Local" class="keyword">match</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> <a href="../icode/TypeKinds.scala.html#232677" title="Null(null)">UNIT</a>  =&gt; <span title="Null(null)" class="keyword">null</span>
          <span class="keyword">case</span> <a title="Inliners.this.global.icodes.Local" id="382688">x</a>     =&gt; <a href="#382550" title="(baseName: String, kind: Inliners.this.global.icodes.TypeKind)Inliners.this.global.icodes.Local">newLocal</a><span class="delimiter">(</span><span title="String(&quot;$retVal&quot;)" class="string">&quot;$retVal&quot;</span>, <a href="#382688" title="Inliners.this.global.icodes.TypeKind">x</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>

        <span class="keyword">val</span> <a title="scala.collection.mutable.HashMap[Inliners.this.global.icodes.Local,Inliners.this.global.icodes.Local]" id="382562">inlinedLocals</a> = mutable.<span title="object scala.collection.mutable.HashMap">HashMap</span>.<span title="[A, B]=&gt; scala.collection.mutable.HashMap[A,B]">empty</span><span title="scala.collection.mutable.HashMap[Inliners.this.global.icodes.Local,Inliners.this.global.icodes.Local]" class="delimiter">[</span><a href="../icode/Members.scala.html#232641" title="Inliners.this.global.icodes.Local">Local</a>, <a href="../icode/Members.scala.html#232641" title="Inliners.this.global.icodes.Local">Local</a><span class="delimiter">]</span>

        /** Add a new block in the current context. */
        <span class="keyword">def</span> <a title="()Inliners.this.global.icodes.BasicBlock" id="382563">newBlock</a><span class="delimiter">(</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
          <span class="keyword">val</span> <a title="Inliners.this.global.icodes.BasicBlock" id="382689">b</a> = <a href="#381778" title="=&gt; Inliner.this.IMethodInfo">caller</a>.<a href="#381582" title="=&gt; Inliners.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#322211" title="=&gt; Inliners.this.global.icodes.Code">code</a>.<a href="../icode/Members.scala.html#322321" title="()Inliners.this.global.icodes.BasicBlock">newBlock</a>
          <a href="#382554" title="List[Inliners.this.global.icodes.ExceptionHandler]">activeHandlers</a> <span title="(f: Inliners.this.global.icodes.ExceptionHandler =&gt; Inliners.this.global.icodes.ExceptionHandler)Unit">foreach</span> <span class="delimiter">(</span><a href="#382709" title="Inliners.this.global.icodes.ExceptionHandler">_</a> <a href="../icode/ExceptionHandlers.scala.html#322461" title="(b: Inliners.this.global.icodes.BasicBlock)x$9.type">addCoveredBlock</a> <a href="#382689" title="Inliners.this.global.icodes.BasicBlock">b</a><span class="delimiter">)</span>
          <span title="Any" class="keyword">if</span> <span class="delimiter">(</span><a href="#382561" title="Inliners.this.global.icodes.Local">retVal</a> <span title="(x$1: AnyRef)Boolean">ne</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <a href="#382689" title="Inliners.this.global.icodes.BasicBlock">b</a>.<a href="../icode/BasicBlocks.scala.html#322142" title="=&gt; scala.collection.mutable.Set[Inliners.this.global.icodes.Local]">varsInScope</a> <span title="(elem: Inliners.this.global.icodes.Local)b.varsInScope.type">+=</span> <a href="#382561" title="Inliners.this.global.icodes.Local">retVal</a>
          <a href="#382689" title="Inliners.this.global.icodes.BasicBlock">b</a>.<a href="../icode/BasicBlocks.scala.html#322142" title="=&gt; scala.collection.mutable.Set[Inliners.this.global.icodes.Local]">varsInScope</a> <span title="(elem: Inliners.this.global.icodes.Local)b.varsInScope.type">+=</span> <a href="#382560" title="Inliners.this.global.icodes.Local">inlinedThis</a>
          <a href="#382689" title="Inliners.this.global.icodes.BasicBlock">b</a>.<a href="../icode/BasicBlocks.scala.html#322142" title="=&gt; scala.collection.mutable.Set[Inliners.this.global.icodes.Local]">varsInScope</a> <span title="(xs: scala.collection.TraversableOnce[Inliners.this.global.icodes.Local])b.varsInScope.type">++=</span> <a href="#382556" title="scala.collection.mutable.Set[Inliners.this.global.icodes.Local]">varsInScope</a>
          <a href="#382689" title="Inliners.this.global.icodes.BasicBlock">b</a>
        <span class="delimiter">}</span>

        <span class="keyword">def</span> <a title="(e: Inliners.this.global.icodes.ExceptionHandler)Inliners.this.global.icodes.ExceptionHandler" id="382564">translateExh</a><span class="delimiter">(</span><a title="Inliners.this.global.icodes.ExceptionHandler" id="382733">e</a>: <a href="../icode/ExceptionHandlers.scala.html#232717" title="Inliners.this.global.icodes.ExceptionHandler">ExceptionHandler</a><span class="delimiter">)</span> = <span class="delimiter">{</span>
          <span class="keyword">val</span> <a title="Inliners.this.global.icodes.ExceptionHandler" id="382734">handler</a>: <a href="../icode/ExceptionHandlers.scala.html#232717" title="Inliners.this.global.icodes.ExceptionHandler">ExceptionHandler</a> = <a href="#382733" title="Inliners.this.global.icodes.ExceptionHandler">e</a>.<a href="../icode/ExceptionHandlers.scala.html#322469" title="=&gt; Inliners.this.global.icodes.ExceptionHandler">dup</a>
          <a href="#382734" title="Inliners.this.global.icodes.ExceptionHandler">handler</a>.<a href="../icode/ExceptionHandlers.scala.html#322459" title="(x$1: scala.collection.immutable.Set[Inliners.this.global.icodes.BasicBlock])Unit">covered</a> = <a href="#382734" title="Inliners.this.global.icodes.ExceptionHandler">handler</a>.<a href="../icode/ExceptionHandlers.scala.html#322458" title="=&gt; scala.collection.immutable.Set[Inliners.this.global.icodes.BasicBlock]">covered</a> <span title="(f: Inliners.this.global.icodes.BasicBlock =&gt; Inliners.this.global.icodes.BasicBlock)(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.immutable.Set[Inliners.this.global.icodes.BasicBlock],Inliners.this.global.icodes.BasicBlock,scala.collection.immutable.Set[Inliners.this.global.icodes.BasicBlock]])scala.collection.immutable.Set[Inliners.this.global.icodes.BasicBlock]">map</span> <a href="#382555" title="scala.collection.mutable.Map[Inliners.this.global.icodes.BasicBlock,Inliners.this.global.icodes.BasicBlock]">inlinedBlock</a>
          <a href="#382734" title="Inliners.this.global.icodes.ExceptionHandler">handler</a> <a href="../icode/ExceptionHandlers.scala.html#322456" title="(b: Inliners.this.global.icodes.BasicBlock)Unit">setStartBlock</a> <a href="#382555" title="(key: Inliners.this.global.icodes.BasicBlock)Inliners.this.global.icodes.BasicBlock">inlinedBlock</a><span class="delimiter">(</span><a href="#382733" title="Inliners.this.global.icodes.ExceptionHandler">e</a>.<a href="../icode/ExceptionHandlers.scala.html#322457" title="=&gt; Inliners.this.global.icodes.BasicBlock">startBlock</a><span class="delimiter">)</span>
          <a href="#382734" title="Inliners.this.global.icodes.ExceptionHandler">handler</a>
        <span class="delimiter">}</span>

        /** alfa-rename `l` in caller's context. */
        <span class="keyword">def</span> <a title="(l: Inliners.this.global.icodes.Local)Inliners.this.global.icodes.Local" id="382565">dupLocal</a><span class="delimiter">(</span><a title="Inliners.this.global.icodes.Local" id="382808">l</a>: <a href="../icode/Members.scala.html#232641" title="Inliners.this.global.icodes.Local">Local</a><span class="delimiter">)</span>: <a href="../icode/Members.scala.html#232641" title="Inliners.this.global.icodes.Local">Local</a> = <span class="delimiter">{</span>
          <span class="keyword">val</span> <a title="Inliners.this.global.icodes.global.TermSymbol" id="382809">sym</a> = <a href="#381778" title="=&gt; Inliner.this.IMethodInfo">caller</a>.<a href="#381551" title="=&gt; Inliners.this.global.icodes.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#46384" title="(name: Inliners.this.global.icodes.global.TermName, pos: Inliners.this.global.icodes.global.Position, newFlags: Long)Inliners.this.global.icodes.global.TermSymbol">newVariable</a><span class="delimiter">(</span><a href="#381765" title="(s: String)Inliners.this.global.TermName">freshName</a><span class="delimiter">(</span><a href="#382808" title="Inliners.this.global.icodes.Local">l</a>.<a href="../icode/Members.scala.html#322657" title="=&gt; Inliners.this.global.icodes.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#46571" title="=&gt; Inliners.this.global.icodes.global.Name">name</a>.<span title="()String">toString</span><span class="delimiter">)</span>, <a href="#382808" title="Inliners.this.global.icodes.Local">l</a>.<a href="../icode/Members.scala.html#322657" title="=&gt; Inliners.this.global.icodes.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#46379" title="=&gt; Inliners.this.global.icodes.global.Position">pos</a><span class="delimiter">)</span>
          // sym.setInfo(l.sym.tpe)
          <span class="keyword">val</span> <a title="Inliners.this.global.icodes.Local" id="382810">dupped</a> = <span title="Inliners.this.global.icodes.Local" class="keyword">new</span> <a href="../icode/Members.scala.html#232641" title="Inliners.this.global.icodes.Local">Local</a><span class="delimiter">(</span><a href="#382809" title="Inliners.this.global.icodes.global.TermSymbol">sym</a>, <a href="#382808" title="Inliners.this.global.icodes.Local">l</a>.<a href="../icode/Members.scala.html#322659" title="=&gt; Inliners.this.global.icodes.TypeKind">kind</a>, <span title="Boolean(false)" class="keyword">false</span><span class="delimiter">)</span>
          <a href="#382562" title="(key: Inliners.this.global.icodes.Local, value: Inliners.this.global.icodes.Local)Unit">inlinedLocals</a><span class="delimiter">(</span><a href="#382808" title="Inliners.this.global.icodes.Local">l</a><span class="delimiter">)</span> = <a href="#382810" title="Inliners.this.global.icodes.Local">dupped</a>
          <a href="#382810" title="Inliners.this.global.icodes.Local">dupped</a>
        <span class="delimiter">}</span>

        <span class="keyword">val</span> <a title="Inliners.this.global.icodes.BasicBlock" id="382566">afterBlock</a> = <a href="#382563" title="()Inliners.this.global.icodes.BasicBlock">newBlock</a><span class="delimiter">(</span><span class="delimiter">)</span>

        /** Map from nw.init instructions to their matching NEW call */
        <span class="keyword">val</span> <a title="scala.collection.mutable.Map[Inliners.this.global.icodes.Instruction,Inliners.this.global.icodes.opcodes.NEW]" id="382567">pending</a>: mutable.<span title="scala.collection.mutable.Map[Inliners.this.global.icodes.Instruction,Inliners.this.global.icodes.opcodes.NEW]">Map</span><span class="delimiter">[</span>Instruction, NEW<span class="delimiter">]</span> = <span title="()scala.collection.mutable.HashMap[Inliners.this.global.icodes.Instruction,Inliners.this.global.icodes.opcodes.NEW]" class="keyword">new</span> mutable.<span title="scala.collection.mutable.HashMap[Inliners.this.global.icodes.Instruction,Inliners.this.global.icodes.opcodes.NEW]">HashMap</span>

        /** Map an instruction from the callee to one suitable for the caller. */
        <span class="keyword">def</span> <a title="(i: Inliners.this.global.icodes.Instruction)Inliners.this.global.icodes.Instruction" id="382568">map</a><span class="delimiter">(</span><a title="Inliners.this.global.icodes.Instruction" id="382819">i</a>: <a href="../icode/Opcodes.scala.html#232653" title="Inliners.this.global.icodes.Instruction">Instruction</a><span class="delimiter">)</span>: <a href="../icode/Opcodes.scala.html#232653" title="Inliners.this.global.icodes.Instruction">Instruction</a> = <span class="delimiter">{</span>
          <span class="keyword">def</span> <a title="(l: Inliners.this.global.icodes.Local)Inliners.this.global.icodes.Instruction" id="382820">assertLocal</a><span class="delimiter">(</span><a title="Inliners.this.global.icodes.Local" id="382823">l</a>: <a href="../icode/Members.scala.html#232641" title="Inliners.this.global.icodes.Local">Local</a><span class="delimiter">)</span> = <span class="delimiter">{</span>
            <a href="../../Global.scala.html#186183" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a><span class="delimiter">(</span><a href="#381778" title="=&gt; Inliner.this.IMethodInfo">caller</a>.<a href="#381567" title="=&gt; List[Inliners.this.global.icodes.Local]">locals</a> <span title="(elem: Any)Boolean">contains</span> <a href="#382823" title="Inliners.this.global.icodes.Local">l</a>, <span title="String(&quot;Could not find local \'&quot;)" class="string">&quot;Could not find local '&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#382823" title="Inliners.this.global.icodes.Local">l</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;\' in locals, nor in inlinedLocals: &quot;)" class="string">&quot;' in locals, nor in inlinedLocals: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#382562" title="scala.collection.mutable.HashMap[Inliners.this.global.icodes.Local,Inliners.this.global.icodes.Local]">inlinedLocals</a><span class="delimiter">)</span>
            <a href="#382819" title="Inliners.this.global.icodes.Instruction">i</a>
          <span class="delimiter">}</span>
          <span class="keyword">def</span> <a title="(l: Inliners.this.global.icodes.Local)Boolean" id="382821">isInlined</a><span class="delimiter">(</span><a title="Inliners.this.global.icodes.Local" id="382827">l</a>: <a href="../icode/Members.scala.html#232641" title="Inliners.this.global.icodes.Local">Local</a><span class="delimiter">)</span> = <a href="#382562" title="scala.collection.mutable.HashMap[Inliners.this.global.icodes.Local,Inliners.this.global.icodes.Local]">inlinedLocals</a> <span title="(key: Inliners.this.global.icodes.Local)Boolean">isDefinedAt</span> <a href="#382827" title="Inliners.this.global.icodes.Local">l</a>

          <span class="keyword">val</span> <a title="Inliners.this.global.icodes.Instruction" id="382822">newInstr</a> = <a href="#382819" title="Inliners.this.global.icodes.Instruction">i</a> <span title="Inliners.this.global.icodes.Instruction" class="keyword">match</span> <span class="delimiter">{</span>
            <span class="keyword">case</span> <span title="Inliners.this.global.icodes.opcodes.LOAD_LOCAL">THIS</span><span class="delimiter">(</span><a title="Inliners.this.global.icodes.global.Symbol" id="382832">clasz</a><span class="delimiter">)</span>                    =&gt; <a href="../icode/Opcodes.scala.html#330875" title="(local: Inliners.this.global.icodes.Local)Inliners.this.global.icodes.opcodes.LOAD_LOCAL">LOAD_LOCAL</a><span class="delimiter">(</span><a href="#382560" title="Inliners.this.global.icodes.Local">inlinedThis</a><span class="delimiter">)</span>
            <span class="keyword">case</span> <span title="Inliners.this.global.icodes.opcodes.STORE_LOCAL">STORE_THIS</span><span class="delimiter">(</span>_<span class="delimiter">)</span>                  =&gt; <a href="../icode/Opcodes.scala.html#327716" title="(local: Inliners.this.global.icodes.Local)Inliners.this.global.icodes.opcodes.STORE_LOCAL">STORE_LOCAL</a><span class="delimiter">(</span><a href="#382560" title="Inliners.this.global.icodes.Local">inlinedThis</a><span class="delimiter">)</span>
            <span class="keyword">case</span> <span title="Inliners.this.global.icodes.opcodes.JUMP">JUMP</span><span class="delimiter">(</span><a title="Inliners.this.global.icodes.BasicBlock" id="382839">whereto</a><span class="delimiter">)</span>                  =&gt; <a href="../icode/Opcodes.scala.html#327593" title="(whereto: Inliners.this.global.icodes.BasicBlock)Inliners.this.global.icodes.opcodes.JUMP">JUMP</a><span class="delimiter">(</span><a href="#382555" title="(key: Inliners.this.global.icodes.BasicBlock)Inliners.this.global.icodes.BasicBlock">inlinedBlock</a><span class="delimiter">(</span><a href="#382839" title="Inliners.this.global.icodes.BasicBlock">whereto</a><span class="delimiter">)</span><span class="delimiter">)</span>
            <span class="keyword">case</span> <span title="Inliners.this.global.icodes.opcodes.CJUMP">CJUMP</span><span class="delimiter">(</span><a title="Inliners.this.global.icodes.BasicBlock" id="382861">succ</a>, <a title="Inliners.this.global.icodes.BasicBlock" id="382862">fail</a>, <a title="Inliners.this.global.icodes.TestOp" id="382863">cond</a>, <a title="Inliners.this.global.icodes.TypeKind" id="382864">kind</a><span class="delimiter">)</span>  =&gt; <a href="../icode/Opcodes.scala.html#327955" title="(successBlock: Inliners.this.global.icodes.BasicBlock, failureBlock: Inliners.this.global.icodes.BasicBlock, cond: Inliners.this.global.icodes.TestOp, kind: Inliners.this.global.icodes.TypeKind)Inliners.this.global.icodes.opcodes.CJUMP">CJUMP</a><span class="delimiter">(</span><a href="#382555" title="(key: Inliners.this.global.icodes.BasicBlock)Inliners.this.global.icodes.BasicBlock">inlinedBlock</a><span class="delimiter">(</span><a href="#382861" title="Inliners.this.global.icodes.BasicBlock">succ</a><span class="delimiter">)</span>, <a href="#382555" title="(key: Inliners.this.global.icodes.BasicBlock)Inliners.this.global.icodes.BasicBlock">inlinedBlock</a><span class="delimiter">(</span><a href="#382862" title="Inliners.this.global.icodes.BasicBlock">fail</a><span class="delimiter">)</span>, <a href="#382863" title="Inliners.this.global.icodes.TestOp">cond</a>, <a href="#382864" title="Inliners.this.global.icodes.TypeKind">kind</a><span class="delimiter">)</span>
            <span class="keyword">case</span> <span title="Inliners.this.global.icodes.opcodes.CZJUMP">CZJUMP</span><span class="delimiter">(</span><a title="Inliners.this.global.icodes.BasicBlock" id="382907">succ</a>, <a title="Inliners.this.global.icodes.BasicBlock" id="382908">fail</a>, <a title="Inliners.this.global.icodes.TestOp" id="382909">cond</a>, <a title="Inliners.this.global.icodes.TypeKind" id="382910">kind</a><span class="delimiter">)</span> =&gt; <a href="../icode/Opcodes.scala.html#328028" title="(successBlock: Inliners.this.global.icodes.BasicBlock, failureBlock: Inliners.this.global.icodes.BasicBlock, cond: Inliners.this.global.icodes.TestOp, kind: Inliners.this.global.icodes.TypeKind)Inliners.this.global.icodes.opcodes.CZJUMP">CZJUMP</a><span class="delimiter">(</span><a href="#382555" title="(key: Inliners.this.global.icodes.BasicBlock)Inliners.this.global.icodes.BasicBlock">inlinedBlock</a><span class="delimiter">(</span><a href="#382907" title="Inliners.this.global.icodes.BasicBlock">succ</a><span class="delimiter">)</span>, <a href="#382555" title="(key: Inliners.this.global.icodes.BasicBlock)Inliners.this.global.icodes.BasicBlock">inlinedBlock</a><span class="delimiter">(</span><a href="#382908" title="Inliners.this.global.icodes.BasicBlock">fail</a><span class="delimiter">)</span>, <a href="#382909" title="Inliners.this.global.icodes.TestOp">cond</a>, <a href="#382910" title="Inliners.this.global.icodes.TypeKind">kind</a><span class="delimiter">)</span>
            <span class="keyword">case</span> <span title="Inliners.this.global.icodes.opcodes.SWITCH">SWITCH</span><span class="delimiter">(</span><a title="List[List[Int]]" id="382951">tags</a>, <a title="List[Inliners.this.global.icodes.BasicBlock]" id="382952">labels</a><span class="delimiter">)</span>           =&gt; <a href="../icode/Opcodes.scala.html#328100" title="(tags: List[List[Int]], labels: List[Inliners.this.global.icodes.BasicBlock])Inliners.this.global.icodes.opcodes.SWITCH">SWITCH</a><span class="delimiter">(</span><a href="#382951" title="List[List[Int]]">tags</a>, <a href="#382952" title="List[Inliners.this.global.icodes.BasicBlock]">labels</a> <span title="(f: Inliners.this.global.icodes.BasicBlock =&gt; Inliners.this.global.icodes.BasicBlock)(implicit bf: scala.collection.generic.CanBuildFrom[List[Inliners.this.global.icodes.BasicBlock],Inliners.this.global.icodes.BasicBlock,List[Inliners.this.global.icodes.BasicBlock]])List[Inliners.this.global.icodes.BasicBlock]">map</span> <a href="#382555" title="scala.collection.mutable.Map[Inliners.this.global.icodes.BasicBlock,Inliners.this.global.icodes.BasicBlock]">inlinedBlock</a><span class="delimiter">)</span>
            <span class="keyword">case</span> <span title="Inliners.this.global.icodes.opcodes.JUMP">RETURN</span><span class="delimiter">(</span>_<span class="delimiter">)</span>                      =&gt; <a href="../icode/Opcodes.scala.html#327593" title="(whereto: Inliners.this.global.icodes.BasicBlock)Inliners.this.global.icodes.opcodes.JUMP">JUMP</a><span class="delimiter">(</span><a href="#382566" title="Inliners.this.global.icodes.BasicBlock">afterBlock</a><span class="delimiter">)</span>
            <span class="keyword">case</span> <span title="Inliners.this.global.icodes.opcodes.LOAD_LOCAL">LOAD_LOCAL</span><span class="delimiter">(</span><a title="Inliners.this.global.icodes.Local" id="383013">l</a><span class="delimiter">)</span> <span class="keyword">if</span> <a href="#382821" title="(l: Inliners.this.global.icodes.Local)Boolean">isInlined</a><span class="delimiter">(</span><a href="#383013" title="Inliners.this.global.icodes.Local">l</a><span class="delimiter">)</span>  =&gt; <a href="../icode/Opcodes.scala.html#330875" title="(local: Inliners.this.global.icodes.Local)Inliners.this.global.icodes.opcodes.LOAD_LOCAL">LOAD_LOCAL</a><span class="delimiter">(</span><a href="#382562" title="(key: Inliners.this.global.icodes.Local)Inliners.this.global.icodes.Local">inlinedLocals</a><span class="delimiter">(</span><a href="#383013" title="Inliners.this.global.icodes.Local">l</a><span class="delimiter">)</span><span class="delimiter">)</span>
            <span class="keyword">case</span> <span title="Inliners.this.global.icodes.opcodes.STORE_LOCAL">STORE_LOCAL</span><span class="delimiter">(</span><a title="Inliners.this.global.icodes.Local" id="383047">l</a><span class="delimiter">)</span> <span class="keyword">if</span> <a href="#382821" title="(l: Inliners.this.global.icodes.Local)Boolean">isInlined</a><span class="delimiter">(</span><a href="#383047" title="Inliners.this.global.icodes.Local">l</a><span class="delimiter">)</span> =&gt; <a href="../icode/Opcodes.scala.html#327716" title="(local: Inliners.this.global.icodes.Local)Inliners.this.global.icodes.opcodes.STORE_LOCAL">STORE_LOCAL</a><span class="delimiter">(</span><a href="#382562" title="(key: Inliners.this.global.icodes.Local)Inliners.this.global.icodes.Local">inlinedLocals</a><span class="delimiter">(</span><a href="#383047" title="Inliners.this.global.icodes.Local">l</a><span class="delimiter">)</span><span class="delimiter">)</span>
            <span class="keyword">case</span> <span title="Inliners.this.global.icodes.Instruction">LOAD_LOCAL</span><span class="delimiter">(</span><a title="Inliners.this.global.icodes.Local" id="383069">l</a><span class="delimiter">)</span>                  =&gt; <a href="#382820" title="(l: Inliners.this.global.icodes.Local)Inliners.this.global.icodes.Instruction">assertLocal</a><span class="delimiter">(</span><a href="#383069" title="Inliners.this.global.icodes.Local">l</a><span class="delimiter">)</span>
            <span class="keyword">case</span> <span title="Inliners.this.global.icodes.Instruction">STORE_LOCAL</span><span class="delimiter">(</span><a title="Inliners.this.global.icodes.Local" id="383071">l</a><span class="delimiter">)</span>                 =&gt; <a href="#382820" title="(l: Inliners.this.global.icodes.Local)Inliners.this.global.icodes.Instruction">assertLocal</a><span class="delimiter">(</span><a href="#383071" title="Inliners.this.global.icodes.Local">l</a><span class="delimiter">)</span>
            <span class="keyword">case</span> <span title="Inliners.this.global.icodes.opcodes.SCOPE_ENTER">SCOPE_ENTER</span><span class="delimiter">(</span><a title="Inliners.this.global.icodes.Local" id="383073">l</a><span class="delimiter">)</span> <span class="keyword">if</span> <a href="#382821" title="(l: Inliners.this.global.icodes.Local)Boolean">isInlined</a><span class="delimiter">(</span><a href="#383073" title="Inliners.this.global.icodes.Local">l</a><span class="delimiter">)</span> =&gt; <a href="../icode/Opcodes.scala.html#332178" title="(lv: Inliners.this.global.icodes.Local)Inliners.this.global.icodes.opcodes.SCOPE_ENTER">SCOPE_ENTER</a><span class="delimiter">(</span><a href="#382562" title="(key: Inliners.this.global.icodes.Local)Inliners.this.global.icodes.Local">inlinedLocals</a><span class="delimiter">(</span><a href="#383073" title="Inliners.this.global.icodes.Local">l</a><span class="delimiter">)</span><span class="delimiter">)</span>
            <span class="keyword">case</span> <span title="Inliners.this.global.icodes.opcodes.SCOPE_EXIT">SCOPE_EXIT</span><span class="delimiter">(</span><a title="Inliners.this.global.icodes.Local" id="383096">l</a><span class="delimiter">)</span> <span class="keyword">if</span> <a href="#382821" title="(l: Inliners.this.global.icodes.Local)Boolean">isInlined</a><span class="delimiter">(</span><a href="#383096" title="Inliners.this.global.icodes.Local">l</a><span class="delimiter">)</span>  =&gt; <a href="../icode/Opcodes.scala.html#327685" title="(lv: Inliners.this.global.icodes.Local)Inliners.this.global.icodes.opcodes.SCOPE_EXIT">SCOPE_EXIT</a><span class="delimiter">(</span><a href="#382562" title="(key: Inliners.this.global.icodes.Local)Inliners.this.global.icodes.Local">inlinedLocals</a><span class="delimiter">(</span><a href="#383096" title="Inliners.this.global.icodes.Local">l</a><span class="delimiter">)</span><span class="delimiter">)</span>

            <span class="keyword">case</span> <a title="Inliners.this.global.icodes.opcodes.NEW" id="383118">nw</a> @ NEW<span class="delimiter">(</span><a title="Inliners.this.global.icodes.REFERENCE" id="383120">sym</a><span class="delimiter">)</span> =&gt;
              <span class="keyword">val</span> <a title="Inliners.this.global.icodes.opcodes.NEW" id="383121">r</a> = <a href="../icode/Opcodes.scala.html#332528" title="(kind: Inliners.this.global.icodes.REFERENCE)Inliners.this.global.icodes.opcodes.NEW">NEW</a><span class="delimiter">(</span><a href="#383120" title="Inliners.this.global.icodes.REFERENCE">sym</a><span class="delimiter">)</span>
              <a href="#382567" title="(key: Inliners.this.global.icodes.Instruction, value: Inliners.this.global.icodes.opcodes.NEW)Unit">pending</a><span class="delimiter">(</span><a href="#383118" title="Inliners.this.global.icodes.opcodes.NEW">nw</a>.<a href="../icode/Opcodes.scala.html#332536" title="=&gt; Inliners.this.global.icodes.opcodes.CALL_METHOD">init</a><span class="delimiter">)</span> = <a href="#383121" title="Inliners.this.global.icodes.opcodes.NEW">r</a>
              <a href="#383121" title="Inliners.this.global.icodes.opcodes.NEW">r</a>

            <span class="keyword">case</span> <span title="Inliners.this.global.icodes.opcodes.CALL_METHOD">CALL_METHOD</span><span class="delimiter">(</span><a title="Inliners.this.global.icodes.global.Symbol" id="383128">meth</a>, Static<span class="delimiter">(</span><span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="keyword">if</span> <a href="#383128" title="Inliners.this.global.icodes.global.Symbol">meth</a>.<a href="../../../../reflect/internal/Symbols.scala.html#46490" title="=&gt; Boolean">isClassConstructor</a> =&gt;
              <a href="../icode/Opcodes.scala.html#332759" title="(method: Inliners.this.global.icodes.global.Symbol, style: Inliners.this.global.icodes.opcodes.InvokeStyle)Inliners.this.global.icodes.opcodes.CALL_METHOD">CALL_METHOD</a><span class="delimiter">(</span><a href="#383128" title="Inliners.this.global.icodes.global.Symbol">meth</a>, <a href="../icode/Opcodes.scala.html#333068" title="(onInstance: Boolean)Inliners.this.global.icodes.opcodes.Static">Static</a><span class="delimiter">(</span><span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span><span class="delimiter">)</span>

            <span class="keyword">case</span> <span title="Inliners.this.global.icodes.Instruction">_</span> =&gt; <a href="#382819" title="Inliners.this.global.icodes.Instruction">i</a>.<a href="../icode/Opcodes.scala.html#322693" title="()Inliners.this.global.icodes.Instruction">clone</a><span class="delimiter">(</span><span class="delimiter">)</span>
          <span class="delimiter">}</span>
          // check any pending NEW's
          <a href="#382567" title="scala.collection.mutable.Map[Inliners.this.global.icodes.Instruction,Inliners.this.global.icodes.opcodes.NEW]">pending</a> <span title="(key: Inliners.this.global.icodes.Instruction)Option[Inliners.this.global.icodes.opcodes.NEW]">remove</span> <a href="#382819" title="Inliners.this.global.icodes.Instruction">i</a> <span title="(f: Inliners.this.global.icodes.opcodes.NEW =&gt; Unit)Unit">foreach</span> <span class="delimiter">(</span><a href="#383139" title="Inliners.this.global.icodes.opcodes.NEW">_</a>.<a href="../icode/Opcodes.scala.html#332537" title="(x$1: Inliners.this.global.icodes.opcodes.CALL_METHOD)Unit">init</a> = <a href="#382822" title="Inliners.this.global.icodes.Instruction">newInstr</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="Inliners.this.global.icodes.opcodes.CALL_METHOD" class="delimiter">[</span><a href="../icode/Opcodes.scala.html#244532" title="Inliners.this.global.icodes.opcodes.CALL_METHOD">CALL_METHOD</a><span class="delimiter">]</span><span class="delimiter">)</span>
          <a href="#382822" title="Inliners.this.global.icodes.Instruction">newInstr</a>
        <span class="delimiter">}</span>

        <a href="#381778" title="=&gt; Inliner.this.IMethodInfo">caller</a> <a href="#381579" title="(ls: List[Inliners.this.global.icodes.Local])Unit">addLocals</a> <span class="delimiter">(</span><a href="#381779" title="=&gt; Inliner.this.IMethodInfo">inc</a>.<a href="#381567" title="=&gt; List[Inliners.this.global.icodes.Local]">locals</a> <span title="(f: Inliners.this.global.icodes.Local =&gt; Inliners.this.global.icodes.Local)(implicit bf: scala.collection.generic.CanBuildFrom[List[Inliners.this.global.icodes.Local],Inliners.this.global.icodes.Local,List[Inliners.this.global.icodes.Local]])List[Inliners.this.global.icodes.Local]">map</span> <a href="#382565" title="(l: Inliners.this.global.icodes.Local)Inliners.this.global.icodes.Local">dupLocal</a><span class="delimiter">)</span>
        <a href="#381778" title="=&gt; Inliner.this.IMethodInfo">caller</a> <a href="#381580" title="(l: Inliners.this.global.icodes.Local)Unit">addLocal</a> <a href="#382560" title="Inliners.this.global.icodes.Local">inlinedThis</a>

        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#382561" title="Inliners.this.global.icodes.Local">retVal</a> <span title="(x$1: AnyRef)Boolean">ne</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span>
          <a href="#381778" title="=&gt; Inliner.this.IMethodInfo">caller</a> <a href="#381580" title="(l: Inliners.this.global.icodes.Local)Unit">addLocal</a> <a href="#382561" title="Inliners.this.global.icodes.Local">retVal</a>

        <a href="#381779" title="=&gt; Inliner.this.IMethodInfo">inc</a>.<a href="#381582" title="=&gt; Inliners.this.global.icodes.IMethod">m</a> <a href="../icode/Members.scala.html#322219" title="(f: Inliners.this.global.icodes.BasicBlock =&gt; scala.collection.mutable.Set[Inliners.this.global.icodes.Local])Unit">foreachBlock</a> <span class="delimiter">{</span> <a title="Inliners.this.global.icodes.BasicBlock" id="383193">b</a> =&gt;
          <a href="#382555" title="scala.collection.mutable.Map[Inliners.this.global.icodes.BasicBlock,Inliners.this.global.icodes.BasicBlock]">inlinedBlock</a> <span title="(kv: (Inliners.this.global.icodes.BasicBlock, Inliners.this.global.icodes.BasicBlock))inlinedBlock.type">+=</span> <span class="delimiter">(</span><a href="#383193" title="(x: Inliners.this.global.icodes.BasicBlock)ArrowAssoc[Inliners.this.global.icodes.BasicBlock]">b</a> <span title="(y: Inliners.this.global.icodes.BasicBlock)(Inliners.this.global.icodes.BasicBlock, Inliners.this.global.icodes.BasicBlock)">-&gt;</span> <a href="#382563" title="()Inliners.this.global.icodes.BasicBlock">newBlock</a><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
          <a href="#382555" title="(key: Inliners.this.global.icodes.BasicBlock)Inliners.this.global.icodes.BasicBlock">inlinedBlock</a><span class="delimiter">(</span><a href="#383193" title="Inliners.this.global.icodes.BasicBlock">b</a><span class="delimiter">)</span>.<a href="../icode/BasicBlocks.scala.html#322142" title="=&gt; scala.collection.mutable.Set[Inliners.this.global.icodes.Local]">varsInScope</a> <span title="(xs: scala.collection.TraversableOnce[Inliners.this.global.icodes.Local])scala.collection.mutable.Set[Inliners.this.global.icodes.Local]">++=</span> <span class="delimiter">(</span><a href="#383193" title="Inliners.this.global.icodes.BasicBlock">b</a>.<a href="../icode/BasicBlocks.scala.html#322142" title="=&gt; scala.collection.mutable.Set[Inliners.this.global.icodes.Local]">varsInScope</a> <span title="(f: Inliners.this.global.icodes.Local =&gt; Inliners.this.global.icodes.Local)(implicit bf: scala.collection.generic.CanBuildFrom[scala.collection.mutable.Set[Inliners.this.global.icodes.Local],Inliners.this.global.icodes.Local,scala.collection.TraversableOnce[Inliners.this.global.icodes.Local]])scala.collection.TraversableOnce[Inliners.this.global.icodes.Local]">map</span> <a href="#382562" title="scala.collection.mutable.HashMap[Inliners.this.global.icodes.Local,Inliners.this.global.icodes.Local]">inlinedLocals</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>

        // re-emit the instructions before the call
        <a href="#381802" title="Inliners.this.global.icodes.BasicBlock">block</a>.<a href="../icode/BasicBlocks.scala.html#322176" title="()Unit">open</a>
        <a href="#381802" title="Inliners.this.global.icodes.BasicBlock">block</a>.<a href="../icode/BasicBlocks.scala.html#322177" title="()Unit">clear</a>
        <a href="#381802" title="Inliners.this.global.icodes.BasicBlock">block</a> <a href="../icode/BasicBlocks.scala.html#322171" title="(is: Seq[Inliners.this.global.icodes.Instruction])Unit">emit</a> <a href="#382558" title="List[Inliners.this.global.icodes.Instruction]">instrBefore</a>

        // store the arguments into special locals
        <a href="#381779" title="=&gt; Inliner.this.IMethodInfo">inc</a>.<a href="#381582" title="=&gt; Inliners.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#322243" title="=&gt; List[Inliners.this.global.icodes.Local]">params</a>.<span title="=&gt; List[Inliners.this.global.icodes.Local]">reverse</span> <span title="(f: Inliners.this.global.icodes.Local =&gt; Unit)Unit">foreach</span> <span class="delimiter">(</span><a title="Inliners.this.global.icodes.Local" id="383312">p</a> =&gt; <a href="#382549" title="(i: Inliners.this.global.icodes.Instruction)Unit">blockEmit</a><span class="delimiter">(</span><a href="../icode/Opcodes.scala.html#327716" title="(local: Inliners.this.global.icodes.Local)Inliners.this.global.icodes.opcodes.STORE_LOCAL">STORE_LOCAL</a><span class="delimiter">(</span><a href="#382562" title="(key: Inliners.this.global.icodes.Local)Inliners.this.global.icodes.Local">inlinedLocals</a><span class="delimiter">(</span><a href="#383312" title="Inliners.this.global.icodes.Local">p</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
        <a href="#382549" title="(i: Inliners.this.global.icodes.Instruction)Unit">blockEmit</a><span class="delimiter">(</span><a href="../icode/Opcodes.scala.html#327716" title="(local: Inliners.this.global.icodes.Local)Inliners.this.global.icodes.opcodes.STORE_LOCAL">STORE_LOCAL</a><span class="delimiter">(</span><a href="#382560" title="Inliners.this.global.icodes.Local">inlinedThis</a><span class="delimiter">)</span><span class="delimiter">)</span>

        // jump to the start block of the callee
        <a href="#382549" title="(i: Inliners.this.global.icodes.Instruction)Unit">blockEmit</a><span class="delimiter">(</span><a href="../icode/Opcodes.scala.html#327593" title="(whereto: Inliners.this.global.icodes.BasicBlock)Inliners.this.global.icodes.opcodes.JUMP">JUMP</a><span class="delimiter">(</span><a href="#382555" title="(key: Inliners.this.global.icodes.BasicBlock)Inliners.this.global.icodes.BasicBlock">inlinedBlock</a><span class="delimiter">(</span><a href="#381779" title="=&gt; Inliner.this.IMethodInfo">inc</a>.<a href="#381582" title="=&gt; Inliners.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#322215" title="=&gt; Inliners.this.global.icodes.BasicBlock">startBlock</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
        <a href="#381802" title="Inliners.this.global.icodes.BasicBlock">block</a>.<a href="../icode/BasicBlocks.scala.html#322175" title="()Unit">close</a>

        // duplicate the other blocks in the callee
        <span class="keyword">val</span> <a title="List[Inliners.this.global.icodes.BasicBlock]" id="382569">calleeLin</a> = <a href="#381779" title="=&gt; Inliner.this.IMethodInfo">inc</a>.<a href="#381582" title="=&gt; Inliners.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#322218" title="(lin: Inliners.this.global.icodes.Linearizer)List[Inliners.this.global.icodes.BasicBlock]">linearizedBlocks</a><span class="delimiter">(</span><span class="delimiter">)</span>
        <a href="#382569" title="List[Inliners.this.global.icodes.BasicBlock]">calleeLin</a> <span title="(f: Inliners.this.global.icodes.BasicBlock =&gt; Unit)Unit">foreach</span> <span class="delimiter">{</span> <a title="Inliners.this.global.icodes.BasicBlock" id="383371">bb</a> =&gt;
          <span class="keyword">var</span> <a title="a.lattice.Elem" id="383372">info</a> = <span title="a.lattice.Elem" class="keyword">if</span><span class="delimiter">(</span><a href="#382552" title="Boolean">hasRETURN</a><span class="delimiter">)</span> <span class="delimiter">(</span><a href="#382553" title="Inliners.this.global.analysis.MethodTFA">a</a> <a href="../icode/analysis/DataFlowAnalysis.scala.html#348027" title="(key: a.P)a.lattice.Elem">in</a> <a href="#383371" title="Inliners.this.global.icodes.BasicBlock">bb</a><span class="delimiter">)</span> <span class="keyword">else</span> <span title="Null(null)" class="keyword">null</span>
          <span class="keyword">def</span> <a title="(i: Inliners.this.global.icodes.Instruction)Unit" id="383373">emitInlined</a><span class="delimiter">(</span><a title="Inliners.this.global.icodes.Instruction" id="383398">i</a>: <a href="../icode/Opcodes.scala.html#232653" title="Inliners.this.global.icodes.Instruction">Instruction</a><span class="delimiter">)</span> = <a href="#382555" title="(key: Inliners.this.global.icodes.BasicBlock)Inliners.this.global.icodes.BasicBlock">inlinedBlock</a><span class="delimiter">(</span><a href="#383371" title="Inliners.this.global.icodes.BasicBlock">bb</a><span class="delimiter">)</span>.<a href="../icode/BasicBlocks.scala.html#322170" title="(instr: Inliners.this.global.icodes.Instruction, pos: scala.tools.nsc.util.Position)Unit">emit</a><span class="delimiter">(</span><a href="#383398" title="Inliners.this.global.icodes.Instruction">i</a>, <a href="#382548" title="scala.tools.nsc.util.Position">targetPos</a><span class="delimiter">)</span>
          <span class="keyword">def</span> <a title="(toDrop: Int)Unit" id="383374">emitDrops</a><span class="delimiter">(</span><a title="Int" id="383420">toDrop</a>: <span title="Int">Int</span><span class="delimiter">)</span>      = <a href="#383372" title="a.lattice.Elem">info</a>.<a href="../icode/analysis/SemiLattice.scala.html#350521" title="=&gt; Inliners.this.global.analysis.global.icodes.TypeStack">stack</a>.<a href="../icode/TypeStacks.scala.html#336239" title="=&gt; Inliners.this.global.analysis.global.icodes.Rep">types</a> <span title="(n: Int)List[Inliners.this.global.analysis.global.icodes.TypeKind]">drop</span> <a href="#383420" title="Int">toDrop</a> <span title="(f: Inliners.this.global.analysis.global.icodes.TypeKind =&gt; Unit)Unit">foreach</span> <span class="delimiter">(</span><a title="Inliners.this.global.analysis.global.icodes.TypeKind" id="383447">t</a> =&gt; <a href="#383373" title="(i: Inliners.this.global.icodes.Instruction)Unit">emitInlined</a><span class="delimiter">(</span><a href="../icode/Opcodes.scala.html#331286" title="(typ: Inliners.this.global.icodes.TypeKind)Inliners.this.global.icodes.opcodes.DROP">DROP</a><span class="delimiter">(</span><a href="#383447" title="Inliners.this.global.analysis.global.icodes.TypeKind">t</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>

          <span class="keyword">for</span> <span class="delimiter">(</span><a title="Inliners.this.global.icodes.Instruction" id="383455">i</a> &lt;- <a href="../icode/BasicBlocks.scala.html#322156" title="(f: Inliners.this.global.icodes.Instruction =&gt; Unit)Unit">bb</a><span class="delimiter">)</span> <span class="delimiter">{</span>
            <a href="#383455" title="Inliners.this.global.icodes.Instruction">i</a> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
              <span class="keyword">case</span> <span title="Unit">RETURN</span><span class="delimiter">(</span><a href="../icode/TypeKinds.scala.html#232677" title="object Inliners.this.global.icodes.UNIT">UNIT</a><span class="delimiter">)</span> =&gt; <a href="#383374" title="(toDrop: Int)Unit">emitDrops</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
              <span class="keyword">case</span> <span title="Unit">RETURN</span><span class="delimiter">(</span><a title="Inliners.this.global.icodes.TypeKind" id="383458">kind</a><span class="delimiter">)</span> =&gt;
                <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#383372" title="a.lattice.Elem">info</a>.<a href="../icode/analysis/SemiLattice.scala.html#350521" title="=&gt; Inliners.this.global.analysis.global.icodes.TypeStack">stack</a>.<a href="../icode/TypeStacks.scala.html#336245" title="=&gt; Int">length</a> <span title="(x: Int)Boolean">&gt;</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span> <span class="delimiter">{</span>
                  <a href="#383373" title="(i: Inliners.this.global.icodes.Instruction)Unit">emitInlined</a><span class="delimiter">(</span><a href="../icode/Opcodes.scala.html#327716" title="(local: Inliners.this.global.icodes.Local)Inliners.this.global.icodes.opcodes.STORE_LOCAL">STORE_LOCAL</a><span class="delimiter">(</span><a href="#382561" title="Inliners.this.global.icodes.Local">retVal</a><span class="delimiter">)</span><span class="delimiter">)</span>
                  <a href="#383374" title="(toDrop: Int)Unit">emitDrops</a><span class="delimiter">(</span><span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
                  <a href="#383373" title="(i: Inliners.this.global.icodes.Instruction)Unit">emitInlined</a><span class="delimiter">(</span><a href="../icode/Opcodes.scala.html#330875" title="(local: Inliners.this.global.icodes.Local)Inliners.this.global.icodes.opcodes.LOAD_LOCAL">LOAD_LOCAL</a><span class="delimiter">(</span><a href="#382561" title="Inliners.this.global.icodes.Local">retVal</a><span class="delimiter">)</span><span class="delimiter">)</span>
                <span class="delimiter">}</span>
              <span class="keyword">case</span> <span title="Unit">_</span>            =&gt; <span title="Unit" class="delimiter">(</span><span class="delimiter">)</span>
            <span class="delimiter">}</span>
            <a href="#383373" title="(i: Inliners.this.global.icodes.Instruction)Unit">emitInlined</a><span class="delimiter">(</span><a href="#382568" title="(i: Inliners.this.global.icodes.Instruction)Inliners.this.global.icodes.Instruction">map</a><span class="delimiter">(</span><a href="#383455" title="Inliners.this.global.icodes.Instruction">i</a><span class="delimiter">)</span><span class="delimiter">)</span>
            <a href="#383372" title="a.lattice.Elem">info</a> = <span title="a.lattice.Elem" class="keyword">if</span><span class="delimiter">(</span><a href="#382552" title="Boolean">hasRETURN</a><span class="delimiter">)</span> <a href="#382553" title="Inliners.this.global.analysis.MethodTFA">a</a>.<a href="../icode/analysis/TypeFlowAnalysis.scala.html#353265" title="(in: Inliners.this.global.analysis.typeFlowLattice.Elem, i: Inliners.this.global.analysis.global.icodes.Instruction)Inliners.this.global.analysis.typeFlowLattice.Elem">interpret</a><span class="delimiter">(</span><a href="#383372" title="a.lattice.Elem">info</a>, <a href="#383455" title="Inliners.this.global.icodes.Instruction">i</a><span class="delimiter">)</span> <span class="keyword">else</span> <span title="Null(null)" class="keyword">null</span>
          <span class="delimiter">}</span>
          <a href="#382555" title="(key: Inliners.this.global.icodes.BasicBlock)Inliners.this.global.icodes.BasicBlock">inlinedBlock</a><span class="delimiter">(</span><a href="#383371" title="Inliners.this.global.icodes.BasicBlock">bb</a><span class="delimiter">)</span>.<a href="../icode/BasicBlocks.scala.html#322175" title="()Unit">close</a>
        <span class="delimiter">}</span>

        <a href="#382566" title="Inliners.this.global.icodes.BasicBlock">afterBlock</a> <a href="../icode/BasicBlocks.scala.html#322171" title="(is: Seq[Inliners.this.global.icodes.Instruction])Unit">emit</a> <a href="#382559" title="List[Inliners.this.global.icodes.Instruction]">instrAfter</a>
        <a href="#382566" title="Inliners.this.global.icodes.BasicBlock">afterBlock</a>.<a href="../icode/BasicBlocks.scala.html#322175" title="()Unit">close</a>

        <a href="#381376" title="=&gt; scala.collection.mutable.Set[Inliners.this.global.icodes.BasicBlock]">staleIn</a>        <span title="(elem: Inliners.this.global.icodes.BasicBlock)Inliner.this.staleIn.type">+=</span> <a href="#382566" title="Inliners.this.global.icodes.BasicBlock">afterBlock</a>
        <a href="#381374" title="=&gt; scala.collection.mutable.Set[Inliners.this.global.icodes.BasicBlock]">splicedBlocks</a> <span title="(xs: scala.collection.TraversableOnce[Inliners.this.global.icodes.BasicBlock])Inliner.this.splicedBlocks.type">++=</span> <span class="delimiter">(</span><a href="#382569" title="List[Inliners.this.global.icodes.BasicBlock]">calleeLin</a> <span title="(f: Inliners.this.global.icodes.BasicBlock =&gt; Inliners.this.global.icodes.BasicBlock)(implicit bf: scala.collection.generic.CanBuildFrom[List[Inliners.this.global.icodes.BasicBlock],Inliners.this.global.icodes.BasicBlock,scala.collection.TraversableOnce[Inliners.this.global.icodes.BasicBlock]])scala.collection.TraversableOnce[Inliners.this.global.icodes.BasicBlock]">map</span> <a href="#382555" title="scala.collection.mutable.Map[Inliners.this.global.icodes.BasicBlock,Inliners.this.global.icodes.BasicBlock]">inlinedBlock</a><span class="delimiter">)</span>

        // add exception handlers of the callee
        <a href="#381778" title="=&gt; Inliner.this.IMethodInfo">caller</a> <a href="#381581" title="(exhs: List[Inliners.this.global.icodes.ExceptionHandler])Unit">addHandlers</a> <span class="delimiter">(</span><a href="#381779" title="=&gt; Inliner.this.IMethodInfo">inc</a>.<a href="#381565" title="=&gt; List[Inliners.this.global.icodes.ExceptionHandler]">handlers</a> <span title="(f: Inliners.this.global.icodes.ExceptionHandler =&gt; Inliners.this.global.icodes.ExceptionHandler)(implicit bf: scala.collection.generic.CanBuildFrom[List[Inliners.this.global.icodes.ExceptionHandler],Inliners.this.global.icodes.ExceptionHandler,List[Inliners.this.global.icodes.ExceptionHandler]])List[Inliners.this.global.icodes.ExceptionHandler]">map</span> <a href="#382564" title="(e: Inliners.this.global.icodes.ExceptionHandler)Inliners.this.global.icodes.ExceptionHandler">translateExh</a><span class="delimiter">)</span>
        <a href="../../Global.scala.html#186183" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a><span class="delimiter">(</span><a href="#382567" title="scala.collection.mutable.Map[Inliners.this.global.icodes.Instruction,Inliners.this.global.icodes.opcodes.NEW]">pending</a>.<span title="=&gt; Boolean">isEmpty</span>, <span title="String(&quot;Pending NEW elements: &quot;)" class="string">&quot;Pending NEW elements: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#382567" title="scala.collection.mutable.Map[Inliners.this.global.icodes.Instruction,Inliners.this.global.icodes.opcodes.NEW]">pending</a><span class="delimiter">)</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="../../Global.scala.html#186138" title="=&gt; scala.tools.nsc.Settings">settings</a>.<a href="../../settings/ScalaSettings.scala.html#186768" title="=&gt; scala.tools.nsc.Settings#BooleanSetting">debug</a>.<a href="../../settings/MutableSettings.scala.html#187054" title="=&gt; Boolean">value</a><span class="delimiter">)</span> <a href="../../Global.scala.html#186153" title="object Inliners.this.global.icodes">icodes</a>.<a href="../icode/ICodes.scala.html#232602" title="(m: Inliners.this.global.icodes.IMethod)Unit">checkValid</a><span class="delimiter">(</span><a href="#381778" title="=&gt; Inliner.this.IMethodInfo">caller</a>.<a href="#381582" title="=&gt; Inliners.this.global.icodes.IMethod">m</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>

      <span class="keyword">def</span> <a title="(stackLength: Int)Boolean" id="381767">isStampedForInlining</a><span class="delimiter">(</span><a title="Int" id="381782">stackLength</a>: <span title="Int">Int</span><span class="delimiter">)</span> =
        <span title="=&gt; Boolean">!</span><a href="#381771" title="=&gt; Boolean">sameSymbols</a> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#381779" title="=&gt; Inliner.this.IMethodInfo">inc</a>.<a href="#381582" title="=&gt; Inliners.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#322246" title="=&gt; Boolean">hasCode</a> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#381777" title="=&gt; Boolean">shouldInline</a> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#381773" title="(stackLength: Int)Boolean">isSafeToInline</a><span class="delimiter">(</span><a href="#381782" title="Int">stackLength</a><span class="delimiter">)</span>

      <span class="keyword">def</span> <a title="(stackLength: Int)Unit" id="381768">logFailure</a><span class="delimiter">(</span><a title="Int" id="381867">stackLength</a>: <span title="Int">Int</span><span class="delimiter">)</span> = <a href="../../Global.scala.html#186199" title="(msg: =&gt; AnyRef)Unit">log</a><span class="delimiter">(</span>
        <span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;&quot;&quot;|inline failed for %s:
           |  pair.sameSymbols: %s
           |  inc.numInlined &lt; 2: %s
           |  inc.m.hasCode: %s
           |  isSafeToInline: %s
           |  shouldInline: %s
        &quot;&quot;&quot;</span>.<span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">stripMargin</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span>
          <a href="#381779" title="=&gt; Inliner.this.IMethodInfo">inc</a>.<a href="#381582" title="=&gt; Inliners.this.global.icodes.IMethod">m</a>, <a href="#381771" title="=&gt; Boolean">sameSymbols</a>, <a href="#381781" title="(key: Inliners.this.global.Symbol)Int">inlinedMethodCount</a><span class="delimiter">(</span><a href="#381779" title="=&gt; Inliner.this.IMethodInfo">inc</a>.<a href="#381551" title="=&gt; Inliners.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span> <span title="(x: Int)Boolean">&lt;</span> <span title="Int(2)" class="int">2</span>,
          <a href="#381779" title="=&gt; Inliner.this.IMethodInfo">inc</a>.<a href="#381582" title="=&gt; Inliners.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#322246" title="=&gt; Boolean">hasCode</a>, <a href="#381773" title="(stackLength: Int)Boolean">isSafeToInline</a><span class="delimiter">(</span><a href="#381867" title="Int">stackLength</a><span class="delimiter">)</span>, <a href="#381777" title="=&gt; Boolean">shouldInline</a>
        <span class="delimiter">)</span>
      <span class="delimiter">)</span>

      <span class="keyword">def</span> <a title="(stackLength: Int)String" id="381769">failureReason</a><span class="delimiter">(</span><a title="Int" id="381924">stackLength</a>: <span title="Int">Int</span><span class="delimiter">)</span> =
        <span title="String" class="keyword">if</span> <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#381779" title="=&gt; Inliner.this.IMethodInfo">inc</a>.<a href="#381582" title="=&gt; Inliners.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#322246" title="=&gt; Boolean">hasCode</a><span class="delimiter">)</span> <span title="String(&quot;bytecode was unavailable&quot;)" class="string">&quot;bytecode was unavailable&quot;</span>
        <span class="keyword">else</span> <span title="String" class="keyword">if</span> <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#381773" title="(stackLength: Int)Boolean">isSafeToInline</a><span class="delimiter">(</span><a href="#381924" title="Int">stackLength</a><span class="delimiter">)</span><span class="delimiter">)</span> <span title="String(&quot;it is unsafe (target may reference private fields)&quot;)" class="string">&quot;it is unsafe (target may reference private fields)&quot;</span>
        <span class="keyword">else</span> <span title="String(&quot;of a bug (run with -Ylog:inline -Ydebug for more information)&quot;)" class="string">&quot;of a bug (run with -Ylog:inline -Ydebug for more information)&quot;</span>

      <span class="keyword">def</span> <a title="(level: Inliner.this.NonPublicRefs.Value)Boolean" id="381770">canAccess</a><span class="delimiter">(</span><a title="Inliner.this.NonPublicRefs.Value" id="383598">level</a>: NonPublicRefs.<span title="Inliner.this.NonPublicRefs.Value">Value</span><span class="delimiter">)</span> = <a href="#383598" title="Inliner.this.NonPublicRefs.Value">level</a> <span title="Boolean" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <a href="#381397" title="Boolean">Private</a>    =&gt; <a href="#381778" title="=&gt; Inliner.this.IMethodInfo">caller</a>.<a href="#381555" title="=&gt; Inliners.this.global.icodes.global.Symbol">owner</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#381779" title="=&gt; Inliner.this.IMethodInfo">inc</a>.<a href="#381555" title="=&gt; Inliners.this.global.icodes.global.Symbol">owner</a>
        <span class="keyword">case</span> <a href="#381399" title="Boolean">Protected</a>  =&gt; <a href="#381778" title="=&gt; Inliner.this.IMethodInfo">caller</a>.<a href="#381555" title="=&gt; Inliners.this.global.icodes.global.Symbol">owner</a>.<a href="../../../../reflect/internal/Symbols.scala.html#46606" title="=&gt; Inliners.this.global.icodes.global.Type">tpe</a> <a href="../../../../reflect/internal/Types.scala.html#41571" title="(that: Inliners.this.global.icodes.global.Type)Boolean">&lt;:&lt;</a> <a href="#381779" title="=&gt; Inliner.this.IMethodInfo">inc</a>.<a href="#381555" title="=&gt; Inliners.this.global.icodes.global.Symbol">owner</a>.<a href="../../../../reflect/internal/Symbols.scala.html#46606" title="=&gt; Inliners.this.global.icodes.global.Type">tpe</a>
        <span class="keyword">case</span> <a href="#381401" title="Boolean(true)">Public</a>     =&gt; <span title="Boolean(true)" class="keyword">true</span>
      <span class="delimiter">}</span>
      <span class="keyword">private</span> <span class="keyword">def</span> <a title="=&gt; Boolean" id="381771">sameSymbols</a> = <a href="#381778" title="=&gt; Inliner.this.IMethodInfo">caller</a>.<a href="#381551" title="=&gt; Inliners.this.global.icodes.global.Symbol">sym</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#381779" title="=&gt; Inliner.this.IMethodInfo">inc</a>.<a href="#381551" title="=&gt; Inliners.this.global.icodes.global.Symbol">sym</a>
      <span class="keyword">private</span> <span class="keyword">def</span> <a title="=&gt; Boolean" id="381772">sameOwner</a>   = <a href="#381778" title="=&gt; Inliner.this.IMethodInfo">caller</a>.<a href="#381555" title="=&gt; Inliners.this.global.icodes.global.Symbol">owner</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#381779" title="=&gt; Inliner.this.IMethodInfo">inc</a>.<a href="#381555" title="=&gt; Inliners.this.global.icodes.global.Symbol">owner</a>

      /** A method is safe to inline when:
       *    - it does not contain calls to private methods when called from another class
       *    - it is not inlined into a position with non-empty stack,
       *      while having a top-level finalizer (see liftedTry problem)
       *    - it is not recursive
       * Note:
       *    - synthetic private members are made public in this pass.
       */
      <span class="keyword">def</span> <a title="(stackLength: Int)Boolean" id="381773">isSafeToInline</a><span class="delimiter">(</span><a title="Int" id="381794">stackLength</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> = <span class="delimiter">{</span>

        <span title="Unit" class="keyword">if</span><span class="delimiter">(</span><a href="#381370" title="=&gt; Inliners.this.global.analysis.MTFAGrowable">tfa</a>.<a href="../icode/analysis/TypeFlowAnalysis.scala.html#354573" title="(msym: Inliners.this.global.analysis.global.Symbol)Boolean">blackballed</a><span class="delimiter">(</span><a href="#381779" title="=&gt; Inliner.this.IMethodInfo">inc</a>.<a href="#381551" title="=&gt; Inliners.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span> <span title="Nothing" class="keyword">return</span> <span title="Boolean(false)" class="keyword">false</span> <span class="delimiter">}</span>
        <span title="Unit" class="keyword">if</span><span class="delimiter">(</span><a href="#381370" title="=&gt; Inliners.this.global.analysis.MTFAGrowable">tfa</a>.<a href="../icode/analysis/TypeFlowAnalysis.scala.html#354569" title="(elem: Inliners.this.global.analysis.global.Symbol)Boolean">knownSafe</a><span class="delimiter">(</span><a href="#381779" title="=&gt; Inliner.this.IMethodInfo">inc</a>.<a href="#381551" title="=&gt; Inliners.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span><span class="delimiter">)</span>   <span class="delimiter">{</span> <span title="Nothing" class="keyword">return</span> <span title="Boolean(true)" class="keyword">true</span>  <span class="delimiter">}</span>

        <span title="Boolean" class="keyword">if</span><span class="delimiter">(</span><a href="#381774" title="(stackLength: Int)Boolean">helperIsSafeToInline</a><span class="delimiter">(</span><a href="#381794" title="Int">stackLength</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="#381370" title="=&gt; Inliners.this.global.analysis.MTFAGrowable">tfa</a>.<a href="../icode/analysis/TypeFlowAnalysis.scala.html#354569" title="=&gt; scala.collection.mutable.Set[Inliners.this.global.analysis.global.Symbol]">knownSafe</a> <span title="(elem: Inliners.this.global.analysis.global.Symbol)Inliner.this.tfa.knownSafe.type">+=</span> <a href="#381779" title="=&gt; Inliner.this.IMethodInfo">inc</a>.<a href="#381551" title="=&gt; Inliners.this.global.icodes.global.Symbol">sym</a>;   <span title="Boolean(true)" class="keyword">true</span>
        <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
          <a href="#381370" title="=&gt; Inliners.this.global.analysis.MTFAGrowable">tfa</a>.<a href="../icode/analysis/TypeFlowAnalysis.scala.html#354567" title="=&gt; scala.collection.mutable.Set[Inliners.this.global.analysis.global.Symbol]">knownUnsafe</a> <span title="(elem: Inliners.this.global.analysis.global.Symbol)Inliner.this.tfa.knownUnsafe.type">+=</span> <a href="#381779" title="=&gt; Inliner.this.IMethodInfo">inc</a>.<a href="#381551" title="=&gt; Inliners.this.global.icodes.global.Symbol">sym</a>; <span title="Boolean(false)" class="keyword">false</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>

      <span class="keyword">private</span> <span class="keyword">def</span> <a title="(stackLength: Int)Boolean" id="381774">helperIsSafeToInline</a><span class="delimiter">(</span><a title="Int" id="383638">stackLength</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> = <span class="delimiter">{</span>
        <span class="keyword">def</span> <a title="(f: Inliners.this.global.Symbol)Boolean" id="383656">makePublic</a><span class="delimiter">(</span><a title="Inliners.this.global.Symbol" id="383658">f</a>: <a href="../../../../reflect/internal/Symbols.scala.html#38726" title="Inliners.this.global.Symbol">Symbol</a><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> =
          <span class="delimiter">(</span><a href="#381779" title="=&gt; Inliner.this.IMethodInfo">inc</a>.<a href="#381582" title="=&gt; Inliners.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#322231" title="=&gt; scala.tools.nsc.util.SourceFile">sourceFile</a> <span title="(x$1: AnyRef)Boolean">ne</span> <a href="../../util/SourceFile.scala.html#33836" title="object scala.tools.nsc.util.NoSourceFile">NoSourceFile</a><span class="delimiter">)</span> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <span class="delimiter">(</span><a href="#383658" title="Inliners.this.global.Symbol">f</a>.<a href="../../../../reflect/internal/HasFlags.scala.html#46784" title="=&gt; Boolean">isSynthetic</a> <span title="(x: Boolean)Boolean">||</span> <a href="#383658" title="Inliners.this.global.Symbol">f</a>.<a href="../../../../reflect/internal/HasFlags.scala.html#46788" title="=&gt; Boolean">isParamAccessor</a><span class="delimiter">)</span> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <span class="delimiter">{</span>
            <a href="../../Global.scala.html#186189" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><span title="String(&quot;Making not-private symbol out of synthetic: &quot;)" class="string">&quot;Making not-private symbol out of synthetic: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#383658" title="Inliners.this.global.Symbol">f</a><span class="delimiter">)</span>

            <a href="#383658" title="Inliners.this.global.Symbol">f</a> <a href="../../../../reflect/internal/Symbols.scala.html#46595" title="(flag: Int)Any">setNotFlag</a> Flags.<span title="Int(4)">PRIVATE</span>
            <span title="Boolean(true)" class="keyword">true</span>
          <span class="delimiter">}</span>

        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#381779" title="=&gt; Inliner.this.IMethodInfo">inc</a>.<a href="#381582" title="=&gt; Inliners.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#322246" title="=&gt; Boolean">hasCode</a> <span title="(x: Boolean)Boolean">||</span> <a href="#381779" title="=&gt; Inliner.this.IMethodInfo">inc</a>.<a href="#381573" title="=&gt; Boolean">isRecursive</a><span class="delimiter">)</span>
          <span title="Nothing" class="keyword">return</span> <span title="Boolean(false)" class="keyword">false</span>

        <span class="keyword">val</span> <a title="Inliner.this.NonPublicRefs.Value" id="383657">accessNeeded</a> = <a href="#381403" title="=&gt; scala.collection.mutable.Map[Inliners.this.global.icodes.IMethod,Inliner.this.NonPublicRefs.Value]">usesNonPublics</a>.<span title="(key: Inliners.this.global.icodes.IMethod, op: =&gt; Inliner.this.NonPublicRefs.Value)Inliner.this.NonPublicRefs.Value">getOrElseUpdate</span><span class="delimiter">(</span><a href="#381779" title="=&gt; Inliner.this.IMethodInfo">inc</a>.<a href="#381582" title="=&gt; Inliners.this.global.icodes.IMethod">m</a>, <span class="delimiter">{</span>
          // Avoiding crashing the compiler if there are open blocks.
          <a href="#381779" title="=&gt; Inliner.this.IMethodInfo">inc</a>.<a href="#381569" title="=&gt; List[Inliners.this.global.icodes.BasicBlock]">openBlocks</a> <span title="(f: Inliners.this.global.icodes.BasicBlock =&gt; Nothing)Unit">foreach</span> <span class="delimiter">{</span> <a title="Inliners.this.global.icodes.BasicBlock" id="383688">b</a> =&gt;
            <a href="#381364" title="(pos: Inliners.this.global.Position, msg: String)Unit">warn</a><span class="delimiter">(</span><a href="#381779" title="=&gt; Inliner.this.IMethodInfo">inc</a>.<a href="#381551" title="=&gt; Inliners.this.global.icodes.global.Symbol">sym</a>.<a href="../../../../reflect/internal/Symbols.scala.html#46379" title="=&gt; Inliners.this.global.icodes.global.Position">pos</a>,
                <span class="string">&quot;Encountered open block in isSafeToInline: this indicates a bug in the optimizer!\n&quot;</span> <span title="String(&quot;Encountered open block in isSafeToInline: this indicates a bug in the optimizer!\n  caller = &quot;)">+</span>
                <span class="string">&quot;  caller = &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#381778" title="=&gt; Inliner.this.IMethodInfo">caller</a>.<a href="#381582" title="=&gt; Inliners.this.global.icodes.IMethod">m</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;, callee = &quot;)" class="string">&quot;, callee = &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#381779" title="=&gt; Inliner.this.IMethodInfo">inc</a>.<a href="#381582" title="=&gt; Inliners.this.global.icodes.IMethod">m</a>
              <span class="delimiter">)</span>
            <span title="Nothing" class="keyword">return</span> <span title="Boolean(false)" class="keyword">false</span>
          <span class="delimiter">}</span>
          <span class="keyword">def</span> <a title="(sym: Inliners.this.global.Symbol, cond: Boolean)Inliner.this.NonPublicRefs.Value" id="383661">check</a><span class="delimiter">(</span><a title="Inliners.this.global.Symbol" id="383690">sym</a>: <a href="../../../../reflect/internal/Symbols.scala.html#38726" title="Inliners.this.global.Symbol">Symbol</a>, <a title="Boolean" id="383691">cond</a>: <span title="Boolean">Boolean</span><span class="delimiter">)</span> =
            <span title="Inliner.this.NonPublicRefs.Value" class="keyword">if</span> <span class="delimiter">(</span><a href="#383691" title="Boolean">cond</a><span class="delimiter">)</span> <a href="#381397" title="=&gt; Inliner.this.NonPublicRefs.Value">Private</a>
            <span class="keyword">else</span> <span title="Inliner.this.NonPublicRefs.Value" class="keyword">if</span> <span class="delimiter">(</span><a href="#383690" title="Inliners.this.global.Symbol">sym</a>.<a href="../../../../reflect/internal/HasFlags.scala.html#46783" title="=&gt; Boolean">isProtected</a><span class="delimiter">)</span> <a href="#381399" title="=&gt; Inliner.this.NonPublicRefs.Value">Protected</a>
            <span class="keyword">else</span> <a href="#381401" title="=&gt; Inliner.this.NonPublicRefs.Value">Public</a>

          <span class="keyword">def</span> <a title="(f: Inliners.this.global.Symbol)Inliner.this.NonPublicRefs.Value" id="383662">checkField</a><span class="delimiter">(</span><a title="Inliners.this.global.Symbol" id="383692">f</a>: <a href="../../../../reflect/internal/Symbols.scala.html#38726" title="Inliners.this.global.Symbol">Symbol</a><span class="delimiter">)</span>   = <a href="#383661" title="(sym: Inliners.this.global.Symbol, cond: Boolean)Inliner.this.NonPublicRefs.Value">check</a><span class="delimiter">(</span><a href="#383692" title="Inliners.this.global.Symbol">f</a>, <a href="#383692" title="Inliners.this.global.Symbol">f</a>.<a href="../../../../reflect/internal/HasFlags.scala.html#46782" title="=&gt; Boolean">isPrivate</a> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <span title="=&gt; Boolean">!</span><a href="#383656" title="(f: Inliners.this.global.Symbol)Boolean">makePublic</a><span class="delimiter">(</span><a href="#383692" title="Inliners.this.global.Symbol">f</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <span class="keyword">def</span> <a title="(m: Inliners.this.global.Symbol)Inliner.this.NonPublicRefs.Value" id="383663">checkSuper</a><span class="delimiter">(</span><a title="Inliners.this.global.Symbol" id="383693">m</a>: <a href="../../../../reflect/internal/Symbols.scala.html#38726" title="Inliners.this.global.Symbol">Symbol</a><span class="delimiter">)</span>   = <a href="#383661" title="(sym: Inliners.this.global.Symbol, cond: Boolean)Inliner.this.NonPublicRefs.Value">check</a><span class="delimiter">(</span><a href="#383693" title="Inliners.this.global.Symbol">m</a>, <a href="#383693" title="Inliners.this.global.Symbol">m</a>.<a href="../../../../reflect/internal/HasFlags.scala.html#46782" title="=&gt; Boolean">isPrivate</a> <span title="(x: Boolean)Boolean">||</span> <span title="=&gt; Boolean">!</span><a href="#383693" title="Inliners.this.global.Symbol">m</a>.<a href="../../../../reflect/internal/Symbols.scala.html#46490" title="=&gt; Boolean">isClassConstructor</a><span class="delimiter">)</span>
          <span class="keyword">def</span> <a title="(m: Inliners.this.global.Symbol)Inliner.this.NonPublicRefs.Value" id="383664">checkMethod</a><span class="delimiter">(</span><a title="Inliners.this.global.Symbol" id="383694">m</a>: <a href="../../../../reflect/internal/Symbols.scala.html#38726" title="Inliners.this.global.Symbol">Symbol</a><span class="delimiter">)</span>  = <a href="#383661" title="(sym: Inliners.this.global.Symbol, cond: Boolean)Inliner.this.NonPublicRefs.Value">check</a><span class="delimiter">(</span><a href="#383694" title="Inliners.this.global.Symbol">m</a>, <a href="#383694" title="Inliners.this.global.Symbol">m</a>.<a href="../../../../reflect/internal/HasFlags.scala.html#46782" title="=&gt; Boolean">isPrivate</a><span class="delimiter">)</span>

          <span class="keyword">def</span> <a title="(i: Inliners.this.global.icodes.Instruction)Inliner.this.NonPublicRefs.Value" id="383665">getAccess</a><span class="delimiter">(</span><a title="Inliners.this.global.icodes.Instruction" id="383695">i</a>: <a href="../icode/Opcodes.scala.html#232653" title="Inliners.this.global.icodes.Instruction">Instruction</a><span class="delimiter">)</span> = <a href="#383695" title="Inliners.this.global.icodes.Instruction">i</a> <span title="Inliner.this.NonPublicRefs.Value" class="keyword">match</span> <span class="delimiter">{</span>
            <span class="keyword">case</span> <span title="Inliner.this.NonPublicRefs.Value">CALL_METHOD</span><span class="delimiter">(</span><a title="Inliners.this.global.icodes.global.Symbol" id="383698">m</a>, SuperCall<span class="delimiter">(</span>_<span class="delimiter">)</span><span class="delimiter">)</span> =&gt; <a href="#383663" title="(m: Inliners.this.global.Symbol)Inliner.this.NonPublicRefs.Value">checkSuper</a><span class="delimiter">(</span><a href="#383698" title="Inliners.this.global.icodes.global.Symbol">m</a><span class="delimiter">)</span>
            <span class="keyword">case</span> <span title="Inliner.this.NonPublicRefs.Value">CALL_METHOD</span><span class="delimiter">(</span><a title="Inliners.this.global.icodes.global.Symbol" id="383702">m</a>, _<span class="delimiter">)</span>            =&gt; <a href="#383664" title="(m: Inliners.this.global.Symbol)Inliner.this.NonPublicRefs.Value">checkMethod</a><span class="delimiter">(</span><a href="#383702" title="Inliners.this.global.icodes.global.Symbol">m</a><span class="delimiter">)</span>
            <span class="keyword">case</span> <span title="Inliner.this.NonPublicRefs.Value">LOAD_FIELD</span><span class="delimiter">(</span><a title="Inliners.this.global.icodes.global.Symbol" id="383705">f</a>, _<span class="delimiter">)</span>             =&gt; <a href="#383662" title="(f: Inliners.this.global.Symbol)Inliner.this.NonPublicRefs.Value">checkField</a><span class="delimiter">(</span><a href="#383705" title="Inliners.this.global.icodes.global.Symbol">f</a><span class="delimiter">)</span>
            <span class="keyword">case</span> <span title="Inliner.this.NonPublicRefs.Value">STORE_FIELD</span><span class="delimiter">(</span><a title="Inliners.this.global.icodes.global.Symbol" id="383708">f</a>, _<span class="delimiter">)</span>            =&gt; <a href="#383662" title="(f: Inliners.this.global.Symbol)Inliner.this.NonPublicRefs.Value">checkField</a><span class="delimiter">(</span><a href="#383708" title="Inliners.this.global.icodes.global.Symbol">f</a><span class="delimiter">)</span>
            <span class="keyword">case</span> <span title="Inliner.this.NonPublicRefs.Value">_</span>                            =&gt; <a href="#381401" title="=&gt; Inliner.this.NonPublicRefs.Value">Public</a>
          <span class="delimiter">}</span>

          <span class="keyword">def</span> <a title="()Inliner.this.NonPublicRefs.Value" id="383666">iterate</a><span class="delimiter">(</span><span class="delimiter">)</span>: NonPublicRefs.<span title="Inliner.this.NonPublicRefs.Value">Value</span> = <a href="#381779" title="=&gt; Inliner.this.IMethodInfo">inc</a>.<a href="#381570" title="=&gt; List[Inliners.this.global.icodes.Instruction]">instructions</a>.<span title="(z: Inliner.this.NonPublicRefs.Value)(f: (Inliner.this.NonPublicRefs.Value, Inliners.this.global.icodes.Instruction) =&gt; Inliner.this.NonPublicRefs.Value)Inliner.this.NonPublicRefs.Value">foldLeft</span><span class="delimiter">(</span><a href="#381401" title="=&gt; Inliner.this.NonPublicRefs.Value">Public</a><span class="delimiter">)</span><span class="delimiter">(</span><span class="delimiter">(</span><a title="Inliner.this.NonPublicRefs.Value" id="383728">res</a>, <a title="Inliners.this.global.icodes.Instruction" id="383729">inc</a><span class="delimiter">)</span> =&gt; <a href="#383665" title="(i: Inliners.this.global.icodes.Instruction)Inliner.this.NonPublicRefs.Value">getAccess</a><span class="delimiter">(</span><a href="#383729" title="Inliners.this.global.icodes.Instruction">inc</a><span class="delimiter">)</span> <span title="Inliner.this.NonPublicRefs.Value" class="keyword">match</span> <span class="delimiter">{</span>
            <span class="keyword">case</span> <a href="#381397" title="Nothing">Private</a>    =&gt; <a href="../../Global.scala.html#186199" title="(msg: =&gt; AnyRef)Unit">log</a><span class="delimiter">(</span><span title="String(&quot;instruction &quot;)" class="string">&quot;instruction &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#383729" title="Inliners.this.global.icodes.Instruction">inc</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; requires private access.&quot;)" class="string">&quot; requires private access.&quot;</span><span class="delimiter">)</span> ; <span title="Nothing" class="keyword">return</span> <a href="#381397" title="=&gt; Inliner.this.NonPublicRefs.Value">Private</a>
            <span class="keyword">case</span> <a href="#381399" title="Inliner.this.NonPublicRefs.Value">Protected</a>  =&gt; <a href="#381399" title="=&gt; Inliner.this.NonPublicRefs.Value">Protected</a>
            <span class="keyword">case</span> <a href="#381401" title="Inliner.this.NonPublicRefs.Value">Public</a>     =&gt; <a href="#383728" title="Inliner.this.NonPublicRefs.Value">res</a>
          <span class="delimiter">}</span><span class="delimiter">)</span>
          <a href="#383666" title="()Inliner.this.NonPublicRefs.Value">iterate</a><span class="delimiter">(</span><span class="delimiter">)</span>
        <span class="delimiter">}</span><span class="delimiter">)</span>

        <a href="#381770" title="(level: Inliner.this.NonPublicRefs.Value)Boolean">canAccess</a><span class="delimiter">(</span><a href="#383657" title="Inliner.this.NonPublicRefs.Value">accessNeeded</a><span class="delimiter">)</span> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <span class="delimiter">{</span>
          <span class="keyword">val</span> <a title="Boolean" id="383730">isIllegalStack</a> = <span class="delimiter">(</span><a href="#383638" title="Int">stackLength</a> <span title="(x: Int)Boolean">&gt;</span> <a href="#381779" title="=&gt; Inliner.this.IMethodInfo">inc</a>.<a href="#381557" title="=&gt; Int">minimumStack</a> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#381779" title="=&gt; Inliner.this.IMethodInfo">inc</a>.<a href="#381575" title="=&gt; Boolean">hasNonFinalizerHandler</a><span class="delimiter">)</span>

          <span title="=&gt; Boolean">!</span><a href="#383730" title="Boolean">isIllegalStack</a> <span title="(x: Boolean)Boolean">||</span> <span class="delimiter">{</span>
            <a href="../../Global.scala.html#186189" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><span title="String(&quot;method &quot;)" class="string">&quot;method &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#381779" title="=&gt; Inliner.this.IMethodInfo">inc</a>.<a href="#381551" title="=&gt; Inliners.this.global.icodes.global.Symbol">sym</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; is used on a non-empty stack with finalizer.&quot;)" class="string">&quot; is used on a non-empty stack with finalizer.&quot;</span><span class="delimiter">)</span>
            <span title="Boolean(false)" class="keyword">false</span>
          <span class="delimiter">}</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>

      /** Decide whether to inline or not. Heuristics:
       *   - it's bad to make the caller larger (&gt; SMALL_METHOD_SIZE) if it was small
       *   - it's bad to inline large methods
       *   - it's good to inline higher order functions
       *   - it's good to inline closures functions.
       *   - it's bad (useless) to inline inside bridge methods
       */
      <span class="keyword">private</span> <span class="keyword">def</span> <a title="=&gt; Boolean" id="381775">neverInline</a>   = <a href="#381778" title="=&gt; Inliner.this.IMethodInfo">caller</a>.<a href="#381560" title="=&gt; Boolean">isBridge</a> <span title="(x: Boolean)Boolean">||</span> <span title="=&gt; Boolean">!</span><a href="#381779" title="=&gt; Inliner.this.IMethodInfo">inc</a>.<a href="#381582" title="=&gt; Inliners.this.global.icodes.IMethod">m</a>.<a href="../icode/Members.scala.html#322246" title="=&gt; Boolean">hasCode</a> <span title="(x: Boolean)Boolean">||</span> <a href="#381779" title="=&gt; Inliner.this.IMethodInfo">inc</a>.<a href="#381559" title="=&gt; Boolean">noinline</a>
      <span class="keyword">private</span> <span class="keyword">def</span> <a title="=&gt; Boolean" id="381776">alwaysInline</a>  = <a href="#381779" title="=&gt; Inliner.this.IMethodInfo">inc</a>.<a href="#381558" title="=&gt; Boolean">inline</a>

      <span class="keyword">def</span> <a title="=&gt; Boolean" id="381777">shouldInline</a>: <span title="Boolean">Boolean</span> = <span title="=&gt; Boolean">!</span><a href="#381775" title="=&gt; Boolean">neverInline</a> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <span class="delimiter">(</span><a href="#381776" title="=&gt; Boolean">alwaysInline</a> <span title="(x: Boolean)Boolean">||</span> <span class="delimiter">{</span>
        <a href="../../Global.scala.html#186189" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><span title="String(&quot;shouldInline: &quot;)" class="string">&quot;shouldInline: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#381778" title="=&gt; Inliner.this.IMethodInfo">caller</a>.<a href="#381582" title="=&gt; Inliners.this.global.icodes.IMethod">m</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; with &quot;)" class="string">&quot; with &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#381779" title="=&gt; Inliner.this.IMethodInfo">inc</a>.<a href="#381582" title="=&gt; Inliners.this.global.icodes.IMethod">m</a><span class="delimiter">)</span>

        <span class="keyword">var</span> <a title="Int" id="383741">score</a> = <span title="Int(0)" class="int">0</span>

        // better not inline inside closures, but hope that the closure itself is repeatedly inlined
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#381778" title="=&gt; Inliner.this.IMethodInfo">caller</a>.<a href="#381561" title="=&gt; Boolean">isInClosure</a><span class="delimiter">)</span>           <a href="#383741" title="Int">score</a> <span title="(x: Int)Int">-=</span> <span title="Int(2)" class="int">2</span>
        <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#381778" title="=&gt; Inliner.this.IMethodInfo">caller</a>.<a href="#381577" title="=&gt; Int">inlinedCalls</a> <span title="(x: Int)Boolean">&lt;</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span> <a href="#383741" title="Int">score</a> <span title="(x: Int)Int">-=</span> <span title="Int(1)" class="int">1</span> // only monadic methods can trigger the first inline

        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#381779" title="=&gt; Inliner.this.IMethodInfo">inc</a>.<a href="#381571" title="=&gt; Boolean">isSmall</a><span class="delimiter">)</span> <a href="#383741" title="Int">score</a> <span title="(x: Int)Int">+=</span> <span title="Int(1)" class="int">1</span>;
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#381779" title="=&gt; Inliner.this.IMethodInfo">inc</a>.<a href="#381572" title="=&gt; Boolean">isLarge</a><span class="delimiter">)</span> <a href="#383741" title="Int">score</a> <span title="(x: Int)Int">-=</span> <span title="Int(1)" class="int">1</span>;
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#381778" title="=&gt; Inliner.this.IMethodInfo">caller</a>.<a href="#381571" title="=&gt; Boolean">isSmall</a> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#381764" title="=&gt; Boolean">isLargeSum</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="#383741" title="Int">score</a> <span title="(x: Int)Int">-=</span> <span title="Int(1)" class="int">1</span>
          <a href="../../Global.scala.html#186189" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><span title="String(&quot;shouldInline: score decreased to &quot;)" class="string">&quot;shouldInline: score decreased to &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#383741" title="Int">score</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; because small &quot;)" class="string">&quot; because small &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#381778" title="=&gt; Inliner.this.IMethodInfo">caller</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; would become large&quot;)" class="string">&quot; would become large&quot;</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>

        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#381779" title="=&gt; Inliner.this.IMethodInfo">inc</a>.<a href="#381564" title="=&gt; Boolean">isMonadic</a><span class="delimiter">)</span>          <a href="#383741" title="Int">score</a> <span title="(x: Int)Int">+=</span> <span title="Int(3)" class="int">3</span>
        <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#381779" title="=&gt; Inliner.this.IMethodInfo">inc</a>.<a href="#381562" title="=&gt; Boolean">isHigherOrder</a><span class="delimiter">)</span> <a href="#383741" title="Int">score</a> <span title="(x: Int)Int">+=</span> <span title="Int(1)" class="int">1</span>

        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#381779" title="=&gt; Inliner.this.IMethodInfo">inc</a>.<a href="#381561" title="=&gt; Boolean">isInClosure</a><span class="delimiter">)</span>                 <a href="#383741" title="Int">score</a> <span title="(x: Int)Int">+=</span> <span title="Int(2)" class="int">2</span>;
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#381781" title="(key: Inliners.this.global.Symbol)Int">inlinedMethodCount</a><span class="delimiter">(</span><a href="#381779" title="=&gt; Inliner.this.IMethodInfo">inc</a>.<a href="#381551" title="=&gt; Inliners.this.global.icodes.global.Symbol">sym</a><span class="delimiter">)</span> <span title="(x: Int)Boolean">&gt;</span> <span title="Int(2)" class="int">2</span><span class="delimiter">)</span> <a href="#383741" title="Int">score</a> <span title="(x: Int)Int">-=</span> <span title="Int(2)" class="int">2</span>;

        <a href="../../Global.scala.html#186199" title="(msg: =&gt; AnyRef)Unit">log</a><span class="delimiter">(</span><span title="String(&quot;shouldInline(&quot;)" class="string">&quot;shouldInline(&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#381779" title="=&gt; Inliner.this.IMethodInfo">inc</a>.<a href="#381582" title="=&gt; Inliners.this.global.icodes.IMethod">m</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;) score: &quot;)" class="string">&quot;) score: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#383741" title="Int">score</a><span class="delimiter">)</span>

        <a href="#383741" title="Int">score</a> <span title="(x: Int)Boolean">&gt;</span> <span title="Int(0)" class="int">0</span>
      <span class="delimiter">}</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="(meth: Inliners.this.global.Symbol, receiver: Inliners.this.global.Symbol)Option[Inliners.this.global.icodes.IMethod]" id="381383">lookupIMethod</a><span class="delimiter">(</span><a title="Inliners.this.global.Symbol" id="381746">meth</a>: <a href="../../../../reflect/internal/Symbols.scala.html#38726" title="Inliners.this.global.Symbol">Symbol</a>, <a title="Inliners.this.global.Symbol" id="381747">receiver</a>: <a href="../../../../reflect/internal/Symbols.scala.html#38726" title="Inliners.this.global.Symbol">Symbol</a><span class="delimiter">)</span>: <span title="Option[Inliners.this.global.icodes.IMethod]">Option</span><span class="delimiter">[</span>IMethod<span class="delimiter">]</span> = <span class="delimiter">{</span>
      <span class="keyword">def</span> <a title="(sym: Inliners.this.global.Symbol)Option[Inliners.this.global.icodes.global.icodes.IMethod]" id="383823">tryParent</a><span class="delimiter">(</span><a title="Inliners.this.global.Symbol" id="383824">sym</a>: <a href="../../../../reflect/internal/Symbols.scala.html#38726" title="Inliners.this.global.Symbol">Symbol</a><span class="delimiter">)</span> = <a href="../../Global.scala.html#186153" title="object Inliners.this.global.icodes">icodes</a> <a href="../icode/Repository.scala.html#232826" title="(sym: Inliners.this.global.icodes.global.Symbol)Option[Inliners.this.global.icodes.global.icodes.IClass]">icode</a> <a href="#383824" title="Inliners.this.global.Symbol">sym</a> <span title="(f: Inliners.this.global.icodes.global.icodes.IClass =&gt; Option[Inliners.this.global.icodes.global.icodes.IMethod])Option[Inliners.this.global.icodes.global.icodes.IMethod]">flatMap</span> <span class="delimiter">(</span><a href="#383834" title="Inliners.this.global.icodes.global.icodes.IClass">_</a> <a href="../icode/Members.scala.html#232947" title="(s: Inliners.this.global.icodes.global.icodes.global.Symbol)Option[Inliners.this.global.icodes.global.icodes.IMethod]">lookupMethod</a> <a href="#381746" title="Inliners.this.global.Symbol">meth</a><span class="delimiter">)</span>

      <a href="#381747" title="Inliners.this.global.Symbol">receiver</a>.<a href="../../../../reflect/internal/Symbols.scala.html#46608" title="=&gt; Inliners.this.global.Type">info</a>.<a href="../../../../reflect/internal/Types.scala.html#41581" title="=&gt; List[Inliners.this.global.Symbol]">baseClasses</a>.<span title="=&gt; Iterator[Inliners.this.global.Symbol]">iterator</span> <span title="(f: Inliners.this.global.Symbol =&gt; Option[Inliners.this.global.icodes.global.icodes.IMethod])Iterator[Option[Inliners.this.global.icodes.global.icodes.IMethod]]">map</span> <a href="#383823" title="(sym: Inliners.this.global.Symbol)Option[Inliners.this.global.icodes.global.icodes.IMethod]">tryParent</a> <span title="(p: Option[Inliners.this.global.icodes.global.icodes.IMethod] =&gt; Boolean)Option[Option[Inliners.this.global.icodes.global.icodes.IMethod]]">find</span> <span class="delimiter">(</span><a href="#383860" title="Option[Inliners.this.global.icodes.global.icodes.IMethod]">_</a>.<span title="=&gt; Boolean">isDefined</span><span class="delimiter">)</span> <span title="(implicit ev: &lt;:&lt;[Option[Inliners.this.global.icodes.global.icodes.IMethod],Option[Inliners.this.global.icodes.IMethod]])Option[Inliners.this.global.icodes.IMethod]">flatten</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span> /* class Inliner */
<span class="delimiter">}</span> /* class Inliners */

        </pre>
    </body>
</html>