<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>scala/tools/nsc/transform/LambdaLift.scala</title>
        <script type="text/javascript" src="../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
/* NSC -- new Scala compiler
 * Copyright 2005-2011 LAMP/EPFL
 * @author
 */

<span class="keyword">package</span> scala.tools.nsc
<span class="keyword">package</span> transform

<span class="keyword">import</span> symtab._
<span class="keyword">import</span> <a href="../symtab/package.scala.html#34879" title="=&gt; reflect.internal.Flags.type">Flags</a>._
<span class="keyword">import</span> util.TreeSet
<span class="keyword">import</span> scala.collection.<span class="delimiter">{</span> mutable, immutable <span class="delimiter">}</span>
<span class="keyword">import</span> scala.collection.mutable.LinkedHashMap

<span class="keyword">abstract</span> <span class="keyword">class</span> <a title="class LambdaLift extends scala.tools.nsc.SubComponent with scala.tools.nsc.transform.InfoTransform with ScalaObject" id="28296">LambdaLift</a> <a href="#28296" title="ScalaObject" class="keyword">extends</a> <a href="InfoTransform.scala.html#28089" title="scala.tools.nsc.transform.InfoTransform">InfoTransform</a> <span class="delimiter">{</span>
  <span class="keyword">import</span> <a href="../SubComponent.scala.html#231956" title="=&gt; scala.tools.nsc.Global">global</a>._
  <span class="keyword">import</span> <a href="../../../reflect/internal/Definitions.scala.html#39224" title="object LambdaLift.this.global.definitions">definitions</a>._

  /** the following two members override abstract members in Transform */
  <span class="keyword">val</span> <a title="String" id="242868">phaseName</a>: <span title="String">String</span> = <span title="String(&quot;lambdalift&quot;)" class="string">&quot;lambdalift&quot;</span>
    
  /** Converts types of captured variables to *Ref types.
   */
  <span class="keyword">def</span> <a title="(sym: LambdaLift.this.global.Symbol, tpe: LambdaLift.this.global.Type, erasedTypes: Boolean)LambdaLift.this.global.Type" id="242870">boxIfCaptured</a><span class="delimiter">(</span><a title="LambdaLift.this.global.Symbol" id="266617">sym</a>: <a href="../../../reflect/internal/Symbols.scala.html#38726" title="LambdaLift.this.global.Symbol">Symbol</a>, <a title="LambdaLift.this.global.Type" id="266618">tpe</a>: <a href="../../../reflect/internal/Types.scala.html#38813" title="LambdaLift.this.global.Type">Type</a>, <a title="Boolean" id="266619">erasedTypes</a>: <span title="Boolean">Boolean</span><span class="delimiter">)</span> =
    <span title="LambdaLift.this.global.Type" class="keyword">if</span> <span class="delimiter">(</span><a href="#266617" title="LambdaLift.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#46482" title="=&gt; Boolean">isCapturedVariable</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="LambdaLift.this.global.Symbol" id="266622">symClass</a> = <a href="#266618" title="LambdaLift.this.global.Type">tpe</a>.<a href="../../../reflect/internal/Types.scala.html#41504" title="=&gt; LambdaLift.this.global.Symbol">typeSymbol</a>
      <span class="keyword">def</span> <a title="(valueRef: Map[LambdaLift.this.global.Symbol,LambdaLift.this.global.Symbol], objectRefClass: LambdaLift.this.global.Symbol)LambdaLift.this.global.Type" id="266623">refType</a><span class="delimiter">(</span><a title="Map[LambdaLift.this.global.Symbol,LambdaLift.this.global.Symbol]" id="266624">valueRef</a>: <span title="Map[LambdaLift.this.global.Symbol,LambdaLift.this.global.Symbol]">Map</span><span class="delimiter">[</span>Symbol, Symbol<span class="delimiter">]</span>, <a title="LambdaLift.this.global.Symbol" id="266625">objectRefClass</a>: <a href="../../../reflect/internal/Symbols.scala.html#38726" title="LambdaLift.this.global.Symbol">Symbol</a><span class="delimiter">)</span> =
        <span title="LambdaLift.this.global.Type" class="keyword">if</span> <span class="delimiter">(</span><a href="../../../reflect/internal/Definitions.scala.html#45476" title="(sym: LambdaLift.this.global.Symbol)Boolean">isValueClass</a><span class="delimiter">(</span><a href="#266622" title="LambdaLift.this.global.Symbol">symClass</a><span class="delimiter">)</span> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#266622" title="LambdaLift.this.global.Symbol">symClass</a> <span title="(x$1: AnyRef)Boolean">!=</span> <a href="../../../reflect/internal/Definitions.scala.html#45531" title="=&gt; LambdaLift.this.global.Symbol">UnitClass</a><span class="delimiter">)</span> <a href="#266624" title="(key: LambdaLift.this.global.Symbol)LambdaLift.this.global.Symbol">valueRef</a><span class="delimiter">(</span><a href="#266622" title="LambdaLift.this.global.Symbol">symClass</a><span class="delimiter">)</span>.<a href="../../../reflect/internal/Symbols.scala.html#46606" title="=&gt; LambdaLift.this.global.Type">tpe</a>
        <span class="keyword">else</span> <span title="LambdaLift.this.global.Type" class="keyword">if</span> <span class="delimiter">(</span><a href="#266619" title="Boolean">erasedTypes</a><span class="delimiter">)</span> <a href="#266625" title="LambdaLift.this.global.Symbol">objectRefClass</a>.<a href="../../../reflect/internal/Symbols.scala.html#46606" title="=&gt; LambdaLift.this.global.Type">tpe</a>
        <span class="keyword">else</span> <a href="../../../reflect/internal/Types.scala.html#38940" title="(tycon: LambdaLift.this.global.Type, args: List[LambdaLift.this.global.Type])LambdaLift.this.global.Type">appliedType</a><span class="delimiter">(</span><a href="#266625" title="LambdaLift.this.global.Symbol">objectRefClass</a>.<a href="../../../reflect/internal/Symbols.scala.html#46625" title="=&gt; LambdaLift.this.global.Type">typeConstructor</a>, <span title="(xs: LambdaLift.this.global.Type*)List[LambdaLift.this.global.Type]">List</span><span class="delimiter">(</span><a href="#266618" title="LambdaLift.this.global.Type">tpe</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span title="LambdaLift.this.global.Type" class="keyword">if</span> <span class="delimiter">(</span><a href="#266617" title="LambdaLift.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/AnnotationInfos.scala.html#44936" title="(cls: LambdaLift.this.global.Symbol)Boolean">hasAnnotation</a><span class="delimiter">(</span><a href="../../../reflect/internal/Definitions.scala.html#45423" title="=&gt; LambdaLift.this.global.Symbol">VolatileAttr</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="#266623" title="(valueRef: Map[LambdaLift.this.global.Symbol,LambdaLift.this.global.Symbol], objectRefClass: LambdaLift.this.global.Symbol)LambdaLift.this.global.Type">refType</a><span class="delimiter">(</span><a href="../../../reflect/internal/Definitions.scala.html#45520" title="=&gt; Map[LambdaLift.this.global.Symbol,LambdaLift.this.global.Symbol]">volatileRefClass</a>, <a href="../../../reflect/internal/Definitions.scala.html#45339" title="=&gt; LambdaLift.this.global.Symbol">VolatileObjectRefClass</a><span class="delimiter">)</span>
      <span class="keyword">else</span> <a href="#266623" title="(valueRef: Map[LambdaLift.this.global.Symbol,LambdaLift.this.global.Symbol], objectRefClass: LambdaLift.this.global.Symbol)LambdaLift.this.global.Type">refType</a><span class="delimiter">(</span><a href="../../../reflect/internal/Definitions.scala.html#45518" title="=&gt; Map[LambdaLift.this.global.Symbol,LambdaLift.this.global.Symbol]">refClass</a>, <a href="../../../reflect/internal/Definitions.scala.html#45337" title="=&gt; LambdaLift.this.global.Symbol">ObjectRefClass</a><span class="delimiter">)</span>
    <span class="delimiter">}</span> <span class="keyword">else</span> <a href="#266618" title="LambdaLift.this.global.Type">tpe</a>

  <span class="keyword">private</span> <span class="keyword">val</span> <a title="LambdaLift.this.global.TypeMap" id="242871">lifted</a> = <a href="#601857" title="LambdaLift.this.global.TypeMap" class="keyword">new</a> <a href="../../../reflect/internal/Types.scala.html#38980" title="anonymous class $anon extends LambdaLift.this.global.TypeMap" id="601857">TypeMap</a> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="(tp: LambdaLift.this.global.Type)LambdaLift.this.global.Type" id="601859">apply</a><span class="delimiter">(</span><a title="LambdaLift.this.global.Type" id="601860">tp</a>: <a href="../../../reflect/internal/Types.scala.html#38813" title="LambdaLift.this.global.Type">Type</a><span class="delimiter">)</span>: <a href="../../../reflect/internal/Types.scala.html#38813" title="LambdaLift.this.global.Type">Type</a> = <a href="#601860" title="LambdaLift.this.global.Type">tp</a> <span title="LambdaLift.this.global.Type" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <span title="LambdaLift.this.global.Type">TypeRef</span><span class="delimiter">(</span><a href="../../../reflect/internal/Types.scala.html#38829" title="object LambdaLift.this.global.NoPrefix">NoPrefix</a>, <a title="LambdaLift.this.global.Symbol" id="601869">sym</a>, <span title="object Nil">Nil</span><span class="delimiter">)</span> <span class="keyword">if</span> <a href="#601869" title="LambdaLift.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#46445" title="=&gt; Boolean">isClass</a> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <span title="=&gt; Boolean">!</span><a href="#601869" title="LambdaLift.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#46475" title="=&gt; Boolean">isPackageClass</a> =&gt;
        <a href="../../../reflect/internal/Types.scala.html#38934" title="(pre: LambdaLift.this.global.Type, sym: LambdaLift.this.global.Symbol, args: List[LambdaLift.this.global.Type])LambdaLift.this.global.Type">typeRef</a><span class="delimiter">(</span><a href="#601859" title="(tp: LambdaLift.this.global.Type)LambdaLift.this.global.Type">apply</a><span class="delimiter">(</span><a href="#601869" title="LambdaLift.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#46564" title="=&gt; LambdaLift.this.global.Symbol">owner</a>.<a href="../../../reflect/internal/Symbols.scala.html#46662" title="=&gt; LambdaLift.this.global.Symbol">enclClass</a>.<a href="../../../reflect/internal/Symbols.scala.html#46667" title="=&gt; LambdaLift.this.global.Type">thisType</a><span class="delimiter">)</span>, <a href="#601869" title="LambdaLift.this.global.Symbol">sym</a>, <span title="object Nil">Nil</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="LambdaLift.this.global.Type">ClassInfoType</span><span class="delimiter">(</span><a title="List[LambdaLift.this.global.Type]" id="601877">parents</a>, <a title="LambdaLift.this.global.Scope" id="601878">decls</a>, <a title="LambdaLift.this.global.Symbol" id="601879">clazz</a><span class="delimiter">)</span> =&gt;
        <span class="keyword">val</span> <a title="List[LambdaLift.this.global.Type]" id="601880">parents1</a> = <a href="#601877" title="List[LambdaLift.this.global.Type]">parents</a> <span title="(f: LambdaLift.this.global.Type =&gt; LambdaLift.this.global.Type)List[LambdaLift.this.global.Type]">mapConserve</span> <a href="#601857" title="LambdaLift.this.global.TypeMap" class="keyword">this</a>
        <span title="LambdaLift.this.global.Type" class="keyword">if</span> <span class="delimiter">(</span><a href="#601880" title="List[LambdaLift.this.global.Type]">parents1</a> <span title="(x$1: AnyRef)Boolean">eq</span> <a href="#601877" title="List[LambdaLift.this.global.Type]">parents</a><span class="delimiter">)</span> <a href="#601860" title="LambdaLift.this.global.Type">tp</a>
        <span class="keyword">else</span> <a href="../../../reflect/internal/Types.scala.html#70033" title="(parents: List[LambdaLift.this.global.Type], decls: LambdaLift.this.global.Scope, typeSymbol: LambdaLift.this.global.Symbol)LambdaLift.this.global.ClassInfoType">ClassInfoType</a><span class="delimiter">(</span><a href="#601880" title="List[LambdaLift.this.global.Type]">parents1</a>, <a href="#601878" title="LambdaLift.this.global.Scope">decls</a>, <a href="#601879" title="LambdaLift.this.global.Symbol">clazz</a><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="LambdaLift.this.global.Type">_</span> =&gt;
        <a href="../../../reflect/internal/Types.scala.html#74772" title="(tp: LambdaLift.this.global.Type)LambdaLift.this.global.Type">mapOver</a><span class="delimiter">(</span><a href="#601860" title="LambdaLift.this.global.Type">tp</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(sym: LambdaLift.this.global.Symbol, tp: LambdaLift.this.global.Type)LambdaLift.this.global.Type" id="242873">transformInfo</a><span class="delimiter">(</span><a title="LambdaLift.this.global.Symbol" id="601940">sym</a>: <a href="../../../reflect/internal/Symbols.scala.html#38726" title="LambdaLift.this.global.Symbol">Symbol</a>, <a title="LambdaLift.this.global.Type" id="601941">tp</a>: <a href="../../../reflect/internal/Types.scala.html#38813" title="LambdaLift.this.global.Type">Type</a><span class="delimiter">)</span>: <a href="../../../reflect/internal/Types.scala.html#38813" title="LambdaLift.this.global.Type">Type</a> =
    <a href="#242870" title="(sym: LambdaLift.this.global.Symbol, tpe: LambdaLift.this.global.Type, erasedTypes: Boolean)LambdaLift.this.global.Type">boxIfCaptured</a><span class="delimiter">(</span><a href="#601940" title="LambdaLift.this.global.Symbol">sym</a>, <a href="../../../reflect/internal/Types.scala.html#74770" title="(tp: LambdaLift.this.global.Type)LambdaLift.this.global.Type">lifted</a><span class="delimiter">(</span><a href="#601941" title="LambdaLift.this.global.Type">tp</a><span class="delimiter">)</span>, erasedTypes = <span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span>

  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="(unit: LambdaLift.this.global.CompilationUnit)LambdaLift.this.global.Transformer" id="242874">newTransformer</a><span class="delimiter">(</span><a title="LambdaLift.this.global.CompilationUnit" id="601956">unit</a>: <a href="../CompilationUnits.scala.html#186387" title="LambdaLift.this.global.CompilationUnit">CompilationUnit</a><span class="delimiter">)</span>: <a href="../ast/Trees.scala.html#186434" title="LambdaLift.this.global.Transformer">Transformer</a> =
    <span title="LambdaLift.this.LambdaLifter" class="keyword">new</span> <a href="#242875" title="LambdaLift.this.LambdaLifter">LambdaLifter</a><span class="delimiter">(</span><a href="#601956" title="LambdaLift.this.global.CompilationUnit">unit</a><span class="delimiter">)</span>

  <span class="keyword">class</span> <a title="class LambdaLifter extends LambdaLift.this.global.explicitOuter.OuterPathTransformer with ScalaObject" id="242875">LambdaLifter</a><a href="#242875" title="ScalaObject" class="delimiter">(</a><a title="LambdaLift.this.global.CompilationUnit" id="602002">unit</a>: <a href="../CompilationUnits.scala.html#186387" title="LambdaLift.this.global.CompilationUnit">CompilationUnit</a><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="../Global.scala.html#186243" title="object LambdaLift.this.global.explicitOuter">explicitOuter</a>.<a href="ExplicitOuter.scala.html#242327" title="LambdaLift.this.global.explicitOuter.OuterPathTransformer">OuterPathTransformer</a><span class="delimiter">(</span><a href="#602002" title="LambdaLift.this.global.CompilationUnit">unit</a><span class="delimiter">)</span> <span class="delimiter">{</span>

    /** A map storing free variables of functions and classes */
    <span class="keyword">private</span> <span class="keyword">val</span> <a title="scala.collection.mutable.LinkedHashMap[LambdaLift.this.global.Symbol,LambdaLifter.this.SymSet]" id="601962">free</a> = <span title="scala.collection.mutable.LinkedHashMap[LambdaLift.this.global.Symbol,LambdaLifter.this.SymSet]" class="keyword">new</span> <span title="scala.collection.mutable.LinkedHashMap[LambdaLift.this.global.Symbol,LambdaLifter.this.SymSet]">LinkedHashMap</span><span class="delimiter">[</span>Symbol, SymSet<span class="delimiter">]</span>

    /** A map storing the free variable proxies of functions and classes */
    <span class="keyword">private</span> <span class="keyword">val</span> <a title="scala.collection.mutable.LinkedHashMap[LambdaLift.this.global.Symbol,List[LambdaLift.this.global.Symbol]]" id="601964">proxies</a> = <span title="scala.collection.mutable.LinkedHashMap[LambdaLift.this.global.Symbol,List[LambdaLift.this.global.Symbol]]" class="keyword">new</span> <span title="scala.collection.mutable.LinkedHashMap[LambdaLift.this.global.Symbol,List[LambdaLift.this.global.Symbol]]">LinkedHashMap</span><span class="delimiter">[</span>Symbol, List<span class="delimiter">[</span>Symbol<span class="delimiter">]</span><span class="delimiter">]</span>

    /** A hashtable storing calls between functions */
    <span class="keyword">private</span> <span class="keyword">val</span> <a title="scala.collection.mutable.LinkedHashMap[LambdaLift.this.global.Symbol,LambdaLifter.this.SymSet]" id="601966">called</a> = <span title="scala.collection.mutable.LinkedHashMap[LambdaLift.this.global.Symbol,LambdaLifter.this.SymSet]" class="keyword">new</span> <span title="scala.collection.mutable.LinkedHashMap[LambdaLift.this.global.Symbol,LambdaLifter.this.SymSet]">LinkedHashMap</span><span class="delimiter">[</span>Symbol, SymSet<span class="delimiter">]</span>

    /** The set of symbols that need to be renamed. */
    <span class="keyword">private</span> <span class="keyword">val</span> <a title="scala.tools.nsc.util.TreeSet[LambdaLift.this.global.Symbol]" id="601968">renamable</a> = <a href="#601983" title="=&gt; scala.tools.nsc.util.TreeSet[LambdaLift.this.global.Symbol]">newSymSet</a>

    // (trait, name) -&gt; owner
    <span class="keyword">private</span> <span class="keyword">val</span> <a title="scala.collection.mutable.HashMap[(LambdaLift.this.global.Symbol, LambdaLift.this.global.Name),LambdaLift.this.global.Symbol]" id="601970">localTraits</a>      = mutable.<span title="[A, B](elems: (A, B)*)scala.collection.mutable.HashMap[A,B]">HashMap</span><span title="(elems: ((LambdaLift.this.global.Symbol, LambdaLift.this.global.Name), LambdaLift.this.global.Symbol)*)scala.collection.mutable.HashMap[(LambdaLift.this.global.Symbol, LambdaLift.this.global.Name),LambdaLift.this.global.Symbol]" class="delimiter">[</span><span title="(LambdaLift.this.global.Symbol, LambdaLift.this.global.Name)" class="delimiter">(</span>Symbol, Name<span class="delimiter">)</span>, <a href="../../../reflect/internal/Symbols.scala.html#38726" title="LambdaLift.this.global.Symbol">Symbol</a><span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>
    // (owner, name) -&gt; implClass
    <span class="keyword">private</span> <span class="keyword">val</span> <a title="scala.collection.mutable.HashMap[(LambdaLift.this.global.Symbol, LambdaLift.this.global.Name),LambdaLift.this.global.Symbol]" id="601972">localImplClasses</a> = mutable.<span title="[A, B](elems: (A, B)*)scala.collection.mutable.HashMap[A,B]">HashMap</span><span title="(elems: ((LambdaLift.this.global.Symbol, LambdaLift.this.global.Name), LambdaLift.this.global.Symbol)*)scala.collection.mutable.HashMap[(LambdaLift.this.global.Symbol, LambdaLift.this.global.Name),LambdaLift.this.global.Symbol]" class="delimiter">[</span><span title="(LambdaLift.this.global.Symbol, LambdaLift.this.global.Name)" class="delimiter">(</span>Symbol, Name<span class="delimiter">)</span>, <a href="../../../reflect/internal/Symbols.scala.html#38726" title="LambdaLift.this.global.Symbol">Symbol</a><span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>

    /** A flag to indicate whether new free variables have been found */
    <span class="keyword">private</span> <span class="keyword">var</span> <a title="Boolean" id="601975">changedFreeVars</a>: <span title="Boolean">Boolean</span> = _

    /** Buffers for lifted out classes and methods */
    <span class="keyword">private</span> <span class="keyword">val</span> <a title="scala.collection.mutable.LinkedHashMap[LambdaLift.this.global.Symbol,List[LambdaLift.this.global.Tree]]" id="601977">liftedDefs</a> = <span title="scala.collection.mutable.LinkedHashMap[LambdaLift.this.global.Symbol,List[LambdaLift.this.global.Tree]]" class="keyword">new</span> <span title="scala.collection.mutable.LinkedHashMap[LambdaLift.this.global.Symbol,List[LambdaLift.this.global.Tree]]">LinkedHashMap</span><span class="delimiter">[</span>Symbol, List<span class="delimiter">[</span>Tree<span class="delimiter">]</span><span class="delimiter">]</span>
    
    /** True if we are transforming under a ReferenceToBoxed node */
    <span class="keyword">private</span> <span class="keyword">var</span> <a title="Boolean" id="601980">isBoxedRef</a> = <span title="Boolean(false)" class="keyword">false</span>
    
    <span class="keyword">private</span> <span class="keyword">type</span> <a title="scala.tools.nsc.util.TreeSet[LambdaLift.this.global.Symbol]" id="601982">SymSet</a> = <a href="../util/TreeSet.scala.html#33454" title="scala.tools.nsc.util.TreeSet[LambdaLift.this.global.Symbol]">TreeSet</a><span class="delimiter">[</span>Symbol<span class="delimiter">]</span>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="=&gt; scala.tools.nsc.util.TreeSet[LambdaLift.this.global.Symbol]" id="601983">newSymSet</a> = <span title="scala.tools.nsc.util.TreeSet[LambdaLift.this.global.Symbol]" class="keyword">new</span> <a href="../util/TreeSet.scala.html#33454" title="scala.tools.nsc.util.TreeSet[LambdaLift.this.global.Symbol]">TreeSet</a><span class="delimiter">[</span>Symbol<span class="delimiter">]</span><span class="delimiter">(</span><a href="#602010" title="LambdaLift.this.global.Symbol">_</a> <a href="../../../reflect/internal/Symbols.scala.html#46647" title="(that: LambdaLift.this.global.Symbol)Boolean">isLess</a> <a href="#602011" title="LambdaLift.this.global.Symbol">_</a><span class="delimiter">)</span>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(f: scala.collection.mutable.LinkedHashMap[LambdaLift.this.global.Symbol,LambdaLifter.this.SymSet], sym: LambdaLift.this.global.Symbol)LambdaLifter.this.SymSet" id="601984">symSet</a><span class="delimiter">(</span><a title="scala.collection.mutable.LinkedHashMap[LambdaLift.this.global.Symbol,LambdaLifter.this.SymSet]" id="602089">f</a>: <span title="scala.collection.mutable.LinkedHashMap[LambdaLift.this.global.Symbol,LambdaLifter.this.SymSet]">LinkedHashMap</span><span class="delimiter">[</span>Symbol, SymSet<span class="delimiter">]</span>, <a title="LambdaLift.this.global.Symbol" id="602090">sym</a>: <a href="../../../reflect/internal/Symbols.scala.html#38726" title="LambdaLift.this.global.Symbol">Symbol</a><span class="delimiter">)</span>: <a href="../util/TreeSet.scala.html#33454" title="LambdaLifter.this.SymSet">SymSet</a> =
      <a href="#602089" title="scala.collection.mutable.LinkedHashMap[LambdaLift.this.global.Symbol,LambdaLifter.this.SymSet]">f</a>.<span title="(key: LambdaLift.this.global.Symbol, op: =&gt; LambdaLifter.this.SymSet)LambdaLifter.this.SymSet">getOrElseUpdate</span><span class="delimiter">(</span><a href="#602090" title="LambdaLift.this.global.Symbol">sym</a>, <a href="#601983" title="=&gt; scala.tools.nsc.util.TreeSet[LambdaLift.this.global.Symbol]">newSymSet</a><span class="delimiter">)</span>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(sym: LambdaLift.this.global.Symbol)Boolean" id="601985">isSameOwnerEnclosure</a><span class="delimiter">(</span><a title="LambdaLift.this.global.Symbol" id="602155">sym</a>: <a href="../../../reflect/internal/Symbols.scala.html#38726" title="LambdaLift.this.global.Symbol">Symbol</a><span class="delimiter">)</span> =
      <a href="#602155" title="LambdaLift.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#46564" title="=&gt; LambdaLift.this.global.Symbol">owner</a>.<a href="../../../reflect/internal/Symbols.scala.html#46687" title="=&gt; LambdaLift.this.global.Symbol">logicallyEnclosingMember</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#242875" title="=&gt; LambdaLift.this.global.explicitOuter.global.Symbol">currentOwner</a>.<a href="../../../reflect/internal/Symbols.scala.html#46687" title="=&gt; LambdaLift.this.global.explicitOuter.global.Symbol">logicallyEnclosingMember</a>

    /** Mark symbol `sym` as being free in `enclosure`, unless `sym`
     *  is defined in `enclosure` or there is a class between `enclosure`s owner
     *  and the owner of `sym`.
     *  Return `true` if there is no class between `enclosure` and
     *  the owner of sym.
     *  pre: sym.isLocal, (enclosure.isMethod || enclosure.isClass)
     *
     *  The idea of `markFree` is illustrated with an example:
     *
     *  def f(x: int) = {
     *    class C {
     *      class D {
     *        val y = x
     *      }
     *    }
     *  }
     *
     *  In this case `x` is free in the primary constructor of class `C`.
     *  but it is not free in `D`, because after lambda lift the code would be transformed
     *  as follows:
     *
     *  def f(x$0: int) {
     *    class C(x$0: int) {
     *      val x$1 = x$0
     *      class D {
     *        val y = outer.x$1
     *      }
     *    }
     *  }
     */
    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(sym: LambdaLift.this.global.Symbol, enclosure: LambdaLift.this.global.Symbol)Boolean" id="601986">markFree</a><span class="delimiter">(</span><a title="LambdaLift.this.global.Symbol" id="602118">sym</a>: <a href="../../../reflect/internal/Symbols.scala.html#38726" title="LambdaLift.this.global.Symbol">Symbol</a>, <a title="LambdaLift.this.global.Symbol" id="602119">enclosure</a>: <a href="../../../reflect/internal/Symbols.scala.html#38726" title="LambdaLift.this.global.Symbol">Symbol</a><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> = <span class="delimiter">{</span>
      <a href="../Global.scala.html#186189" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><span title="String(&quot;mark free: &quot;)" class="string">&quot;mark free: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#602118" title="LambdaLift.this.global.Symbol">sym</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; of &quot;)" class="string">&quot; of &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#602118" title="LambdaLift.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#46564" title="=&gt; LambdaLift.this.global.Symbol">owner</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; marked free in &quot;)" class="string">&quot; marked free in &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#602119" title="LambdaLift.this.global.Symbol">enclosure</a><span class="delimiter">)</span>
      <span title="Boolean" class="keyword">if</span> <span class="delimiter">(</span><a href="#602119" title="LambdaLift.this.global.Symbol">enclosure</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#602118" title="LambdaLift.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#46564" title="=&gt; LambdaLift.this.global.Symbol">owner</a>.<a href="../../../reflect/internal/Symbols.scala.html#46687" title="=&gt; LambdaLift.this.global.Symbol">logicallyEnclosingMember</a><span class="delimiter">)</span> <span title="Boolean(true)" class="keyword">true</span>
      <span class="keyword">else</span> <span title="Boolean" class="keyword">if</span> <span class="delimiter">(</span><a href="#602119" title="LambdaLift.this.global.Symbol">enclosure</a>.<a href="../../../reflect/internal/Symbols.scala.html#46475" title="=&gt; Boolean">isPackageClass</a> <span title="(x: Boolean)Boolean">||</span> <span title="=&gt; Boolean">!</span><a href="#601986" title="(sym: LambdaLift.this.global.Symbol, enclosure: LambdaLift.this.global.Symbol)Boolean">markFree</a><span class="delimiter">(</span><a href="#602118" title="LambdaLift.this.global.Symbol">sym</a>, <a href="#602119" title="LambdaLift.this.global.Symbol">enclosure</a>.<a href="../../../reflect/internal/Symbols.scala.html#46515" title="=&gt; LambdaLift.this.global.Symbol">skipConstructor</a>.<a href="../../../reflect/internal/Symbols.scala.html#46564" title="=&gt; LambdaLift.this.global.Symbol">owner</a>.<a href="../../../reflect/internal/Symbols.scala.html#46687" title="=&gt; LambdaLift.this.global.Symbol">logicallyEnclosingMember</a><span class="delimiter">)</span><span class="delimiter">)</span> <span title="Boolean(false)" class="keyword">false</span>
      <span class="keyword">else</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="LambdaLifter.this.SymSet" id="602168">ss</a> = <a href="#601984" title="(f: scala.collection.mutable.LinkedHashMap[LambdaLift.this.global.Symbol,LambdaLifter.this.SymSet], sym: LambdaLift.this.global.Symbol)LambdaLifter.this.SymSet">symSet</a><span class="delimiter">(</span><a href="#601962" title="=&gt; scala.collection.mutable.LinkedHashMap[LambdaLift.this.global.Symbol,LambdaLifter.this.SymSet]">free</a>, <a href="#602119" title="LambdaLift.this.global.Symbol">enclosure</a><span class="delimiter">)</span>
        <span title="Any" class="keyword">if</span> <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="../../../reflect/internal/util/Set.scala.html#129810" title="(x: LambdaLift.this.global.Symbol)Boolean">ss</a><span class="delimiter">(</span><a href="#602118" title="LambdaLift.this.global.Symbol">sym</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="#602168" title="LambdaLifter.this.SymSet">ss</a> <a href="../util/TreeSet.scala.html#593856" title="(x: LambdaLift.this.global.Symbol)Unit">addEntry</a> <a href="#602118" title="LambdaLift.this.global.Symbol">sym</a>
          <a href="#601968" title="=&gt; scala.tools.nsc.util.TreeSet[LambdaLift.this.global.Symbol]">renamable</a> <a href="../util/TreeSet.scala.html#593856" title="(x: LambdaLift.this.global.Symbol)Unit">addEntry</a> <a href="#602118" title="LambdaLift.this.global.Symbol">sym</a>
          <a href="../../../reflect/internal/SymbolTable.scala.html#35637" title="(ph: scala.reflect.internal.Phase)(op: =&gt; Any)Any">atPhase</a><span class="delimiter">(</span><a href="../Global.scala.html#186319" title="=&gt; LambdaLift.this.global.Run">currentRun</a>.<a href="../Global.scala.html#188840" title="=&gt; scala.tools.nsc.Phase">picklerPhase</a><span class="delimiter">)</span> <span class="delimiter">{</span>
            // The param symbol in the MethodType should not be renamed, only the symbol in scope. This way,
            // parameter names for named arguments are not changed. Example: without cloning the MethodType,
            //     def closure(x: Int) = { () =&gt; x }
            // would have the signature
            //     closure: (x$1: Int)() =&gt; Int
            <span title="Any" class="keyword">if</span> <span class="delimiter">(</span><a href="#602118" title="LambdaLift.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/HasFlags.scala.html#46793" title="=&gt; Boolean">isParameter</a> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#602118" title="LambdaLift.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#46564" title="=&gt; LambdaLift.this.global.Symbol">owner</a>.<a href="../../../reflect/internal/Symbols.scala.html#46608" title="=&gt; LambdaLift.this.global.Type">info</a>.<a href="../../../reflect/internal/Types.scala.html#41525" title="=&gt; List[List[LambdaLift.this.global.Symbol]]">paramss</a>.<span title="(p: List[LambdaLift.this.global.Symbol] =&gt; Boolean)Boolean">exists</span><span class="delimiter">(</span><a href="#602190" title="List[LambdaLift.this.global.Symbol]">_</a> <span title="(elem: Any)Boolean">contains</span> <a href="#602118" title="LambdaLift.this.global.Symbol">sym</a><span class="delimiter">)</span><span class="delimiter">)</span>
              <a href="#602118" title="LambdaLift.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#46564" title="=&gt; LambdaLift.this.global.Symbol">owner</a> <a href="../../../reflect/internal/Symbols.scala.html#46611" title="(f: LambdaLift.this.global.Type =&gt; LambdaLift.this.global.Type)LambdaLift.this.global.Symbol">modifyInfo</a> <span class="delimiter">(</span><a href="#602195" title="LambdaLift.this.global.Type">_</a> <a href="../../../reflect/internal/Types.scala.html#41583" title="(owner: LambdaLift.this.global.Symbol)LambdaLift.this.global.Type">cloneInfo</a> <a href="#602118" title="LambdaLift.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#46564" title="=&gt; LambdaLift.this.global.Symbol">owner</a><span class="delimiter">)</span>
          <span class="delimiter">}</span>
          <a href="#601975" title="(x$1: Boolean)Unit">changedFreeVars</a> = <span title="Boolean(true)" class="keyword">true</span>
          <a href="../Global.scala.html#186189" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><span title="String(&quot;&quot;)" class="string">&quot;&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#602118" title="LambdaLift.this.global.Symbol">sym</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; is free in &quot;)" class="string">&quot; is free in &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#602119" title="LambdaLift.this.global.Symbol">enclosure</a><span class="delimiter">)</span>;
          <span title="Any" class="keyword">if</span> <span class="delimiter">(</span><a href="#602118" title="LambdaLift.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#46481" title="=&gt; Boolean">isVariable</a><span class="delimiter">)</span> <a href="#602118" title="LambdaLift.this.global.Symbol">sym</a> <a href="../../../reflect/internal/Symbols.scala.html#46589" title="(mask: Long)sym.type">setFlag</a> <span title="Long(65536L)">CAPTURED</span>
        <span class="delimiter">}</span>
        <span title="=&gt; Boolean">!</span><a href="#602119" title="LambdaLift.this.global.Symbol">enclosure</a>.<a href="../../../reflect/internal/Symbols.scala.html#46445" title="=&gt; Boolean">isClass</a>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(sym: LambdaLift.this.global.Symbol, owner: LambdaLift.this.global.Symbol)Unit" id="601987">markCalled</a><span class="delimiter">(</span><a title="LambdaLift.this.global.Symbol" id="602121">sym</a>: <a href="../../../reflect/internal/Symbols.scala.html#38726" title="LambdaLift.this.global.Symbol">Symbol</a>, <a title="LambdaLift.this.global.Symbol" id="602122">owner</a>: <a href="../../../reflect/internal/Symbols.scala.html#38726" title="LambdaLift.this.global.Symbol">Symbol</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="../Global.scala.html#186189" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><span title="String(&quot;mark called: &quot;)" class="string">&quot;mark called: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#602121" title="LambdaLift.this.global.Symbol">sym</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; of &quot;)" class="string">&quot; of &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#602121" title="LambdaLift.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#46564" title="=&gt; LambdaLift.this.global.Symbol">owner</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; is called by &quot;)" class="string">&quot; is called by &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#602122" title="LambdaLift.this.global.Symbol">owner</a><span class="delimiter">)</span>
      <a href="#601984" title="(f: scala.collection.mutable.LinkedHashMap[LambdaLift.this.global.Symbol,LambdaLifter.this.SymSet], sym: LambdaLift.this.global.Symbol)LambdaLifter.this.SymSet">symSet</a><span class="delimiter">(</span><a href="#601966" title="=&gt; scala.collection.mutable.LinkedHashMap[LambdaLift.this.global.Symbol,LambdaLifter.this.SymSet]">called</a>, <a href="#602122" title="LambdaLift.this.global.Symbol">owner</a><span class="delimiter">)</span> <a href="../util/TreeSet.scala.html#593856" title="(x: LambdaLift.this.global.Symbol)Unit">addEntry</a> <a href="#602121" title="LambdaLift.this.global.Symbol">sym</a>
    <span class="delimiter">}</span>

    /** The traverse function */
    <span class="keyword">private</span> <span class="keyword">val</span> <a title="LambdaLift.this.global.Traverser" id="601988">freeVarTraverser</a> = <a href="#602017" title="LambdaLift.this.global.Traverser" class="keyword">new</a> <a href="../SubComponent.scala.html#231956" title="anonymous class $anon extends LambdaLift.this.global.Traverser" id="602017">Traverser</a> <span class="delimiter">{</span>
      <span class="keyword">override</span> <span class="keyword">def</span> <a title="(tree: LambdaLift.this.global.Tree)Unit" id="602019">traverse</a><span class="delimiter">(</span><a title="LambdaLift.this.global.Tree" id="602020">tree</a>: <span title="LambdaLift.this.global.Tree">Tree</span><span class="delimiter">)</span> <span class="delimiter">{</span>
       <span class="keyword">try</span> <span class="delimiter">{</span> //debug
        <span class="keyword">val</span> <a title="LambdaLift.this.global.Symbol" id="602023">sym</a> = <a href="#602020" title="LambdaLift.this.global.Tree">tree</a>.<span title="=&gt; LambdaLift.this.global.Symbol">symbol</span>;
        <a href="#602020" title="LambdaLift.this.global.Tree">tree</a> <span title="Any" class="keyword">match</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> <span title="Unit">ClassDef</span><span class="delimiter">(</span>_, _, _, _<span class="delimiter">)</span> =&gt;
            <a href="#601977" title="(key: LambdaLift.this.global.Symbol, value: List[LambdaLift.this.global.Tree])Unit">liftedDefs</a><span class="delimiter">(</span><a href="#602020" title="LambdaLift.this.global.Tree">tree</a>.<span title="=&gt; LambdaLift.this.global.Symbol">symbol</span><span class="delimiter">)</span> = <span title="object Nil">Nil</span>
            <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#602023" title="LambdaLift.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#46550" title="=&gt; Boolean">isLocal</a><span class="delimiter">)</span> <span class="delimiter">{</span>
              // Don't rename implementation classes independently of their interfaces. If
              // the interface is to be renamed, then we will rename the implementation
              // class at that time. You'd think we could call &quot;.implClass&quot; on the trait
              // rather than collecting them in another map, but that seems to fail for
              // exactly the traits being renamed here (i.e. defined in methods.)
              //
              // !!! - it makes no sense to have methods like &quot;implClass&quot; and
              // &quot;companionClass&quot; which fail for an arbitrary subset of nesting
              // arrangements, and then have separate methods which attempt to compensate
              // for that failure. There should be exactly one method for any given
              // entity which always gives the right answer.
              <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#602023" title="LambdaLift.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#46459" title="=&gt; Boolean">isImplClass</a><span class="delimiter">)</span>
                <a href="#601972" title="(key: (LambdaLift.this.global.Symbol, LambdaLift.this.global.Name), value: LambdaLift.this.global.Symbol)Unit">localImplClasses</a><span class="delimiter">(</span><span title="(_1: LambdaLift.this.global.Symbol, _2: LambdaLift.this.global.TypeName)(LambdaLift.this.global.Symbol, LambdaLift.this.global.TypeName)" class="delimiter">(</span><a href="#602023" title="LambdaLift.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#46564" title="=&gt; LambdaLift.this.global.Symbol">owner</a>, <a href="../../../reflect/internal/StdNames.scala.html#39313" title="object LambdaLift.this.global.nme">nme</a>.<a href="../../../reflect/internal/NameManglers.scala.html#59444" title="(implname: LambdaLift.this.global.Name)LambdaLift.this.global.TypeName">interfaceName</a><span class="delimiter">(</span><a href="#602023" title="LambdaLift.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#46571" title="=&gt; LambdaLift.this.global.Name">name</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span> = <a href="#602023" title="LambdaLift.this.global.Symbol">sym</a>
              <span class="keyword">else</span> <span class="delimiter">{</span>
                <a href="#601968" title="=&gt; scala.tools.nsc.util.TreeSet[LambdaLift.this.global.Symbol]">renamable</a> <a href="../util/TreeSet.scala.html#593856" title="(x: LambdaLift.this.global.Symbol)Unit">addEntry</a> <a href="#602023" title="LambdaLift.this.global.Symbol">sym</a>
                <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#602023" title="LambdaLift.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#46451" title="=&gt; Boolean">isTrait</a><span class="delimiter">)</span>
                  <a href="#601970" title="(key: (LambdaLift.this.global.Symbol, LambdaLift.this.global.Name), value: LambdaLift.this.global.Symbol)Unit">localTraits</a><span class="delimiter">(</span><span title="(_1: LambdaLift.this.global.Symbol, _2: LambdaLift.this.global.Name)(LambdaLift.this.global.Symbol, LambdaLift.this.global.Name)" class="delimiter">(</span><a href="#602023" title="LambdaLift.this.global.Symbol">sym</a>, <a href="#602023" title="LambdaLift.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#46571" title="=&gt; LambdaLift.this.global.Name">name</a><span class="delimiter">)</span><span class="delimiter">)</span> = <a href="#602023" title="LambdaLift.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#46564" title="=&gt; LambdaLift.this.global.Symbol">owner</a>
              <span class="delimiter">}</span>
            <span class="delimiter">}</span>
          <span class="keyword">case</span> <span title="Any">DefDef</span><span class="delimiter">(</span>_, _, _, _, _, _<span class="delimiter">)</span> =&gt;
            <span title="Any" class="keyword">if</span> <span class="delimiter">(</span><a href="#602023" title="LambdaLift.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#46550" title="=&gt; Boolean">isLocal</a><span class="delimiter">)</span> <span class="delimiter">{</span>
              <a href="#601968" title="=&gt; scala.tools.nsc.util.TreeSet[LambdaLift.this.global.Symbol]">renamable</a> <a href="../util/TreeSet.scala.html#593856" title="(x: LambdaLift.this.global.Symbol)Unit">addEntry</a> <a href="#602023" title="LambdaLift.this.global.Symbol">sym</a>
              <a href="#602023" title="LambdaLift.this.global.Symbol">sym</a> <a href="../../../reflect/internal/Symbols.scala.html#46589" title="(mask: Long)sym.type">setFlag</a> <span class="delimiter">(</span><a href="../../../reflect/internal/Flags.scala.html#38467" title="=&gt; Long">PrivateLocal</a> <span title="(x: Int)Long">|</span> <span title="Int(32)">FINAL</span><span class="delimiter">)</span>
            <span class="delimiter">}</span> <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#602023" title="LambdaLift.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#46539" title="=&gt; Boolean">isPrimaryConstructor</a><span class="delimiter">)</span> <span class="delimiter">{</span>
              <a href="#601984" title="(f: scala.collection.mutable.LinkedHashMap[LambdaLift.this.global.Symbol,LambdaLifter.this.SymSet], sym: LambdaLift.this.global.Symbol)LambdaLifter.this.SymSet">symSet</a><span class="delimiter">(</span><a href="#601966" title="=&gt; scala.collection.mutable.LinkedHashMap[LambdaLift.this.global.Symbol,LambdaLifter.this.SymSet]">called</a>, <a href="#602023" title="LambdaLift.this.global.Symbol">sym</a><span class="delimiter">)</span> <a href="../util/TreeSet.scala.html#593856" title="(x: LambdaLift.this.global.Symbol)Unit">addEntry</a> <a href="#602023" title="LambdaLift.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#46564" title="=&gt; LambdaLift.this.global.Symbol">owner</a>
            <span class="delimiter">}</span>
          <span class="keyword">case</span> <span title="AnyVal">Ident</span><span class="delimiter">(</span><a title="LambdaLift.this.global.Name" id="602105">name</a><span class="delimiter">)</span> =&gt;
            <span title="AnyVal" class="keyword">if</span> <span class="delimiter">(</span><a href="#602023" title="LambdaLift.this.global.Symbol">sym</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../../reflect/internal/Symbols.scala.html#38740" title="=&gt; LambdaLift.this.global.NoSymbol">NoSymbol</a><span class="delimiter">)</span> <span class="delimiter">{</span>
              <a href="../Global.scala.html#186184" title="(assertion: Boolean)Unit">assert</a><span class="delimiter">(</span><a href="#602105" title="LambdaLift.this.global.Name">name</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../../reflect/internal/StdNames.scala.html#39313" title="object LambdaLift.this.global.nme">nme</a>.<a href="../../../reflect/internal/StdNames.scala.html#59373" title="=&gt; LambdaLift.this.global.nme.NameType">WILDCARD</a><span class="delimiter">)</span>
            <span class="delimiter">}</span> <span class="keyword">else</span> <span title="AnyVal" class="keyword">if</span> <span class="delimiter">(</span><a href="#602023" title="LambdaLift.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#46550" title="=&gt; Boolean">isLocal</a><span class="delimiter">)</span> <span class="delimiter">{</span>
              <span class="keyword">val</span> <a title="LambdaLift.this.global.Symbol" id="602117">owner</a> = <a href="#602017" title="=&gt; LambdaLift.this.global.Symbol">currentOwner</a>.<a href="../../../reflect/internal/Symbols.scala.html#46687" title="=&gt; LambdaLift.this.global.Symbol">logicallyEnclosingMember</a>
              <span title="AnyVal" class="keyword">if</span> <span class="delimiter">(</span><a href="#602023" title="LambdaLift.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#46443" title="=&gt; Boolean">isTerm</a> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <span title="=&gt; Boolean">!</span><a href="#602023" title="LambdaLift.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#46461" title="=&gt; Boolean">isMethod</a><span class="delimiter">)</span> <a href="#601986" title="(sym: LambdaLift.this.global.Symbol, enclosure: LambdaLift.this.global.Symbol)Boolean">markFree</a><span class="delimiter">(</span><a href="#602023" title="LambdaLift.this.global.Symbol">sym</a>, <a href="#602117" title="LambdaLift.this.global.Symbol">owner</a><span class="delimiter">)</span>
              <span class="keyword">else</span> <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#602023" title="LambdaLift.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#46461" title="=&gt; Boolean">isMethod</a><span class="delimiter">)</span> <a href="#601987" title="(sym: LambdaLift.this.global.Symbol, owner: LambdaLift.this.global.Symbol)Unit">markCalled</a><span class="delimiter">(</span><a href="#602023" title="LambdaLift.this.global.Symbol">sym</a>, <a href="#602117" title="LambdaLift.this.global.Symbol">owner</a><span class="delimiter">)</span>
                //symSet(called, owner) addEntry sym
            <span class="delimiter">}</span>
          <span class="keyword">case</span> <span title="Unit">Select</span><span class="delimiter">(</span>_, _<span class="delimiter">)</span> =&gt;
            <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#602023" title="LambdaLift.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#46492" title="=&gt; Boolean">isConstructor</a> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#602023" title="LambdaLift.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#46564" title="=&gt; LambdaLift.this.global.Symbol">owner</a>.<a href="../../../reflect/internal/Symbols.scala.html#46550" title="=&gt; Boolean">isLocal</a><span class="delimiter">)</span>
              <a href="#601987" title="(sym: LambdaLift.this.global.Symbol, owner: LambdaLift.this.global.Symbol)Unit">markCalled</a><span class="delimiter">(</span><a href="#602023" title="LambdaLift.this.global.Symbol">sym</a>, <a href="#602017" title="=&gt; LambdaLift.this.global.Symbol">currentOwner</a>.<a href="../../../reflect/internal/Symbols.scala.html#46687" title="=&gt; LambdaLift.this.global.Symbol">logicallyEnclosingMember</a><span class="delimiter">)</span>
          <span class="keyword">case</span> <span title="Unit">_</span> =&gt;
        <span class="delimiter">}</span>
        <a href="#602017" title="LambdaLift.this.global.Traverser" class="keyword">super</a>.<span title="(tree: LambdaLift.this.global.Tree)Unit">traverse</span><span class="delimiter">(</span><a href="#602020" title="LambdaLift.this.global.Tree">tree</a><span class="delimiter">)</span>
       <span class="delimiter">}</span> <span class="keyword">catch</span> <span class="delimiter">{</span>//debug
         <span class="keyword">case</span> <a title="Nothing" id="602135">ex</a>: <span title="Throwable">Throwable</span> =&gt;
           <span title="object Console">Console</span>.<span title="(x: Any)Unit">println</span><span class="delimiter">(</span><span title="String(&quot;exception when traversing &quot;)" class="string">&quot;exception when traversing &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#602020" title="LambdaLift.this.global.Tree">tree</a><span class="delimiter">)</span>
           <span title="Nothing" class="keyword">throw</span> <a href="#602135" title="Throwable">ex</a>
       <span class="delimiter">}</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    /** Compute free variables map `fvs`.
     *  Also assign unique names to all
     *  value/variable/let that are free in some function or class, and to
     *  all class/function symbols that are owned by some function.
     */
    <span class="keyword">private</span> <span class="keyword">def</span> <a title="()Unit" id="601990">computeFreeVars</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#601988" title="=&gt; LambdaLift.this.global.Traverser">freeVarTraverser</a>.<span title="(tree: LambdaLift.this.global.Tree)Unit">traverse</span><span class="delimiter">(</span><a href="#602002" title="LambdaLift.this.global.CompilationUnit">unit</a>.<a href="../CompilationUnits.scala.html#188697" title="=&gt; LambdaLift.this.global.Tree">body</a><span class="delimiter">)</span>

      <a href="#602218" title="Unit" class="keyword">do</a> <span class="delimiter">{</span>
        <a href="#601975" title="(x$1: Boolean)Unit">changedFreeVars</a> = <span title="Boolean(false)" class="keyword">false</span>
        <span class="keyword">for</span> <span class="delimiter">(</span><a title="LambdaLift.this.global.Symbol" id="602250">caller</a> &lt;- <a href="#601966" title="=&gt; scala.collection.mutable.LinkedHashMap[LambdaLift.this.global.Symbol,LambdaLifter.this.SymSet]">called</a>.<span title="(f: LambdaLift.this.global.Symbol =&gt; Unit)Unit">keys</span> ; <a title="LambdaLift.this.global.Symbol" id="602290">callee</a> &lt;- <a href="#601966" title="(key: LambdaLift.this.global.Symbol)LambdaLifter.this.SymSet">called</a><a href="../../../reflect/internal/util/Set.scala.html#129807" title="(f: LambdaLift.this.global.Symbol =&gt; Unit)Unit" class="delimiter">(</a><a href="#602250" title="LambdaLift.this.global.Symbol">caller</a><span class="delimiter">)</span> ; <a title="LambdaLifter.this.SymSet" id="602298">fvs</a> &lt;- <a href="#601962" title="=&gt; scala.collection.mutable.LinkedHashMap[LambdaLift.this.global.Symbol,LambdaLifter.this.SymSet]">free</a> <span title="(f: LambdaLifter.this.SymSet =&gt; Unit)Unit">get</span> <a href="#602290" title="LambdaLift.this.global.Symbol">callee</a> ; <a title="LambdaLift.this.global.Symbol" id="602303">fv</a> &lt;- <a href="../../../reflect/internal/util/Set.scala.html#129807" title="(f: LambdaLift.this.global.Symbol =&gt; Boolean)Unit">fvs</a><span class="delimiter">)</span>
          <a href="#601986" title="(sym: LambdaLift.this.global.Symbol, enclosure: LambdaLift.this.global.Symbol)Boolean">markFree</a><span class="delimiter">(</span><a href="#602303" title="LambdaLift.this.global.Symbol">fv</a>, <a href="#602250" title="LambdaLift.this.global.Symbol">caller</a><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">while</span> <span class="delimiter">(</span><a href="#601975" title="=&gt; Boolean">changedFreeVars</a><span class="delimiter">)</span>
      
      <span class="keyword">def</span> <a title="(sym: LambdaLift.this.global.Symbol)Unit" id="602216">renameSym</a><span class="delimiter">(</span><a title="LambdaLift.this.global.Symbol" id="602308">sym</a>: <a href="../../../reflect/internal/Symbols.scala.html#38726" title="LambdaLift.this.global.Symbol">Symbol</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="LambdaLift.this.global.Name" id="602309">originalName</a> = <a href="#602308" title="LambdaLift.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#46571" title="=&gt; LambdaLift.this.global.Name">name</a>
        <span class="keyword">val</span> <a title="String" id="602310">base</a> = <a href="#602308" title="LambdaLift.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#46571" title="implicit scala.Predef.any2stringadd : (x: Any)scala.runtime.StringAdd">name</a> <span title="(other: String)String">+</span> <a href="../../../reflect/internal/StdNames.scala.html#39313" title="object LambdaLift.this.global.nme">nme</a>.<a href="../../../reflect/internal/NameManglers.scala.html#59379" title="=&gt; String">NAME_JOIN_STRING</a> <span title="(x$1: Any)String">+</span> <span class="delimiter">(</span>
          <span title="Any" class="keyword">if</span> <span class="delimiter">(</span><a href="#602308" title="LambdaLift.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#46504" title="=&gt; Boolean">isAnonymousFunction</a> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#602308" title="LambdaLift.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#46564" title="=&gt; LambdaLift.this.global.Symbol">owner</a>.<a href="../../../reflect/internal/Symbols.scala.html#46461" title="=&gt; Boolean">isMethod</a><span class="delimiter">)</span>
            <a href="#602308" title="LambdaLift.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#46564" title="=&gt; LambdaLift.this.global.Symbol">owner</a>.<a href="../../../reflect/internal/Symbols.scala.html#46571" title="implicit scala.Predef.any2stringadd : (x: Any)scala.runtime.StringAdd">name</a> <span title="(other: String)String">+</span> <a href="../../../reflect/internal/StdNames.scala.html#39313" title="object LambdaLift.this.global.nme">nme</a>.<a href="../../../reflect/internal/NameManglers.scala.html#59379" title="=&gt; String">NAME_JOIN_STRING</a>
          <span class="keyword">else</span> <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span>
        <span class="delimiter">)</span>
        <a href="#602308" title="LambdaLift.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#46572" title="(name: LambdaLift.this.global.Name)Unit">name</a> =
          <span title="LambdaLift.this.global.Name" class="keyword">if</span> <span class="delimiter">(</span><a href="#602308" title="LambdaLift.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#46571" title="=&gt; LambdaLift.this.global.Name">name</a>.<a href="../../../reflect/internal/Names.scala.html#52125" title="=&gt; Boolean">isTypeName</a><span class="delimiter">)</span> <a href="#602002" title="LambdaLift.this.global.CompilationUnit">unit</a>.<a href="../CompilationUnits.scala.html#188696" title="(prefix: String)LambdaLift.this.global.TypeName">freshTypeName</a><span class="delimiter">(</span><a href="#602310" title="String">base</a><span class="delimiter">)</span>
          <span class="keyword">else</span> <a href="#602002" title="LambdaLift.this.global.CompilationUnit">unit</a>.<a href="../CompilationUnits.scala.html#188695" title="(prefix: String)LambdaLift.this.global.TermName">freshTermName</a><span class="delimiter">(</span><a href="#602310" title="String">base</a><span class="delimiter">)</span>

        <a href="../Global.scala.html#186189" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;renaming in %s: %s =&gt; %s&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#602308" title="LambdaLift.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#46564" title="=&gt; LambdaLift.this.global.Symbol">owner</a>.<a href="../../../reflect/internal/Symbols.scala.html#46745" title="=&gt; String">fullLocationString</a>, <a href="#602309" title="LambdaLift.this.global.Name">originalName</a>, <a href="#602308" title="LambdaLift.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#46571" title="=&gt; LambdaLift.this.global.Name">name</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>

      /** Rename a trait's interface and implementation class in coordinated fashion.
       */
      <span class="keyword">def</span> <a title="(traitSym: LambdaLift.this.global.Symbol, implSym: LambdaLift.this.global.Symbol)Unit" id="602217">renameTrait</a><span class="delimiter">(</span><a title="LambdaLift.this.global.Symbol" id="602323">traitSym</a>: <a href="../../../reflect/internal/Symbols.scala.html#38726" title="LambdaLift.this.global.Symbol">Symbol</a>, <a title="LambdaLift.this.global.Symbol" id="602324">implSym</a>: <a href="../../../reflect/internal/Symbols.scala.html#38726" title="LambdaLift.this.global.Symbol">Symbol</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="LambdaLift.this.global.Name" id="602325">originalImplName</a> = <a href="#602324" title="LambdaLift.this.global.Symbol">implSym</a>.<a href="../../../reflect/internal/Symbols.scala.html#46571" title="=&gt; LambdaLift.this.global.Name">name</a>
        <a href="#602216" title="(sym: LambdaLift.this.global.Symbol)Unit">renameSym</a><span class="delimiter">(</span><a href="#602323" title="LambdaLift.this.global.Symbol">traitSym</a><span class="delimiter">)</span>
        <a href="#602324" title="LambdaLift.this.global.Symbol">implSym</a>.<a href="../../../reflect/internal/Symbols.scala.html#46572" title="(name: LambdaLift.this.global.Name)Unit">name</a> = <a href="../../../reflect/internal/StdNames.scala.html#39313" title="object LambdaLift.this.global.nme">nme</a>.<a href="../../../reflect/internal/NameManglers.scala.html#59443" title="(name: LambdaLift.this.global.Name)LambdaLift.this.global.TypeName">implClassName</a><span class="delimiter">(</span><a href="#602323" title="LambdaLift.this.global.Symbol">traitSym</a>.<a href="../../../reflect/internal/Symbols.scala.html#46571" title="=&gt; LambdaLift.this.global.Name">name</a><span class="delimiter">)</span>

        <a href="../Global.scala.html#186189" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;renaming impl class in step with %s: %s =&gt; %s&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#602323" title="LambdaLift.this.global.Symbol">traitSym</a>, <a href="#602325" title="LambdaLift.this.global.Name">originalImplName</a>, <a href="#602324" title="LambdaLift.this.global.Symbol">implSym</a>.<a href="../../../reflect/internal/Symbols.scala.html#46571" title="=&gt; LambdaLift.this.global.Name">name</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
      
      <span class="keyword">for</span> <span class="delimiter">(</span><a title="LambdaLift.this.global.Symbol" id="602335">sym</a> &lt;- <a href="../../../reflect/internal/util/Set.scala.html#129807" title="(f: LambdaLift.this.global.Symbol =&gt; Unit)Unit">renamable</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        // If we renamed a trait from Foo to Foo$1, we must rename the implementation
        // class from Foo$class to Foo$1$class.  (Without special consideration it would
        // become Foo$class$1 instead.) Since the symbols are being renamed out from
        // under us, and there's no reliable link between trait symbol and impl symbol,
        // we have maps from ((trait, name)) -&gt; owner and ((owner, name)) -&gt; impl.
        <a href="#601970" title="=&gt; scala.collection.mutable.HashMap[(LambdaLift.this.global.Symbol, LambdaLift.this.global.Name),LambdaLift.this.global.Symbol]">localTraits</a> <span title="(key: (LambdaLift.this.global.Symbol, LambdaLift.this.global.Name))Option[LambdaLift.this.global.Symbol]">remove</span> <span class="delimiter">(</span><span title="(_1: LambdaLift.this.global.Symbol, _2: LambdaLift.this.global.Name)(LambdaLift.this.global.Symbol, LambdaLift.this.global.Name)" class="delimiter">(</span><a href="#602335" title="LambdaLift.this.global.Symbol">sym</a>, <a href="#602335" title="LambdaLift.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#46571" title="=&gt; LambdaLift.this.global.Name">name</a><span class="delimiter">)</span><span class="delimiter">)</span> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> <span title="Unit">None</span>        =&gt; <a href="#602216" title="(sym: LambdaLift.this.global.Symbol)Unit">renameSym</a><span class="delimiter">(</span><a href="#602335" title="LambdaLift.this.global.Symbol">sym</a><span class="delimiter">)</span>
          <span class="keyword">case</span> <span title="Unit">Some</span><span class="delimiter">(</span><a title="LambdaLift.this.global.Symbol" id="602345">owner</a><span class="delimiter">)</span> =&gt;
            <a href="#601972" title="=&gt; scala.collection.mutable.HashMap[(LambdaLift.this.global.Symbol, LambdaLift.this.global.Name),LambdaLift.this.global.Symbol]">localImplClasses</a> <span title="(key: (LambdaLift.this.global.Symbol, LambdaLift.this.global.Name))Option[LambdaLift.this.global.Symbol]">remove</span> <span class="delimiter">(</span><span title="(_1: LambdaLift.this.global.Symbol, _2: LambdaLift.this.global.Name)(LambdaLift.this.global.Symbol, LambdaLift.this.global.Name)" class="delimiter">(</span><a href="#602345" title="LambdaLift.this.global.Symbol">owner</a>, <a href="#602335" title="LambdaLift.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#46571" title="=&gt; LambdaLift.this.global.Name">name</a><span class="delimiter">)</span><span class="delimiter">)</span> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
              <span class="keyword">case</span> <span title="Unit">Some</span><span class="delimiter">(</span><a title="LambdaLift.this.global.Symbol" id="602355">implSym</a><span class="delimiter">)</span>  =&gt; <a href="#602217" title="(traitSym: LambdaLift.this.global.Symbol, implSym: LambdaLift.this.global.Symbol)Unit">renameTrait</a><span class="delimiter">(</span><a href="#602335" title="LambdaLift.this.global.Symbol">sym</a>, <a href="#602355" title="LambdaLift.this.global.Symbol">implSym</a><span class="delimiter">)</span>
              <span class="keyword">case</span> <span title="Unit">_</span>              =&gt; <a href="#602216" title="(sym: LambdaLift.this.global.Symbol)Unit">renameSym</a><span class="delimiter">(</span><a href="#602335" title="LambdaLift.this.global.Symbol">sym</a><span class="delimiter">)</span> // pure interface, no impl class
            <span class="delimiter">}</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>

      <a href="../../../reflect/internal/SymbolTable.scala.html#35637" title="(ph: scala.reflect.internal.Phase)(op: =&gt; Unit)Unit">atPhase</a><span class="delimiter">(</span><a href="../../../reflect/internal/SymbolTable.scala.html#35628" title="=&gt; scala.reflect.internal.Phase">phase</a>.<a href="../../../reflect/internal/Phase.scala.html#69307" title="=&gt; scala.reflect.internal.Phase">next</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="keyword">for</span> <span class="delimiter">(</span><span class="delimiter">(</span><a title="LambdaLift.this.global.Symbol" id="602399">owner</a>, <a title="LambdaLifter.this.SymSet" id="602400">freeValues</a><span class="delimiter">)</span> &lt;- <a href="#601962" title="=&gt; scala.collection.mutable.LinkedHashMap[LambdaLift.this.global.Symbol,LambdaLifter.this.SymSet]">free</a>.<a href="#602370" title="(f: ((LambdaLift.this.global.Symbol, LambdaLifter.this.SymSet)) =&gt; Unit)Unit">toList</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <span class="keyword">val</span> <a title="Long" id="602401">newFlags</a> = <span title="Int(2097152)">SYNTHETIC</span> <span title="(x: Long)Long">|</span> <span class="delimiter">(</span> <span title="Long" class="keyword">if</span> <span class="delimiter">(</span><a href="#602399" title="LambdaLift.this.global.Symbol">owner</a>.<a href="../../../reflect/internal/Symbols.scala.html#46445" title="=&gt; Boolean">isClass</a><span class="delimiter">)</span> <span title="Int(536870912)">PARAMACCESSOR</span> <span title="(x: Long)Long">|</span> <a href="../../../reflect/internal/Flags.scala.html#38467" title="=&gt; Long">PrivateLocal</a> <span class="keyword">else</span> <span title="Long(8192L)">PARAM</span> <span class="delimiter">)</span>
          <a href="../Global.scala.html#186189" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;free var proxy: %s, %s&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#602399" title="LambdaLift.this.global.Symbol">owner</a>.<a href="../../../reflect/internal/Symbols.scala.html#46745" title="=&gt; String">fullLocationString</a>, <a href="#602400" title="LambdaLifter.this.SymSet">freeValues</a>.<a href="../../../reflect/internal/util/Set.scala.html#129813" title="=&gt; List[LambdaLift.this.global.Symbol]">toList</a>.<span title="(sep: String)String">mkString</span><span class="delimiter">(</span><span title="String(&quot;, &quot;)" class="string">&quot;, &quot;</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
          <a href="#601964" title="(key: LambdaLift.this.global.Symbol, value: List[LambdaLift.this.global.Symbol])Unit">proxies</a><span class="delimiter">(</span><a href="#602399" title="LambdaLift.this.global.Symbol">owner</a><span class="delimiter">)</span> =
            <span class="keyword">for</span> <span class="delimiter">(</span><a title="LambdaLift.this.global.Symbol" id="602441">fv</a> &lt;- <a href="#602400" title="LambdaLifter.this.SymSet">freeValues</a>.<a href="../../../reflect/internal/util/Set.scala.html#129813" title="(f: LambdaLift.this.global.Symbol =&gt; LambdaLift.this.global.TermSymbol)(implicit bf: scala.collection.generic.CanBuildFrom[List[LambdaLift.this.global.Symbol],LambdaLift.this.global.TermSymbol,List[LambdaLift.this.global.Symbol]])List[LambdaLift.this.global.Symbol]">toList</a><span class="delimiter">)</span> <span class="keyword">yield</span> <span class="delimiter">{</span>
              <span class="keyword">val</span> <a title="LambdaLift.this.global.TermSymbol" id="602442">proxy</a> = <a href="#602399" title="LambdaLift.this.global.Symbol">owner</a>.<a href="../../../reflect/internal/Symbols.scala.html#46383" title="(name: LambdaLift.this.global.TermName, pos: LambdaLift.this.global.Position, newFlags: Long)LambdaLift.this.global.TermSymbol">newValue</a><span class="delimiter">(</span><a href="#602441" title="LambdaLift.this.global.Symbol">fv</a>.<a href="../../../reflect/internal/Names.scala.html#38367" title="implicit scala.reflect.internal.Names.promoteTermNamesAsNecessary : (name: LambdaLift.this.global.Name)LambdaLift.this.global.TermName">name</a>, <a href="#602399" title="LambdaLift.this.global.Symbol">owner</a>.<a href="../../../reflect/internal/Symbols.scala.html#46379" title="=&gt; LambdaLift.this.global.Position">pos</a>, <a href="#602401" title="Long">newFlags</a><span class="delimiter">)</span> <a href="../../../reflect/internal/Symbols.scala.html#46610" title="(info: LambdaLift.this.global.Type)LambdaLift.this.global.TermSymbol">setInfo</a> <a href="#602441" title="LambdaLift.this.global.Symbol">fv</a>.<a href="../../../reflect/internal/Symbols.scala.html#46608" title="=&gt; LambdaLift.this.global.Type">info</a>
              <span title="Any" class="keyword">if</span> <span class="delimiter">(</span><a href="#602399" title="LambdaLift.this.global.Symbol">owner</a>.<a href="../../../reflect/internal/Symbols.scala.html#46445" title="=&gt; Boolean">isClass</a><span class="delimiter">)</span> <a href="#602399" title="LambdaLift.this.global.Symbol">owner</a>.<a href="../../../reflect/internal/Symbols.scala.html#46608" title="=&gt; LambdaLift.this.global.Type">info</a>.<a href="../../../reflect/internal/Types.scala.html#41536" title="=&gt; LambdaLift.this.global.Scope">decls</a> <a href="../../../reflect/internal/Scopes.scala.html#60499" title="(sym: LambdaLift.this.global.Symbol)LambdaLift.this.global.Symbol">enter</a> <a href="#602442" title="LambdaLift.this.global.TermSymbol">proxy</a>
              <a href="#602442" title="LambdaLift.this.global.TermSymbol">proxy</a>
            <span class="delimiter">}</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(sym: LambdaLift.this.global.Symbol)LambdaLift.this.global.Symbol" id="601991">proxy</a><span class="delimiter">(</span><a title="LambdaLift.this.global.Symbol" id="602502">sym</a>: <a href="../../../reflect/internal/Symbols.scala.html#38726" title="LambdaLift.this.global.Symbol">Symbol</a><span class="delimiter">)</span> = <span class="delimiter">{</span>
      <span class="keyword">def</span> <a title="(enclosure: LambdaLift.this.global.Symbol)LambdaLift.this.global.Symbol" id="602505">searchIn</a><span class="delimiter">(</span><a title="LambdaLift.this.global.Symbol" id="602506">enclosure</a>: <a href="../../../reflect/internal/Symbols.scala.html#38726" title="LambdaLift.this.global.Symbol">Symbol</a><span class="delimiter">)</span>: <a href="../../../reflect/internal/Symbols.scala.html#38726" title="LambdaLift.this.global.Symbol">Symbol</a> = <span class="delimiter">{</span>
        <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#602506" title="LambdaLift.this.global.Symbol">enclosure</a> <span title="(x$1: AnyRef)Boolean">eq</span> <a href="../../../reflect/internal/Symbols.scala.html#38740" title="=&gt; LambdaLift.this.global.NoSymbol">NoSymbol</a><span class="delimiter">)</span> <span title="Nothing" class="keyword">throw</span> <span title="(x$1: String)IllegalArgumentException" class="keyword">new</span> <span title="IllegalArgumentException">IllegalArgumentException</span><span class="delimiter">(</span><span title="String(&quot;Could not find proxy for &quot;)" class="string">&quot;Could not find proxy for &quot;</span><span title="(x$1: Any)String">+</span> <a href="#602502" title="LambdaLift.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#46757" title="=&gt; String">defString</a> <span title="(x$1: Any)String">+</span><span title="String(&quot; in &quot;)" class="string">&quot; in &quot;</span><span title="(x$1: Any)String">+</span> <a href="#602502" title="LambdaLift.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#46566" title="=&gt; List[LambdaLift.this.global.Symbol]">ownerChain</a> <span title="(x$1: Any)String">+</span><span title="String(&quot; (currentOwner= &quot;)" class="string">&quot; (currentOwner= &quot;</span><span title="(x$1: Any)String">+</span> <a href="#242875" title="=&gt; LambdaLift.this.global.explicitOuter.global.Symbol">currentOwner</a> <span title="(x$1: Any)String">+</span><span title="String(&quot; )&quot;)" class="string">&quot; )&quot;</span><span class="delimiter">)</span>
        <a href="../Global.scala.html#186189" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><span title="String(&quot;searching for &quot;)" class="string">&quot;searching for &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#602502" title="LambdaLift.this.global.Symbol">sym</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;(&quot;)" class="string">&quot;(&quot;</span> <span title="(x$1: Any)String">+</span> <a href="#602502" title="LambdaLift.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#46564" title="=&gt; LambdaLift.this.global.Symbol">owner</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot;) in &quot;)" class="string">&quot;) in &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#602506" title="LambdaLift.this.global.Symbol">enclosure</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; &quot;)" class="string">&quot; &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#602506" title="LambdaLift.this.global.Symbol">enclosure</a>.<a href="../../../reflect/internal/Symbols.scala.html#46687" title="=&gt; LambdaLift.this.global.Symbol">logicallyEnclosingMember</a><span class="delimiter">)</span>

        <span class="keyword">val</span> <a title="List[LambdaLift.this.global.Symbol]" id="602507">ps</a> = <span class="delimiter">(</span><a href="#601964" title="=&gt; scala.collection.mutable.LinkedHashMap[LambdaLift.this.global.Symbol,List[LambdaLift.this.global.Symbol]]">proxies</a> <span title="(key: LambdaLift.this.global.Symbol)Option[List[LambdaLift.this.global.Symbol]]">get</span> <a href="#602506" title="LambdaLift.this.global.Symbol">enclosure</a>.<a href="../../../reflect/internal/Symbols.scala.html#46687" title="=&gt; LambdaLift.this.global.Symbol">logicallyEnclosingMember</a><span class="delimiter">)</span>.<span title="=&gt; List[List[LambdaLift.this.global.Symbol]]">toList</span>.<span title="(implicit asTraversable: List[LambdaLift.this.global.Symbol] =&gt; scala.collection.GenTraversableOnce[LambdaLift.this.global.Symbol])List[LambdaLift.this.global.Symbol]">flatten</span> <span title="(p: LambdaLift.this.global.Symbol =&gt; Boolean)List[LambdaLift.this.global.Symbol]">filter</span> <span class="delimiter">(</span><a href="#602558" title="LambdaLift.this.global.Symbol">_</a>.<a href="../../../reflect/internal/Symbols.scala.html#46571" title="=&gt; LambdaLift.this.global.Name">name</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#602502" title="LambdaLift.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#46571" title="=&gt; LambdaLift.this.global.Name">name</a><span class="delimiter">)</span>
        <span title="LambdaLift.this.global.Symbol" class="keyword">if</span> <span class="delimiter">(</span><a href="#602507" title="List[LambdaLift.this.global.Symbol]">ps</a>.<span title="=&gt; Boolean">isEmpty</span><span class="delimiter">)</span> <a href="#602505" title="(enclosure: LambdaLift.this.global.Symbol)LambdaLift.this.global.Symbol">searchIn</a><span class="delimiter">(</span><a href="#602506" title="LambdaLift.this.global.Symbol">enclosure</a>.<a href="../../../reflect/internal/Symbols.scala.html#46515" title="=&gt; LambdaLift.this.global.Symbol">skipConstructor</a>.<a href="../../../reflect/internal/Symbols.scala.html#46564" title="=&gt; LambdaLift.this.global.Symbol">owner</a><span class="delimiter">)</span>
        <span class="keyword">else</span> <a href="#602507" title="List[LambdaLift.this.global.Symbol]">ps</a>.<span title="=&gt; LambdaLift.this.global.Symbol">head</span>
      <span class="delimiter">}</span>
      <a href="../Global.scala.html#186189" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><span title="String(&quot;proxy &quot;)" class="string">&quot;proxy &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#602502" title="LambdaLift.this.global.Symbol">sym</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; in &quot;)" class="string">&quot; in &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#602502" title="LambdaLift.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#46564" title="=&gt; LambdaLift.this.global.Symbol">owner</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; from &quot;)" class="string">&quot; from &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#242875" title="=&gt; LambdaLift.this.global.explicitOuter.global.Symbol">currentOwner</a>.<a href="../../../reflect/internal/Symbols.scala.html#46566" title="=&gt; List[LambdaLift.this.global.explicitOuter.global.Symbol]">ownerChain</a>.<span title="(sep: String)String">mkString</span><span class="delimiter">(</span><span title="String(&quot; -&gt; &quot;)" class="string">&quot; -&gt; &quot;</span><span class="delimiter">)</span> <span title="(x$1: Any)String">+</span>
          <span title="String(&quot; &quot;)" class="string">&quot; &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#602502" title="LambdaLift.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#46564" title="=&gt; LambdaLift.this.global.Symbol">owner</a>.<a href="../../../reflect/internal/Symbols.scala.html#46687" title="=&gt; LambdaLift.this.global.Symbol">logicallyEnclosingMember</a><span class="delimiter">)</span>

      <span title="LambdaLift.this.global.Symbol" class="keyword">if</span> <span class="delimiter">(</span><a href="#601985" title="(sym: LambdaLift.this.global.Symbol)Boolean">isSameOwnerEnclosure</a><span class="delimiter">(</span><a href="#602502" title="LambdaLift.this.global.Symbol">sym</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="#602502" title="LambdaLift.this.global.Symbol">sym</a>
      <span class="keyword">else</span> <a href="#602505" title="(enclosure: LambdaLift.this.global.Symbol)LambdaLift.this.global.Symbol">searchIn</a><span class="delimiter">(</span><a href="#242875" title="=&gt; LambdaLift.this.global.explicitOuter.global.Symbol">currentOwner</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(sym: LambdaLift.this.global.Symbol)LambdaLift.this.global.Select" id="601992">memberRef</a><span class="delimiter">(</span><a title="LambdaLift.this.global.Symbol" id="602568">sym</a>: <a href="../../../reflect/internal/Symbols.scala.html#38726" title="LambdaLift.this.global.Symbol">Symbol</a><span class="delimiter">)</span> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="LambdaLift.this.global.Symbol" id="602571">clazz</a> = <a href="#602568" title="LambdaLift.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#46564" title="=&gt; LambdaLift.this.global.Symbol">owner</a>.<a href="../../../reflect/internal/Symbols.scala.html#46662" title="=&gt; LambdaLift.this.global.Symbol">enclClass</a>
      //Console.println(&quot;memberRef from &quot;+currentClass+&quot; to &quot;+sym+&quot; in &quot;+clazz)
      <span class="keyword">val</span> <a title="LambdaLift.this.global.gen.global.Tree" id="602572">qual</a> = <span title="LambdaLift.this.global.gen.global.Tree" class="keyword">if</span> <span class="delimiter">(</span><a href="#602571" title="LambdaLift.this.global.Symbol">clazz</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#242875" title="=&gt; LambdaLift.this.global.explicitOuter.global.Symbol">currentClass</a><span class="delimiter">)</span> <a href="../Global.scala.html#186149" title="object LambdaLift.this.global.gen">gen</a>.<a href="../../../reflect/internal/TreeGen.scala.html#92352" title="(sym: LambdaLift.this.global.gen.global.Symbol)LambdaLift.this.global.gen.global.Tree">mkAttributedThis</a><span class="delimiter">(</span><a href="#602571" title="LambdaLift.this.global.Symbol">clazz</a><span class="delimiter">)</span>
                 <span class="keyword">else</span> <span class="delimiter">{</span>
                   <a href="#602568" title="LambdaLift.this.global.Symbol">sym</a> <a href="../../../reflect/internal/Symbols.scala.html#46590" title="(mask: Long)sym.type">resetFlag</a><span class="delimiter">(</span>LOCAL <span title="Long(524292L)">|</span> PRIVATE<span class="delimiter">)</span>
                   <span title="LambdaLift.this.global.gen.global.Tree" class="keyword">if</span> <span class="delimiter">(</span><a href="#602571" title="LambdaLift.this.global.Symbol">clazz</a>.<a href="../../../reflect/internal/Symbols.scala.html#46548" title="=&gt; Boolean">isStaticOwner</a><span class="delimiter">)</span> <a href="../Global.scala.html#186149" title="object LambdaLift.this.global.gen">gen</a>.<a href="../../../reflect/internal/TreeGen.scala.html#92341" title="(tpe: LambdaLift.this.global.gen.global.Type)LambdaLift.this.global.gen.global.Tree">mkAttributedQualifier</a><span class="delimiter">(</span><a href="#602571" title="LambdaLift.this.global.Symbol">clazz</a>.<a href="../../../reflect/internal/Symbols.scala.html#46667" title="=&gt; LambdaLift.this.global.Type">thisType</a><span class="delimiter">)</span>
                   <span class="keyword">else</span> <a href="ExplicitOuter.scala.html#599563" title="(base: LambdaLift.this.global.explicitOuter.global.Tree, from: LambdaLift.this.global.explicitOuter.global.Symbol, to: LambdaLift.this.global.explicitOuter.global.Symbol)LambdaLift.this.global.explicitOuter.global.Tree">outerPath</a><span class="delimiter">(</span><a href="ExplicitOuter.scala.html#599561" title="=&gt; LambdaLift.this.global.explicitOuter.global.Tree">outerValue</a>, <a href="#242875" title="=&gt; LambdaLift.this.global.explicitOuter.global.Symbol">currentClass</a>.<a href="../../../reflect/internal/Symbols.scala.html#46674" title="=&gt; LambdaLift.this.global.explicitOuter.global.Symbol">outerClass</a>, <a href="#602571" title="LambdaLift.this.global.Symbol">clazz</a><span class="delimiter">)</span>
                 <span class="delimiter">}</span>
      <a href="../SubComponent.scala.html#231956" title="(qualifier: LambdaLift.this.global.Tree, sym: LambdaLift.this.global.Symbol)LambdaLift.this.global.Select">Select</a><span class="delimiter">(</span><a href="#602572" title="LambdaLift.this.global.gen.global.Tree">qual</a>, <a href="#602568" title="LambdaLift.this.global.Symbol">sym</a><span class="delimiter">)</span> <span title="(tp: LambdaLift.this.global.Type)LambdaLift.this.global.Select">setType</span> <a href="#602568" title="LambdaLift.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#46606" title="=&gt; LambdaLift.this.global.Type">tpe</a>
    <span class="delimiter">}</span>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(sym: LambdaLift.this.global.Symbol)LambdaLift.this.global.gen.global.Tree" id="601993">proxyRef</a><span class="delimiter">(</span><a title="LambdaLift.this.global.Symbol" id="602618">sym</a>: <a href="../../../reflect/internal/Symbols.scala.html#38726" title="LambdaLift.this.global.Symbol">Symbol</a><span class="delimiter">)</span> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="LambdaLift.this.global.Symbol" id="602621">psym</a> = <a href="#601991" title="(sym: LambdaLift.this.global.Symbol)LambdaLift.this.global.Symbol">proxy</a><span class="delimiter">(</span><a href="#602618" title="LambdaLift.this.global.Symbol">sym</a><span class="delimiter">)</span>
      <span title="LambdaLift.this.global.gen.global.Tree" class="keyword">if</span> <span class="delimiter">(</span><a href="#602621" title="LambdaLift.this.global.Symbol">psym</a>.<a href="../../../reflect/internal/Symbols.scala.html#46550" title="=&gt; Boolean">isLocal</a><span class="delimiter">)</span> <a href="../Global.scala.html#186149" title="object LambdaLift.this.global.gen">gen</a>.<a href="../../../reflect/internal/TreeGen.scala.html#92353" title="(sym: LambdaLift.this.global.gen.global.Symbol)LambdaLift.this.global.gen.global.Tree">mkAttributedIdent</a><span class="delimiter">(</span><a href="#602621" title="LambdaLift.this.global.Symbol">psym</a><span class="delimiter">)</span> <span class="keyword">else</span> <a href="#601992" title="(sym: LambdaLift.this.global.Symbol)LambdaLift.this.global.Select">memberRef</a><span class="delimiter">(</span><a href="#602621" title="LambdaLift.this.global.Symbol">psym</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(pos: LambdaLift.this.global.Position, sym: LambdaLift.this.global.Symbol, args: List[LambdaLift.this.global.Tree])List[LambdaLift.this.global.Tree]" id="601994">addFreeArgs</a><span class="delimiter">(</span><a title="LambdaLift.this.global.Position" id="602623">pos</a>: <a href="../util/Position.scala.html#33991" title="LambdaLift.this.global.Position">Position</a>, <a title="LambdaLift.this.global.Symbol" id="602624">sym</a>: <a href="../../../reflect/internal/Symbols.scala.html#38726" title="LambdaLift.this.global.Symbol">Symbol</a>, <a title="List[LambdaLift.this.global.Tree]" id="602625">args</a>: <span title="List[LambdaLift.this.global.Tree]">List</span><span class="delimiter">[</span>Tree<span class="delimiter">]</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
      <a href="#601962" title="=&gt; scala.collection.mutable.LinkedHashMap[LambdaLift.this.global.Symbol,LambdaLifter.this.SymSet]">free</a> <span title="(key: LambdaLift.this.global.Symbol)Option[LambdaLifter.this.SymSet]">get</span> <a href="#602624" title="LambdaLift.this.global.Symbol">sym</a> <span title="List[LambdaLift.this.global.Tree]" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <span title="List[LambdaLift.this.global.Tree]">Some</span><span class="delimiter">(</span><a title="LambdaLifter.this.SymSet" id="602632">fvs</a><span class="delimiter">)</span> =&gt; <a href="#602625" title="List[LambdaLift.this.global.Tree]">args</a> <span title="(that: scala.collection.GenTraversableOnce[LambdaLift.this.global.Tree])(implicit bf: scala.collection.generic.CanBuildFrom[List[LambdaLift.this.global.Tree],LambdaLift.this.global.Tree,List[LambdaLift.this.global.Tree]])List[LambdaLift.this.global.Tree]">++</span> <span class="delimiter">(</span><a href="#602632" title="LambdaLifter.this.SymSet">fvs</a>.<a href="../../../reflect/internal/util/Set.scala.html#129813" title="=&gt; List[LambdaLift.this.global.Symbol]">toList</a> <span title="(f: LambdaLift.this.global.Symbol =&gt; LambdaLift.this.global.gen.global.Tree)(implicit bf: scala.collection.generic.CanBuildFrom[List[LambdaLift.this.global.Symbol],LambdaLift.this.global.gen.global.Tree,List[LambdaLift.this.global.gen.global.Tree]])List[LambdaLift.this.global.gen.global.Tree]">map</span> <span class="delimiter">(</span><a title="LambdaLift.this.global.Symbol" id="602678">fv</a> =&gt; <a href="../../../reflect/internal/Trees.scala.html#39387" title="(pos: LambdaLift.this.global.Position)(tree: LambdaLift.this.global.gen.global.Tree)LambdaLift.this.global.gen.global.Tree">atPos</a><span class="delimiter">(</span><a href="#602623" title="LambdaLift.this.global.Position">pos</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#601993" title="(sym: LambdaLift.this.global.Symbol)LambdaLift.this.global.gen.global.Tree">proxyRef</a><span class="delimiter">(</span><a href="#602678" title="LambdaLift.this.global.Symbol">fv</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="keyword">case</span> <span title="List[LambdaLift.this.global.Tree]">_</span>         =&gt; <a href="#602625" title="List[LambdaLift.this.global.Tree]">args</a>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(tree: LambdaLift.this.global.Tree, sym: LambdaLift.this.global.Symbol)LambdaLift.this.global.Tree" id="601995">addFreeParams</a><span class="delimiter">(</span><a title="LambdaLift.this.global.Tree" id="602757">tree</a>: <span title="LambdaLift.this.global.Tree">Tree</span>, <a title="LambdaLift.this.global.Symbol" id="602758">sym</a>: <a href="../../../reflect/internal/Symbols.scala.html#38726" title="LambdaLift.this.global.Symbol">Symbol</a><span class="delimiter">)</span>: <span title="LambdaLift.this.global.Tree">Tree</span> = <a href="#601964" title="=&gt; scala.collection.mutable.LinkedHashMap[LambdaLift.this.global.Symbol,List[LambdaLift.this.global.Symbol]]">proxies</a>.<span title="(key: LambdaLift.this.global.Symbol)Option[List[LambdaLift.this.global.Symbol]]">get</span><span class="delimiter">(</span><a href="#602758" title="LambdaLift.this.global.Symbol">sym</a><span class="delimiter">)</span> <span title="LambdaLift.this.global.Tree" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <span title="LambdaLift.this.global.Tree">Some</span><span class="delimiter">(</span><a title="List[LambdaLift.this.global.Symbol]" id="602764">ps</a><span class="delimiter">)</span> =&gt;
        <span class="keyword">val</span> <a title="List[LambdaLift.this.global.ValDef]" id="602765">freeParams</a> = <a href="#602764" title="List[LambdaLift.this.global.Symbol]">ps</a> <span title="(f: LambdaLift.this.global.Symbol =&gt; LambdaLift.this.global.ValDef)(implicit bf: scala.collection.generic.CanBuildFrom[List[LambdaLift.this.global.Symbol],LambdaLift.this.global.ValDef,List[LambdaLift.this.global.ValDef]])List[LambdaLift.this.global.ValDef]">map</span> <span class="delimiter">(</span><a title="LambdaLift.this.global.Symbol" id="602782">p</a> =&gt; <a href="../../../reflect/internal/Trees.scala.html#39364" title="(sym: LambdaLift.this.global.Symbol)LambdaLift.this.global.ValDef">ValDef</a><span class="delimiter">(</span><a href="#602782" title="LambdaLift.this.global.Symbol">p</a><span class="delimiter">)</span> <span title="(pos: scala.tools.nsc.util.Position)LambdaLift.this.global.ValDef">setPos</span> <a href="#602757" title="LambdaLift.this.global.Tree">tree</a>.<span title="=&gt; LambdaLift.this.global.Position">pos</span> <span title="(tp: LambdaLift.this.global.Type)LambdaLift.this.global.ValDef">setType</span> <a href="../../../reflect/internal/Types.scala.html#38827" title="object LambdaLift.this.global.NoType">NoType</a><span class="delimiter">)</span>
        <a href="#602757" title="LambdaLift.this.global.Tree">tree</a> <span title="LambdaLift.this.global.Tree" class="keyword">match</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> <span title="LambdaLift.this.global.explicitOuter.global.DefDef">DefDef</span><span class="delimiter">(</span><a title="LambdaLift.this.global.Modifiers" id="602842">mods</a>, <a title="LambdaLift.this.global.Name" id="602843">name</a>, <a title="List[LambdaLift.this.global.TypeDef]" id="602844">tparams</a>, <a title="List[List[LambdaLift.this.global.ValDef]]" id="602845">vparamss</a>, <a title="LambdaLift.this.global.Tree" id="602846">tpt</a>, <a title="LambdaLift.this.global.Tree" id="602847">rhs</a><span class="delimiter">)</span> =&gt;
            <span class="keyword">val</span> <a title="List[LambdaLift.this.global.Symbol]" id="602848">addParams</a> = <a href="../../../reflect/internal/Symbols.scala.html#38745" title="(syms: List[LambdaLift.this.global.Symbol])List[LambdaLift.this.global.Symbol]">cloneSymbols</a><span class="delimiter">(</span><a href="#602764" title="List[LambdaLift.this.global.Symbol]">ps</a><span class="delimiter">)</span>.<span title="(f: LambdaLift.this.global.Symbol =&gt; LambdaLift.this.global.Symbol)(implicit bf: scala.collection.generic.CanBuildFrom[List[LambdaLift.this.global.Symbol],LambdaLift.this.global.Symbol,List[LambdaLift.this.global.Symbol]])List[LambdaLift.this.global.Symbol]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.List.Coll,LambdaLift.this.global.Symbol,List[LambdaLift.this.global.Symbol]]" class="delimiter">(</span><a href="#602869" title="LambdaLift.this.global.Symbol">_</a>.<a href="../../../reflect/internal/Symbols.scala.html#46589" title="(mask: Long)x$7.type">setFlag</a><span class="delimiter">(</span><span title="Long(8192L)">PARAM</span><span class="delimiter">)</span><span class="delimiter">)</span>
            <a href="#602758" title="LambdaLift.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#46615" title="(info: LambdaLift.this.global.Type)LambdaLift.this.global.Symbol">updateInfo</a><span class="delimiter">(</span>
              <a href="../../../reflect/internal/Types.scala.html#74770" title="(tp: LambdaLift.this.global.Type)LambdaLift.this.global.Type">lifted</a><span class="delimiter">(</span><a href="../../../reflect/internal/Types.scala.html#62346" title="(params: List[LambdaLift.this.global.Symbol], resultType: LambdaLift.this.global.Type)LambdaLift.this.global.MethodType">MethodType</a><span class="delimiter">(</span><a href="#602758" title="LambdaLift.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#46608" title="=&gt; LambdaLift.this.global.Type">info</a>.<a href="../../../reflect/internal/Types.scala.html#41526" title="=&gt; List[LambdaLift.this.global.Symbol]">params</a> <a href="#602917" title="(prefix: List[LambdaLift.this.global.Symbol])List[LambdaLift.this.global.Symbol]">:::</a> <a href="#602848" title="List[LambdaLift.this.global.Symbol]">addParams</a>, <a href="#602758" title="LambdaLift.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#46608" title="=&gt; LambdaLift.this.global.Type">info</a>.<a href="../../../reflect/internal/Types.scala.html#41519" title="=&gt; LambdaLift.this.global.Type">resultType</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
            <a href="#242875" title="=&gt; LambdaLift.this.global.explicitOuter.global.TreeCopier">treeCopy</a>.<span title="(tree: LambdaLift.this.global.explicitOuter.global.Tree, mods: LambdaLift.this.global.explicitOuter.global.Modifiers, name: LambdaLift.this.global.explicitOuter.global.Name, tparams: List[LambdaLift.this.global.explicitOuter.global.TypeDef], vparamss: List[List[LambdaLift.this.global.explicitOuter.global.ValDef]], tpt: LambdaLift.this.global.explicitOuter.global.Tree, rhs: LambdaLift.this.global.explicitOuter.global.Tree)LambdaLift.this.global.explicitOuter.global.DefDef">DefDef</span><span class="delimiter">(</span><a href="#602757" title="LambdaLift.this.global.Tree">tree</a>, <a href="#602842" title="LambdaLift.this.global.Modifiers">mods</a>, <a href="#602843" title="LambdaLift.this.global.Name">name</a>, <a href="#602844" title="List[LambdaLift.this.global.TypeDef]">tparams</a>, <span title="(xs: List[LambdaLift.this.global.explicitOuter.global.ValDef]*)List[List[LambdaLift.this.global.explicitOuter.global.ValDef]]">List</span><span class="delimiter">(</span><a href="#602845" title="List[List[LambdaLift.this.global.ValDef]]">vparamss</a>.<span title="=&gt; List[LambdaLift.this.global.ValDef]">head</span> <span title="(that: scala.collection.GenTraversableOnce[LambdaLift.this.global.ValDef])(implicit bf: scala.collection.generic.CanBuildFrom[List[LambdaLift.this.global.ValDef],LambdaLift.this.global.ValDef,List[LambdaLift.this.global.explicitOuter.global.ValDef]])List[LambdaLift.this.global.explicitOuter.global.ValDef]">++</span> <a href="#602765" title="List[LambdaLift.this.global.ValDef]">freeParams</a><span class="delimiter">)</span>, <a href="#602846" title="LambdaLift.this.global.Tree">tpt</a>, <a href="#602847" title="LambdaLift.this.global.Tree">rhs</a><span class="delimiter">)</span>
          <span class="keyword">case</span> <span title="LambdaLift.this.global.explicitOuter.global.ClassDef">ClassDef</span><span class="delimiter">(</span><a title="LambdaLift.this.global.Modifiers" id="603022">mods</a>, <a title="LambdaLift.this.global.TypeName" id="603023">name</a>, <a title="List[LambdaLift.this.global.TypeDef]" id="603024">tparams</a>, <a title="LambdaLift.this.global.Template" id="603025">impl</a> @ Template<span class="delimiter">(</span><a title="List[LambdaLift.this.global.Tree]" id="603038">parents</a>, <a title="LambdaLift.this.global.ValDef" id="603039">self</a>, <a title="List[LambdaLift.this.global.Tree]" id="603040">body</a><span class="delimiter">)</span><span class="delimiter">)</span> =&gt;
            // Disabled attempt to to add getters to freeParams
            // this does not work yet. Problem is that local symbols need local names
            // and references to local symbols need to be transformed into
            // method calls to setters.
            // def paramGetter(param: Symbol): Tree = {
            //   val getter = param.newGetter setFlag TRANS_FLAG resetFlag PARAMACCESSOR // mark because we have to add them to interface
            //   sym.info.decls.enter(getter)
            //   val rhs = Select(gen.mkAttributedThis(sym), param) setType param.tpe
            //   DefDef(getter, rhs) setPos tree.pos setType NoType
            // }
            // val newDefs = if (sym.isTrait) freeParams ::: (ps map paramGetter) else freeParams
            <a href="#242875" title="=&gt; LambdaLift.this.global.explicitOuter.global.TreeCopier">treeCopy</a>.<span title="(tree: LambdaLift.this.global.explicitOuter.global.Tree, mods: LambdaLift.this.global.explicitOuter.global.Modifiers, name: LambdaLift.this.global.explicitOuter.global.Name, tparams: List[LambdaLift.this.global.explicitOuter.global.TypeDef], impl: LambdaLift.this.global.explicitOuter.global.Template)LambdaLift.this.global.explicitOuter.global.ClassDef">ClassDef</span><span class="delimiter">(</span><a href="#602757" title="LambdaLift.this.global.Tree">tree</a>, <a href="#603022" title="LambdaLift.this.global.Modifiers">mods</a>, <a href="#603023" title="LambdaLift.this.global.TypeName">name</a>, <a href="#603024" title="List[LambdaLift.this.global.TypeDef]">tparams</a>,
                              <a href="#242875" title="=&gt; LambdaLift.this.global.explicitOuter.global.TreeCopier">treeCopy</a>.<span title="(tree: LambdaLift.this.global.explicitOuter.global.Tree, parents: List[LambdaLift.this.global.explicitOuter.global.Tree], self: LambdaLift.this.global.explicitOuter.global.ValDef, body: List[LambdaLift.this.global.explicitOuter.global.Tree])LambdaLift.this.global.explicitOuter.global.Template">Template</span><span class="delimiter">(</span><a href="#603025" title="LambdaLift.this.global.Template">impl</a>, <a href="#603038" title="List[LambdaLift.this.global.Tree]">parents</a>, <a href="#603039" title="LambdaLift.this.global.ValDef">self</a>, <a href="#603040" title="List[LambdaLift.this.global.Tree]">body</a> <a href="#603050" title="(prefix: List[LambdaLift.this.global.Tree])List[LambdaLift.this.global.Tree]">:::</a> <a href="#602765" title="List[LambdaLift.this.global.ValDef]">freeParams</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>
      <span class="keyword">case</span> <span title="LambdaLift.this.global.Tree">None</span> =&gt;
        <a href="#602757" title="LambdaLift.this.global.Tree">tree</a>
    <span class="delimiter">}</span>

/*  Something like this will be necessary to eliminate the implementation
 *  restiction from paramGetter above:
 *  We need to pass getters to the interface of an implementation class.
    private def fixTraitGetters(lifted: List[Tree]): List[Tree] =
      for (stat &lt;- lifted) yield stat match {
        case ClassDef(mods, name, tparams, templ @ Template(parents, self, body))
        if stat.symbol.isTrait &amp;&amp; !stat.symbol.isImplClass =&gt;
          val iface = stat.symbol
          lifted.find(l =&gt; l.symbol.isImplClass &amp;&amp; l.symbol.toInterface == iface) match {
            case Some(implDef) =&gt;
              val impl = implDef.symbol
              val implGetters = impl.info.decls.toList filter (_ hasFlag TRANS_FLAG)
              if (implGetters.nonEmpty) {
                val ifaceGetters = implGetters map { ig =&gt;
                  ig resetFlag TRANS_FLAG
                  val getter = ig cloneSymbol iface setFlag DEFERRED
                  iface.info.decls enter getter
                  getter
                }
                val ifaceGetterDefs = ifaceGetters map (DefDef(_, EmptyTree) setType NoType)
                treeCopy.ClassDef(
                  stat, mods, name, tparams,
                  treeCopy.Template(templ, parents, self, body ::: ifaceGetterDefs))
              } else
                stat
            case None =&gt;
              stat
          }
        case _ =&gt;
          stat
      }
*/
    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(tree: LambdaLift.this.global.Tree)LambdaLift.this.global.Tree" id="601996">liftDef</a><span class="delimiter">(</span><a title="LambdaLift.this.global.Tree" id="603058">tree</a>: <span title="LambdaLift.this.global.Tree">Tree</span><span class="delimiter">)</span>: <span title="LambdaLift.this.global.Tree">Tree</span> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="LambdaLift.this.global.Symbol" id="603060">sym</a> = <a href="#603058" title="LambdaLift.this.global.Tree">tree</a>.<span title="=&gt; LambdaLift.this.global.Symbol">symbol</span>
      <span class="keyword">val</span> <a title="LambdaLift.this.global.Symbol" id="603061">oldOwner</a> = <a href="#603060" title="LambdaLift.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#46564" title="=&gt; LambdaLift.this.global.Symbol">owner</a>
      <span title="Any" class="keyword">if</span> <span class="delimiter">(</span><a href="#603060" title="LambdaLift.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#46564" title="=&gt; LambdaLift.this.global.Symbol">owner</a>.<a href="../../../reflect/internal/Symbols.scala.html#46540" title="=&gt; Boolean">isAuxiliaryConstructor</a> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#603060" title="LambdaLift.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#46461" title="=&gt; Boolean">isMethod</a><span class="delimiter">)</span>  // # bug 1909
    	  <a href="#603060" title="LambdaLift.this.global.Symbol">sym</a> <a href="../../../reflect/internal/Symbols.scala.html#46589" title="(mask: Long)sym.type">setFlag</a> <span title="Long(8388608L)">STATIC</span>
      <a href="#603060" title="LambdaLift.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#46565" title="(owner: LambdaLift.this.global.Symbol)Unit">owner</a> = <a href="#603060" title="LambdaLift.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#46564" title="=&gt; LambdaLift.this.global.Symbol">owner</a>.<a href="../../../reflect/internal/Symbols.scala.html#46662" title="=&gt; LambdaLift.this.global.Symbol">enclClass</a>
      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#603060" title="LambdaLift.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#46445" title="=&gt; Boolean">isClass</a><span class="delimiter">)</span> <a href="#603060" title="LambdaLift.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#46565" title="(owner: LambdaLift.this.global.Symbol)Unit">owner</a> = <a href="#603060" title="LambdaLift.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#46564" title="=&gt; LambdaLift.this.global.Symbol">owner</a>.<a href="../../../reflect/internal/Symbols.scala.html#46697" title="=&gt; LambdaLift.this.global.Symbol">toInterface</a>
      <span title="Any" class="keyword">if</span> <span class="delimiter">(</span><a href="#603060" title="LambdaLift.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#46461" title="=&gt; Boolean">isMethod</a><span class="delimiter">)</span> <a href="#603060" title="LambdaLift.this.global.Symbol">sym</a> <a href="../../../reflect/internal/Symbols.scala.html#46589" title="(mask: Long)sym.type">setFlag</a> <span title="Long(17179869184L)">LIFTED</span>
      <a href="#601977" title="(key: LambdaLift.this.global.Symbol, value: List[LambdaLift.this.global.Tree])Unit">liftedDefs</a><span class="delimiter">(</span><a href="#603060" title="LambdaLift.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#46564" title="=&gt; LambdaLift.this.global.Symbol">owner</a><span class="delimiter">)</span> <span title="(x: LambdaLift.this.global.Tree)List[LambdaLift.this.global.Tree]">::=</span> <a href="#603058" title="LambdaLift.this.global.Tree">tree</a>
      <a href="#603060" title="LambdaLift.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#46564" title="=&gt; LambdaLift.this.global.Symbol">owner</a>.<a href="../../../reflect/internal/Symbols.scala.html#46608" title="=&gt; LambdaLift.this.global.Type">info</a>.<a href="../../../reflect/internal/Types.scala.html#41536" title="=&gt; LambdaLift.this.global.Scope">decls</a> <a href="../../../reflect/internal/Scopes.scala.html#60500" title="(sym: LambdaLift.this.global.Symbol)Unit">enterUnique</a> <a href="#603060" title="LambdaLift.this.global.Symbol">sym</a>
      <a href="../Global.scala.html#186189" title="(msg: =&gt; String)Unit">debuglog</a><span class="delimiter">(</span><span title="String(&quot;lifted: &quot;)" class="string">&quot;lifted: &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#603060" title="LambdaLift.this.global.Symbol">sym</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; from &quot;)" class="string">&quot; from &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#603061" title="LambdaLift.this.global.Symbol">oldOwner</a> <span title="(x$1: Any)String">+</span> <span title="String(&quot; to &quot;)" class="string">&quot; to &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#603060" title="LambdaLift.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#46564" title="=&gt; LambdaLift.this.global.Symbol">owner</a><span class="delimiter">)</span>
      <a href="../SubComponent.scala.html#231956" title="object LambdaLift.this.global.EmptyTree">EmptyTree</a>
    <span class="delimiter">}</span>

    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(tree: LambdaLift.this.global.Tree, isBoxedRef: Boolean)LambdaLift.this.global.Tree" id="601997">postTransform</a><span class="delimiter">(</span><a title="LambdaLift.this.global.Tree" id="603138">tree</a>: <span title="LambdaLift.this.global.Tree">Tree</span>, <a title="Boolean" id="603141">isBoxedRef</a>: <span title="Boolean">Boolean</span> = <span title="Boolean(false)" class="keyword">false</span><span class="delimiter">)</span>: <span title="LambdaLift.this.global.Tree">Tree</span> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="LambdaLift.this.global.Symbol" id="603142">sym</a> = <a href="#603138" title="LambdaLift.this.global.Tree">tree</a>.<span title="=&gt; LambdaLift.this.global.Symbol">symbol</span>
      <a href="#603138" title="LambdaLift.this.global.Tree">tree</a> <span title="LambdaLift.this.global.Tree" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <span title="LambdaLift.this.global.Tree">ClassDef</span><span class="delimiter">(</span>_, _, _, _<span class="delimiter">)</span> =&gt;
          <span class="keyword">val</span> <a title="LambdaLift.this.global.Tree" id="603149">tree1</a> = <a href="#601995" title="(tree: LambdaLift.this.global.Tree, sym: LambdaLift.this.global.Symbol)LambdaLift.this.global.Tree">addFreeParams</a><span class="delimiter">(</span><a href="#603138" title="LambdaLift.this.global.Tree">tree</a>, <a href="#603142" title="LambdaLift.this.global.Symbol">sym</a><span class="delimiter">)</span>
          <span title="LambdaLift.this.global.Tree" class="keyword">if</span> <span class="delimiter">(</span><a href="#603142" title="LambdaLift.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#46550" title="=&gt; Boolean">isLocal</a><span class="delimiter">)</span> <a href="#601996" title="(tree: LambdaLift.this.global.Tree)LambdaLift.this.global.Tree">liftDef</a><span class="delimiter">(</span><a href="#603149" title="LambdaLift.this.global.Tree">tree1</a><span class="delimiter">)</span> <span class="keyword">else</span> <a href="#603149" title="LambdaLift.this.global.Tree">tree1</a>
        <span class="keyword">case</span> <span title="LambdaLift.this.global.Tree">DefDef</span><span class="delimiter">(</span>_, _, _, _, _, _<span class="delimiter">)</span> =&gt;
          <span class="keyword">val</span> <a title="LambdaLift.this.global.Tree" id="603158">tree1</a> = <a href="#601995" title="(tree: LambdaLift.this.global.Tree, sym: LambdaLift.this.global.Symbol)LambdaLift.this.global.Tree">addFreeParams</a><span class="delimiter">(</span><a href="#603138" title="LambdaLift.this.global.Tree">tree</a>, <a href="#603142" title="LambdaLift.this.global.Symbol">sym</a><span class="delimiter">)</span>
          <span title="LambdaLift.this.global.Tree" class="keyword">if</span> <span class="delimiter">(</span><a href="#603142" title="LambdaLift.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#46550" title="=&gt; Boolean">isLocal</a><span class="delimiter">)</span> <a href="#601996" title="(tree: LambdaLift.this.global.Tree)LambdaLift.this.global.Tree">liftDef</a><span class="delimiter">(</span><a href="#603158" title="LambdaLift.this.global.Tree">tree1</a><span class="delimiter">)</span> <span class="keyword">else</span> <a href="#603158" title="LambdaLift.this.global.Tree">tree1</a>
        <span class="keyword">case</span> <span title="LambdaLift.this.global.Tree">ValDef</span><span class="delimiter">(</span><a title="LambdaLift.this.global.Modifiers" id="603165">mods</a>, <a title="LambdaLift.this.global.TermName" id="603166">name</a>, <a title="LambdaLift.this.global.Tree" id="603167">tpt</a>, <a title="LambdaLift.this.global.Tree" id="603168">rhs</a><span class="delimiter">)</span> =&gt;
          <span title="LambdaLift.this.global.Tree" class="keyword">if</span> <span class="delimiter">(</span><a href="#603142" title="LambdaLift.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#46482" title="=&gt; Boolean">isCapturedVariable</a><span class="delimiter">)</span> <span class="delimiter">{</span>
            <span class="keyword">val</span> <a title="LambdaLift.this.global.TypeTree" id="603169">tpt1</a> = <a href="../SubComponent.scala.html#231956" title="(tp: LambdaLift.this.global.Type)LambdaLift.this.global.TypeTree">TypeTree</a><span class="delimiter">(</span><a href="#603142" title="LambdaLift.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#46606" title="=&gt; LambdaLift.this.global.Type">tpe</a><span class="delimiter">)</span> <span title="(pos: scala.tools.nsc.util.Position)LambdaLift.this.global.TypeTree">setPos</span> <a href="#603167" title="LambdaLift.this.global.Tree">tpt</a>.<span title="=&gt; LambdaLift.this.global.Position">pos</span>
            /* Creating a constructor argument if one isn't present. */
            <span class="keyword">val</span> <a title="LambdaLift.this.global.gen.global.Tree" id="603170">constructorArg</a> = <a href="#603168" title="LambdaLift.this.global.Tree">rhs</a> <span title="LambdaLift.this.global.gen.global.Tree" class="keyword">match</span> <span class="delimiter">{</span>
              <span class="keyword">case</span> <a href="../SubComponent.scala.html#231956" title="LambdaLift.this.global.gen.global.Tree">EmptyTree</a> =&gt;
                <a href="#603142" title="LambdaLift.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#46664" title="=&gt; LambdaLift.this.global.Symbol">primaryConstructor</a>.<a href="../../../reflect/internal/Symbols.scala.html#46608" title="=&gt; LambdaLift.this.global.Type">info</a>.<a href="../../../reflect/internal/Types.scala.html#41527" title="=&gt; List[LambdaLift.this.global.Type]">paramTypes</a> <span title="LambdaLift.this.global.gen.global.Tree" class="keyword">match</span> <span class="delimiter">{</span>
                  <span class="keyword">case</span> <a href="#603181" title="LambdaLift.this.global.gen.global.Tree">List</a><span class="delimiter">(</span><a title="LambdaLift.this.global.Type" id="603203">tp</a><span class="delimiter">)</span> =&gt; <a href="../Global.scala.html#186149" title="object LambdaLift.this.global.gen">gen</a>.<a href="../../../reflect/internal/TreeGen.scala.html#92367" title="(tp: LambdaLift.this.global.gen.global.Type)LambdaLift.this.global.gen.global.Tree">mkZero</a><span class="delimiter">(</span><a href="#603203" title="LambdaLift.this.global.Type">tp</a><span class="delimiter">)</span>
                  <span class="keyword">case</span> <span title="LambdaLift.this.global.Tree">_</span>        =&gt;
                    <a href="../Global.scala.html#186199" title="(msg: =&gt; AnyRef)Unit">log</a><span class="delimiter">(</span><span title="String(&quot;Couldn\'t determine how to properly construct &quot;)" class="string">&quot;Couldn't determine how to properly construct &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#603142" title="LambdaLift.this.global.Symbol">sym</a><span class="delimiter">)</span>
                    <a href="#603168" title="LambdaLift.this.global.Tree">rhs</a>
                <span class="delimiter">}</span>
              <span class="keyword">case</span> <a title="LambdaLift.this.global.Tree" id="603205">arg</a> =&gt; <a href="#603205" title="LambdaLift.this.global.Tree">arg</a>
            <span class="delimiter">}</span>
            /** Wrap expr argument in new *Ref(..) constructor, but make
             *  sure that Try expressions stay at toplevel.
             */
            <span class="keyword">def</span> <a title="(expr: LambdaLift.this.global.Tree)LambdaLift.this.global.Tree" id="603171">refConstr</a><span class="delimiter">(</span><a title="LambdaLift.this.global.Tree" id="603206">expr</a>: <span title="LambdaLift.this.global.Tree">Tree</span><span class="delimiter">)</span>: <span title="LambdaLift.this.global.Tree">Tree</span> = <a href="#603206" title="LambdaLift.this.global.Tree">expr</a> <span title="LambdaLift.this.global.Tree" class="keyword">match</span> <span class="delimiter">{</span>
              <span class="keyword">case</span> <span title="LambdaLift.this.global.Try">Try</span><span class="delimiter">(</span><a title="LambdaLift.this.global.Tree" id="603210">block</a>, <a title="List[LambdaLift.this.global.CaseDef]" id="603211">catches</a>, <a title="LambdaLift.this.global.Tree" id="603212">finalizer</a><span class="delimiter">)</span> =&gt;
                <a href="../SubComponent.scala.html#231956" title="(block: LambdaLift.this.global.Tree, catches: List[LambdaLift.this.global.CaseDef], finalizer: LambdaLift.this.global.Tree)LambdaLift.this.global.Try">Try</a><span class="delimiter">(</span><a href="#603171" title="(expr: LambdaLift.this.global.Tree)LambdaLift.this.global.Tree">refConstr</a><span class="delimiter">(</span><a href="#603210" title="LambdaLift.this.global.Tree">block</a><span class="delimiter">)</span>, <a href="#603211" title="List[LambdaLift.this.global.CaseDef]">catches</a> <span title="(f: LambdaLift.this.global.CaseDef =&gt; LambdaLift.this.global.CaseDef)(implicit bf: scala.collection.generic.CanBuildFrom[List[LambdaLift.this.global.CaseDef],LambdaLift.this.global.CaseDef,List[LambdaLift.this.global.CaseDef]])List[LambdaLift.this.global.CaseDef]">map</span> <a href="#603172" title="(cdef: LambdaLift.this.global.CaseDef)LambdaLift.this.global.CaseDef">refConstrCase</a>, <a href="#603212" title="LambdaLift.this.global.Tree">finalizer</a><span class="delimiter">)</span>
              <span class="keyword">case</span> <span title="LambdaLift.this.global.Tree">_</span> =&gt; 
                <a href="../../../reflect/internal/Trees.scala.html#39377" title="(sym: LambdaLift.this.global.Symbol, args: LambdaLift.this.global.Tree*)LambdaLift.this.global.Tree">New</a><span class="delimiter">(</span><a href="#603142" title="LambdaLift.this.global.Symbol">sym</a>, <a href="#603206" title="LambdaLift.this.global.Tree">expr</a><span class="delimiter">)</span>
            <span class="delimiter">}</span>
            <span class="keyword">def</span> <a title="(cdef: LambdaLift.this.global.CaseDef)LambdaLift.this.global.CaseDef" id="603172">refConstrCase</a><span class="delimiter">(</span><a title="LambdaLift.this.global.CaseDef" id="603234">cdef</a>: <span title="LambdaLift.this.global.CaseDef">CaseDef</span><span class="delimiter">)</span>: <span title="LambdaLift.this.global.CaseDef">CaseDef</span> = 
              <a href="../SubComponent.scala.html#231956" title="(pat: LambdaLift.this.global.Tree, guard: LambdaLift.this.global.Tree, body: LambdaLift.this.global.Tree)LambdaLift.this.global.CaseDef">CaseDef</a><span class="delimiter">(</span><a href="#603234" title="LambdaLift.this.global.CaseDef">cdef</a>.<span title="=&gt; LambdaLift.this.global.Tree">pat</span>, <a href="#603234" title="LambdaLift.this.global.CaseDef">cdef</a>.<span title="=&gt; LambdaLift.this.global.Tree">guard</span>, <a href="#603171" title="(expr: LambdaLift.this.global.Tree)LambdaLift.this.global.Tree">refConstr</a><span class="delimiter">(</span><a href="#603234" title="LambdaLift.this.global.CaseDef">cdef</a>.<span title="=&gt; LambdaLift.this.global.Tree">body</span><span class="delimiter">)</span><span class="delimiter">)</span>
            <a href="#242875" title="=&gt; LambdaLift.this.global.explicitOuter.global.TreeCopier">treeCopy</a>.<span title="(tree: LambdaLift.this.global.explicitOuter.global.Tree, mods: LambdaLift.this.global.explicitOuter.global.Modifiers, name: LambdaLift.this.global.explicitOuter.global.Name, tpt: LambdaLift.this.global.explicitOuter.global.Tree, rhs: LambdaLift.this.global.explicitOuter.global.Tree)LambdaLift.this.global.explicitOuter.global.ValDef">ValDef</span><span class="delimiter">(</span><a href="#603138" title="LambdaLift.this.global.Tree">tree</a>, <a href="#603165" title="LambdaLift.this.global.Modifiers">mods</a>, <a href="#603166" title="LambdaLift.this.global.TermName">name</a>, <a href="#603169" title="LambdaLift.this.global.TypeTree">tpt1</a>, <a href="../Global.scala.html#186285" title="object LambdaLift.this.global.typer">typer</a>.<a href="../typechecker/Typers.scala.html#187860" title="(pos: LambdaLift.this.global.analyzer.global.Position)(tree: LambdaLift.this.global.analyzer.global.Tree)LambdaLift.this.global.analyzer.global.Tree">typedPos</a><span class="delimiter">(</span><a href="#603168" title="LambdaLift.this.global.Tree">rhs</a>.<span title="=&gt; LambdaLift.this.global.Position">pos</span><span class="delimiter">)</span> <span class="delimiter">{</span>
              <a href="#603171" title="(expr: LambdaLift.this.global.Tree)LambdaLift.this.global.Tree">refConstr</a><span class="delimiter">(</span><a href="#603170" title="LambdaLift.this.global.gen.global.Tree">constructorArg</a><span class="delimiter">)</span>
            <span class="delimiter">}</span><span class="delimiter">)</span>
          <span class="delimiter">}</span> <span class="keyword">else</span> <a href="#603138" title="LambdaLift.this.global.Tree">tree</a>
        <span class="keyword">case</span> <span title="LambdaLift.this.global.Block">Return</span><span class="delimiter">(</span>Block<span class="delimiter">(</span><a title="List[LambdaLift.this.global.Tree]" id="603320">stats</a>, <a title="LambdaLift.this.global.Tree" id="603321">value</a><span class="delimiter">)</span><span class="delimiter">)</span> =&gt;
          <a href="../SubComponent.scala.html#231956" title="(stats: List[LambdaLift.this.global.Tree], expr: LambdaLift.this.global.Tree)LambdaLift.this.global.Block">Block</a><span class="delimiter">(</span><a href="#603320" title="List[LambdaLift.this.global.Tree]">stats</a>, <a href="#242875" title="=&gt; LambdaLift.this.global.explicitOuter.global.TreeCopier">treeCopy</a>.<span title="(tree: LambdaLift.this.global.explicitOuter.global.Tree, expr: LambdaLift.this.global.explicitOuter.global.Tree)LambdaLift.this.global.explicitOuter.global.Return">Return</span><span class="delimiter">(</span><a href="#603138" title="LambdaLift.this.global.Tree">tree</a>, <a href="#603321" title="LambdaLift.this.global.Tree">value</a><span class="delimiter">)</span><span class="delimiter">)</span> <span title="(tp: LambdaLift.this.global.Type)LambdaLift.this.global.Block">setType</span> <a href="#603138" title="LambdaLift.this.global.Tree">tree</a>.<span title="=&gt; LambdaLift.this.global.Type">tpe</span> <span title="(pos: scala.tools.nsc.util.Position)LambdaLift.this.global.Block">setPos</span> <a href="#603138" title="LambdaLift.this.global.Tree">tree</a>.<span title="=&gt; LambdaLift.this.global.Position">pos</span>
        <span class="keyword">case</span> <span title="LambdaLift.this.global.Tree">Return</span><span class="delimiter">(</span><a title="LambdaLift.this.global.Tree" id="603352">expr</a><span class="delimiter">)</span> =&gt;
          <a href="../Global.scala.html#186183" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a><span class="delimiter">(</span><a href="#603142" title="LambdaLift.this.global.Symbol">sym</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#242875" title="=&gt; LambdaLift.this.global.explicitOuter.global.Symbol">currentMethod</a>, <a href="#603142" title="LambdaLift.this.global.Symbol">sym</a><span class="delimiter">)</span>
          <a href="#603138" title="LambdaLift.this.global.Tree">tree</a>
        <span class="keyword">case</span> <span title="LambdaLift.this.global.explicitOuter.global.Apply">Apply</span><span class="delimiter">(</span><a title="LambdaLift.this.global.Tree" id="603366">fn</a>, <a title="List[LambdaLift.this.global.Tree]" id="603367">args</a><span class="delimiter">)</span> =&gt;
          <a href="#242875" title="=&gt; LambdaLift.this.global.explicitOuter.global.TreeCopier">treeCopy</a>.<span title="(tree: LambdaLift.this.global.explicitOuter.global.Tree, fun: LambdaLift.this.global.explicitOuter.global.Tree, args: List[LambdaLift.this.global.explicitOuter.global.Tree])LambdaLift.this.global.explicitOuter.global.Apply">Apply</span><span class="delimiter">(</span><a href="#603138" title="LambdaLift.this.global.Tree">tree</a>, <a href="#603366" title="LambdaLift.this.global.Tree">fn</a>, <a href="#601994" title="(pos: LambdaLift.this.global.Position, sym: LambdaLift.this.global.Symbol, args: List[LambdaLift.this.global.Tree])List[LambdaLift.this.global.Tree]">addFreeArgs</a><span class="delimiter">(</span><a href="#603138" title="LambdaLift.this.global.Tree">tree</a>.<span title="=&gt; LambdaLift.this.global.Position">pos</span>, <a href="#603142" title="LambdaLift.this.global.Symbol">sym</a>, <a href="#603367" title="List[LambdaLift.this.global.Tree]">args</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="keyword">case</span> <span title="LambdaLift.this.global.explicitOuter.global.Assign">Assign</span><span class="delimiter">(</span>Apply<span class="delimiter">(</span>TypeApply<span class="delimiter">(</span><a title="LambdaLift.this.global.Select" id="603379">sel</a> @ Select<span class="delimiter">(</span><a title="LambdaLift.this.global.Tree" id="603384">qual</a>, _<span class="delimiter">)</span>, _<span class="delimiter">)</span>, <a href="#603386" title="(x: List[LambdaLift.this.global.Tree])Some[List[LambdaLift.this.global.Tree]]">List</a><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>, <a title="LambdaLift.this.global.Tree" id="603397">rhs</a><span class="delimiter">)</span> =&gt;
          // eliminate casts introduced by selecting a captured variable field
          // on the lhs of an assignment.
          <a href="../Global.scala.html#186184" title="(assertion: Boolean)Unit">assert</a><span class="delimiter">(</span><a href="#603379" title="LambdaLift.this.global.Select">sel</a>.<span title="=&gt; LambdaLift.this.global.Symbol">symbol</span> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../../reflect/internal/Definitions.scala.html#45323" title="=&gt; LambdaLift.this.global.Symbol">Object_asInstanceOf</a><span class="delimiter">)</span>
          <a href="#242875" title="=&gt; LambdaLift.this.global.explicitOuter.global.TreeCopier">treeCopy</a>.<span title="(tree: LambdaLift.this.global.explicitOuter.global.Tree, lhs: LambdaLift.this.global.explicitOuter.global.Tree, rhs: LambdaLift.this.global.explicitOuter.global.Tree)LambdaLift.this.global.explicitOuter.global.Assign">Assign</span><span class="delimiter">(</span><a href="#603138" title="LambdaLift.this.global.Tree">tree</a>, <a href="#603384" title="LambdaLift.this.global.Tree">qual</a>, <a href="#603397" title="LambdaLift.this.global.Tree">rhs</a><span class="delimiter">)</span>
        <span class="keyword">case</span> <span title="LambdaLift.this.global.Tree">Ident</span><span class="delimiter">(</span><a title="LambdaLift.this.global.Name" id="603412">name</a><span class="delimiter">)</span> =&gt;
          <span class="keyword">val</span> <a title="LambdaLift.this.global.gen.global.Tree" id="603413">tree1</a> =
            <span title="LambdaLift.this.global.gen.global.Tree" class="keyword">if</span> <span class="delimiter">(</span><a href="#603142" title="LambdaLift.this.global.Symbol">sym</a> <span title="(x$1: AnyRef)Boolean">!=</span> <a href="../../../reflect/internal/Symbols.scala.html#38740" title="=&gt; LambdaLift.this.global.NoSymbol">NoSymbol</a> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#603142" title="LambdaLift.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#46443" title="=&gt; Boolean">isTerm</a> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <span title="=&gt; Boolean">!</span><a href="#603142" title="LambdaLift.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/HasFlags.scala.html#46812" title="=&gt; Boolean">isLabel</a><span class="delimiter">)</span>
              <span title="LambdaLift.this.global.gen.global.Tree" class="keyword">if</span> <span class="delimiter">(</span><a href="#603142" title="LambdaLift.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#46461" title="=&gt; Boolean">isMethod</a><span class="delimiter">)</span>
                <a href="../../../reflect/internal/Trees.scala.html#39387" title="(pos: LambdaLift.this.global.Position)(tree: LambdaLift.this.global.Select)LambdaLift.this.global.Select">atPos</a><span class="delimiter">(</span><a href="#603138" title="LambdaLift.this.global.Tree">tree</a>.<span title="=&gt; LambdaLift.this.global.Position">pos</span><span class="delimiter">)</span><span class="delimiter">(</span><a href="#601992" title="(sym: LambdaLift.this.global.Symbol)LambdaLift.this.global.Select">memberRef</a><span class="delimiter">(</span><a href="#603142" title="LambdaLift.this.global.Symbol">sym</a><span class="delimiter">)</span><span class="delimiter">)</span>
              <span class="keyword">else</span> <span title="LambdaLift.this.global.gen.global.Tree" class="keyword">if</span> <span class="delimiter">(</span><a href="#603142" title="LambdaLift.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#46550" title="=&gt; Boolean">isLocal</a> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <span title="=&gt; Boolean">!</span><a href="#601985" title="(sym: LambdaLift.this.global.Symbol)Boolean">isSameOwnerEnclosure</a><span class="delimiter">(</span><a href="#603142" title="LambdaLift.this.global.Symbol">sym</a><span class="delimiter">)</span><span class="delimiter">)</span>
                <a href="../../../reflect/internal/Trees.scala.html#39387" title="(pos: LambdaLift.this.global.Position)(tree: LambdaLift.this.global.gen.global.Tree)LambdaLift.this.global.gen.global.Tree">atPos</a><span class="delimiter">(</span><a href="#603138" title="LambdaLift.this.global.Tree">tree</a>.<span title="=&gt; LambdaLift.this.global.Position">pos</span><span class="delimiter">)</span><span class="delimiter">(</span><a href="#601993" title="(sym: LambdaLift.this.global.Symbol)LambdaLift.this.global.gen.global.Tree">proxyRef</a><span class="delimiter">(</span><a href="#603142" title="LambdaLift.this.global.Symbol">sym</a><span class="delimiter">)</span><span class="delimiter">)</span>
              <span class="keyword">else</span> <a href="#603138" title="LambdaLift.this.global.Tree">tree</a>
            <span class="keyword">else</span> <a href="#603138" title="LambdaLift.this.global.Tree">tree</a>
          <span title="LambdaLift.this.global.Tree" class="keyword">if</span> <span class="delimiter">(</span><a href="#603142" title="LambdaLift.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#46482" title="=&gt; Boolean">isCapturedVariable</a> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <span title="=&gt; Boolean">!</span><a href="#603141" title="Boolean">isBoxedRef</a><span class="delimiter">)</span>
            <a href="../../../reflect/internal/Trees.scala.html#39387" title="(pos: LambdaLift.this.global.Position)(tree: LambdaLift.this.global.Tree)LambdaLift.this.global.Tree">atPos</a><span class="delimiter">(</span><a href="#603138" title="LambdaLift.this.global.Tree">tree</a>.<span title="=&gt; LambdaLift.this.global.Position">pos</span><span class="delimiter">)</span> <span class="delimiter">{</span>
              <span class="keyword">val</span> <a title="LambdaLift.this.global.Type" id="603434">tp</a> = <a href="#603138" title="LambdaLift.this.global.Tree">tree</a>.<span title="=&gt; LambdaLift.this.global.Type">tpe</span>
              <span class="keyword">val</span> <a title="LambdaLift.this.global.analyzer.global.Tree" id="603435">elemTree</a> = <a href="../Global.scala.html#186285" title="object LambdaLift.this.global.typer">typer</a> <a href="../typechecker/Typers.scala.html#187859" title="(tree: LambdaLift.this.global.analyzer.global.Tree)LambdaLift.this.global.analyzer.global.Tree">typed</a> <a href="../SubComponent.scala.html#231956" title="(qualifier: LambdaLift.this.global.Tree, name: LambdaLift.this.global.Name)LambdaLift.this.global.Select">Select</a><span class="delimiter">(</span><a href="#603413" title="LambdaLift.this.global.gen.global.Tree">tree1</a> <span title="(tp: LambdaLift.this.global.gen.global.Type)tree1.type">setType</span> <a href="#603142" title="LambdaLift.this.global.Symbol">sym</a>.<a href="../../../reflect/internal/Symbols.scala.html#46606" title="=&gt; LambdaLift.this.global.Type">tpe</a>, <a href="../../../reflect/internal/StdNames.scala.html#39313" title="object LambdaLift.this.global.nme">nme</a>.<a href="../../../reflect/internal/StdNames.scala.html#59122" title="=&gt; LambdaLift.this.global.nme.NameType">elem</a><span class="delimiter">)</span>
              <span title="LambdaLift.this.global.Tree" class="keyword">if</span> <span class="delimiter">(</span><a href="#603435" title="LambdaLift.this.global.analyzer.global.Tree">elemTree</a>.<span title="=&gt; LambdaLift.this.global.analyzer.global.Type">tpe</span>.<a href="../../../reflect/internal/Types.scala.html#41504" title="=&gt; LambdaLift.this.global.analyzer.global.Symbol">typeSymbol</a> <span title="(x$1: AnyRef)Boolean">!=</span> <a href="#603434" title="LambdaLift.this.global.Type">tp</a>.<a href="../../../reflect/internal/Types.scala.html#41504" title="=&gt; LambdaLift.this.global.Symbol">typeSymbol</a><span class="delimiter">)</span> <a href="../Global.scala.html#186149" title="object LambdaLift.this.global.gen">gen</a>.<a href="../Global.scala.html#239117" title="(tree: LambdaLift.this.global.Tree, pt: LambdaLift.this.global.Type)LambdaLift.this.global.Tree">mkAttributedCast</a><span class="delimiter">(</span><a href="#603435" title="LambdaLift.this.global.analyzer.global.Tree">elemTree</a>, <a href="#603434" title="LambdaLift.this.global.Type">tp</a><span class="delimiter">)</span> <span class="keyword">else</span> <a href="#603435" title="LambdaLift.this.global.analyzer.global.Tree">elemTree</a>
            <span class="delimiter">}</span>
          <span class="keyword">else</span> <a href="#603413" title="LambdaLift.this.global.gen.global.Tree">tree1</a>
        <span class="keyword">case</span> <span title="LambdaLift.this.global.Tree">Block</span><span class="delimiter">(</span><a title="List[LambdaLift.this.global.Tree]" id="603479">stats</a>, <a title="LambdaLift.this.global.Tree" id="603480">expr0</a><span class="delimiter">)</span> =&gt;
          <span class="keyword">val</span> <a href="#603482" title="(List[LambdaLift.this.global.Tree], List[LambdaLift.this.global.Tree])" class="delimiter">(</a><a href="#603481" title="List[LambdaLift.this.global.Tree]" id="603482">lzyVals</a>, <a href="#603481" title="List[LambdaLift.this.global.Tree]" id="603483">rest</a><span class="delimiter">)</span> = <a href="#603479" title="List[LambdaLift.this.global.Tree]">stats</a> <span title="(p: LambdaLift.this.global.Tree =&gt; Boolean)(List[LambdaLift.this.global.Tree], List[LambdaLift.this.global.Tree])">partition</span> <a href="#603487" title="Boolean" class="delimiter">{</a>
            <span class="keyword">case</span> <a title="Boolean" id="603488">stat</a>: <span title="LambdaLift.this.global.ValDef">ValDef</span> =&gt; <a href="#603488" title="LambdaLift.this.global.ValDef">stat</a>.<span title="=&gt; LambdaLift.this.global.Symbol">symbol</span>.<a href="../../../reflect/internal/HasFlags.scala.html#46779" title="=&gt; Boolean">isLazy</a> <span title="(x: Boolean)Boolean">||</span> <a href="#603488" title="LambdaLift.this.global.ValDef">stat</a>.<span title="=&gt; LambdaLift.this.global.Symbol">symbol</span>.<a href="../../../reflect/internal/Symbols.scala.html#46544" title="=&gt; Boolean">isModuleVar</a>
            <span class="keyword">case</span> <span title="Boolean(false)">_</span>            =&gt; <span title="Boolean(false)" class="keyword">false</span>
          <span class="delimiter">}</span>
          <span title="LambdaLift.this.global.Tree" class="keyword">if</span> <span class="delimiter">(</span><a href="#603482" title="List[LambdaLift.this.global.Tree]">lzyVals</a>.<span title="=&gt; Boolean">isEmpty</span><span class="delimiter">)</span> <a href="#603138" title="LambdaLift.this.global.Tree">tree</a>
          <span class="keyword">else</span> <a href="#242875" title="=&gt; LambdaLift.this.global.explicitOuter.global.TreeCopier">treeCopy</a>.<span title="(tree: LambdaLift.this.global.explicitOuter.global.Tree, stats: List[LambdaLift.this.global.explicitOuter.global.Tree], expr: LambdaLift.this.global.explicitOuter.global.Tree)LambdaLift.this.global.explicitOuter.global.Block">Block</span><span class="delimiter">(</span><a href="#603138" title="LambdaLift.this.global.Tree">tree</a>, <a href="#603482" title="List[LambdaLift.this.global.Tree]">lzyVals</a> <a href="#603502" title="(prefix: List[LambdaLift.this.global.Tree])List[LambdaLift.this.global.Tree]">:::</a> <a href="#603483" title="List[LambdaLift.this.global.Tree]">rest</a>, <a href="#603480" title="LambdaLift.this.global.Tree">expr0</a><span class="delimiter">)</span>
        <span class="keyword">case</span> <span title="LambdaLift.this.global.Tree">_</span> =&gt;
          <a href="#603138" title="LambdaLift.this.global.Tree">tree</a>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
    
    <span class="keyword">private</span> <span class="keyword">def</span> <a title="(tree: LambdaLift.this.global.Tree)LambdaLift.this.global.explicitOuter.global.Tree" id="601998">preTransform</a><span class="delimiter">(</span><a title="LambdaLift.this.global.Tree" id="603510">tree</a>: <span title="LambdaLift.this.global.Tree">Tree</span><span class="delimiter">)</span> = <a href="#242875" title="LambdaLift.this.LambdaLifter" class="keyword">super</a>.<a href="ExplicitOuter.scala.html#599564" title="(tree: LambdaLift.this.global.explicitOuter.global.Tree)LambdaLift.this.global.explicitOuter.global.Tree">transform</a><span class="delimiter">(</span><a href="#603510" title="LambdaLift.this.global.Tree">tree</a><span class="delimiter">)</span> <span title="(tp: LambdaLift.this.global.explicitOuter.global.Type)LambdaLift.this.global.explicitOuter.global.Tree">setType</span> <a href="../../../reflect/internal/Types.scala.html#74770" title="(tp: LambdaLift.this.global.Type)LambdaLift.this.global.Type">lifted</a><span class="delimiter">(</span><a href="#603510" title="LambdaLift.this.global.Tree">tree</a>.<span title="=&gt; LambdaLift.this.global.Type">tpe</span><span class="delimiter">)</span>

    <span class="keyword">override</span> <span class="keyword">def</span> <a title="(tree: LambdaLift.this.global.Tree)LambdaLift.this.global.Tree" id="601999">transform</a><span class="delimiter">(</span><a title="LambdaLift.this.global.Tree" id="603532">tree</a>: <span title="LambdaLift.this.global.Tree">Tree</span><span class="delimiter">)</span>: <span title="LambdaLift.this.global.Tree">Tree</span> = <a href="#603532" title="LambdaLift.this.global.Tree">tree</a> <span title="LambdaLift.this.global.Tree" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <span title="LambdaLift.this.global.Tree">ReferenceToBoxed</span><span class="delimiter">(</span><a title="LambdaLift.this.global.Ident" id="603539">idt</a><span class="delimiter">)</span> =&gt;
        <a href="#601997" title="(tree: LambdaLift.this.global.Tree, isBoxedRef: Boolean)LambdaLift.this.global.Tree">postTransform</a><span class="delimiter">(</span><a href="#601998" title="(tree: LambdaLift.this.global.Tree)LambdaLift.this.global.explicitOuter.global.Tree">preTransform</a><span class="delimiter">(</span><a href="#603539" title="LambdaLift.this.global.Ident">idt</a><span class="delimiter">)</span>, isBoxedRef = <span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="LambdaLift.this.global.Tree">_</span> =&gt;
        <a href="#601997" title="(tree: LambdaLift.this.global.Tree, isBoxedRef: Boolean)LambdaLift.this.global.Tree">postTransform</a><span class="delimiter">(</span><a href="#601998" title="(tree: LambdaLift.this.global.Tree)LambdaLift.this.global.explicitOuter.global.Tree">preTransform</a><span class="delimiter">(</span><a href="#603532" title="LambdaLift.this.global.Tree">tree</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
      
    /** Transform statements and add lifted definitions to them. */
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="(stats: List[LambdaLift.this.global.Tree], exprOwner: LambdaLift.this.global.Symbol)List[LambdaLift.this.global.Tree]" id="602000">transformStats</a><span class="delimiter">(</span><a title="List[LambdaLift.this.global.Tree]" id="603542">stats</a>: <span title="List[LambdaLift.this.global.Tree]">List</span><span class="delimiter">[</span>Tree<span class="delimiter">]</span>, <a title="LambdaLift.this.global.Symbol" id="603543">exprOwner</a>: <a href="../../../reflect/internal/Symbols.scala.html#38726" title="LambdaLift.this.global.Symbol">Symbol</a><span class="delimiter">)</span>: <span title="List[LambdaLift.this.global.Tree]">List</span><span class="delimiter">[</span>Tree<span class="delimiter">]</span> = <span class="delimiter">{</span>
      <span class="keyword">def</span> <a title="(stat: LambdaLift.this.global.Tree)LambdaLift.this.global.Tree" id="603547">addLifted</a><span class="delimiter">(</span><a title="LambdaLift.this.global.Tree" id="603548">stat</a>: <span title="LambdaLift.this.global.Tree">Tree</span><span class="delimiter">)</span>: <span title="LambdaLift.this.global.Tree">Tree</span> = <a href="#603548" title="LambdaLift.this.global.Tree">stat</a> <span title="LambdaLift.this.global.Tree" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <span title="LambdaLift.this.global.explicitOuter.global.ClassDef">ClassDef</span><span class="delimiter">(</span><a title="LambdaLift.this.global.Modifiers" id="603555">mods</a>, <a title="LambdaLift.this.global.TypeName" id="603556">name</a>, <a title="List[LambdaLift.this.global.TypeDef]" id="603557">tparams</a>, <a title="LambdaLift.this.global.Template" id="603558">impl</a> @ Template<span class="delimiter">(</span><a title="List[LambdaLift.this.global.Tree]" id="603564">parents</a>, <a title="LambdaLift.this.global.ValDef" id="603565">self</a>, <a title="List[LambdaLift.this.global.Tree]" id="603566">body</a><span class="delimiter">)</span><span class="delimiter">)</span> =&gt;
          <span class="keyword">val</span> <a title="List[LambdaLift.this.global.Tree]" id="603567">lifted</a> = <a href="#601977" title="=&gt; scala.collection.mutable.LinkedHashMap[LambdaLift.this.global.Symbol,List[LambdaLift.this.global.Tree]]">liftedDefs</a> <span title="(key: LambdaLift.this.global.Symbol)Option[List[LambdaLift.this.global.Tree]]">get</span> <a href="#603548" title="LambdaLift.this.global.Tree">stat</a>.<span title="=&gt; LambdaLift.this.global.Symbol">symbol</span> <span title="List[LambdaLift.this.global.Tree]" class="keyword">match</span> <span class="delimiter">{</span>
            <span class="keyword">case</span> <span title="List[LambdaLift.this.global.Tree]">Some</span><span class="delimiter">(</span><a title="List[LambdaLift.this.global.Tree]" id="603573">xs</a><span class="delimiter">)</span> =&gt; <a href="#603573" title="List[LambdaLift.this.global.Tree]">xs</a> <span title="(f: LambdaLift.this.global.Tree =&gt; LambdaLift.this.global.Tree)(implicit bf: scala.collection.generic.CanBuildFrom[List[LambdaLift.this.global.Tree],LambdaLift.this.global.Tree,List[LambdaLift.this.global.Tree]])List[LambdaLift.this.global.Tree]">reverseMap</span> <a href="#603547" title="(stat: LambdaLift.this.global.Tree)LambdaLift.this.global.Tree">addLifted</a>
            <span class="keyword">case</span> <span title="scala.collection.immutable.Nil.type">_</span>        =&gt; <a href="../Global.scala.html#186199" title="(msg: =&gt; AnyRef)Unit">log</a><span class="delimiter">(</span><span title="String(&quot;unexpectedly no lifted defs for &quot;)" class="string">&quot;unexpectedly no lifted defs for &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#603548" title="LambdaLift.this.global.Tree">stat</a>.<span title="=&gt; LambdaLift.this.global.Symbol">symbol</span><span class="delimiter">)</span> ; <span title="object Nil">Nil</span>
          <span class="delimiter">}</span>
          <span class="keyword">val</span> <a title="LambdaLift.this.global.explicitOuter.global.ClassDef" id="603568">result</a> = <a href="#242875" title="=&gt; LambdaLift.this.global.explicitOuter.global.TreeCopier">treeCopy</a>.<span title="(tree: LambdaLift.this.global.explicitOuter.global.Tree, mods: LambdaLift.this.global.explicitOuter.global.Modifiers, name: LambdaLift.this.global.explicitOuter.global.Name, tparams: List[LambdaLift.this.global.explicitOuter.global.TypeDef], impl: LambdaLift.this.global.explicitOuter.global.Template)LambdaLift.this.global.explicitOuter.global.ClassDef">ClassDef</span><span class="delimiter">(</span>
            <a href="#603548" title="LambdaLift.this.global.Tree">stat</a>, <a href="#603555" title="LambdaLift.this.global.Modifiers">mods</a>, <a href="#603556" title="LambdaLift.this.global.TypeName">name</a>, <a href="#603557" title="List[LambdaLift.this.global.TypeDef]">tparams</a>, <a href="#242875" title="=&gt; LambdaLift.this.global.explicitOuter.global.TreeCopier">treeCopy</a>.<span title="(tree: LambdaLift.this.global.explicitOuter.global.Tree, parents: List[LambdaLift.this.global.explicitOuter.global.Tree], self: LambdaLift.this.global.explicitOuter.global.ValDef, body: List[LambdaLift.this.global.explicitOuter.global.Tree])LambdaLift.this.global.explicitOuter.global.Template">Template</span><span class="delimiter">(</span><a href="#603558" title="LambdaLift.this.global.Template">impl</a>, <a href="#603564" title="List[LambdaLift.this.global.Tree]">parents</a>, <a href="#603565" title="LambdaLift.this.global.ValDef">self</a>, <a href="#603566" title="List[LambdaLift.this.global.Tree]">body</a> <a href="#603614" title="(prefix: List[LambdaLift.this.global.Tree])List[LambdaLift.this.global.Tree]">:::</a> <a href="#603567" title="List[LambdaLift.this.global.Tree]">lifted</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <a href="#601977" title="=&gt; scala.collection.mutable.LinkedHashMap[LambdaLift.this.global.Symbol,List[LambdaLift.this.global.Tree]]">liftedDefs</a> <span title="(key: LambdaLift.this.global.Symbol)LambdaLifter.this.liftedDefs.type">-=</span> <a href="#603548" title="LambdaLift.this.global.Tree">stat</a>.<span title="=&gt; LambdaLift.this.global.Symbol">symbol</span>
          <a href="#603568" title="LambdaLift.this.global.explicitOuter.global.ClassDef">result</a>
        <span class="keyword">case</span> <span title="LambdaLift.this.global.explicitOuter.global.DefDef">DefDef</span><span class="delimiter">(</span><a title="LambdaLift.this.global.Modifiers" id="603638">mods</a>, <a title="LambdaLift.this.global.Name" id="603639">name</a>, <a title="List[LambdaLift.this.global.TypeDef]" id="603640">tp</a>, <a title="List[List[LambdaLift.this.global.ValDef]]" id="603641">vp</a>, <a title="LambdaLift.this.global.Tree" id="603642">tpt</a>, Block<span class="delimiter">(</span><span title="object Nil">Nil</span>, <a title="LambdaLift.this.global.Tree" id="603647">expr</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="keyword">if</span> <span title="=&gt; Boolean">!</span><a href="#603548" title="LambdaLift.this.global.Tree">stat</a>.<span title="=&gt; LambdaLift.this.global.Symbol">symbol</span>.<a href="../../../reflect/internal/Symbols.scala.html#46492" title="=&gt; Boolean">isConstructor</a> =&gt;
          <a href="#242875" title="=&gt; LambdaLift.this.global.explicitOuter.global.TreeCopier">treeCopy</a>.<span title="(tree: LambdaLift.this.global.explicitOuter.global.Tree, mods: LambdaLift.this.global.explicitOuter.global.Modifiers, name: LambdaLift.this.global.explicitOuter.global.Name, tparams: List[LambdaLift.this.global.explicitOuter.global.TypeDef], vparamss: List[List[LambdaLift.this.global.explicitOuter.global.ValDef]], tpt: LambdaLift.this.global.explicitOuter.global.Tree, rhs: LambdaLift.this.global.explicitOuter.global.Tree)LambdaLift.this.global.explicitOuter.global.DefDef">DefDef</span><span class="delimiter">(</span><a href="#603548" title="LambdaLift.this.global.Tree">stat</a>, <a href="#603638" title="LambdaLift.this.global.Modifiers">mods</a>, <a href="#603639" title="LambdaLift.this.global.Name">name</a>, <a href="#603640" title="List[LambdaLift.this.global.TypeDef]">tp</a>, <a href="#603641" title="List[List[LambdaLift.this.global.ValDef]]">vp</a>, <a href="#603642" title="LambdaLift.this.global.Tree">tpt</a>, <a href="#603647" title="LambdaLift.this.global.Tree">expr</a><span class="delimiter">)</span>
        <span class="keyword">case</span> <span title="LambdaLift.this.global.Tree">_</span> =&gt;
          <a href="#603548" title="LambdaLift.this.global.Tree">stat</a>
      <span class="delimiter">}</span>
      <a href="#242875" title="LambdaLift.this.LambdaLifter" class="keyword">super</a>.<span title="(stats: List[LambdaLift.this.global.explicitOuter.global.Tree], exprOwner: LambdaLift.this.global.explicitOuter.global.Symbol)List[LambdaLift.this.global.explicitOuter.global.Tree]">transformStats</span><span class="delimiter">(</span><a href="#603542" title="List[LambdaLift.this.global.Tree]">stats</a>, <a href="#603543" title="LambdaLift.this.global.Symbol">exprOwner</a><span class="delimiter">)</span> <span title="(f: LambdaLift.this.global.explicitOuter.global.Tree =&gt; LambdaLift.this.global.Tree)(implicit bf: scala.collection.generic.CanBuildFrom[List[LambdaLift.this.global.explicitOuter.global.Tree],LambdaLift.this.global.Tree,List[LambdaLift.this.global.Tree]])List[LambdaLift.this.global.Tree]">map</span> <a href="#603547" title="(stat: LambdaLift.this.global.Tree)LambdaLift.this.global.Tree">addLifted</a>
    <span class="delimiter">}</span>

    <span class="keyword">override</span> <span class="keyword">def</span> <a title="(unit: LambdaLift.this.global.CompilationUnit)Unit" id="602001">transformUnit</a><span class="delimiter">(</span><a title="LambdaLift.this.global.CompilationUnit" id="603702">unit</a>: <a href="../CompilationUnits.scala.html#186387" title="LambdaLift.this.global.CompilationUnit">CompilationUnit</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#601990" title="()Unit">computeFreeVars</a>
      <a href="../../../reflect/internal/SymbolTable.scala.html#35637" title="(ph: scala.reflect.internal.Phase)(op: =&gt; Unit)Unit">atPhase</a><span class="delimiter">(</span><a href="../../../reflect/internal/SymbolTable.scala.html#35628" title="=&gt; scala.reflect.internal.Phase">phase</a>.<a href="../../../reflect/internal/Phase.scala.html#69307" title="=&gt; scala.reflect.internal.Phase">next</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#242875" title="LambdaLift.this.LambdaLifter" class="keyword">super</a>.<a href="../ast/Trees.scala.html#268474" title="(unit: LambdaLift.this.global.explicitOuter.global.CompilationUnit)Unit">transformUnit</a><span class="delimiter">(</span><a href="#603702" title="LambdaLift.this.global.CompilationUnit">unit</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="../Global.scala.html#186183" title="(assertion: Boolean, message: =&gt; Any)Unit">assert</a><span class="delimiter">(</span><a href="#601977" title="=&gt; scala.collection.mutable.LinkedHashMap[LambdaLift.this.global.Symbol,List[LambdaLift.this.global.Tree]]">liftedDefs</a>.<span title="=&gt; Boolean">isEmpty</span>, <a href="#601977" title="=&gt; scala.collection.mutable.LinkedHashMap[LambdaLift.this.global.Symbol,List[LambdaLift.this.global.Tree]]">liftedDefs</a>.<span title="=&gt; Iterable[LambdaLift.this.global.Symbol]">keys</span> <span title="(sep: String)String">mkString</span> <span title="String(&quot;, &quot;)" class="string">&quot;, &quot;</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span> // class LambdaLifter

<span class="delimiter">}</span>

        </pre>
    </body>
</html>