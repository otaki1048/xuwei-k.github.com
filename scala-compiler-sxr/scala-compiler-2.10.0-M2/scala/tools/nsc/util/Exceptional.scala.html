<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>scala/tools/nsc/util/Exceptional.scala</title>
        <script type="text/javascript" src="../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> scala.tools.nsc
<span class="keyword">package</span> util

<span class="keyword">import</span> java.util.concurrent.ExecutionException
<span class="keyword">import</span> java.lang.reflect.<span class="delimiter">{</span> InvocationTargetException, UndeclaredThrowableException <span class="delimiter">}</span>
<span class="keyword">import</span> io.<span class="delimiter">{</span> Sources, Fileish <span class="delimiter">}</span>
<span class="keyword">import</span> scala.tools.util.<a href="../../util/StringOps.scala.html#34677" title="object scala.tools.util.StringOps">StringOps</a>._

/** A simple throwable wrapper so it looks more like a parade of
 *  glittering frame-shaped beauties than the other thing.
 */
<span class="keyword">class</span> <a title="class Exceptional extends Object with ScalaObject" id="33796">Exceptional</a><a href="#33796" title="ScalaObject" class="delimiter">(</a><span class="keyword">val</span> <a title="Throwable" id="240292">ex</a>: <span title="Throwable">Throwable</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scala.tools.nsc.util.ScalaPrefs" id="240293">prefs</a>: <a href="ScalaPrefs.scala.html#33829" title="scala.tools.nsc.util.ScalaPrefs">ScalaPrefs</a><span class="delimiter">)</span> <span class="delimiter">{</span>
  <span class="keyword">val</span> <a title="scala.tools.nsc.util.Exceptional.Calibrated" id="240263">formatter</a>  = <a href="#240293" title="scala.tools.nsc.util.ScalaPrefs">prefs</a>.<a href="#707113" title="(ex: Throwable)scala.tools.nsc.util.Exceptional.Calibrated">exceptionFormatter</a><span class="delimiter">(</span><a href="#240292" title="=&gt; Throwable">ex</a><span class="delimiter">)</span>
  <span class="keyword">val</span> <a title="Throwable" id="240265">unwrapped</a>  = <a href="#33797" title="object scala.tools.nsc.util.Exceptional">Exceptional</a>.<a href="#240252" title="(x: Throwable)Throwable">unwrap</a><span class="delimiter">(</span><a href="#240292" title="=&gt; Throwable">ex</a><span class="delimiter">)</span>
  <span class="keyword">val</span> <a title="scala.tools.nsc.util.TableDef[scala.tools.nsc.util.JavaStackFrame]#Table" id="240267">table</a>      = <a href="#240263" title="=&gt; scala.tools.nsc.util.Exceptional.Calibrated">formatter</a>.<a href="#707125" title="(ex: Throwable)scala.tools.nsc.util.TableDef[scala.tools.nsc.util.JavaStackFrame]#Table">newTable</a><span class="delimiter">(</span><a href="#240265" title="=&gt; Throwable">unwrapped</a><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="()Unit" id="240269">rawTrace</a><span class="delimiter">(</span><span class="delimiter">)</span> = <a href="#240265" title="=&gt; Throwable">unwrapped</a>.<span title="()Unit">printStackTrace</span><span class="delimiter">(</span><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="=&gt; Boolean" id="240270">isScanDone</a> = <a href="#240293" title="scala.tools.nsc.util.ScalaPrefs">prefs</a>.<a href="ScalaPrefs.scala.html#240294" title="=&gt; scala.tools.nsc.io.Sources">codeSources</a>.<a href="../io/Sources.scala.html#474566" title="()Boolean">isDone</a><span class="delimiter">(</span><span class="delimiter">)</span>

  /** Block until the scanning is complete. */
  <span class="keyword">def</span> <a title="()Exceptional.this.type" id="240271">force</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span class="keyword">this</span>.<span class="keyword">type</span> = <span class="delimiter">{</span>
    <a href="#240293" title="scala.tools.nsc.util.ScalaPrefs">prefs</a>.<a href="ScalaPrefs.scala.html#240294" title="=&gt; scala.tools.nsc.io.Sources">codeSources</a>.<a href="../io/Sources.scala.html#474568" title="()Unit">force</a><span class="delimiter">(</span><span class="delimiter">)</span>
    <a href="#33796" title="Exceptional.this.type" class="keyword">this</a>
  <span class="delimiter">}</span>

  /** Stack frame contexts are only shown as long as this is true. */
  <span class="keyword">def</span> <a title="(frame: scala.tools.nsc.util.JavaStackFrame)Boolean" id="240272">spanFn</a><span class="delimiter">(</span><a title="scala.tools.nsc.util.JavaStackFrame" id="481751">frame</a>: <a href="JavaStackFrame.scala.html#33418" title="scala.tools.nsc.util.JavaStackFrame">JavaStackFrame</a><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> = <span title="Boolean(true)" class="keyword">true</span>

  /** The result of this will be printed before a context trace. */
  <span class="keyword">def</span> <a title="=&gt; String" id="240273">contextPrelude</a>: <span title="String">String</span> =
    <span title="String" class="keyword">if</span> <span class="delimiter">(</span><a href="#240270" title="=&gt; Boolean">isScanDone</a> <span title="(x: Boolean)Boolean">||</span> <a href="#240293" title="scala.tools.nsc.util.ScalaPrefs">prefs</a>.<a href="ScalaPrefs.scala.html#240294" title="=&gt; scala.tools.nsc.io.Sources">codeSources</a>.<a href="../io/Sources.scala.html#474554" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span>
    <span class="keyword">else</span> <span title="String(&quot;/* Still scanning source path: there may be more momentarily. */\n&quot;)" class="string">&quot;/* Still scanning source path: there may be more momentarily. */\n&quot;</span>

  /** Frames with surrounding context. */
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="=&gt; List[scala.tools.nsc.util.JavaStackFrame]" id="240274">contextFrames</a>     = <a href="#240280" title="=&gt; List[scala.tools.nsc.util.JavaStackFrame]">toList</a> <span title="(p: scala.tools.nsc.util.JavaStackFrame =&gt; Boolean)List[scala.tools.nsc.util.JavaStackFrame]">takeWhile</span> <a href="#240272" title="(frame: scala.tools.nsc.util.JavaStackFrame)Boolean">spanFn</a>
  <span class="keyword">def</span> <a title="()String" id="240275">contextHead</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="String">String</span>     = <a href="#240276" title="()List[String]">contextElems</a>.<span title="=&gt; Option[String]">headOption</span> <span title="(default: =&gt; String)String">getOrElse</span> <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span>
  <span class="keyword">def</span> <a title="()List[String]" id="240276">contextElems</a><span class="delimiter">(</span><span class="delimiter">)</span>            = <a href="#240274" title="=&gt; List[scala.tools.nsc.util.JavaStackFrame]">contextFrames</a> <span title="(f: scala.tools.nsc.util.JavaStackFrame =&gt; String)(implicit bf: scala.collection.generic.CanBuildFrom[List[scala.tools.nsc.util.JavaStackFrame],String,List[String]])List[String]">map</span> <a href="#240263" title="=&gt; scala.tools.nsc.util.Exceptional.Calibrated">formatter</a>.<a href="#707126" title="(frame: scala.tools.nsc.util.JavaStackFrame)String">inContext</a>
  <span class="keyword">def</span> <a title="()String" id="240277">context</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="String">String</span>         = <a href="#240278" title="(num: Int)String">context</a><span class="delimiter">(</span><a href="#240279" title="=&gt; Int">length</a><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="(num: Int)String" id="240278">context</a><span class="delimiter">(</span><a title="Int" id="240309">num</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="String">String</span> = <a href="#240273" title="=&gt; String">contextPrelude</a> <span title="(x$1: Any)String">+</span> <a href="../../util/StringOps.scala.html#87051" title="(xs: Seq[String], sep: String, orElse: String)String">ojoinOr</a><span class="delimiter">(</span><a href="#240274" title="=&gt; List[scala.tools.nsc.util.JavaStackFrame]">contextFrames</a> <span title="(n: Int)List[scala.tools.nsc.util.JavaStackFrame]">take</span> <a href="#240309" title="Int">num</a> <span title="(f: scala.tools.nsc.util.JavaStackFrame =&gt; String)(implicit bf: scala.collection.generic.CanBuildFrom[List[scala.tools.nsc.util.JavaStackFrame],String,Seq[String]])Seq[String]">map</span> <a href="#240263" title="=&gt; scala.tools.nsc.util.Exceptional.Calibrated">formatter</a>.<a href="#707126" title="(frame: scala.tools.nsc.util.JavaStackFrame)String">inContext</a>, <span title="String(&quot;\n&quot;)" class="string">&quot;\n&quot;</span>, <span title="String(&quot;No stack trace.&quot;)" class="string">&quot;No stack trace.&quot;</span><span class="delimiter">)</span>

  /** Exceptional doesn't extend Seq because it turns out to be super
   *  annoying in the repl: tab-completion sees all the Seq methods.
   */
  <span class="keyword">def</span> <a title="=&gt; Int" id="240279">length</a>            = <a href="#240280" title="=&gt; List[scala.tools.nsc.util.JavaStackFrame]">toList</a>.<span title="=&gt; Int">length</span>
  <span class="keyword">def</span> <a title="=&gt; List[scala.tools.nsc.util.JavaStackFrame]" id="240280">toList</a>            = <a href="#240267" title="=&gt; scala.tools.nsc.util.TableDef[scala.tools.nsc.util.JavaStackFrame]#Table">table</a>.<span title="=&gt; List[scala.tools.nsc.util.JavaStackFrame]">toList</span>
  <span class="keyword">def</span> <a title="=&gt; Iterator[scala.tools.nsc.util.JavaStackFrame]" id="240281">iterator</a>          = <a href="#240267" title="=&gt; scala.tools.nsc.util.TableDef[scala.tools.nsc.util.JavaStackFrame]#Table">table</a>.<a href="TableDef.scala.html#143665" title="=&gt; Iterator[scala.tools.nsc.util.JavaStackFrame]">iterator</a>
  <span class="keyword">def</span> <a title="(index: Int)scala.tools.nsc.util.JavaStackFrame" id="240282">apply</a><span class="delimiter">(</span><a title="Int" id="707302">index</a>: <span title="Int">Int</span><span class="delimiter">)</span> = <a href="TableDef.scala.html#143666" title="(index: Int)scala.tools.nsc.util.JavaStackFrame">table</a><span class="delimiter">(</span><a href="#707302" title="Int">index</a><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="=&gt; List[Throwable]" id="240283">causes</a>  = <a href="#33797" title="object scala.tools.nsc.util.Exceptional">Exceptional</a>.<a href="#240251" title="(x: Throwable)List[Throwable]">causes</a><span class="delimiter">(</span><a href="#240292" title="=&gt; Throwable">ex</a><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="=&gt; String" id="240284">summary</a> = <a href="#240265" title="=&gt; Throwable">unwrapped</a>.<span title="()String">toString</span> <span title="(x$1: Any)String">+</span> <span title="String(&quot;\n  at &quot;)" class="string">&quot;\n  at &quot;</span> <span title="(x$1: Any)String">+</span> <a href="#240282" title="(index: Int)scala.tools.nsc.util.JavaStackFrame">apply</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>.<a href="JavaStackFrame.scala.html#481773" title="=&gt; String">shortNameString</a>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(msg: Any)Unit" id="240285">println</a><span class="delimiter">(</span><a title="Any" id="707599">msg</a>: <span title="Any">Any</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span title="object Console">Console</span> <span title="(x: Any)Unit">println</span> <a href="#707599" title="Any">msg</a>
    <span title="object Console">Console</span>.<span title="()Unit">flush</span><span class="delimiter">(</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="()Unit" id="240286">show</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="Unit">Unit</span>         = <a href="#240285" title="(msg: Any)Unit">println</a><span class="delimiter">(</span><a href="#240277" title="()String">context</a><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="(num: Int)Unit" id="240287">show</a><span class="delimiter">(</span><a title="Int" id="520397">num</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <a href="#240285" title="(msg: Any)Unit">println</a><span class="delimiter">(</span><a href="#240278" title="(num: Int)String">context</a><span class="delimiter">(</span><a href="#520397" title="Int">num</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="()Unit" id="240288">showCauses</a><span class="delimiter">(</span><span class="delimiter">)</span>         = <a href="#240285" title="(msg: Any)Unit">println</a><span class="delimiter">(</span><span class="delimiter">(</span><a href="#240292" title="=&gt; Throwable">ex</a> <a href="#707614" title="(x: Throwable)List[Throwable]">::</a> <a href="#240283" title="=&gt; List[Throwable]">causes</a><span class="delimiter">)</span>.<span title="(start: String, sep: String, end: String)String">mkString</span><span class="delimiter">(</span><span title="String(&quot;&quot;)" class="string">&quot;&quot;</span>, <span title="String(&quot;\n  caused by -&gt; &quot;)" class="string">&quot;\n  caused by -&gt; &quot;</span>, <span title="String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="()Unit" id="240289">showTable</a><span class="delimiter">(</span><span class="delimiter">)</span>          = <a href="#240285" title="(msg: Any)Unit">println</a><span class="delimiter">(</span><a href="#240267" title="=&gt; scala.tools.nsc.util.TableDef[scala.tools.nsc.util.JavaStackFrame]#Table">table</a><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="()Unit" id="240290">showSummary</a><span class="delimiter">(</span><span class="delimiter">)</span>        = <a href="#240285" title="(msg: Any)Unit">println</a><span class="delimiter">(</span><a href="#240284" title="=&gt; String">summary</a><span class="delimiter">)</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="()String" id="240291">toString</a> = <a href="#240284" title="=&gt; String">summary</a>
<span class="delimiter">}</span>


<span class="keyword">object</span> <a title="object scala.tools.nsc.util.Exceptional" id="33797">Exceptional</a> <span title="ScalaObject" class="delimiter">{</span>
  <span class="keyword">type</span> <a title="[+T]PartialFunction[Throwable,T]" id="240232">Catcher</a><span class="delimiter">[</span>+<a title="&gt;: Nothing &lt;: Any" id="240233">T</a><span class="delimiter">]</span> = <span title="PartialFunction[Throwable,T]">PartialFunction</span><span class="delimiter">[</span>Throwable, T<span class="delimiter">]</span>

  /** Creates an exception handler which will only ever catch the given
   *  number of exceptions (if the given pf is defined there) and after
   *  that will disable itself.
   */
  <span class="keyword">def</span> <a title="[T](numCatches: Int)(pf: scala.tools.nsc.util.Exceptional.Catcher[T])scala.tools.nsc.util.Exceptional.Catcher[T]" id="240234">expiringHandler</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="240236">T</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="Int" id="635137">numCatches</a>: <span title="Int">Int</span><span class="delimiter">)</span><span class="delimiter">(</span><a title="scala.tools.nsc.util.Exceptional.Catcher[T]" id="635138">pf</a>: <span title="scala.tools.nsc.util.Exceptional.Catcher[T]">Catcher</span><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="scala.tools.nsc.util.Exceptional.Catcher[T]">Catcher</span><span class="delimiter">[</span>T<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">var</span> <a title="Int" id="707631">remaining</a> = <a href="#635137" title="Int">numCatches</a>;
    <a href="#707633" title="T" class="delimiter">{</a> <span class="keyword">case</span> <a title="T" id="707634">ex</a>: <span title="Throwable">Throwable</span> <span class="keyword">if</span> <a href="#707631" title="Int">remaining</a> <span title="(x: Int)Boolean">&gt;</span> <span title="Int(0)" class="int">0</span> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#635138" title="scala.tools.nsc.util.Exceptional.Catcher[T]">pf</a>.<span title="(x: Throwable)Boolean">isDefinedAt</span><span class="delimiter">(</span><a href="#707634" title="Throwable">ex</a><span class="delimiter">)</span> =&gt;
        <a href="#707631" title="Int">remaining</a> <span title="(x: Int)Int">-=</span> <span title="Int(1)" class="int">1</span>
        <a href="#635138" title="(v1: Throwable)T">pf</a><span class="delimiter">(</span><a href="#707634" title="Throwable">ex</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  /** The Throwable =&gt; Exceptional implicit plus the associated factory. */
  <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="implicit scala.tools.nsc.util.Exceptional.throwableToExceptional : (ex: Throwable)(implicit prefs: scala.tools.nsc.util.ScalaPrefs)scala.tools.nsc.util.Exceptional" id="240237">throwableToExceptional</a><span class="delimiter">(</span><a title="Throwable" id="707355">ex</a>: <span title="Throwable">Throwable</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scala.tools.nsc.util.ScalaPrefs" id="707356">prefs</a>: <a href="ScalaPrefs.scala.html#33829" title="scala.tools.nsc.util.ScalaPrefs">ScalaPrefs</a><span class="delimiter">)</span>: <a href="#33796" title="scala.tools.nsc.util.Exceptional">Exceptional</a> = <a href="#240238" title="(ex: Throwable)(implicit prefs: scala.tools.nsc.util.ScalaPrefs)scala.tools.nsc.util.Exceptional">apply</a><span class="delimiter">(</span><a href="#707355" title="Throwable">ex</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#707356" title="scala.tools.nsc.util.ScalaPrefs">prefs</a><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="(ex: Throwable)(implicit prefs: scala.tools.nsc.util.ScalaPrefs)scala.tools.nsc.util.Exceptional" id="240238">apply</a><span class="delimiter">(</span><a title="Throwable" id="240253">ex</a>: <span title="Throwable">Throwable</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scala.tools.nsc.util.ScalaPrefs" id="240254">prefs</a>: <a href="ScalaPrefs.scala.html#33829" title="scala.tools.nsc.util.ScalaPrefs">ScalaPrefs</a><span class="delimiter">)</span> = <span title="scala.tools.nsc.util.Exceptional" class="keyword">new</span> <a href="#33796" title="scala.tools.nsc.util.Exceptional">Exceptional</a><span class="delimiter">(</span><a href="#240253" title="Throwable">ex</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#240254" title="scala.tools.nsc.util.ScalaPrefs">prefs</a><span class="delimiter">)</span>

  /** Some handy functions. */
  <span class="keyword">def</span> <a title="()Array[scala.tools.nsc.util.JavaStackFrame]" id="240239">stack</a><span class="delimiter">(</span><span class="delimiter">)</span>  = <a href="JavaStackFrame.scala.html#33419" title="object scala.tools.nsc.util.JavaStackFrame">JavaStackFrame</a> <a href="JavaStackFrame.scala.html#707188" title="(xs: Array[StackTraceElement])Array[scala.tools.nsc.util.JavaStackFrame]">frames</a> <span class="delimiter">(</span><span class="delimiter">(</span><span title="Throwable" class="keyword">new</span> <span title="Throwable">Throwable</span><span class="delimiter">)</span>.<span title="(xs: Array[StackTraceElement])scala.collection.mutable.ArrayOps[StackTraceElement]">getStackTrace</span> <span title="(p: StackTraceElement =&gt; Boolean)Array[StackTraceElement]">dropWhile</span> <a href="#240250" title="(ste: StackTraceElement)Boolean">isLocal</a><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="()Unit" id="240240">showme</a><span class="delimiter">(</span><span class="delimiter">)</span> = <a href="#240238" title="(ex: Throwable)(implicit prefs: scala.tools.nsc.util.ScalaPrefs)scala.tools.nsc.util.Exceptional">apply</a><a href="ScalaPrefs.scala.html#240297" title="object scala.tools.nsc.util.ScalaPrefs.DefaultScalaPrefs" class="delimiter">(</a><span title="Throwable" class="keyword">new</span> <span title="Throwable">Throwable</span><span class="delimiter">)</span>.<a href="#240286" title="()Unit">show</a><span class="delimiter">(</span><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="()Unit" id="240241">showstack</a><span class="delimiter">(</span><span class="delimiter">)</span> = <a href="#240238" title="(ex: Throwable)(implicit prefs: scala.tools.nsc.util.ScalaPrefs)scala.tools.nsc.util.Exceptional">apply</a><a href="ScalaPrefs.scala.html#240297" title="object scala.tools.nsc.util.ScalaPrefs.DefaultScalaPrefs" class="delimiter">(</a><span title="Throwable" class="keyword">new</span> <span title="Throwable">Throwable</span><span class="delimiter">)</span>.<a href="#240289" title="()Unit">showTable</a><span class="delimiter">(</span><span class="delimiter">)</span>

  /** A frame formatter with more refined aesthetics than the default.
   *  Come, let us be civilized.
   */
  <span class="keyword">object</span> <a title="object scala.tools.nsc.util.Exceptional.ScalaFormat" id="240242">ScalaFormat</a> <span title="ScalaObject" class="keyword">extends</span> <a href="TableDef.scala.html#33643" title="scala.tools.nsc.util.TableDef[scala.tools.nsc.util.JavaStackFrame]">TableDef</a><span class="delimiter">[</span>JavaStackFrame<span class="delimiter">]</span> <span class="delimiter">{</span>
      <a href="TableDef.scala.html#143630" title="(pair: (String, scala.tools.nsc.util.JavaStackFrame =&gt; Any))scala.tools.nsc.util.TableDef[scala.tools.nsc.util.JavaStackFrame]">&gt;&gt;</a> <span class="delimiter">(</span><span title="(x: String)ArrowAssoc[String]" class="string">&quot;file&quot;</span>    <span title="(y: scala.tools.nsc.util.JavaStackFrame =&gt; String)(String, scala.tools.nsc.util.JavaStackFrame =&gt; String)">-&gt;</span> <span class="delimiter">(</span><a href="#707903" title="scala.tools.nsc.util.JavaStackFrame">_</a>.<a href="JavaStackFrame.scala.html#481761" title="=&gt; String">fileName</a><span class="delimiter">)</span><span class="delimiter">)</span>   <a href="TableDef.scala.html#143632" title="(sep: String)scala.tools.nsc.util.TableDef[scala.tools.nsc.util.JavaStackFrame]">&gt;+</a> <span title="String(&quot;:&quot;)" class="string">&quot;:&quot;</span>
      <a href="TableDef.scala.html#143631" title="(pair: (String, scala.tools.nsc.util.JavaStackFrame =&gt; Any))scala.tools.nsc.util.TableDef[scala.tools.nsc.util.JavaStackFrame]">&lt;&lt;</a> <span class="delimiter">(</span><span title="(x: String)ArrowAssoc[String]" class="string">&quot;line&quot;</span>    <span title="(y: scala.tools.nsc.util.JavaStackFrame =&gt; Int)(String, scala.tools.nsc.util.JavaStackFrame =&gt; Int)">-&gt;</span> <span class="delimiter">(</span><a href="#707922" title="scala.tools.nsc.util.JavaStackFrame">_</a>.<a href="JavaStackFrame.scala.html#481762" title="=&gt; Int">line</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="TableDef.scala.html#143630" title="(pair: (String, scala.tools.nsc.util.JavaStackFrame =&gt; Any))scala.tools.nsc.util.TableDef[scala.tools.nsc.util.JavaStackFrame]">&gt;&gt;</a> <span class="delimiter">(</span><span title="(x: String)ArrowAssoc[String]" class="string">&quot;class&quot;</span>   <span title="(y: scala.tools.nsc.util.JavaStackFrame =&gt; String)(String, scala.tools.nsc.util.JavaStackFrame =&gt; String)">-&gt;</span> <span class="delimiter">(</span><a href="#707940" title="scala.tools.nsc.util.JavaStackFrame">_</a>.<a href="JavaStackFrame.scala.html#481768" title="=&gt; String">shortestName</a><span class="delimiter">)</span><span class="delimiter">)</span>  <a href="TableDef.scala.html#143632" title="(sep: String)scala.tools.nsc.util.TableDef[scala.tools.nsc.util.JavaStackFrame]">&gt;+</a> <span title="String(&quot;.&quot;)" class="string">&quot;.&quot;</span>
      <a href="TableDef.scala.html#143631" title="(pair: (String, scala.tools.nsc.util.JavaStackFrame =&gt; Any))scala.tools.nsc.util.TableDef[scala.tools.nsc.util.JavaStackFrame]">&lt;&lt;</a> <span class="delimiter">(</span><span title="(x: String)ArrowAssoc[String]" class="string">&quot;method&quot;</span>  <span title="(y: scala.tools.nsc.util.JavaStackFrame =&gt; String)(String, scala.tools.nsc.util.JavaStackFrame =&gt; String)">-&gt;</span> <span class="delimiter">(</span><a href="#707960" title="scala.tools.nsc.util.JavaStackFrame">_</a>.<a href="JavaStackFrame.scala.html#481760" title="=&gt; String">methodName</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">trait</span> <a title="trait Calibrated extends Object" id="240244">Calibrated</a> <span title="Object" class="delimiter">{</span>
    <span class="keyword">def</span> <a title="(ex: Throwable)scala.tools.nsc.util.TableDef[scala.tools.nsc.util.JavaStackFrame]#Table" id="707125">newTable</a><span class="delimiter">(</span><a title="Throwable" id="707127">ex</a>: <span title="Throwable">Throwable</span><span class="delimiter">)</span>: TableDef<span class="delimiter">[</span>JavaStackFrame<span class="delimiter">]</span>#<a href="TableDef.scala.html#143647" title="scala.tools.nsc.util.TableDef[scala.tools.nsc.util.JavaStackFrame]#Table">Table</a>
    <span class="keyword">def</span> <a title="(frame: scala.tools.nsc.util.JavaStackFrame)String" id="707126">inContext</a><span class="delimiter">(</span><a title="scala.tools.nsc.util.JavaStackFrame" id="707179">frame</a>: <a href="JavaStackFrame.scala.html#33418" title="scala.tools.nsc.util.JavaStackFrame">JavaStackFrame</a><span class="delimiter">)</span>: <span title="String">String</span>
  <span class="delimiter">}</span>
  <span class="keyword">trait</span> <a title="trait Formatter extends Object with Throwable =&gt; scala.tools.nsc.util.Exceptional.Calibrated" id="240245">Formatter</a> <span class="keyword">extends</span> <span class="delimiter">(</span>Throwable =&gt; Calibrated<span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="(ex: Throwable)scala.tools.nsc.util.Exceptional.Calibrated" id="707113">apply</a><span class="delimiter">(</span><a title="Throwable" id="707115">ex</a>: <span title="Throwable">Throwable</span><span class="delimiter">)</span>: <a href="#240244" title="scala.tools.nsc.util.Exceptional.Calibrated">Calibrated</a>
  <span class="delimiter">}</span>
  <span class="keyword">object</span> <a title="object scala.tools.nsc.util.Exceptional.Formatter" id="240246">Formatter</a> <span title="ScalaObject" class="delimiter">{</span>
    <span class="keyword">def</span> <a title="(implicit prefs: scala.tools.nsc.util.ScalaPrefs)scala.tools.nsc.util.Exceptional.Formatter" id="707967">apply</a><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scala.tools.nsc.util.ScalaPrefs" id="707969">prefs</a>: <a href="ScalaPrefs.scala.html#33829" title="scala.tools.nsc.util.ScalaPrefs">ScalaPrefs</a><span class="delimiter">)</span>: <a href="#240245" title="scala.tools.nsc.util.Exceptional.Formatter">Formatter</a> = <a href="#707971" title="Object with scala.tools.nsc.util.Exceptional.Formatter" class="keyword">new</a> <a title="anonymous class $anon extends Object with scala.tools.nsc.util.Exceptional.Formatter" id="707971">Formatter</a> <span class="delimiter">{</span>
      <span class="keyword">def</span> <a title="(ex: Throwable)Object with scala.tools.nsc.util.Exceptional.Calibrated{def newTable(ex: Throwable): scala.tools.nsc.util.Exceptional.ScalaFormat.Table}" id="707973">apply</a><span class="delimiter">(</span><a title="Throwable" id="707977">ex</a>: <span title="Throwable">Throwable</span><span class="delimiter">)</span> = <a href="#707982" title="Object with scala.tools.nsc.util.Exceptional.Calibrated" class="keyword">new</a> <a title="anonymous class $anon extends Object with scala.tools.nsc.util.Exceptional.Calibrated" id="707982">Calibrated</a> <span class="delimiter">{</span>
        <span class="keyword">def</span> <a title="(ex: Throwable)scala.tools.nsc.util.Exceptional.ScalaFormat.Table" id="707984">newTable</a><span class="delimiter">(</span><a title="Throwable" id="707988">ex</a>: <span title="Throwable">Throwable</span><span class="delimiter">)</span>          = <span title="scala.tools.nsc.util.Exceptional.ScalaFormat.Table" class="keyword">new</span> <a href="#240242" title="object scala.tools.nsc.util.Exceptional.ScalaFormat">ScalaFormat</a>.<a href="TableDef.scala.html#143647" title="scala.tools.nsc.util.Exceptional.ScalaFormat.Table">Table</a><span class="delimiter">(</span><a href="JavaStackFrame.scala.html#33419" title="object scala.tools.nsc.util.JavaStackFrame">JavaStackFrame</a> <a href="JavaStackFrame.scala.html#707189" title="(xs: Array[scala.tools.nsc.util.JavaStackFrame])scala.collection.mutable.WrappedArray[scala.tools.nsc.util.JavaStackFrame]">frames</a> <a href="#707988" title="Throwable">ex</a><span class="delimiter">)</span>
        <span class="keyword">def</span> <a title="(frame: scala.tools.nsc.util.JavaStackFrame)String" id="707985">inContext</a><span class="delimiter">(</span><a title="scala.tools.nsc.util.JavaStackFrame" id="708026">frame</a>: <a href="JavaStackFrame.scala.html#33418" title="scala.tools.nsc.util.JavaStackFrame">JavaStackFrame</a><span class="delimiter">)</span> = <span title="scala.tools.nsc.util.FrameContext" class="keyword">new</span> <a href="JavaStackFrame.scala.html#33283" title="scala.tools.nsc.util.FrameContext">FrameContext</a><span class="delimiter">(</span><a href="#708026" title="scala.tools.nsc.util.JavaStackFrame">frame</a>, <a href="#707969" title="scala.tools.nsc.util.ScalaPrefs">prefs</a>.<a href="ScalaPrefs.scala.html#240294" title="=&gt; scala.tools.nsc.io.Sources">codeSources</a><span class="delimiter">)</span> <a href="JavaStackFrame.scala.html#708044" title="()String">toString</a>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  /** Java stack traces have the interesting property of using only the name
   *  of the file, no paths.  This makes it a bit of a gamble to try to associate
   *  a stack frame with a specific file.  Witness the heuristic.
   */
  <span class="keyword">def</span> <a title="(sources: scala.tools.nsc.io.Sources, frame: scala.tools.nsc.util.JavaStackFrame)List[scala.tools.nsc.io.Fileish]" id="240248">locateSources</a><span class="delimiter">(</span><a title="scala.tools.nsc.io.Sources" id="708251">sources</a>: <a href="../io/Sources.scala.html#24428" title="scala.tools.nsc.io.Sources">Sources</a>, <a title="scala.tools.nsc.util.JavaStackFrame" id="708252">frame</a>: <a href="JavaStackFrame.scala.html#33418" title="scala.tools.nsc.util.JavaStackFrame">JavaStackFrame</a><span class="delimiter">)</span>: <span title="List[scala.tools.nsc.io.Fileish]">List</span><span class="delimiter">[</span>Fileish<span class="delimiter">]</span> = <span class="delimiter">{</span>
    // if only one has a matching path, that's fairly sure to be the one
    <span class="keyword">val</span> <a title="List[scala.tools.nsc.io.Fileish]" id="708254">matches</a> = <a href="../io/Sources.scala.html#474552" title="(name: String)List[scala.tools.nsc.io.Fileish]">sources</a><span class="delimiter">(</span><a href="#708252" title="scala.tools.nsc.util.JavaStackFrame">frame</a>.<a href="JavaStackFrame.scala.html#481761" title="=&gt; String">fileName</a><span class="delimiter">)</span> <span title="(p: scala.tools.nsc.io.Fileish =&gt; Boolean)List[scala.tools.nsc.io.Fileish]">filter</span> <span class="delimiter">(</span><a href="#708264" title="scala.tools.nsc.io.Fileish">_</a>.<a href="../io/Fileish.scala.html#522761" title="=&gt; String">pkgFromPath</a> <span title="(x$1: String)Boolean">endsWith</span> <a href="#708252" title="scala.tools.nsc.util.JavaStackFrame">frame</a>.<a href="JavaStackFrame.scala.html#481764" title="=&gt; String">pkgName</a><span class="delimiter">)</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#708254" title="List[scala.tools.nsc.io.Fileish]">matches</a>.<span title="=&gt; Boolean">isEmpty</span> <span title="(x: Boolean)Boolean">||</span> <a href="#708254" title="List[scala.tools.nsc.io.Fileish]">matches</a>.<span title="=&gt; List[scala.tools.nsc.io.Fileish]">tail</span>.<span title="=&gt; Boolean">isEmpty</span><span class="delimiter">)</span>
      <span title="Nothing" class="keyword">return</span> <a href="#708254" title="List[scala.tools.nsc.io.Fileish]">matches</a>

    // otherwise we'll drink them in and look for a package name
    <a href="#708254" title="List[scala.tools.nsc.io.Fileish]">matches</a> <span title="(p: scala.tools.nsc.io.Fileish =&gt; Boolean)List[scala.tools.nsc.io.Fileish]">filter</span> <span class="delimiter">(</span><a href="#708272" title="scala.tools.nsc.io.Fileish">_</a>.<a href="../io/Fileish.scala.html#522763" title="=&gt; String">pkgFromSource</a> <span title="(x$1: String)Boolean">endsWith</span> <a href="#708252" title="scala.tools.nsc.util.JavaStackFrame">frame</a>.<a href="JavaStackFrame.scala.html#481764" title="=&gt; String">pkgName</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  /** Right now this punts if more than one match and it accepts the first at random.
   */
  <span class="keyword">def</span> <a title="(sources: scala.tools.nsc.io.Sources, frame: scala.tools.nsc.util.JavaStackFrame)Option[scala.tools.nsc.io.Fileish]" id="240249">locateSource</a><span class="delimiter">(</span><a title="scala.tools.nsc.io.Sources" id="708051">sources</a>: <a href="../io/Sources.scala.html#24428" title="scala.tools.nsc.io.Sources">Sources</a>, <a title="scala.tools.nsc.util.JavaStackFrame" id="708052">frame</a>: <a href="JavaStackFrame.scala.html#33418" title="scala.tools.nsc.util.JavaStackFrame">JavaStackFrame</a><span class="delimiter">)</span>: <span title="Option[scala.tools.nsc.io.Fileish]">Option</span><span class="delimiter">[</span>Fileish<span class="delimiter">]</span> =
    <a href="#240248" title="(sources: scala.tools.nsc.io.Sources, frame: scala.tools.nsc.util.JavaStackFrame)List[scala.tools.nsc.io.Fileish]">locateSources</a><span class="delimiter">(</span><a href="#708051" title="scala.tools.nsc.io.Sources">sources</a>, <a href="#708052" title="scala.tools.nsc.util.JavaStackFrame">frame</a><span class="delimiter">)</span>.<span title="=&gt; Option[scala.tools.nsc.io.Fileish]">headOption</span>

  <span class="keyword">def</span> <a title="(ste: StackTraceElement)Boolean" id="240250">isLocal</a><span class="delimiter">(</span><a title="StackTraceElement" id="707864">ste</a>: <span title="StackTraceElement">StackTraceElement</span><span class="delimiter">)</span> = <a href="#707864" title="StackTraceElement">ste</a>.<span title="()String">getClassName</span> <span title="(x$1: String)Boolean">startsWith</span> <span class="keyword">this</span>.<span title="()Class[_]">getClass</span>.<span title="()String">getName</span>
  <span class="keyword">def</span> <a title="(x: Throwable)List[Throwable]" id="240251">causes</a><span class="delimiter">(</span><a title="Throwable" id="707343">x</a>: <span title="Throwable">Throwable</span><span class="delimiter">)</span>: <span title="List[Throwable]">List</span><span class="delimiter">[</span>Throwable<span class="delimiter">]</span> = <a href="#707343" title="Throwable">x</a>.<span title="()Throwable">getCause</span> <span title="List[Throwable]" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <span title="scala.collection.immutable.Nil.type" class="keyword">null</span> =&gt; <span title="object Nil">Nil</span>
    <span class="keyword">case</span> <a title="List[Throwable]" id="708273">ex</a>   =&gt; <a href="#707343" title="Throwable">x</a> <a href="#708274" title="(x: Throwable)List[Throwable]">::</a> <a href="#240251" title="(x: Throwable)List[Throwable]">causes</a><span class="delimiter">(</span><a href="#708273" title="Throwable">ex</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>
  <span class="keyword">def</span> <a title="(x: Throwable)Throwable" id="240252">unwrap</a><span class="delimiter">(</span><a title="Throwable" id="256832">x</a>: <span title="Throwable">Throwable</span><span class="delimiter">)</span>: <span title="Throwable">Throwable</span> = <a href="#256832" title="Throwable">x</a> <span title="Throwable" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span>  <span title="Throwable">_</span>: <span title="java.lang.reflect.InvocationTargetException">InvocationTargetException</span> |
          _: <span title="ExceptionInInitializerError">ExceptionInInitializerError</span> |
          _: <span title="java.lang.reflect.UndeclaredThrowableException">UndeclaredThrowableException</span> |
          _: <span title="java.util.concurrent.ExecutionException">ExecutionException</span>
            <span class="keyword">if</span> <a href="#256832" title="Throwable">x</a>.<span title="()Throwable">getCause</span> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span> =&gt;
              <a href="#240252" title="(x: Throwable)Throwable">unwrap</a><span class="delimiter">(</span><a href="#256832" title="Throwable">x</a>.<span title="()Throwable">getCause</span><span class="delimiter">)</span>

    <span class="keyword">case</span> <span title="Throwable">_</span> =&gt; <a href="#256832" title="Throwable">x</a>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>