<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>fj/data/Zipper.java</title>
        <script type="text/javascript" src="../../jquery-all.js"></script>
        <script type="text/javascript" src="../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> fj.data;

<span class="keyword">import</span> fj.Equal;
<span class="keyword">import</span> fj.F;
<span class="keyword">import</span> fj.F2;
<span class="keyword">import</span> fj.F3;
<span class="keyword">import</span> fj.Function;
<span class="keyword">import</span> fj.Ord;
<span class="keyword">import</span> fj.P;
<span class="keyword">import</span> fj.P1;
<span class="keyword">import</span> fj.P2;
<span class="keyword">import</span> fj.P3;
<span class="keyword">import</span> fj.Show;
<span class="keyword">import</span> fj.function.Integers;

<span class="keyword">import</span> java.util.Iterator;

<span class="keyword">import</span> static fj.Function.compose;
<span class="keyword">import</span> static fj.Function.curry;
<span class="keyword">import</span> static fj.Function.flip;
<span class="keyword">import</span> static fj.Function.join;
<span class="keyword">import</span> static fj.Function.uncurryF2;
<span class="keyword">import</span> static fj.data.Option.none;
<span class="keyword">import</span> static fj.data.Option.some;
<span class="keyword">import</span> static fj.data.Stream.nil;
<span class="keyword">import</span> static fj.data.Stream.repeat;

<span class="comment">/**
 * Provides a pointed stream, which is a non-empty zipper-like stream structure that tracks an index (focus)
 * position in a stream. Focus can be moved forward and backwards through the stream, elements can be inserted
 * before or after the focused position, and the focused item can be deleted.
 * &lt;p/&gt;
 * Based on the pointedlist library by Jeff Wheeler.
 */</span>
public <span class="keyword">final</span> <span class="keyword">class</span> <a title="object fj.data.Zipper" id="10485">Zipper</a>&lt;<a title="Nothing" id="10486">A</a>&gt; implements Iterable&lt;<a href="#10485" title="fj.data.Zipper">Zipper</a>&lt;<a href="#10486" title="A">A</a>&gt;&gt; <span class="delimiter">{</span>
  <span class="keyword">private</span> <span class="keyword">final</span> <a href="Stream.java.html#10365" title="fj.data.Stream">Stream</a>&lt;<a href="#10486" title="A">A</a>&gt; <a title="fj.data.Stream[A]" id="19921">left</a>;
  <span class="keyword">private</span> <span class="keyword">final</span> <a href="#10486" title="A">A</a> <a title="A" id="19922">focus</a>;
  <span class="keyword">private</span> <span class="keyword">final</span> <a href="Stream.java.html#10365" title="fj.data.Stream">Stream</a>&lt;<a href="#10486" title="A">A</a>&gt; <a title="fj.data.Stream[A]" id="19923">right</a>;

  <span class="keyword">private</span> Zipper<span class="delimiter">(</span><span class="keyword">final</span> Stream&lt;A&gt; left, <span class="keyword">final</span> A focus, <span class="keyword">final</span> Stream&lt;A&gt; right<span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">this</span>.left = left;
    <span class="keyword">this</span>.focus = focus;
    <span class="keyword">this</span>.right = right;
  <span class="delimiter">}</span>


  <span class="comment">/**
   * Creates a new Zipper with the given streams before and after the focus, and the given focused item.
   *
   * @param left  The stream of elements before the focus.
   * @param focus The element under focus.
   * @param right The stream of elements after the focus.
   * @return a new Zipper with the given streams before and after the focus, and the given focused item.
   */</span>
  public static &lt;<a title="Nothing" id="31526">A</a>&gt; <a href="#10485" title="fj.data.Zipper">Zipper</a>&lt;<a href="#31526" title="A">A</a>&gt; <a title="[A](left: fj.data.Stream[A], focus: A, right: fj.data.Stream[A])fj.data.Zipper[A]" id="31524">zipper</a><span class="delimiter">(</span><span class="keyword">final</span> <a href="Stream.java.html#10365" title="fj.data.Stream">Stream</a>&lt;<a href="#31526" title="A">A</a>&gt; <a title="fj.data.Stream[A]" id="31563">left</a>, <span class="keyword">final</span> <a href="#31526" title="A">A</a> <a title="A" id="31564">focus</a>, <span class="keyword">final</span> <a href="Stream.java.html#10365" title="fj.data.Stream">Stream</a>&lt;<a href="#31526" title="A">A</a>&gt; <a title="fj.data.Stream[A]" id="31565">right</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">return</span> <span class="keyword">new</span> Zipper&lt;A&gt;<span class="delimiter">(</span>left, focus, right<span class="delimiter">)</span>;
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Creates a new Zipper from the given triple.
   *
   * @param p A triple of the elements before the focus, the focus element, and the elements after the focus,
   *          respectively.
   * @return a new Zipper created from the given triple.
   */</span>
  public static &lt;<a title="Nothing" id="31529">A</a>&gt; <a href="#10485" title="fj.data.Zipper">Zipper</a>&lt;<a href="#31529" title="A">A</a>&gt; <a title="[A](p: fj.P3[fj.data.Stream[A],A,fj.data.Stream[A]])fj.data.Zipper[A]" id="31527">zipper</a><span class="delimiter">(</span><span class="keyword">final</span> P3&lt;<a href="Stream.java.html#10365" title="fj.data.Stream">Stream</a>&lt;<a href="#31529" title="A">A</a>&gt;, <a href="#31529" title="A">A</a>, <a href="Stream.java.html#10365" title="fj.data.Stream">Stream</a>&lt;<a href="#31529" title="A">A</a>&gt;&gt; <a title="fj.P3[fj.data.Stream[A],A,fj.data.Stream[A]]" id="31570">p</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">return</span> <span class="keyword">new</span> Zipper&lt;A&gt;<span class="delimiter">(</span>p._1<span class="delimiter">(</span><span class="delimiter">)</span>, p._2<span class="delimiter">(</span><span class="delimiter">)</span>, p._3<span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>;
  <span class="delimiter">}</span>

  <span class="comment">/**
   * First-class constructor of zippers.
   *
   * @return A function that yields a new zipper given streams on the left and right and a focus element.
   */</span>
  public static &lt;<a title="Nothing" id="31532">A</a>&gt; F3&lt;<a href="Stream.java.html#10365" title="fj.data.Stream">Stream</a>&lt;<a href="#31532" title="A">A</a>&gt;, <a href="#31532" title="A">A</a>, <a href="Stream.java.html#10365" title="fj.data.Stream">Stream</a>&lt;<a href="#31532" title="A">A</a>&gt;, <a href="#10485" title="fj.data.Zipper">Zipper</a>&lt;<a href="#31532" title="A">A</a>&gt;&gt; <a title="[A]()fj.F3[fj.data.Stream[A],A,fj.data.Stream[A],fj.data.Zipper[A]]" id="31530">zipper</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">return</span> <span class="keyword">new</span> F3&lt;Stream&lt;A&gt;, A, Stream&lt;A&gt;, Zipper&lt;A&gt;&gt;<span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      public Zipper&lt;A&gt; f<span class="delimiter">(</span><span class="keyword">final</span> Stream&lt;A&gt; l, <span class="keyword">final</span> A a, <span class="keyword">final</span> Stream&lt;A&gt; r<span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="keyword">return</span> zipper<span class="delimiter">(</span>l, a, r<span class="delimiter">)</span>;
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>;
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Returns the product-3 representation of this Zipper.
   *
   * @return the product-3 representation of this Zipper.
   */</span>
  public P3&lt;<a href="Stream.java.html#10365" title="fj.data.Stream">Stream</a>&lt;<a href="#10486" title="A">A</a>&gt;, <a href="#10486" title="A">A</a>, <a href="Stream.java.html#10365" title="fj.data.Stream">Stream</a>&lt;<a href="#10486" title="A">A</a>&gt;&gt; <a title="()fj.P3[fj.data.Stream[A],A,fj.data.Stream[A]]" id="19925">p</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">return</span> P.p<span class="delimiter">(</span>left, focus, right<span class="delimiter">)</span>;
  <span class="delimiter">}</span>

  <span class="comment">/**
   * A first-class function that yields the product-3 representation of a given Zipper.
   *
   * @return A first-class function that yields the product-3 representation of a given Zipper.
   */</span>
  public static &lt;<a title="Nothing" id="31535">A</a>&gt; F&lt;<a href="#10485" title="fj.data.Zipper">Zipper</a>&lt;<a href="#31535" title="A">A</a>&gt;, P3&lt;<a href="Stream.java.html#10365" title="fj.data.Stream">Stream</a>&lt;<a href="#31535" title="A">A</a>&gt;, <a href="#31535" title="A">A</a>, <a href="Stream.java.html#10365" title="fj.data.Stream">Stream</a>&lt;<a href="#31535" title="A">A</a>&gt;&gt;&gt; <a title="[A]()fj.F[fj.data.Zipper[A],fj.P3[fj.data.Stream[A],A,fj.data.Stream[A]]]" id="31533">p_</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">return</span> <span class="keyword">new</span> F&lt;Zipper&lt;A&gt;, P3&lt;Stream&lt;A&gt;, A, Stream&lt;A&gt;&gt;&gt;<span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      public P3&lt;Stream&lt;A&gt;, A, Stream&lt;A&gt;&gt; f<span class="delimiter">(</span><span class="keyword">final</span> Zipper&lt;A&gt; a<span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="keyword">return</span> a.p<span class="delimiter">(</span><span class="delimiter">)</span>;
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>;
  <span class="delimiter">}</span>

  <span class="comment">/**
   * An Ord instance for Zippers.
   *
   * @param o An Ord instance for the element type.
   * @return An Ord instance for Zippers.
   */</span>
  public static &lt;<a title="Nothing" id="31538">A</a>&gt; Ord&lt;<a href="#10485" title="fj.data.Zipper">Zipper</a>&lt;<a href="#31538" title="A">A</a>&gt;&gt; <a title="[A](o: fj.Ord[A])fj.Ord[fj.data.Zipper[A]]" id="31536">ord</a><span class="delimiter">(</span><span class="keyword">final</span> Ord&lt;<a href="#31538" title="A">A</a>&gt; <a title="fj.Ord[A]" id="31575">o</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">final</span> Ord&lt;Stream&lt;A&gt;&gt; so = Ord.streamOrd<span class="delimiter">(</span>o<span class="delimiter">)</span>;
    <span class="keyword">return</span> Ord.p3Ord<span class="delimiter">(</span>so, o, so<span class="delimiter">)</span>.comap<span class="delimiter">(</span>Zipper.&lt;A&gt;p_<span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>;
  <span class="delimiter">}</span>

  <span class="comment">/**
   * An Equal instance for Zippers.
   *
   * @param e An Equal instance for the element type.
   * @return An Equal instance for Zippers.
   */</span>
  public static &lt;<a title="Nothing" id="31541">A</a>&gt; Equal&lt;<a href="#10485" title="fj.data.Zipper">Zipper</a>&lt;<a href="#31541" title="A">A</a>&gt;&gt; <a title="[A](e: fj.Equal[A])fj.Equal[fj.data.Zipper[A]]" id="31539">eq</a><span class="delimiter">(</span><span class="keyword">final</span> Equal&lt;<a href="#31541" title="A">A</a>&gt; <a title="fj.Equal[A]" id="31578">e</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">final</span> Equal&lt;Stream&lt;A&gt;&gt; se = Equal.streamEqual<span class="delimiter">(</span>e<span class="delimiter">)</span>;
    <span class="keyword">return</span> Equal.p3Equal<span class="delimiter">(</span>se, e, se<span class="delimiter">)</span>.comap<span class="delimiter">(</span>Zipper.&lt;A&gt;p_<span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>;
  <span class="delimiter">}</span>

  <span class="comment">/**
   * A Show instance for Zippers.
   *
   * @param s A Show instance for the element type.
   * @return A Show instance for Zippers.
   */</span>
  public static &lt;<a title="Nothing" id="31544">A</a>&gt; Show&lt;<a href="#10485" title="fj.data.Zipper">Zipper</a>&lt;<a href="#31544" title="A">A</a>&gt;&gt; <a title="[A](s: fj.Show[A])fj.Show[fj.data.Zipper[A]]" id="31542">show</a><span class="delimiter">(</span><span class="keyword">final</span> Show&lt;<a href="#31544" title="A">A</a>&gt; <a title="fj.Show[A]" id="31581">s</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">final</span> Show&lt;Stream&lt;A&gt;&gt; ss = Show.streamShow<span class="delimiter">(</span>s<span class="delimiter">)</span>;
    <span class="keyword">return</span> Show.p3Show<span class="delimiter">(</span>ss, s, ss<span class="delimiter">)</span>.comap<span class="delimiter">(</span>Zipper.&lt;A&gt;p_<span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>;
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Maps the given function across the elements of this zipper (covariant functor pattern).
   *
   * @param f A function to map across this zipper.
   * @return A new zipper with the given function applied to all elements.
   */</span>
  public &lt;<a title="Nothing" id="19928">B</a>&gt; <a href="#10485" title="fj.data.Zipper">Zipper</a>&lt;<a href="#19928" title="B">B</a>&gt; <a title="[B](f: fj.F[A,B])fj.data.Zipper[B]" id="19926">map</a><span class="delimiter">(</span><span class="keyword">final</span> F&lt;<a href="#10486" title="A">A</a>, <a href="#19928" title="B">B</a>&gt; <a title="fj.F[A,B]" id="31597">f</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">return</span> zipper<span class="delimiter">(</span>left.map<span class="delimiter">(</span>f<span class="delimiter">)</span>, f.f<span class="delimiter">(</span>focus<span class="delimiter">)</span>, right.map<span class="delimiter">(</span>f<span class="delimiter">)</span><span class="delimiter">)</span>;
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Performs a right-fold reduction across this zipper.
   *
   * @param f The function to apply on each element of this zipper.
   * @param z The beginning value to start the application from.
   * @return the final result after the right-fold reduction.
   */</span>
  public &lt;<a title="Nothing" id="19931">B</a>&gt; <a href="#19931" title="B">B</a> <a title="[B](f: fj.F[A,fj.F[B,B]], z: B)B" id="19929">foldRight</a><span class="delimiter">(</span><span class="keyword">final</span> F&lt;<a href="#10486" title="A">A</a>, F&lt;<a href="#19931" title="B">B</a>, <a href="#19931" title="B">B</a>&gt;&gt; <a title="fj.F[A,fj.F[B,B]]" id="31600">f</a>, <span class="keyword">final</span> <a href="#19931" title="B">B</a> <a title="B" id="31601">z</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">return</span> left.foldLeft<span class="delimiter">(</span>flip<span class="delimiter">(</span>f<span class="delimiter">)</span>,
                         right.cons<span class="delimiter">(</span>focus<span class="delimiter">)</span>.foldRight<span class="delimiter">(</span>compose<span class="delimiter">(</span>
                             Function.&lt;P1&lt;B&gt;, B, B&gt;andThen<span class="delimiter">(</span><span class="delimiter">)</span>.f<span class="delimiter">(</span>P1.&lt;B&gt;__1<span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>, f<span class="delimiter">)</span>, z<span class="delimiter">)</span><span class="delimiter">)</span>;
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Creates a new zipper with a single element.
   *
   * @param a The focus element of the new zipper.
   * @return a new zipper with a single element which is in focus.
   */</span>
  public static &lt;<a title="Nothing" id="31547">A</a>&gt; <a href="#10485" title="fj.data.Zipper">Zipper</a>&lt;<a href="#31547" title="A">A</a>&gt; <a title="[A](a: A)fj.data.Zipper[A]" id="31545">single</a><span class="delimiter">(</span><span class="keyword">final</span> <a href="#31547" title="A">A</a> <a title="A" id="31584">a</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">return</span> zipper<span class="delimiter">(</span>Stream.&lt;A&gt;nil<span class="delimiter">(</span><span class="delimiter">)</span>, a, Stream.&lt;A&gt;nil<span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>;
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Possibly create a zipper if the provided stream has at least one element, otherwise None.
   * The provided stream's head will be the focus of the zipper, and the rest of the stream will follow
   * on the right side.
   *
   * @param a The stream from which to create a zipper.
   * @return a new zipper if the provided stream has at least one element, otherwise None.
   */</span>
  @SuppressWarnings<span class="delimiter">(</span><span class="delimiter">{</span><span class="string">&quot;IfMayBeConditional&quot;</span><span class="delimiter">}</span><span class="delimiter">)</span>
  public static &lt;<a title="Nothing" id="31550">A</a>&gt; <a href="Option.java.html#10291" title="fj.data.Option">Option</a>&lt;<a href="#10485" title="fj.data.Zipper">Zipper</a>&lt;<a href="#31550" title="A">A</a>&gt;&gt; <a title="[A](a: fj.data.Stream[A])fj.data.Option[fj.data.Zipper[A]]" id="31548">fromStream</a><span class="delimiter">(</span><span class="keyword">final</span> <a href="Stream.java.html#10365" title="fj.data.Stream">Stream</a>&lt;<a href="#31550" title="A">A</a>&gt; <a title="fj.data.Stream[A]" id="31587">a</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">if</span> <span class="delimiter">(</span>a.isEmpty<span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">return</span> none<span class="delimiter">(</span><span class="delimiter">)</span>;
    <span class="keyword">else</span>
      <span class="keyword">return</span> some<span class="delimiter">(</span>zipper<span class="delimiter">(</span>Stream.&lt;A&gt;nil<span class="delimiter">(</span><span class="delimiter">)</span>, a.head<span class="delimiter">(</span><span class="delimiter">)</span>, a.tail<span class="delimiter">(</span><span class="delimiter">)</span>._1<span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>;
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Possibly create a zipper if the provided stream has at least one element, otherwise None.
   * The provided stream's last element will be the focus of the zipper, following the rest of the stream in order,
   * to the left.
   *
   * @param a The stream from which to create a zipper.
   * @return a new zipper if the provided stream has at least one element, otherwise None.
   */</span>
  public static &lt;<a title="Nothing" id="31553">A</a>&gt; <a href="Option.java.html#10291" title="fj.data.Option">Option</a>&lt;<a href="#10485" title="fj.data.Zipper">Zipper</a>&lt;<a href="#31553" title="A">A</a>&gt;&gt; <a title="[A](a: fj.data.Stream[A])fj.data.Option[fj.data.Zipper[A]]" id="31551">fromStreamEnd</a><span class="delimiter">(</span><span class="keyword">final</span> <a href="Stream.java.html#10365" title="fj.data.Stream">Stream</a>&lt;<a href="#31553" title="A">A</a>&gt; <a title="fj.data.Stream[A]" id="31590">a</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">if</span> <span class="delimiter">(</span>a.isEmpty<span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">return</span> none<span class="delimiter">(</span><span class="delimiter">)</span>;
    <span class="keyword">else</span> <span class="delimiter">{</span>
      <span class="keyword">final</span> Stream&lt;A&gt; xs = a.reverse<span class="delimiter">(</span><span class="delimiter">)</span>;
      <span class="keyword">return</span> some<span class="delimiter">(</span>zipper<span class="delimiter">(</span>xs.tail<span class="delimiter">(</span><span class="delimiter">)</span>._1<span class="delimiter">(</span><span class="delimiter">)</span>, xs.head<span class="delimiter">(</span><span class="delimiter">)</span>, Stream.&lt;A&gt;nil<span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>;
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Returns the focus element of this zipper.
   *
   * @return the focus element of this zipper.
   */</span>
  public <a href="#10486" title="A">A</a> <a title="()A" id="19932">focus</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">return</span> focus;
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Possibly moves the focus to the next element in the list.
   *
   * @return An optional zipper with the focus moved one element to the right, if there are elements to the right of
   *         focus, otherwise None.
   */</span>
  public <a href="Option.java.html#10291" title="fj.data.Option">Option</a>&lt;<a href="#10485" title="fj.data.Zipper">Zipper</a>&lt;<a href="#10486" title="A">A</a>&gt;&gt; <a title="()fj.data.Option[fj.data.Zipper[A]]" id="19933">next</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">return</span> right.isEmpty<span class="delimiter">(</span><span class="delimiter">)</span> ? Option.&lt;Zipper&lt;A&gt;&gt;none<span class="delimiter">(</span><span class="delimiter">)</span> : some<span class="delimiter">(</span>tryNext<span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>;
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Attempts to move the focus to the next element, or throws an error if there are no more elements.
   *
   * @return A zipper with the focus moved one element to the right, if there are elements to the right of
   *         focus, otherwise throws an error.
   */</span>
  public <a href="#10485" title="fj.data.Zipper">Zipper</a>&lt;<a href="#10486" title="A">A</a>&gt; <a title="()fj.data.Zipper[A]" id="19934">tryNext</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">if</span> <span class="delimiter">(</span>right.isEmpty<span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">throw</span> <span class="keyword">new</span> Error<span class="delimiter">(</span><span class="string">&quot;Tried next at the end of a zipper.&quot;</span><span class="delimiter">)</span>;
    <span class="keyword">else</span>
      <span class="keyword">return</span> zipper<span class="delimiter">(</span>left.cons<span class="delimiter">(</span>focus<span class="delimiter">)</span>, right.head<span class="delimiter">(</span><span class="delimiter">)</span>, right.tail<span class="delimiter">(</span><span class="delimiter">)</span>._1<span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>;
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Possibly moves the focus to the previous element in the list.
   *
   * @return An optional zipper with the focus moved one element to the left, if there are elements to the left of
   *         focus, otherwise None.
   */</span>
  public <a href="Option.java.html#10291" title="fj.data.Option">Option</a>&lt;<a href="#10485" title="fj.data.Zipper">Zipper</a>&lt;<a href="#10486" title="A">A</a>&gt;&gt; <a title="()fj.data.Option[fj.data.Zipper[A]]" id="19935">previous</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">return</span> left.isEmpty<span class="delimiter">(</span><span class="delimiter">)</span> ? Option.&lt;Zipper&lt;A&gt;&gt;none<span class="delimiter">(</span><span class="delimiter">)</span> : some<span class="delimiter">(</span>tryPrevious<span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>;
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Attempts to move the focus to the previous element, or throws an error if there are no more elements.
   *
   * @return A zipper with the focus moved one element to the left, if there are elements to the left of
   *         focus, otherwise throws an error.
   */</span>
  public <a href="#10485" title="fj.data.Zipper">Zipper</a>&lt;<a href="#10486" title="A">A</a>&gt; <a title="()fj.data.Zipper[A]" id="19936">tryPrevious</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">if</span> <span class="delimiter">(</span>left.isEmpty<span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">throw</span> <span class="keyword">new</span> Error<span class="delimiter">(</span><span class="string">&quot;Tried previous at the beginning of a zipper.&quot;</span><span class="delimiter">)</span>;
    <span class="keyword">else</span>
      <span class="keyword">return</span> zipper<span class="delimiter">(</span>left.tail<span class="delimiter">(</span><span class="delimiter">)</span>._1<span class="delimiter">(</span><span class="delimiter">)</span>, left.head<span class="delimiter">(</span><span class="delimiter">)</span>, right.cons<span class="delimiter">(</span>focus<span class="delimiter">)</span><span class="delimiter">)</span>;
  <span class="delimiter">}</span>

  <span class="comment">/**
   * First-class version of the next() function.
   *
   * @return A function that moves the given zipper's focus to the next element.
   */</span>
  public static &lt;<a title="Nothing" id="31556">A</a>&gt; F&lt;<a href="#10485" title="fj.data.Zipper">Zipper</a>&lt;<a href="#31556" title="A">A</a>&gt;, <a href="Option.java.html#10291" title="fj.data.Option">Option</a>&lt;<a href="#10485" title="fj.data.Zipper">Zipper</a>&lt;<a href="#31556" title="A">A</a>&gt;&gt;&gt; <a title="[A]()fj.F[fj.data.Zipper[A],fj.data.Option[fj.data.Zipper[A]]]" id="31554">next_</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">return</span> <span class="keyword">new</span> F&lt;Zipper&lt;A&gt;, Option&lt;Zipper&lt;A&gt;&gt;&gt;<span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      public Option&lt;Zipper&lt;A&gt;&gt; f<span class="delimiter">(</span><span class="keyword">final</span> Zipper&lt;A&gt; as<span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="keyword">return</span> as.next<span class="delimiter">(</span><span class="delimiter">)</span>;
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>;
  <span class="delimiter">}</span>

  <span class="comment">/**
   * First-class version of the previous() function.
   *
   * @return A function that moves the given zipper's focus to the previous element.
   */</span>
  public static &lt;<a title="Nothing" id="31559">A</a>&gt; F&lt;<a href="#10485" title="fj.data.Zipper">Zipper</a>&lt;<a href="#31559" title="A">A</a>&gt;, <a href="Option.java.html#10291" title="fj.data.Option">Option</a>&lt;<a href="#10485" title="fj.data.Zipper">Zipper</a>&lt;<a href="#31559" title="A">A</a>&gt;&gt;&gt; <a title="[A]()fj.F[fj.data.Zipper[A],fj.data.Option[fj.data.Zipper[A]]]" id="31557">previous_</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">return</span> <span class="keyword">new</span> F&lt;Zipper&lt;A&gt;, Option&lt;Zipper&lt;A&gt;&gt;&gt;<span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      public Option&lt;Zipper&lt;A&gt;&gt; f<span class="delimiter">(</span><span class="keyword">final</span> Zipper&lt;A&gt; as<span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="keyword">return</span> as.previous<span class="delimiter">(</span><span class="delimiter">)</span>;
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>;
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Inserts an element to the left of the focus, then moves the focus to the new element.
   *
   * @param a A new element to insert into this zipper.
   * @return A new zipper with the given element in focus, and the current focus element on its right.
   */</span>
  public <a href="#10485" title="fj.data.Zipper">Zipper</a>&lt;<a href="#10486" title="A">A</a>&gt; <a title="(a: A)fj.data.Zipper[A]" id="19937">insertLeft</a><span class="delimiter">(</span><span class="keyword">final</span> <a href="#10486" title="A">A</a> <a title="A" id="31610">a</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">return</span> zipper<span class="delimiter">(</span>left, a, right.cons<span class="delimiter">(</span>focus<span class="delimiter">)</span><span class="delimiter">)</span>;
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Inserts an element to the right of the focus, then moves the focus to the new element.
   *
   * @param a A new element to insert into this zipper.
   * @return A new zipper with the given element in focus, and the current focus element on its left.
   */</span>
  public <a href="#10485" title="fj.data.Zipper">Zipper</a>&lt;<a href="#10486" title="A">A</a>&gt; <a title="(a: A)fj.data.Zipper[A]" id="19938">insertRight</a><span class="delimiter">(</span><span class="keyword">final</span> <a href="#10486" title="A">A</a> <a title="A" id="31612">a</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">return</span> zipper<span class="delimiter">(</span>left.cons<span class="delimiter">(</span>focus<span class="delimiter">)</span>, a, right<span class="delimiter">)</span>;
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Possibly deletes the element at the focus, then moves the element on the left into focus.
   * If no element is on the left, focus on the element to the right.
   * Returns None if the focus element is the only element in this zipper.
   *
   * @return A new zipper with this zipper's focus element removed, or None if deleting the focus element
   *         would cause the zipper to be empty.
   */</span>
  public <a href="Option.java.html#10291" title="fj.data.Option">Option</a>&lt;<a href="#10485" title="fj.data.Zipper">Zipper</a>&lt;<a href="#10486" title="A">A</a>&gt;&gt; <a title="()fj.data.Option[fj.data.Zipper[A]]" id="19939">deleteLeft</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">return</span> left.isEmpty<span class="delimiter">(</span><span class="delimiter">)</span> &amp;&amp; right.isEmpty<span class="delimiter">(</span><span class="delimiter">)</span>
           ? Option.&lt;Zipper&lt;A&gt;&gt;none<span class="delimiter">(</span><span class="delimiter">)</span>
           : some<span class="delimiter">(</span>zipper<span class="delimiter">(</span>left.isEmpty<span class="delimiter">(</span><span class="delimiter">)</span> ? left : left.tail<span class="delimiter">(</span><span class="delimiter">)</span>._1<span class="delimiter">(</span><span class="delimiter">)</span>,
                         left.isEmpty<span class="delimiter">(</span><span class="delimiter">)</span> ? right.head<span class="delimiter">(</span><span class="delimiter">)</span> : left.head<span class="delimiter">(</span><span class="delimiter">)</span>,
                         left.isEmpty<span class="delimiter">(</span><span class="delimiter">)</span> ? right.tail<span class="delimiter">(</span><span class="delimiter">)</span>._1<span class="delimiter">(</span><span class="delimiter">)</span> : right<span class="delimiter">)</span><span class="delimiter">)</span>;
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Possibly deletes the element at the focus, then moves the element on the right into focus.
   * If no element is on the right, focus on the element to the left.
   * Returns None if the focus element is the only element in this zipper.
   *
   * @return A new zipper with this zipper's focus element removed, or None if deleting the focus element
   *         would cause the zipper to be empty.
   */</span>
  public <a href="Option.java.html#10291" title="fj.data.Option">Option</a>&lt;<a href="#10485" title="fj.data.Zipper">Zipper</a>&lt;<a href="#10486" title="A">A</a>&gt;&gt; <a title="()fj.data.Option[fj.data.Zipper[A]]" id="19940">deleteRight</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">return</span> left.isEmpty<span class="delimiter">(</span><span class="delimiter">)</span> &amp;&amp; right.isEmpty<span class="delimiter">(</span><span class="delimiter">)</span>
           ? Option.&lt;Zipper&lt;A&gt;&gt;none<span class="delimiter">(</span><span class="delimiter">)</span>
           : some<span class="delimiter">(</span>zipper<span class="delimiter">(</span>right.isEmpty<span class="delimiter">(</span><span class="delimiter">)</span> ? left.tail<span class="delimiter">(</span><span class="delimiter">)</span>._1<span class="delimiter">(</span><span class="delimiter">)</span> : left,
                         right.isEmpty<span class="delimiter">(</span><span class="delimiter">)</span> ? left.head<span class="delimiter">(</span><span class="delimiter">)</span> : right.head<span class="delimiter">(</span><span class="delimiter">)</span>,
                         right.isEmpty<span class="delimiter">(</span><span class="delimiter">)</span> ? right : right.tail<span class="delimiter">(</span><span class="delimiter">)</span>._1<span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>;
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Deletes all elements in the zipper except the focus.
   *
   * @return A new zipper with the focus element as the only element.
   */</span>
  public <a href="#10485" title="fj.data.Zipper">Zipper</a>&lt;<a href="#10486" title="A">A</a>&gt; <a title="()fj.data.Zipper[A]" id="19941">deleteOthers</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">final</span> Stream&lt;A&gt; nil = nil<span class="delimiter">(</span><span class="delimiter">)</span>;
    <span class="keyword">return</span> zipper<span class="delimiter">(</span>nil, focus, nil<span class="delimiter">)</span>;
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Returns the length of this zipper.
   *
   * @return the length of this zipper.
   */</span>
  public int <a title="()Int" id="19942">length</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">return</span> foldRight<span class="delimiter">(</span>Function.&lt;A, F&lt;Integer, Integer&gt;&gt;constant<span class="delimiter">(</span>Integers.add.f<span class="delimiter">(</span><span class="int">1</span><span class="delimiter">)</span><span class="delimiter">)</span>, <span class="int">0</span><span class="delimiter">)</span>;
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Returns whether the focus is on the first element.
   *
   * @return true if the focus is on the first element, otherwise false.
   */</span>
  public boolean <a title="()Boolean" id="19943">atStart</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">return</span> left.isEmpty<span class="delimiter">(</span><span class="delimiter">)</span>;
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Returns whether the focus is on the last element.
   *
   * @return true if the focus is on the last element, otherwise false.
   */</span>
  public boolean <a title="()Boolean" id="19944">atEnd</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">return</span> right.isEmpty<span class="delimiter">(</span><span class="delimiter">)</span>;
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Creates a zipper of variations of this zipper, in which each element is focused,
   * with this zipper as the focus of the zipper of zippers (comonad pattern).
   *
   * @return a zipper of variations of the provided zipper, in which each element is focused,
   *         with this zipper as the focus of the zipper of zippers.
   */</span>
  public <a href="#10485" title="fj.data.Zipper">Zipper</a>&lt;<a href="#10485" title="fj.data.Zipper">Zipper</a>&lt;<a href="#10486" title="A">A</a>&gt;&gt; <a title="()fj.data.Zipper[fj.data.Zipper[A]]" id="19945">positions</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">final</span> Stream&lt;Zipper&lt;A&gt;&gt; left = Stream.unfold<span class="delimiter">(</span>
        <span class="keyword">new</span> F&lt;Zipper&lt;A&gt;, Option&lt;P2&lt;Zipper&lt;A&gt;, Zipper&lt;A&gt;&gt;&gt;&gt;<span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
          public Option&lt;P2&lt;Zipper&lt;A&gt;, Zipper&lt;A&gt;&gt;&gt; f<span class="delimiter">(</span><span class="keyword">final</span> Zipper&lt;A&gt; p<span class="delimiter">)</span> <span class="delimiter">{</span>
            <span class="keyword">return</span> p.previous<span class="delimiter">(</span><span class="delimiter">)</span>.map<span class="delimiter">(</span>join<span class="delimiter">(</span>P.&lt;Zipper&lt;A&gt;, Zipper&lt;A&gt;&gt;p2<span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>;
          <span class="delimiter">}</span>
        <span class="delimiter">}</span>, <span class="keyword">this</span><span class="delimiter">)</span>;
    <span class="keyword">final</span> Stream&lt;Zipper&lt;A&gt;&gt; right = Stream.unfold<span class="delimiter">(</span>
        <span class="keyword">new</span> F&lt;Zipper&lt;A&gt;, Option&lt;P2&lt;Zipper&lt;A&gt;, Zipper&lt;A&gt;&gt;&gt;&gt;<span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
          public Option&lt;P2&lt;Zipper&lt;A&gt;, Zipper&lt;A&gt;&gt;&gt; f<span class="delimiter">(</span><span class="keyword">final</span> Zipper&lt;A&gt; p<span class="delimiter">)</span> <span class="delimiter">{</span>
            <span class="keyword">return</span> p.next<span class="delimiter">(</span><span class="delimiter">)</span>.map<span class="delimiter">(</span>join<span class="delimiter">(</span>P.&lt;Zipper&lt;A&gt;, Zipper&lt;A&gt;&gt;p2<span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>;
          <span class="delimiter">}</span>
        <span class="delimiter">}</span>, <span class="keyword">this</span><span class="delimiter">)</span>;

    <span class="keyword">return</span> zipper<span class="delimiter">(</span>left, <span class="keyword">this</span>, right<span class="delimiter">)</span>;
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Maps over variations of this zipper, such that the given function is applied to each variation (comonad pattern).
   *
   * @param f The comonadic function to apply for each variation of this zipper.
   * @return A new zipper, with the given function applied for each variation of this zipper.
   */</span>
  public &lt;<a title="Nothing" id="19948">B</a>&gt; <a href="#10485" title="fj.data.Zipper">Zipper</a>&lt;<a href="#19948" title="B">B</a>&gt; <a title="[B](f: fj.F[fj.data.Zipper[A],B])fj.data.Zipper[B]" id="19946">cobind</a><span class="delimiter">(</span><span class="keyword">final</span> F&lt;<a href="#10485" title="fj.data.Zipper">Zipper</a>&lt;<a href="#10486" title="A">A</a>&gt;, <a href="#19948" title="B">B</a>&gt; <a title="fj.F[fj.data.Zipper[A],B]" id="31621">f</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">return</span> positions<span class="delimiter">(</span><span class="delimiter">)</span>.map<span class="delimiter">(</span>f<span class="delimiter">)</span>;
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Zips the elements of this zipper with a boolean that indicates whether that element has focus.
   * All of the booleans will be false, except the focused element.
   *
   * @return A new zipper of pairs, with each element of this zipper paired with a boolean that is true if that
   *         element has focus, and false otherwise.
   */</span>
  public <a href="#10485" title="fj.data.Zipper">Zipper</a>&lt;P2&lt;<a href="#10486" title="A">A</a>, Boolean&gt;&gt; <a title="()fj.data.Zipper[fj.P2[A,java.lang.Boolean]]" id="19949">zipWithFocus</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">return</span> zipper<span class="delimiter">(</span>left.zip<span class="delimiter">(</span>repeat<span class="delimiter">(</span><span class="keyword">false</span><span class="delimiter">)</span><span class="delimiter">)</span>, P.p<span class="delimiter">(</span>focus, <span class="keyword">true</span><span class="delimiter">)</span>, right.zip<span class="delimiter">(</span>repeat<span class="delimiter">(</span><span class="keyword">false</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>;
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Move the focus to the specified index.
   *
   * @param n The index to which to move the focus.
   * @return A new zipper with the focus moved to the specified index, or none if there is no such index.
   */</span>
  public <a href="Option.java.html#10291" title="fj.data.Option">Option</a>&lt;<a href="#10485" title="fj.data.Zipper">Zipper</a>&lt;<a href="#10486" title="A">A</a>&gt;&gt; <a title="(n: Int)fj.data.Option[fj.data.Zipper[A]]" id="19950">move</a><span class="delimiter">(</span><span class="keyword">final</span> int <a title="Int" id="31625">n</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">final</span> int ll = left.length<span class="delimiter">(</span><span class="delimiter">)</span>;
    <span class="keyword">final</span> int rl = right.length<span class="delimiter">(</span><span class="delimiter">)</span>;
    Option&lt;Zipper&lt;A&gt;&gt; p = some<span class="delimiter">(</span><span class="keyword">this</span><span class="delimiter">)</span>;
    <span class="keyword">if</span> <span class="delimiter">(</span>n &lt; <span class="int">0</span> || n &gt;= length<span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">return</span> none<span class="delimiter">(</span><span class="delimiter">)</span>;
    <span class="keyword">else</span> <span class="keyword">if</span> <span class="delimiter">(</span>ll &gt;= n<span class="delimiter">)</span>
      <span class="keyword">for</span> <span class="delimiter">(</span>int i = ll - n; i &gt; <span class="int">0</span>; i--<span class="delimiter">)</span>
        p = p.bind<span class="delimiter">(</span>Zipper.&lt;A&gt;previous_<span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>;
    <span class="keyword">else</span> <span class="keyword">if</span> <span class="delimiter">(</span>rl &gt;= n<span class="delimiter">)</span>
      <span class="keyword">for</span> <span class="delimiter">(</span>int i = rl - n; i &gt; <span class="int">0</span>; i--<span class="delimiter">)</span>
        p = p.bind<span class="delimiter">(</span>Zipper.&lt;A&gt;next_<span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>;
    <span class="keyword">return</span> p;
  <span class="delimiter">}</span>

  <span class="comment">/**
   * A first-class version of the move function.
   *
   * @return A function that moves the focus of the given zipper to the given index.
   */</span>
  public static &lt;<a title="Nothing" id="31562">A</a>&gt; F&lt;Integer, F&lt;<a href="#10485" title="fj.data.Zipper">Zipper</a>&lt;<a href="#31562" title="A">A</a>&gt;, <a href="Option.java.html#10291" title="fj.data.Option">Option</a>&lt;<a href="#10485" title="fj.data.Zipper">Zipper</a>&lt;<a href="#31562" title="A">A</a>&gt;&gt;&gt;&gt; <a title="[A]()fj.F[java.lang.Integer,fj.F[fj.data.Zipper[A],fj.data.Option[fj.data.Zipper[A]]]]" id="31560">move</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">return</span> curry<span class="delimiter">(</span><span class="keyword">new</span> F2&lt;Integer, Zipper&lt;A&gt;, Option&lt;Zipper&lt;A&gt;&gt;&gt;<span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      public Option&lt;Zipper&lt;A&gt;&gt; f<span class="delimiter">(</span><span class="keyword">final</span> Integer i, <span class="keyword">final</span> Zipper&lt;A&gt; a<span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="keyword">return</span> a.move<span class="delimiter">(</span>i<span class="delimiter">)</span>;
      <span class="delimiter">}</span>
    <span class="delimiter">}</span><span class="delimiter">)</span>;
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Moves the focus to the element matching the given predicate, if present.
   *
   * @param p A predicate to match.
   * @return A new zipper with the nearest matching element focused if it is present in this zipper.
   */</span>
  public <a href="Option.java.html#10291" title="fj.data.Option">Option</a>&lt;<a href="#10485" title="fj.data.Zipper">Zipper</a>&lt;<a href="#10486" title="A">A</a>&gt;&gt; <a title="(p: fj.F[A,java.lang.Boolean])fj.data.Option[fj.data.Zipper[A]]" id="19951">find</a><span class="delimiter">(</span><span class="keyword">final</span> F&lt;<a href="#10486" title="A">A</a>, Boolean&gt; <a title="fj.F[A,java.lang.Boolean]" id="31627">p</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">if</span> <span class="delimiter">(</span>p.f<span class="delimiter">(</span>focus<span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">return</span> some<span class="delimiter">(</span><span class="keyword">this</span><span class="delimiter">)</span>;
    <span class="keyword">else</span> <span class="delimiter">{</span>
      <span class="keyword">final</span> Zipper&lt;Zipper&lt;A&gt;&gt; ps = positions<span class="delimiter">(</span><span class="delimiter">)</span>;
      <span class="keyword">return</span> ps.lefts<span class="delimiter">(</span><span class="delimiter">)</span>.interleave<span class="delimiter">(</span>ps.rights<span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>.find<span class="delimiter">(</span><span class="keyword">new</span> F&lt;Zipper&lt;A&gt;, Boolean&gt;<span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        public Boolean f<span class="delimiter">(</span><span class="keyword">final</span> Zipper&lt;A&gt; zipper<span class="delimiter">)</span> <span class="delimiter">{</span>
          <span class="keyword">return</span> p.f<span class="delimiter">(</span>zipper.focus<span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>;
        <span class="delimiter">}</span>
      <span class="delimiter">}</span><span class="delimiter">)</span>;
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Returns the index of the focus.
   *
   * @return the index of the focus.
   */</span>
  public int <a title="()Int" id="19952">index</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">return</span> left.length<span class="delimiter">(</span><span class="delimiter">)</span>;
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Move the focus to the next element. If the last element is focused, loop to the first element.
   *
   * @return A new zipper with the next element focused, unless the last element is currently focused, in which case
   *         the first element becomes focused.
   */</span>
  public <a href="#10485" title="fj.data.Zipper">Zipper</a>&lt;<a href="#10486" title="A">A</a>&gt; <a title="()fj.data.Zipper[A]" id="19953">cycleNext</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">if</span> <span class="delimiter">(</span>left.isEmpty<span class="delimiter">(</span><span class="delimiter">)</span> &amp;&amp; right.isEmpty<span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">return</span> <span class="keyword">this</span>;
    <span class="keyword">else</span> <span class="keyword">if</span> <span class="delimiter">(</span>right.isEmpty<span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="keyword">final</span> Stream&lt;A&gt; xs = left.reverse<span class="delimiter">(</span><span class="delimiter">)</span>;
      <span class="keyword">return</span> zipper<span class="delimiter">(</span>Stream.&lt;A&gt;nil<span class="delimiter">(</span><span class="delimiter">)</span>, xs.head<span class="delimiter">(</span><span class="delimiter">)</span>, xs.tail<span class="delimiter">(</span><span class="delimiter">)</span>._1<span class="delimiter">(</span><span class="delimiter">)</span>.snoc<span class="delimiter">(</span>P.p<span class="delimiter">(</span>focus<span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>;
    <span class="delimiter">}</span> <span class="keyword">else</span>
      <span class="keyword">return</span> tryNext<span class="delimiter">(</span><span class="delimiter">)</span>;
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Move the focus to the previous element. If the first element is focused, loop to the last element.
   *
   * @return A new zipper with the previous element focused, unless the first element is currently focused,
   *         in which case the last element becomes focused.
   */</span>
  public <a href="#10485" title="fj.data.Zipper">Zipper</a>&lt;<a href="#10486" title="A">A</a>&gt; <a title="()fj.data.Zipper[A]" id="19954">cyclePrevious</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">if</span> <span class="delimiter">(</span>left.isEmpty<span class="delimiter">(</span><span class="delimiter">)</span> &amp;&amp; right.isEmpty<span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">return</span> <span class="keyword">this</span>;
    <span class="keyword">else</span> <span class="keyword">if</span> <span class="delimiter">(</span>left.isEmpty<span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="keyword">final</span> Stream&lt;A&gt; xs = right.reverse<span class="delimiter">(</span><span class="delimiter">)</span>;
      <span class="keyword">return</span> zipper<span class="delimiter">(</span>xs.tail<span class="delimiter">(</span><span class="delimiter">)</span>._1<span class="delimiter">(</span><span class="delimiter">)</span>.snoc<span class="delimiter">(</span>P.p<span class="delimiter">(</span>focus<span class="delimiter">)</span><span class="delimiter">)</span>, xs.head<span class="delimiter">(</span><span class="delimiter">)</span>, Stream.&lt;A&gt;nil<span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>;
    <span class="delimiter">}</span> <span class="keyword">else</span>
      <span class="keyword">return</span> tryPrevious<span class="delimiter">(</span><span class="delimiter">)</span>;
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Possibly deletes the element at the focus, then move the element on the left into focus. If no element is on the
   * left, focus on the last element. If the deletion will cause the list to be empty, return None.
   *
   * @return A new zipper with the focused element removed, and focus on the previous element to the left, or the last
   *         element if there is no element to the left.
   */</span>
  public <a href="Option.java.html#10291" title="fj.data.Option">Option</a>&lt;<a href="#10485" title="fj.data.Zipper">Zipper</a>&lt;<a href="#10486" title="A">A</a>&gt;&gt; <a title="()fj.data.Option[fj.data.Zipper[A]]" id="19955">deleteLeftCycle</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">if</span> <span class="delimiter">(</span>left.isEmpty<span class="delimiter">(</span><span class="delimiter">)</span> &amp;&amp; right.isEmpty<span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">return</span> none<span class="delimiter">(</span><span class="delimiter">)</span>;
    <span class="keyword">else</span> <span class="keyword">if</span> <span class="delimiter">(</span>left.isNotEmpty<span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">return</span> some<span class="delimiter">(</span>zipper<span class="delimiter">(</span>left.tail<span class="delimiter">(</span><span class="delimiter">)</span>._1<span class="delimiter">(</span><span class="delimiter">)</span>, left.head<span class="delimiter">(</span><span class="delimiter">)</span>, right<span class="delimiter">)</span><span class="delimiter">)</span>;
    <span class="keyword">else</span> <span class="delimiter">{</span>
      <span class="keyword">final</span> Stream&lt;A&gt; xs = right.reverse<span class="delimiter">(</span><span class="delimiter">)</span>;
      <span class="keyword">return</span> some<span class="delimiter">(</span>zipper<span class="delimiter">(</span>xs.tail<span class="delimiter">(</span><span class="delimiter">)</span>._1<span class="delimiter">(</span><span class="delimiter">)</span>, xs.head<span class="delimiter">(</span><span class="delimiter">)</span>, Stream.&lt;A&gt;nil<span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>;
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Possibly deletes the element at the focus, then move the element on the right into focus. If no element is on the
   * right, focus on the first element. If the deletion will cause the list to be empty, return None.
   *
   * @return A new zipper with the focused element removed, and focus on the next element to the right, or the first
   *         element if there is no element to the right.
   */</span>
  public <a href="Option.java.html#10291" title="fj.data.Option">Option</a>&lt;<a href="#10485" title="fj.data.Zipper">Zipper</a>&lt;<a href="#10486" title="A">A</a>&gt;&gt; <a title="()fj.data.Option[fj.data.Zipper[A]]" id="19956">deleteRightCycle</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">if</span> <span class="delimiter">(</span>left.isEmpty<span class="delimiter">(</span><span class="delimiter">)</span> &amp;&amp; right.isEmpty<span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">return</span> none<span class="delimiter">(</span><span class="delimiter">)</span>;
    <span class="keyword">else</span> <span class="keyword">if</span> <span class="delimiter">(</span>right.isNotEmpty<span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">return</span> some<span class="delimiter">(</span>zipper<span class="delimiter">(</span>left, right.head<span class="delimiter">(</span><span class="delimiter">)</span>, right.tail<span class="delimiter">(</span><span class="delimiter">)</span>._1<span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>;
    <span class="keyword">else</span> <span class="delimiter">{</span>
      <span class="keyword">final</span> Stream&lt;A&gt; xs = left.reverse<span class="delimiter">(</span><span class="delimiter">)</span>;
      <span class="keyword">return</span> some<span class="delimiter">(</span>zipper<span class="delimiter">(</span>Stream.&lt;A&gt;nil<span class="delimiter">(</span><span class="delimiter">)</span>, xs.head<span class="delimiter">(</span><span class="delimiter">)</span>, xs.tail<span class="delimiter">(</span><span class="delimiter">)</span>._1<span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>;
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Replaces the element in focus with the given element.
   *
   * @param a An element to replace the focused element with.
   * @return A new zipper with the given element in focus.
   */</span>
  public <a href="#10485" title="fj.data.Zipper">Zipper</a>&lt;<a href="#10486" title="A">A</a>&gt; <a title="(a: A)fj.data.Zipper[A]" id="19957">replace</a><span class="delimiter">(</span><span class="keyword">final</span> <a href="#10486" title="A">A</a> <a title="A" id="31634">a</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">return</span> zipper<span class="delimiter">(</span>left, a, right<span class="delimiter">)</span>;
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Returns the Stream representation of this zipper.
   *
   * @return A stream that contains all the elements of this zipper.
   */</span>
  public <a href="Stream.java.html#10365" title="fj.data.Stream">Stream</a>&lt;<a href="#10486" title="A">A</a>&gt; <a title="()fj.data.Stream[A]" id="19958">toStream</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">return</span> left.reverse<span class="delimiter">(</span><span class="delimiter">)</span>.snoc<span class="delimiter">(</span>P.p<span class="delimiter">(</span>focus<span class="delimiter">)</span><span class="delimiter">)</span>.append<span class="delimiter">(</span>right<span class="delimiter">)</span>;
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Returns a Stream of the elements to the left of focus.
   *
   * @return a Stream of the elements to the left of focus.
   */</span>
  public <a href="Stream.java.html#10365" title="fj.data.Stream">Stream</a>&lt;<a href="#10486" title="A">A</a>&gt; <a title="()fj.data.Stream[A]" id="19959">lefts</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">return</span> left;
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Returns a Stream of the elements to the right of focus.
   *
   * @return a Stream of the elements to the right of focus.
   */</span>
  public <a href="Stream.java.html#10365" title="fj.data.Stream">Stream</a>&lt;<a href="#10486" title="A">A</a>&gt; <a title="()fj.data.Stream[A]" id="19960">rights</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">return</span> right;
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Zips this Zipper with another, applying the given function lock-step over both zippers in both directions.
   * The structure of the resulting Zipper is the structural intersection of the two Zippers.
   *
   * @param bs A Zipper to zip this one with.
   * @param f  A function with which to zip together the two Zippers.
   * @return The result of applying the given function over this Zipper and the given Zipper, location-wise.
   */</span>
  public &lt;<a title="Nothing" id="19964">B</a>, <a title="Nothing" id="19965">C</a>&gt; <a href="#10485" title="fj.data.Zipper">Zipper</a>&lt;<a href="#19965" title="C">C</a>&gt; <a title="[B, C](bs: fj.data.Zipper[B], f: fj.F2[A,B,C])fj.data.Zipper[C]" id="19961">zipWith</a><span class="delimiter">(</span><span class="keyword">final</span> <a href="#10485" title="fj.data.Zipper">Zipper</a>&lt;<a href="#19964" title="B">B</a>&gt; <a title="fj.data.Zipper[B]" id="31639">bs</a>, <span class="keyword">final</span> F2&lt;<a href="#10486" title="A">A</a>, <a href="#19964" title="B">B</a>, <a href="#19965" title="C">C</a>&gt; <a title="fj.F2[A,B,C]" id="31640">f</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">return</span> f.zipZipperM<span class="delimiter">(</span><span class="delimiter">)</span>.f<span class="delimiter">(</span><span class="keyword">this</span>, bs<span class="delimiter">)</span>;
  <span class="delimiter">}</span>


  <span class="comment">/**
   * Zips this Zipper with another, applying the given function lock-step over both zippers in both directions.
   * The structure of the resulting Zipper is the structural intersection of the two Zippers.
   *
   * @param bs A Zipper to zip this one with.
   * @param f  A function with which to zip together the two Zippers.
   * @return The result of applying the given function over this Zipper and the given Zipper, location-wise.
   */</span>
  public &lt;<a title="Nothing" id="19969">B</a>, <a title="Nothing" id="19970">C</a>&gt; <a href="#10485" title="fj.data.Zipper">Zipper</a>&lt;<a href="#19970" title="C">C</a>&gt; <a title="[B, C](bs: fj.data.Zipper[B], f: fj.F[A,fj.F[B,C]])fj.data.Zipper[C]" id="19966">zipWith</a><span class="delimiter">(</span><span class="keyword">final</span> <a href="#10485" title="fj.data.Zipper">Zipper</a>&lt;<a href="#19969" title="B">B</a>&gt; <a title="fj.data.Zipper[B]" id="31644">bs</a>, <span class="keyword">final</span> F&lt;<a href="#10486" title="A">A</a>, F&lt;<a href="#19969" title="B">B</a>, <a href="#19970" title="C">C</a>&gt;&gt; <a title="fj.F[A,fj.F[B,C]]" id="31645">f</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">return</span> zipWith<span class="delimiter">(</span>bs, uncurryF2<span class="delimiter">(</span>f<span class="delimiter">)</span><span class="delimiter">)</span>;
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Returns an iterator of all the positions of this Zipper, starting from the leftmost position.
   *
   * @return An iterator of all the positions of this Zipper, starting from the leftmost position.
   */</span>
  public Iterator&lt;<a href="#10485" title="fj.data.Zipper">Zipper</a>&lt;<a href="#10486" title="A">A</a>&gt;&gt; <a title="()java.util.Iterator[fj.data.Zipper[A]]" id="19971">iterator</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span> <span class="keyword">return</span> positions<span class="delimiter">(</span><span class="delimiter">)</span>.toStream<span class="delimiter">(</span><span class="delimiter">)</span>.iterator<span class="delimiter">(</span><span class="delimiter">)</span>; <span class="delimiter">}</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>