<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>fj/data/Set.java</title>
        <script type="text/javascript" src="../../jquery-all.js"></script>
        <script type="text/javascript" src="../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> fj.data;

<span class="keyword">import</span> fj.F;
<span class="keyword">import</span> fj.F2;
<span class="keyword">import</span> fj.Function;
<span class="keyword">import</span> fj.Monoid;
<span class="keyword">import</span> fj.Ord;
<span class="keyword">import</span> fj.P;
<span class="keyword">import</span> fj.P2;
<span class="keyword">import</span> fj.P3;
<span class="keyword">import</span> <a href="../Function.java.html#9624" title="object fj.Function">static</a> fj.Function.*;
<span class="keyword">import</span> static fj.data.Either.right;
<span class="keyword">import</span> static fj.data.Option.some;
<span class="keyword">import</span> static fj.function.Booleans.not;

<span class="keyword">import</span> fj.Ordering;
<span class="keyword">import</span> static fj.Ordering.GT;
<span class="keyword">import</span> static fj.Ordering.LT;

<span class="keyword">import</span> java.util.Iterator;

<span class="comment">/**
 * Provides an in-memory, immutable set, implemented as a red/black tree.
 */</span>
public <span class="keyword">abstract</span> <span class="keyword">class</span> <a title="object fj.data.Set" id="10324">Set</a>&lt;<a title="Nothing" id="10325">A</a>&gt; implements Iterable&lt;<a href="#10325" title="A">A</a>&gt; <span class="delimiter">{</span>
  <span class="keyword">private</span> Set<span class="delimiter">(</span><span class="keyword">final</span> Ord&lt;A&gt; ord<span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">this</span>.ord = ord;
  <span class="delimiter">}</span>

  <span class="keyword">private</span> enum <a title="object fj.data.Set.Color" id="30115">Color</a> <span class="delimiter">{</span>
    <a title="fj.data.Set.Color" id="30161">R</a>, <a title="fj.data.Set.Color" id="30162">B</a>
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">final</span> Ord&lt;<a href="#10325" title="A">A</a>&gt; <a title="fj.Ord[A]" id="19567">ord</a>;

  public <span class="keyword">final</span> boolean <a title="()Boolean" id="19568">isEmpty</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">return</span> <span class="keyword">this</span> instanceof Empty;
  <span class="delimiter">}</span>

  @SuppressWarnings<span class="delimiter">(</span><span class="delimiter">{</span><span class="string">&quot;ClassEscapesDefinedScope&quot;</span><span class="delimiter">}</span><span class="delimiter">)</span>
  <span class="keyword">abstract</span> Color <a title="()fj.data.Set.Color" id="19569">color</a><span class="delimiter">(</span><span class="delimiter">)</span>;

  <span class="keyword">abstract</span> <a href="#10324" title="fj.data.Set">Set</a>&lt;<a href="#10325" title="A">A</a>&gt; <a title="()fj.data.Set[A]" id="19570">l</a><span class="delimiter">(</span><span class="delimiter">)</span>;

  <span class="keyword">abstract</span> <a href="#10325" title="A">A</a> <a title="()A" id="19571">head</a><span class="delimiter">(</span><span class="delimiter">)</span>;

  <span class="keyword">abstract</span> <a href="#10324" title="fj.data.Set">Set</a>&lt;<a href="#10325" title="A">A</a>&gt; <a title="()fj.data.Set[A]" id="19572">r</a><span class="delimiter">(</span><span class="delimiter">)</span>;

  <span class="comment">/**
   * Returns the order of this Set.
   *
   * @return the order of this Set.
   */</span>
  public <span class="keyword">final</span> Ord&lt;<a href="#10325" title="A">A</a>&gt; <a title="()fj.Ord[A]" id="19573">ord</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">return</span> ord;
  <span class="delimiter">}</span>

  <span class="keyword">private</span> static <span class="keyword">final</span> <span class="keyword">class</span> <a title="object fj.data.Set.Empty" id="30118">Empty</a>&lt;<a id="30119">A</a>&gt; <span class="keyword">extends</span> Set&lt;A&gt; <span class="delimiter">{</span>
    <span class="keyword">private</span> Empty<span class="delimiter">(</span><span class="keyword">final</span> Ord&lt;A&gt; ord<span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="keyword">super</span><span class="delimiter">(</span>ord<span class="delimiter">)</span>;
    <span class="delimiter">}</span>

    public Color color<span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="keyword">return</span> Color.B;
    <span class="delimiter">}</span>

    public Set&lt;A&gt; l<span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="keyword">throw</span> <span class="keyword">new</span> Error<span class="delimiter">(</span><span class="string">&quot;Left on empty set.&quot;</span><span class="delimiter">)</span>;
    <span class="delimiter">}</span>

    public Set&lt;A&gt; r<span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="keyword">throw</span> <span class="keyword">new</span> Error<span class="delimiter">(</span><span class="string">&quot;Right on empty set.&quot;</span><span class="delimiter">)</span>;
    <span class="delimiter">}</span>

    public A head<span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="keyword">throw</span> <span class="keyword">new</span> Error<span class="delimiter">(</span><span class="string">&quot;Head on empty set.&quot;</span><span class="delimiter">)</span>;
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">private</span> static <span class="keyword">final</span> <span class="keyword">class</span> <a title="object fj.data.Set.Tree" id="30122">Tree</a>&lt;<a id="30123">A</a>&gt; <span class="keyword">extends</span> Set&lt;A&gt; <span class="delimiter">{</span>
    <span class="keyword">private</span> <span class="keyword">final</span> Color c;
    <span class="keyword">private</span> <span class="keyword">final</span> Set&lt;A&gt; a;
    <span class="keyword">private</span> <span class="keyword">final</span> A x;
    <span class="keyword">private</span> <span class="keyword">final</span> Set&lt;A&gt; b;

    <span class="keyword">private</span> Tree<span class="delimiter">(</span><span class="keyword">final</span> Ord&lt;A&gt; ord, <span class="keyword">final</span> Color c, <span class="keyword">final</span> Set&lt;A&gt; a, <span class="keyword">final</span> A x, <span class="keyword">final</span> Set&lt;A&gt; b<span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="keyword">super</span><span class="delimiter">(</span>ord<span class="delimiter">)</span>;
      <span class="keyword">this</span>.c = c;
      <span class="keyword">this</span>.a = a;
      <span class="keyword">this</span>.x = x;
      <span class="keyword">this</span>.b = b;
    <span class="delimiter">}</span>

    public Color color<span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="keyword">return</span> c;
    <span class="delimiter">}</span>

    public Set&lt;A&gt; l<span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="keyword">return</span> a;
    <span class="delimiter">}</span>

    public A head<span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="keyword">return</span> x;
    <span class="delimiter">}</span>

    public Set&lt;A&gt; r<span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="keyword">return</span> b;
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Updates, with the given function, the first element in the set that is equal to the given element,
   * according to the order.
   *
   * @param a An element to replace.
   * @param f A function to transforms the found element.
   * @return A pair of: (1) True if an element was found that matches the given element, otherwise false.
   *         (2) A new set with the given function applied to the first set element
   *         that was equal to the given element.
   */</span>
  public <span class="keyword">final</span> P2&lt;Boolean, <a href="#10324" title="fj.data.Set">Set</a>&lt;<a href="#10325" title="A">A</a>&gt;&gt; <a title="(a: A, f: fj.F[A,A])fj.P2[java.lang.Boolean,fj.data.Set[A]]" id="19574">update</a><span class="delimiter">(</span><span class="keyword">final</span> <a href="#10325" title="A">A</a> <a title="A" id="30241">a</a>, <span class="keyword">final</span> F&lt;<a href="#10325" title="A">A</a>, <a href="#10325" title="A">A</a>&gt; <a title="fj.F[A,A]" id="30242">f</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">return</span> isEmpty<span class="delimiter">(</span><span class="delimiter">)</span>
           ? P.p<span class="delimiter">(</span><span class="keyword">false</span>, <span class="keyword">this</span><span class="delimiter">)</span>
           : tryUpdate<span class="delimiter">(</span>a, f<span class="delimiter">)</span>.either<span class="delimiter">(</span><span class="keyword">new</span> F&lt;A, P2&lt;Boolean, Set&lt;A&gt;&gt;&gt;<span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
             public P2&lt;Boolean, Set&lt;A&gt;&gt; f<span class="delimiter">(</span><span class="keyword">final</span> A a2<span class="delimiter">)</span> <span class="delimiter">{</span>
               <span class="keyword">return</span> P.p<span class="delimiter">(</span><span class="keyword">true</span>, delete<span class="delimiter">(</span>a<span class="delimiter">)</span>.insert<span class="delimiter">(</span>a2<span class="delimiter">)</span><span class="delimiter">)</span>;
             <span class="delimiter">}</span>
           <span class="delimiter">}</span>, Function.&lt;P2&lt;Boolean, Set&lt;A&gt;&gt;&gt;identity<span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>;
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <a href="Either.java.html#10039" title="fj.data.Either">Either</a>&lt;<a href="#10325" title="A">A</a>, P2&lt;Boolean, <a href="#10324" title="fj.data.Set">Set</a>&lt;<a href="#10325" title="A">A</a>&gt;&gt;&gt; <a title="(a: A, f: fj.F[A,A])fj.data.Either[A,fj.P2[java.lang.Boolean,fj.data.Set[A]]]" id="19575">tryUpdate</a><span class="delimiter">(</span><span class="keyword">final</span> <a href="#10325" title="A">A</a> <a title="A" id="30244">a</a>, <span class="keyword">final</span> F&lt;<a href="#10325" title="A">A</a>, <a href="#10325" title="A">A</a>&gt; <a title="fj.F[A,A]" id="30245">f</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">if</span> <span class="delimiter">(</span>isEmpty<span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">return</span> right<span class="delimiter">(</span>P.p<span class="delimiter">(</span><span class="keyword">false</span>, <span class="keyword">this</span><span class="delimiter">)</span><span class="delimiter">)</span>;
    <span class="keyword">else</span> <span class="keyword">if</span> <span class="delimiter">(</span>ord.isLessThan<span class="delimiter">(</span>a, head<span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">return</span> l<span class="delimiter">(</span><span class="delimiter">)</span>.tryUpdate<span class="delimiter">(</span>a, f<span class="delimiter">)</span>.right<span class="delimiter">(</span><span class="delimiter">)</span>.map<span class="delimiter">(</span><span class="keyword">new</span> F&lt;P2&lt;Boolean, Set&lt;A&gt;&gt;, P2&lt;Boolean, Set&lt;A&gt;&gt;&gt;<span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        public P2&lt;Boolean, Set&lt;A&gt;&gt; f<span class="delimiter">(</span><span class="keyword">final</span> P2&lt;Boolean, Set&lt;A&gt;&gt; set<span class="delimiter">)</span> <span class="delimiter">{</span>
          <span class="keyword">return</span> set._1<span class="delimiter">(</span><span class="delimiter">)</span> ? P.p<span class="delimiter">(</span><span class="keyword">true</span>, <span class="delimiter">(</span>Set&lt;A&gt;<span class="delimiter">)</span> <span class="keyword">new</span> Tree&lt;A&gt;<span class="delimiter">(</span>ord, color<span class="delimiter">(</span><span class="delimiter">)</span>, set._2<span class="delimiter">(</span><span class="delimiter">)</span>, head<span class="delimiter">(</span><span class="delimiter">)</span>, r<span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span> : set;
        <span class="delimiter">}</span>
      <span class="delimiter">}</span><span class="delimiter">)</span>;
    <span class="keyword">else</span> <span class="keyword">if</span> <span class="delimiter">(</span>ord.eq<span class="delimiter">(</span>a, head<span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="keyword">final</span> A h = f.f<span class="delimiter">(</span>head<span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>;
      <span class="keyword">return</span> ord.eq<span class="delimiter">(</span>head<span class="delimiter">(</span><span class="delimiter">)</span>, h<span class="delimiter">)</span> ? Either
          .&lt;A, P2&lt;Boolean, Set&lt;A&gt;&gt;&gt;right<span class="delimiter">(</span>P.p<span class="delimiter">(</span><span class="keyword">true</span>, <span class="delimiter">(</span>Set&lt;A&gt;<span class="delimiter">)</span> <span class="keyword">new</span> Tree&lt;A&gt;<span class="delimiter">(</span>ord, color<span class="delimiter">(</span><span class="delimiter">)</span>, l<span class="delimiter">(</span><span class="delimiter">)</span>, h, r<span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
                               : Either.&lt;A, P2&lt;Boolean, Set&lt;A&gt;&gt;&gt;left<span class="delimiter">(</span>h<span class="delimiter">)</span>;
    <span class="delimiter">}</span> <span class="keyword">else</span> <span class="keyword">return</span> r<span class="delimiter">(</span><span class="delimiter">)</span>.tryUpdate<span class="delimiter">(</span>a, f<span class="delimiter">)</span>.right<span class="delimiter">(</span><span class="delimiter">)</span>.map<span class="delimiter">(</span><span class="keyword">new</span> F&lt;P2&lt;Boolean, Set&lt;A&gt;&gt;, P2&lt;Boolean, Set&lt;A&gt;&gt;&gt;<span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      public P2&lt;Boolean, Set&lt;A&gt;&gt; f<span class="delimiter">(</span><span class="keyword">final</span> P2&lt;Boolean, Set&lt;A&gt;&gt; set<span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="keyword">return</span> set._1<span class="delimiter">(</span><span class="delimiter">)</span> ? P.p<span class="delimiter">(</span><span class="keyword">true</span>, <span class="delimiter">(</span>Set&lt;A&gt;<span class="delimiter">)</span> <span class="keyword">new</span> Tree&lt;A&gt;<span class="delimiter">(</span>ord, color<span class="delimiter">(</span><span class="delimiter">)</span>, l<span class="delimiter">(</span><span class="delimiter">)</span>, head<span class="delimiter">(</span><span class="delimiter">)</span>, set._2<span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span> : set;
      <span class="delimiter">}</span>
    <span class="delimiter">}</span><span class="delimiter">)</span>;
  <span class="delimiter">}</span>

  <span class="comment">/**
   * The empty set.
   *
   * @param ord An order for the type of elements.
   * @return the empty set.
   */</span>
  public static &lt;<a title="Nothing" id="30126">A</a>&gt; <a href="#10324" title="fj.data.Set">Set</a>&lt;<a href="#30126" title="A">A</a>&gt; <a title="[A](ord: fj.Ord[A])fj.data.Set[A]" id="30124">empty</a><span class="delimiter">(</span><span class="keyword">final</span> Ord&lt;<a href="#30126" title="A">A</a>&gt; <a title="fj.Ord[A]" id="30170">ord</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">return</span> <span class="keyword">new</span> Empty&lt;A&gt;<span class="delimiter">(</span>ord<span class="delimiter">)</span>;
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Checks if the given element is a member of this set.
   *
   * @param x An element to check for membership in this set.
   * @return true if the given element is a member of this set.
   */</span>
  public <span class="keyword">final</span> boolean <a title="(x: A)Boolean" id="19576">member</a><span class="delimiter">(</span><span class="keyword">final</span> <a href="#10325" title="A">A</a> <a title="A" id="30247">x</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">return</span> !isEmpty<span class="delimiter">(</span><span class="delimiter">)</span> &amp;&amp; <span class="delimiter">(</span>ord.isLessThan<span class="delimiter">(</span>x, head<span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span> &amp;&amp; l<span class="delimiter">(</span><span class="delimiter">)</span>.member<span class="delimiter">(</span>x<span class="delimiter">)</span> || ord.eq<span class="delimiter">(</span>head<span class="delimiter">(</span><span class="delimiter">)</span>, x<span class="delimiter">)</span> || r<span class="delimiter">(</span><span class="delimiter">)</span>.member<span class="delimiter">(</span>x<span class="delimiter">)</span><span class="delimiter">)</span>;
  <span class="delimiter">}</span>


  <span class="comment">/**
   * First-class membership check.
   *
   * @return A function that returns true if the given element if a member of the given set.
   */</span>
  public static &lt;<a title="Nothing" id="30129">A</a>&gt; F&lt;<a href="#10324" title="fj.data.Set">Set</a>&lt;<a href="#30129" title="A">A</a>&gt;, F&lt;<a href="#30129" title="A">A</a>, Boolean&gt;&gt; <a title="[A]()fj.F[fj.data.Set[A],fj.F[A,java.lang.Boolean]]" id="30127">member</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">return</span> curry<span class="delimiter">(</span><span class="keyword">new</span> F2&lt;Set&lt;A&gt;, A, Boolean&gt;<span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      public Boolean f<span class="delimiter">(</span><span class="keyword">final</span> Set&lt;A&gt; s, <span class="keyword">final</span> A a<span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="keyword">return</span> s.member<span class="delimiter">(</span>a<span class="delimiter">)</span>;
      <span class="delimiter">}</span>
    <span class="delimiter">}</span><span class="delimiter">)</span>;
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Inserts the given element into this set.
   *
   * @param x An element to insert into this set.
   * @return A new set with the given element inserted.
   */</span>
  public <span class="keyword">final</span> <a href="#10324" title="fj.data.Set">Set</a>&lt;<a href="#10325" title="A">A</a>&gt; <a title="(x: A)fj.data.Set[A]" id="19577">insert</a><span class="delimiter">(</span><span class="keyword">final</span> <a href="#10325" title="A">A</a> <a title="A" id="30249">x</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">return</span> ins<span class="delimiter">(</span>x<span class="delimiter">)</span>.makeBlack<span class="delimiter">(</span><span class="delimiter">)</span>;
  <span class="delimiter">}</span>

  <span class="comment">/**
   * First-class insertion function.
   *
   * @return A function that inserts a given element into a given set.
   */</span>
  public static &lt;<a title="Nothing" id="30132">A</a>&gt; F&lt;<a href="#30132" title="A">A</a>, F&lt;<a href="#10324" title="fj.data.Set">Set</a>&lt;<a href="#30132" title="A">A</a>&gt;, <a href="#10324" title="fj.data.Set">Set</a>&lt;<a href="#30132" title="A">A</a>&gt;&gt;&gt; <a title="[A]()fj.F[A,fj.F[fj.data.Set[A],fj.data.Set[A]]]" id="30130">insert</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">return</span> curry<span class="delimiter">(</span><span class="keyword">new</span> F2&lt;A, Set&lt;A&gt;, Set&lt;A&gt;&gt;<span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      public Set&lt;A&gt; f<span class="delimiter">(</span><span class="keyword">final</span> A a, <span class="keyword">final</span> Set&lt;A&gt; set<span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="keyword">return</span> set.insert<span class="delimiter">(</span>a<span class="delimiter">)</span>;
      <span class="delimiter">}</span>
    <span class="delimiter">}</span><span class="delimiter">)</span>;
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <a href="#10324" title="fj.data.Set">Set</a>&lt;<a href="#10325" title="A">A</a>&gt; <a title="(x: A)fj.data.Set[A]" id="19578">ins</a><span class="delimiter">(</span><span class="keyword">final</span> <a href="#10325" title="A">A</a> <a title="A" id="30251">x</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">return</span> isEmpty<span class="delimiter">(</span><span class="delimiter">)</span>
           ? <span class="keyword">new</span> Tree&lt;A&gt;<span class="delimiter">(</span>ord, Color.R, empty<span class="delimiter">(</span>ord<span class="delimiter">)</span>, x, empty<span class="delimiter">(</span>ord<span class="delimiter">)</span><span class="delimiter">)</span>
           : ord.isLessThan<span class="delimiter">(</span>x, head<span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
             ? balance<span class="delimiter">(</span>ord, color<span class="delimiter">(</span><span class="delimiter">)</span>, l<span class="delimiter">(</span><span class="delimiter">)</span>.ins<span class="delimiter">(</span>x<span class="delimiter">)</span>, head<span class="delimiter">(</span><span class="delimiter">)</span>, r<span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
             : ord.eq<span class="delimiter">(</span>x, head<span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
               ? <span class="keyword">new</span> Tree&lt;A&gt;<span class="delimiter">(</span>ord, color<span class="delimiter">(</span><span class="delimiter">)</span>, l<span class="delimiter">(</span><span class="delimiter">)</span>, x, r<span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
               : balance<span class="delimiter">(</span>ord, color<span class="delimiter">(</span><span class="delimiter">)</span>, l<span class="delimiter">(</span><span class="delimiter">)</span>, head<span class="delimiter">(</span><span class="delimiter">)</span>, r<span class="delimiter">(</span><span class="delimiter">)</span>.ins<span class="delimiter">(</span>x<span class="delimiter">)</span><span class="delimiter">)</span>;
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <a href="#10324" title="fj.data.Set">Set</a>&lt;<a href="#10325" title="A">A</a>&gt; <a title="()fj.data.Set[A]" id="19579">makeBlack</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">return</span> <span class="keyword">new</span> Tree&lt;A&gt;<span class="delimiter">(</span>ord, Color.B, l<span class="delimiter">(</span><span class="delimiter">)</span>, head<span class="delimiter">(</span><span class="delimiter">)</span>, r<span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>;
  <span class="delimiter">}</span>

  @SuppressWarnings<span class="delimiter">(</span><span class="delimiter">{</span><span class="string">&quot;SuspiciousNameCombination&quot;</span><span class="delimiter">}</span><span class="delimiter">)</span>
  <span class="keyword">private</span> static &lt;<a title="Nothing" id="30135">A</a>&gt; Tree&lt;<a href="#30135" title="A">A</a>&gt; <a title="[A](o: fj.Ord[A], a: fj.data.Set[A], x: A, b: fj.data.Set[A], y: A, c: fj.data.Set[A], z: A, d: fj.data.Set[A])fj.data.Set.Tree[A]" id="30133">tr</a><span class="delimiter">(</span><span class="keyword">final</span> Ord&lt;<a href="#30135" title="A">A</a>&gt; <a title="fj.Ord[A]" id="30175">o</a>,
                                <span class="keyword">final</span> <a href="#10324" title="fj.data.Set">Set</a>&lt;<a href="#30135" title="A">A</a>&gt; <a title="fj.data.Set[A]" id="30176">a</a>, <span class="keyword">final</span> <a href="#30135" title="A">A</a> <a title="A" id="30177">x</a>, <span class="keyword">final</span> <a href="#10324" title="fj.data.Set">Set</a>&lt;<a href="#30135" title="A">A</a>&gt; <a title="fj.data.Set[A]" id="30178">b</a>,
                                <span class="keyword">final</span> <a href="#30135" title="A">A</a> <a title="A" id="30179">y</a>,
                                <span class="keyword">final</span> <a href="#10324" title="fj.data.Set">Set</a>&lt;<a href="#30135" title="A">A</a>&gt; <a title="fj.data.Set[A]" id="30180">c</a>, <span class="keyword">final</span> <a href="#30135" title="A">A</a> <a title="A" id="30181">z</a>, <span class="keyword">final</span> <a href="#10324" title="fj.data.Set">Set</a>&lt;<a href="#30135" title="A">A</a>&gt; <a title="fj.data.Set[A]" id="30182">d</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">return</span> <span class="keyword">new</span> Tree&lt;A&gt;<span class="delimiter">(</span>o, Color.R, <span class="keyword">new</span> Tree&lt;A&gt;<span class="delimiter">(</span>o, Color.B, a, x, b<span class="delimiter">)</span>, y, <span class="keyword">new</span> Tree&lt;A&gt;<span class="delimiter">(</span>o, Color.B, c, z, d<span class="delimiter">)</span><span class="delimiter">)</span>;
  <span class="delimiter">}</span>

  <span class="keyword">private</span> static &lt;<a title="Nothing" id="30138">A</a>&gt; <a href="#10324" title="fj.data.Set">Set</a>&lt;<a href="#30138" title="A">A</a>&gt; <a title="[A](ord: fj.Ord[A], c: fj.data.Set.Color, l: fj.data.Set[A], h: A, r: fj.data.Set[A])fj.data.Set[A]" id="30136">balance</a><span class="delimiter">(</span><span class="keyword">final</span> Ord&lt;<a href="#30138" title="A">A</a>&gt; <a title="fj.Ord[A]" id="30201">ord</a>, <span class="keyword">final</span> Color <a title="fj.data.Set.Color" id="30202">c</a>, <span class="keyword">final</span> <a href="#10324" title="fj.data.Set">Set</a>&lt;<a href="#30138" title="A">A</a>&gt; <a title="fj.data.Set[A]" id="30203">l</a>, <span class="keyword">final</span> <a href="#30138" title="A">A</a> <a title="A" id="30204">h</a>, <span class="keyword">final</span> <a href="#10324" title="fj.data.Set">Set</a>&lt;<a href="#30138" title="A">A</a>&gt; <a title="fj.data.Set[A]" id="30205">r</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">return</span> c == Color.B &amp;&amp; l.isTR<span class="delimiter">(</span><span class="delimiter">)</span> &amp;&amp; l.l<span class="delimiter">(</span><span class="delimiter">)</span>.isTR<span class="delimiter">(</span><span class="delimiter">)</span> ? tr<span class="delimiter">(</span>ord, l.l<span class="delimiter">(</span><span class="delimiter">)</span>.l<span class="delimiter">(</span><span class="delimiter">)</span>, l.l<span class="delimiter">(</span><span class="delimiter">)</span>.head<span class="delimiter">(</span><span class="delimiter">)</span>, l.l<span class="delimiter">(</span><span class="delimiter">)</span>.r<span class="delimiter">(</span><span class="delimiter">)</span>, l.head<span class="delimiter">(</span><span class="delimiter">)</span>, l.r<span class="delimiter">(</span><span class="delimiter">)</span>, h, r<span class="delimiter">)</span> : c == Color.B &amp;&amp; l.isTR<span class="delimiter">(</span><span class="delimiter">)</span> &amp;&amp; l.r<span class="delimiter">(</span><span class="delimiter">)</span>.isTR<span class="delimiter">(</span><span class="delimiter">)</span> ? tr<span class="delimiter">(</span>ord, l.l<span class="delimiter">(</span><span class="delimiter">)</span>, l.head<span class="delimiter">(</span><span class="delimiter">)</span>, l.r<span class="delimiter">(</span><span class="delimiter">)</span>.l<span class="delimiter">(</span><span class="delimiter">)</span>, l.r<span class="delimiter">(</span><span class="delimiter">)</span>.head<span class="delimiter">(</span><span class="delimiter">)</span>, l.r<span class="delimiter">(</span><span class="delimiter">)</span>.r<span class="delimiter">(</span><span class="delimiter">)</span>, h, r<span class="delimiter">)</span> : c == Color.B &amp;&amp; r.isTR<span class="delimiter">(</span><span class="delimiter">)</span> &amp;&amp; r.l<span class="delimiter">(</span><span class="delimiter">)</span>.isTR<span class="delimiter">(</span><span class="delimiter">)</span> ? tr<span class="delimiter">(</span>ord, l, h, r.l<span class="delimiter">(</span><span class="delimiter">)</span>.l<span class="delimiter">(</span><span class="delimiter">)</span>, r.l<span class="delimiter">(</span><span class="delimiter">)</span>.head<span class="delimiter">(</span><span class="delimiter">)</span>, r.l<span class="delimiter">(</span><span class="delimiter">)</span>.r<span class="delimiter">(</span><span class="delimiter">)</span>, r.head<span class="delimiter">(</span><span class="delimiter">)</span>, r.r<span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span> : c == Color.B &amp;&amp; r.isTR<span class="delimiter">(</span><span class="delimiter">)</span> &amp;&amp; r.r<span class="delimiter">(</span><span class="delimiter">)</span>.isTR<span class="delimiter">(</span><span class="delimiter">)</span> ? tr<span class="delimiter">(</span>ord, l, h, r.l<span class="delimiter">(</span><span class="delimiter">)</span>, r.head<span class="delimiter">(</span><span class="delimiter">)</span>, r.r<span class="delimiter">(</span><span class="delimiter">)</span>.l<span class="delimiter">(</span><span class="delimiter">)</span>, r.r<span class="delimiter">(</span><span class="delimiter">)</span>.head<span class="delimiter">(</span><span class="delimiter">)</span>, r.r<span class="delimiter">(</span><span class="delimiter">)</span>.r<span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span> : <span class="keyword">new</span> Tree&lt;A&gt;<span class="delimiter">(</span>ord, c, l, h, r<span class="delimiter">)</span>;
  <span class="delimiter">}</span>

  <span class="keyword">private</span> boolean <a title="()Boolean" id="19580">isTR</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">return</span> !isEmpty<span class="delimiter">(</span><span class="delimiter">)</span> &amp;&amp; color<span class="delimiter">(</span><span class="delimiter">)</span> == Color.R;
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Returns an iterator over this set.
   *
   * @return an iterator over this set.
   */</span>
  public <span class="keyword">final</span> Iterator&lt;<a href="#10325" title="A">A</a>&gt; <a title="()java.util.Iterator[A]" id="19581">iterator</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">return</span> toStream<span class="delimiter">(</span><span class="delimiter">)</span>.iterator<span class="delimiter">(</span><span class="delimiter">)</span>;
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Returns a set with a single element.
   *
   * @param o An order for the type of element.
   * @param a An element to put in a set.
   * @return A new set with the given element in it.
   */</span>
  public static &lt;<a title="Nothing" id="30141">A</a>&gt; <a href="#10324" title="fj.data.Set">Set</a>&lt;<a href="#30141" title="A">A</a>&gt; <a title="[A](o: fj.Ord[A], a: A)fj.data.Set[A]" id="30139">single</a><span class="delimiter">(</span><span class="keyword">final</span> Ord&lt;<a href="#30141" title="A">A</a>&gt; <a title="fj.Ord[A]" id="30212">o</a>, <span class="keyword">final</span> <a href="#30141" title="A">A</a> <a title="A" id="30213">a</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">return</span> empty<span class="delimiter">(</span>o<span class="delimiter">)</span>.insert<span class="delimiter">(</span>a<span class="delimiter">)</span>;
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Maps the given function across this set.
   *
   * @param o An order for the elements of the new set.
   * @param f A function to map across this set.
   * @return The set of the results of applying the given function to the elements of this set.
   */</span>
  public <span class="keyword">final</span> &lt;<a title="Nothing" id="19584">B</a>&gt; <a href="#10324" title="fj.data.Set">Set</a>&lt;<a href="#19584" title="B">B</a>&gt; <a title="[B](o: fj.Ord[B], f: fj.F[A,B])fj.data.Set[B]" id="19582">map</a><span class="delimiter">(</span><span class="keyword">final</span> Ord&lt;<a href="#19584" title="B">B</a>&gt; <a title="fj.Ord[B]" id="30256">o</a>, <span class="keyword">final</span> F&lt;<a href="#10325" title="A">A</a>, <a href="#19584" title="B">B</a>&gt; <a title="fj.F[A,B]" id="30257">f</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">return</span> iterableSet<span class="delimiter">(</span>o, toStream<span class="delimiter">(</span><span class="delimiter">)</span>.map<span class="delimiter">(</span>f<span class="delimiter">)</span><span class="delimiter">)</span>;
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Folds this Set using the given monoid.
   *
   * @param f A transformation from this Set's elements, to the monoid.
   * @param m The monoid to fold this Set with.
   * @return The result of folding the Set with the given monoid.
   */</span>
  public <span class="keyword">final</span> &lt;<a title="Nothing" id="19587">B</a>&gt; <a href="#19587" title="B">B</a> <a title="[B](f: fj.F[A,B], m: fj.Monoid[B])B" id="19585">foldMap</a><span class="delimiter">(</span><span class="keyword">final</span> F&lt;<a href="#10325" title="A">A</a>, <a href="#19587" title="B">B</a>&gt; <a title="fj.F[A,B]" id="30261">f</a>, <span class="keyword">final</span> Monoid&lt;<a href="#19587" title="B">B</a>&gt; <a title="fj.Monoid[B]" id="30262">m</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">return</span> isEmpty<span class="delimiter">(</span><span class="delimiter">)</span> ?
           m.zero<span class="delimiter">(</span><span class="delimiter">)</span> :
           m.sum<span class="delimiter">(</span>m.sum<span class="delimiter">(</span>r<span class="delimiter">(</span><span class="delimiter">)</span>.foldMap<span class="delimiter">(</span>f, m<span class="delimiter">)</span>, f.f<span class="delimiter">(</span>head<span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>, l<span class="delimiter">(</span><span class="delimiter">)</span>.foldMap<span class="delimiter">(</span>f, m<span class="delimiter">)</span><span class="delimiter">)</span>;
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Returns a list representation of this set.
   *
   * @return a list representation of this set.
   */</span>
  public <span class="keyword">final</span> <a href="List.java.html#10232" title="fj.data.List">List</a>&lt;<a href="#10325" title="A">A</a>&gt; <a title="()fj.data.List[A]" id="19588">toList</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">return</span> foldMap<span class="delimiter">(</span>List.cons<span class="delimiter">(</span>List.&lt;A&gt;nil<span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>, Monoid.&lt;A&gt;listMonoid<span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>;
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Returns a stream representation of this set.
   *
   * @return a stream representation of this set.
   */</span>
  public <span class="keyword">final</span> <a href="Stream.java.html#10365" title="fj.data.Stream">Stream</a>&lt;<a href="#10325" title="A">A</a>&gt; <a title="()fj.data.Stream[A]" id="19589">toStream</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">return</span> foldMap<span class="delimiter">(</span>Stream.&lt;A&gt;single<span class="delimiter">(</span><span class="delimiter">)</span>, Monoid.&lt;A&gt;streamMonoid<span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>;
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Binds the given function across this set.
   *
   * @param o An order for the elements of the target set.
   * @param f A function to bind across this set.
   * @return A new set after applying the given function and joining the resulting sets.
   */</span>
  public <span class="keyword">final</span> &lt;<a title="Nothing" id="19592">B</a>&gt; <a href="#10324" title="fj.data.Set">Set</a>&lt;<a href="#19592" title="B">B</a>&gt; <a title="[B](o: fj.Ord[B], f: fj.F[A,fj.data.Set[B]])fj.data.Set[B]" id="19590">bind</a><span class="delimiter">(</span><span class="keyword">final</span> Ord&lt;<a href="#19592" title="B">B</a>&gt; <a title="fj.Ord[B]" id="30268">o</a>, <span class="keyword">final</span> F&lt;<a href="#10325" title="A">A</a>, <a href="#10324" title="fj.data.Set">Set</a>&lt;<a href="#19592" title="B">B</a>&gt;&gt; <a title="fj.F[A,fj.data.Set[B]]" id="30269">f</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">return</span> join<span class="delimiter">(</span>o, map<span class="delimiter">(</span>Ord.setOrd<span class="delimiter">(</span>o<span class="delimiter">)</span>, f<span class="delimiter">)</span><span class="delimiter">)</span>;
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Add all the elements of the given set to this set.
   *
   * @param s A set to add to this set.
   * @return A new set containing all elements of both sets.
   */</span>
  public <span class="keyword">final</span> <a href="#10324" title="fj.data.Set">Set</a>&lt;<a href="#10325" title="A">A</a>&gt; <a title="(s: fj.data.Set[A])fj.data.Set[A]" id="19593">union</a><span class="delimiter">(</span><span class="keyword">final</span> <a href="#10324" title="fj.data.Set">Set</a>&lt;<a href="#10325" title="A">A</a>&gt; <a title="fj.data.Set[A]" id="30273">s</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">return</span> iterableSet<span class="delimiter">(</span>ord, s.toStream<span class="delimiter">(</span><span class="delimiter">)</span>.append<span class="delimiter">(</span>toStream<span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>;
  <span class="delimiter">}</span>
  
  <span class="comment">/**
   * A first class function for {@link #union(Set)}.
   * 
   * @return A function that adds all the elements of one set to another set.
   * @see #union(Set)
   */</span>
  public static &lt;<a title="Nothing" id="30144">A</a>&gt; F&lt;<a href="#10324" title="fj.data.Set">Set</a>&lt;<a href="#30144" title="A">A</a>&gt;, F&lt;<a href="#10324" title="fj.data.Set">Set</a>&lt;<a href="#30144" title="A">A</a>&gt;, <a href="#10324" title="fj.data.Set">Set</a>&lt;<a href="#30144" title="A">A</a>&gt;&gt;&gt; <a title="[A]()fj.F[fj.data.Set[A],fj.F[fj.data.Set[A],fj.data.Set[A]]]" id="30142">union</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">return</span> curry<span class="delimiter">(</span><span class="keyword">new</span> F2&lt;Set&lt;A&gt;, Set&lt;A&gt;, Set&lt;A&gt;&gt;<span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      public Set&lt;A&gt; f<span class="delimiter">(</span><span class="keyword">final</span> Set&lt;A&gt; s1, <span class="keyword">final</span> Set&lt;A&gt; s2<span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="keyword">return</span> s1.union<span class="delimiter">(</span>s2<span class="delimiter">)</span>;
      <span class="delimiter">}</span>
    <span class="delimiter">}</span><span class="delimiter">)</span>;
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Filters elements from this set by returning only elements which produce &lt;code&gt;true&lt;/code&gt;
   * when the given function is applied to them.
   *
   * @param f The predicate function to filter on.
   * @return A new set whose elements all match the given predicate.
   */</span>
  public <span class="keyword">final</span> <a href="#10324" title="fj.data.Set">Set</a>&lt;<a href="#10325" title="A">A</a>&gt; <a title="(f: fj.F[A,java.lang.Boolean])fj.data.Set[A]" id="19594">filter</a><span class="delimiter">(</span><span class="keyword">final</span> F&lt;<a href="#10325" title="A">A</a>, Boolean&gt; <a title="fj.F[A,java.lang.Boolean]" id="30275">f</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">return</span> iterableSet<span class="delimiter">(</span>ord, toStream<span class="delimiter">(</span><span class="delimiter">)</span>.filter<span class="delimiter">(</span>f<span class="delimiter">)</span><span class="delimiter">)</span>;
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Deletes the given element from this set.
   *
   * @param a an element to remove.
   * @return A new set containing all the elements of this set, except the given element.
   */</span>
  public <span class="keyword">final</span> <a href="#10324" title="fj.data.Set">Set</a>&lt;<a href="#10325" title="A">A</a>&gt; <a title="(a: A)fj.data.Set[A]" id="19595">delete</a><span class="delimiter">(</span><span class="keyword">final</span> <a href="#10325" title="A">A</a> <a title="A" id="30277">a</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">return</span> minus<span class="delimiter">(</span>single<span class="delimiter">(</span>ord, a<span class="delimiter">)</span><span class="delimiter">)</span>;
  <span class="delimiter">}</span>

  <span class="comment">/**
   * First-class deletion function.
   *
   * @return A function that deletes a given element from a given set.
   */</span>
  public <span class="keyword">final</span> F&lt;<a href="#10325" title="A">A</a>, F&lt;<a href="#10324" title="fj.data.Set">Set</a>&lt;<a href="#10325" title="A">A</a>&gt;, <a href="#10324" title="fj.data.Set">Set</a>&lt;<a href="#10325" title="A">A</a>&gt;&gt;&gt; <a title="()fj.F[A,fj.F[fj.data.Set[A],fj.data.Set[A]]]" id="19596">delete</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">return</span> curry<span class="delimiter">(</span><span class="keyword">new</span> F2&lt;A, Set&lt;A&gt;, Set&lt;A&gt;&gt;<span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      public Set&lt;A&gt; f<span class="delimiter">(</span><span class="keyword">final</span> A a, <span class="keyword">final</span> Set&lt;A&gt; set<span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="keyword">return</span> set.delete<span class="delimiter">(</span>a<span class="delimiter">)</span>;
      <span class="delimiter">}</span>
    <span class="delimiter">}</span><span class="delimiter">)</span>;
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Remove all elements from this set that do not occur in the given set.
   *
   * @param s A set of elements to retain.
   * @return A new set which is the intersection of this set and the given set.
   */</span>
  public <span class="keyword">final</span> <a href="#10324" title="fj.data.Set">Set</a>&lt;<a href="#10325" title="A">A</a>&gt; <a title="(s: fj.data.Set[A])fj.data.Set[A]" id="19597">intersect</a><span class="delimiter">(</span><span class="keyword">final</span> <a href="#10324" title="fj.data.Set">Set</a>&lt;<a href="#10325" title="A">A</a>&gt; <a title="fj.data.Set[A]" id="30280">s</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">return</span> filter<span class="delimiter">(</span>Set.&lt;A&gt;member<span class="delimiter">(</span><span class="delimiter">)</span>.f<span class="delimiter">(</span>s<span class="delimiter">)</span><span class="delimiter">)</span>;
  <span class="delimiter">}</span>
  
  <span class="comment">/**
   * A first class function for {@link #intersect(Set)}.
   * 
   * @return A function that intersects two given sets.
   * @see #intersect(Set)
   */</span>
  public static &lt;<a title="Nothing" id="30147">A</a>&gt; F&lt;<a href="#10324" title="fj.data.Set">Set</a>&lt;<a href="#30147" title="A">A</a>&gt;, F&lt;<a href="#10324" title="fj.data.Set">Set</a>&lt;<a href="#30147" title="A">A</a>&gt;, <a href="#10324" title="fj.data.Set">Set</a>&lt;<a href="#30147" title="A">A</a>&gt;&gt;&gt; <a title="[A]()fj.F[fj.data.Set[A],fj.F[fj.data.Set[A],fj.data.Set[A]]]" id="30145">intersect</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">return</span> curry<span class="delimiter">(</span><span class="keyword">new</span> F2&lt;Set&lt;A&gt;, Set&lt;A&gt;, Set&lt;A&gt;&gt;<span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      public Set&lt;A&gt; f<span class="delimiter">(</span><span class="keyword">final</span> Set&lt;A&gt; s1, <span class="keyword">final</span> Set&lt;A&gt; s2<span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="keyword">return</span> s1.intersect<span class="delimiter">(</span>s2<span class="delimiter">)</span>;
      <span class="delimiter">}</span>
    <span class="delimiter">}</span><span class="delimiter">)</span>;
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Remove all elements from this set that occur in the given set.
   *
   * @param s A set of elements to delete.
   * @return A new set which contains only the elements of this set that do not occur in the given set.
   */</span>
  public <span class="keyword">final</span> <a href="#10324" title="fj.data.Set">Set</a>&lt;<a href="#10325" title="A">A</a>&gt; <a title="(s: fj.data.Set[A])fj.data.Set[A]" id="19598">minus</a><span class="delimiter">(</span><span class="keyword">final</span> <a href="#10324" title="fj.data.Set">Set</a>&lt;<a href="#10325" title="A">A</a>&gt; <a title="fj.data.Set[A]" id="30282">s</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">return</span> filter<span class="delimiter">(</span>compose<span class="delimiter">(</span>not, Set.&lt;A&gt;member<span class="delimiter">(</span><span class="delimiter">)</span>.f<span class="delimiter">(</span>s<span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>;
  <span class="delimiter">}</span>
  
  <span class="comment">/**
   * A first class function for {@link #minus(Set)}.
   * 
   * @return A function that removes all elements of one set from another set.
   * @see #minus(Set)
   */</span>
  public static &lt;<a title="Nothing" id="30150">A</a>&gt; F&lt;<a href="#10324" title="fj.data.Set">Set</a>&lt;<a href="#30150" title="A">A</a>&gt;, F&lt;<a href="#10324" title="fj.data.Set">Set</a>&lt;<a href="#30150" title="A">A</a>&gt;, <a href="#10324" title="fj.data.Set">Set</a>&lt;<a href="#30150" title="A">A</a>&gt;&gt;&gt; <a title="[A]()fj.F[fj.data.Set[A],fj.F[fj.data.Set[A],fj.data.Set[A]]]" id="30148">minus</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">return</span> curry<span class="delimiter">(</span><span class="keyword">new</span> F2&lt;Set&lt;A&gt;, Set&lt;A&gt;, Set&lt;A&gt;&gt;<span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      public Set&lt;A&gt; f<span class="delimiter">(</span><span class="keyword">final</span> Set&lt;A&gt; s1, <span class="keyword">final</span> Set&lt;A&gt; s2<span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="keyword">return</span> s1.minus<span class="delimiter">(</span>s2<span class="delimiter">)</span>;
      <span class="delimiter">}</span>
    <span class="delimiter">}</span><span class="delimiter">)</span>;
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Returns the size of this set.
   *
   * @return The number of elements in this set.
   */</span>
  public <span class="keyword">final</span> int <a title="()Int" id="19599">size</a><span class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">final</span> F&lt;A, Integer&gt; one = constant<span class="delimiter">(</span><span class="int">1</span><span class="delimiter">)</span>;
    <span class="keyword">return</span> foldMap<span class="delimiter">(</span>one, Monoid.intAdditionMonoid<span class="delimiter">)</span>;
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Splits this set at the given element. Returns a product-3 of:
   * &lt;ul&gt;
   * &lt;li&gt;A set containing all the elements of this set which are less than the given value.&lt;/li&gt;
   * &lt;li&gt;An option of a value equal to the given value, if one was found in this set, otherwise None.
   * &lt;li&gt;A set containing all the elements of this set which are greater than the given value.&lt;/li&gt;
   * &lt;/ul&gt;
   *
   * @param a A value at which to split this set.
   * @return Two sets and an optional value, where all elements in the first set are less than the given value
   *         and all the elements in the second set are greater than the given value, and the optional value is the
   *         given value if found, otherwise None.
   */</span>
  public <span class="keyword">final</span> P3&lt;<a href="#10324" title="fj.data.Set">Set</a>&lt;<a href="#10325" title="A">A</a>&gt;, <a href="Option.java.html#10291" title="fj.data.Option">Option</a>&lt;<a href="#10325" title="A">A</a>&gt;, <a href="#10324" title="fj.data.Set">Set</a>&lt;<a href="#10325" title="A">A</a>&gt;&gt; <a title="(a: A)fj.P3[fj.data.Set[A],fj.data.Option[A],fj.data.Set[A]]" id="19600">split</a><span class="delimiter">(</span><span class="keyword">final</span> <a href="#10325" title="A">A</a> <a title="A" id="30285">a</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">if</span> <span class="delimiter">(</span>isEmpty<span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">return</span> P.p<span class="delimiter">(</span>empty<span class="delimiter">(</span>ord<span class="delimiter">)</span>, Option.&lt;A&gt;none<span class="delimiter">(</span><span class="delimiter">)</span>, empty<span class="delimiter">(</span>ord<span class="delimiter">)</span><span class="delimiter">)</span>;
    <span class="keyword">else</span> <span class="delimiter">{</span>
      <span class="keyword">final</span> A h = head<span class="delimiter">(</span><span class="delimiter">)</span>;
      <span class="keyword">final</span> Ordering i = ord.compare<span class="delimiter">(</span>a, h<span class="delimiter">)</span>;
      <span class="keyword">if</span> <span class="delimiter">(</span>i == LT<span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="keyword">final</span> P3&lt;Set&lt;A&gt;, Option&lt;A&gt;, Set&lt;A&gt;&gt; lg = l<span class="delimiter">(</span><span class="delimiter">)</span>.split<span class="delimiter">(</span>a<span class="delimiter">)</span>;
        <span class="keyword">return</span> P.p<span class="delimiter">(</span>lg._1<span class="delimiter">(</span><span class="delimiter">)</span>, lg._2<span class="delimiter">(</span><span class="delimiter">)</span>, lg._3<span class="delimiter">(</span><span class="delimiter">)</span>.insert<span class="delimiter">(</span>h<span class="delimiter">)</span>.union<span class="delimiter">(</span>r<span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>;
      <span class="delimiter">}</span> <span class="keyword">else</span> <span class="keyword">if</span> <span class="delimiter">(</span>i == GT<span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="keyword">final</span> P3&lt;Set&lt;A&gt;, Option&lt;A&gt;, Set&lt;A&gt;&gt; lg = r<span class="delimiter">(</span><span class="delimiter">)</span>.split<span class="delimiter">(</span>a<span class="delimiter">)</span>;
        <span class="keyword">return</span> P.p<span class="delimiter">(</span>lg._1<span class="delimiter">(</span><span class="delimiter">)</span>.insert<span class="delimiter">(</span>h<span class="delimiter">)</span>.union<span class="delimiter">(</span>l<span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>, lg._2<span class="delimiter">(</span><span class="delimiter">)</span>, lg._3<span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>;
      <span class="delimiter">}</span> <span class="keyword">else</span>
        <span class="keyword">return</span> P.p<span class="delimiter">(</span>l<span class="delimiter">(</span><span class="delimiter">)</span>, some<span class="delimiter">(</span>h<span class="delimiter">)</span>, r<span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>;
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Returns true if this set is a subset of the given set.
   *
   * @param s A set which is a superset of this set if this method returns true.
   * @return true if this set is a subset of the given set.
   */</span>
  public <span class="keyword">final</span> boolean <a title="(s: fj.data.Set[A])Boolean" id="19601">subsetOf</a><span class="delimiter">(</span><span class="keyword">final</span> <a href="#10324" title="fj.data.Set">Set</a>&lt;<a href="#10325" title="A">A</a>&gt; <a title="fj.data.Set[A]" id="30287">s</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">if</span> <span class="delimiter">(</span>isEmpty<span class="delimiter">(</span><span class="delimiter">)</span> || s.isEmpty<span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">return</span> isEmpty<span class="delimiter">(</span><span class="delimiter">)</span>;
    <span class="keyword">else</span> <span class="delimiter">{</span>
      <span class="keyword">final</span> P3&lt;Set&lt;A&gt;, Option&lt;A&gt;, Set&lt;A&gt;&gt; find = s.split<span class="delimiter">(</span>head<span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>;
      <span class="keyword">return</span> find._2<span class="delimiter">(</span><span class="delimiter">)</span>.isSome<span class="delimiter">(</span><span class="delimiter">)</span> &amp;&amp; l<span class="delimiter">(</span><span class="delimiter">)</span>.subsetOf<span class="delimiter">(</span>find._1<span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span> &amp;&amp; r<span class="delimiter">(</span><span class="delimiter">)</span>.subsetOf<span class="delimiter">(</span>find._3<span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>;
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Join a set of sets into a single set.
   *
   * @param s A set of sets.
   * @param o An order for the elements of the new set.
   * @return A new set which is the join of the given set of sets.
   */</span>
  public static &lt;<a title="Nothing" id="30153">A</a>&gt; <a href="#10324" title="fj.data.Set">Set</a>&lt;<a href="#30153" title="A">A</a>&gt; <a title="[A](o: fj.Ord[A], s: fj.data.Set[fj.data.Set[A]])fj.data.Set[A]" id="30151">join</a><span class="delimiter">(</span><span class="keyword">final</span> Ord&lt;<a href="#30153" title="A">A</a>&gt; <a title="fj.Ord[A]" id="30220">o</a>, <span class="keyword">final</span> <a href="#10324" title="fj.data.Set">Set</a>&lt;<a href="#10324" title="fj.data.Set">Set</a>&lt;<a href="#30153" title="A">A</a>&gt;&gt; <a title="fj.data.Set[fj.data.Set[A]]" id="30221">s</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">final</span> F&lt;Set&lt;A&gt;, Set&lt;A&gt;&gt; id = identity<span class="delimiter">(</span><span class="delimiter">)</span>;
    <span class="keyword">return</span> s.foldMap<span class="delimiter">(</span>id, Monoid.&lt;A&gt;setMonoid<span class="delimiter">(</span>o<span class="delimiter">)</span><span class="delimiter">)</span>;
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Return the elements of the given iterable as a set.
   *
   * @param o  An order for the elements of the new set.
   * @param as An iterable of elements to add to a set.
   * @return A new set containing the elements of the given iterable.
   */</span>
  public static &lt;<a title="Nothing" id="30156">A</a>&gt; <a href="#10324" title="fj.data.Set">Set</a>&lt;<a href="#30156" title="A">A</a>&gt; <a title="[A](o: fj.Ord[A], as: java.lang.Iterable[A])fj.data.Set[A]" id="30154">iterableSet</a><span class="delimiter">(</span><span class="keyword">final</span> Ord&lt;<a href="#30156" title="A">A</a>&gt; <a title="fj.Ord[A]" id="30225">o</a>, <span class="keyword">final</span> Iterable&lt;<a href="#30156" title="A">A</a>&gt; <a title="java.lang.Iterable[A]" id="30226">as</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    Set&lt;A&gt; s = empty<span class="delimiter">(</span>o<span class="delimiter">)</span>;
    <span class="keyword">for</span> <span class="delimiter">(</span><span class="keyword">final</span> A a : as<span class="delimiter">)</span>
      s = s.insert<span class="delimiter">(</span>a<span class="delimiter">)</span>;
    <span class="keyword">return</span> s;
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Constructs a set from the given elements.
   *
   * @param o  An order for the elements of the new set.
   * @param as The elements to add to a set.
   * @return A new set containing the elements of the given iterable.
   */</span>
  public static &lt;<a title="Nothing" id="30159">A</a>&gt; <a href="#10324" title="fj.data.Set">Set</a>&lt;<a href="#30159" title="A">A</a>&gt; <a title="[A](o: fj.Ord[A], as: &lt;repeated...&gt;[A])fj.data.Set[A]" id="30157">set</a><span class="delimiter">(</span><span class="keyword">final</span> Ord&lt;<a href="#30159" title="A">A</a>&gt; <a title="fj.Ord[A]" id="30230">o</a>, <span class="keyword">final</span> <a href="#30159" title="&lt;repeated...&gt;">A</a> ... <a title="&lt;repeated...&gt;[A]" id="30231">as</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    Set&lt;A&gt; s = empty<span class="delimiter">(</span>o<span class="delimiter">)</span>;
    <span class="keyword">for</span> <span class="delimiter">(</span><span class="keyword">final</span> A a : as<span class="delimiter">)</span>
      s = s.insert<span class="delimiter">(</span>a<span class="delimiter">)</span>;
    <span class="keyword">return</span> s;
  <span class="delimiter">}</span>

<span class="delimiter">}</span>

        </pre>
    </body>
</html>