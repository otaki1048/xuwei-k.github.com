<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>org/scalaquery/ql/extended/DerbyDriver.scala</title>
        <script type="text/javascript" src="../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="keyword">package</span> org.scalaquery.ql.extended

<span class="keyword">import</span> org.scalaquery.SQueryException
<span class="keyword">import</span> org.scalaquery.ql._
<span class="keyword">import</span> org.scalaquery.ql.basic._
<span class="keyword">import</span> org.scalaquery.util._

<span class="comment">/**
 * ScalaQuery driver for Derby/JavaDB.
 *
 * &lt;p&gt;This driver implements the ExtendedProfile with the following
 * limitations:&lt;/p&gt;
 * &lt;ul&gt;
 *   &lt;li&gt;&lt;code&gt;Functions.database&lt;/code&gt; is not available in Derby. ScalaQuery
 *     will return an empty string instead.&lt;/li&gt;
 *   &lt;li&gt;&lt;code&gt;Sequence.curr&lt;/code&gt; to get the current value of a sequence is
 *     not supported by Derby. Trying to generate SQL code which uses this
 *     feature throws a SQueryException.&lt;/li&gt;
 *   &lt;li&gt;Sequence cycling is supported but does not conform to SQL:2008
 *     semantics. Derby cycles back to the START value instead of MINVALUE or
 *     MAXVALUE.&lt;/li&gt;
 * &lt;/ul&gt;
 *
 * @author szeiger
 */</span>
<span class="keyword">class</span> <a title="class DerbyDriver extends java.lang.Object with org.scalaquery.ql.extended.ExtendedProfile with ScalaObject" id="10465">DerbyDriver</a> <a href="#10465" title="ScalaObject" class="keyword">extends</a> <a href="ExtendedProfile.scala.html#10484" title="org.scalaquery.ql.extended.ExtendedProfile">ExtendedProfile</a> <span class="delimiter">{</span> self =&gt;

  <span class="keyword">type</span> <a title="org.scalaquery.ql.extended.ExtendedImplicitConversions[org.scalaquery.ql.extended.DerbyDriver]" id="118875">ImplicitT</a> = <a href="ExtendedProfile.scala.html#10485" title="org.scalaquery.ql.extended.ExtendedImplicitConversions[org.scalaquery.ql.extended.DerbyDriver]">ExtendedImplicitConversions</a><span class="delimiter">[</span>DerbyDriver<span class="delimiter">]</span>
  <span class="keyword">type</span> <a title="org.scalaquery.ql.basic.BasicTypeMapperDelegates" id="118876">TypeMapperDelegatesT</a> = <a href="../basic/BasicTypeMapperDelegates.scala.html#10427" title="org.scalaquery.ql.basic.BasicTypeMapperDelegates">BasicTypeMapperDelegates</a>

  <span class="keyword">val</span> <a title="Implicit extends java.lang.Object with org.scalaquery.ql.extended.ExtendedImplicitConversions[org.scalaquery.ql.extended.DerbyDriver]" id="118877">Implicit</a> = <a href="#118885" title="java.lang.Object with org.scalaquery.ql.extended.ExtendedImplicitConversions[org.scalaquery.ql.extended.DerbyDriver]{}" class="keyword">new</a> <a title="anonymous class $anon extends java.lang.Object with org.scalaquery.ql.extended.ExtendedImplicitConversions[org.scalaquery.ql.extended.DerbyDriver]" id="118885">ExtendedImplicitConversions</a><span class="delimiter">[</span>DerbyDriver<span class="delimiter">]</span> <span class="delimiter">{</span>
    <span class="keyword">implicit</span> <span class="keyword">val</span> <a title="org.scalaquery.ql.extended.DerbyDriver" id="118887">scalaQueryDriver</a> = <a href="#10465" title="org.scalaquery.ql.extended.DerbyDriver">self</a>
  <span class="delimiter">}</span>

  <span class="keyword">val</span> <a title="org.scalaquery.ql.extended.DerbyTypeMapperDelegates" id="118879">typeMapperDelegates</a> = <span title="org.scalaquery.ql.extended.DerbyTypeMapperDelegates" class="keyword">new</span> <a href="#10468" title="org.scalaquery.ql.extended.DerbyTypeMapperDelegates">DerbyTypeMapperDelegates</a>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(query: org.scalaquery.ql.Query[_], nc: org.scalaquery.util.NamingContext)org.scalaquery.ql.extended.DerbyQueryBuilder" id="118881">createQueryBuilder</a><span class="delimiter">(</span><a title="org.scalaquery.ql.Query[_]" id="118901">query</a>: <a href="../Query.scala.html#10200" title="org.scalaquery.ql.Query[_]">Query</a><span class="delimiter">[</span>_<span class="delimiter">]</span>, <a title="org.scalaquery.util.NamingContext" id="118902">nc</a>: <a href="../../util/NamingContext.scala.html#10725" title="org.scalaquery.util.NamingContext">NamingContext</a><span class="delimiter">)</span> = <span title="org.scalaquery.ql.extended.DerbyQueryBuilder" class="keyword">new</span> <a href="#10471" title="org.scalaquery.ql.extended.DerbyQueryBuilder">DerbyQueryBuilder</a><span class="delimiter">(</span><a href="#118901" title="org.scalaquery.ql.Query[_]">query</a>, <a href="#118902" title="org.scalaquery.util.NamingContext">nc</a>, <span title="object None">None</span>, <a href="#10465" title="org.scalaquery.ql.extended.DerbyDriver" class="keyword">this</a><span class="delimiter">)</span>
  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(table: org.scalaquery.ql.basic.AbstractBasicTable[_])org.scalaquery.ql.DDL" id="118882">buildTableDDL</a><span class="delimiter">(</span><a title="org.scalaquery.ql.basic.AbstractBasicTable[_]" id="118936">table</a>: <a href="../basic/BasicTable.scala.html#10416" title="org.scalaquery.ql.basic.AbstractBasicTable[_]">AbstractBasicTable</a><span class="delimiter">[</span>_<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../DDL.scala.html#9860" title="org.scalaquery.ql.DDL">DDL</a> = <span title="org.scalaquery.ql.extended.DerbyDDLBuilder" class="keyword">new</span> <a href="#10472" title="org.scalaquery.ql.extended.DerbyDDLBuilder">DerbyDDLBuilder</a><span class="delimiter">(</span><a href="#118936" title="org.scalaquery.ql.basic.AbstractBasicTable[_]">table</a>, <a href="#10465" title="org.scalaquery.ql.extended.DerbyDriver" class="keyword">this</a><span class="delimiter">)</span>.<a href="../basic/BasicDDLBuilder.scala.html#107795" title="=&gt; org.scalaquery.ql.DDL">buildDDL</a>
  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(seq: org.scalaquery.ql.Sequence[_])org.scalaquery.ql.DDL" id="118883">buildSequenceDDL</a><span class="delimiter">(</span><a title="org.scalaquery.ql.Sequence[_]" id="118956">seq</a>: <a href="../Sequence.scala.html#10233" title="org.scalaquery.ql.Sequence[_]">Sequence</a><span class="delimiter">[</span>_<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../DDL.scala.html#9860" title="org.scalaquery.ql.DDL">DDL</a> = <span title="org.scalaquery.ql.extended.DerbySequenceDDLBuilder[_$3]" class="keyword">new</span> <a href="#10473" title="org.scalaquery.ql.extended.DerbySequenceDDLBuilder[_$3]">DerbySequenceDDLBuilder</a><span class="delimiter">(</span><a href="#118956" title="org.scalaquery.ql.Sequence[_]">seq</a>, <a href="#10465" title="org.scalaquery.ql.extended.DerbyDriver" class="keyword">this</a><span class="delimiter">)</span>.<a href="#118967" title="=&gt; org.scalaquery.ql.DDL">buildDDL</a>
<span class="delimiter">}</span>

<span class="keyword">object</span> <a title="object org.scalaquery.ql.extended.DerbyDriver" id="10466">DerbyDriver</a> <span title="ScalaObject" class="keyword">extends</span> <a href="#10465" title="org.scalaquery.ql.extended.DerbyDriver">DerbyDriver</a>

<span class="keyword">class</span> <a title="class DerbyTypeMapperDelegates extends java.lang.Object with org.scalaquery.ql.basic.BasicTypeMapperDelegates with ScalaObject" id="10468">DerbyTypeMapperDelegates</a> <a href="#10468" title="ScalaObject" class="keyword">extends</a> <a href="../basic/BasicTypeMapperDelegates.scala.html#10427" title="org.scalaquery.ql.basic.BasicTypeMapperDelegates">BasicTypeMapperDelegates</a> <span class="delimiter">{</span>
  <span class="keyword">import</span> <a href="#10469" title="object org.scalaquery.ql.extended.DerbyTypeMapperDelegates">DerbyTypeMapperDelegates</a>._
  <span class="keyword">override</span> <span class="keyword">val</span> <a title="org.scalaquery.ql.extended.DerbyTypeMapperDelegates.BooleanTypeMapperDelegate" id="118899">booleanTypeMapperDelegate</a> = <span title="org.scalaquery.ql.extended.DerbyTypeMapperDelegates.BooleanTypeMapperDelegate" class="keyword">new</span> <a href="#118983" title="org.scalaquery.ql.extended.DerbyTypeMapperDelegates.BooleanTypeMapperDelegate">BooleanTypeMapperDelegate</a>
<span class="delimiter">}</span>

<span class="keyword">object</span> <a title="object org.scalaquery.ql.extended.DerbyTypeMapperDelegates" id="10469">DerbyTypeMapperDelegates</a> <span title="ScalaObject" class="delimiter">{</span>
  <span class="comment">/* Derby does not have a proper BOOLEAN type. The suggested workaround is
   * SMALLINT with constants 1 and 0 for TRUE and FALSE. */</span>
  <span class="keyword">class</span> <a title="class BooleanTypeMapperDelegate extends org.scalaquery.ql.basic.BasicTypeMapperDelegates.BooleanTypeMapperDelegate with ScalaObject" id="118983">BooleanTypeMapperDelegate</a> <a href="#118983" title="ScalaObject" class="keyword">extends</a> <a href="../basic/BasicTypeMapperDelegates.scala.html#10428" title="object org.scalaquery.ql.basic.BasicTypeMapperDelegates">BasicTypeMapperDelegates</a>.<a href="../basic/BasicTypeMapperDelegates.scala.html#107108" title="org.scalaquery.ql.basic.BasicTypeMapperDelegates.BooleanTypeMapperDelegate">BooleanTypeMapperDelegate</a> <span class="delimiter">{</span>
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; java.lang.String" id="118985">sqlTypeName</a> = <span title="java.lang.String(&quot;SMALLINT&quot;)" class="string">&quot;SMALLINT&quot;</span>
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="(value: Boolean)String" id="118986">valueToSQLLiteral</a><span class="delimiter">(</span><a title="Boolean" id="118992">value</a>: <span title="Boolean">Boolean</span><span class="delimiter">)</span> = <span title="String" class="keyword">if</span><span class="delimiter">(</span><a href="#118992" title="Boolean">value</a><span class="delimiter">)</span> <span title="java.lang.String(&quot;1&quot;)" class="string">&quot;1&quot;</span> <span class="keyword">else</span> <span title="java.lang.String(&quot;0&quot;)" class="string">&quot;0&quot;</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="keyword">class</span> <a title="class DerbyQueryBuilder extends org.scalaquery.ql.basic.BasicQueryBuilder with ScalaObject" id="10471">DerbyQueryBuilder</a><a href="#10471" title="ScalaObject" class="delimiter">(</a><a title="org.scalaquery.ql.Query[_]" id="118927">_query</a>: <a href="../Query.scala.html#10200" title="org.scalaquery.ql.Query[_]">Query</a><span class="delimiter">[</span>_<span class="delimiter">]</span>, <a title="org.scalaquery.util.NamingContext" id="118928">_nc</a>: <a href="../../util/NamingContext.scala.html#10725" title="org.scalaquery.util.NamingContext">NamingContext</a>, <a title="Option[org.scalaquery.ql.basic.BasicQueryBuilder]" id="118929">parent</a>: <span title="Option[org.scalaquery.ql.basic.BasicQueryBuilder]">Option</span><span class="delimiter">[</span>BasicQueryBuilder<span class="delimiter">]</span>, <a title="org.scalaquery.ql.extended.DerbyDriver" id="118930">profile</a>: <a href="#10465" title="org.scalaquery.ql.extended.DerbyDriver">DerbyDriver</a><span class="delimiter">)</span>
<span class="keyword">extends</span> <a href="../basic/BasicQueryBuilder.scala.html#10376" title="org.scalaquery.ql.basic.BasicQueryBuilder">BasicQueryBuilder</a><span class="delimiter">(</span><a href="#118927" title="org.scalaquery.ql.Query[_]">_query</a>, <a href="#118928" title="org.scalaquery.util.NamingContext">_nc</a>, <a href="#118929" title="Option[org.scalaquery.ql.basic.BasicQueryBuilder]">parent</a>, <a href="#118930" title="org.scalaquery.ql.extended.DerbyDriver">profile</a><span class="delimiter">)</span> <span class="delimiter">{</span>

  <span class="keyword">import</span> <a href="ExtendedProfile.scala.html#10489" title="object org.scalaquery.ql.extended.ExtendedQueryOps">ExtendedQueryOps</a>._
  <span class="keyword">import</span> <a href="#118930" title="org.scalaquery.ql.extended.DerbyDriver">profile</a>.<a href="../basic/BasicProfile.scala.html#79191" title="=&gt; org.scalaquery.ql.basic.BasicSQLUtils">sqlUtils</a>._

  <span class="keyword">override</span> <span class="keyword">type</span> <a title="org.scalaquery.ql.extended.DerbyQueryBuilder" id="118918">Self</a> = <a href="#10471" title="org.scalaquery.ql.extended.DerbyQueryBuilder">DerbyQueryBuilder</a>
  <span class="keyword">override</span> <span class="keyword">protected</span> <span class="keyword">val</span> <a title="Boolean" id="118919">mayLimit0</a> = <span title="Boolean(false)" class="keyword">false</span>
  <span class="keyword">override</span> <span class="keyword">protected</span> <span class="keyword">val</span> <a title="Some[java.lang.String]" id="118921">scalarFrom</a> = <span title="(x: java.lang.String)Some[java.lang.String]">Some</span><span class="delimiter">(</span><span title="java.lang.String(&quot;sysibm.sysdummy1&quot;)" class="string">&quot;sysibm.sysdummy1&quot;</span><span class="delimiter">)</span>

  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="(query: org.scalaquery.ql.Query[_], nc: org.scalaquery.util.NamingContext)org.scalaquery.ql.extended.DerbyQueryBuilder" id="118923">createSubQueryBuilder</a><span class="delimiter">(</span><a title="org.scalaquery.ql.Query[_]" id="119010">query</a>: <a href="../Query.scala.html#10200" title="org.scalaquery.ql.Query[_]">Query</a><span class="delimiter">[</span>_<span class="delimiter">]</span>, <a title="org.scalaquery.util.NamingContext" id="119011">nc</a>: <a href="../../util/NamingContext.scala.html#10725" title="org.scalaquery.util.NamingContext">NamingContext</a><span class="delimiter">)</span> =
    <span title="org.scalaquery.ql.extended.DerbyQueryBuilder" class="keyword">new</span> <a href="#10471" title="org.scalaquery.ql.extended.DerbyQueryBuilder">DerbyQueryBuilder</a><span class="delimiter">(</span><a href="#119010" title="org.scalaquery.ql.Query[_]">query</a>, <a href="#119011" title="org.scalaquery.util.NamingContext">nc</a>, <span title="(x: org.scalaquery.ql.extended.DerbyQueryBuilder)Some[org.scalaquery.ql.extended.DerbyQueryBuilder]">Some</span><span class="delimiter">(</span><a href="#10471" title="org.scalaquery.ql.extended.DerbyQueryBuilder" class="keyword">this</a><span class="delimiter">)</span>, <a href="#118930" title="org.scalaquery.ql.extended.DerbyDriver">profile</a><span class="delimiter">)</span>

  <span class="keyword">override</span> <span class="keyword">protected</span> <span class="keyword">def</span> <a title="(c: org.scalaquery.util.Node, b: org.scalaquery.util.SQLBuilder, rename: Boolean, topLevel: Boolean)Unit" id="118924">expr</a><span class="delimiter">(</span><a title="org.scalaquery.util.Node" id="119022">c</a>: <a href="../../util/Node.scala.html#10735" title="org.scalaquery.util.Node">Node</a>, <a title="org.scalaquery.util.SQLBuilder" id="119023">b</a>: <a href="../../util/SQLBuilder.scala.html#10756" title="org.scalaquery.util.SQLBuilder">SQLBuilder</a>, <a title="Boolean" id="119024">rename</a>: <span title="Boolean">Boolean</span>, <a title="Boolean" id="119025">topLevel</a>: <span title="Boolean">Boolean</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    <a href="#119022" title="org.scalaquery.util.Node">c</a> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="comment">/* Convert proper BOOLEANs which should be returned from a SELECT
       * statement into pseudo-boolean SMALLINT values 1 and 0 */</span>
      <span class="keyword">case</span> <a title="Unit" id="119028">c</a>: <a href="../ColumnBase.scala.html#9801" title="org.scalaquery.ql.Column[_]">Column</a><span class="delimiter">[</span>_<span class="delimiter">]</span> <span class="keyword">if</span> <a href="#119025" title="Boolean">topLevel</a> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <span title="=&gt; Boolean">!</span><a href="#119024" title="Boolean">rename</a> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#119023" title="org.scalaquery.util.SQLBuilder">b</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../basic/BasicQueryBuilder.scala.html#103881" title="=&gt; org.scalaquery.util.SQLBuilder">selectSlot</a> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#119028" title="org.scalaquery.ql.Column[_]">c</a>.<a href="../ColumnBase.scala.html#78936" title="(v1: org.scalaquery.ql.basic.BasicProfile)org.scalaquery.ql.TypeMapperDelegate[_]">typeMapper</a><span class="delimiter">(</span><a href="#118930" title="org.scalaquery.ql.extended.DerbyDriver">profile</a><span class="delimiter">)</span> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#118930" title="org.scalaquery.ql.extended.DerbyDriver">profile</a>.<a href="#118879" title="=&gt; org.scalaquery.ql.extended.DerbyTypeMapperDelegates">typeMapperDelegates</a>.<a href="#118899" title="=&gt; org.scalaquery.ql.extended.DerbyTypeMapperDelegates.BooleanTypeMapperDelegate">booleanTypeMapperDelegate</a> =&gt;
        <a href="#119023" title="org.scalaquery.util.SQLBuilder">b</a> <a href="../../util/SQLBuilder.scala.html#103840" title="(s: String)org.scalaquery.util.SQLBuilder">+=</a> <span title="java.lang.String(&quot;case when &quot;)" class="string">&quot;case when &quot;</span>
        <a href="#118925" title="(c: org.scalaquery.util.Node, b: org.scalaquery.util.SQLBuilder)Unit">innerExpr</a><span class="delimiter">(</span><a href="#119028" title="org.scalaquery.ql.Column[_]">c</a>, <a href="#119023" title="org.scalaquery.util.SQLBuilder">b</a><span class="delimiter">)</span>
        <a href="#119023" title="org.scalaquery.util.SQLBuilder">b</a> <a href="../../util/SQLBuilder.scala.html#103840" title="(s: String)org.scalaquery.util.SQLBuilder">+=</a> <span title="java.lang.String(&quot; then 1 else 0 end&quot;)" class="string">&quot; then 1 else 0 end&quot;</span>
      <span class="keyword">case</span> <span title="Unit">_</span> =&gt; <a href="#10471" title="org.scalaquery.ql.extended.DerbyQueryBuilder" class="keyword">super</a>.<a href="../basic/BasicQueryBuilder.scala.html#103907" title="(c: org.scalaquery.util.Node, b: org.scalaquery.util.SQLBuilder, rename: Boolean, topLevel: Boolean)Unit">expr</a><span class="delimiter">(</span><a href="#119022" title="org.scalaquery.util.Node">c</a>, <a href="#119023" title="org.scalaquery.util.SQLBuilder">b</a>, <a href="#119024" title="Boolean">rename</a>, <a href="#119025" title="Boolean">topLevel</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">override</span> <span class="keyword">protected</span> <span class="keyword">def</span> <a title="(c: org.scalaquery.util.Node, b: org.scalaquery.util.SQLBuilder)Unit" id="118925">innerExpr</a><span class="delimiter">(</span><a title="org.scalaquery.util.Node" id="119044">c</a>: <a href="../../util/Node.scala.html#10735" title="org.scalaquery.util.Node">Node</a>, <a title="org.scalaquery.util.SQLBuilder" id="119045">b</a>: <a href="../../util/SQLBuilder.scala.html#10756" title="org.scalaquery.util.SQLBuilder">SQLBuilder</a><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <a href="#119044" title="org.scalaquery.util.Node">c</a> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="comment">/* Create TRUE and FALSE values because Derby lacks boolean literals */</span>
    <span class="keyword">case</span> <a title="Unit" id="119054">c</a> @ ConstColumn<span class="delimiter">(</span><span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span> =&gt; <a href="#119045" title="org.scalaquery.util.SQLBuilder">b</a> <a href="../../util/SQLBuilder.scala.html#103840" title="(s: String)org.scalaquery.util.SQLBuilder">+=</a> <span title="java.lang.String(&quot;(1=1)&quot;)" class="string">&quot;(1=1)&quot;</span>
    <span class="keyword">case</span> <a title="Unit" id="119061">c</a> @ ConstColumn<span class="delimiter">(</span><span title="Boolean(false)" class="keyword">false</span><span class="delimiter">)</span> =&gt; <a href="#119045" title="org.scalaquery.util.SQLBuilder">b</a> <a href="../../util/SQLBuilder.scala.html#103840" title="(s: String)org.scalaquery.util.SQLBuilder">+=</a> <span title="java.lang.String(&quot;(1=0)&quot;)" class="string">&quot;(1=0)&quot;</span>

    <span class="comment">/* Convert pseudo-booleans from tables and subqueries to real booleans */</span>
    <span class="keyword">case</span> <a title="Unit" id="119068">n</a>: <a href="../ColumnBase.scala.html#9819" title="org.scalaquery.ql.NamedColumn[_]">NamedColumn</a><span class="delimiter">[</span>_<span class="delimiter">]</span> <span class="keyword">if</span> <a href="#119068" title="org.scalaquery.ql.NamedColumn[_]">n</a>.<a href="../ColumnBase.scala.html#78936" title="(v1: org.scalaquery.ql.basic.BasicProfile)org.scalaquery.ql.TypeMapperDelegate[_]">typeMapper</a><span class="delimiter">(</span><a href="#118930" title="org.scalaquery.ql.extended.DerbyDriver">profile</a><span class="delimiter">)</span> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#118930" title="org.scalaquery.ql.extended.DerbyDriver">profile</a>.<a href="#118879" title="=&gt; org.scalaquery.ql.extended.DerbyTypeMapperDelegates">typeMapperDelegates</a>.<a href="#118899" title="=&gt; org.scalaquery.ql.extended.DerbyTypeMapperDelegates.BooleanTypeMapperDelegate">booleanTypeMapperDelegate</a> =&gt;
      <a href="#119045" title="org.scalaquery.util.SQLBuilder">b</a> <a href="../../util/SQLBuilder.scala.html#103840" title="(s: String)org.scalaquery.util.SQLBuilder">+=</a> <span title="java.lang.String(&quot;(&quot;)" class="string">&quot;(&quot;</span>; <a href="#10471" title="org.scalaquery.ql.extended.DerbyQueryBuilder" class="keyword">super</a>.<a href="../basic/BasicQueryBuilder.scala.html#103908" title="(c: org.scalaquery.util.Node, b: org.scalaquery.util.SQLBuilder)Unit">innerExpr</a><span class="delimiter">(</span><a href="#119044" title="org.scalaquery.util.Node">c</a>, <a href="#119045" title="org.scalaquery.util.SQLBuilder">b</a><span class="delimiter">)</span>; <a href="#119045" title="org.scalaquery.util.SQLBuilder">b</a> <a href="../../util/SQLBuilder.scala.html#103840" title="(s: String)org.scalaquery.util.SQLBuilder">+=</a> <span title="java.lang.String(&quot; != 0)&quot;)" class="string">&quot; != 0)&quot;</span>
    <span class="keyword">case</span> <a title="Unit" id="119085">c</a> @ SubqueryColumn<span class="delimiter">(</span><a title="Int" id="119086">pos</a>, <a title="org.scalaquery.ql.Subquery" id="119087">sq</a>, <a title="org.scalaquery.ql.TypeMapper[_]" id="119088">tm</a><span class="delimiter">)</span> <span class="keyword">if</span> <a href="#119088" title="((v1: org.scalaquery.ql.basic.BasicProfile)org.scalaquery.ql.TypeMapperDelegate[_0]) forSome { type _0; type _0; type _0 }">tm</a><span class="delimiter">(</span><a href="#118930" title="org.scalaquery.ql.extended.DerbyDriver">profile</a><span class="delimiter">)</span> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#118930" title="org.scalaquery.ql.extended.DerbyDriver">profile</a>.<a href="#118879" title="=&gt; org.scalaquery.ql.extended.DerbyTypeMapperDelegates">typeMapperDelegates</a>.<a href="#118899" title="=&gt; org.scalaquery.ql.extended.DerbyTypeMapperDelegates.BooleanTypeMapperDelegate">booleanTypeMapperDelegate</a> =&gt;
      <a href="#119045" title="org.scalaquery.util.SQLBuilder">b</a> <a href="../../util/SQLBuilder.scala.html#103840" title="(s: String)org.scalaquery.util.SQLBuilder">+=</a> <span title="java.lang.String(&quot;(&quot;)" class="string">&quot;(&quot;</span>; <a href="#10471" title="org.scalaquery.ql.extended.DerbyQueryBuilder" class="keyword">super</a>.<a href="../basic/BasicQueryBuilder.scala.html#103908" title="(c: org.scalaquery.util.Node, b: org.scalaquery.util.SQLBuilder)Unit">innerExpr</a><span class="delimiter">(</span><a href="#119085" title="org.scalaquery.ql.SubqueryColumn">c</a>, <a href="#119045" title="org.scalaquery.util.SQLBuilder">b</a><span class="delimiter">)</span>; <a href="#119045" title="org.scalaquery.util.SQLBuilder">b</a> <a href="../../util/SQLBuilder.scala.html#103840" title="(s: String)org.scalaquery.util.SQLBuilder">+=</a> <span title="java.lang.String(&quot; != 0)&quot;)" class="string">&quot; != 0)&quot;</span>

    <span class="keyword">case</span> <a title="Unit" id="119116">a</a> @ ColumnOps.AsColumnOf<span class="delimiter">(</span><a title="org.scalaquery.util.Node" id="119118">ch</a>, <a title="Option[String]" id="119119">name</a><span class="delimiter">)</span> =&gt;
      <span class="comment">/* Derby does not support {fn convert}, so we use the SQL CAST syntax */</span>
      <a href="#119045" title="org.scalaquery.util.SQLBuilder">b</a> <a href="../../util/SQLBuilder.scala.html#103840" title="(s: String)org.scalaquery.util.SQLBuilder">+=</a> <span title="java.lang.String(&quot;cast(&quot;)" class="string">&quot;cast(&quot;</span>; <a href="../basic/BasicQueryBuilder.scala.html#103906" title="(c: org.scalaquery.util.Node, b: org.scalaquery.util.SQLBuilder)Unit">expr</a><span class="delimiter">(</span><a href="#119118" title="org.scalaquery.util.Node">ch</a>, <a href="#119045" title="org.scalaquery.util.SQLBuilder">b</a><span class="delimiter">)</span>; <a href="#119045" title="org.scalaquery.util.SQLBuilder">b</a> <a href="../../util/SQLBuilder.scala.html#103840" title="(s: String)org.scalaquery.util.SQLBuilder">+=</a> <span title="java.lang.String(&quot; as &quot;)" class="string">&quot; as &quot;</span> <a href="../../util/SQLBuilder.scala.html#103840" title="(s: String)org.scalaquery.util.SQLBuilder">+=</a> <a href="#119119" title="Option[String]">name</a>.<span title="(default: =&gt; String)String">getOrElse</span><span class="delimiter">(</span><a href="../basic/BasicSQLUtils.scala.html#107848" title="(tmd: org.scalaquery.ql.TypeMapperDelegate[_])String">mapTypeName</a><span class="delimiter">(</span><a href="#119116" title="org.scalaquery.ql.ColumnOps.AsColumnOf[Any]">a</a>.<a href="../ColumnBase.scala.html#78936" title="(v1: org.scalaquery.ql.basic.BasicProfile)org.scalaquery.ql.TypeMapperDelegate[Any]">typeMapper</a><span class="delimiter">(</span><a href="#118930" title="org.scalaquery.ql.extended.DerbyDriver">profile</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../util/SQLBuilder.scala.html#103840" title="(s: String)org.scalaquery.util.SQLBuilder">+=</a> <span title="java.lang.String(&quot;)&quot;)" class="string">&quot;)&quot;</span>

    <span class="keyword">case</span> <span title="Unit">ColumnOps</span>.IfNull<span class="delimiter">(</span><a title="org.scalaquery.util.Node" id="119147">l</a>, <a title="org.scalaquery.util.Node" id="119148">r</a><span class="delimiter">)</span> =&gt; <a href="#119148" title="org.scalaquery.util.Node">r</a> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="comment">/* Derby does not support IFNULL so we use COALESCE instead,
       * and it requires NULLs to be casted to a suitable type */</span>
      <span class="keyword">case</span> <a title="Unit" id="119149">c</a>: <a href="../ColumnBase.scala.html#9801" title="org.scalaquery.ql.Column[_]">Column</a><span class="delimiter">[</span>_<span class="delimiter">]</span> =&gt;
        <a href="#119045" title="org.scalaquery.util.SQLBuilder">b</a> <a href="../../util/SQLBuilder.scala.html#103840" title="(s: String)org.scalaquery.util.SQLBuilder">+=</a> <span title="java.lang.String(&quot;coalesce(cast(&quot;)" class="string">&quot;coalesce(cast(&quot;</span>
        <a href="../basic/BasicQueryBuilder.scala.html#103906" title="(c: org.scalaquery.util.Node, b: org.scalaquery.util.SQLBuilder)Unit">expr</a><span class="delimiter">(</span><a href="#119147" title="org.scalaquery.util.Node">l</a>, <a href="#119045" title="org.scalaquery.util.SQLBuilder">b</a><span class="delimiter">)</span>
        <a href="#119045" title="org.scalaquery.util.SQLBuilder">b</a> <a href="../../util/SQLBuilder.scala.html#103840" title="(s: String)org.scalaquery.util.SQLBuilder">+=</a> <span title="java.lang.String(&quot; as &quot;)" class="string">&quot; as &quot;</span> <a href="../../util/SQLBuilder.scala.html#103840" title="(s: String)org.scalaquery.util.SQLBuilder">+=</a> <a href="../basic/BasicSQLUtils.scala.html#107848" title="(tmd: org.scalaquery.ql.TypeMapperDelegate[_])String">mapTypeName</a><span class="delimiter">(</span><a href="#119149" title="org.scalaquery.ql.Column[_]">c</a>.<a href="../ColumnBase.scala.html#78936" title="(v1: org.scalaquery.ql.basic.BasicProfile)org.scalaquery.ql.TypeMapperDelegate[_]">typeMapper</a><span class="delimiter">(</span><a href="#118930" title="org.scalaquery.ql.extended.DerbyDriver">profile</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../util/SQLBuilder.scala.html#103840" title="(s: String)org.scalaquery.util.SQLBuilder">+=</a> <span title="java.lang.String(&quot;),&quot;)" class="string">&quot;),&quot;</span>
        <a href="../basic/BasicQueryBuilder.scala.html#103906" title="(c: org.scalaquery.util.Node, b: org.scalaquery.util.SQLBuilder)Unit">expr</a><span class="delimiter">(</span><a href="#119148" title="org.scalaquery.util.Node">r</a>, <a href="#119045" title="org.scalaquery.util.SQLBuilder">b</a><span class="delimiter">)</span>; <a href="#119045" title="org.scalaquery.util.SQLBuilder">b</a> <a href="../../util/SQLBuilder.scala.html#103840" title="(s: String)org.scalaquery.util.SQLBuilder">+=</a> <span title="java.lang.String(&quot;)&quot;)" class="string">&quot;)&quot;</span>
      <span class="keyword">case</span> <span title="Nothing">_</span> =&gt; <span title="Nothing" class="keyword">throw</span> <a href="../../SQueryException.scala.html#25911" title="org.scalaquery.SQueryException" class="keyword">new</a> <a href="../../SQueryException.scala.html#9548" title="org.scalaquery.SQueryException">SQueryException</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Cannot determine type of right-hand side for ifNull&quot;)" class="string">&quot;Cannot determine type of right-hand side for ifNull&quot;</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="keyword">case</span> <a title="Unit" id="119181">fk</a>: <a href="../Constraint.scala.html#9844" title="org.scalaquery.ql.ForeignKey[_]">ForeignKey</a><span class="delimiter">[</span>_<span class="delimiter">]</span> =&gt;
      <span class="comment">/* Derby does not support row value constructor syntax (tuple syntax),
       * so we need to untuple and compare the individual columns (which
       * should be safe because they may not contain NULLs). */</span>
      <span class="keyword">val</span> <a title="List[(org.scalaquery.util.Node, org.scalaquery.util.Node)]" id="119185">cols</a> = <a href="../basic/BasicQueryBuilder.scala.html#103915" title="(columns: org.scalaquery.util.Node)List[org.scalaquery.util.Node]">untupleColumn</a><span class="delimiter">(</span><a href="#119181" title="org.scalaquery.ql.ForeignKey[_]">fk</a>.<a href="../Constraint.scala.html#84543" title="=&gt; org.scalaquery.util.Node">left</a><span class="delimiter">)</span> <span title="(that: scala.collection.GenIterable[org.scalaquery.util.Node])(implicit bf: scala.collection.generic.CanBuildFrom[List[org.scalaquery.util.Node],(org.scalaquery.util.Node, org.scalaquery.util.Node),List[(org.scalaquery.util.Node, org.scalaquery.util.Node)]])List[(org.scalaquery.util.Node, org.scalaquery.util.Node)]">zip</span> <a href="../basic/BasicQueryBuilder.scala.html#103915" title="(columns: org.scalaquery.util.Node)List[org.scalaquery.util.Node]">untupleColumn</a><span class="delimiter">(</span><a href="#119181" title="org.scalaquery.ql.ForeignKey[_]">fk</a>.<a href="../Constraint.scala.html#84545" title="=&gt; org.scalaquery.util.Node">right</a><span class="delimiter">)</span>
      <a href="#119045" title="org.scalaquery.util.SQLBuilder">b</a> <a href="../../util/SQLBuilder.scala.html#103840" title="(s: String)org.scalaquery.util.SQLBuilder">+=</a> <span title="java.lang.String(&quot;(&quot;)" class="string">&quot;(&quot;</span>
      <a href="#119045" title="org.scalaquery.util.SQLBuilder">b</a>.<a href="../../util/SQLBuilder.scala.html#103846" title="(sequence: Traversable[(org.scalaquery.util.Node, org.scalaquery.util.Node)], separator: String)(f: (org.scalaquery.util.Node, org.scalaquery.util.Node) =&gt; Unit)Unit">sep</a><span class="delimiter">(</span><a href="#119185" title="List[(org.scalaquery.util.Node, org.scalaquery.util.Node)]">cols</a>, <span title="java.lang.String(&quot; and &quot;)" class="string">&quot; and &quot;</span><span class="delimiter">)</span><a href="#119265" title="Unit" class="delimiter">{</a> <span class="keyword">case</span> <span title="Unit" class="delimiter">(</span><a title="org.scalaquery.util.Node" id="119268">l</a>,<a title="org.scalaquery.util.Node" id="119269">r</a><span class="delimiter">)</span> =&gt; <a href="../basic/BasicQueryBuilder.scala.html#103906" title="(c: org.scalaquery.util.Node, b: org.scalaquery.util.SQLBuilder)Unit">expr</a><span class="delimiter">(</span><a href="#119268" title="org.scalaquery.util.Node">l</a>, <a href="#119045" title="org.scalaquery.util.SQLBuilder">b</a><span class="delimiter">)</span>; <a href="#119045" title="org.scalaquery.util.SQLBuilder">b</a> <a href="../../util/SQLBuilder.scala.html#103840" title="(s: String)org.scalaquery.util.SQLBuilder">+=</a> <span title="java.lang.String(&quot;=&quot;)" class="string">&quot;=&quot;</span>; <a href="../basic/BasicQueryBuilder.scala.html#103906" title="(c: org.scalaquery.util.Node, b: org.scalaquery.util.SQLBuilder)Unit">expr</a><span class="delimiter">(</span><a href="#119269" title="org.scalaquery.util.Node">r</a>, <a href="#119045" title="org.scalaquery.util.SQLBuilder">b</a><span class="delimiter">)</span>; <span class="delimiter">}</span>
      <a href="#119045" title="org.scalaquery.util.SQLBuilder">b</a> <a href="../../util/SQLBuilder.scala.html#103840" title="(s: String)org.scalaquery.util.SQLBuilder">+=</a> <span title="java.lang.String(&quot;)&quot;)" class="string">&quot;)&quot;</span>

    <span class="keyword">case</span> <a title="Unit" id="119286">c</a> @ BindColumn<span class="delimiter">(</span><a title="Any" id="119289">v</a><span class="delimiter">)</span> <span class="keyword">if</span> <a href="#119045" title="org.scalaquery.util.SQLBuilder">b</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../basic/BasicQueryBuilder.scala.html#103881" title="=&gt; org.scalaquery.util.SQLBuilder">selectSlot</a> =&gt;
      <span class="comment">/* The Derby embedded driver has a bug (DERBY-4671) which results in a
       * NullPointerException when using bind variables in a SELECT clause.
       * This should be fixed in Derby 10.6.1.1. The workaround is to add an
       * explicit type annotation (in the form of a CAST expression). */</span>
      <span class="keyword">val</span> <a title="org.scalaquery.ql.TypeMapperDelegate[Any]" id="119294">tmd</a> = <a href="#119286" title="org.scalaquery.ql.BindColumn[Any]">c</a>.<a href="../ColumnBase.scala.html#78936" title="(v1: org.scalaquery.ql.basic.BasicProfile)org.scalaquery.ql.TypeMapperDelegate[Any]">typeMapper</a><span class="delimiter">(</span><a href="#118930" title="org.scalaquery.ql.extended.DerbyDriver">profile</a><span class="delimiter">)</span>
      <a href="#119045" title="org.scalaquery.util.SQLBuilder">b</a> <a href="../../util/SQLBuilder.scala.html#103840" title="(s: String)org.scalaquery.util.SQLBuilder">+=</a> <span title="java.lang.String(&quot;cast(&quot;)" class="string">&quot;cast(&quot;</span>
      <a href="#119045" title="org.scalaquery.util.SQLBuilder">b</a> <a href="../../util/SQLBuilder.scala.html#103845" title="(f: (org.scalaquery.session.PositionedParameters, Any) =&gt; Unit)org.scalaquery.util.SQLBuilder">+?=</a> <span class="delimiter">{</span> <span class="delimiter">(</span><a title="org.scalaquery.session.PositionedParameters" id="119301">p</a>, <a title="Any" id="119302">param</a><span class="delimiter">)</span> =&gt; <a href="#119294" title="org.scalaquery.ql.TypeMapperDelegate[Any]">tmd</a>.<a href="../TypeMapper.scala.html#79207" title="(v: Any, p: org.scalaquery.session.PositionedParameters)Unit">setValue</a><span class="delimiter">(</span><a href="#119289" title="Any">v</a>, <a href="#119301" title="org.scalaquery.session.PositionedParameters">p</a><span class="delimiter">)</span> <span class="delimiter">}</span>
      <a href="#119045" title="org.scalaquery.util.SQLBuilder">b</a> <a href="../../util/SQLBuilder.scala.html#103840" title="(s: String)org.scalaquery.util.SQLBuilder">+=</a> <span title="java.lang.String(&quot; as &quot;)" class="string">&quot; as &quot;</span> <a href="../../util/SQLBuilder.scala.html#103840" title="(s: String)org.scalaquery.util.SQLBuilder">+=</a> <a href="../basic/BasicSQLUtils.scala.html#107848" title="(tmd: org.scalaquery.ql.TypeMapperDelegate[_])String">mapTypeName</a><span class="delimiter">(</span><a href="#119294" title="org.scalaquery.ql.TypeMapperDelegate[Any]">tmd</a><span class="delimiter">)</span> <a href="../../util/SQLBuilder.scala.html#103840" title="(s: String)org.scalaquery.util.SQLBuilder">+=</a> <span title="java.lang.String(&quot;)&quot;)" class="string">&quot;)&quot;</span>

    <span class="comment">/* I guess NEXTVAL was too short */</span>
    <span class="keyword">case</span> <span title="Unit">Sequence</span>.Nextval<span class="delimiter">(</span><a title="org.scalaquery.ql.Sequence[Any]" id="119320">seq</a><span class="delimiter">)</span> =&gt; <a href="#119045" title="org.scalaquery.util.SQLBuilder">b</a> <a href="../../util/SQLBuilder.scala.html#103840" title="(s: String)org.scalaquery.util.SQLBuilder">+=</a> <span title="java.lang.String(&quot;(next value for &quot;)" class="string">&quot;(next value for &quot;</span> <a href="../../util/SQLBuilder.scala.html#103840" title="(s: String)org.scalaquery.util.SQLBuilder">+=</a> <a href="../basic/BasicSQLUtils.scala.html#107847" title="(id: String)String">quoteIdentifier</a><span class="delimiter">(</span><a href="#119320" title="org.scalaquery.ql.Sequence[Any]">seq</a>.<a href="../Sequence.scala.html#102135" title="=&gt; String">name</a><span class="delimiter">)</span> <a href="../../util/SQLBuilder.scala.html#103840" title="(s: String)org.scalaquery.util.SQLBuilder">+=</a> <span title="java.lang.String(&quot;)&quot;)" class="string">&quot;)&quot;</span>

    <span class="keyword">case</span> <span title="Nothing">Sequence</span>.Currval<span class="delimiter">(</span><a title="org.scalaquery.ql.Sequence[Any]" id="119335">seq</a><span class="delimiter">)</span> =&gt; <span title="Nothing" class="keyword">throw</span> <a href="../../SQueryException.scala.html#25911" title="org.scalaquery.SQueryException" class="keyword">new</a> <a href="../../SQueryException.scala.html#9548" title="org.scalaquery.SQueryException">SQueryException</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Derby does not support CURRVAL&quot;)" class="string">&quot;Derby does not support CURRVAL&quot;</span><span class="delimiter">)</span>

    <span class="keyword">case</span> <a href="../SimpleFunction.scala.html#85915" title="Unit">SimpleFunction</a><span class="delimiter">(</span><span title="java.lang.String(&quot;database&quot;)" class="string">&quot;database&quot;</span>, <span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span> =&gt; <a href="#119045" title="org.scalaquery.util.SQLBuilder">b</a> <a href="../../util/SQLBuilder.scala.html#103840" title="(s: String)org.scalaquery.util.SQLBuilder">+=</a> <span title="java.lang.String(&quot;\'\'&quot;)" class="string">&quot;''&quot;</span>

    <span class="keyword">case</span> <span title="Unit">_</span> =&gt; <a href="#10471" title="org.scalaquery.ql.extended.DerbyQueryBuilder" class="keyword">super</a>.<a href="../basic/BasicQueryBuilder.scala.html#103908" title="(c: org.scalaquery.util.Node, b: org.scalaquery.util.SQLBuilder)Unit">innerExpr</a><span class="delimiter">(</span><a href="#119044" title="org.scalaquery.util.Node">c</a>, <a href="#119045" title="org.scalaquery.util.SQLBuilder">b</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">override</span> <span class="keyword">protected</span> <span class="keyword">def</span> <a title="(t: org.scalaquery.util.Node, name: String, b: org.scalaquery.util.SQLBuilder)Unit" id="118926">table</a><span class="delimiter">(</span><a title="org.scalaquery.util.Node" id="119342">t</a>: <a href="../../util/Node.scala.html#10735" title="org.scalaquery.util.Node">Node</a>, <a title="String" id="119343">name</a>: <span title="String">String</span>, <a title="org.scalaquery.util.SQLBuilder" id="119344">b</a>: <a href="../../util/SQLBuilder.scala.html#10756" title="org.scalaquery.util.SQLBuilder">SQLBuilder</a><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <a href="#119342" title="org.scalaquery.util.Node">t</a> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="comment">/* Derby requires columns of UNION parts to have the same names. If my
     * understanding of SQL:2008 is correct, this is a bug. This behavior
     * would be correct if the CORRESPONDING keyword was used for a UNION.
     * The workaround is to rename all parts with the same auto-generated
     * column names. */</span>
    <span class="keyword">case</span> <span title="Unit">Subquery</span><span class="delimiter">(</span>Union<span class="delimiter">(</span><a title="Boolean" id="119346">all</a>, <a title="List[org.scalaquery.ql.Query[_]]" id="119347">sqs</a><span class="delimiter">)</span>, <a title="Boolean" id="119348">rename</a><span class="delimiter">)</span> =&gt;
      <a href="#119344" title="org.scalaquery.util.SQLBuilder">b</a> <a href="../../util/SQLBuilder.scala.html#103840" title="(s: String)org.scalaquery.util.SQLBuilder">+=</a> <span title="java.lang.String(&quot;(&quot;)" class="string">&quot;(&quot;</span>
      <a href="#119344" title="org.scalaquery.util.SQLBuilder">b</a>.<a href="../../util/SQLBuilder.scala.html#103846" title="(sequence: Traversable[org.scalaquery.ql.Query[_]], separator: String)(f: org.scalaquery.ql.Query[_] =&gt; Unit)Unit">sep</a><span class="delimiter">(</span><a href="#119347" title="List[org.scalaquery.ql.Query[_]]">sqs</a>, <span class="delimiter">(</span><span title="String" class="keyword">if</span><span class="delimiter">(</span><a href="#119346" title="Boolean">all</a><span class="delimiter">)</span> <span title="java.lang.String(&quot; UNION ALL &quot;)" class="string">&quot; UNION ALL &quot;</span> <span class="keyword">else</span> <span title="java.lang.String(&quot; UNION &quot;)" class="string">&quot; UNION &quot;</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">(</span><a title="org.scalaquery.ql.Query[_]" id="119373">sq</a> =&gt; <a href="../basic/BasicQueryBuilder.scala.html#103893" title="(q: org.scalaquery.ql.Query[_])DerbyQueryBuilder.this.Self">subQueryBuilderFor</a><span class="delimiter">(</span><a href="#119373" title="org.scalaquery.ql.Query[_]">sq</a><span class="delimiter">)</span>.<a href="../basic/BasicQueryBuilder.scala.html#103897" title="(b: org.scalaquery.util.SQLBuilder, rename: Boolean)Unit">innerBuildSelect</a><span class="delimiter">(</span><a href="#119344" title="org.scalaquery.util.SQLBuilder">b</a>, <a href="#119348" title="Boolean">rename</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="#119344" title="org.scalaquery.util.SQLBuilder">b</a> <a href="../../util/SQLBuilder.scala.html#103840" title="(s: String)org.scalaquery.util.SQLBuilder">+=</a> <span title="java.lang.String(&quot;) &quot;)" class="string">&quot;) &quot;</span> <a href="../../util/SQLBuilder.scala.html#103840" title="(s: String)org.scalaquery.util.SQLBuilder">+=</a> <a href="../basic/BasicSQLUtils.scala.html#107847" title="(id: String)String">quoteIdentifier</a><span class="delimiter">(</span><a href="#119343" title="String">name</a><span class="delimiter">)</span>
    <span class="keyword">case</span> <span title="Unit">_</span> =&gt; <a href="#10471" title="org.scalaquery.ql.extended.DerbyQueryBuilder" class="keyword">super</a>.<a href="../basic/BasicQueryBuilder.scala.html#103913" title="(t: org.scalaquery.util.Node, name: String, b: org.scalaquery.util.SQLBuilder)Unit">table</a><span class="delimiter">(</span><a href="#119342" title="org.scalaquery.util.Node">t</a>, <a href="#119343" title="String">name</a>, <a href="#119344" title="org.scalaquery.util.SQLBuilder">b</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="keyword">class</span> <a title="class DerbyDDLBuilder extends org.scalaquery.ql.basic.BasicDDLBuilder with ScalaObject" id="10472">DerbyDDLBuilder</a><a href="#10472" title="ScalaObject" class="delimiter">(</a><a title="org.scalaquery.ql.basic.AbstractBasicTable[_]" id="118950">table</a>: <a href="../basic/BasicTable.scala.html#10416" title="org.scalaquery.ql.basic.AbstractBasicTable[_]">AbstractBasicTable</a><span class="delimiter">[</span>_<span class="delimiter">]</span>, <a title="org.scalaquery.ql.extended.DerbyDriver" id="118951">profile</a>: <a href="#10465" title="org.scalaquery.ql.extended.DerbyDriver">DerbyDriver</a><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="../basic/BasicDDLBuilder.scala.html#10320" title="org.scalaquery.ql.basic.BasicDDLBuilder">BasicDDLBuilder</a><span class="delimiter">(</span><a href="#118950" title="org.scalaquery.ql.basic.AbstractBasicTable[_]">table</a>, <a href="#118951" title="org.scalaquery.ql.extended.DerbyDriver">profile</a><span class="delimiter">)</span> <span class="delimiter">{</span>
  <span class="keyword">import</span> <a href="#118951" title="org.scalaquery.ql.extended.DerbyDriver">profile</a>.<a href="../basic/BasicProfile.scala.html#79191" title="=&gt; org.scalaquery.ql.basic.BasicSQLUtils">sqlUtils</a>._

  <span class="keyword">protected</span> <span class="keyword">class</span> <a title="class DerbyColumnDDLBuilder extends DerbyDDLBuilder.this.BasicColumnDDLBuilder with ScalaObject" id="118947">DerbyColumnDDLBuilder</a><a href="#118947" title="ScalaObject" class="delimiter">(</a><a title="org.scalaquery.ql.NamedColumn[_]" id="119403">column</a>: <a href="../ColumnBase.scala.html#9819" title="org.scalaquery.ql.NamedColumn[_]">NamedColumn</a><span class="delimiter">[</span>_<span class="delimiter">]</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="../basic/BasicDDLBuilder.scala.html#107793" title="DerbyDDLBuilder.this.BasicColumnDDLBuilder">BasicColumnDDLBuilder</a><span class="delimiter">(</span><a href="#119403" title="org.scalaquery.ql.NamedColumn[_]">column</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">override</span> <span class="keyword">protected</span> <span class="keyword">def</span> <a title="(sb: StringBuilder)Unit" id="119397">appendOptions</a><span class="delimiter">(</span><a title="StringBuilder" id="119409">sb</a>: <span title="StringBuilder">StringBuilder</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span title="Any" class="keyword">if</span><span class="delimiter">(</span><a href="../basic/BasicDDLBuilder.scala.html#107867" title="=&gt; String">defaultLiteral</a> <span title="(x$1: AnyRef)Boolean">ne</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> <a href="#119409" title="StringBuilder">sb</a> <span title="(s: String)StringBuilder">append</span> <span title="java.lang.String(&quot; DEFAULT &quot;)" class="string">&quot; DEFAULT &quot;</span> <span title="(s: String)StringBuilder">append</span> <a href="../basic/BasicDDLBuilder.scala.html#107867" title="=&gt; String">defaultLiteral</a>
      <span title="Any" class="keyword">if</span><span class="delimiter">(</span><a href="../basic/BasicDDLBuilder.scala.html#107858" title="=&gt; Boolean">notNull</a><span class="delimiter">)</span> <a href="#119409" title="StringBuilder">sb</a> <span title="(s: String)StringBuilder">append</span> <span title="java.lang.String(&quot; NOT NULL&quot;)" class="string">&quot; NOT NULL&quot;</span>
      <span title="Any" class="keyword">if</span><span class="delimiter">(</span><a href="../basic/BasicDDLBuilder.scala.html#107864" title="=&gt; Boolean">primaryKey</a><span class="delimiter">)</span> <a href="#119409" title="StringBuilder">sb</a> <span title="(s: String)StringBuilder">append</span> <span title="java.lang.String(&quot; PRIMARY KEY&quot;)" class="string">&quot; PRIMARY KEY&quot;</span>
      <span title="Unit" class="keyword">if</span><span class="delimiter">(</span><a href="../basic/BasicDDLBuilder.scala.html#107861" title="=&gt; Boolean">autoIncrement</a><span class="delimiter">)</span> <a href="#119409" title="StringBuilder">sb</a> <span title="(s: String)StringBuilder">append</span> <span title="java.lang.String(&quot; GENERATED BY DEFAULT AS IDENTITY&quot;)" class="string">&quot; GENERATED BY DEFAULT AS IDENTITY&quot;</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">override</span> <span class="keyword">protected</span> <span class="keyword">def</span> <a title="(c: org.scalaquery.ql.NamedColumn[_])DerbyDDLBuilder.this.DerbyColumnDDLBuilder" id="118948">createColumnDDLBuilder</a><span class="delimiter">(</span><a title="org.scalaquery.ql.NamedColumn[_]" id="119455">c</a>: <a href="../ColumnBase.scala.html#9819" title="org.scalaquery.ql.NamedColumn[_]">NamedColumn</a><span class="delimiter">[</span>_<span class="delimiter">]</span><span class="delimiter">)</span> = <span title="DerbyDDLBuilder.this.DerbyColumnDDLBuilder" class="keyword">new</span> <a href="#118947" title="DerbyDDLBuilder.this.DerbyColumnDDLBuilder">DerbyColumnDDLBuilder</a><span class="delimiter">(</span><a href="#119455" title="org.scalaquery.ql.NamedColumn[_]">c</a><span class="delimiter">)</span>

  <span class="keyword">override</span> <span class="keyword">protected</span> <span class="keyword">def</span> <a title="(idx: org.scalaquery.ql.Index)java.lang.String" id="118949">createIndex</a><span class="delimiter">(</span><a title="org.scalaquery.ql.Index" id="119463">idx</a>: <a href="../Index.scala.html#9871" title="org.scalaquery.ql.Index">Index</a><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span title="java.lang.String" class="keyword">if</span><span class="delimiter">(</span><a href="#119463" title="org.scalaquery.ql.Index">idx</a>.<a href="../Index.scala.html#85956" title="=&gt; Boolean">unique</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="comment">/* Create a UNIQUE CONSTRAINT (with an automatically generated backing
       * index) because Derby does not allow a FOREIGN KEY CONSTRAINT to
       * reference columns which have a UNIQUE INDEX but not a nominal UNIQUE
       * CONSTRAINT. */</span>
      <span class="keyword">val</span> <a title="StringBuilder" id="119466">sb</a> = <span title="()StringBuilder" class="keyword">new</span> <span title="StringBuilder">StringBuilder</span> <span title="(s: String)StringBuilder">append</span> <span title="java.lang.String(&quot;ALTER TABLE &quot;)" class="string">&quot;ALTER TABLE &quot;</span> <span title="(s: String)StringBuilder">append</span> <a href="../basic/BasicSQLUtils.scala.html#107847" title="(id: String)String">quoteIdentifier</a><span class="delimiter">(</span><a href="#118950" title="org.scalaquery.ql.basic.AbstractBasicTable[_]">table</a>.<a href="../TableBase.scala.html#84557" title="=&gt; String">tableName</a><span class="delimiter">)</span> <span title="(s: String)StringBuilder">append</span> <span title="java.lang.String(&quot; ADD &quot;)" class="string">&quot; ADD &quot;</span>
      <a href="#119466" title="StringBuilder">sb</a> <span title="(s: String)StringBuilder">append</span> <span title="java.lang.String(&quot;CONSTRAINT &quot;)" class="string">&quot;CONSTRAINT &quot;</span> <span title="(s: String)StringBuilder">append</span> <a href="../basic/BasicSQLUtils.scala.html#107847" title="(id: String)String">quoteIdentifier</a><span class="delimiter">(</span><a href="#119463" title="org.scalaquery.ql.Index">idx</a>.<a href="../Index.scala.html#85950" title="=&gt; String">name</a><span class="delimiter">)</span> <span title="(s: String)StringBuilder">append</span> <span title="java.lang.String(&quot; UNIQUE(&quot;)" class="string">&quot; UNIQUE(&quot;</span>
      <a href="../basic/BasicDDLBuilder.scala.html#107803" title="(columns: org.scalaquery.util.Node, sb: StringBuilder, requiredTableName: String)Unit">addIndexColumnList</a><span class="delimiter">(</span><a href="#119463" title="org.scalaquery.ql.Index">idx</a>.<a href="../Index.scala.html#85954" title="=&gt; org.scalaquery.ql.ColumnBase[_]">on</a>, <a href="#119466" title="StringBuilder">sb</a>, <a href="#119463" title="org.scalaquery.ql.Index">idx</a>.<a href="../Index.scala.html#85952" title="=&gt; org.scalaquery.ql.AbstractTable[_]">table</a>.<a href="../TableBase.scala.html#84557" title="=&gt; String">tableName</a><span class="delimiter">)</span>
      <a href="#119466" title="StringBuilder">sb</a> <span title="(s: String)StringBuilder">append</span> <span title="java.lang.String(&quot;)&quot;)" class="string">&quot;)&quot;</span>
      <a href="#119466" title="StringBuilder">sb</a>.<span title="()java.lang.String">toString</span>
    <span class="delimiter">}</span> <span class="keyword">else</span> <a href="#10472" title="org.scalaquery.ql.extended.DerbyDDLBuilder" class="keyword">super</a>.<a href="../basic/BasicDDLBuilder.scala.html#107796" title="(idx: org.scalaquery.ql.Index)java.lang.String">createIndex</a><span class="delimiter">(</span><a href="#119463" title="org.scalaquery.ql.Index">idx</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="keyword">class</span> <a title="class DerbySequenceDDLBuilder[T] extends org.scalaquery.ql.basic.BasicSequenceDDLBuilder with ScalaObject" id="10473">DerbySequenceDDLBuilder</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="10474">T</a><span class="delimiter">]</span><a href="#10473" title="ScalaObject" class="delimiter">(</a><a title="org.scalaquery.ql.Sequence[T]" id="118969">seq</a>: <a href="../Sequence.scala.html#10233" title="org.scalaquery.ql.Sequence[T]">Sequence</a><span class="delimiter">[</span>T<span class="delimiter">]</span>, <a title="org.scalaquery.ql.extended.DerbyDriver" id="118970">profile</a>: <a href="#10465" title="org.scalaquery.ql.extended.DerbyDriver">DerbyDriver</a><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="../basic/BasicSequenceDDLBuilder.scala.html#10408" title="org.scalaquery.ql.basic.BasicSequenceDDLBuilder">BasicSequenceDDLBuilder</a><span class="delimiter">(</span><a href="#118969" title="org.scalaquery.ql.Sequence[T]">seq</a>, <a href="#118970" title="org.scalaquery.ql.extended.DerbyDriver">profile</a><span class="delimiter">)</span> <span class="delimiter">{</span>
  <span class="keyword">import</span> <a href="#118970" title="org.scalaquery.ql.extended.DerbyDriver">profile</a>.<a href="../basic/BasicProfile.scala.html#79191" title="=&gt; org.scalaquery.ql.basic.BasicSQLUtils">sqlUtils</a>._

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; org.scalaquery.ql.DDL" id="118967">buildDDL</a>: <a href="../DDL.scala.html#9860" title="org.scalaquery.ql.DDL">DDL</a> = <span class="delimiter">{</span>
    <span class="keyword">import</span> <a href="#118969" title="org.scalaquery.ql.Sequence[T]">seq</a>.<a href="../Sequence.scala.html#102149" title="=&gt; Integral[T]">integral</a>._
    <span class="keyword">val</span> <a title="T" id="119505">increment</a> = <a href="#118969" title="org.scalaquery.ql.Sequence[T]">seq</a>.<a href="../Sequence.scala.html#102141" title="=&gt; Option[T]">_increment</a>.<span title="(default: =&gt; T)T">getOrElse</span><span class="delimiter">(</span><a href="../Sequence.scala.html#102149" title="=&gt; T">one</a><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="Boolean" id="119506">desc</a> = <a href="../Sequence.scala.html#102149" title="implicit scala.math.Ordering.mkOrderingOps : (lhs: T)DerbySequenceDDLBuilder.this.seq.integral.Ops">increment</a> <span title="(rhs: T)Boolean">&lt;</span> <a href="../Sequence.scala.html#102149" title="=&gt; T">zero</a>
    <span class="keyword">val</span> <a title="StringBuilder" id="119507">b</a> = <span title="()StringBuilder" class="keyword">new</span> <span title="StringBuilder">StringBuilder</span> <span title="(s: String)StringBuilder">append</span> <span title="java.lang.String(&quot;CREATE SEQUENCE &quot;)" class="string">&quot;CREATE SEQUENCE &quot;</span> <span title="(s: String)StringBuilder">append</span> <a href="../basic/BasicSQLUtils.scala.html#107847" title="(id: String)String">quoteIdentifier</a><span class="delimiter">(</span><a href="#118969" title="org.scalaquery.ql.Sequence[T]">seq</a>.<a href="../Sequence.scala.html#102135" title="=&gt; String">name</a><span class="delimiter">)</span>
    <span class="comment">/* Set the START value explicitly because it defaults to the data type's
     * min/max value instead of the more conventional 1/-1. */</span>
    <a href="#119507" title="StringBuilder">b</a> <span title="(s: String)StringBuilder">append</span> <span title="java.lang.String(&quot; START WITH &quot;)" class="string">&quot; START WITH &quot;</span> <span title="(x: Any)StringBuilder">append</span> <a href="#118969" title="org.scalaquery.ql.Sequence[T]">seq</a>.<a href="../Sequence.scala.html#102143" title="=&gt; Option[T]">_start</a>.<span title="(default: =&gt; Any)Any">getOrElse</span><span class="delimiter">(</span><span title="Int" class="keyword">if</span><span class="delimiter">(</span><a href="#119506" title="Boolean">desc</a><span class="delimiter">)</span> -<span title="Int(-1)" class="int">1</span> <span class="keyword">else</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
    <a href="#118969" title="org.scalaquery.ql.Sequence[T]">seq</a>.<a href="../Sequence.scala.html#102141" title="=&gt; Option[T]">_increment</a>.<span title="(f: T =&gt; StringBuilder)Unit">foreach</span> <span class="delimiter">{</span> <a href="#119507" title="StringBuilder">b</a> <span title="(s: String)StringBuilder">append</span> <span title="java.lang.String(&quot; INCREMENT BY &quot;)" class="string">&quot; INCREMENT BY &quot;</span> <span title="(x: Any)StringBuilder">append</span> <a href="#119591" title="T">_</a> <span class="delimiter">}</span>
    <a href="#118969" title="org.scalaquery.ql.Sequence[T]">seq</a>.<a href="../Sequence.scala.html#102139" title="=&gt; Option[T]">_maxValue</a>.<span title="(f: T =&gt; StringBuilder)Unit">foreach</span> <span class="delimiter">{</span> <a href="#119507" title="StringBuilder">b</a> <span title="(s: String)StringBuilder">append</span> <span title="java.lang.String(&quot; MAXVALUE &quot;)" class="string">&quot; MAXVALUE &quot;</span> <span title="(x: Any)StringBuilder">append</span> <a href="#119605" title="T">_</a> <span class="delimiter">}</span>
    <a href="#118969" title="org.scalaquery.ql.Sequence[T]">seq</a>.<a href="../Sequence.scala.html#102137" title="=&gt; Option[T]">_minValue</a>.<span title="(f: T =&gt; StringBuilder)Unit">foreach</span> <span class="delimiter">{</span> <a href="#119507" title="StringBuilder">b</a> <span title="(s: String)StringBuilder">append</span> <span title="java.lang.String(&quot; MINVALUE &quot;)" class="string">&quot; MINVALUE &quot;</span> <span title="(x: Any)StringBuilder">append</span> <a href="#119619" title="T">_</a> <span class="delimiter">}</span>
    <span class="comment">/* Cycling is supported but does not conform to SQL:2008 semantics. Derby
     * cycles back to the START value instead of MINVALUE or MAXVALUE. No good
     * workaround available AFAICT. */</span>
    <span title="Any" class="keyword">if</span><span class="delimiter">(</span><a href="#118969" title="org.scalaquery.ql.Sequence[T]">seq</a>.<a href="../Sequence.scala.html#102145" title="=&gt; Boolean">_cycle</a><span class="delimiter">)</span> <a href="#119507" title="StringBuilder">b</a> <span title="(s: String)StringBuilder">append</span> <span title="java.lang.String(&quot; CYCLE&quot;)" class="string">&quot; CYCLE&quot;</span>
    <a href="#119641" title="java.lang.Object with org.scalaquery.ql.DDL{}" class="keyword">new</a> <a title="anonymous class $anon extends java.lang.Object with org.scalaquery.ql.DDL" id="119641">DDL</a> <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="Iterable[java.lang.String]" id="119645">createPhase1</a> = <span title="(elems: java.lang.String*)Iterable[java.lang.String]">Iterable</span><span class="delimiter">(</span><a href="#119507" title="StringBuilder">b</a>.<span title="()java.lang.String">toString</span><span class="delimiter">)</span>
      <span class="keyword">val</span> <a title="scala.collection.immutable.Nil.type" id="119647">createPhase2</a> = <span title="object Nil">Nil</span>
      <span class="keyword">val</span> <a title="scala.collection.immutable.Nil.type" id="119649">dropPhase1</a> = <span title="object Nil">Nil</span>
      <span class="keyword">val</span> <a title="Iterable[java.lang.String]" id="119651">dropPhase2</a> = <span title="(elems: java.lang.String*)Iterable[java.lang.String]">Iterable</span><span class="delimiter">(</span><span title="java.lang.String(&quot;DROP SEQUENCE &quot;)" class="string">&quot;DROP SEQUENCE &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="../basic/BasicSQLUtils.scala.html#107847" title="(id: String)String">quoteIdentifier</a><span class="delimiter">(</span><a href="#118969" title="org.scalaquery.ql.Sequence[T]">seq</a>.<a href="../Sequence.scala.html#102135" title="=&gt; String">name</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>