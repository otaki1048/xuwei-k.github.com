<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>mapper/net/liftweb/mapper/view/TableEditor.scala</title>
        <script type="text/javascript" src="../../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/*
 * Copyright 2009-2011 WorldWide Conferencing, LLC
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */</span>

<span class="keyword">package</span> net.liftweb
<span class="keyword">package</span> mapper
<span class="keyword">package</span> view

<span class="keyword">import</span> xml.<span class="delimiter">{</span>NodeSeq, Text<span class="delimiter">}</span>

<span class="keyword">import</span> common.<span class="delimiter">{</span>Box, Full, Empty<span class="delimiter">}</span>
<span class="keyword">import</span> util.<a href="../../../../../util/net/liftweb/util/BindPlus.scala.html#13168" title="object net.liftweb.util.BindPlus">BindPlus</a>._
<span class="keyword">import</span> util.<span class="delimiter">{</span>Helpers, BindHelpers<span class="delimiter">}</span>
<span class="keyword">import</span> <a href="../../../../../util/net/liftweb/util/Helpers.scala.html#13346" title="object net.liftweb.util.Helpers">Helpers</a>._
<span class="keyword">import</span> http.<span class="delimiter">{</span>SHtml, S, DispatchSnippet, js<span class="delimiter">}</span>
<span class="keyword">import</span> <a href="../../../../../webkit/net/liftweb/http/S.scala.html#14641" title="object net.liftweb.http.S">S</a>.?

<span class="keyword">import</span> js.<a href="../../../../../webkit/net/liftweb/http/js/JsCommands.scala.html#14916" title="object net.liftweb.http.js.JsCmds">JsCmds</a>.<span class="delimiter">{</span>Script, Run<span class="delimiter">}</span>

<span class="keyword">import</span> mapper.<span class="delimiter">{</span>Mapper, MetaMapper, LongKeyedMetaMapper, MappedField<span class="delimiter">}</span>

<span class="keyword">import</span> <a href="Util.scala.html#11941" title="object net.liftweb.mapper.view.Util">Util</a>._


<span class="comment">/**
 * Keeps track of pending adds to and removes from a list of mappers.
 * Supports in-memory sorting by a field.
 * Usage: override metaMapper with a MetaMapper instance, call sortBy
 * to specify the field to sort by. If it is already sorted by that
 * field it will sort descending, otherwise ascending.
 * Call save to actualize changes.
 * @author nafg
 */</span>
<span class="keyword">trait</span> <a title="trait ItemsList[T &lt;: net.liftweb.mapper.Mapper[T]] extends java.lang.Object with ScalaObject" id="11922">ItemsList</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: net.liftweb.mapper.Mapper[T]" id="11923">T</a> &lt;: Mapper<span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">]</span> <span title="ScalaObject" class="delimiter">{</span>
  <span class="comment">/**
   * The MetaMapper that provides create and findAll functionality etc.
   * Must itself be a T (the mapper type it represents)
   */</span>
  <span class="keyword">def</span> <a title="=&gt; T with net.liftweb.mapper.MetaMapper[T]" id="195432">metaMapper</a>: <a href="#195475" title="ItemsList extends T with net.liftweb.mapper.MetaMapper[T]">T</a> <span class="keyword">with</span> MetaMapper<span class="delimiter">[</span>T<span class="delimiter">]</span>

  <span class="comment">/**
   * Whether the sorting algorithm should put null first or last
   */</span>
  <span class="keyword">var</span> <a title="Boolean" id="195434">sortNullFirst</a> = <span title="Boolean(true)" class="keyword">true</span>
  <span class="comment">/**
   * The list of items that correspond to items in the database
   */</span>
  <span class="keyword">var</span> <a title="List[T]" id="195437">current</a>: <span title="List[T]">List</span><span class="delimiter">[</span>T<span class="delimiter">]</span> = <span title="object Nil">Nil</span>
  <span class="comment">/**
   * The list of items pending to be added to the database
   */</span>
  <span class="keyword">var</span> <a title="List[T]" id="195440">added</a>: <span title="List[T]">List</span><span class="delimiter">[</span>T<span class="delimiter">]</span> = <span title="object Nil">Nil</span>
  <span class="comment">/**
   * The list of items to be deleted from current
   */</span>
  <span class="keyword">var</span> <a title="List[T]" id="195443">removed</a>: <span title="List[T]">List</span><span class="delimiter">[</span>T<span class="delimiter">]</span> = <span title="object Nil">Nil</span>
  <span class="comment">/**
   * The field to sort by, if any
   */</span>
  <span class="keyword">var</span> <a title="Option[net.liftweb.mapper.MappedField[_, T]]" id="195446">sortField</a>: <span title="Option[net.liftweb.mapper.MappedField[_, T]]">Option</span><span class="delimiter">[</span>MappedField<span class="delimiter">[</span>_, T<span class="delimiter">]</span><span class="delimiter">]</span> = <span title="object None">None</span>
  <span class="comment">/**
   * The sort direction
   */</span>
  <span class="keyword">var</span> <a title="Boolean" id="195449">ascending</a> = <span title="Boolean(true)" class="keyword">true</span>

  <span class="comment">/**
   * Returns the items (current + added - removed), sorted.
   * Sorting sorts strings case-insensitive, as well as Ordered and java.lang.Comparable.
   * Anything else where both values are nonnull are sorted via their toString method (case sensitive)
   */</span>
  <span class="keyword">def</span> <a title="=&gt; Seq[T]" id="195451">items</a>: <span title="Seq[T]">Seq</span><span class="delimiter">[</span>T<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">import</span> scala.util.<span title="object scala.util.Sorting">Sorting</span>._
    <span class="keyword">val</span> <a title="List[T]" id="195483">unsorted</a>: <span title="List[T]">List</span><span class="delimiter">[</span>T<span class="delimiter">]</span> = <a href="#195437" title="=&gt; List[T]">current</a>.<span title="(p: T =&gt; Boolean)List[T]">filterNot</span><span class="delimiter">(</span><a href="#195443" title="=&gt; List[T]">removed</a>.<a href="#195558" title="(elem: Any)Boolean">contains</a><span class="delimiter">)</span> <span title="(that: scala.collection.GenTraversableOnce[T])(implicit bf: scala.collection.generic.CanBuildFrom[List[T],T,List[T]])List[T]">++</span> <a href="#195440" title="=&gt; List[T]">added</a>
    <a href="#195446" title="=&gt; Option[net.liftweb.mapper.MappedField[_, T]]">sortField</a> <span title="Seq[T]" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <span title="List[T]">None</span> =&gt;
        <a href="#195483" title="List[T]">unsorted</a>
      <span class="keyword">case</span> <span title="List[T]">Some</span><span class="delimiter">(</span><a title="net.liftweb.mapper.MappedField[_, T]" id="195636">field</a><span class="delimiter">)</span> =&gt;
        <a href="#195483" title="List[T]">unsorted</a>.<span title="(lt: (T, T) =&gt; Boolean)List[T]">sortWith</span> <span class="delimiter">{</span>
          <span class="delimiter">(</span><a title="T" id="195646">a</a>, <a title="T" id="195647">b</a><span class="delimiter">)</span> =&gt; <span class="delimiter">(</span><span title="(_1: Any, _2: Any)(Any, Any)" class="delimiter">(</span><a href="#195636" title="net.liftweb.mapper.MappedField[_, T]">field</a>.<a href="../MappedField.scala.html#147394" title="((actual: T)net.liftweb.mapper.MappedField[_0,T]) forSome { type _0; type _0; type _0; type _0 }">actualField</a><span class="delimiter">(</span><a href="#195646" title="T">a</a><span class="delimiter">)</span>.<a href="../MappedField.scala.html#147450" title="=&gt; _0">is</a>: <span title="Any">Any</span>, <a href="#195636" title="net.liftweb.mapper.MappedField[_, T]">field</a>.<a href="../MappedField.scala.html#147394" title="((actual: T)net.liftweb.mapper.MappedField[_0,T]) forSome { type _0; type _0; type _0; type _0 }">actualField</a><span class="delimiter">(</span><a href="#195647" title="T">b</a><span class="delimiter">)</span>.<a href="../MappedField.scala.html#147450" title="=&gt; _0">is</a>: <span title="Any">Any</span><span class="delimiter">)</span> <span title="Boolean" class="keyword">match</span> <span class="delimiter">{</span>
            <span class="keyword">case</span> <span title="Boolean" class="delimiter">(</span><a title="String" id="195667">aval</a>: <span title="String">String</span>, <a title="String" id="195668">bval</a>: <span title="String">String</span><span class="delimiter">)</span> =&gt; <a href="#195667" title="String">aval</a>.<span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">toLowerCase</span> <span title="(that: String)Boolean">&lt;</span> <a href="#195668" title="String">bval</a>.<span title="()java.lang.String">toLowerCase</span>
            <span class="keyword">case</span> <span title="Boolean" class="delimiter">(</span><a title="Ordered[Any]" id="195681">aval</a>: <span title="Ordered[Any]">Ordered</span><span class="delimiter">[</span>Any<span class="delimiter">]</span>, <a title="Ordered[Any]" id="195682">bval</a>: <span title="Ordered[Any]">Ordered</span><span class="delimiter">[</span>Any<span class="delimiter">]</span><span class="delimiter">)</span> =&gt; <a href="#195681" title="Ordered[Any]">aval</a> <span title="(that: Any)Boolean">&lt;</span> <a href="#195682" title="Ordered[Any]">bval</a>
            <span class="keyword">case</span> <span title="Boolean" class="delimiter">(</span><a title="java.lang.Comparable[Any]" id="195686">aval</a>: java.lang.<span title="java.lang.Comparable[Any]">Comparable</span><span class="delimiter">[</span>Any<span class="delimiter">]</span>, <a title="java.lang.Comparable[Any]" id="195687">bval</a>: java.lang.<span title="java.lang.Comparable[Any]">Comparable</span><span class="delimiter">[</span>Any<span class="delimiter">]</span><span class="delimiter">)</span> =&gt; <span class="delimiter">(</span><a href="#195686" title="java.lang.Comparable[Any]">aval</a> <span title="(x$1: Any)Int">compareTo</span> <a href="#195687" title="java.lang.Comparable[Any]">bval</a><span class="delimiter">)</span> <span title="(x: Int)Boolean">&lt;</span> <span title="Int(0)" class="int">0</span>
            <span class="keyword">case</span> <span title="Boolean" class="delimiter">(</span><span title="Null(null)" class="keyword">null</span>, _<span class="delimiter">)</span> =&gt; <a href="#195434" title="=&gt; Boolean">sortNullFirst</a>
            <span class="keyword">case</span> <span title="Boolean" class="delimiter">(</span>_, <span title="Null(null)" class="keyword">null</span><span class="delimiter">)</span> =&gt; <span title="=&gt; Boolean">!</span><a href="#195434" title="=&gt; Boolean">sortNullFirst</a>
            <span class="keyword">case</span> <span title="Boolean" class="delimiter">(</span><a title="Any" id="195699">aval</a>, <a title="Any" id="195700">bval</a><span class="delimiter">)</span> =&gt; <a href="#195699" title="Any">aval</a>.<span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">toString</span> <span title="(that: String)Boolean">&lt;</span> <a href="#195700" title="Any">bval</a>.<span title="()java.lang.String">toString</span>
          <span class="delimiter">}</span><span class="delimiter">)</span> <span title="Boolean" class="keyword">match</span> <span class="delimiter">{</span>
            <span class="keyword">case</span> <a title="Boolean" id="195708">cmp</a> =&gt;
              <span title="Boolean" class="keyword">if</span><span class="delimiter">(</span><a href="#195449" title="=&gt; Boolean">ascending</a><span class="delimiter">)</span> <a href="#195708" title="Boolean">cmp</a> <span class="keyword">else</span> <span title="=&gt; Boolean">!</span><a href="#195708" title="Boolean">cmp</a>
          <span class="delimiter">}</span>
        <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
  <span class="comment">/**
   * Adds a new, unsaved item
   */</span>
  <span class="keyword">def</span> <a title="=&gt; Unit" id="195452">add</a> <span class="delimiter">{</span>
    <a href="#195440" title="(x$1: List[T])Unit">added</a> <span title="(x: T)List[T]">::=</span> <a href="#195432" title="=&gt; T with net.liftweb.mapper.MetaMapper[T]">metaMapper</a>.<a href="../MetaMapper.scala.html#146838" title="=&gt; T">create</a>
  <span class="delimiter">}</span>
  <span class="comment">/**
   * Marks an item pending for removal
   */</span>
  <span class="keyword">def</span> <a title="(i: T)Unit" id="195453">remove</a><span class="delimiter">(</span><a title="T" id="195718">i</a>: <a href="#11923" title="T">T</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span title="Unit" class="keyword">if</span><span class="delimiter">(</span><a href="#195440" title="=&gt; List[T]">added</a>.<span title="(p: T =&gt; Boolean)Boolean">exists</span><span class="delimiter">(</span><a href="#195718" title="T">i</a>.<a href="#195728" title="(x$1: AnyRef)Boolean">eq</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="#195440" title="(x$1: List[T])Unit">added</a> = <a href="#195440" title="=&gt; List[T]">added</a>.<span title="(p: T =&gt; Boolean)List[T]">filter</span><span class="delimiter">(</span><a href="#195718" title="T">i</a>.<a href="#195734" title="(x$1: AnyRef)Boolean">ne</a><span class="delimiter">)</span>
    <span class="keyword">else</span> <span title="Unit" class="keyword">if</span><span class="delimiter">(</span><a href="#195437" title="=&gt; List[T]">current</a>.<span title="(elem: Any)Boolean">contains</span><span class="delimiter">(</span><a href="#195718" title="T">i</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="#195443" title="(x$1: List[T])Unit">removed</a> <span title="(x: T)List[T]">::=</span> <a href="#195718" title="T">i</a>
  <span class="delimiter">}</span>
  <span class="comment">/**
   * Reset the ItemsList from the database: calls refresh, and 'added' and 'removed' are cleared.
   */</span>
  <span class="keyword">def</span> <a title="=&gt; Unit" id="195454">reload</a> <span class="delimiter">{</span>
    <a href="#195455" title="=&gt; Unit">refresh</a>
    <a href="#195440" title="(x$1: List[T])Unit">added</a> = <span title="object Nil">Nil</span>
    <a href="#195443" title="(x$1: List[T])Unit">removed</a> = <span title="object Nil">Nil</span>
  <span class="delimiter">}</span>
  <span class="comment">/**
   * Reloads the contents of 'current' from the database
   */</span>
  <span class="keyword">def</span> <a title="=&gt; Unit" id="195455">refresh</a> <span class="delimiter">{</span>
    <a href="#195437" title="(x$1: List[T])Unit">current</a> = <a href="#195432" title="=&gt; T with net.liftweb.mapper.MetaMapper[T]">metaMapper</a>.<a href="../MetaMapper.scala.html#146797" title="()List[T]">findAll</a>
  <span class="delimiter">}</span>
  <span class="comment">/**
   * Sends to the database:
   *  added is saved
   *  removed is deleted
   *  (current - removed) is saved
   */</span>
  <span class="keyword">def</span> <a title="=&gt; Unit" id="195456">save</a> <span class="delimiter">{</span>
    <span class="keyword">val</span> <a href="#195750" title="(List[T], List[T])" class="delimiter">(</a><a href="#195749" title="List[T]" id="195750">successAdd</a>, <a href="#195749" title="List[T]" id="195751">failAdd</a><span class="delimiter">)</span> = <a href="#195440" title="=&gt; List[T]">added</a>.<span title="(p: T =&gt; Boolean)(List[T], List[T])">partition</span><span title="(List[T], List[T]) @unchecked" class="delimiter">(</span><a href="#195760" title="T">_</a>.<a href="../Mapper.scala.html#147084" title="()Boolean">save</a><span class="delimiter">)</span>
    <a href="#195440" title="(x$1: List[T])Unit">added</a> = <a href="#195751" title="List[T]">failAdd</a>

    <span class="keyword">val</span> <a href="#195753" title="(List[T], List[T])" class="delimiter">(</a><a href="#195752" title="List[T]" id="195753">successRemove</a>, <a href="#195752" title="List[T]" id="195754">failRemove</a><span class="delimiter">)</span> = <a href="#195443" title="=&gt; List[T]">removed</a>.<span title="(p: T =&gt; Boolean)(List[T], List[T])">partition</span><span title="(List[T], List[T]) @unchecked" class="delimiter">(</span><a href="#195776" title="T">_</a>.<a href="../Mapper.scala.html#147091" title="=&gt; Boolean">delete_!</a><span class="delimiter">)</span>
    <a href="#195437" title="(x$1: List[T])Unit">current</a> = <a href="#195437" title="=&gt; List[T]">current</a>.<span title="(p: T =&gt; Boolean)List[T]">filterNot</span><span class="delimiter">(</span><a href="#195753" title="List[T]">successRemove</a>.<a href="#195792" title="(elem: Any)Boolean">contains</a><span class="delimiter">)</span>
    <a href="#195443" title="(x$1: List[T])Unit">removed</a> = <a href="#195754" title="List[T]">failRemove</a>

    <span class="keyword">for</span><span class="delimiter">(</span><a title="T" id="195804">c</a> &lt;- <a href="#195437" title="(f: T =&gt; Boolean)Unit">current</a> <span class="keyword">if</span> <a href="#195804" title="T">c</a>.<a href="../Mapper.scala.html#147088" title="=&gt; List[net.liftweb.util.FieldError]">validate</a>.<span title="=&gt; Boolean">isEmpty</span><span class="delimiter">)</span> <a href="#195804" title="T">c</a>.<a href="../Mapper.scala.html#147084" title="()Boolean">save</a>

    <a href="#195437" title="(x$1: List[T])Unit">current</a> <span title="(that: scala.collection.GenTraversableOnce[T])(implicit bf: scala.collection.generic.CanBuildFrom[List[T],T,List[T]])List[T]">++=</span> <a href="#195750" title="List[T]">successAdd</a>
  <span class="delimiter">}</span>


  <span class="keyword">def</span> <a title="(field: net.liftweb.mapper.MappedField[_, T])Unit" id="195457">sortBy</a><span class="delimiter">(</span><a title="net.liftweb.mapper.MappedField[_, T]" id="195867">field</a>: <a href="../MappedField.scala.html#11427" title="net.liftweb.mapper.MappedField[_, T]">MappedField</a><span class="delimiter">[</span>_, T<span class="delimiter">]</span><span class="delimiter">)</span> = <span title="(_1: Option[net.liftweb.mapper.MappedField[_, T]], _2: Boolean)(Option[net.liftweb.mapper.MappedField[_, T]], Boolean)" class="delimiter">(</span><a href="#195446" title="=&gt; Option[net.liftweb.mapper.MappedField[_, T]]">sortField</a>, <a href="#195449" title="=&gt; Boolean">ascending</a><span class="delimiter">)</span> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <span title="Unit" class="delimiter">(</span>Some<span class="delimiter">(</span><a title="net.liftweb.mapper.MappedField[_, T]" id="195879">f</a><span class="delimiter">)</span>, <span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span> <span class="keyword">if</span> <a href="#195879" title="net.liftweb.mapper.MappedField[_, T]">f</a> <span title="(x$1: AnyRef)Boolean">eq</span> <a href="#195867" title="net.liftweb.mapper.MappedField[_, T]">field</a> =&gt;
      <a href="#195449" title="(x$1: Boolean)Unit">ascending</a> = <span title="Boolean(false)" class="keyword">false</span>
    <span class="keyword">case</span> <span title="Unit">_</span> | <span title="Null(null)" class="keyword">null</span> =&gt;
      <a href="#195446" title="(x$1: Option[net.liftweb.mapper.MappedField[_, T]])Unit">sortField</a> = <span title="(x: net.liftweb.mapper.MappedField[_$2,T])Some[net.liftweb.mapper.MappedField[_$2,T]]">Some</span><span class="delimiter">(</span><a href="#195867" title="net.liftweb.mapper.MappedField[_, T]">field</a><span class="delimiter">)</span>
      <a href="#195449" title="(x$1: Boolean)Unit">ascending</a> = <span title="Boolean(true)" class="keyword">true</span>
  <span class="delimiter">}</span>
  <span class="keyword">def</span> <a title="(field: net.liftweb.mapper.MappedField[_, T])() =&gt; Unit" id="195458">sortFn</a><span class="delimiter">(</span><a title="net.liftweb.mapper.MappedField[_, T]" id="195898">field</a>: <a href="../MappedField.scala.html#11427" title="net.liftweb.mapper.MappedField[_, T]">MappedField</a><span class="delimiter">[</span>_, T<span class="delimiter">]</span><span class="delimiter">)</span> = <span title="(_1: Option[net.liftweb.mapper.MappedField[_, T]], _2: Boolean)(Option[net.liftweb.mapper.MappedField[_, T]], Boolean)" class="delimiter">(</span><a href="#195446" title="=&gt; Option[net.liftweb.mapper.MappedField[_, T]]">sortField</a>, <a href="#195449" title="=&gt; Boolean">ascending</a><span class="delimiter">)</span> <span title="() =&gt; Unit" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <span title="() =&gt; Unit" class="delimiter">(</span>Some<span class="delimiter">(</span><a title="net.liftweb.mapper.MappedField[_, T]" id="195910">f</a><span class="delimiter">)</span>, <span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span> <span class="keyword">if</span> <a href="#195910" title="net.liftweb.mapper.MappedField[_, T]">f</a> <span title="(x$1: AnyRef)Boolean">eq</span> <a href="#195898" title="net.liftweb.mapper.MappedField[_, T]">field</a> =&gt;
      <span class="delimiter">(</span><span class="delimiter">)</span> =&gt; <a href="#195449" title="(x$1: Boolean)Unit">ascending</a> = <span title="Boolean(false)" class="keyword">false</span>
    <span class="keyword">case</span> <span title="() =&gt; Unit">_</span> | <span title="Null(null)" class="keyword">null</span> =&gt;
      <span class="delimiter">(</span><span class="delimiter">)</span> =&gt; <span class="delimiter">{</span>
        <a href="#195446" title="(x$1: Option[net.liftweb.mapper.MappedField[_, T]])Unit">sortField</a> = <span title="(x: net.liftweb.mapper.MappedField[_$3,T])Some[net.liftweb.mapper.MappedField[_$3,T]]">Some</span><span class="delimiter">(</span><a href="#195898" title="net.liftweb.mapper.MappedField[_, T]">field</a><span class="delimiter">)</span>
        <a href="#195449" title="(x$1: Boolean)Unit">ascending</a> = <span title="Boolean(true)" class="keyword">true</span>
      <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <a href="#195454" title="=&gt; Unit">reload</a>
<span class="delimiter">}</span>


<span class="comment">/**
 * Holds a registry of TableEditor delegates
 * Call TableEditor.registerTable(name_to_use_in_view, meta_mapper_for_the_table, display_title)
 * in Boot after DB.defineConnectionManager.
 * Referencing TableEditor triggers registering its snippet package and enabling
 * the provided template, /tableeditor/default.
 * @author nafg
 */</span>
<span class="keyword">object</span> <a title="object net.liftweb.mapper.view.TableEditor" id="11924">TableEditor</a> <span title="ScalaObject" class="delimiter">{</span>
  net.liftweb.http.<a href="../../../../../webkit/net/liftweb/http/LiftRules.scala.html#158817" title="implicit net.liftweb.http.LiftRulesMocker.toLiftRules : (in: net.liftweb.http.LiftRulesMocker)net.liftweb.http.LiftRules">LiftRules</a>.<a href="../../../../../webkit/net/liftweb/http/LiftRules.scala.html#159078" title="(what: String)Unit">addToPackages</a><span class="delimiter">(</span><span title="java.lang.String(&quot;net.liftweb.mapper.view&quot;)" class="string">&quot;net.liftweb.mapper.view&quot;</span><span class="delimiter">)</span>

  <span class="keyword">private</span><span class="delimiter">[</span>view<span class="delimiter">]</span> <span class="keyword">val</span> <a title="scala.collection.mutable.HashMap[String,net.liftweb.mapper.view.TableEditorImpl[_]]" id="195932">map</a> = <span title="()scala.collection.mutable.HashMap[String,net.liftweb.mapper.view.TableEditorImpl[_]]" class="keyword">new</span> scala.collection.mutable.<span title="scala.collection.mutable.HashMap[String,net.liftweb.mapper.view.TableEditorImpl[_]]">HashMap</span><span class="delimiter">[</span>String, TableEditorImpl<span class="delimiter">[</span>_<span class="delimiter">]</span><span class="delimiter">]</span>
  <span class="keyword">def</span> <a title="[T &lt;: net.liftweb.mapper.Mapper[T]](name: String, meta: T with net.liftweb.mapper.MetaMapper[T], title: String)Unit" id="195934">registerTable</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: net.liftweb.mapper.Mapper[T]" id="195936">T</a>&lt;:Mapper<span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">(</span><a title="String" id="196070">name</a>: <span title="String">String</span>, <a title="TableEditor extends T with net.liftweb.mapper.MetaMapper[T]" id="196071">meta</a>: <a href="#196109" title="TableEditor extends T with net.liftweb.mapper.MetaMapper[T]">T</a> <span class="keyword">with</span> MetaMapper<span class="delimiter">[</span>T<span class="delimiter">]</span>, <a title="String" id="196072">title</a>: <span title="String">String</span><span class="delimiter">)</span> =
    <a href="#195932" title="(key: String, value: net.liftweb.mapper.view.TableEditorImpl[_])Unit">map</a><span class="delimiter">(</span><a href="#196070" title="String">name</a><span class="delimiter">)</span> = <span title="net.liftweb.mapper.view.TableEditorImpl[T]" class="keyword">new</span> <a href="#11929" title="net.liftweb.mapper.view.TableEditorImpl[T]">TableEditorImpl</a><span class="delimiter">(</span><a href="#196072" title="String">title</a>, <a href="#196071" title="TableEditor extends T with net.liftweb.mapper.MetaMapper[T]">meta</a><span class="delimiter">)</span>
<span class="delimiter">}</span>

<span class="keyword">package</span> snippet <span class="delimiter">{</span>
  <span class="comment">/**
   * This is the snippet that the view references.
   * It requires the following contents:
   * table:title - the title registered in Boot
   * header:fields - repeated for every field of the MetaMapper, for the header.
   *  field:name - the displayName of the field, capified. Links to sort by the field.
   * table:items - repeated for each record
   * item:fields - repeated for each field of the current record
   *  field:form - the result of toForm on the field
   * item:removeBtn - a button to remove the current item
   * table:insertBtn - a button to insert another item
   * For a default layout, use lift:embed what=&quot;/tableeditor/default&quot;, with
   * @author nafg
   */</span>
  <span class="keyword">class</span> <a title="class TableEditor extends java.lang.Object with net.liftweb.http.DispatchSnippet with ScalaObject" id="11928">TableEditor</a> <a href="#11928" title="ScalaObject" class="keyword">extends</a> <a href="../../../../../webkit/net/liftweb/http/StatefulSnippet.scala.html#14717" title="net.liftweb.http.DispatchSnippet">DispatchSnippet</a> <span class="delimiter">{</span>
    <span class="keyword">private</span> <span class="keyword">def</span> <a title="=&gt; net.liftweb.common.Box[net.liftweb.mapper.view.TableEditorImpl[_]]" id="196125">getInstance</a>: <a href="../../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[net.liftweb.mapper.view.TableEditorImpl[_]]">Box</a><span class="delimiter">[</span>TableEditorImpl<span class="delimiter">[</span>_<span class="delimiter">]</span><span class="delimiter">]</span> = <a href="../../../../../webkit/net/liftweb/http/S.scala.html#14641" title="object net.liftweb.http.S">S</a>.<a href="../../../../../util/net/liftweb/util/BindHelpers.scala.html#196136" title="(key: String)net.liftweb.common.Box[net.liftweb.http.S.attr.Info]">attr</a><span class="delimiter">(</span><span title="java.lang.String(&quot;table&quot;)" class="string">&quot;table&quot;</span><span class="delimiter">)</span>.<a href="../../../../../common/net/liftweb/common/Box.scala.html#27020" title="(f: net.liftweb.http.S.attr.Info =&gt; net.liftweb.mapper.view.TableEditorImpl[_])net.liftweb.common.Box[net.liftweb.mapper.view.TableEditorImpl[_]]">map</a><span class="delimiter">(</span><a href="#11924" title="object net.liftweb.mapper.view.TableEditor">TableEditor</a>.<a href="#195932" title="(key: String)net.liftweb.mapper.view.TableEditorImpl[_]">map</a><span class="delimiter">(</span><a href="#196250" title="net.liftweb.http.S.attr.Info">_</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="keyword">def</span> <a title="=&gt; PartialFunction[String,scala.xml.NodeSeq =&gt; scala.xml.NodeSeq]" id="196126">dispatch</a> = <a href="#196298" title="scala.xml.NodeSeq =&gt; scala.xml.NodeSeq" class="delimiter">{</a>
      <span class="keyword">case</span> <span title="scala.xml.NodeSeq =&gt; scala.xml.NodeSeq" class="string">&quot;edit&quot;</span> =&gt;
        <span class="keyword">val</span> <a title="net.liftweb.mapper.view.TableEditorImpl[_]" id="196299">o</a> = <a href="#196125" title="=&gt; net.liftweb.common.Box[net.liftweb.mapper.view.TableEditorImpl[_]]">getInstance</a>.<a href="../../../../../common/net/liftweb/common/Box.scala.html#27015" title="=&gt; net.liftweb.mapper.view.TableEditorImpl[_]">open_!</a>
        <a href="#196299" title="net.liftweb.mapper.view.TableEditorImpl[_]">o</a>.<a href="#196089" title="(xhtml: scala.xml.NodeSeq)scala.xml.NodeSeq">edit</a> _
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="comment">/**
 * This class does the actual view binding against a ItemsList.
 * The implementation is in the base trait ItemsListEditor
 * @author nafg
 */</span>
<span class="keyword">protected</span> <span class="keyword">class</span> <a title="class TableEditorImpl[T &lt;: net.liftweb.mapper.Mapper[T]] extends java.lang.Object with net.liftweb.mapper.view.ItemsListEditor[T] with ScalaObject" id="11929">TableEditorImpl</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: net.liftweb.mapper.Mapper[T]" id="11930">T</a> &lt;: Mapper<span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">]</span><a href="#11929" title="ScalaObject" class="delimiter">(</a><span class="keyword">val</span> <a title="String" id="196100">title</a>: <span title="String">String</span>, <a title="view extends T with net.liftweb.mapper.MetaMapper[T]" id="196101">meta</a>: <span title="view extends T with net.liftweb.mapper.MetaMapper[T]">T</span> <span class="keyword">with</span> MetaMapper<span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#11931" title="net.liftweb.mapper.view.ItemsListEditor[T]">ItemsListEditor</a><span class="delimiter">[</span>T<span class="delimiter">]</span> <span class="delimiter">{</span>
  <span class="keyword">var</span> <a title="items extends java.lang.Object with net.liftweb.mapper.view.ItemsList[T]" id="196097">items</a> = <a href="#196309" title="java.lang.Object with net.liftweb.mapper.view.ItemsList[T]" class="keyword">new</a> <a title="anonymous class $anon extends java.lang.Object with net.liftweb.mapper.view.ItemsList[T]" id="196309">ItemsList</a><span class="delimiter">[</span>T<span class="delimiter">]</span> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="=&gt; T with net.liftweb.mapper.MetaMapper[T]" id="196311">metaMapper</a> = <a href="#196101" title="view extends T with net.liftweb.mapper.MetaMapper[T]">meta</a>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="comment">/**
 * General trait to edit an ItemsList.
 * @author nafg
 */</span>
<span class="keyword">trait</span> <a title="trait ItemsListEditor[T &lt;: net.liftweb.mapper.Mapper[T]] extends java.lang.Object with ScalaObject" id="11931">ItemsListEditor</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: net.liftweb.mapper.Mapper[T]" id="11932">T</a>&lt;:Mapper<span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">]</span> <span title="ScalaObject" class="delimiter">{</span>
  <span class="keyword">def</span> <a title="=&gt; net.liftweb.mapper.view.ItemsList[T]" id="196080">items</a>: <a href="#11922" title="net.liftweb.mapper.view.ItemsList[T]">ItemsList</a><span class="delimiter">[</span>T<span class="delimiter">]</span>
  <span class="keyword">def</span> <a title="=&gt; String" id="196081">title</a>: <span title="String">String</span>

  <span class="keyword">def</span> <a title="=&gt; Unit" id="196082">onInsert</a>: <span title="Unit">Unit</span> = <a href="#196080" title="=&gt; net.liftweb.mapper.view.ItemsList[T]">items</a>.<a href="#195452" title="=&gt; Unit">add</a>
  <span class="keyword">def</span> <a title="(item: T)Unit" id="196083">onRemove</a><span class="delimiter">(</span><a title="T" id="196342">item</a>: <a href="#11932" title="T">T</a><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <a href="#196080" title="=&gt; net.liftweb.mapper.view.ItemsList[T]">items</a>.<a href="#195453" title="(i: T)Unit">remove</a><span class="delimiter">(</span><a href="#196342" title="T">item</a><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="=&gt; Unit" id="196084">onSubmit</a>: <span title="Unit">Unit</span> = <span class="keyword">try</span> <span class="delimiter">{</span>
    <a href="#196080" title="=&gt; net.liftweb.mapper.view.ItemsList[T]">items</a>.<a href="#195456" title="=&gt; Unit">save</a>
  <span class="delimiter">}</span> <span class="keyword">catch</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <a title="Unit" id="196347">e</a>: java.sql.<span title="java.sql.SQLException">SQLException</span> =&gt;
      <a href="../../../../../webkit/net/liftweb/http/S.scala.html#14641" title="object net.liftweb.http.S">S</a>.<a href="../../../../../webkit/net/liftweb/http/S.scala.html#49540" title="(n: String)Unit">error</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Not all items could be saved!&quot;)" class="string">&quot;Not all items could be saved!&quot;</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>
  <span class="keyword">def</span> <a title="(f: net.liftweb.mapper.MappedField[_, T])() =&gt; Unit" id="196085">sortFn</a><span class="delimiter">(</span><a title="net.liftweb.mapper.MappedField[_, T]" id="196352">f</a>: <a href="../MappedField.scala.html#11427" title="net.liftweb.mapper.MappedField[_, T]">MappedField</a><span class="delimiter">[</span>_, T<span class="delimiter">]</span><span class="delimiter">)</span>: <span class="delimiter">(</span><span class="delimiter">)</span>=&gt;Unit = <a href="#196080" title="=&gt; net.liftweb.mapper.view.ItemsList[T]">items</a>.<a href="#195458" title="(field: net.liftweb.mapper.MappedField[_, T])() =&gt; Unit">sortFn</a><span class="delimiter">(</span><a href="#196352" title="net.liftweb.mapper.MappedField[_, T]">f</a><span class="delimiter">)</span>

  <span class="keyword">val</span> <a title="net.liftweb.mapper.MappedField[_, T] =&gt; Boolean" id="196086">fieldFilter</a>: MappedField<span class="delimiter">[</span>_,T<span class="delimiter">]</span>=&gt;Boolean = <span class="delimiter">(</span>f: <a href="../MappedField.scala.html#11427" title="net.liftweb.mapper.MappedField[_, T]">MappedField</a><span class="delimiter">[</span>_,T<span class="delimiter">]</span><span class="delimiter">)</span>=&gt;<span title="Boolean(true)" class="keyword">true</span>

  <span class="keyword">def</span> <a title="(item: T)scala.xml.NodeSeq =&gt; scala.xml.NodeSeq" id="196088">customBind</a><span class="delimiter">(</span><a title="T" id="196369">item</a>: <a href="#11932" title="T">T</a><span class="delimiter">)</span>: NodeSeq=&gt;NodeSeq = <span class="delimiter">(</span>ns: <span title="scala.xml.NodeSeq">NodeSeq</span><span class="delimiter">)</span> =&gt; <a href="#196372" title="scala.xml.NodeSeq">ns</a>

  <span class="keyword">def</span> <a title="(xhtml: scala.xml.NodeSeq)scala.xml.NodeSeq" id="196089">edit</a><span class="delimiter">(</span><a title="scala.xml.NodeSeq" id="196302">xhtml</a>: <span title="scala.xml.NodeSeq">NodeSeq</span><span class="delimiter">)</span>: <span title="scala.xml.NodeSeq">NodeSeq</span> = <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="=&gt; scala.xml.Elem" id="196373">unsavedScript</a> = <span class="delimiter">(</span>&lt;<a title="scala.xml.Elem" id="196376">head</a>&gt;<span class="delimiter">{</span><a href="../../../../../webkit/net/liftweb/http/js/JsCommands.scala.html#196378" title="(script: net.liftweb.http.js.JsCmd)scala.xml.Node">Script</a><span class="delimiter">(</span><a href="../../../../../webkit/net/liftweb/http/js/JsCommands.scala.html#196384" title="(text: String)net.liftweb.http.js.JsCmds.Run">Run</a><span class="delimiter">(</span><span title="java.lang.String(&quot;\012                           var safeToContinue = false\012                           window.onbeforeunload = function(evt) {{  // thanks Tim!\012                             if(!safeToContinue) {{\012                               var reply = \&quot;You have unsaved changes!\&quot;;\012                               if(typeof evt == \'undefined\') evt = window.event;\012                               if(evt) evt.returnValue = reply;\012                               return reply;\012                             }}\012                           }}\012    &quot;)" class="string">&quot;&quot;&quot;
                           var safeToContinue = false
                           window.onbeforeunload = function(evt) {{  // thanks Tim!
                             if(!safeToContinue) {{
                               var reply = &quot;You have unsaved changes!&quot;;
                               if(typeof evt == 'undefined') evt = window.event;
                               if(evt) evt.returnValue = reply;
                               return reply;
                             }}
                           }}
    &quot;&quot;&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">}</span>&lt;/head&gt;<span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="net.liftweb.util.Helpers.TheStrBindParam" id="196374">noPrompt</a> = <a href="../../../../../util/net/liftweb/util/BindHelpers.scala.html#49003" title="implicit net.liftweb.util.BindHelpers.strToSuperArrowAssoc : (in: String)net.liftweb.util.Helpers.SuperArrowAssoc" class="string">&quot;onclick&quot;</a> <a href="../../../../../util/net/liftweb/util/BindHelpers.scala.html#58380" title="(in: String)net.liftweb.util.Helpers.TheStrBindParam">-&gt;</a> <span title="java.lang.String(&quot;safeToContinue=true&quot;)" class="string">&quot;safeToContinue=true&quot;</span>
    <span class="keyword">val</span> <a title="scala.xml.NodeSeq" id="196375">optScript</a> = <span title="scala.xml.NodeSeq" class="keyword">if</span><span class="delimiter">(</span>
      <span class="delimiter">(</span><a href="#196080" title="=&gt; net.liftweb.mapper.view.ItemsList[T]">items</a>.<a href="#195440" title="=&gt; List[T]">added</a>.<span title="=&gt; Int">length</span> <span title="(x: Int)Int">+</span> <a href="#196080" title="=&gt; net.liftweb.mapper.view.ItemsList[T]">items</a>.<a href="#195443" title="=&gt; List[T]">removed</a>.<span title="=&gt; Int">length</span> <span title="(x: Int)Boolean">==</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span title="(x: Boolean)Boolean">&amp;&amp;</span>
        <a href="#196080" title="=&gt; net.liftweb.mapper.view.ItemsList[T]">items</a>.<a href="#195437" title="=&gt; List[T]">current</a>.<span title="(p: T =&gt; Boolean)Boolean">forall</span><span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#196460" title="T">_</a>.<a href="../Mapper.scala.html#147109" title="=&gt; Boolean">dirty_?</a><span class="delimiter">)</span>
    <span class="delimiter">)</span> <span class="delimiter">{</span>
      <span title="object scala.xml.NodeSeq">NodeSeq</span>.<span title="=&gt; scala.xml.NodeSeq">Empty</span>
    <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
      <a href="#196373" title="=&gt; scala.xml.Elem">unsavedScript</a>
    <span class="delimiter">}</span>
    <a href="#196375" title="scala.xml.NodeSeq">optScript</a> <span title="(that: scala.collection.GenTraversableOnce[scala.xml.Node])(implicit bf: scala.collection.generic.CanBuildFrom[scala.xml.NodeSeq,scala.xml.Node,scala.xml.NodeSeq])scala.xml.NodeSeq">++</span> <a href="../../../../../util/net/liftweb/util/BindPlus.scala.html#195417" title="implicit net.liftweb.util.BindPlus.nodeSeqToBindable : (ns: scala.xml.NodeSeq)net.liftweb.util.BindPlus.BindableNodeSeq">xhtml</a>.<a href="../../../../../util/net/liftweb/util/BindPlus.scala.html#196483" title="(prefix: String, bindParams: net.liftweb.util.Helpers.BindParam*)scala.xml.NodeSeq">bind</a><a href="../../../../../util/net/liftweb/util/BindPlus.scala.html#195417" title="implicit net.liftweb.util.BindPlus.nodeSeqToBindable : (ns: scala.xml.NodeSeq)net.liftweb.util.BindPlus.BindableNodeSeq" class="delimiter">(</a><span title="java.lang.String(&quot;header&quot;)" class="string">&quot;header&quot;</span>,
         <a href="../../../../../util/net/liftweb/util/BindHelpers.scala.html#49003" title="implicit net.liftweb.util.BindHelpers.strToSuperArrowAssoc : (in: String)net.liftweb.util.Helpers.SuperArrowAssoc" class="string">&quot;fields&quot;</a> <a href="../../../../../util/net/liftweb/util/BindHelpers.scala.html#58385" title="(in: scala.xml.NodeSeq =&gt; scala.xml.NodeSeq)net.liftweb.util.Helpers.FuncBindParam">-&gt;</a> <a href="Util.scala.html#195425" title="[T &lt;: net.liftweb.mapper.Mapper[T]](mapper: T, fn: net.liftweb.mapper.MappedField[_, T] =&gt; Seq[net.liftweb.util.Helpers.BindParam], filter: net.liftweb.mapper.MappedField[_, T] =&gt; Boolean)scala.xml.NodeSeq =&gt; scala.xml.NodeSeq">eachField</a><span title="(mapper: T, fn: net.liftweb.mapper.MappedField[_, T] =&gt; Seq[net.liftweb.util.Helpers.BindParam], filter: net.liftweb.mapper.MappedField[_, T] =&gt; Boolean)scala.xml.NodeSeq =&gt; scala.xml.NodeSeq" class="delimiter">[</span><a href="#11932" title="T">T</a><span class="delimiter">]</span><span class="delimiter">(</span>
             <a href="#196080" title="=&gt; net.liftweb.mapper.view.ItemsList[T]">items</a>.<a href="#195432" title="=&gt; T with net.liftweb.mapper.MetaMapper[T]">metaMapper</a>,
             <span class="delimiter">(</span>f: <a href="../MappedField.scala.html#11427" title="net.liftweb.mapper.MappedField[_, T]">MappedField</a><span class="delimiter">[</span>_,T<span class="delimiter">]</span><span class="delimiter">)</span> =&gt; <span title="(elems: net.liftweb.util.Helpers.TheBindParam*)Seq[net.liftweb.util.Helpers.TheBindParam]">Seq</span><span class="delimiter">(</span>
               <a href="../../../../../util/net/liftweb/util/BindHelpers.scala.html#49003" title="implicit net.liftweb.util.BindHelpers.strToSuperArrowAssoc : (in: String)net.liftweb.util.Helpers.SuperArrowAssoc" class="string">&quot;name&quot;</a> <a href="../../../../../util/net/liftweb/util/BindHelpers.scala.html#58383" title="(in: scala.xml.Node)net.liftweb.util.Helpers.TheBindParam">-&gt;</a> <a href="../../../../../webkit/net/liftweb/http/SHtml.scala.html#14660" title="object net.liftweb.http.SHtml">SHtml</a>.<a href="../../../../../webkit/net/liftweb/http/SHtml.scala.html#152821" title="(to: String, func: () =&gt; Any, body: scala.xml.NodeSeq, attrs: net.liftweb.http.SHtml.ElemAttr*)scala.xml.Elem">link</a><span class="delimiter">(</span><a href="../../../../../webkit/net/liftweb/http/S.scala.html#14641" title="object net.liftweb.http.S">S</a>.<a href="../../../../../webkit/net/liftweb/http/S.scala.html#49359" title="=&gt; String">uri</a>, <a href="#196085" title="(f: net.liftweb.mapper.MappedField[_, T])() =&gt; Unit">sortFn</a><span class="delimiter">(</span><a href="#196556" title="net.liftweb.mapper.MappedField[_, T]">f</a><span class="delimiter">)</span>, <span title="(_data: String)scala.xml.Text">Text</span><span class="delimiter">(</span><a href="../../../../../util/net/liftweb/util/StringHelpers.scala.html#48843" title="(in: String)String">capify</a><span class="delimiter">(</span><a href="#196556" title="net.liftweb.mapper.MappedField[_, T]">f</a>.<a href="../MappedField.scala.html#147429" title="=&gt; String">displayName</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
             <span class="delimiter">)</span>,
             <a href="#196086" title="=&gt; net.liftweb.mapper.MappedField[_, T] =&gt; Boolean">fieldFilter</a>
         <span class="delimiter">)</span>
    <span class="delimiter">)</span>.<a href="../../../../../util/net/liftweb/util/BindPlus.scala.html#196483" title="(prefix: String, bindParams: net.liftweb.util.Helpers.BindParam*)scala.xml.NodeSeq">bind</a><span class="delimiter">(</span><span title="java.lang.String(&quot;table&quot;)" class="string">&quot;table&quot;</span>,
         <a href="../../../../../util/net/liftweb/util/BindHelpers.scala.html#49003" title="implicit net.liftweb.util.BindHelpers.strToSuperArrowAssoc : (in: String)net.liftweb.util.Helpers.SuperArrowAssoc" class="string">&quot;title&quot;</a> <a href="../../../../../util/net/liftweb/util/BindHelpers.scala.html#58380" title="(in: String)net.liftweb.util.Helpers.TheStrBindParam">-&gt;</a> <a href="#196081" title="=&gt; String">title</a>,
         <a href="../../../../../util/net/liftweb/util/BindHelpers.scala.html#49003" title="implicit net.liftweb.util.BindHelpers.strToSuperArrowAssoc : (in: String)net.liftweb.util.Helpers.SuperArrowAssoc" class="string">&quot;insertBtn&quot;</a> <a href="../../../../../util/net/liftweb/util/BindHelpers.scala.html#58383" title="(in: scala.xml.Node)net.liftweb.util.Helpers.TheBindParam">-&gt;</a> <a href="../../../../../webkit/net/liftweb/http/SHtml.scala.html#14660" title="object net.liftweb.http.SHtml">SHtml</a>.<a href="../../../../../webkit/net/liftweb/http/SHtml.scala.html#152863" title="(value: String, func: () =&gt; Any, attrs: net.liftweb.http.SHtml.ElemAttr*)scala.xml.Elem">submit</a><span class="delimiter">(</span><a href="../../../../../webkit/net/liftweb/http/S.scala.html#49351" title="(str: String)String">?</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Insert&quot;)" class="string">&quot;Insert&quot;</span><span class="delimiter">)</span>, <a href="#196082" title="=&gt; Unit">onInsert</a> _, <a href="../../../../../webkit/net/liftweb/http/SHtml.scala.html#162292" title="implicit net.liftweb.http.SHtml.ElemAttr.pairToBasic : (in: (String, String))net.liftweb.http.SHtml.ElemAttr">noPrompt</a><span class="delimiter">)</span>,
         <a href="../../../../../util/net/liftweb/util/BindHelpers.scala.html#49003" title="implicit net.liftweb.util.BindHelpers.strToSuperArrowAssoc : (in: String)net.liftweb.util.Helpers.SuperArrowAssoc" class="string">&quot;items&quot;</a> <a href="../../../../../util/net/liftweb/util/BindHelpers.scala.html#58385" title="(in: scala.xml.NodeSeq =&gt; scala.xml.NodeSeq)net.liftweb.util.Helpers.FuncBindParam">-&gt;</a> <span class="delimiter">{</span>ns:<span title="scala.xml.NodeSeq">NodeSeq</span> =&gt;
           <a href="#196080" title="=&gt; net.liftweb.mapper.view.ItemsList[T]">items</a>.<a href="#195451" title="=&gt; Seq[T]">items</a>.<span title="(f: T =&gt; scala.collection.GenTraversableOnce[scala.xml.Node])(implicit bf: scala.collection.generic.CanBuildFrom[Seq[T],scala.xml.Node,Seq[scala.xml.Node]])Seq[scala.xml.Node]">flatMap</span> <span title="scala.collection.generic.CanBuildFrom[scala.collection.Seq.Coll,scala.xml.Node,Seq[scala.xml.Node]]" class="delimiter">{</span><a title="T" id="197568">i</a> =&gt;
             <a href="../../../../../util/net/liftweb/util/BindHelpers.scala.html#49008" title="(namespace: String, xml: scala.xml.NodeSeq, params: net.liftweb.util.Helpers.BindParam*)scala.xml.NodeSeq">bind</a><span class="delimiter">(</span><span title="java.lang.String(&quot;item&quot;)" class="string">&quot;item&quot;</span>,
                  <a href="#196088" title="(item: T)scala.xml.NodeSeq =&gt; scala.xml.NodeSeq">customBind</a><span title="(v1: scala.xml.NodeSeq)scala.xml.NodeSeq" class="delimiter">(</span><a href="#197568" title="T">i</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#196940" title="scala.xml.NodeSeq">ns</a><span class="delimiter">)</span>,
                  <a href="../../../../../util/net/liftweb/util/BindHelpers.scala.html#49003" title="implicit net.liftweb.util.BindHelpers.strToSuperArrowAssoc : (in: String)net.liftweb.util.Helpers.SuperArrowAssoc" class="string">&quot;fields&quot;</a> <a href="../../../../../util/net/liftweb/util/BindHelpers.scala.html#58385" title="(in: scala.xml.NodeSeq =&gt; scala.xml.NodeSeq)net.liftweb.util.Helpers.FuncBindParam">-&gt;</a> <a href="Util.scala.html#195425" title="(mapper: T, fn: net.liftweb.mapper.MappedField[_, T] =&gt; Seq[net.liftweb.util.Helpers.BindParam], filter: net.liftweb.mapper.MappedField[_, T] =&gt; Boolean)scala.xml.NodeSeq =&gt; scala.xml.NodeSeq">eachField</a><span class="delimiter">(</span>
                    <a href="#197568" title="T">i</a>,
                    <span class="delimiter">(</span>f: <a href="../MappedField.scala.html#11427" title="net.liftweb.mapper.MappedField[_, T]">MappedField</a><span class="delimiter">[</span>_,T<span class="delimiter">]</span><span class="delimiter">)</span> =&gt; <span title="(elems: net.liftweb.util.Helpers.BoxBindParam*)Seq[net.liftweb.util.Helpers.BoxBindParam]">Seq</span><span class="delimiter">(</span><a href="../../../../../util/net/liftweb/util/BindHelpers.scala.html#49003" title="implicit net.liftweb.util.BindHelpers.strToSuperArrowAssoc : (in: String)net.liftweb.util.Helpers.SuperArrowAssoc" class="string">&quot;form&quot;</a> <a href="../../../../../util/net/liftweb/util/BindHelpers.scala.html#58386" title="(in: net.liftweb.common.Box[scala.xml.NodeSeq])net.liftweb.util.Helpers.BoxBindParam">-&gt;</a> <a href="#197614" title="net.liftweb.mapper.MappedField[_, T]">f</a>.<a href="../MappedField.scala.html#147434" title="=&gt; net.liftweb.common.Box[scala.xml.NodeSeq]">toForm</a><span class="delimiter">)</span>,
                    <a href="#196086" title="=&gt; net.liftweb.mapper.MappedField[_, T] =&gt; Boolean">fieldFilter</a>
                  <span class="delimiter">)</span>,
                  <a href="../../../../../util/net/liftweb/util/BindHelpers.scala.html#49003" title="implicit net.liftweb.util.BindHelpers.strToSuperArrowAssoc : (in: String)net.liftweb.util.Helpers.SuperArrowAssoc" class="string">&quot;removeBtn&quot;</a> <a href="../../../../../util/net/liftweb/util/BindHelpers.scala.html#58383" title="(in: scala.xml.Node)net.liftweb.util.Helpers.TheBindParam">-&gt;</a> <a href="../../../../../webkit/net/liftweb/http/SHtml.scala.html#14660" title="object net.liftweb.http.SHtml">SHtml</a>.<a href="../../../../../webkit/net/liftweb/http/SHtml.scala.html#152863" title="(value: String, func: () =&gt; Any, attrs: net.liftweb.http.SHtml.ElemAttr*)scala.xml.Elem">submit</a><span class="delimiter">(</span><a href="../../../../../webkit/net/liftweb/http/S.scala.html#49351" title="(str: String)String">?</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Remove&quot;)" class="string">&quot;Remove&quot;</span><span class="delimiter">)</span>, <span class="delimiter">(</span><span class="delimiter">)</span>=&gt;<a href="#196083" title="(item: T)Unit">onRemove</a><span class="delimiter">(</span><a href="#197568" title="T">i</a><span class="delimiter">)</span>, <a href="../../../../../webkit/net/liftweb/http/SHtml.scala.html#162292" title="implicit net.liftweb.http.SHtml.ElemAttr.pairToBasic : (in: (String, String))net.liftweb.http.SHtml.ElemAttr">noPrompt</a><span class="delimiter">)</span>,
                  <a href="../../../../../util/net/liftweb/util/BindHelpers.scala.html#49003" title="implicit net.liftweb.util.BindHelpers.strToSuperArrowAssoc : (in: String)net.liftweb.util.Helpers.SuperArrowAssoc" class="string">&quot;msg&quot;</a> <a href="../../../../../util/net/liftweb/util/BindHelpers.scala.html#58381" title="(in: scala.xml.NodeSeq)net.liftweb.util.Helpers.TheBindParam">-&gt;</a> <span class="delimiter">(</span><span class="delimiter">(</span><a href="#197568" title="T">i</a>.<a href="../Mapper.scala.html#147088" title="=&gt; List[net.liftweb.util.FieldError]">validate</a> <span title="scala.xml.NodeSeq" class="keyword">match</span> <span class="delimiter">{</span>
                    <span class="keyword">case</span> <span title="scala.xml.NodeSeq">Nil</span> =&gt;
                      <span title="scala.xml.NodeSeq" class="keyword">if</span><span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#197568" title="T">i</a>.<a href="../Mapper.scala.html#147107" title="=&gt; Boolean">saved_?</a><span class="delimiter">)</span> <span title="(_data: String)scala.xml.Text">Text</span><span class="delimiter">(</span><a href="../../../../../webkit/net/liftweb/http/S.scala.html#49351" title="(str: String)String">?</a><span class="delimiter">(</span><span title="java.lang.String(&quot;New&quot;)" class="string">&quot;New&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="keyword">else</span> <span title="scala.xml.NodeSeq" class="keyword">if</span><span class="delimiter">(</span><a href="#197568" title="T">i</a>.<a href="../Mapper.scala.html#147109" title="=&gt; Boolean">dirty_?</a><span class="delimiter">)</span> <span title="(_data: String)scala.xml.Text">Text</span><span class="delimiter">(</span><a href="../../../../../webkit/net/liftweb/http/S.scala.html#49351" title="(str: String)String">?</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Unsaved&quot;)" class="string">&quot;Unsaved&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="keyword">else</span> <span title="object scala.xml.NodeSeq">NodeSeq</span>.<span title="=&gt; scala.xml.NodeSeq">Empty</span>
                    <span class="keyword">case</span> <a title="scala.xml.Elem" id="197765">errors</a> =&gt; <span class="delimiter">(</span>&lt;<a title="scala.xml.Elem" id="197766">ul</a>&gt;<span class="delimiter">{</span><a href="#197765" title="List[net.liftweb.util.FieldError]">errors</a>.<span title="(f: net.liftweb.util.FieldError =&gt; scala.collection.GenTraversableOnce[scala.xml.Node])(implicit bf: scala.collection.generic.CanBuildFrom[List[net.liftweb.util.FieldError],scala.xml.Node,Any])Any">flatMap</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.List.Coll,scala.xml.Node,List[scala.xml.Node]]" class="delimiter">(</span><a title="net.liftweb.util.FieldError" id="197783">e</a> =&gt; &lt;<a title="scala.xml.Elem" id="197784">li</a>&gt;<span class="delimiter">{</span><a href="#197783" title="net.liftweb.util.FieldError">e</a>.<a href="../../../../../util/net/liftweb/util/BaseField.scala.html#147945" title="=&gt; scala.xml.NodeSeq">msg</a><span class="delimiter">}</span>&lt;/li&gt;<span class="delimiter">)</span><span class="delimiter">}</span>&lt;/ul&gt;<span class="delimiter">)</span>
                  <span class="delimiter">}</span><span class="delimiter">)</span><span class="delimiter">)</span>
             <span class="delimiter">)</span>
           <span class="delimiter">}</span> <span title="implicit scala.xml.NodeSeq.seqToNodeSeq : (s: Seq[scala.xml.Node])scala.xml.NodeSeq">++</span> <a href="#196080" title="=&gt; net.liftweb.mapper.view.ItemsList[T]">items</a>.<a href="#195443" title="=&gt; List[T]">removed</a>.<span title="(f: T =&gt; scala.collection.GenTraversableOnce[scala.xml.Node])(implicit bf: scala.collection.generic.CanBuildFrom[List[T],scala.xml.Node,List[scala.xml.Node]])List[scala.xml.Node]">flatMap</span> <span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.List.Coll,scala.xml.Node,List[scala.xml.Node]]" class="delimiter">{</span> <a title="T" id="197894">i</a> =&gt;
             <a href="../../../../../util/net/liftweb/util/BindHelpers.scala.html#49008" title="(namespace: String, xml: scala.xml.NodeSeq, params: net.liftweb.util.Helpers.BindParam*)scala.xml.NodeSeq">bind</a><span class="delimiter">(</span><span title="java.lang.String(&quot;item&quot;)" class="string">&quot;item&quot;</span>, <a href="#196088" title="(item: T)scala.xml.NodeSeq =&gt; scala.xml.NodeSeq">customBind</a><span title="(v1: scala.xml.NodeSeq)scala.xml.NodeSeq" class="delimiter">(</span><a href="#197894" title="T">i</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#196940" title="scala.xml.NodeSeq">ns</a><span class="delimiter">)</span>,
                  <a href="../../../../../util/net/liftweb/util/BindHelpers.scala.html#49003" title="implicit net.liftweb.util.BindHelpers.strToSuperArrowAssoc : (in: String)net.liftweb.util.Helpers.SuperArrowAssoc" class="string">&quot;fields&quot;</a> <a href="../../../../../util/net/liftweb/util/BindHelpers.scala.html#58385" title="(in: scala.xml.NodeSeq =&gt; scala.xml.NodeSeq)net.liftweb.util.Helpers.FuncBindParam">-&gt;</a> <a href="Util.scala.html#195425" title="(mapper: T, fn: net.liftweb.mapper.MappedField[_, T] =&gt; Seq[net.liftweb.util.Helpers.BindParam], filter: net.liftweb.mapper.MappedField[_, T] =&gt; Boolean)scala.xml.NodeSeq =&gt; scala.xml.NodeSeq">eachField</a><span class="delimiter">(</span>
                    <a href="#197894" title="T">i</a>,
                    <span class="delimiter">{</span>f: <a href="../MappedField.scala.html#11427" title="net.liftweb.mapper.MappedField[_, T]">MappedField</a><span class="delimiter">[</span>_,T<span class="delimiter">]</span> =&gt; <span title="(elems: net.liftweb.util.Helpers.TheBindParam*)Seq[net.liftweb.util.Helpers.TheBindParam]">Seq</span><span class="delimiter">(</span><a href="../../../../../util/net/liftweb/util/BindHelpers.scala.html#49003" title="implicit net.liftweb.util.BindHelpers.strToSuperArrowAssoc : (in: String)net.liftweb.util.Helpers.SuperArrowAssoc" class="string">&quot;form&quot;</a> <a href="../../../../../util/net/liftweb/util/BindHelpers.scala.html#58383" title="(in: scala.xml.Node)net.liftweb.util.Helpers.TheBindParam">-&gt;</a> &lt;<a title="scala.xml.Elem" id="197971">strike</a>&gt;<span class="delimiter">{</span><a href="#197940" title="net.liftweb.mapper.MappedField[_, T]">f</a>.<a href="../MappedField.scala.html#147477" title="=&gt; scala.xml.Node">asHtml</a><span class="delimiter">}</span>&lt;/strike&gt;<span class="delimiter">)</span><span class="delimiter">}</span>,
                    <a href="#196086" title="=&gt; net.liftweb.mapper.MappedField[_, T] =&gt; Boolean">fieldFilter</a>
                  <span class="delimiter">)</span>,
                  <a href="../../../../../util/net/liftweb/util/BindHelpers.scala.html#49003" title="implicit net.liftweb.util.BindHelpers.strToSuperArrowAssoc : (in: String)net.liftweb.util.Helpers.SuperArrowAssoc" class="string">&quot;removeBtn&quot;</a> <a href="../../../../../util/net/liftweb/util/BindHelpers.scala.html#58381" title="(in: scala.xml.NodeSeq)net.liftweb.util.Helpers.TheBindParam">-&gt;</a> <span title="object scala.xml.NodeSeq">NodeSeq</span>.<span title="=&gt; scala.xml.NodeSeq">Empty</span>,
                  <a href="../../../../../util/net/liftweb/util/BindHelpers.scala.html#49003" title="implicit net.liftweb.util.BindHelpers.strToSuperArrowAssoc : (in: String)net.liftweb.util.Helpers.SuperArrowAssoc" class="string">&quot;msg&quot;</a> <a href="../../../../../util/net/liftweb/util/BindHelpers.scala.html#58382" title="(in: scala.xml.Text)net.liftweb.util.Helpers.TheBindParam">-&gt;</a> <span title="(_data: String)scala.xml.Text">Text</span><span class="delimiter">(</span><a href="../../../../../webkit/net/liftweb/http/S.scala.html#49351" title="(str: String)String">?</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Deleted&quot;)" class="string">&quot;Deleted&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
             <span class="delimiter">)</span>
           <span class="delimiter">}</span>: <span title="scala.xml.NodeSeq">NodeSeq</span>
         <span class="delimiter">}</span>,
         <a href="../../../../../util/net/liftweb/util/BindHelpers.scala.html#49003" title="implicit net.liftweb.util.BindHelpers.strToSuperArrowAssoc : (in: String)net.liftweb.util.Helpers.SuperArrowAssoc" class="string">&quot;saveBtn&quot;</a> <a href="../../../../../util/net/liftweb/util/BindHelpers.scala.html#58383" title="(in: scala.xml.Node)net.liftweb.util.Helpers.TheBindParam">-&gt;</a> <a href="../../../../../webkit/net/liftweb/http/SHtml.scala.html#14660" title="object net.liftweb.http.SHtml">SHtml</a>.<a href="../../../../../webkit/net/liftweb/http/SHtml.scala.html#152863" title="(value: String, func: () =&gt; Any, attrs: net.liftweb.http.SHtml.ElemAttr*)scala.xml.Elem">submit</a><span class="delimiter">(</span><a href="../../../../../webkit/net/liftweb/http/S.scala.html#49351" title="(str: String)String">?</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Save&quot;)" class="string">&quot;Save&quot;</span><span class="delimiter">)</span>, <a href="#196084" title="=&gt; Unit">onSubmit</a> _, <a href="../../../../../webkit/net/liftweb/http/SHtml.scala.html#162292" title="implicit net.liftweb.http.SHtml.ElemAttr.pairToBasic : (in: (String, String))net.liftweb.http.SHtml.ElemAttr">noPrompt</a><span class="delimiter">)</span>
    <span class="delimiter">)</span>
  <span class="delimiter">}</span>

<span class="delimiter">}</span>

        </pre>
    </body>
</html>