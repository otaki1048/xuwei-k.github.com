<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>mapper/net/liftweb/mapper/MappedForeignKey.scala</title>
        <script type="text/javascript" src="../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/*
 * Copyright 2006-2011 WorldWide Conferencing, LLC
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */</span>

<span class="keyword">package</span> net.liftweb
<span class="keyword">package</span> mapper

<span class="keyword">import</span> common._


<span class="keyword">import</span> scala.xml.<span class="delimiter">{</span>NodeSeq, Text, Elem<span class="delimiter">}</span>
<span class="keyword">import</span> http.<span class="delimiter">{</span>js, S, SHtml<span class="delimiter">}</span>
<span class="keyword">import</span> js._
<span class="keyword">import</span> <a href="../../../../webkit/net/liftweb/http/S.scala.html#14641" title="object net.liftweb.http.S">S</a>.?
<span class="keyword">import</span> json._
<span class="keyword">import</span> util.FieldError


<span class="comment">/**
 * A trait that defines foreign key references
 */</span>
<span class="keyword">trait</span> <a title="trait BaseForeignKey extends java.lang.Object with net.liftweb.mapper.BaseMappedField" id="11446">BaseForeignKey</a> <span class="keyword">extends</span> <a href="MappedField.scala.html#11418" title="net.liftweb.mapper.BaseMappedField">BaseMappedField</a> <span class="delimiter">{</span>

  <span class="keyword">type</span> <a title="&gt;: Nothing &lt;: Any" id="162540">KeyType</a>
  <span class="keyword">type</span> <a title="&gt;: Nothing &lt;: net.liftweb.mapper.KeyedMapper[BaseForeignKey.this.KeyType,BaseForeignKey.this.KeyedForeignType]" id="162541">KeyedForeignType</a> &lt;: KeyedMapper<span class="delimiter">[</span>KeyType, KeyedForeignType<span class="delimiter">]</span>

  <span class="keyword">type</span> <a title="&gt;: Nothing &lt;: net.liftweb.mapper.Mapper[BaseForeignKey.this.OwnerType]" id="162542">OwnerType</a> &lt;: Mapper<span class="delimiter">[</span>OwnerType<span class="delimiter">]</span>

  <span class="comment">/**
   * Is the key defined?
   */</span>
  <span class="keyword">def</span> <a title="=&gt; Boolean" id="162543">defined_?</a> : <span title="Boolean">Boolean</span>

  <span class="comment">/**
   * get the object referred to by this foreign key
   */</span>

  <span class="keyword">def</span> <a title="=&gt; net.liftweb.mapper.BaseMetaMapper" id="162544">dbKeyToTable</a>: <a href="MetaMapper.scala.html#11665" title="net.liftweb.mapper.BaseMetaMapper">BaseMetaMapper</a>

  <span class="keyword">def</span> <a title="=&gt; net.liftweb.mapper.BaseMappedField" id="162545">dbKeyToColumn</a>: <a href="MappedField.scala.html#11418" title="net.liftweb.mapper.BaseMappedField">BaseMappedField</a>

  <span class="keyword">def</span> <a title="(key: BaseForeignKey.this.KeyType)List[BaseForeignKey.this.OwnerType]" id="162546">findFor</a><span class="delimiter">(</span><a title="BaseForeignKey.this.KeyType" id="162556">key</a>: <a href="#162540" title="BaseForeignKey.this.KeyType">KeyType</a><span class="delimiter">)</span>: <span title="List[BaseForeignKey.this.OwnerType]">List</span><span class="delimiter">[</span>OwnerType<span class="delimiter">]</span>

  <span class="keyword">def</span> <a title="(key: BaseForeignKey.this.KeyedForeignType)List[BaseForeignKey.this.OwnerType]" id="162547">findFor</a><span class="delimiter">(</span><a title="BaseForeignKey.this.KeyedForeignType" id="162558">key</a>: <a href="#162541" title="BaseForeignKey.this.KeyedForeignType">KeyedForeignType</a><span class="delimiter">)</span>: <span title="List[BaseForeignKey.this.OwnerType]">List</span><span class="delimiter">[</span>OwnerType<span class="delimiter">]</span>

  <span class="comment">/**
   * Called when Schemifier adds a foreign key.  Return a function that will be called when Schemifier
   * is done with the schemification.
   */</span>
  <span class="keyword">def</span> <a title="=&gt; net.liftweb.common.Box[() =&gt; Unit]" id="162548">dbAddedForeignKey</a>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[() =&gt; Unit]">Box</a><span class="delimiter">[</span><span class="delimiter">(</span><span class="delimiter">)</span> =&gt; Unit<span class="delimiter">]</span>
<span class="delimiter">}</span>


<span class="keyword">object</span> <a title="object net.liftweb.mapper.MappedForeignKey" id="11447">MappedForeignKey</a> <span title="ScalaObject" class="delimiter">{</span>
  <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="[KeyType, MyOwner &lt;: net.liftweb.mapper.Mapper[MyOwner], Other &lt;: net.liftweb.mapper.KeyedMapper[KeyType,Other]](in: net.liftweb.mapper.MappedForeignKey[KeyType,MyOwner,Other])net.liftweb.common.Box[Other]" id="162563">getObj</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="162567">KeyType</a>,
          <a title="&gt;: Nothing &lt;: net.liftweb.mapper.Mapper[MyOwner]" id="162568">MyOwner</a> &lt;: Mapper<span class="delimiter">[</span>MyOwner<span class="delimiter">]</span>,
          <a title="&gt;: Nothing &lt;: net.liftweb.mapper.KeyedMapper[KeyType,Other]" id="162569">Other</a> &lt;: KeyedMapper<span class="delimiter">[</span>KeyType,
             Other<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">(</span><a title="net.liftweb.mapper.MappedForeignKey[KeyType,MyOwner,Other]" id="162571">in</a>:
               <a href="#11449" title="net.liftweb.mapper.MappedForeignKey[KeyType,MyOwner,Other]">MappedForeignKey</a><span class="delimiter">[</span>KeyType,
                    MyOwner,
                    Other<span class="delimiter">]</span><span class="delimiter">)</span>:
  <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[Other]">Box</a><span class="delimiter">[</span>Other<span class="delimiter">]</span> = <a href="#162571" title="net.liftweb.mapper.MappedForeignKey[KeyType,MyOwner,Other]">in</a>.<a href="#155168" title="=&gt; net.liftweb.common.Box[Other]">obj</a>
<span class="delimiter">}</span>

<span class="comment">/**
 * The Trait that defines a field that is mapped to a foreign key
 */</span>
<span class="keyword">trait</span> <a title="trait MappedForeignKey[KeyType, MyOwner &lt;: net.liftweb.mapper.Mapper[MyOwner], Other &lt;: net.liftweb.mapper.KeyedMapper[KeyType,Other]] extends java.lang.Object with net.liftweb.mapper.MappedField[KeyType,MyOwner] with net.liftweb.mapper.LifecycleCallbacks with ScalaObject" id="11449">MappedForeignKey</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="11450">KeyType</a>, <a title="&gt;: Nothing &lt;: net.liftweb.mapper.Mapper[MyOwner]" id="11451">MyOwner</a> &lt;: Mapper<span class="delimiter">[</span>MyOwner<span class="delimiter">]</span>, <a title="&gt;: Nothing &lt;: net.liftweb.mapper.KeyedMapper[KeyType,Other]" id="11452">Other</a> &lt;: KeyedMapper<span class="delimiter">[</span>KeyType, Other<span class="delimiter">]</span><span class="delimiter">]</span>
<span title="ScalaObject" class="keyword">extends</span> <a href="MappedField.scala.html#11427" title="net.liftweb.mapper.MappedField[KeyType,MyOwner]">MappedField</a><span class="delimiter">[</span>KeyType, MyOwner<span class="delimiter">]</span>
<span class="keyword">with</span> <a href="MappedField.scala.html#11435" title="net.liftweb.mapper.LifecycleCallbacks">LifecycleCallbacks</a> <span class="delimiter">{</span>
  <span class="keyword">type</span> <a title="&gt;: Nothing &lt;: KeyType" id="155156">FieldType</a> &lt;: KeyType
  <span class="comment">// type ForeignType &lt;: KeyedMapper[KeyType, Other]</span>

  <span class="comment">/**
   * What's the MetaMapper for the foreign key
   */</span>
  <span class="keyword">def</span> <a title="=&gt; net.liftweb.mapper.KeyedMetaMapper[KeyType,Other]" id="155157">foreignMeta</a>: <a href="MetaMapper.scala.html#11791" title="net.liftweb.mapper.KeyedMetaMapper[KeyType,Other]">KeyedMetaMapper</a><span class="delimiter">[</span>KeyType, Other<span class="delimiter">]</span>

  <span class="comment">/**
   * Make sure the MetaMapper for the KeyedMapper we're checking
   * is in fact the same one as we are associated with.  Issue #532.
   */</span>
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(km: net.liftweb.mapper.KeyedMapper[KeyType, _])Boolean" id="155158">checkTypes</a><span class="delimiter">(</span><a title="net.liftweb.mapper.KeyedMapper[KeyType, _]" id="162597">km</a>: <a href="Mapper.scala.html#11643" title="net.liftweb.mapper.KeyedMapper[KeyType, _]">KeyedMapper</a><span class="delimiter">[</span>KeyType, _<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> =
    <a href="#162597" title="net.liftweb.mapper.KeyedMapper[KeyType, _]">km</a>.<a href="Mapper.scala.html#147133" title="(=&gt; net.liftweb.mapper.KeyedMetaMapper[KeyType,_$1]) forSome { type _$1; type _$1 }">getSingleton</a> <span title="(x$1: AnyRef)Boolean">eq</span> <a href="#155157" title="=&gt; net.liftweb.mapper.KeyedMetaMapper[KeyType,Other]">foreignMeta</a>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(other: Any)Boolean" id="155159">equals</a><span class="delimiter">(</span><a title="Any" id="162618">other</a>: <span title="Any">Any</span><span class="delimiter">)</span> = <a href="#162618" title="Any">other</a> <span title="Boolean" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <a title="Boolean" id="162621">km</a>: <a href="Mapper.scala.html#11643" title="net.liftweb.mapper.KeyedMapper[KeyType,Other]">KeyedMapper</a><span class="delimiter">[</span>KeyType, Other<span class="delimiter">]</span> <span class="keyword">if</span> <a href="#155158" title="(km: net.liftweb.mapper.KeyedMapper[KeyType, _])Boolean">checkTypes</a><span class="delimiter">(</span><a href="#162621" title="net.liftweb.mapper.KeyedMapper[KeyType,Other]">km</a><span class="delimiter">)</span> =&gt; <a href="#11449" title="MappedForeignKey.this.type" class="keyword">this</a>.<a href="MappedField.scala.html#147450" title="=&gt; KeyType">is</a> <span title="(x$1: Any)Boolean">==</span> <a href="#162621" title="net.liftweb.mapper.KeyedMapper[KeyType,Other]">km</a>.<a href="Mapper.scala.html#147132" title="=&gt; net.liftweb.mapper.MappedField[KeyType,Other] with net.liftweb.mapper.IndexedField[KeyType]">primaryKeyField</a>.<a href="MappedField.scala.html#147450" title="=&gt; KeyType">is</a>
    <span class="keyword">case</span> <span title="Boolean">_</span> =&gt; <a href="#11449" title="net.liftweb.mapper.MappedForeignKey[KeyType,MyOwner,Other]" class="keyword">super</a>.<a href="MappedField.scala.html#147475" title="(other: Any)Boolean">equals</a><span class="delimiter">(</span><a href="#162618" title="Any">other</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="=&gt; net.liftweb.mapper.KeyedMetaMapper[KeyType,Other]" id="155160">dbKeyToTable</a>: <a href="MetaMapper.scala.html#11791" title="net.liftweb.mapper.KeyedMetaMapper[KeyType,Other]">KeyedMetaMapper</a><span class="delimiter">[</span>KeyType, Other<span class="delimiter">]</span>

  <span class="keyword">def</span> <a title="=&gt; net.liftweb.common.Box[List[(KeyType, String)]]" id="155161">validSelectValues</a>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[List[(KeyType, String)]]">Box</a><span class="delimiter">[</span>List<span class="delimiter">[</span><span class="delimiter">(</span>KeyType, String<span class="delimiter">)</span><span class="delimiter">]</span><span class="delimiter">]</span> = <a href="../../../../common/net/liftweb/common/Box.scala.html#10581" title="object net.liftweb.common.Empty">Empty</a>


  <span class="keyword">def</span> <a title="=&gt; scala.xml.NodeSeq" id="155162">immutableMsg</a>: <span title="scala.xml.NodeSeq">NodeSeq</span> = <span title="(_data: String)scala.xml.Text">Text</span><span class="delimiter">(</span><a href="../../../../webkit/net/liftweb/http/S.scala.html#49351" title="(str: String)String">?</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Can\'t change&quot;)" class="string">&quot;Can't change&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; net.liftweb.common.Box[scala.xml.Elem]" id="155163">_toForm</a>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[scala.xml.Elem]">Box</a><span class="delimiter">[</span>Elem<span class="delimiter">]</span> = <a href="../../../../common/net/liftweb/common/Box.scala.html#27086" title="(value: scala.xml.Elem)net.liftweb.common.Full[scala.xml.Elem]">Full</a><span class="delimiter">(</span><a href="#155161" title="=&gt; net.liftweb.common.Box[List[(KeyType, String)]]">validSelectValues</a>.<a href="../../../../common/net/liftweb/common/Box.scala.html#27023" title="(f: List[(KeyType, String)] =&gt; net.liftweb.common.Box[scala.xml.Elem])net.liftweb.common.Box[scala.xml.Elem]">flatMap</a><a href="#162654" title="&lt;none&gt; extends net.liftweb.common.Box[scala.xml.Elem] with Serializable" class="delimiter">{</a>
      <span class="keyword">case</span> <span title="net.liftweb.common.Empty.type">Nil</span> =&gt; <a href="../../../../common/net/liftweb/common/Box.scala.html#10581" title="object net.liftweb.common.Empty">Empty</a>

      <span class="keyword">case</span> <a title="net.liftweb.common.Full[scala.xml.Elem]" id="162655">xs</a> =&gt;
        <a href="../../../../common/net/liftweb/common/Box.scala.html#27086" title="(value: scala.xml.Elem)net.liftweb.common.Full[scala.xml.Elem]">Full</a><span class="delimiter">(</span><a href="../../../../webkit/net/liftweb/http/SHtml.scala.html#14660" title="object net.liftweb.http.SHtml">SHtml</a>.<a href="../../../../webkit/net/liftweb/http/SHtml.scala.html#152887" title="(options: Seq[(KeyType, String)], default: net.liftweb.common.Box[KeyType], onSubmit: KeyType =&gt; Any, attrs: net.liftweb.http.SHtml.ElemAttr*)scala.xml.Elem">selectObj</a><span class="delimiter">(</span><a href="#162655" title="List[(KeyType, String)]">xs</a>, <a href="../../../../common/net/liftweb/common/Box.scala.html#27086" title="(value: KeyType)net.liftweb.common.Full[KeyType]">Full</a><span class="delimiter">(</span><a href="#11449" title="MappedForeignKey.this.type" class="keyword">this</a>.<a href="MappedField.scala.html#147450" title="=&gt; KeyType">is</a><span class="delimiter">)</span>, <a href="#11449" title="MappedForeignKey.this.type" class="keyword">this</a>.<a href="MappedField.scala.html#147418" title="(value: KeyType)KeyType">set</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>.<a href="../../../../common/net/liftweb/common/Box.scala.html#27017" title="(default: =&gt; scala.xml.Elem)scala.xml.Elem">openOr</a><span class="delimiter">(</span>&lt;<a title="scala.xml.Elem" id="162772">span</a>&gt;<span class="delimiter">{</span><a href="#155162" title="=&gt; scala.xml.NodeSeq">immutableMsg</a><span class="delimiter">}</span>&lt;/span&gt;<span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="comment">/**
   * Is the key defined
   */</span>
  <span class="keyword">def</span> <a title="=&gt; Boolean" id="155164">defined_?</a> : <span title="Boolean">Boolean</span>

  <span class="comment">/**
   * Is the obj field cached
   */</span>
  <span class="keyword">def</span> <a title="=&gt; Boolean" id="155165">cached_?</a> : <span title="Boolean">Boolean</span> = <a href="#11449" title="(x$1: Boolean)Boolean">synchronized</a><span class="delimiter">{</span> <a href="#155175" title="=&gt; Boolean">_calcedObj</a><span class="delimiter">}</span>

  <span class="keyword">override</span> <span class="keyword">protected</span> <span class="keyword">def</span> <a title="(b: Boolean)Unit" id="155166">dirty_?</a><span class="delimiter">(</span><a title="Boolean" id="162782">b</a>: <span title="Boolean">Boolean</span><span class="delimiter">)</span> = <a href="#11449" title="(x$1: Unit)Unit">synchronized</a> <span class="delimiter">{</span> <span class="comment">// issue 165</span>
    <span class="comment">// invalidate if the primary key has changed Issue 370</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#155172" title="=&gt; net.liftweb.common.Box[Other]">_obj</a>.<a href="../../../../common/net/liftweb/common/Box.scala.html#27013" title="=&gt; Boolean">isEmpty</a> <span title="(x: Boolean)Boolean">||</span> <span class="delimiter">(</span><a href="#155175" title="=&gt; Boolean">_calcedObj</a> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#155172" title="=&gt; net.liftweb.common.Box[Other]">_obj</a>.<a href="../../../../common/net/liftweb/common/Box.scala.html#27014" title="=&gt; Boolean">isDefined</a> <span title="(x: Boolean)Boolean">&amp;&amp;</span>
       <a href="#155172" title="=&gt; net.liftweb.common.Box[Other]">_obj</a>.<a href="../../../../common/net/liftweb/common/Box.scala.html#27015" title="=&gt; Other">open_!</a>.<a href="Mapper.scala.html#147132" title="=&gt; net.liftweb.mapper.MappedField[KeyType,Other] with net.liftweb.mapper.IndexedField[KeyType]">primaryKeyField</a>.<a href="MappedField.scala.html#147450" title="=&gt; KeyType">is</a> <span title="(x$1: Any)Boolean">!=</span> <a href="#11449" title="MappedForeignKey.this.type" class="keyword">this</a>.<a href="MappedField.scala.html#147453" title="=&gt; KeyType">i_is_!</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#155172" title="(x$1: net.liftweb.common.Box[Other])Unit">_obj</a> = <a href="../../../../common/net/liftweb/common/Box.scala.html#10581" title="object net.liftweb.common.Empty">Empty</a>
      <a href="#155175" title="(x$1: Boolean)Unit">_calcedObj</a> = <span title="Boolean(false)" class="keyword">false</span>
    <span class="delimiter">}</span>
    <a href="#11449" title="net.liftweb.mapper.MappedForeignKey[KeyType,MyOwner,Other]" class="keyword">super</a>.<a href="MappedField.scala.html#147402" title="(b: Boolean)Unit">dirty_?</a><span class="delimiter">(</span><a href="#162782" title="Boolean">b</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Some people prefer the name foreign to materialize the
   * foreign reference.  This is a proxy to the obj method.
   */</span>
  <span class="keyword">def</span> <a title="=&gt; net.liftweb.common.Box[Other]" id="155167">foreign</a>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[Other]">Box</a><span class="delimiter">[</span>Other<span class="delimiter">]</span> = <a href="#155168" title="=&gt; net.liftweb.common.Box[Other]">obj</a>

  <span class="comment">/**
   * Load and cache the record that this field references
   */</span>
  <span class="keyword">def</span> <a title="=&gt; net.liftweb.common.Box[Other]" id="155168">obj</a>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[Other]">Box</a><span class="delimiter">[</span>Other<span class="delimiter">]</span> = <a href="#11449" title="(x$1: net.liftweb.common.Box[Other])net.liftweb.common.Box[Other]">synchronized</a> <span class="delimiter">{</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#155175" title="=&gt; Boolean">_calcedObj</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#155175" title="(x$1: Boolean)Unit">_calcedObj</a> = <span title="Boolean(true)" class="keyword">true</span>
      <a href="#11449" title="MappedForeignKey.this.type" class="keyword">this</a>.<a href="#155172" title="(x$1: net.liftweb.common.Box[Other])Unit">_obj</a> = <span title="net.liftweb.common.Box[Other]" class="keyword">if</span><span class="delimiter">(</span><a href="#155164" title="=&gt; Boolean">defined_?</a><span class="delimiter">)</span> <a href="#155160" title="=&gt; net.liftweb.mapper.KeyedMetaMapper[KeyType,Other]">dbKeyToTable</a>.<a href="MetaMapper.scala.html#146988" title="(key: Any)net.liftweb.common.Box[Other]">find</a><span class="delimiter">(</span><a href="MappedField.scala.html#147453" title="=&gt; KeyType">i_is_!</a><span class="delimiter">)</span> <span class="keyword">else</span> <a href="../../../../common/net/liftweb/common/Box.scala.html#10581" title="object net.liftweb.common.Empty">Empty</a>
    <span class="delimiter">}</span>
    <a href="#155172" title="=&gt; net.liftweb.common.Box[Other]">_obj</a>
  <span class="delimiter">}</span>

  <span class="keyword">private</span><span class="delimiter">[</span>mapper<span class="delimiter">]</span> <span class="keyword">def</span> <a title="(obj: net.liftweb.common.Box[Any])Unit" id="155169">_primeObj</a><span class="delimiter">(</span><a title="net.liftweb.common.Box[Any]" id="162807">obj</a>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[Any]">Box</a><span class="delimiter">[</span>Any<span class="delimiter">]</span><span class="delimiter">)</span> =
    <a href="#155170" title="(obj: net.liftweb.common.Box[Other])Unit">primeObj</a><span class="delimiter">(</span><a href="#162807" title="net.liftweb.common.Box[Any]">obj</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="net.liftweb.common.Box[Other]" class="delimiter">[</span><a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[Other]">Box</a><span class="delimiter">[</span>Other<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span>

  <span class="comment">/**
   * Prime the reference of this FK reference
   */</span>
  <span class="keyword">def</span> <a title="(obj: net.liftweb.common.Box[Other])Unit" id="155170">primeObj</a><span class="delimiter">(</span><a title="net.liftweb.common.Box[Other]" id="162810">obj</a>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[Other]">Box</a><span class="delimiter">[</span>Other<span class="delimiter">]</span><span class="delimiter">)</span> = <a href="#11449" title="(x$1: Unit)Unit">synchronized</a> <span class="delimiter">{</span>
    <a href="#155172" title="(x$1: net.liftweb.common.Box[Other])Unit">_obj</a> = <a href="#162810" title="net.liftweb.common.Box[Other]">obj</a>
    <a href="#155175" title="(x$1: Boolean)Unit">_calcedObj</a> = <span title="Boolean(true)" class="keyword">true</span>
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">var</span> <a title="net.liftweb.common.Box[Other]" id="155172">_obj</a>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[Other]">Box</a><span class="delimiter">[</span>Other<span class="delimiter">]</span> = <a href="../../../../common/net/liftweb/common/Box.scala.html#10581" title="object net.liftweb.common.Empty">Empty</a>
  <span class="keyword">private</span> <span class="keyword">var</span> <a title="Boolean" id="155175">_calcedObj</a> = <span title="Boolean(false)" class="keyword">false</span>


  <span class="comment">/**
   * Set the value from a possible instance of the foreign mapper class.
   * v will be cached in obj.
   * If v is Empty, set the value to defaultValue (-1)
   * @return the Mapper containing this field
   */</span>
  <span class="keyword">def</span> <a title="(v: net.liftweb.common.Box[Other])MyOwner" id="155177">apply</a><span class="delimiter">(</span><a title="net.liftweb.common.Box[Other]" id="157110">v</a>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[Other]">Box</a><span class="delimiter">[</span>Other<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#11451" title="MyOwner">MyOwner</a> = <span class="delimiter">{</span>
    <a href="MappedField.scala.html#147416" title="(v: KeyType)MyOwner">apply</a><span class="delimiter">(</span><a href="#157110" title="net.liftweb.common.Box[Other]">v</a>.<a href="../../../../common/net/liftweb/common/Box.scala.html#27073" title="(dflt: =&gt; KeyType)(f: Other =&gt; KeyType)KeyType">dmap</a><span class="delimiter">(</span><a href="MappedField.scala.html#147388" title="=&gt; KeyType">defaultValue</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#162838" title="Other">_</a>.<a href="Mapper.scala.html#147132" title="=&gt; net.liftweb.mapper.MappedField[KeyType,Other] with net.liftweb.mapper.IndexedField[KeyType]">primaryKeyField</a>.<a href="MappedField.scala.html#147450" title="=&gt; KeyType">is</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="#155170" title="(obj: net.liftweb.common.Box[Other])Unit">primeObj</a><span class="delimiter">(</span><a href="#157110" title="net.liftweb.common.Box[Other]">v</a><span class="delimiter">)</span>
    <a href="MappedField.scala.html#147406" title="=&gt; MyOwner">fieldOwner</a>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Set the value from an instance of the foreign mapper class.
   * obj will be set to Full(v)
   * @return the Mapper containing this field
   */</span>
  <span class="keyword">def</span> <a title="(v: Other)MyOwner" id="155178">apply</a><span class="delimiter">(</span><a title="Other" id="157117">v</a>: <a href="#11452" title="Other">Other</a><span class="delimiter">)</span>: <a href="#11451" title="MyOwner">MyOwner</a> = <span class="delimiter">{</span>
    <a href="MappedField.scala.html#147416" title="(v: KeyType)MyOwner">apply</a><span class="delimiter">(</span><a href="#157117" title="Other">v</a>.<a href="Mapper.scala.html#147132" title="=&gt; net.liftweb.mapper.MappedField[KeyType,Other] with net.liftweb.mapper.IndexedField[KeyType]">primaryKeyField</a>.<a href="MappedField.scala.html#147450" title="=&gt; KeyType">is</a><span class="delimiter">)</span>
    <a href="#155170" title="(obj: net.liftweb.common.Box[Other])Unit">primeObj</a><span class="delimiter">(</span><a href="../../../../common/net/liftweb/common/Box.scala.html#27086" title="(value: Other)net.liftweb.common.Full[Other]">Full</a><span class="delimiter">(</span><a href="#157117" title="Other">v</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="MappedField.scala.html#147406" title="=&gt; MyOwner">fieldOwner</a>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * This method, which gets called when the mapper class is going to be saved,
   * sets the field's value from obj if it's set to the default (!defined_?).
   * Overrides LifecycleCallbacks.beforeSave
   */</span>
  <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; Unit" id="155179">beforeSave</a> <span class="delimiter">{</span>
    <span title="Unit" class="keyword">if</span><span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#155164" title="=&gt; Boolean">defined_?</a><span class="delimiter">)</span>
      <span class="keyword">for</span><span class="delimiter">(</span><a title="Other" id="162893">o</a> &lt;- <a href="../../../../common/net/liftweb/common/Box.scala.html#27031" title="(f: Other =&gt; KeyType)Unit">obj</a><span class="delimiter">)</span>
        <a href="MappedField.scala.html#147418" title="(value: KeyType)KeyType">set</a><span class="delimiter">(</span><a href="#162893" title="Other">o</a>.<a href="Mapper.scala.html#147132" title="=&gt; net.liftweb.mapper.MappedField[KeyType,Other] with net.liftweb.mapper.IndexedField[KeyType]">primaryKeyField</a>.<a href="MappedField.scala.html#147450" title="=&gt; KeyType">is</a><span class="delimiter">)</span>
    <a href="#11449" title="net.liftweb.mapper.MappedForeignKey[KeyType,MyOwner,Other]" class="keyword">super</a>.<a href="MappedField.scala.html#154838" title="=&gt; Unit">beforeSave</a>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * A validation function that checks that obj is nonempty
   */</span>
  <span class="keyword">val</span> <a title="Long =&gt; List[net.liftweb.util.FieldError]" id="155180">valHasObj</a> = <span class="delimiter">(</span>value: <span title="Long">Long</span><span class="delimiter">)</span> =&gt;
    <span title="List[net.liftweb.util.FieldError]" class="keyword">if</span> <span class="delimiter">(</span><a href="#155168" title="=&gt; net.liftweb.common.Box[Other]">obj</a>.<a href="../../../../common/net/liftweb/common/Box.scala.html#27013" title="=&gt; Boolean">isEmpty</a><span class="delimiter">)</span> <span title="(xs: net.liftweb.util.FieldError*)List[net.liftweb.util.FieldError]">List</span><span class="delimiter">(</span><a href="../../../../util/net/liftweb/util/BaseField.scala.html#147940" title="(field: net.liftweb.util.FieldIdentifier, msg: scala.xml.NodeSeq)net.liftweb.util.FieldError">FieldError</a><span class="delimiter">(</span><a href="#11449" title="net.liftweb.mapper.MappedForeignKey[KeyType,MyOwner,Other]" class="keyword">this</a>, scala.xml.<span title="(_data: String)scala.xml.Text">Text</span><span class="delimiter">(</span><span title="java.lang.String(&quot;Required field: &quot;)" class="string">&quot;Required field: &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="MappedField.scala.html#147427" title="=&gt; String">name</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="keyword">else</span> <span title="object Nil">Nil</span>
<span class="delimiter">}</span>


@deprecated<span class="delimiter">(</span><span class="string">&quot;Functionality folded into MappedForeignKey, so just use MappedLongForeignKey. Will be removed in 2.5&quot;</span><span class="delimiter">)</span>
<span class="keyword">class</span> <a title="class LongMappedMapper[T &lt;: net.liftweb.mapper.Mapper[T], O &lt;: net.liftweb.mapper.KeyedMapper[Long,O]] extends net.liftweb.mapper.MappedLongForeignKey[T,O] with net.liftweb.mapper.LongMappedForeignMapper[T,O] with ScalaObject" id="11453">LongMappedMapper</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: net.liftweb.mapper.Mapper[T]" id="11454">T</a>&lt;:Mapper<span class="delimiter">[</span>T<span class="delimiter">]</span>, <a title="&gt;: Nothing &lt;: net.liftweb.mapper.KeyedMapper[Long,O]" id="11455">O</a>&lt;:KeyedMapper<span class="delimiter">[</span>Long,O<span class="delimiter">]</span><span class="delimiter">]</span><a href="#11453" title="ScalaObject" class="delimiter">(</a><a title="T" id="162967">theOwner</a>: <a href="#11454" title="T">T</a>, <a title="=&gt; net.liftweb.mapper.KeyedMetaMapper[Long,O]" id="162968">foreign</a>: =&gt; KeyedMetaMapper<span class="delimiter">[</span>Long, O<span class="delimiter">]</span><span class="delimiter">)</span>
  <span class="keyword">extends</span> <a href="#11459" title="net.liftweb.mapper.MappedLongForeignKey[T,O]">MappedLongForeignKey</a><span class="delimiter">[</span>T,O<span class="delimiter">]</span><span class="delimiter">(</span><a href="#162967" title="T">theOwner</a>, <a href="#162968" title="=&gt; net.liftweb.mapper.KeyedMetaMapper[Long,O]">foreign</a><span class="delimiter">)</span> <span class="keyword">with</span> <a href="#11456" title="net.liftweb.mapper.LongMappedForeignMapper[T,O]">LongMappedForeignMapper</a><span class="delimiter">[</span>T,O<span class="delimiter">]</span>


@deprecated<span class="delimiter">(</span><span class="string">&quot;Functionality folded into MappedForeignKey, so just use MappedLongForeignKey. Will be removed in 2.5&quot;</span><span class="delimiter">)</span>
<span class="keyword">trait</span> <a title="trait LongMappedForeignMapper[T &lt;: net.liftweb.mapper.Mapper[T], O &lt;: net.liftweb.mapper.KeyedMapper[Long,O]] extends net.liftweb.mapper.MappedLongForeignKey[T,O]" id="11456">LongMappedForeignMapper</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: net.liftweb.mapper.Mapper[T]" id="11457">T</a>&lt;:Mapper<span class="delimiter">[</span>T<span class="delimiter">]</span>,<a title="&gt;: Nothing &lt;: net.liftweb.mapper.KeyedMapper[Long,O]" id="11458">O</a>&lt;:KeyedMapper<span class="delimiter">[</span>Long,O<span class="delimiter">]</span><span class="delimiter">]</span>
                              <span class="keyword">extends</span> <a href="#11459" title="net.liftweb.mapper.MappedLongForeignKey[T,O]">MappedLongForeignKey</a><span class="delimiter">[</span>T,O<span class="delimiter">]</span>


<span class="keyword">abstract</span> <span class="keyword">class</span> <a title="class MappedLongForeignKey[T &lt;: net.liftweb.mapper.Mapper[T], O &lt;: net.liftweb.mapper.KeyedMapper[Long,O]] extends net.liftweb.mapper.MappedLong[T] with net.liftweb.mapper.MappedForeignKey[Long,T,O] with net.liftweb.mapper.BaseForeignKey with ScalaObject" id="11459">MappedLongForeignKey</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: net.liftweb.mapper.Mapper[T]" id="11460">T</a>&lt;:Mapper<span class="delimiter">[</span>T<span class="delimiter">]</span>,<a title="&gt;: Nothing &lt;: net.liftweb.mapper.KeyedMapper[Long,O]" id="11461">O</a>&lt;:KeyedMapper<span class="delimiter">[</span>Long, O<span class="delimiter">]</span><span class="delimiter">]</span><a href="#11459" title="ScalaObject" class="delimiter">(</a><a title="T" id="162969">theOwner</a>: <a href="#11460" title="T">T</a>, <a title="=&gt; net.liftweb.mapper.KeyedMetaMapper[Long,O]" id="162970">_foreignMeta</a>: =&gt; KeyedMetaMapper<span class="delimiter">[</span>Long, O<span class="delimiter">]</span><span class="delimiter">)</span>
<span class="keyword">extends</span> <a href="MappedLong.scala.html#11507" title="net.liftweb.mapper.MappedLong[T]">MappedLong</a><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">(</span><a href="#162969" title="T">theOwner</a><span class="delimiter">)</span> <span class="keyword">with</span> <a href="#11449" title="net.liftweb.mapper.MappedForeignKey[Long,T,O]">MappedForeignKey</a><span class="delimiter">[</span>Long,T,O<span class="delimiter">]</span> <span class="keyword">with</span> <a href="#11446" title="net.liftweb.mapper.BaseForeignKey">BaseForeignKey</a> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="=&gt; Boolean" id="162936">defined_?</a> = <a href="MappedLong.scala.html#162911" title="=&gt; Long">i_is_!</a> <span title="(x: Long)Boolean">&gt;</span> <span title="Long(0L)" class="long">0L</span>

  <span class="keyword">def</span> <a title="=&gt; net.liftweb.mapper.KeyedMetaMapper[Long,O]" id="162937">foreignMeta</a> = <a href="#162970" title="=&gt; net.liftweb.mapper.KeyedMetaMapper[Long,O]">_foreignMeta</a>

  @deprecated<span class="delimiter">(</span><span class="string">&quot;Use 'box' instead&quot;</span><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="=&gt; net.liftweb.common.Box[Long]" id="162938">can</a>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[Long]">Box</a><span class="delimiter">[</span>Long<span class="delimiter">]</span> = <span title="net.liftweb.common.Box[Long]" class="keyword">if</span> <span class="delimiter">(</span><a href="#162936" title="=&gt; Boolean">defined_?</a><span class="delimiter">)</span> <a href="../../../../common/net/liftweb/common/Box.scala.html#27086" title="(value: Long)net.liftweb.common.Full[Long]">Full</a><span class="delimiter">(</span><a href="MappedField.scala.html#147450" title="=&gt; Long">is</a><span class="delimiter">)</span> <span class="keyword">else</span> <a href="../../../../common/net/liftweb/common/Box.scala.html#10581" title="object net.liftweb.common.Empty">Empty</a>

  <span class="keyword">def</span> <a title="=&gt; net.liftweb.common.Box[Long]" id="162939">box</a>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[Long]">Box</a><span class="delimiter">[</span>Long<span class="delimiter">]</span> = <span title="net.liftweb.common.Box[Long]" class="keyword">if</span> <span class="delimiter">(</span><a href="#162936" title="=&gt; Boolean">defined_?</a><span class="delimiter">)</span> <a href="../../../../common/net/liftweb/common/Box.scala.html#27086" title="(value: Long)net.liftweb.common.Full[Long]">Full</a><span class="delimiter">(</span><a href="MappedField.scala.html#147450" title="=&gt; Long">is</a><span class="delimiter">)</span> <span class="keyword">else</span> <a href="../../../../common/net/liftweb/common/Box.scala.html#10581" title="object net.liftweb.common.Empty">Empty</a>

  <span class="keyword">type</span> <a title="Long" id="162940">KeyType</a> = <span title="Long">Long</span>
  <span class="keyword">type</span> <a title="O" id="162941">KeyedForeignType</a> = <a href="#11461" title="O">O</a>
  <span class="keyword">type</span> <a title="T" id="162942">OwnerType</a> = <a href="#11460" title="T">T</a>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(field: String)java.lang.Long" id="162943">jdbcFriendly</a><span class="delimiter">(</span><a title="String" id="163002">field</a> : <span title="String">String</span><span class="delimiter">)</span> = <span title="java.lang.Long" class="keyword">if</span> <span class="delimiter">(</span><a href="#162936" title="=&gt; Boolean">defined_?</a><span class="delimiter">)</span> <span title="java.lang.Long" class="keyword">new</span> java.lang.<span title="java.lang.Long">Long</span><span class="delimiter">(</span><a href="MappedLong.scala.html#162911" title="=&gt; Long">i_is_!</a><span class="delimiter">)</span> <span class="keyword">else</span> <span title="Null(null)" class="keyword">null</span>
  <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; java.lang.Long" id="162944">jdbcFriendly</a> = <span title="java.lang.Long" class="keyword">if</span> <span class="delimiter">(</span><a href="#162936" title="=&gt; Boolean">defined_?</a><span class="delimiter">)</span> <span title="java.lang.Long" class="keyword">new</span> java.lang.<span title="java.lang.Long">Long</span><span class="delimiter">(</span><a href="MappedLong.scala.html#162911" title="=&gt; Long">i_is_!</a><span class="delimiter">)</span> <span class="keyword">else</span> <span title="Null(null)" class="keyword">null</span>

  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="net.liftweb.mapper.KeyedMetaMapper[Long,O]" id="162946">dbKeyToTable</a>: <a href="MetaMapper.scala.html#11791" title="net.liftweb.mapper.KeyedMetaMapper[Long,O]">KeyedMetaMapper</a><span class="delimiter">[</span>Long, O<span class="delimiter">]</span> = <a href="#162937" title="=&gt; net.liftweb.mapper.KeyedMetaMapper[Long,O]">foreignMeta</a>

  <span class="keyword">def</span> <a title="=&gt; net.liftweb.mapper.MappedField[Long,O] with net.liftweb.mapper.IndexedField[Long]" id="162947">dbKeyToColumn</a> = <a href="#162945" title="=&gt; net.liftweb.mapper.KeyedMetaMapper[Long,O]">dbKeyToTable</a>.<a href="Mapper.scala.html#147132" title="=&gt; net.liftweb.mapper.MappedField[Long,O] with net.liftweb.mapper.IndexedField[Long]">primaryKeyField</a>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; Boolean" id="162948">dbIndexed_?</a> = <span title="Boolean(true)" class="keyword">true</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; Boolean" id="162949">dbForeignKey_?</a> = <span title="Boolean(true)" class="keyword">true</span>


  <span class="keyword">def</span> <a title="(obs: net.liftweb.common.Box[net.liftweb.mapper.KeyObfuscator])net.liftweb.http.js.JsExp" id="162950">asSafeJs</a><span class="delimiter">(</span><a title="net.liftweb.common.Box[net.liftweb.mapper.KeyObfuscator]" id="163051">obs</a>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[net.liftweb.mapper.KeyObfuscator]">Box</a><span class="delimiter">[</span>KeyObfuscator<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../../../webkit/net/liftweb/http/js/JsCommands.scala.html#14908" title="net.liftweb.http.js.JsExp">JsExp</a> =
  <a href="#163051" title="net.liftweb.common.Box[net.liftweb.mapper.KeyObfuscator]">obs</a>.<a href="../../../../common/net/liftweb/common/Box.scala.html#27020" title="(f: net.liftweb.mapper.KeyObfuscator =&gt; net.liftweb.http.js.JE.Str)net.liftweb.common.Box[net.liftweb.http.js.JE.Str]">map</a><span class="delimiter">(</span><a title="net.liftweb.mapper.KeyObfuscator" id="163057">o</a> =&gt; <a href="../../../../webkit/net/liftweb/http/js/JsCommands.scala.html#14910" title="object net.liftweb.http.js.JE">JE</a>.<a href="../../../../webkit/net/liftweb/http/js/JsCommands.scala.html#158029" title="(str: String)net.liftweb.http.js.JE.Str">Str</a><span class="delimiter">(</span><a href="#163057" title="net.liftweb.mapper.KeyObfuscator">o</a>.<a href="MetaMapper.scala.html#163065" title="(theType: net.liftweb.mapper.KeyedMetaMapper[Long,O], key: Long)String">obscure</a><span class="delimiter">(</span><a href="#162945" title="=&gt; net.liftweb.mapper.KeyedMetaMapper[Long,O]">dbKeyToTable</a>, <a href="MappedField.scala.html#147450" title="=&gt; Long">is</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>.<a href="../../../../common/net/liftweb/common/Box.scala.html#27017" title="(default: =&gt; net.liftweb.http.js.JsExp with Product with Serializable)net.liftweb.http.js.JsExp with Product with Serializable">openOr</a><span class="delimiter">(</span><a href="../../../../webkit/net/liftweb/http/js/JsCommands.scala.html#14910" title="object net.liftweb.http.js.JE">JE</a>.<a href="../../../../webkit/net/liftweb/http/js/JsCommands.scala.html#159380" title="(lng: Long)net.liftweb.http.js.JE.Num">Num</a><span class="delimiter">(</span><a href="MappedField.scala.html#147450" title="=&gt; Long">is</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; net.liftweb.http.js.JsExp" id="162951">asJsExp</a>: <a href="../../../../webkit/net/liftweb/http/js/JsCommands.scala.html#14908" title="net.liftweb.http.js.JsExp">JsExp</a> = <span title="net.liftweb.http.js.JsExp" class="keyword">if</span> <span class="delimiter">(</span><a href="#162936" title="=&gt; Boolean">defined_?</a><span class="delimiter">)</span> <a href="#11459" title="net.liftweb.mapper.MappedLongForeignKey[T,O]" class="keyword">super</a>.<a href="MappedLong.scala.html#162915" title="=&gt; net.liftweb.http.js.JsExp">asJsExp</a> <span class="keyword">else</span> <a href="../../../../webkit/net/liftweb/http/js/JsCommands.scala.html#14910" title="object net.liftweb.http.js.JE">JE</a>.<a href="../../../../webkit/net/liftweb/http/js/JsCommands.scala.html#49676" title="object net.liftweb.http.js.JE.JsNull">JsNull</a>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; net.liftweb.common.Box[net.liftweb.json.JsonAST.JValue]" id="162952">asJsonValue</a>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[net.liftweb.json.JsonAST.JValue]">Box</a><span class="delimiter">[</span>JsonAST.JValue<span class="delimiter">]</span> =
    <span title="net.liftweb.common.Box[net.liftweb.json.JsonAST.JValue]" class="keyword">if</span> <span class="delimiter">(</span><a href="#162936" title="=&gt; Boolean">defined_?</a><span class="delimiter">)</span> <a href="#11459" title="net.liftweb.mapper.MappedLongForeignKey[T,O]" class="keyword">super</a>.<a href="MappedLong.scala.html#162916" title="=&gt; net.liftweb.common.Box[net.liftweb.json.JsonAST.JValue]">asJsonValue</a> <span class="keyword">else</span> <a href="../../../../common/net/liftweb/common/Box.scala.html#27086" title="(value: net.liftweb.json.JsonAST.JNull.type)net.liftweb.common.Full[net.liftweb.json.JsonAST.JNull.type]">Full</a><span class="delimiter">(</span><a href="../../../../json/net/liftweb/json/JsonAST.scala.html#11132" title="object net.liftweb.json.JsonAST">JsonAST</a>.<a href="../../../../json/net/liftweb/json/JsonAST.scala.html#48513" title="object net.liftweb.json.JsonAST.JNull">JNull</a><span class="delimiter">)</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(in: Any)Long" id="162953">setFromAny</a><span class="delimiter">(</span><a title="Any" id="163185">in</a>: <span title="Any">Any</span><span class="delimiter">)</span>: <span title="Long">Long</span> =
  <a href="#163185" title="Any">in</a> <span title="Long" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <a href="../../../../json/net/liftweb/json/JsonAST.scala.html#11132" title="Long">JsonAST</a>.<a href="../../../../json/net/liftweb/json/JsonAST.scala.html#48513" title="object net.liftweb.json.JsonAST.JNull">JNull</a> =&gt; <a href="#11459" title="MappedLongForeignKey.this.type" class="keyword">this</a>.<a href="MappedField.scala.html#147418" title="(value: Long)Long">set</a><span class="delimiter">(</span><span title="Long(0L)" class="long">0L</span><span class="delimiter">)</span>
    <span class="keyword">case</span> <span title="Long">JsonAST</span>.JInt<span class="delimiter">(</span><a title="BigInt" id="163191">bigint</a><span class="delimiter">)</span> =&gt; <a href="#11459" title="MappedLongForeignKey.this.type" class="keyword">this</a>.<a href="MappedField.scala.html#147418" title="(value: Long)Long">set</a><span class="delimiter">(</span><a href="#163191" title="BigInt">bigint</a>.<span title="()Long">longValue</span><span class="delimiter">)</span>
    <span class="keyword">case</span> <a title="Long" id="163192">o</a> =&gt; <a href="#11459" title="net.liftweb.mapper.MappedLongForeignKey[T,O]" class="keyword">super</a>.<a href="MappedLong.scala.html#162922" title="(in: Any)Long">setFromAny</a><span class="delimiter">(</span><a href="#163192" title="Any">o</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Called when Schemifier adds a foreign key.  Return a function that will be called when Schemifier
   * is done with the schemification.
   */</span>
  <span class="keyword">def</span> <a title="=&gt; net.liftweb.common.Box[() =&gt; Unit]" id="162954">dbAddedForeignKey</a>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[() =&gt; Unit]">Box</a><span class="delimiter">[</span><span class="delimiter">(</span><span class="delimiter">)</span> =&gt; Unit<span class="delimiter">]</span> = <a href="../../../../common/net/liftweb/common/Box.scala.html#10581" title="object net.liftweb.common.Empty">Empty</a>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="()String" id="162955">toString</a> = <span title="String" class="keyword">if</span> <span class="delimiter">(</span><a href="#162936" title="=&gt; Boolean">defined_?</a><span class="delimiter">)</span> <a href="#11459" title="net.liftweb.mapper.MappedLongForeignKey[T,O]" class="keyword">super</a>.<a href="MappedField.scala.html#147469" title="()String">toString</a> <span class="keyword">else</span> <span title="java.lang.String(&quot;NULL&quot;)" class="string">&quot;NULL&quot;</span>

  <span class="keyword">def</span> <a title="(key: MappedLongForeignKey.this.KeyType)List[MappedLongForeignKey.this.OwnerType]" id="162956">findFor</a><span class="delimiter">(</span><a title="MappedLongForeignKey.this.KeyType" id="163200">key</a>: <span title="MappedLongForeignKey.this.KeyType">KeyType</span><span class="delimiter">)</span>: <span title="List[MappedLongForeignKey.this.OwnerType]">List</span><span class="delimiter">[</span>OwnerType<span class="delimiter">]</span> = <a href="#162969" title="T">theOwner</a>.<a href="Mapper.scala.html#147071" title="=&gt; net.liftweb.mapper.MetaMapper[T]">getSingleton</a>.<a href="MetaMapper.scala.html#146823" title="(by: net.liftweb.mapper.QueryParam[T]*)List[T]">findAll</a><span class="delimiter">(</span><a href="MetaMapper.scala.html#155049" title="(field: net.liftweb.mapper.MappedField[Long,T], value: MappedLongForeignKey.this.KeyType)(implicit evidence$5: MappedLongForeignKey.this.KeyType =&gt; Long)net.liftweb.mapper.Cmp[T,Long]">By</a><span title="&lt;:&lt;[MappedLongForeignKey.this.KeyType,MappedLongForeignKey.this.KeyType]" class="delimiter">(</span><a href="#11459" title="net.liftweb.mapper.MappedLongForeignKey[T,O]" class="keyword">this</a>, <a href="#163200" title="MappedLongForeignKey.this.KeyType">key</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(key: MappedLongForeignKey.this.KeyedForeignType)List[MappedLongForeignKey.this.OwnerType]" id="162957">findFor</a><span class="delimiter">(</span><a title="MappedLongForeignKey.this.KeyedForeignType" id="163282">key</a>: <a href="#11461" title="MappedLongForeignKey.this.KeyedForeignType">KeyedForeignType</a><span class="delimiter">)</span>: <span title="List[MappedLongForeignKey.this.OwnerType]">List</span><span class="delimiter">[</span>OwnerType<span class="delimiter">]</span> = <a href="#162969" title="T">theOwner</a>.<a href="Mapper.scala.html#147071" title="=&gt; net.liftweb.mapper.MetaMapper[T]">getSingleton</a>.<a href="MetaMapper.scala.html#146823" title="(by: net.liftweb.mapper.QueryParam[T]*)List[T]">findAll</a><span class="delimiter">(</span><a href="MetaMapper.scala.html#155061" title="(field: net.liftweb.mapper.MappedForeignKey[Long,T,MappedLongForeignKey.this.KeyedForeignType], value: MappedLongForeignKey.this.KeyedForeignType)net.liftweb.mapper.Cmp[T,Long]">By</a><span class="delimiter">(</span><a href="#11459" title="net.liftweb.mapper.MappedLongForeignKey[T,O]" class="keyword">this</a>, <a href="#163282" title="MappedLongForeignKey.this.KeyedForeignType">key</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="comment">// def +(in: Long): Long = is + in</span>

  <span class="comment">/**
   * Given the driver type, return the string required to create the column in the database
   */</span>
  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(dbType: net.liftweb.mapper.package.DriverType, colName: String)String" id="162958">fieldCreatorString</a><span class="delimiter">(</span><a title="net.liftweb.mapper.package.DriverType" id="163373">dbType</a>: <a href="../../../../db/net/liftweb/db/Driver.scala.html#10921" title="net.liftweb.mapper.package.DriverType">DriverType</a>, <a title="String" id="163374">colName</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="String">String</span> = <a href="#163374" title="String">colName</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot; &quot;)" class="string">&quot; &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#163373" title="net.liftweb.mapper.package.DriverType">dbType</a>.<a href="../../../../db/net/liftweb/db/Driver.scala.html#66509" title="=&gt; String">longForeignKeyColumnType</a>  <span title="(x$1: Any)java.lang.String">+</span> <a href="MappedField.scala.html#147397" title="()java.lang.String">notNullAppender</a><span class="delimiter">(</span><span class="delimiter">)</span>

<span class="delimiter">}</span>

<span class="keyword">abstract</span> <span class="keyword">class</span> <a title="class MappedStringForeignKey[T &lt;: net.liftweb.mapper.Mapper[T], O &lt;: net.liftweb.mapper.KeyedMapper[String,O]] extends net.liftweb.mapper.MappedString[T] with net.liftweb.mapper.MappedForeignKey[String,T,O] with net.liftweb.mapper.BaseForeignKey with ScalaObject" id="11462">MappedStringForeignKey</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: net.liftweb.mapper.Mapper[T]" id="11463">T</a>&lt;:Mapper<span class="delimiter">[</span>T<span class="delimiter">]</span>,<a title="&gt;: Nothing &lt;: net.liftweb.mapper.KeyedMapper[String,O]" id="11464">O</a>&lt;:KeyedMapper<span class="delimiter">[</span>String, O<span class="delimiter">]</span><span class="delimiter">]</span><a href="#11462" title="ScalaObject" class="delimiter">(</a><span class="keyword">override</span> <span class="keyword">val</span> <a title="T" id="163410">fieldOwner</a>: <a href="#11463" title="T">T</a>, <a title="=&gt; net.liftweb.mapper.KeyedMetaMapper[String,O]" id="163411">foreign</a>: =&gt; KeyedMetaMapper<span class="delimiter">[</span>String, O<span class="delimiter">]</span>,<span class="keyword">override</span> <span class="keyword">val</span> <a title="Int" id="163412">maxLen</a>: <span title="Int">Int</span><span class="delimiter">)</span>
<span class="keyword">extends</span> <a href="MappedString.scala.html#11569" title="net.liftweb.mapper.MappedString[T]">MappedString</a><span class="delimiter">[</span>T<span class="delimiter">]</span><span class="delimiter">(</span><a href="#163410" title="T">fieldOwner</a>, <a href="#163412" title="Int">maxLen</a><span class="delimiter">)</span> <span class="keyword">with</span> <a href="#11449" title="net.liftweb.mapper.MappedForeignKey[String,T,O]">MappedForeignKey</a><span class="delimiter">[</span>String,T,O<span class="delimiter">]</span> <span class="keyword">with</span> <a href="#11446" title="net.liftweb.mapper.BaseForeignKey">BaseForeignKey</a> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="=&gt; Boolean" id="163390">defined_?</a> = <a href="MappedString.scala.html#147497" title="=&gt; String">i_is_!</a> <span title="(x$1: AnyRef)Boolean">ne</span> <span title="Null(null)" class="keyword">null</span>

  <span class="keyword">type</span> <a title="String" id="163391">KeyType</a> = <span title="String">String</span>
  <span class="keyword">type</span> <a title="O" id="163392">KeyedForeignType</a> = <a href="#11464" title="O">O</a>
  <span class="keyword">type</span> <a title="T" id="163393">OwnerType</a> = <a href="#11463" title="T">T</a>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(field: String)String" id="163394">jdbcFriendly</a><span class="delimiter">(</span><a title="String" id="163418">field</a>: <span title="String">String</span><span class="delimiter">)</span> = <a href="MappedString.scala.html#147497" title="=&gt; String">i_is_!</a>
  <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; String" id="163395">jdbcFriendly</a> = <a href="MappedString.scala.html#147497" title="=&gt; String">i_is_!</a>

  <span class="keyword">def</span> <a title="=&gt; net.liftweb.mapper.KeyedMetaMapper[String,O]" id="163396">dbKeyToTable</a>: <a href="MetaMapper.scala.html#11791" title="net.liftweb.mapper.KeyedMetaMapper[String,O]">KeyedMetaMapper</a><span class="delimiter">[</span>String, O<span class="delimiter">]</span> = <a href="#163411" title="=&gt; net.liftweb.mapper.KeyedMetaMapper[String,O]">foreign</a>
  <span class="keyword">def</span> <a title="=&gt; net.liftweb.mapper.MappedField[String,O] with net.liftweb.mapper.IndexedField[String]" id="163397">dbKeyToColumn</a> = <a href="#163396" title="=&gt; net.liftweb.mapper.KeyedMetaMapper[String,O]">dbKeyToTable</a>.<a href="Mapper.scala.html#147132" title="=&gt; net.liftweb.mapper.MappedField[String,O] with net.liftweb.mapper.IndexedField[String]">primaryKeyField</a>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; Boolean" id="163398">dbIndexed_?</a> = <span title="Boolean(true)" class="keyword">true</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; Boolean" id="163399">dbForeignKey_?</a> = <span title="Boolean(true)" class="keyword">true</span>

  <span class="keyword">def</span> <a title="(obs: net.liftweb.common.Box[net.liftweb.mapper.KeyObfuscator])net.liftweb.http.js.JsExp" id="163400">asSafeJs</a><span class="delimiter">(</span><a title="net.liftweb.common.Box[net.liftweb.mapper.KeyObfuscator]" id="163444">obs</a>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[net.liftweb.mapper.KeyObfuscator]">Box</a><span class="delimiter">[</span>KeyObfuscator<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../../../webkit/net/liftweb/http/js/JsCommands.scala.html#14908" title="net.liftweb.http.js.JsExp">JsExp</a> =
    <a href="#163444" title="net.liftweb.common.Box[net.liftweb.mapper.KeyObfuscator]">obs</a>.<a href="../../../../common/net/liftweb/common/Box.scala.html#27020" title="(f: net.liftweb.mapper.KeyObfuscator =&gt; net.liftweb.http.js.JE.Str)net.liftweb.common.Box[net.liftweb.http.js.JE.Str]">map</a><span class="delimiter">(</span><a title="net.liftweb.mapper.KeyObfuscator" id="163450">o</a> =&gt; <a href="../../../../webkit/net/liftweb/http/js/JsCommands.scala.html#14910" title="object net.liftweb.http.js.JE">JE</a>.<a href="../../../../webkit/net/liftweb/http/js/JsCommands.scala.html#158029" title="(str: String)net.liftweb.http.js.JE.Str">Str</a><span class="delimiter">(</span><a href="#163450" title="net.liftweb.mapper.KeyObfuscator">o</a>.<a href="MetaMapper.scala.html#163065" title="(theType: net.liftweb.mapper.KeyedMetaMapper[String,O], key: String)String">obscure</a><span class="delimiter">(</span><a href="#163396" title="=&gt; net.liftweb.mapper.KeyedMetaMapper[String,O]">dbKeyToTable</a>, <a href="MappedField.scala.html#147450" title="=&gt; String">is</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>.<a href="../../../../common/net/liftweb/common/Box.scala.html#27017" title="(default: =&gt; net.liftweb.http.js.JE.Str)net.liftweb.http.js.JE.Str">openOr</a><span class="delimiter">(</span><a href="../../../../webkit/net/liftweb/http/js/JsCommands.scala.html#14910" title="object net.liftweb.http.js.JE">JE</a>.<a href="../../../../webkit/net/liftweb/http/js/JsCommands.scala.html#158029" title="(str: String)net.liftweb.http.js.JE.Str">Str</a><span class="delimiter">(</span><a href="MappedField.scala.html#147450" title="=&gt; String">is</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="comment">/**
   * Called when Schemifier adds a foreign key.  Return a function that will be called when Schemifier
   * is done with the schemification.
   */</span>
  <span class="keyword">def</span> <a title="=&gt; net.liftweb.common.Box[() =&gt; Unit]" id="163401">dbAddedForeignKey</a>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[() =&gt; Unit]">Box</a><span class="delimiter">[</span><span class="delimiter">(</span><span class="delimiter">)</span> =&gt; Unit<span class="delimiter">]</span> = <a href="../../../../common/net/liftweb/common/Box.scala.html#10581" title="object net.liftweb.common.Empty">Empty</a>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="()String" id="163402">toString</a> = <span title="String" class="keyword">if</span> <span class="delimiter">(</span><a href="#163390" title="=&gt; Boolean">defined_?</a><span class="delimiter">)</span> <a href="#11462" title="net.liftweb.mapper.MappedStringForeignKey[T,O]" class="keyword">super</a>.<a href="MappedField.scala.html#147469" title="()String">toString</a> <span class="keyword">else</span> <span title="java.lang.String(&quot;NULL&quot;)" class="string">&quot;NULL&quot;</span>

  <span class="keyword">def</span> <a title="(v: net.liftweb.common.Box[O])T" id="163403">set</a><span class="delimiter">(</span><a title="net.liftweb.common.Box[O]" id="163476">v</a>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[O]">Box</a><span class="delimiter">[</span>O<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#11463" title="T">T</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="String" id="163481">toSet</a>: <span title="String">String</span> = <a href="#163476" title="net.liftweb.common.Box[O]">v</a> <span title="String" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <span title="String">Full</span><span class="delimiter">(</span><a title="O" id="163483">i</a><span class="delimiter">)</span> =&gt; <a href="#163483" title="O">i</a>.<a href="Mapper.scala.html#147132" title="=&gt; net.liftweb.mapper.MappedField[String,O] with net.liftweb.mapper.IndexedField[String]">primaryKeyField</a>.<a href="MappedField.scala.html#147450" title="=&gt; String">is</a>
      <span class="keyword">case</span> <span title="Null(null)">_</span> =&gt; <span title="Null(null)" class="keyword">null</span>
    <span class="delimiter">}</span>

    <a href="MappedString.scala.html#147505" title="(v: String)T" class="keyword">this</a><span class="delimiter">(</span><a href="#163481" title="String">toSet</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(key: MappedStringForeignKey.this.KeyType)List[MappedStringForeignKey.this.OwnerType]" id="163404">findFor</a><span class="delimiter">(</span><a title="MappedStringForeignKey.this.KeyType" id="163537">key</a>: <span title="MappedStringForeignKey.this.KeyType">KeyType</span><span class="delimiter">)</span>: <span title="List[MappedStringForeignKey.this.OwnerType]">List</span><span class="delimiter">[</span>OwnerType<span class="delimiter">]</span> = <a href="#163410" title="=&gt; T">fieldOwner</a>.<a href="Mapper.scala.html#147071" title="=&gt; net.liftweb.mapper.MetaMapper[T]">getSingleton</a>.<a href="MetaMapper.scala.html#146823" title="(by: net.liftweb.mapper.QueryParam[T]*)List[T]">findAll</a><span class="delimiter">(</span><a href="MetaMapper.scala.html#155049" title="(field: net.liftweb.mapper.MappedField[String,T], value: MappedStringForeignKey.this.KeyType)(implicit evidence$5: MappedStringForeignKey.this.KeyType =&gt; String)net.liftweb.mapper.Cmp[T,String]">By</a><span title="&lt;:&lt;[MappedStringForeignKey.this.KeyType,MappedStringForeignKey.this.KeyType]" class="delimiter">(</span><a href="#11462" title="net.liftweb.mapper.MappedStringForeignKey[T,O]" class="keyword">this</a>, <a href="#163537" title="MappedStringForeignKey.this.KeyType">key</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(key: MappedStringForeignKey.this.KeyedForeignType)List[MappedStringForeignKey.this.OwnerType]" id="163405">findFor</a><span class="delimiter">(</span><a title="MappedStringForeignKey.this.KeyedForeignType" id="163622">key</a>: <a href="#11464" title="MappedStringForeignKey.this.KeyedForeignType">KeyedForeignType</a><span class="delimiter">)</span>: <span title="List[MappedStringForeignKey.this.OwnerType]">List</span><span class="delimiter">[</span>OwnerType<span class="delimiter">]</span> = <a href="#163410" title="=&gt; T">fieldOwner</a>.<a href="Mapper.scala.html#147071" title="=&gt; net.liftweb.mapper.MetaMapper[T]">getSingleton</a>.<a href="MetaMapper.scala.html#146823" title="(by: net.liftweb.mapper.QueryParam[T]*)List[T]">findAll</a><span class="delimiter">(</span><a href="MetaMapper.scala.html#155061" title="(field: net.liftweb.mapper.MappedForeignKey[String,T,MappedStringForeignKey.this.KeyedForeignType], value: MappedStringForeignKey.this.KeyedForeignType)net.liftweb.mapper.Cmp[T,String]">By</a><span class="delimiter">(</span><a href="#11462" title="net.liftweb.mapper.MappedStringForeignKey[T,O]" class="keyword">this</a>, <a href="#163622" title="MappedStringForeignKey.this.KeyedForeignType">key</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="comment">/**
   * Given the driver type, return the string required to create the column in the database
   */</span>
  <span class="comment">// defect 79 override def fieldCreatorString(dbType: DriverType, colName: String): String = colName + &quot; &quot; + dbType.longForeignKeyColumnType</span>

<span class="delimiter">}</span>


        </pre>
    </body>
</html>