<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>util/net/liftweb/util/VCardParser.scala</title>
        <script type="text/javascript" src="../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/*
 * Copyright 2008-2011 WorldWide Conferencing, LLC
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */</span>

<span class="keyword">package</span> net.liftweb
<span class="keyword">package</span> util

<span class="keyword">import</span> scala.collection.mutable._
<span class="keyword">import</span> scala.util.parsing.combinator._

<span class="comment">/**
 * Parser a VCard entry such as
 * 
 * BEGIN:VCARD
 * VERSION:2.1
 * N:Gump;Forrest
 * FN:Forrest Gump
 * ORG:Bubba Gump Shrimp Co.
 * TITLE:Shrimp Man
 * TEL;WORK;VOICE:(111) 555-1212
 * TEL;HOME;VOICE:(404) 555-1212
 * ADR;WORK:;;100 Waters Edge;Baytown;LA;30314;United States of America
 * END:VCARD
 *
 */</span>
<span class="keyword">object</span> <a title="object net.liftweb.util.VCardParser" id="13721">VCardParser</a> <span title="ScalaObject" class="keyword">extends</span> <span title="scala.util.parsing.combinator.Parsers">Parsers</span> <span class="delimiter">{</span>
  <span class="keyword">type</span> <a title="Char" id="322015">Elem</a> = <span title="Char">Char</span>

  <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="implicit net.liftweb.util.VCardParser.strToInput : (in: String)net.liftweb.util.VCardParser.Input" id="322016">strToInput</a><span class="delimiter">(</span><a title="String" id="322067">in</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="net.liftweb.util.VCardParser.Input">Input</span> = <span title="(chars: Array[Char])scala.util.parsing.input.CharArrayReader" class="keyword">new</span> scala.util.parsing.input.<span title="scala.util.parsing.input.CharArrayReader">CharArrayReader</span><span class="delimiter">(</span><a href="#322067" title="String">in</a>.<span title="()Array[Char]">toCharArray</span><span class="delimiter">)</span>

  case <span class="keyword">class</span> <a title="class VCardKey extends java.lang.Object with ScalaObject with Product with Serializable" id="322509">VCardKey</a><a href="#322509" title="ScalaObject" class="delimiter">(</a><a title="String" id="322245">name</a>: <span title="String">String</span>, <a title="List[(String, String)]" id="322246">props</a>: <span title="List[(String, String)]">List</span><span class="delimiter">[</span><span class="delimiter">(</span>String, String<span class="delimiter">)</span><span class="delimiter">]</span><span class="delimiter">)</span>
  case <span class="keyword">class</span> <a title="class VCardEntry extends java.lang.Object with ScalaObject with Product with Serializable" id="322505">VCardEntry</a><a href="#322505" title="ScalaObject" class="delimiter">(</a><a title="net.liftweb.util.VCardParser.VCardKey" id="322329">key</a>: <a href="#322509" title="net.liftweb.util.VCardParser.VCardKey">VCardKey</a>, <a title="List[String]" id="322330">value</a>: <span title="List[String]">List</span><span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">)</span>

  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="net.liftweb.util.VCardParser.Parser[Option[net.liftweb.util.VCardParser.~[net.liftweb.util.VCardParser.Elem,net.liftweb.util.VCardParser.Elem]]]" id="322024">multiLineSep</a> = <span title="(p: =&gt; net.liftweb.util.VCardParser.Parser[net.liftweb.util.VCardParser.~[net.liftweb.util.VCardParser.Elem,net.liftweb.util.VCardParser.Elem]])net.liftweb.util.VCardParser.Parser[Option[net.liftweb.util.VCardParser.~[net.liftweb.util.VCardParser.Elem,net.liftweb.util.VCardParser.Elem]]]">opt</span><span class="delimiter">(</span><span title="(e: net.liftweb.util.VCardParser.Elem)net.liftweb.util.VCardParser.Parser[net.liftweb.util.VCardParser.Elem]">elem</span><span class="delimiter">(</span><span title="Char(\'\\n\')" class="char">'\n'</span><span class="delimiter">)</span> <span title="(q: =&gt; net.liftweb.util.VCardParser.Parser[net.liftweb.util.VCardParser.Elem])net.liftweb.util.VCardParser.Parser[net.liftweb.util.VCardParser.~[net.liftweb.util.VCardParser.Elem,net.liftweb.util.VCardParser.Elem]]">~</span> <span title="(e: net.liftweb.util.VCardParser.Elem)net.liftweb.util.VCardParser.Parser[net.liftweb.util.VCardParser.Elem]">elem</span><span class="delimiter">(</span><span title="Char(\' \')" class="char">' '</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="net.liftweb.util.VCardParser.Parser[String]" id="322026">value</a> = <span class="delimiter">(</span><a href="#322023" title="=&gt; net.liftweb.util.VCardParser.Parser[Option[net.liftweb.util.VCardParser.~[net.liftweb.util.VCardParser.Elem,net.liftweb.util.VCardParser.Elem]]]">multiLineSep</a> <span title="(q: =&gt; net.liftweb.util.VCardParser.Parser[net.liftweb.util.VCardParser.Elem])net.liftweb.util.VCardParser.Parser[net.liftweb.util.VCardParser.Elem]">~&gt;</span> <span title="(kind: String, p: net.liftweb.util.VCardParser.Elem =&gt; Boolean)net.liftweb.util.VCardParser.Parser[net.liftweb.util.VCardParser.Elem]">elem</span><span class="delimiter">(</span><span title="java.lang.String(&quot;value&quot;)" class="string">&quot;value&quot;</span>, <span class="delimiter">{</span><a title="net.liftweb.util.VCardParser.Elem" id="322071">c</a> =&gt; <span title="=&gt; Boolean">!</span><a href="#322071" title="implicit scala.LowPriorityImplicits.charWrapper : (c: Char)scala.runtime.RichChar">c</a>.<span title="=&gt; Boolean">isControl</span> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#322071" title="net.liftweb.util.VCardParser.Elem">c</a> <span title="(x: Char)Boolean">!=</span> <span title="Char(\';\')" class="char">';'</span><span class="delimiter">}</span><span class="delimiter">)</span> <span title="(q: =&gt; net.liftweb.util.VCardParser.Parser[Option[net.liftweb.util.VCardParser.~[net.liftweb.util.VCardParser.Elem,net.liftweb.util.VCardParser.Elem]]])net.liftweb.util.VCardParser.Parser[net.liftweb.util.VCardParser.Elem]">&lt;~</span> <a href="#322023" title="=&gt; net.liftweb.util.VCardParser.Parser[Option[net.liftweb.util.VCardParser.~[net.liftweb.util.VCardParser.Elem,net.liftweb.util.VCardParser.Elem]]]">multiLineSep</a><span class="delimiter">)</span>.<span title="=&gt; net.liftweb.util.VCardParser.Parser[List[net.liftweb.util.VCardParser.Elem]]">*</span> <span title="(f: List[net.liftweb.util.VCardParser.Elem] =&gt; String)net.liftweb.util.VCardParser.Parser[String]">^^</span> <a href="#322094" title="String" class="delimiter">{</a><span class="keyword">case</span> <a title="String" id="322095">l</a> =&gt; <a href="#322095" title="List[net.liftweb.util.VCardParser.Elem]">l</a>.<span title="=&gt; String">mkString</span><span class="delimiter">}</span>
  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="net.liftweb.util.VCardParser.Parser[List[net.liftweb.util.VCardParser.Elem]]" id="322028">spaces</a> = <span class="delimiter">(</span><span title="(e: net.liftweb.util.VCardParser.Elem)net.liftweb.util.VCardParser.Parser[net.liftweb.util.VCardParser.Elem]">elem</span><span class="delimiter">(</span><span title="Char(\' \')" class="char">' '</span><span class="delimiter">)</span> <span title="(q: =&gt; net.liftweb.util.VCardParser.Parser[net.liftweb.util.VCardParser.Elem])net.liftweb.util.VCardParser.Parser[net.liftweb.util.VCardParser.Elem]">|</span> <span title="(e: net.liftweb.util.VCardParser.Elem)net.liftweb.util.VCardParser.Parser[net.liftweb.util.VCardParser.Elem]">elem</span><span class="delimiter">(</span><span title="Char(\'\\t\')" class="char">'\t'</span><span class="delimiter">)</span> <span title="(q: =&gt; net.liftweb.util.VCardParser.Parser[net.liftweb.util.VCardParser.Elem])net.liftweb.util.VCardParser.Parser[net.liftweb.util.VCardParser.Elem]">|</span> <span title="(e: net.liftweb.util.VCardParser.Elem)net.liftweb.util.VCardParser.Parser[net.liftweb.util.VCardParser.Elem]">elem</span><span class="delimiter">(</span><span title="Char(\'\\n\')" class="char">'\n'</span><span class="delimiter">)</span> <span title="(q: =&gt; net.liftweb.util.VCardParser.Parser[net.liftweb.util.VCardParser.Elem])net.liftweb.util.VCardParser.Parser[net.liftweb.util.VCardParser.Elem]">|</span> <span title="(e: net.liftweb.util.VCardParser.Elem)net.liftweb.util.VCardParser.Parser[net.liftweb.util.VCardParser.Elem]">elem</span><span class="delimiter">(</span><span title="Char(\'\\r\')" class="char">'\r'</span><span class="delimiter">)</span><span class="delimiter">)</span><span title="=&gt; net.liftweb.util.VCardParser.Parser[List[net.liftweb.util.VCardParser.Elem]]">*</span>
  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="net.liftweb.util.VCardParser.Parser[String]" id="322030">key</a> = <span title="(kind: String, p: net.liftweb.util.VCardParser.Elem =&gt; Boolean)net.liftweb.util.VCardParser.Parser[net.liftweb.util.VCardParser.Elem]">elem</span><span class="delimiter">(</span><span title="java.lang.String(&quot;key&quot;)" class="string">&quot;key&quot;</span>, <span class="delimiter">{</span><a title="net.liftweb.util.VCardParser.Elem" id="322134">c</a> =&gt; <a href="#322134" title="implicit scala.LowPriorityImplicits.charWrapper : (c: Char)scala.runtime.RichChar">c</a>.<span title="=&gt; Boolean">isLetterOrDigit</span> <span title="(x: Boolean)Boolean">||</span> <a href="#322134" title="net.liftweb.util.VCardParser.Elem">c</a> <span title="(x: Char)Boolean">==</span> <span title="Char(\'-\')" class="char">'-'</span> <span title="(x: Boolean)Boolean">||</span> <a href="#322134" title="net.liftweb.util.VCardParser.Elem">c</a> <span title="(x: Char)Boolean">==</span> <span title="Char(\'_\')" class="char">'_'</span><span class="delimiter">}</span><span class="delimiter">)</span>.<span title="=&gt; net.liftweb.util.VCardParser.Parser[List[net.liftweb.util.VCardParser.Elem]]">+</span> <span title="(f: List[net.liftweb.util.VCardParser.Elem] =&gt; String)net.liftweb.util.VCardParser.Parser[String]">^^</span> <a href="#322148" title="String" class="delimiter">{</a><span class="keyword">case</span> <a title="String" id="322149">list</a> =&gt; <a href="#322149" title="List[net.liftweb.util.VCardParser.Elem]">list</a>.<span title="=&gt; String">mkString</span><span class="delimiter">}</span>
  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="net.liftweb.util.VCardParser.Parser[List[(String, String)]]" id="322032">props</a> = <span class="delimiter">(</span><span class="delimiter">(</span><span class="delimiter">(</span><span class="delimiter">(</span><span title="(e: net.liftweb.util.VCardParser.Elem)net.liftweb.util.VCardParser.Parser[net.liftweb.util.VCardParser.Elem]">elem</span><span class="delimiter">(</span><span title="Char(\';\')" class="char">';'</span><span class="delimiter">)</span> <span title="(q: =&gt; net.liftweb.util.VCardParser.Parser[String])net.liftweb.util.VCardParser.Parser[String]">~&gt;</span> <a href="#322029" title="=&gt; net.liftweb.util.VCardParser.Parser[String]">key</a> <span title="(q: =&gt; net.liftweb.util.VCardParser.Parser[net.liftweb.util.VCardParser.Elem])net.liftweb.util.VCardParser.Parser[String]">&lt;~</span> <span title="(e: net.liftweb.util.VCardParser.Elem)net.liftweb.util.VCardParser.Parser[net.liftweb.util.VCardParser.Elem]">elem</span><span class="delimiter">(</span><span title="Char(\'=\')" class="char">'='</span><span class="delimiter">)</span><span class="delimiter">)</span> <span title="(q: =&gt; net.liftweb.util.VCardParser.Parser[String])net.liftweb.util.VCardParser.Parser[net.liftweb.util.VCardParser.~[String,String]]">~</span> <a href="#322029" title="=&gt; net.liftweb.util.VCardParser.Parser[String]">key</a><span class="delimiter">)</span> <span title="(f: net.liftweb.util.VCardParser.~[String,String] =&gt; (String, String))net.liftweb.util.VCardParser.Parser[(String, String)]">^^</span> <a href="#322177" title="(String, String)" class="delimiter">{</a><span class="keyword">case</span> <a title="(String, String)" id="322180">a</a> ~ <a title="String" id="322181">b</a> =&gt; <span title="(_1: String, _2: String)(String, String)" class="delimiter">(</span><a href="#322180" title="String">a</a>, <a href="#322181" title="String">b</a><span class="delimiter">)</span><span class="delimiter">}</span><span class="delimiter">)</span> <span title="(q: =&gt; net.liftweb.util.VCardParser.Parser[(String, String)])net.liftweb.util.VCardParser.Parser[(String, String)]">|</span> <span class="delimiter">(</span><span class="delimiter">(</span><span title="(e: net.liftweb.util.VCardParser.Elem)net.liftweb.util.VCardParser.Parser[net.liftweb.util.VCardParser.Elem]">elem</span><span class="delimiter">(</span><span title="Char(\';\')" class="char">';'</span><span class="delimiter">)</span> <span title="(q: =&gt; net.liftweb.util.VCardParser.Parser[String])net.liftweb.util.VCardParser.Parser[String]">~&gt;</span> <a href="#322029" title="=&gt; net.liftweb.util.VCardParser.Parser[String]">key</a><span class="delimiter">)</span> <span title="(f: String =&gt; (String, java.lang.String))net.liftweb.util.VCardParser.Parser[(String, java.lang.String)]">^^</span> <a href="#322205" title="(String, java.lang.String)" class="delimiter">{</a><span class="keyword">case</span> <a title="(String, java.lang.String)" id="322206">a</a> =&gt; <span title="(_1: String, _2: java.lang.String)(String, java.lang.String)" class="delimiter">(</span><a href="#322206" title="String">a</a>, <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span><span class="delimiter">}</span><span class="delimiter">)</span><span class="delimiter">)</span><span title="=&gt; net.liftweb.util.VCardParser.Parser[List[(String, String)]]">*</span>
  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="net.liftweb.util.VCardParser.Parser[net.liftweb.util.VCardParser.VCardKey]" id="322034">left</a> = <span class="delimiter">(</span><a href="#322029" title="=&gt; net.liftweb.util.VCardParser.Parser[String]">key</a> <span title="(q: =&gt; net.liftweb.util.VCardParser.Parser[List[(String, String)]])net.liftweb.util.VCardParser.Parser[net.liftweb.util.VCardParser.~[String,List[(String, String)]]]">~</span> <a href="#322031" title="=&gt; net.liftweb.util.VCardParser.Parser[List[(String, String)]]">props</a><span class="delimiter">)</span> <span title="(f: net.liftweb.util.VCardParser.~[String,List[(String, String)]] =&gt; net.liftweb.util.VCardParser.VCardKey)net.liftweb.util.VCardParser.Parser[net.liftweb.util.VCardParser.VCardKey]">^^</span> <a href="#322228" title="net.liftweb.util.VCardParser.VCardKey" class="delimiter">{</a><span class="keyword">case</span> <a title="net.liftweb.util.VCardParser.VCardKey" id="322231">k</a> ~ <a title="List[(String, String)]" id="322232">l</a> =&gt; <a href="#322509" title="(name: String, props: List[(String, String)])net.liftweb.util.VCardParser.VCardKey">VCardKey</a><span class="delimiter">(</span><a href="#322231" title="String">k</a>, <a href="#322232" title="List[(String, String)]">l</a><span class="delimiter">)</span><span class="delimiter">}</span>
  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="net.liftweb.util.VCardParser.Parser[List[net.liftweb.util.VCardParser.VCardEntry]]" id="322036">expr</a> = <span class="delimiter">(</span><span class="delimiter">(</span><span class="delimiter">(</span><a href="#322027" title="=&gt; net.liftweb.util.VCardParser.Parser[List[net.liftweb.util.VCardParser.Elem]]">spaces</a> <span title="(q: =&gt; net.liftweb.util.VCardParser.Parser[net.liftweb.util.VCardParser.VCardKey])net.liftweb.util.VCardParser.Parser[net.liftweb.util.VCardParser.VCardKey]">~&gt;</span> <a href="#322033" title="=&gt; net.liftweb.util.VCardParser.Parser[net.liftweb.util.VCardParser.VCardKey]">left</a> <span title="(p: =&gt; net.liftweb.util.VCardParser.Parser[net.liftweb.util.VCardParser.Elem])net.liftweb.util.VCardParser.Parser[net.liftweb.util.VCardParser.~[net.liftweb.util.VCardParser.VCardKey,net.liftweb.util.VCardParser.Elem]]">~!</span> <span title="(e: net.liftweb.util.VCardParser.Elem)net.liftweb.util.VCardParser.Parser[net.liftweb.util.VCardParser.Elem]">elem</span><span class="delimiter">(</span><span title="Char(\':\')" class="char">':'</span><span class="delimiter">)</span><span class="delimiter">)</span> <span title="(q: =&gt; net.liftweb.util.VCardParser.Parser[List[String]])net.liftweb.util.VCardParser.Parser[net.liftweb.util.VCardParser.~[net.liftweb.util.VCardParser.~[net.liftweb.util.VCardParser.VCardKey,net.liftweb.util.VCardParser.Elem],List[String]]]">~</span> <span title="(p: =&gt; net.liftweb.util.VCardParser.Parser[String], q: =&gt; net.liftweb.util.VCardParser.Parser[Any])net.liftweb.util.VCardParser.Parser[List[String]]">repsep</span><span class="delimiter">(</span><a href="#322025" title="=&gt; net.liftweb.util.VCardParser.Parser[String]">value</a>, <span title="implicit scala.util.parsing.combinator.Parsers.accept : (e: net.liftweb.util.VCardParser.Elem)net.liftweb.util.VCardParser.Parser[net.liftweb.util.VCardParser.Elem]" class="char">';'</span><span class="delimiter">)</span><span class="delimiter">)</span> <span title="(f: net.liftweb.util.VCardParser.~[net.liftweb.util.VCardParser.~[net.liftweb.util.VCardParser.VCardKey,net.liftweb.util.VCardParser.Elem],List[String]] =&gt; net.liftweb.util.VCardParser.VCardEntry)net.liftweb.util.VCardParser.Parser[net.liftweb.util.VCardParser.VCardEntry]">^^</span> <a href="#322310" title="net.liftweb.util.VCardParser.VCardEntry" class="delimiter">{</a><span class="keyword">case</span> <a title="net.liftweb.util.VCardParser.VCardEntry" id="322315">a</a> ~ _ ~ <a title="List[String]" id="322316">b</a> =&gt; <a href="#322505" title="(key: net.liftweb.util.VCardParser.VCardKey, value: List[String])net.liftweb.util.VCardParser.VCardEntry">VCardEntry</a><span class="delimiter">(</span><a href="#322315" title="net.liftweb.util.VCardParser.VCardKey">a</a>, <a href="#322316" title="List[String]">b</a><span class="delimiter">)</span><span class="delimiter">}</span><span class="delimiter">)</span><span title="=&gt; net.liftweb.util.VCardParser.Parser[List[net.liftweb.util.VCardParser.VCardEntry]]">+</span>

  <span class="keyword">def</span> <a title="(in: String)Either[List[net.liftweb.util.VCardParser.VCardEntry],String]" id="322037">parse</a><span class="delimiter">(</span><a title="String" id="322461">in</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="Either[List[net.liftweb.util.VCardParser.VCardEntry],String]">Either</span><span class="delimiter">[</span>List<span class="delimiter">[</span>VCardEntry<span class="delimiter">]</span>, String<span class="delimiter">]</span> = <a href="#322035" title="(in: net.liftweb.util.VCardParser.Input)net.liftweb.util.VCardParser.ParseResult[List[net.liftweb.util.VCardParser.VCardEntry]]">expr</a><span class="delimiter">(</span><a href="#322016" title="implicit net.liftweb.util.VCardParser.strToInput : (in: String)net.liftweb.util.VCardParser.Input">in</a><span class="delimiter">)</span> <span title="Either[List[net.liftweb.util.VCardParser.VCardEntry],String]" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <span title="Left[List[net.liftweb.util.VCardParser.VCardEntry],Nothing]">Success</span><span class="delimiter">(</span><a title="List[net.liftweb.util.VCardParser.VCardEntry]" id="322480">v</a>, <a title="net.liftweb.util.VCardParser.Input" id="322481">r</a><span class="delimiter">)</span> =&gt; <span title="(a: List[net.liftweb.util.VCardParser.VCardEntry])Left[List[net.liftweb.util.VCardParser.VCardEntry],Nothing]">Left</span><span class="delimiter">(</span><a href="#322480" title="List[net.liftweb.util.VCardParser.VCardEntry]">v</a><span class="delimiter">)</span>
    <span class="keyword">case</span> <a title="Right[Nothing,java.lang.String]" id="322497">err</a> @ _ =&gt; <span title="(b: java.lang.String)Right[Nothing,java.lang.String]">Right</span><span class="delimiter">(</span><a href="#322497" title="net.liftweb.util.VCardParser.ParseResult[List[net.liftweb.util.VCardParser.VCardEntry]]">err</a> <span title="()java.lang.String">toString</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>


        </pre>
    </body>
</html>