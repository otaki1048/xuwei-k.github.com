<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>util/net/liftweb/util/Mailer.scala</title>
        <script type="text/javascript" src="../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/*
 * Copyright 2006-2011 WorldWide Conferencing, LLC
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */</span>

<span class="keyword">package</span> net.liftweb
<span class="keyword">package</span> util

<span class="keyword">import</span> javax.mail._
<span class="keyword">import</span> javax.mail.internet._
<span class="keyword">import</span> javax.naming.<span class="delimiter">{</span>Context, InitialContext<span class="delimiter">}</span>
<span class="keyword">import</span> java.util.Properties
<span class="keyword">import</span> common._
<span class="keyword">import</span> actor._
<span class="keyword">import</span> xml.<span class="delimiter">{</span>Text, Elem, Node, NodeSeq<span class="delimiter">}</span>

<span class="comment">/**
 * Utilities for sending email.
 */</span>
<span class="keyword">object</span> <a title="object net.liftweb.util.Mailer" id="13493">Mailer</a> <span title="ScalaObject" class="keyword">extends</span> <a href="#13495" title="net.liftweb.util.Mailer">Mailer</a>

<span class="comment">/**
 * This trait implmenets the mail sending.  You can create subclasses of this class/trait and
 * implement your own mailer functionality
 */</span>
<span class="keyword">trait</span> <a title="trait Mailer extends java.lang.Object with net.liftweb.util.SimpleInjector with ScalaObject" id="13495">Mailer</a> <span title="ScalaObject" class="keyword">extends</span> <a href="Maker.scala.html#13505" title="net.liftweb.util.SimpleInjector">SimpleInjector</a> <span class="delimiter">{</span>
  <span class="keyword">private</span> <span class="keyword">val</span> <a title="net.liftweb.common.Logger" id="146670">logger</a> = <a href="../../../../common/net/liftweb/common/Logging.scala.html#31889" title="(cls: Class[_])net.liftweb.common.Logger">Logger</a><span class="delimiter">(</span>classOf<span title="java.lang.Class[net.liftweb.util.Mailer](classOf[net.liftweb.util.Mailer])" class="delimiter">[</span>Mailer<span class="delimiter">]</span><span class="delimiter">)</span>
  
  <span class="keyword">sealed</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <a title="class MailTypes extends java.lang.Object with ScalaObject" id="146672">MailTypes</a>
  <span class="comment">/**
   * Add message headers to outgoing messages
   */</span>
  <span class="keyword">final</span> case <span class="keyword">class</span> <a title="class MessageHeader extends Mailer.this.MailTypes with ScalaObject with Product with Serializable" id="306528">MessageHeader</a><a href="#306528" title="ScalaObject" class="delimiter">(</a><a title="String" id="310708">name</a>: <span title="String">String</span>, <a title="String" id="310709">value</a>: <span title="String">String</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#146672" title="Mailer.this.MailTypes">MailTypes</a>
  <span class="keyword">abstract</span> <span class="keyword">class</span> <a title="class MailBodyType extends Mailer.this.MailTypes with ScalaObject" id="146676">MailBodyType</a> <a href="#146676" title="ScalaObject" class="keyword">extends</a> <a href="#146672" title="Mailer.this.MailTypes">MailTypes</a>
  <span class="keyword">final</span> case <span class="keyword">class</span> <a title="class PlusImageHolder extends java.lang.Object with ScalaObject with Product with Serializable" id="306612">PlusImageHolder</a><a href="#306612" title="ScalaObject" class="delimiter">(</a><a title="String" id="310698">name</a>: <span title="String">String</span>, <a title="String" id="310699">mimeType</a>: <span title="String">String</span>, <a title="Array[Byte]" id="310700">bytes</a>: <span title="Array[Byte]">Array</span><span class="delimiter">[</span>Byte<span class="delimiter">]</span><span class="delimiter">)</span>

  <span class="comment">/**
   * Represents a text/plain mail body. The given text will
   * be encoded as UTF-8 when sent.
   */</span>
  <span class="keyword">final</span> case <span class="keyword">class</span> <a title="class PlainMailBodyType extends Mailer.this.MailBodyType with ScalaObject with Product with Serializable" id="306683">PlainMailBodyType</a><a href="#306683" title="ScalaObject" class="delimiter">(</a><a title="String" id="310692">text</a>: <span title="String">String</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#146676" title="Mailer.this.MailBodyType">MailBodyType</a>

  <span class="comment">/**
   * Represents a text/plain mail body that is encoded with the
   * specified charset
   */</span>
  <span class="keyword">final</span> case <span class="keyword">class</span> <a title="class PlainPlusBodyType extends Mailer.this.MailBodyType with ScalaObject with Product with Serializable" id="306745">PlainPlusBodyType</a><a href="#306745" title="ScalaObject" class="delimiter">(</a><a title="String" id="310684">text</a>: <span title="String">String</span>, <a title="String" id="310685">charset</a>: <span title="String">String</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#146676" title="Mailer.this.MailBodyType">MailBodyType</a>

  <span class="keyword">final</span> case <span class="keyword">class</span> <a title="class XHTMLMailBodyType extends Mailer.this.MailBodyType with ScalaObject with Product with Serializable" id="306808">XHTMLMailBodyType</a><a href="#306808" title="ScalaObject" class="delimiter">(</a><a title="scala.xml.NodeSeq" id="307282">text</a>: <span title="scala.xml.NodeSeq">NodeSeq</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#146676" title="Mailer.this.MailBodyType">MailBodyType</a>
  <span class="keyword">final</span> case <span class="keyword">class</span> <a title="class XHTMLPlusImages extends Mailer.this.MailBodyType with ScalaObject with Product with Serializable" id="306858">XHTMLPlusImages</a><a href="#306858" title="ScalaObject" class="delimiter">(</a><a title="scala.xml.NodeSeq" id="310673">text</a>: <span title="scala.xml.NodeSeq">NodeSeq</span>, <a title="Mailer.this.PlusImageHolder*" id="310674">items</a>: <span title="Mailer.this.PlusImageHolder*">PlusImageHolder</span>*<span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#146676" title="Mailer.this.MailBodyType">MailBodyType</a>

  <span class="keyword">sealed</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <a title="class RoutingType extends Mailer.this.MailTypes with ScalaObject" id="146692">RoutingType</a> <a href="#146692" title="ScalaObject" class="keyword">extends</a> <a href="#146672" title="Mailer.this.MailTypes">MailTypes</a>
  <span class="keyword">sealed</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <a title="class AddressType extends Mailer.this.RoutingType with ScalaObject" id="146693">AddressType</a> <a href="#146693" title="ScalaObject" class="keyword">extends</a> <a href="#146692" title="Mailer.this.RoutingType">RoutingType</a> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="=&gt; String" id="148939">address</a>: <span title="String">String</span>
    <span class="keyword">def</span> <a title="=&gt; net.liftweb.common.Box[String]" id="148940">name</a>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[String]">Box</a><span class="delimiter">[</span>String<span class="delimiter">]</span>
  <span class="delimiter">}</span>
  <span class="keyword">final</span> case <span class="keyword">class</span> <a title="class From extends Mailer.this.AddressType with ScalaObject with Product with Serializable" id="230523">From</a><a href="#230523" title="ScalaObject" class="delimiter">(</a><a title="String" id="230533">address</a>: <span title="String">String</span>, <a title="net.liftweb.common.Box[String]" id="230534">name</a>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[String]">Box</a><span class="delimiter">[</span>String<span class="delimiter">]</span> = <a href="../../../../common/net/liftweb/common/Box.scala.html#10581" title="object net.liftweb.common.Empty">Empty</a><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#146693" title="Mailer.this.AddressType">AddressType</a>
  <span class="keyword">final</span> case <span class="keyword">class</span> <a title="class To extends Mailer.this.AddressType with ScalaObject with Product with Serializable" id="230564">To</a><a href="#230564" title="ScalaObject" class="delimiter">(</a><a title="String" id="230574">address</a>: <span title="String">String</span>, <a title="net.liftweb.common.Box[String]" id="230575">name</a>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[String]">Box</a><span class="delimiter">[</span>String<span class="delimiter">]</span> = <a href="../../../../common/net/liftweb/common/Box.scala.html#10581" title="object net.liftweb.common.Empty">Empty</a><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#146693" title="Mailer.this.AddressType">AddressType</a>
  <span class="keyword">final</span> case <span class="keyword">class</span> <a title="class CC extends Mailer.this.AddressType with ScalaObject with Product with Serializable" id="307044">CC</a><a href="#307044" title="ScalaObject" class="delimiter">(</a><a title="String" id="310652">address</a>: <span title="String">String</span>, <a title="net.liftweb.common.Box[String]" id="310657">name</a>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[String]">Box</a><span class="delimiter">[</span>String<span class="delimiter">]</span> = <a href="../../../../common/net/liftweb/common/Box.scala.html#10581" title="object net.liftweb.common.Empty">Empty</a><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#146693" title="Mailer.this.AddressType">AddressType</a>
  <span class="keyword">final</span> case <span class="keyword">class</span> <a title="class Subject extends Mailer.this.RoutingType with ScalaObject with Product with Serializable" id="230550">Subject</a><a href="#230550" title="ScalaObject" class="delimiter">(</a><a title="String" id="230557">subject</a>: <span title="String">String</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#146692" title="Mailer.this.RoutingType">RoutingType</a>
  <span class="keyword">final</span> case <span class="keyword">class</span> <a title="class BCC extends Mailer.this.AddressType with ScalaObject with Product with Serializable" id="230614">BCC</a><a href="#230614" title="ScalaObject" class="delimiter">(</a><a title="String" id="230624">address</a>: <span title="String">String</span>, <a title="net.liftweb.common.Box[String]" id="230625">name</a>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[String]">Box</a><span class="delimiter">[</span>String<span class="delimiter">]</span> = <a href="../../../../common/net/liftweb/common/Box.scala.html#10581" title="object net.liftweb.common.Empty">Empty</a><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#146693" title="Mailer.this.AddressType">AddressType</a>
  <span class="keyword">final</span> case <span class="keyword">class</span> <a title="class ReplyTo extends Mailer.this.AddressType with ScalaObject with Product with Serializable" id="307223">ReplyTo</a><a href="#307223" title="ScalaObject" class="delimiter">(</a><a title="String" id="310631">address</a>: <span title="String">String</span>, <a title="net.liftweb.common.Box[String]" id="310636">name</a>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[String]">Box</a><span class="delimiter">[</span>String<span class="delimiter">]</span> = <a href="../../../../common/net/liftweb/common/Box.scala.html#10581" title="object net.liftweb.common.Empty">Empty</a><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#146693" title="Mailer.this.AddressType">AddressType</a>

  <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="implicit net.liftweb.util.Mailer.xmlToMailBodyType : (html: scala.xml.NodeSeq)Mailer.this.MailBodyType" id="146712">xmlToMailBodyType</a><span class="delimiter">(</span><a title="scala.xml.NodeSeq" id="148941">html</a>: <span title="scala.xml.NodeSeq">NodeSeq</span><span class="delimiter">)</span>: <a href="#146676" title="Mailer.this.MailBodyType">MailBodyType</a> = <a href="#306808" title="(text: scala.xml.NodeSeq)Mailer.this.XHTMLMailBodyType">XHTMLMailBodyType</a><span class="delimiter">(</span><a href="#148941" title="scala.xml.NodeSeq">html</a><span class="delimiter">)</span>

  <span class="keyword">final</span> case <span class="keyword">class</span> <a title="class MessageInfo extends java.lang.Object with ScalaObject with Product with Serializable" id="307326">MessageInfo</a><a href="#307326" title="ScalaObject" class="delimiter">(</a><a title="Mailer.this.From" id="310613">from</a>: <a href="#230523" title="Mailer.this.From">From</a>, <a title="Mailer.this.Subject" id="310614">subject</a>: <a href="#230550" title="Mailer.this.Subject">Subject</a>, <a title="List[Mailer.this.MailTypes]" id="310615">info</a>: <span title="List[Mailer.this.MailTypes]">List</span><span class="delimiter">[</span>MailTypes<span class="delimiter">]</span><span class="delimiter">)</span>

  <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="implicit net.liftweb.util.Mailer.addressToAddress : (in: Mailer.this.AddressType)javax.mail.Address" id="146716">addressToAddress</a><span class="delimiter">(</span><a title="Mailer.this.AddressType" id="148933">in</a>: <a href="#146693" title="Mailer.this.AddressType">AddressType</a><span class="delimiter">)</span>: <span title="javax.mail.Address">Address</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="javax.mail.internet.InternetAddress" id="307388">ret</a> = <span title="(x$1: java.lang.String)javax.mail.internet.InternetAddress" class="keyword">new</span> <span title="javax.mail.internet.InternetAddress">InternetAddress</span><span class="delimiter">(</span><a href="#148933" title="Mailer.this.AddressType">in</a>.<a href="#148939" title="=&gt; String">address</a><span class="delimiter">)</span>
    <a href="#148933" title="Mailer.this.AddressType">in</a>.<a href="#148940" title="=&gt; net.liftweb.common.Box[String]">name</a>.<a href="../../../../common/net/liftweb/common/Box.scala.html#27031" title="(f: String =&gt; Unit)Unit">foreach</a><span class="delimiter">{</span><a title="String" id="307449">n</a> =&gt; <a href="#307388" title="javax.mail.internet.InternetAddress">ret</a>.<span title="(x$1: java.lang.String)Unit">setPersonal</span><span class="delimiter">(</span><a href="#307449" title="String">n</a><span class="delimiter">)</span><span class="delimiter">}</span>
    <a href="#307388" title="javax.mail.internet.InternetAddress">ret</a>
  <span class="delimiter">}</span>

  <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="implicit net.liftweb.util.Mailer.adListToAdArray : (in: List[Mailer.this.AddressType])Array[javax.mail.Address]" id="146717">adListToAdArray</a><span class="delimiter">(</span><a title="List[Mailer.this.AddressType]" id="148662">in</a>: <span title="List[Mailer.this.AddressType]">List</span><span class="delimiter">[</span>AddressType<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="Array[javax.mail.Address]">Array</span><span class="delimiter">[</span>Address<span class="delimiter">]</span> = <a href="#148662" title="List[Mailer.this.AddressType]">in</a>.<span title="(f: Mailer.this.AddressType =&gt; javax.mail.Address)(implicit bf: scala.collection.generic.CanBuildFrom[List[Mailer.this.AddressType],javax.mail.Address,List[javax.mail.Address]])List[javax.mail.Address]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.List.Coll,javax.mail.Address,List[javax.mail.Address]]" class="delimiter">(</span><a href="#146716" title="implicit net.liftweb.util.Mailer.addressToAddress : (in: Mailer.this.AddressType)javax.mail.Address">addressToAddress</a><span class="delimiter">)</span>.<span title="(implicit evidence$1: ClassManifest[javax.mail.Address])Array[javax.mail.Address]">toArray</span>

  <span class="comment">/**
   * Passwords cannot be accessed via System.getProperty.  Instead, we
   * provide a means of explicitlysetting the authenticator.
   */</span>
  <span class="comment">//def authenticator = authenticatorFunc</span>
  <span class="keyword">var</span> <a title="net.liftweb.common.Box[javax.mail.Authenticator]" id="146719">authenticator</a>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[javax.mail.Authenticator]">Box</a><span class="delimiter">[</span>Authenticator<span class="delimiter">]</span> = <a href="../../../../common/net/liftweb/common/Box.scala.html#10581" title="object net.liftweb.common.Empty">Empty</a>

  <span class="comment">/**
   * Use the mailer resource in your container by specifying the JNDI name
   */</span>
  <span class="keyword">var</span> <a title="net.liftweb.common.Box[String]" id="146722">jndiName</a>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[String]">Box</a><span class="delimiter">[</span>String<span class="delimiter">]</span> = <a href="../../../../common/net/liftweb/common/Box.scala.html#10581" title="object net.liftweb.common.Empty">Empty</a>

  <span class="comment">/**
   * Custom properties for the JNDI session
   */</span>
  <span class="keyword">var</span> <a title="Map[String,String]" id="146725">customProperties</a>: <span title="Map[String,String]">Map</span><span class="delimiter">[</span>String, String<span class="delimiter">]</span> = <span title="(elems: (String, Nothing)*)scala.collection.immutable.Map[String,Nothing]">Map</span><span class="delimiter">(</span><span class="delimiter">)</span>

  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="net.liftweb.common.Box[javax.mail.Session]" id="146728">jndiSession</a>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[javax.mail.Session]">Box</a><span class="delimiter">[</span>Session<span class="delimiter">]</span> =
  <span class="keyword">for</span><span class="delimiter">{</span>
    <a title="String" id="307530">name</a> &lt;- <a href="../../../../common/net/liftweb/common/Box.scala.html#27023" title="(f: String =&gt; net.liftweb.common.Box[javax.mail.Session])net.liftweb.common.Box[javax.mail.Session]">jndiName</a>
    <a title="java.lang.Object" id="307675">contextObj</a> &lt;- <a href="Helpers.scala.html#13346" title="object net.liftweb.util.Helpers">Helpers</a>.<a href="ControlHelpers.scala.html#48608" title="(f: =&gt; java.lang.Object)net.liftweb.common.Box[java.lang.Object]">tryo</a><a href="../../../../common/net/liftweb/common/Box.scala.html#27023" title="(f: java.lang.Object =&gt; net.liftweb.common.Box[javax.mail.Session])net.liftweb.common.Box[javax.mail.Session]" class="delimiter">(</a><span title="()javax.naming.InitialContext" class="keyword">new</span> <span title="javax.naming.InitialContext">InitialContext</span><span class="delimiter">(</span><span class="delimiter">)</span>.<span title="(x$1: java.lang.String)java.lang.Object">lookup</span><span class="delimiter">(</span><span title="java.lang.String(&quot;java:comp/env&quot;)" class="string">&quot;java:comp/env&quot;</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <a title="javax.naming.Context" id="307692">context</a> &lt;- <a href="../../../../common/net/liftweb/common/Box.scala.html#10572" title="object net.liftweb.common.Box">Box</a>.<a href="../../../../common/net/liftweb/common/Box.scala.html#28644" title="[B](in: T forSome { type T })(implicit m: scala.reflect.Manifest[B])net.liftweb.common.Box[B]">asA</a><span title="(in: T forSome { type T })(implicit m: scala.reflect.Manifest[javax.naming.Context])net.liftweb.common.Box[javax.naming.Context]" class="delimiter">[</span><span title="javax.naming.Context">Context</span><span class="delimiter">]</span><a href="../../../../common/net/liftweb/common/Box.scala.html#27023" title="(f: javax.naming.Context =&gt; net.liftweb.common.Box[javax.mail.Session])net.liftweb.common.Box[javax.mail.Session]" class="delimiter">(</a><a href="#307675" title="java.lang.Object">contextObj</a><span class="delimiter">)</span>
    <a title="java.lang.Object" id="307740">sessionObj</a> &lt;- <a href="Helpers.scala.html#13346" title="object net.liftweb.util.Helpers">Helpers</a>.<a href="ControlHelpers.scala.html#48608" title="(f: =&gt; java.lang.Object)net.liftweb.common.Box[java.lang.Object]">tryo</a><a href="../../../../common/net/liftweb/common/Box.scala.html#27023" title="(f: java.lang.Object =&gt; net.liftweb.common.Box[javax.mail.Session])net.liftweb.common.Box[javax.mail.Session]" class="delimiter">(</a><a href="#307692" title="javax.naming.Context">context</a>.<span title="(x$1: java.lang.String)java.lang.Object">lookup</span><span class="delimiter">(</span><a href="#307530" title="String">name</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <a title="javax.mail.Session" id="307757">session</a> &lt;- <a href="../../../../common/net/liftweb/common/Box.scala.html#10572" title="object net.liftweb.common.Box">Box</a>.<a href="../../../../common/net/liftweb/common/Box.scala.html#28644" title="[B](in: T forSome { type T })(implicit m: scala.reflect.Manifest[B])net.liftweb.common.Box[B]">asA</a><span title="(in: T forSome { type T })(implicit m: scala.reflect.Manifest[javax.mail.Session])net.liftweb.common.Box[javax.mail.Session]" class="delimiter">[</span><span title="javax.mail.Session">Session</span><span class="delimiter">]</span><a href="../../../../common/net/liftweb/common/Box.scala.html#27020" title="(f: javax.mail.Session =&gt; javax.mail.Session)net.liftweb.common.Box[javax.mail.Session]" class="delimiter">(</a><a href="#307740" title="java.lang.Object">sessionObj</a><span class="delimiter">)</span>
  <span class="delimiter">}</span> <span class="keyword">yield</span> <a href="#307757" title="javax.mail.Session">session</a>

  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="java.util.Properties" id="146730">properties</a>: <span title="java.util.Properties">Properties</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="java.util.Properties" id="307763">p</a> = <span title="object java.lang.System">System</span>.<span title="()java.util.Properties">getProperties</span>.<span title="()java.lang.Object">clone</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="java.util.Properties" class="delimiter">[</span><span title="java.util.Properties">Properties</span><span class="delimiter">]</span>
    <a href="#146725" title="=&gt; Map[String,String]">customProperties</a>.<span title="(f: (String, String) =&gt; java.lang.Object)Unit">foreach</span> <a href="#307788" title="java.lang.Object" class="delimiter">{</a><span class="keyword">case</span> <span title="java.lang.Object" class="delimiter">(</span><a title="String" id="307791">name</a>, <a title="String" id="307792">value</a><span class="delimiter">)</span> =&gt; <a href="#307763" title="java.util.Properties">p</a>.<span title="(x$1: java.lang.Object, x$2: java.lang.Object)java.lang.Object">put</span><span class="delimiter">(</span><a href="#307791" title="String">name</a>, <a href="#307792" title="String">value</a><span class="delimiter">)</span><span class="delimiter">}</span>
    <span class="comment">// allow the properties file to set/override system properties</span>

    <a href="Props.scala.html#13579" title="object net.liftweb.util.Props">Props</a>.<a href="Props.scala.html#151343" title="=&gt; Map[String,String]">props</a>.<span title="(f: (String, String) =&gt; java.lang.Object)Unit">foreach</span> <a href="#307816" title="java.lang.Object" class="delimiter">{</a>
      <span class="keyword">case</span> <span title="java.lang.Object" class="delimiter">(</span><a title="String" id="307819">name</a>, <a title="String" id="307820">value</a><span class="delimiter">)</span> =&gt;
        <a href="#307763" title="java.util.Properties">p</a>.<span title="(x$1: java.lang.String, x$2: java.lang.String)java.lang.Object">setProperty</span><span class="delimiter">(</span><a href="#307819" title="String">name</a>, <a href="#307820" title="String">value</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
    <a href="#307763" title="java.util.Properties">p</a>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * The host that should be used to send mail.
   */</span>
  <span class="keyword">def</span> <a title="=&gt; String" id="146731">host</a> = <a href="#146733" title="()String">hostFunc</a><span class="delimiter">(</span><span class="delimiter">)</span>

  <span class="comment">/**
   * To change the way the host is calculated, set this to the function that calcualtes the host name.
   * By default: System.getProperty(&quot;mail.smtp.host&quot;)
   */</span>
  <span class="keyword">var</span> <a title="() =&gt; String" id="146733">hostFunc</a>: <span class="delimiter">(</span><span class="delimiter">)</span> =&gt; String = <a href="#146735" title="=&gt; java.lang.String">_host</a> _

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="=&gt; java.lang.String" id="146735">_host</a> = <a href="#146729" title="=&gt; java.util.Properties">properties</a>.<span title="(x$1: java.lang.String)java.lang.String">getProperty</span><span class="delimiter">(</span><span title="java.lang.String(&quot;mail.smtp.host&quot;)" class="string">&quot;mail.smtp.host&quot;</span><span class="delimiter">)</span> <span title="java.lang.String" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <span title="java.lang.String(&quot;localhost&quot;)" class="keyword">null</span> =&gt; <span title="java.lang.String(&quot;localhost&quot;)" class="string">&quot;localhost&quot;</span>
    <span class="keyword">case</span> <a title="java.lang.String" id="307830">s</a> =&gt; <a href="#307830" title="java.lang.String">s</a>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="=&gt; java.util.Properties" id="146736">buildProps</a>: <span title="java.util.Properties">Properties</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="java.util.Properties" id="307834">p</a> = <a href="#146729" title="=&gt; java.util.Properties">properties</a>.<span title="()java.lang.Object">clone</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="java.util.Properties" class="delimiter">[</span><span title="java.util.Properties">Properties</span><span class="delimiter">]</span>
    <a href="#307834" title="java.util.Properties">p</a>.<span title="(x$1: java.lang.String)java.lang.String">getProperty</span><span class="delimiter">(</span><span title="java.lang.String(&quot;mail.smtp.host&quot;)" class="string">&quot;mail.smtp.host&quot;</span><span class="delimiter">)</span> <span title="Any" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <span title="java.lang.Object" class="keyword">null</span> =&gt; <a href="#307834" title="java.util.Properties">p</a>.<span title="(x$1: java.lang.Object, x$2: java.lang.Object)java.lang.Object">put</span><span class="delimiter">(</span><span title="java.lang.String(&quot;mail.smtp.host&quot;)" class="string">&quot;mail.smtp.host&quot;</span>, <a href="#146731" title="=&gt; String">host</a><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="Unit">_</span> =&gt;
    <span class="delimiter">}</span>

    <a href="#307834" title="java.util.Properties">p</a>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Set the mail.charset property to something other than UTF-8 for non-UTF-8
   * mail.
   */</span>
  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="java.lang.String" id="146738">charSet</a> = <a href="#146729" title="=&gt; java.util.Properties">properties</a>.<span title="(x$1: java.lang.String)java.lang.String">getProperty</span><span class="delimiter">(</span><span title="java.lang.String(&quot;mail.charset&quot;)" class="string">&quot;mail.charset&quot;</span><span class="delimiter">)</span> <span title="java.lang.String" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <span title="java.lang.String(&quot;UTF-8&quot;)" class="keyword">null</span> =&gt; <span title="java.lang.String(&quot;UTF-8&quot;)" class="string">&quot;UTF-8&quot;</span>
    <span class="keyword">case</span> <a title="java.lang.String" id="306070">x</a> =&gt; <a href="#306070" title="java.lang.String">x</a>
  <span class="delimiter">}</span>

  <span class="comment">// def host_=(hostname: String) = System.setProperty(&quot;mail.smtp.host&quot;, hostname)</span>

  <span class="keyword">protected</span> <span class="keyword">class</span> <a title="class MsgSender extends java.lang.Object with net.liftweb.actor.SpecializedLiftActor[Mailer.this.MessageInfo] with ScalaObject" id="146739">MsgSender</a> <a href="#146739" title="ScalaObject" class="keyword">extends</a> <a href="../../../../actor/net/liftweb/actor/LiftActor.scala.html#10551" title="net.liftweb.actor.SpecializedLiftActor[Mailer.this.MessageInfo]">SpecializedLiftActor</a><span class="delimiter">[</span>MessageInfo<span class="delimiter">]</span> <span class="delimiter">{</span>
    <span class="keyword">protected</span> <span class="keyword">def</span> <a title="=&gt; PartialFunction[Mailer.this.MessageInfo,Unit]" id="306494">messageHandler</a> = <a href="#307856" title="Unit" class="delimiter">{</a>
      <span class="keyword">case</span> <span title="Unit">MessageInfo</span><span class="delimiter">(</span><a title="Mailer.this.From" id="307857">from</a>, <a title="Mailer.this.Subject" id="307858">subject</a>, <a title="List[Mailer.this.MailTypes]" id="307859">info</a><span class="delimiter">)</span> =&gt;
        <span class="keyword">try</span> <span class="delimiter">{</span>
          <a href="#146754" title="(from: Mailer.this.From, subject: Mailer.this.Subject, info: List[Mailer.this.MailTypes])Unit">msgSendImpl</a><span class="delimiter">(</span><a href="#307857" title="Mailer.this.From">from</a>, <a href="#307858" title="Mailer.this.Subject">subject</a>, <a href="#307859" title="List[Mailer.this.MailTypes]">info</a><span class="delimiter">)</span>
        <span class="delimiter">}</span> <span class="keyword">catch</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> <a title="Unit" id="307864">e</a>: <span title="Exception">Exception</span> =&gt; <a href="#146670" title="=&gt; net.liftweb.common.Logger">logger</a>.<a href="../../../../common/net/liftweb/common/Logging.scala.html#31961" title="(msg: =&gt; AnyRef, t: Throwable)Unit">error</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Couldn\'t send mail&quot;)" class="string">&quot;Couldn't send mail&quot;</span>, <a href="#307864" title="Exception">e</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="(msg: javax.mail.internet.MimeMessage)Unit" id="146740">performTransportSend</a><span class="delimiter">(</span><a title="javax.mail.internet.MimeMessage" id="307872">msg</a>: <span title="javax.mail.internet.MimeMessage">MimeMessage</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span class="keyword">import</span> <a href="Props.scala.html#13579" title="object net.liftweb.util.Props">Props</a>.<a href="Props.scala.html#151308" title="object net.liftweb.util.Props.RunModes">RunModes</a>._
    <span class="delimiter">(</span><a href="Props.scala.html#13579" title="object net.liftweb.util.Props">Props</a>.<a href="Props.scala.html#151315" title="=&gt; net.liftweb.util.Props.RunModes.Value">mode</a> <span title="javax.mail.internet.MimeMessage =&gt; Unit" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <a href="Props.scala.html#151346" title="javax.mail.internet.MimeMessage =&gt; Unit">Development</a> =&gt; <a href="#146741" title="=&gt; Mailer.this.Inject[javax.mail.internet.MimeMessage =&gt; Unit]">devModeSend</a>.<a href="Maker.scala.html#150929" title="=&gt; javax.mail.internet.MimeMessage =&gt; Unit">vend</a>
        <span class="keyword">case</span> <a href="Props.scala.html#151348" title="javax.mail.internet.MimeMessage =&gt; Unit">Test</a> =&gt; <a href="#146743" title="=&gt; Mailer.this.Inject[javax.mail.internet.MimeMessage =&gt; Unit]">testModeSend</a>.<a href="Maker.scala.html#150929" title="=&gt; javax.mail.internet.MimeMessage =&gt; Unit">vend</a>
        <span class="keyword">case</span> <a href="Props.scala.html#151350" title="javax.mail.internet.MimeMessage =&gt; Unit">Staging</a> =&gt; <a href="#146745" title="=&gt; Mailer.this.Inject[javax.mail.internet.MimeMessage =&gt; Unit]">stagingModeSend</a>.<a href="Maker.scala.html#150929" title="=&gt; javax.mail.internet.MimeMessage =&gt; Unit">vend</a>
        <span class="keyword">case</span> <a href="Props.scala.html#151352" title="javax.mail.internet.MimeMessage =&gt; Unit">Production</a> =&gt; <a href="#146747" title="=&gt; Mailer.this.Inject[javax.mail.internet.MimeMessage =&gt; Unit]">productionModeSend</a>.<a href="Maker.scala.html#150929" title="=&gt; javax.mail.internet.MimeMessage =&gt; Unit">vend</a>
        <span class="keyword">case</span> <a href="Props.scala.html#151354" title="javax.mail.internet.MimeMessage =&gt; Unit">Pilot</a> =&gt; <a href="#146749" title="=&gt; Mailer.this.Inject[javax.mail.internet.MimeMessage =&gt; Unit]">pilotModeSend</a>.<a href="Maker.scala.html#150929" title="=&gt; javax.mail.internet.MimeMessage =&gt; Unit">vend</a>
        <span class="keyword">case</span> <a href="Props.scala.html#151356" title="javax.mail.internet.MimeMessage =&gt; Unit">Profile</a> =&gt; <a href="#146751" title="=&gt; Mailer.this.Inject[javax.mail.internet.MimeMessage =&gt; Unit]">profileModeSend</a>.<a href="Maker.scala.html#150929" title="=&gt; javax.mail.internet.MimeMessage =&gt; Unit">vend</a>
      <span class="delimiter">}</span><span class="delimiter">)</span>.<span title="(v1: javax.mail.internet.MimeMessage)Unit">apply</span><span class="delimiter">(</span><a href="#307872" title="javax.mail.internet.MimeMessage">msg</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * How to send a message in dev mode.  By default, use Transport.send(msg)
   */</span>
  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="Mailer.this.Inject[javax.mail.internet.MimeMessage =&gt; Unit]" id="146742">devModeSend</a>: <a href="Maker.scala.html#146667" title="Mailer.this.Inject[javax.mail.internet.MimeMessage =&gt; Unit]">Inject</a><span class="delimiter">[</span>MimeMessage =&gt; Unit<span class="delimiter">]</span> = <a href="#307877" title="Mailer.this.Inject[javax.mail.internet.MimeMessage =&gt; Unit]" class="keyword">new</a> <a title="anonymous class $anon extends Mailer.this.Inject[javax.mail.internet.MimeMessage =&gt; Unit]" id="307877">Inject</a><span class="delimiter">[</span>MimeMessage =&gt; Unit<span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">(</span>m: <span title="javax.mail.internet.MimeMessage">MimeMessage</span><span class="delimiter">)</span> =&gt; <span title="object javax.mail.Transport">Transport</span>.<span title="(x$1: javax.mail.Message)Unit">send</span><span class="delimiter">(</span><a href="#307889" title="javax.mail.internet.MimeMessage">m</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span><span class="delimiter">}</span>

  <span class="comment">/**
   * How to send a message in test mode.  By default, log the message
   */</span>
  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="Mailer.this.Inject[javax.mail.internet.MimeMessage =&gt; Unit]" id="146744">testModeSend</a>: <a href="Maker.scala.html#146667" title="Mailer.this.Inject[javax.mail.internet.MimeMessage =&gt; Unit]">Inject</a><span class="delimiter">[</span>MimeMessage =&gt; Unit<span class="delimiter">]</span> = <a href="#308075" title="Mailer.this.Inject[javax.mail.internet.MimeMessage =&gt; Unit]" class="keyword">new</a> <a title="anonymous class $anon extends Mailer.this.Inject[javax.mail.internet.MimeMessage =&gt; Unit]" id="308075">Inject</a><span class="delimiter">[</span>MimeMessage =&gt; Unit<span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">(</span>m: <span title="javax.mail.internet.MimeMessage">MimeMessage</span><span class="delimiter">)</span> =&gt; <a href="#146670" title="=&gt; net.liftweb.common.Logger">logger</a>.<a href="../../../../common/net/liftweb/common/Logging.scala.html#31948" title="(msg: =&gt; AnyRef)Unit">info</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Sending Mime Message: &quot;)" class="string">&quot;Sending Mime Message: &quot;</span><span title="(x$1: Any)java.lang.String">+</span><a href="#308085" title="javax.mail.internet.MimeMessage">m</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span><span class="delimiter">}</span>

  <span class="comment">/**
   * How to send a message in staging mode.  By default, use Transport.send(msg)
   */</span>
  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="Mailer.this.Inject[javax.mail.internet.MimeMessage =&gt; Unit]" id="146746">stagingModeSend</a>: <a href="Maker.scala.html#146667" title="Mailer.this.Inject[javax.mail.internet.MimeMessage =&gt; Unit]">Inject</a><span class="delimiter">[</span>MimeMessage =&gt; Unit<span class="delimiter">]</span> = <a href="#308121" title="Mailer.this.Inject[javax.mail.internet.MimeMessage =&gt; Unit]" class="keyword">new</a> <a title="anonymous class $anon extends Mailer.this.Inject[javax.mail.internet.MimeMessage =&gt; Unit]" id="308121">Inject</a><span class="delimiter">[</span>MimeMessage =&gt; Unit<span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">(</span>m: <span title="javax.mail.internet.MimeMessage">MimeMessage</span><span class="delimiter">)</span> =&gt; <span title="object javax.mail.Transport">Transport</span>.<span title="(x$1: javax.mail.Message)Unit">send</span><span class="delimiter">(</span><a href="#308131" title="javax.mail.internet.MimeMessage">m</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span><span class="delimiter">}</span>

  <span class="comment">/**
   * How to send a message in production mode.  By default, use Transport.send(msg)
   */</span>
  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="Mailer.this.Inject[javax.mail.internet.MimeMessage =&gt; Unit]" id="146748">productionModeSend</a>: <a href="Maker.scala.html#146667" title="Mailer.this.Inject[javax.mail.internet.MimeMessage =&gt; Unit]">Inject</a><span class="delimiter">[</span>MimeMessage =&gt; Unit<span class="delimiter">]</span> = <a href="#308167" title="Mailer.this.Inject[javax.mail.internet.MimeMessage =&gt; Unit]" class="keyword">new</a> <a title="anonymous class $anon extends Mailer.this.Inject[javax.mail.internet.MimeMessage =&gt; Unit]" id="308167">Inject</a><span class="delimiter">[</span>MimeMessage =&gt; Unit<span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">(</span>m: <span title="javax.mail.internet.MimeMessage">MimeMessage</span><span class="delimiter">)</span> =&gt; <span title="object javax.mail.Transport">Transport</span>.<span title="(x$1: javax.mail.Message)Unit">send</span><span class="delimiter">(</span><a href="#308177" title="javax.mail.internet.MimeMessage">m</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span><span class="delimiter">}</span>

  <span class="comment">/**
   * How to send a message in pilot mode.  By default, use Transport.send(msg)
   */</span>
  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="Mailer.this.Inject[javax.mail.internet.MimeMessage =&gt; Unit]" id="146750">pilotModeSend</a>: <a href="Maker.scala.html#146667" title="Mailer.this.Inject[javax.mail.internet.MimeMessage =&gt; Unit]">Inject</a><span class="delimiter">[</span>MimeMessage =&gt; Unit<span class="delimiter">]</span> = <a href="#308213" title="Mailer.this.Inject[javax.mail.internet.MimeMessage =&gt; Unit]" class="keyword">new</a> <a title="anonymous class $anon extends Mailer.this.Inject[javax.mail.internet.MimeMessage =&gt; Unit]" id="308213">Inject</a><span class="delimiter">[</span>MimeMessage =&gt; Unit<span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">(</span>m: <span title="javax.mail.internet.MimeMessage">MimeMessage</span><span class="delimiter">)</span> =&gt; <span title="object javax.mail.Transport">Transport</span>.<span title="(x$1: javax.mail.Message)Unit">send</span><span class="delimiter">(</span><a href="#308223" title="javax.mail.internet.MimeMessage">m</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span><span class="delimiter">}</span>

  <span class="comment">/**
   * How to send a message in profile mode.  By default, use Transport.send(msg)
   */</span>
  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="Mailer.this.Inject[javax.mail.internet.MimeMessage =&gt; Unit]" id="146752">profileModeSend</a>: <a href="Maker.scala.html#146667" title="Mailer.this.Inject[javax.mail.internet.MimeMessage =&gt; Unit]">Inject</a><span class="delimiter">[</span>MimeMessage =&gt; Unit<span class="delimiter">]</span> = <a href="#308259" title="Mailer.this.Inject[javax.mail.internet.MimeMessage =&gt; Unit]" class="keyword">new</a> <a title="anonymous class $anon extends Mailer.this.Inject[javax.mail.internet.MimeMessage =&gt; Unit]" id="308259">Inject</a><span class="delimiter">[</span>MimeMessage =&gt; Unit<span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">(</span>m: <span title="javax.mail.internet.MimeMessage">MimeMessage</span><span class="delimiter">)</span> =&gt; <span title="object javax.mail.Transport">Transport</span>.<span title="(x$1: javax.mail.Message)Unit">send</span><span class="delimiter">(</span><a href="#308269" title="javax.mail.internet.MimeMessage">m</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span><span class="delimiter">}</span>

  <span class="comment">/**
   * Synchronously send an email.
   */</span>
  <span class="keyword">def</span> <a title="(from: Mailer.this.From, subject: Mailer.this.Subject, rest: Mailer.this.MailTypes*)Unit" id="146753">blockingSendMail</a><span class="delimiter">(</span><a title="Mailer.this.From" id="308305">from</a>: <a href="#230523" title="Mailer.this.From">From</a>, <a title="Mailer.this.Subject" id="308306">subject</a>: <a href="#230550" title="Mailer.this.Subject">Subject</a>, <a title="Mailer.this.MailTypes*" id="308307">rest</a>: <span title="Mailer.this.MailTypes*">MailTypes</span>*<span class="delimiter">)</span> <span class="delimiter">{</span>
    <a href="#146754" title="(from: Mailer.this.From, subject: Mailer.this.Subject, info: List[Mailer.this.MailTypes])Unit">msgSendImpl</a><span class="delimiter">(</span><a href="#308305" title="Mailer.this.From">from</a>, <a href="#308306" title="Mailer.this.Subject">subject</a>, <a href="#308307" title="Mailer.this.MailTypes*">rest</a>.<span title="=&gt; List[Mailer.this.MailTypes]">toList</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>
  
  <span class="keyword">def</span> <a title="(from: Mailer.this.From, subject: Mailer.this.Subject, info: List[Mailer.this.MailTypes])Unit" id="146754">msgSendImpl</a><span class="delimiter">(</span><a title="Mailer.this.From" id="307860">from</a>: <a href="#230523" title="Mailer.this.From">From</a>, <a title="Mailer.this.Subject" id="307861">subject</a>: <a href="#230550" title="Mailer.this.Subject">Subject</a>, <a title="List[Mailer.this.MailTypes]" id="307862">info</a>: <span title="List[Mailer.this.MailTypes]">List</span><span class="delimiter">[</span>MailTypes<span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="javax.mail.Session" id="308309">session</a> = <a href="#146719" title="=&gt; net.liftweb.common.Box[javax.mail.Authenticator]">authenticator</a> <span title="javax.mail.Session" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <span title="javax.mail.Session">Full</span><span class="delimiter">(</span><a title="javax.mail.Authenticator" id="308313">a</a><span class="delimiter">)</span> =&gt; <a href="#146727" title="=&gt; net.liftweb.common.Box[javax.mail.Session]">jndiSession</a> <a href="../../../../common/net/liftweb/common/Box.scala.html#27017" title="(default: =&gt; javax.mail.Session)javax.mail.Session">openOr</a> <span title="object javax.mail.Session">Session</span>.<span title="(x$1: java.util.Properties, x$2: javax.mail.Authenticator)javax.mail.Session">getInstance</span><span class="delimiter">(</span><a href="#146736" title="=&gt; java.util.Properties">buildProps</a>, <a href="#308313" title="javax.mail.Authenticator">a</a><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="javax.mail.Session">_</span> =&gt; <a href="#146727" title="=&gt; net.liftweb.common.Box[javax.mail.Session]">jndiSession</a> <a href="../../../../common/net/liftweb/common/Box.scala.html#27017" title="(default: =&gt; javax.mail.Session)javax.mail.Session">openOr</a> <span title="object javax.mail.Session">Session</span>.<span title="(x$1: java.util.Properties)javax.mail.Session">getInstance</span><span class="delimiter">(</span><a href="#146736" title="=&gt; java.util.Properties">buildProps</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="keyword">val</span> <a title="javax.mail.internet.MimeMessage" id="308310">message</a> = <span title="javax.mail.internet.MimeMessage" class="keyword">new</span> <span title="javax.mail.internet.MimeMessage">MimeMessage</span><span class="delimiter">(</span><a href="#308309" title="javax.mail.Session">session</a><span class="delimiter">)</span>
    <a href="#308310" title="javax.mail.internet.MimeMessage">message</a>.<span title="(x$1: javax.mail.Address)Unit">setFrom</span><span class="delimiter">(</span><a href="#146716" title="implicit net.liftweb.util.Mailer.addressToAddress : (in: Mailer.this.AddressType)javax.mail.Address">from</a><span class="delimiter">)</span>
    <a href="#308310" title="javax.mail.internet.MimeMessage">message</a>.<span title="(x$1: javax.mail.Message.RecipientType, x$2: Array[javax.mail.Address])Unit">setRecipients</span><span class="delimiter">(</span><span title="object javax.mail.Message">Message</span>.<span title="object javax.mail.Message.RecipientType">RecipientType</span>.<span title="javax.mail.Message.RecipientType">TO</span>, <a href="#307862" title="List[Mailer.this.MailTypes]">info</a>.<span title="(f: Mailer.this.MailTypes =&gt; scala.collection.GenTraversableOnce[Mailer.this.To])(implicit bf: scala.collection.generic.CanBuildFrom[List[Mailer.this.MailTypes],Mailer.this.To,List[Mailer.this.To]])List[Mailer.this.To]">flatMap</span> <a href="#146717" title="implicit net.liftweb.util.Mailer.adListToAdArray : (in: List[Mailer.this.AddressType])Array[javax.mail.Address]" class="delimiter">{</a><span class="keyword">case</span> <a title="Iterable[Mailer.this.To]" id="308362">x</a>: <a href="#230564" title="Mailer.this.To">To</a> =&gt; <span title="[A](x: A)Some[A]">Some</span><span title="(x: Mailer.this.To)Some[Mailer.this.To]" class="delimiter">[</span><a href="#230564" title="Mailer.this.To">To</a><span class="delimiter">]</span><span title="(xo: Option[Mailer.this.To])Iterable[Mailer.this.To]" class="delimiter">(</span><a href="#308362" title="Mailer.this.To">x</a><span class="delimiter">)</span> <span class="keyword">case</span> <span title="Iterable[Nothing]">_</span> =&gt; <span title="(xo: Option[Nothing])Iterable[Nothing]">None</span><span class="delimiter">}</span><span class="delimiter">)</span>
    <a href="#308310" title="javax.mail.internet.MimeMessage">message</a>.<span title="(x$1: javax.mail.Message.RecipientType, x$2: Array[javax.mail.Address])Unit">setRecipients</span><span class="delimiter">(</span><span title="object javax.mail.Message">Message</span>.<span title="object javax.mail.Message.RecipientType">RecipientType</span>.<span title="javax.mail.Message.RecipientType">CC</span>, <a href="#307862" title="List[Mailer.this.MailTypes]">info</a>.<span title="(f: Mailer.this.MailTypes =&gt; scala.collection.GenTraversableOnce[Mailer.this.CC])(implicit bf: scala.collection.generic.CanBuildFrom[List[Mailer.this.MailTypes],Mailer.this.CC,List[Mailer.this.CC]])List[Mailer.this.CC]">flatMap</span> <a href="#146717" title="implicit net.liftweb.util.Mailer.adListToAdArray : (in: List[Mailer.this.AddressType])Array[javax.mail.Address]" class="delimiter">{</a><span class="keyword">case</span> <a title="Iterable[Mailer.this.CC]" id="308508">x</a>: <a href="#307044" title="Mailer.this.CC">CC</a> =&gt; <span title="[A](x: A)Some[A]">Some</span><span title="(x: Mailer.this.CC)Some[Mailer.this.CC]" class="delimiter">[</span><a href="#307044" title="Mailer.this.CC">CC</a><span class="delimiter">]</span><span title="(xo: Option[Mailer.this.CC])Iterable[Mailer.this.CC]" class="delimiter">(</span><a href="#308508" title="Mailer.this.CC">x</a><span class="delimiter">)</span> <span class="keyword">case</span> <span title="Iterable[Nothing]">_</span> =&gt; <span title="(xo: Option[Nothing])Iterable[Nothing]">None</span><span class="delimiter">}</span><span class="delimiter">)</span>
    <a href="#308310" title="javax.mail.internet.MimeMessage">message</a>.<span title="(x$1: javax.mail.Message.RecipientType, x$2: Array[javax.mail.Address])Unit">setRecipients</span><span class="delimiter">(</span><span title="object javax.mail.Message">Message</span>.<span title="object javax.mail.Message.RecipientType">RecipientType</span>.<span title="javax.mail.Message.RecipientType">BCC</span>, <a href="#307862" title="List[Mailer.this.MailTypes]">info</a>.<span title="(f: Mailer.this.MailTypes =&gt; scala.collection.GenTraversableOnce[Mailer.this.BCC])(implicit bf: scala.collection.generic.CanBuildFrom[List[Mailer.this.MailTypes],Mailer.this.BCC,List[Mailer.this.BCC]])List[Mailer.this.BCC]">flatMap</span> <a href="#146717" title="implicit net.liftweb.util.Mailer.adListToAdArray : (in: List[Mailer.this.AddressType])Array[javax.mail.Address]" class="delimiter">{</a><span class="keyword">case</span> <a title="Iterable[Mailer.this.BCC]" id="308654">x</a>: <a href="#230614" title="Mailer.this.BCC">BCC</a> =&gt; <span title="[A](x: A)Some[A]">Some</span><span title="(x: Mailer.this.BCC)Some[Mailer.this.BCC]" class="delimiter">[</span><a href="#230614" title="Mailer.this.BCC">BCC</a><span class="delimiter">]</span><span title="(xo: Option[Mailer.this.BCC])Iterable[Mailer.this.BCC]" class="delimiter">(</span><a href="#308654" title="Mailer.this.BCC">x</a><span class="delimiter">)</span> <span class="keyword">case</span> <span title="Iterable[Nothing]">_</span> =&gt; <span title="(xo: Option[Nothing])Iterable[Nothing]">None</span><span class="delimiter">}</span><span class="delimiter">)</span>
    <span class="comment">// message.setReplyTo(filter[MailTypes, ReplyTo](info, {case x @ ReplyTo(_) =&gt; Some(x); case _ =&gt; None}))</span>
    <a href="#308310" title="javax.mail.internet.MimeMessage">message</a>.<span title="(x$1: Array[javax.mail.Address])Unit">setReplyTo</span><span class="delimiter">(</span><a href="#307862" title="List[Mailer.this.MailTypes]">info</a>.<span title="(f: Mailer.this.MailTypes =&gt; scala.collection.GenTraversableOnce[Mailer.this.ReplyTo])(implicit bf: scala.collection.generic.CanBuildFrom[List[Mailer.this.MailTypes],Mailer.this.ReplyTo,List[Mailer.this.ReplyTo]])List[Mailer.this.ReplyTo]">flatMap</span> <a href="#146717" title="implicit net.liftweb.util.Mailer.adListToAdArray : (in: List[Mailer.this.AddressType])Array[javax.mail.Address]" class="delimiter">{</a><span class="keyword">case</span> <a title="Iterable[Mailer.this.ReplyTo]" id="308934">x</a>: <a href="#307223" title="Mailer.this.ReplyTo">ReplyTo</a> =&gt; <span title="[A](x: A)Some[A]">Some</span><span title="(x: Mailer.this.ReplyTo)Some[Mailer.this.ReplyTo]" class="delimiter">[</span><a href="#307223" title="Mailer.this.ReplyTo">ReplyTo</a><span class="delimiter">]</span><span title="(xo: Option[Mailer.this.ReplyTo])Iterable[Mailer.this.ReplyTo]" class="delimiter">(</span><a href="#308934" title="Mailer.this.ReplyTo">x</a><span class="delimiter">)</span> <span class="keyword">case</span> <span title="Iterable[Nothing]">_</span> =&gt; <span title="(xo: Option[Nothing])Iterable[Nothing]">None</span><span class="delimiter">}</span><span class="delimiter">)</span>
    <a href="#308310" title="javax.mail.internet.MimeMessage">message</a>.<span title="(x$1: java.lang.String)Unit">setSubject</span><span class="delimiter">(</span><a href="#307861" title="Mailer.this.Subject">subject</a>.<a href="#230557" title="=&gt; String">subject</a><span class="delimiter">)</span>
    <a href="#307862" title="List[Mailer.this.MailTypes]">info</a>.<span title="(f: Mailer.this.MailTypes =&gt; Unit)Unit">foreach</span> <a href="#309078" title="Unit" class="delimiter">{</a>
      <span class="keyword">case</span> <span title="Unit">MessageHeader</span><span class="delimiter">(</span><a title="String" id="309079">name</a>, <a title="String" id="309080">value</a><span class="delimiter">)</span> =&gt; <a href="#308310" title="javax.mail.internet.MimeMessage">message</a>.<span title="(x$1: java.lang.String, x$2: java.lang.String)Unit">addHeader</span><span class="delimiter">(</span><a href="#309079" title="String">name</a>, <a href="#309080" title="String">value</a><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="Unit">_</span> =&gt; 
    <span class="delimiter">}</span>

    <span class="keyword">val</span> <a title="List[Mailer.this.MailBodyType]" id="308311">bodyTypes</a> = <a href="#307862" title="List[Mailer.this.MailTypes]">info</a>.<span title="(f: Mailer.this.MailTypes =&gt; scala.collection.GenTraversableOnce[Mailer.this.MailBodyType])(implicit bf: scala.collection.generic.CanBuildFrom[List[Mailer.this.MailTypes],Mailer.this.MailBodyType,List[Mailer.this.MailBodyType]])List[Mailer.this.MailBodyType]">flatMap</span> <a href="#309092" title="Iterable[Mailer.this.MailBodyType]" class="delimiter">{</a><span class="keyword">case</span> <a title="Iterable[Mailer.this.MailBodyType]" id="309093">x</a>: <a href="#146676" title="Mailer.this.MailBodyType">MailBodyType</a> =&gt; <span title="[A](x: A)Some[A]">Some</span><span title="(x: Mailer.this.MailBodyType)Some[Mailer.this.MailBodyType]" class="delimiter">[</span><a href="#146676" title="Mailer.this.MailBodyType">MailBodyType</a><span class="delimiter">]</span><span title="(xo: Option[Mailer.this.MailBodyType])Iterable[Mailer.this.MailBodyType]" class="delimiter">(</span><a href="#309093" title="Mailer.this.MailBodyType">x</a><span class="delimiter">)</span>; <span class="keyword">case</span> <span title="Iterable[Nothing]">_</span> =&gt; <span title="(xo: Option[Nothing])Iterable[Nothing]">None</span><span class="delimiter">}</span>
    <a href="#308311" title="List[Mailer.this.MailBodyType]">bodyTypes</a> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <span title="Unit">PlainMailBodyType</span><span class="delimiter">(</span><a title="String" id="309228">txt</a><span class="delimiter">)</span> :: <span title="object Nil">Nil</span> =&gt;
        <a href="#308310" title="javax.mail.internet.MimeMessage">message</a>.<span title="(x$1: java.lang.String)Unit">setText</span><span class="delimiter">(</span><a href="#309228" title="String">txt</a><span class="delimiter">)</span>

      <span class="keyword">case</span> <span title="Unit">_</span> =&gt;
        <span class="keyword">val</span> <a title="javax.mail.internet.MimeMultipart" id="309231">multiPart</a> = <span title="(x$1: java.lang.String)javax.mail.internet.MimeMultipart" class="keyword">new</span> <span title="javax.mail.internet.MimeMultipart">MimeMultipart</span><span class="delimiter">(</span><span title="java.lang.String(&quot;alternative&quot;)" class="string">&quot;alternative&quot;</span><span class="delimiter">)</span>
        <a href="#308311" title="List[Mailer.this.MailBodyType]">bodyTypes</a>.<span title="(f: Mailer.this.MailBodyType =&gt; Unit)Unit">foreach</span> <span class="delimiter">{</span>
          <a title="Mailer.this.MailBodyType" id="309322">tab</a> =&gt;
          <span class="keyword">val</span> <a title="javax.mail.BodyPart" id="309323">bp</a> = <a href="#146759" title="(tab: Mailer.this.MailBodyType)javax.mail.BodyPart">buildMailBody</a><span class="delimiter">(</span><a href="#309322" title="Mailer.this.MailBodyType">tab</a><span class="delimiter">)</span>
          <a href="#309231" title="javax.mail.internet.MimeMultipart">multiPart</a>.<span title="(x$1: javax.mail.BodyPart)Unit">addBodyPart</span><span class="delimiter">(</span><a href="#309323" title="javax.mail.BodyPart">bp</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
        <a href="#308310" title="javax.mail.internet.MimeMessage">message</a>.<span title="(x$1: javax.mail.Multipart)Unit">setContent</span><span class="delimiter">(</span><a href="#309231" title="javax.mail.internet.MimeMultipart">multiPart</a><span class="delimiter">)</span>;
    <span class="delimiter">}</span>

    <a href="#13495" title="Mailer.this.type">Mailer</a>.<span class="keyword">this</span>.<a href="#146740" title="(msg: javax.mail.internet.MimeMessage)Unit">performTransportSend</a><span class="delimiter">(</span><a href="#308310" title="javax.mail.internet.MimeMessage">message</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">protected</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="Mailer.this.MsgSender" id="146756">msgSender</a> = <span title="Mailer.this.MsgSender" class="keyword">new</span> <a href="#146739" title="Mailer.this.MsgSender">MsgSender</a>

  <span class="comment">/**
   * The default mechanism for encoding a NodeSeq to a String representing HTML.  By default, use Html5.toString(node)
   */</span>
  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="(in: scala.xml.NodeSeq)String" id="146757">encodeHtmlBodyPart</a><span class="delimiter">(</span><a title="scala.xml.NodeSeq" id="309336">in</a>: <span title="scala.xml.NodeSeq">NodeSeq</span><span class="delimiter">)</span>: <span title="String">String</span> = <a href="HtmlParser.scala.html#13361" title="object net.liftweb.util.Html5">Html5</a>.<a href="HtmlParser.scala.html#294837" title="(x: scala.xml.Node)String">toString</a><span class="delimiter">(</span><a href="#146758" title="(in: scala.xml.NodeSeq)scala.xml.Node">firstNode</a><span class="delimiter">(</span><a href="#309336" title="scala.xml.NodeSeq">in</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="(in: scala.xml.NodeSeq)scala.xml.Node" id="146758">firstNode</a><span class="delimiter">(</span><a title="scala.xml.NodeSeq" id="309340">in</a>: <span title="scala.xml.NodeSeq">NodeSeq</span><span class="delimiter">)</span>: <span title="scala.xml.Node">Node</span> = <a href="#309340" title="scala.xml.NodeSeq">in</a> <span title="scala.xml.Node" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <a title="scala.xml.Node" id="309342">n</a>: <span title="scala.xml.Node">Node</span> =&gt; <a href="#309342" title="scala.xml.Node">n</a>
    <span class="keyword">case</span> <a title="scala.xml.Node" id="309343">ns</a> =&gt; <a href="#309343" title="scala.xml.NodeSeq">ns</a>.<span title="=&gt; List[scala.xml.Node]">toList</span>.<span title="(pf: PartialFunction[scala.xml.Node,scala.xml.Elem])(implicit bf: scala.collection.generic.CanBuildFrom[List[scala.xml.Node],scala.xml.Elem,List[scala.xml.Elem]])List[scala.xml.Elem]">collect</span> <a href="#309359" title="scala.xml.Elem" class="delimiter">{</a>
      <span class="keyword">case</span> <a title="scala.xml.Elem" id="309360">e</a>: <span title="scala.xml.Elem">Elem</span> =&gt; <a href="#309360" title="scala.xml.Elem">e</a>
    <span class="delimiter">}</span> <span title="scala.xml.Node" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <span title="scala.xml.Node">Nil</span> =&gt; <span title="scala.xml.Node" class="keyword">if</span> <span class="delimiter">(</span><a href="#309343" title="scala.xml.NodeSeq">ns</a>.<span title="=&gt; Int">length</span> <span title="(x: Int)Boolean">==</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <span title="(_data: String)scala.xml.Text">Text</span><span class="delimiter">(</span><span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span> <span class="keyword">else</span> <a href="#309343" title="(i: Int)scala.xml.Node">ns</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <a title="scala.xml.Elem" id="309414">x</a> :: <a title="List[scala.xml.Elem]" id="309415">xs</a> =&gt; <a href="#309414" title="scala.xml.Elem">x</a>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Given a MailBodyType, convert it to a javax.mail.BodyPart.  You can override this method if you
   * add custom MailBodyTypes
   */</span>
  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="(tab: Mailer.this.MailBodyType)javax.mail.BodyPart" id="146759">buildMailBody</a><span class="delimiter">(</span><a title="Mailer.this.MailBodyType" id="309324">tab</a>: <a href="#146676" title="Mailer.this.MailBodyType">MailBodyType</a><span class="delimiter">)</span>: <span title="javax.mail.BodyPart">BodyPart</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="javax.mail.internet.MimeBodyPart" id="309416">bp</a> = <span title="javax.mail.internet.MimeBodyPart" class="keyword">new</span> <span title="javax.mail.internet.MimeBodyPart">MimeBodyPart</span>
          <a href="#309324" title="Mailer.this.MailBodyType">tab</a> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
            <span class="keyword">case</span> <span title="Unit">PlainMailBodyType</span><span class="delimiter">(</span><a title="String" id="309614">txt</a><span class="delimiter">)</span> =&gt; <a href="#309416" title="javax.mail.internet.MimeBodyPart">bp</a>.<span title="(x$1: java.lang.String, x$2: java.lang.String)Unit">setText</span><span class="delimiter">(</span><a href="#309614" title="String">txt</a>, <span title="java.lang.String(&quot;UTF-8&quot;)" class="string">&quot;UTF-8&quot;</span><span class="delimiter">)</span>
            <span class="keyword">case</span> <span title="Unit">PlainPlusBodyType</span><span class="delimiter">(</span><a title="String" id="309617">txt</a>, <a title="String" id="309618">charset</a><span class="delimiter">)</span> =&gt; <a href="#309416" title="javax.mail.internet.MimeBodyPart">bp</a>.<span title="(x$1: java.lang.String, x$2: java.lang.String)Unit">setText</span><span class="delimiter">(</span><a href="#309617" title="String">txt</a>, <a href="#309618" title="String">charset</a><span class="delimiter">)</span>
            <span class="keyword">case</span> <span title="Unit">XHTMLMailBodyType</span><span class="delimiter">(</span><a title="scala.xml.NodeSeq" id="309621">html</a><span class="delimiter">)</span> =&gt; <a href="#309416" title="javax.mail.internet.MimeBodyPart">bp</a>.<span title="(x$1: Any, x$2: java.lang.String)Unit">setContent</span><span class="delimiter">(</span><a href="#146757" title="(in: scala.xml.NodeSeq)String">encodeHtmlBodyPart</a><span class="delimiter">(</span><a href="#309621" title="scala.xml.NodeSeq">html</a><span class="delimiter">)</span>, <span title="java.lang.String(&quot;text/html; charset=&quot;)" class="string">&quot;text/html; charset=&quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#146737" title="=&gt; java.lang.String">charSet</a><span class="delimiter">)</span>
            <span class="keyword">case</span> <span title="Unit">XHTMLPlusImages</span><span class="delimiter">(</span><a title="scala.xml.NodeSeq" id="309624">html</a>, <a title="Seq[Mailer.this.PlusImageHolder]" id="309625">img</a>@_*<span class="delimiter">)</span> =&gt;
              <span class="keyword">val</span> <a title="javax.mail.internet.MimeMultipart" id="309626">html_mp</a> = <span title="(x$1: java.lang.String)javax.mail.internet.MimeMultipart" class="keyword">new</span> <span title="javax.mail.internet.MimeMultipart">MimeMultipart</span><span class="delimiter">(</span><span title="java.lang.String(&quot;related&quot;)" class="string">&quot;related&quot;</span><span class="delimiter">)</span>
              <span class="keyword">val</span> <a title="javax.mail.internet.MimeBodyPart" id="309627">bp2</a> = <span title="javax.mail.internet.MimeBodyPart" class="keyword">new</span> <span title="javax.mail.internet.MimeBodyPart">MimeBodyPart</span>
              <a href="#309627" title="javax.mail.internet.MimeBodyPart">bp2</a>.<span title="(x$1: Any, x$2: java.lang.String)Unit">setContent</span><span class="delimiter">(</span><a href="#146757" title="(in: scala.xml.NodeSeq)String">encodeHtmlBodyPart</a><span class="delimiter">(</span><a href="#309624" title="scala.xml.NodeSeq">html</a><span class="delimiter">)</span>, <span title="java.lang.String(&quot;text/html; charset=&quot;)" class="string">&quot;text/html; charset=&quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#146737" title="=&gt; java.lang.String">charSet</a><span class="delimiter">)</span>
              <a href="#309626" title="javax.mail.internet.MimeMultipart">html_mp</a>.<span title="(x$1: javax.mail.BodyPart)Unit">addBodyPart</span><span class="delimiter">(</span><a href="#309627" title="javax.mail.internet.MimeBodyPart">bp2</a><span class="delimiter">)</span>
              <a href="#309625" title="Seq[Mailer.this.PlusImageHolder]">img</a>.<span title="(f: Mailer.this.PlusImageHolder =&gt; Unit)Unit">foreach</span> <span class="delimiter">{</span>
                <a title="Mailer.this.PlusImageHolder" id="309654">i</a> =&gt;
                <span class="keyword">val</span> <a title="javax.mail.internet.MimeBodyPart" id="309655">rel_bpi</a> = <span title="javax.mail.internet.MimeBodyPart" class="keyword">new</span> <span title="javax.mail.internet.MimeBodyPart">MimeBodyPart</span>
                <a href="#309655" title="javax.mail.internet.MimeBodyPart">rel_bpi</a>.<span title="(x$1: java.lang.String)Unit">setFileName</span><span class="delimiter">(</span><a href="#309654" title="Mailer.this.PlusImageHolder">i</a>.<a href="#310698" title="=&gt; String">name</a><span class="delimiter">)</span>
                <a href="#309655" title="javax.mail.internet.MimeBodyPart">rel_bpi</a>.<span title="(x$1: java.lang.String)Unit">setContentID</span><span class="delimiter">(</span><a href="#309654" title="Mailer.this.PlusImageHolder">i</a>.<a href="#310698" title="=&gt; String">name</a><span class="delimiter">)</span>
                <a href="#309655" title="javax.mail.internet.MimeBodyPart">rel_bpi</a>.<span title="(x$1: java.lang.String)Unit">setDisposition</span><span class="delimiter">(</span><span title="java.lang.String(&quot;inline&quot;)" class="string">&quot;inline&quot;</span><span class="delimiter">)</span>
                <a href="#309655" title="javax.mail.internet.MimeBodyPart">rel_bpi</a>.<span title="(x$1: javax.activation.DataHandler)Unit">setDataHandler</span><span class="delimiter">(</span><span title="javax.activation.DataHandler" class="keyword">new</span> javax.activation.<span title="javax.activation.DataHandler">DataHandler</span><span class="delimiter">(</span><a href="#310580" title="java.lang.Object with javax.activation.DataSource" class="keyword">new</a> <a title="anonymous class $anon extends java.lang.Object with javax.activation.DataSource" id="310580">javax</a>.activation.<span title="javax.activation.DataSource">DataSource</span> <span class="delimiter">{</span>
                      <span class="keyword">def</span> <a title="()String" id="310582">getContentType</a> = <a href="#309654" title="Mailer.this.PlusImageHolder">i</a>.<a href="#310699" title="=&gt; String">mimeType</a>

                      <span class="keyword">def</span> <a title="()java.io.ByteArrayInputStream" id="310583">getInputStream</a> = <span title="java.io.ByteArrayInputStream" class="keyword">new</span> java.io.<span title="java.io.ByteArrayInputStream">ByteArrayInputStream</span><span class="delimiter">(</span><a href="#309654" title="Mailer.this.PlusImageHolder">i</a>.<a href="#310700" title="=&gt; Array[Byte]">bytes</a><span class="delimiter">)</span>

                      <span class="keyword">def</span> <a title="()String" id="310584">getName</a> = <a href="#309654" title="Mailer.this.PlusImageHolder">i</a>.<a href="#310698" title="=&gt; String">name</a>

                      <span class="keyword">def</span> <a title="()Nothing" id="310585">getOutputStream</a> = <span title="Nothing" class="keyword">throw</span> <span title="(x$1: java.lang.String)java.io.IOException" class="keyword">new</span> java.io.<span title="java.io.IOException">IOException</span><span class="delimiter">(</span><span title="java.lang.String(&quot;Unable to write to item&quot;)" class="string">&quot;Unable to write to item&quot;</span><span class="delimiter">)</span>
                    <span class="delimiter">}</span><span class="delimiter">)</span><span class="delimiter">)</span>
                <a href="#309626" title="javax.mail.internet.MimeMultipart">html_mp</a>.<span title="(x$1: javax.mail.BodyPart)Unit">addBodyPart</span><span class="delimiter">(</span><a href="#309655" title="javax.mail.internet.MimeBodyPart">rel_bpi</a><span class="delimiter">)</span>
              <span class="delimiter">}</span>
              <a href="#309416" title="javax.mail.internet.MimeBodyPart">bp</a>.<span title="(x$1: javax.mail.Multipart)Unit">setContent</span><span class="delimiter">(</span><a href="#309626" title="javax.mail.internet.MimeMultipart">html_mp</a><span class="delimiter">)</span>
          <span class="delimiter">}</span>
    <a href="#309416" title="javax.mail.internet.MimeBodyPart">bp</a>
  <span class="delimiter">}</span>


  <span class="comment">/**
   * Asynchronously send an email.
   */</span>
  <span class="keyword">def</span> <a title="(from: Mailer.this.From, subject: Mailer.this.Subject, rest: Mailer.this.MailTypes*)Unit" id="146760">sendMail</a><span class="delimiter">(</span><a title="Mailer.this.From" id="230514">from</a>: <a href="#230523" title="Mailer.this.From">From</a>, <a title="Mailer.this.Subject" id="230515">subject</a>: <a href="#230550" title="Mailer.this.Subject">Subject</a>, <a title="Mailer.this.MailTypes*" id="230516">rest</a>: <span title="Mailer.this.MailTypes*">MailTypes</span>*<span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="comment">// forward it to an actor so there's no time on this thread spent sending the message</span>
    <a href="#146755" title="=&gt; Mailer.this.MsgSender">msgSender</a> <a href="../../../../actor/net/liftweb/actor/LiftActor.scala.html#29502" title="(msg: Mailer.this.MessageInfo)Unit">!</a> <a href="#307326" title="(from: Mailer.this.From, subject: Mailer.this.Subject, info: List[Mailer.this.MailTypes])Mailer.this.MessageInfo">MessageInfo</a><span class="delimiter">(</span><a href="#230514" title="Mailer.this.From">from</a>, <a href="#230515" title="Mailer.this.Subject">subject</a>, <a href="#230516" title="Mailer.this.MailTypes*">rest</a>.<span title="=&gt; List[Mailer.this.MailTypes]">toList</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>


        </pre>
    </body>
</html>