<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>util/net/liftweb/util/CSSHelpers.scala</title>
        <script type="text/javascript" src="../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/*
 * Copyright 2007-2011 WorldWide Conferencing, LLC
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */</span>

<span class="keyword">package</span> net.liftweb
<span class="keyword">package</span> util

<span class="keyword">import</span> scala.util.parsing.combinator._
<span class="keyword">import</span> common._
<span class="keyword">import</span> java.io._

<span class="keyword">object</span> <a title="object net.liftweb.util.CSSHelpers" id="13184">CSSHelpers</a> <span title="ScalaObject" class="keyword">extends</span> <a href="ControlHelpers.scala.html#13217" title="net.liftweb.util.ControlHelpers">ControlHelpers</a> <span class="delimiter">{</span>

  <span class="comment">/**
   * Adds a prefix to root relative paths in the url segments from the css content
   *
   * @param in - the text reader
   * @param rootPrefix - the prefix to be added
   * @return (Box[String], String) - returns the tuple containing the parsing output and the original input (as a String)
   */</span>
  <span class="keyword">def</span> <a title="(in: java.io.Reader, rootPrefix: String)(net.liftweb.common.Box[String], String)" id="284050">fixCSS</a><span class="delimiter">(</span><a title="java.io.Reader" id="284052">in</a>: <span title="java.io.Reader">Reader</span>, <a title="String" id="284053">rootPrefix</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="(net.liftweb.common.Box[String], String)" class="delimiter">(</span>Box<span class="delimiter">[</span>String<span class="delimiter">]</span>, String<span class="delimiter">)</span> = <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="java.io.BufferedReader" id="284055">reader</a> = <span title="(x$1: java.io.Reader)java.io.BufferedReader" class="keyword">new</span> <span title="java.io.BufferedReader">BufferedReader</span><span class="delimiter">(</span><a href="#284052" title="java.io.Reader">in</a><span class="delimiter">)</span>
      <span class="keyword">val</span> <a title="StringBuilder" id="284056">res</a> = <span title="()StringBuilder" class="keyword">new</span> <span title="StringBuilder">StringBuilder</span>;
      <span class="keyword">var</span> <a title="String" id="284057">line</a>: <span title="String">String</span> = <span title="Null(null)" class="keyword">null</span>;
      <span class="keyword">try</span> <span class="delimiter">{</span>
        <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><span class="delimiter">{</span><a href="#284057" title="String">line</a> = <a href="#284055" title="java.io.BufferedReader">reader</a>.<span title="()java.lang.String">readLine</span><span class="delimiter">(</span><span class="delimiter">)</span>; <a href="#284057" title="String">line</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span><span class="delimiter">}</span><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="#284056" title="StringBuilder">res</a> <a href="#284064" title="(s: String)StringBuilder">append</a> <a href="#284057" title="String">line</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;\012&quot;)" class="string">&quot;\n&quot;</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span> <span class="keyword">finally</span> <span class="delimiter">{</span>
        <a href="#284055" title="java.io.BufferedReader">reader</a> <span title="()Unit">close</span>
      <span class="delimiter">}</span>
      <span class="keyword">val</span> <a title="java.lang.String" id="284058">str</a> = <a href="#284056" title="StringBuilder">res</a> <span title="()java.lang.String">toString</span>;
      <span title="(_1: net.liftweb.common.Box[String], _2: java.lang.String)(net.liftweb.common.Box[String], java.lang.String)" class="delimiter">(</span><a href="#284653" title="(prefix: String)net.liftweb.util.CSSParser">CSSParser</a><span class="delimiter">(</span><a href="#284053" title="String">rootPrefix</a><span class="delimiter">)</span>.<a href="#284102" title="(in: String)net.liftweb.common.Box[String]">fixCSS</a><span class="delimiter">(</span><a href="#284058" title="java.lang.String">str</a><span class="delimiter">)</span>, <a href="#284058" title="java.lang.String">str</a><span class="delimiter">)</span>;
  <span class="delimiter">}</span>


<span class="delimiter">}</span>

<span class="comment">/**
 * Combinator parser for prefixing root relative paths with a given prefix
 */</span>
case <span class="keyword">class</span> <a title="class CSSParser extends java.lang.Object with scala.util.parsing.combinator.Parsers with ScalaObject with Product with Serializable" id="284653">CSSParser</a><a href="#284653" title="ScalaObject" class="delimiter">(</a><a title="String" id="284105">prefix</a>: <span title="String">String</span><span class="delimiter">)</span> <span class="keyword">extends</span> <span title="scala.util.parsing.combinator.Parsers">Parsers</span>  <span class="delimiter">{</span>
  <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="implicit net.liftweb.util.CSSParser.strToInput : (in: String)CSSParser.this.Input" id="284086">strToInput</a><span class="delimiter">(</span><a title="String" id="284189">in</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="CSSParser.this.Input">Input</span> = <span title="(chars: Array[Char])scala.util.parsing.input.CharArrayReader" class="keyword">new</span> scala.util.parsing.input.<span title="scala.util.parsing.input.CharArrayReader">CharArrayReader</span><span class="delimiter">(</span><a href="#284189" title="String">in</a>.<span title="()Array[Char]">toCharArray</span><span class="delimiter">)</span>
  <span class="keyword">type</span> <a title="Char" id="284087">Elem</a> = <span title="Char">Char</span>


 <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="CSSParser.this.Parser[String]" id="284089">contentParser</a> = <a href="#284653" title="[T](f: CSSParser.this.Input =&gt; CSSParser.this.ParseResult[T])CSSParser.this.Parser[T]">Parser</a><span title="(f: CSSParser.this.Input =&gt; CSSParser.this.ParseResult[String])CSSParser.this.Parser[String]" class="delimiter">[</span><span title="String">String</span><span class="delimiter">]</span> <a href="#284169" title="CSSParser.this.ParseResult[String]" class="delimiter">{</a>
    <span class="keyword">case</span> <a title="CSSParser.this.Success[java.lang.String]" id="284180">in</a> =&gt;
      <span class="keyword">val</span> <a title="StringBuilder" id="284181">content</a> = <span title="()StringBuilder" class="keyword">new</span> <span title="StringBuilder">StringBuilder</span>;
      <span class="keyword">var</span> <a title="Int" id="284182">seqDone</a> = <span title="Int(0)" class="int">0</span>;

      <span class="keyword">def</span> <a title="(in: CSSParser.this.Input)(f: Char =&gt; Boolean)CSSParser.this.Input" id="284183">walk</a><span class="delimiter">(</span><a title="CSSParser.this.Input" id="284192">in</a>: <span title="CSSParser.this.Input">Input</span><span class="delimiter">)</span><span class="delimiter">(</span><a title="Char =&gt; Boolean" id="284193">f</a>: Char =&gt; Boolean<span class="delimiter">)</span>: <span title="CSSParser.this.Input">Input</span> = <span class="delimiter">{</span>
        <span class="keyword">var</span> <a title="CSSParser.this.Input" id="284194">seq</a> = <a href="#284192" title="CSSParser.this.Input">in</a>
        <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#284194" title="CSSParser.this.Input">seq</a>.<span title="=&gt; Boolean">atEnd</span> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <span title="=&gt; Boolean">!</span><a href="#284193" title="(v1: Char)Boolean">f</a><span class="delimiter">(</span><a href="#284194" title="CSSParser.this.Input">seq</a> <span title="=&gt; CSSParser.this.Elem">first</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
          <a href="#284194" title="CSSParser.this.Input">seq</a> = <a href="#284194" title="CSSParser.this.Input">seq</a> <span title="=&gt; scala.util.parsing.input.Reader[CSSParser.this.Elem]">rest</span>
        <span class="delimiter">}</span>
        <a href="#284194" title="CSSParser.this.Input">seq</a> <span title="=&gt; scala.util.parsing.input.Reader[CSSParser.this.Elem]">rest</span>
      <span class="delimiter">}</span>

      <span class="keyword">val</span> <a title="CSSParser.this.Input" id="284184">rest</a> = <a href="#284183" title="(in: CSSParser.this.Input)(f: Char =&gt; Boolean)CSSParser.this.Input">walk</a><span class="delimiter">(</span><a href="#284180" title="CSSParser.this.Input">in</a><span class="delimiter">)</span> <a href="#284198" title="Boolean" class="delimiter">{</a>
        <span class="keyword">case</span> <a title="Boolean" id="284199">c</a> =&gt;
          <a href="#284181" title="StringBuilder">content</a> <span title="(x: Char)StringBuilder">append</span> <a href="#284199" title="Char">c</a>
          <a href="#284199" title="implicit scala.LowPriorityImplicits.charWrapper : (c: Char)scala.runtime.RichChar">c</a>.<span title="=&gt; Char">toLower</span> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
            <span class="keyword">case</span> <span title="Unit" class="char">'u'</span> <span class="keyword">if</span> <span class="delimiter">(</span><a href="#284182" title="Int">seqDone</a> <span title="(x: Int)Boolean">==</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> =&gt; <a href="#284182" title="Int">seqDone</a> = <span title="Int(1)" class="int">1</span>;
            <span class="keyword">case</span> <span title="Unit" class="char">'r'</span> <span class="keyword">if</span> <span class="delimiter">(</span><a href="#284182" title="Int">seqDone</a> <span title="(x: Int)Boolean">==</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span> =&gt; <a href="#284182" title="Int">seqDone</a> = <span title="Int(2)" class="int">2</span>;
            <span class="keyword">case</span> <span title="Unit" class="char">'l'</span> <span class="keyword">if</span> <span class="delimiter">(</span><a href="#284182" title="Int">seqDone</a> <span title="(x: Int)Boolean">==</span> <span title="Int(2)" class="int">2</span><span class="delimiter">)</span> =&gt; <a href="#284182" title="Int">seqDone</a> = <span title="Int(3)" class="int">3</span>;
            <span class="keyword">case</span> <span title="Unit">_</span> =&gt; <a href="#284182" title="Int">seqDone</a> = <span title="Int(0)" class="int">0</span>
          <span class="delimiter">}</span>
          <a href="#284182" title="Int">seqDone</a> <span title="(x: Int)Boolean">==</span> <span title="Int(3)" class="int">3</span>;
      <span class="delimiter">}</span>

      <a href="#284653" title="(result: java.lang.String, next: CSSParser.this.Input)CSSParser.this.Success[java.lang.String]">Success</a><span class="delimiter">(</span><a href="#284181" title="StringBuilder">content</a> <span title="()java.lang.String">toString</span>, <a href="#284184" title="CSSParser.this.Input">rest</a><span class="delimiter">)</span>;
  <span class="delimiter">}</span>



  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="CSSParser.this.Parser[List[CSSParser.this.Elem]]" id="284091">spaces</a> = <span class="delimiter">(</span><a href="#284653" title="(e: CSSParser.this.Elem)CSSParser.this.Parser[CSSParser.this.Elem]">elem</a><span class="delimiter">(</span><span title="Char(\' \')" class="char">' '</span><span class="delimiter">)</span> <span title="(q: =&gt; CSSParser.this.Parser[CSSParser.this.Elem])CSSParser.this.Parser[CSSParser.this.Elem]">|</span> <a href="#284653" title="(e: CSSParser.this.Elem)CSSParser.this.Parser[CSSParser.this.Elem]">elem</a><span class="delimiter">(</span><span title="Char(\'\\t\')" class="char">'\t'</span><span class="delimiter">)</span> <span title="(q: =&gt; CSSParser.this.Parser[CSSParser.this.Elem])CSSParser.this.Parser[CSSParser.this.Elem]">|</span> <a href="#284653" title="(e: CSSParser.this.Elem)CSSParser.this.Parser[CSSParser.this.Elem]">elem</a><span class="delimiter">(</span><span title="Char(\'\\n\')" class="char">'\n'</span><span class="delimiter">)</span> <span title="(q: =&gt; CSSParser.this.Parser[CSSParser.this.Elem])CSSParser.this.Parser[CSSParser.this.Elem]">|</span> <a href="#284653" title="(e: CSSParser.this.Elem)CSSParser.this.Parser[CSSParser.this.Elem]">elem</a><span class="delimiter">(</span><span title="Char(\'\\r\')" class="char">'\r'</span><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="=&gt; CSSParser.this.Parser[List[CSSParser.this.Elem]]">*</span>
  <span class="comment">// consider only root relative paths that start with /</span>
  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="CSSParser.this.Parser[String]" id="284093">path</a> = <a href="#284653" title="(kind: String, p: CSSParser.this.Elem =&gt; Boolean)CSSParser.this.Parser[CSSParser.this.Elem]">elem</a><span class="delimiter">(</span><span title="java.lang.String(&quot;path&quot;)" class="string">&quot;path&quot;</span>, <a title="CSSParser.this.Elem" id="284276">c</a> =&gt; <a href="#284276" title="implicit scala.LowPriorityImplicits.charWrapper : (c: Char)scala.runtime.RichChar">c</a>.<span title="=&gt; Boolean">isLetterOrDigit</span> <span title="(x: Boolean)Boolean">||</span>
                         <a href="#284276" title="CSSParser.this.Elem">c</a> <span title="(x: Char)Boolean">==</span> <span title="Char(\'?\')" class="char">'?'</span> <span title="(x: Boolean)Boolean">||</span> <a href="#284276" title="CSSParser.this.Elem">c</a> <span title="(x: Char)Boolean">==</span> <span title="Char(\'/\')" class="char">'/'</span> <span title="(x: Boolean)Boolean">||</span>
                         <a href="#284276" title="CSSParser.this.Elem">c</a> <span title="(x: Char)Boolean">==</span> <span title="Char(\'&amp;\')" class="char">'&amp;'</span> <span title="(x: Boolean)Boolean">||</span> <a href="#284276" title="CSSParser.this.Elem">c</a> <span title="(x: Char)Boolean">==</span> <span title="Char(\'@\')" class="char">'@'</span> <span title="(x: Boolean)Boolean">||</span>
                         <a href="#284276" title="CSSParser.this.Elem">c</a> <span title="(x: Char)Boolean">==</span> <span title="Char(\';\')" class="char">';'</span> <span title="(x: Boolean)Boolean">||</span> <a href="#284276" title="CSSParser.this.Elem">c</a> <span title="(x: Char)Boolean">==</span> <span title="Char(\'.\')" class="char">'.'</span> <span title="(x: Boolean)Boolean">||</span>
                         <a href="#284276" title="CSSParser.this.Elem">c</a> <span title="(x: Char)Boolean">==</span> <span title="Char(\'+\')" class="char">'+'</span> <span title="(x: Boolean)Boolean">||</span> <a href="#284276" title="CSSParser.this.Elem">c</a> <span title="(x: Char)Boolean">==</span> <span title="Char(\'-\')" class="char">'-'</span> <span title="(x: Boolean)Boolean">||</span>
                         <a href="#284276" title="CSSParser.this.Elem">c</a> <span title="(x: Char)Boolean">==</span> <span title="Char(\'=\')" class="char">'='</span> <span title="(x: Boolean)Boolean">||</span> <a href="#284276" title="CSSParser.this.Elem">c</a> <span title="(x: Char)Boolean">==</span> <span title="Char(\':\')" class="char">':'</span> <span title="(x: Boolean)Boolean">||</span>
                         <a href="#284276" title="CSSParser.this.Elem">c</a> <span title="(x: Char)Boolean">==</span> <span title="Char(\' \')" class="char">' '</span> <span title="(x: Boolean)Boolean">||</span> <a href="#284276" title="CSSParser.this.Elem">c</a> <span title="(x: Char)Boolean">==</span> <span title="Char(\'_\')" class="char">'_'</span><span class="delimiter">)</span>.<span title="=&gt; CSSParser.this.Parser[List[CSSParser.this.Elem]]">+</span> <span title="(f: List[CSSParser.this.Elem] =&gt; String)CSSParser.this.Parser[String]">^^</span> <a href="#284333" title="String" class="delimiter">{</a><span class="keyword">case</span> <a title="String" id="284334">l</a> =&gt; <a href="#284334" title="List[CSSParser.this.Elem]">l</a>.<span title="(sep: String)String">mkString</span><span class="delimiter">(</span><span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span><span class="delimiter">}</span>

  <span class="comment">// the URL might be wrapped in simple quotes</span>
  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="CSSParser.this.Parser[String]" id="284095">seq1</a> = <a href="#284653" title="(e: CSSParser.this.Elem)CSSParser.this.Parser[CSSParser.this.Elem]">elem</a><span class="delimiter">(</span><span title="Char(\'\\\'\')" class="char">'\''</span><span class="delimiter">)</span> <span title="(q: =&gt; CSSParser.this.Parser[String])CSSParser.this.Parser[String]">~&gt;</span> <a href="#284092" title="=&gt; CSSParser.this.Parser[String]">path</a> <span title="(q: =&gt; CSSParser.this.Parser[CSSParser.this.Elem])CSSParser.this.Parser[String]">&lt;~</span> <a href="#284653" title="(e: CSSParser.this.Elem)CSSParser.this.Parser[CSSParser.this.Elem]">elem</a><span class="delimiter">(</span><span title="Char(\'\\\'\')" class="char">'\''</span><span class="delimiter">)</span>
  <span class="comment">// the URL might be wrapped in double quotes</span>
  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="CSSParser.this.Parser[String]" id="284097">seq2</a> = <a href="#284653" title="(e: CSSParser.this.Elem)CSSParser.this.Parser[CSSParser.this.Elem]">elem</a><span class="delimiter">(</span><span title="Char(\'\\\&quot;\')" class="char">'\&quot;'</span><span class="delimiter">)</span> <span title="(q: =&gt; CSSParser.this.Parser[String])CSSParser.this.Parser[String]">~&gt;</span> <a href="#284092" title="=&gt; CSSParser.this.Parser[String]">path</a> <span title="(q: =&gt; CSSParser.this.Parser[CSSParser.this.Elem])CSSParser.this.Parser[String]">&lt;~</span> <a href="#284653" title="(e: CSSParser.this.Elem)CSSParser.this.Parser[CSSParser.this.Elem]">elem</a><span class="delimiter">(</span><span title="Char(\'\\\&quot;\')" class="char">'\&quot;'</span><span class="delimiter">)</span>
  <span class="comment">// do the parsing per CSS spec http://www.w3.org/TR/REC-CSS2/syndata.html#uri section 4.3.4</span>
  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="CSSParser.this.Parser[java.lang.String]" id="284099">expr</a> = <span class="delimiter">(</span><a href="#284090" title="=&gt; CSSParser.this.Parser[List[CSSParser.this.Elem]]">spaces</a> <span title="(q: =&gt; CSSParser.this.Parser[CSSParser.this.Elem])CSSParser.this.Parser[CSSParser.this.~[List[CSSParser.this.Elem],CSSParser.this.Elem]]">~</span> <a href="#284653" title="(e: CSSParser.this.Elem)CSSParser.this.Parser[CSSParser.this.Elem]">elem</a><span class="delimiter">(</span><span title="Char(\'(\')" class="char">'('</span><span class="delimiter">)</span> <span title="(q: =&gt; CSSParser.this.Parser[List[CSSParser.this.Elem]])CSSParser.this.Parser[CSSParser.this.~[CSSParser.this.~[List[CSSParser.this.Elem],CSSParser.this.Elem],List[CSSParser.this.Elem]]]">~</span> <a href="#284090" title="=&gt; CSSParser.this.Parser[List[CSSParser.this.Elem]]">spaces</a><span class="delimiter">)</span> <span title="(q: =&gt; CSSParser.this.Parser[String])CSSParser.this.Parser[String]">~&gt;</span> <span class="delimiter">(</span> <a href="#284094" title="=&gt; CSSParser.this.Parser[String]">seq1</a> <span title="(q: =&gt; CSSParser.this.Parser[String])CSSParser.this.Parser[String]">|</span> <a href="#284096" title="=&gt; CSSParser.this.Parser[String]">seq2</a> <span title="(q: =&gt; CSSParser.this.Parser[String])CSSParser.this.Parser[String]">|</span> <a href="#284092" title="=&gt; CSSParser.this.Parser[String]">path</a> <span class="delimiter">)</span> <span title="(q: =&gt; CSSParser.this.Parser[List[CSSParser.this.Elem]])CSSParser.this.Parser[String]">&lt;~</span> <span class="delimiter">(</span><a href="#284090" title="=&gt; CSSParser.this.Parser[List[CSSParser.this.Elem]]">spaces</a> <span title="(q: =&gt; CSSParser.this.Parser[CSSParser.this.Elem])CSSParser.this.Parser[List[CSSParser.this.Elem]]">&lt;~</span> <a href="#284653" title="(e: CSSParser.this.Elem)CSSParser.this.Parser[CSSParser.this.Elem]">elem</a><span class="delimiter">(</span><span title="Char(\')\')" class="char">')'</span><span class="delimiter">)</span><span class="delimiter">)</span> <span title="(f: String =&gt; java.lang.String)CSSParser.this.Parser[java.lang.String]">^^</span> <a href="#284411" title="java.lang.String" class="delimiter">{</a><span class="keyword">case</span> <a title="java.lang.String" id="284412">s</a> =&gt; <span class="delimiter">{</span>
      <span title="java.lang.String(&quot;(\'&quot;)" class="string">&quot;('&quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <span class="delimiter">(</span><a href="#284412" title="String">s</a>.<span title="()java.lang.String">trim</span>.<span title="(x$1: java.lang.String)Boolean">startsWith</span><span class="delimiter">(</span><span title="java.lang.String(&quot;/&quot;)" class="string">&quot;/&quot;</span><span class="delimiter">)</span> <span title="Any" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <span title="java.lang.String" class="keyword">true</span> =&gt; <a href="#284105" title="=&gt; String">prefix</a> <span title="(x$1: Any)java.lang.String">+</span> <a href="#284412" title="String">s</a>.<span title="()java.lang.String">trim</span>
        <span class="keyword">case</span> <span title="java.lang.String">_</span> =&gt; <a href="#284412" title="String">s</a>.<span title="()java.lang.String">trim</span>
      <span class="delimiter">}</span><span class="delimiter">)</span> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;\')&quot;)" class="string">&quot;')&quot;</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="CSSParser.this.Parser[java.lang.String]" id="284101">phrase</a> = <span class="delimiter">(</span><span class="delimiter">(</span><a href="#284088" title="=&gt; CSSParser.this.Parser[String]">contentParser</a> <span title="(q: =&gt; CSSParser.this.Parser[java.lang.String])CSSParser.this.Parser[CSSParser.this.~[String,java.lang.String]]">~</span> <a href="#284098" title="=&gt; CSSParser.this.Parser[java.lang.String]">expr</a><span class="delimiter">)</span>.<span title="=&gt; CSSParser.this.Parser[List[CSSParser.this.~[String,java.lang.String]]]">*</span> <span title="(f: List[CSSParser.this.~[String,java.lang.String]] =&gt; String)CSSParser.this.Parser[String]">^^</span> <a href="#284429" title="String" class="delimiter">{</a><span class="keyword">case</span> <a title="String" id="284430">l</a> =&gt; <a href="#284430" title="List[CSSParser.this.~[String,java.lang.String]]">l</a>.<span title="(f: CSSParser.this.~[String,java.lang.String] =&gt; scala.collection.GenTraversableOnce[Char])(implicit bf: scala.collection.generic.CanBuildFrom[List[CSSParser.this.~[String,java.lang.String]],Char,List[Char]])List[Char]">flatMap</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.List.Coll,Char,List[Char]]" class="delimiter">(</span><a title="CSSParser.this.~[String,java.lang.String]" id="284447">f</a> =&gt; <a href="#284447" title="CSSParser.this.~[String,java.lang.String]">f</a>.<span title="=&gt; String">_1</span> <span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">+</span> <a href="#284447" title="CSSParser.this.~[String,java.lang.String]">f</a>.<span title="=&gt; java.lang.String">_2</span><span class="delimiter">)</span>.<span title="(sep: String)String">mkString</span><span class="delimiter">(</span><span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span><span class="delimiter">}</span><span class="delimiter">)</span> <span title="(q: =&gt; CSSParser.this.Parser[String])CSSParser.this.Parser[CSSParser.this.~[String,String]]">~</span> <a href="#284088" title="=&gt; CSSParser.this.Parser[String]">contentParser</a> <span title="(f: CSSParser.this.~[String,String] =&gt; java.lang.String)CSSParser.this.Parser[java.lang.String]">^^</span> <a href="#284523" title="java.lang.String" class="delimiter">{</a><span class="keyword">case</span> <a title="java.lang.String" id="284526">a</a> ~ <a title="String" id="284527">b</a> =&gt; <a href="#284526" title="String">a</a> <span title="(x$1: Any)java.lang.String">+</span> <a href="#284527" title="String">b</a><span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(in: String)net.liftweb.common.Box[String]" id="284102">fixCSS</a><span class="delimiter">(</span><a title="String" id="284109">in</a>: <span title="String">String</span><span class="delimiter">)</span>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[String]">Box</a><span class="delimiter">[</span>String<span class="delimiter">]</span> = <a href="#284100" title="(in: CSSParser.this.Input)CSSParser.this.ParseResult[java.lang.String]">phrase</a><span class="delimiter">(</span><a href="#284086" title="implicit net.liftweb.util.CSSParser.strToInput : (in: String)CSSParser.this.Input">in</a><span class="delimiter">)</span> <span title="net.liftweb.common.Box[String]" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <span title="net.liftweb.common.Box[String]">Success</span><span class="delimiter">(</span><a title="java.lang.String" id="284605">v</a>, <a title="CSSParser.this.Input" id="284606">r</a><span class="delimiter">)</span> =&gt; <span class="delimiter">(</span><a href="#284606" title="CSSParser.this.Input">r</a> <span title="=&gt; Boolean">atEnd</span><span class="delimiter">)</span> <span title="net.liftweb.common.Box[String]" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <span title="net.liftweb.common.Full[java.lang.String]" class="keyword">true</span> =&gt; <a href="../../../../common/net/liftweb/common/Box.scala.html#27086" title="(value: java.lang.String)net.liftweb.common.Full[java.lang.String]">Full</a><span class="delimiter">(</span><a href="#284605" title="java.lang.String">v</a><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="net.liftweb.common.Empty.type">_</span> =&gt; <a href="../../../../common/net/liftweb/common/Box.scala.html#10581" title="object net.liftweb.common.Empty">Empty</a> <span class="comment">// return Empty if the reader is not at end as it implies that parsing ended due to a parser error</span>
      <span class="delimiter">}</span>
    <span class="keyword">case</span> <span title="net.liftweb.common.Empty.type">_</span> =&gt; <a href="../../../../common/net/liftweb/common/Box.scala.html#10581" title="object net.liftweb.common.Empty">Empty</a>
  <span class="delimiter">}</span>

<span class="delimiter">}</span>


        </pre>
    </body>
</html>