<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>util/net/liftweb/util/CurrencyZone.scala</title>
        <script type="text/javascript" src="../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/*
 * Copyright 2007-2011 WorldWide Conferencing, LLC
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */</span>

<span class="keyword">package</span> net.liftweb
<span class="keyword">package</span> util

<span class="keyword">import</span> java.util.Locale
<span class="keyword">import</span> java.text.<span class="delimiter">{</span>NumberFormat, DecimalFormat<span class="delimiter">}</span>

<span class="keyword">trait</span> <a title="trait TwoFractionDigits extends java.lang.Object with ScalaObject" id="13291">TwoFractionDigits</a> <span title="ScalaObject" class="delimiter">{</span>
    <span class="keyword">def</span> <a title="=&gt; Int" id="292785">numberOfFractionDigits</a> = <span title="Int(2)" class="int">2</span>
    <span class="keyword">def</span> <a title="=&gt; Int" id="292786">scale</a> = <span title="Int(10)" class="int">10</span>
<span class="delimiter">}</span>

<span class="keyword">trait</span> <a title="trait DollarCurrency extends java.lang.Object with net.liftweb.util.TwoFractionDigits with ScalaObject" id="13292">DollarCurrency</a> <span title="ScalaObject" class="keyword">extends</span> <a href="#13291" title="net.liftweb.util.TwoFractionDigits">TwoFractionDigits</a> <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="=&gt; String" id="292796">currencySymbol</a>: <span title="String">String</span> = <span title="java.lang.String(&quot;$&quot;)" class="string">&quot;$&quot;</span>
<span class="delimiter">}</span>

<span class="comment">/* Various Currencies */</span>
<span class="keyword">object</span> <a title="object net.liftweb.util.AU" id="13293">AU</a> <span title="ScalaObject" class="keyword">extends</span> <a href="#13301" title="net.liftweb.util.CurrencyZone">CurrencyZone</a> <span class="delimiter">{</span>
    <span class="keyword">type</span> <a title="net.liftweb.util.AU.AUD" id="292810">Currency</a> = <a href="#292815" title="net.liftweb.util.AU.AUD">AUD</a>
    <span class="keyword">var</span> <a title="java.util.Locale" id="292812">locale</a> = <span title="(x$1: java.lang.String, x$2: java.lang.String)java.util.Locale" class="keyword">new</span> <span title="java.util.Locale">Locale</span><span class="delimiter">(</span><span title="java.lang.String(&quot;en&quot;)" class="string">&quot;en&quot;</span>, <span title="java.lang.String(&quot;AU&quot;)" class="string">&quot;AU&quot;</span><span class="delimiter">)</span>
    <span class="keyword">def</span> <a title="(x: BigDecimal)net.liftweb.util.AU.AUD" id="292814">make</a><span class="delimiter">(</span><a title="BigDecimal" id="292852">x</a>: <span title="BigDecimal">BigDecimal</span><span class="delimiter">)</span> = <a href="#292857" title="net.liftweb.util.AU.AUD" class="keyword">new</a> <a href="#292810" title="anonymous class $anon extends net.liftweb.util.AU.AUD" id="292857">Currency</a><span class="delimiter">{</span><span class="keyword">def</span> <a title="=&gt; BigDecimal" id="292913">amount</a> = <a href="#292852" title="BigDecimal">x</a><span class="delimiter">}</span>
    <span class="keyword">abstract</span> <span class="keyword">class</span> <a title="class AUD extends net.liftweb.util.AU.AbstractCurrency with net.liftweb.util.DollarCurrency with ScalaObject" id="292815">AUD</a> <a href="#292815" title="ScalaObject" class="keyword">extends</a> <a href="#292808" title="net.liftweb.util.AU.AbstractCurrency">AbstractCurrency</a><span class="delimiter">(</span><span title="java.lang.String(&quot;AUD&quot;)" class="string">&quot;AUD&quot;</span><span class="delimiter">)</span> <span class="keyword">with</span> <a href="#13292" title="net.liftweb.util.DollarCurrency">DollarCurrency</a> <span class="delimiter">{</span><span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="keyword">object</span> <a title="object net.liftweb.util.US" id="13295">US</a> <span title="ScalaObject" class="keyword">extends</span> <a href="#13301" title="net.liftweb.util.CurrencyZone">CurrencyZone</a> <span class="delimiter">{</span>
    <span class="keyword">type</span> <a title="net.liftweb.util.US.USD" id="292922">Currency</a> = <a href="#292927" title="net.liftweb.util.US.USD">USD</a>
    <span class="keyword">var</span> <a title="java.util.Locale" id="292924">locale</a> = <span title="object java.util.Locale">Locale</span>.<span title="java.util.Locale">US</span>
    <span class="keyword">def</span> <a title="(x: BigDecimal)net.liftweb.util.US.USD" id="292926">make</a><span class="delimiter">(</span><a title="BigDecimal" id="292931">x</a>: <span title="BigDecimal">BigDecimal</span><span class="delimiter">)</span> = <a href="#292934" title="net.liftweb.util.US.USD" class="keyword">new</a> <a href="#292922" title="anonymous class $anon extends net.liftweb.util.US.USD" id="292934">Currency</a><span class="delimiter">{</span><span class="keyword">def</span> <a title="=&gt; BigDecimal" id="292942">amount</a> = <a href="#292931" title="BigDecimal">x</a><span class="delimiter">}</span>
    <span class="keyword">abstract</span> <span class="keyword">class</span> <a title="class USD extends net.liftweb.util.US.AbstractCurrency with net.liftweb.util.DollarCurrency with ScalaObject" id="292927">USD</a> <a href="#292927" title="ScalaObject" class="keyword">extends</a> <a href="#292808" title="net.liftweb.util.US.AbstractCurrency">AbstractCurrency</a><span class="delimiter">(</span><span title="java.lang.String(&quot;USD&quot;)" class="string">&quot;USD&quot;</span><span class="delimiter">)</span> <span class="keyword">with</span> <a href="#13292" title="net.liftweb.util.DollarCurrency">DollarCurrency</a> <span class="delimiter">{</span><span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="keyword">object</span> <a title="object net.liftweb.util.GB" id="13297">GB</a> <span title="ScalaObject" class="keyword">extends</span> <a href="#13301" title="net.liftweb.util.CurrencyZone">CurrencyZone</a> <span class="delimiter">{</span>
    <span class="keyword">type</span> <a title="net.liftweb.util.GB.GBP" id="292951">Currency</a> = <a href="#292956" title="net.liftweb.util.GB.GBP">GBP</a>
    <span class="keyword">var</span> <a title="java.util.Locale" id="292953">locale</a> = <span title="object java.util.Locale">Locale</span>.<span title="java.util.Locale">UK</span>
    <span class="keyword">def</span> <a title="(x: BigDecimal)net.liftweb.util.GB.GBP" id="292955">make</a><span class="delimiter">(</span><a title="BigDecimal" id="292961">x</a>: <span title="BigDecimal">BigDecimal</span><span class="delimiter">)</span> = <a href="#292964" title="net.liftweb.util.GB.GBP" class="keyword">new</a> <a href="#292951" title="anonymous class $anon extends net.liftweb.util.GB.GBP" id="292964">Currency</a><span class="delimiter">{</span><span class="keyword">def</span> <a title="=&gt; BigDecimal" id="292975">amount</a> = <a href="#292961" title="BigDecimal">x</a><span class="delimiter">}</span>
    <span class="keyword">abstract</span> <span class="keyword">class</span> <a title="class GBP extends net.liftweb.util.GB.AbstractCurrency with net.liftweb.util.TwoFractionDigits with ScalaObject" id="292956">GBP</a> <a href="#292956" title="ScalaObject" class="keyword">extends</a> <a href="#292808" title="net.liftweb.util.GB.AbstractCurrency">AbstractCurrency</a><span class="delimiter">(</span><span title="java.lang.String(&quot;GBP&quot;)" class="string">&quot;GBP&quot;</span><span class="delimiter">)</span> <span class="keyword">with</span> <a href="#13291" title="net.liftweb.util.TwoFractionDigits">TwoFractionDigits</a> <span class="delimiter">{</span><span class="keyword">def</span> <a title="=&gt; java.lang.String" id="292960">currencySymbol</a> = <span title="java.lang.String(&quot;£&quot;)" class="string">&quot;£&quot;</span><span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="keyword">object</span> <a title="object net.liftweb.util.EU" id="13299">EU</a> <span title="ScalaObject" class="keyword">extends</span> <a href="#13301" title="net.liftweb.util.CurrencyZone">CurrencyZone</a> <span class="delimiter">{</span>
    <span class="keyword">type</span> <a title="net.liftweb.util.EU.EUR" id="292984">Currency</a> = <a href="#292989" title="net.liftweb.util.EU.EUR">EUR</a>
    <span class="keyword">var</span> <a title="java.util.Locale" id="292986">locale</a> = <span title="object java.util.Locale">Locale</span>.<span title="java.util.Locale">GERMANY</span> <span class="comment">// guess this is why its a var</span>
    <span class="keyword">def</span> <a title="(x: BigDecimal)net.liftweb.util.EU.EUR" id="292988">make</a><span class="delimiter">(</span><a title="BigDecimal" id="292994">x</a>: <span title="BigDecimal">BigDecimal</span><span class="delimiter">)</span> = <a href="#292997" title="net.liftweb.util.EU.EUR{}" class="keyword">new</a> <a href="#292984" title="anonymous class $anon extends net.liftweb.util.EU.EUR" id="292997">Currency</a><span class="delimiter">{</span><span class="keyword">def</span> <a title="=&gt; BigDecimal" id="293008">amount</a> = <a href="#292994" title="BigDecimal">x</a>; <span class="keyword">override</span> <span class="keyword">val</span> <a title="java.util.Locale" id="293009">_locale</a> = <a href="#292986" title="=&gt; java.util.Locale">locale</a><span class="delimiter">}</span>
    <span class="keyword">abstract</span> <span class="keyword">class</span> <a title="class EUR extends net.liftweb.util.EU.AbstractCurrency with net.liftweb.util.TwoFractionDigits with ScalaObject" id="292989">EUR</a> <a href="#292989" title="ScalaObject" class="keyword">extends</a> <a href="#292808" title="net.liftweb.util.EU.AbstractCurrency">AbstractCurrency</a><span class="delimiter">(</span><span title="java.lang.String(&quot;EUR&quot;)" class="string">&quot;EUR&quot;</span><span class="delimiter">)</span> <span class="keyword">with</span> <a href="#13291" title="net.liftweb.util.TwoFractionDigits">TwoFractionDigits</a> <span class="delimiter">{</span><span class="keyword">def</span> <a title="=&gt; java.lang.String" id="292993">currencySymbol</a> = <span title="java.lang.String(&quot;€&quot;)" class="string">&quot;€&quot;</span><span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="keyword">abstract</span> <span class="keyword">class</span> <a title="class CurrencyZone extends java.lang.Object with ScalaObject" id="13301">CurrencyZone</a> <a href="#13301" title="ScalaObject" class="delimiter">{</a>
    <span class="keyword">type</span> <a title="&gt;: Nothing &lt;: CurrencyZone.this.AbstractCurrency" id="292802">Currency</a> &lt;: AbstractCurrency

    <span class="keyword">var</span> <a title="=&gt; java.util.Locale" id="292804">locale</a>: <span title="java.util.Locale">Locale</span>
    <span class="keyword">def</span> <a title="(x: BigDecimal)CurrencyZone.this.Currency" id="292805">make</a><span class="delimiter">(</span><a title="BigDecimal" id="292854">x</a>: <span title="BigDecimal">BigDecimal</span><span class="delimiter">)</span>: <a href="#292802" title="CurrencyZone.this.Currency">Currency</a>

    <span class="keyword">def</span> <a title="(x: String)CurrencyZone.this.Currency" id="292806">apply</a><span class="delimiter">(</span><a title="String" id="293022">x</a>: <span title="String">String</span><span class="delimiter">)</span>: <a href="#292802" title="CurrencyZone.this.Currency">Currency</a> = <span class="delimiter">{</span>
        <span class="keyword">try</span> <span class="delimiter">{</span>
            <a href="#292805" title="(x: BigDecimal)CurrencyZone.this.Currency">make</a><span class="delimiter">(</span><span title="(x: String)scala.math.BigDecimal">BigDecimal</span><span class="delimiter">(</span><a href="#293022" title="String">x</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="comment">// try normal number</span>
        <span class="delimiter">}</span> <span class="keyword">catch</span> <span class="delimiter">{</span> <span class="keyword">case</span> <a title="CurrencyZone.this.Currency" id="293032">e</a>: java.lang.<span title="java.lang.NumberFormatException">NumberFormatException</span> =&gt; <span class="delimiter">{</span>
                    <span class="keyword">try</span> <span class="delimiter">{</span>
                        <a href="#292805" title="(x: BigDecimal)CurrencyZone.this.Currency">make</a><span class="delimiter">(</span><span title="(x: String)scala.math.BigDecimal">BigDecimal</span><span class="delimiter">(</span><span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span><span title="(x$1: Any)java.lang.String">+</span><span title="object java.text.NumberFormat">NumberFormat</span>.<span title="(x$1: java.util.Locale)java.text.NumberFormat">getNumberInstance</span><span class="delimiter">(</span><a href="#292804" title="=&gt; java.util.Locale">locale</a><span class="delimiter">)</span>.<span title="(x$1: java.lang.String)java.lang.Number">parse</span><span class="delimiter">(</span><a href="#293022" title="String">x</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="comment">// try with grouping separator</span>
                    <span class="delimiter">}</span> <span class="keyword">catch</span> <span class="delimiter">{</span> <span class="keyword">case</span> <a title="CurrencyZone.this.Currency" id="293134">e</a>: java.text.<span title="java.text.ParseException">ParseException</span> =&gt; <span class="delimiter">{</span>
                                <a href="#292805" title="(x: BigDecimal)CurrencyZone.this.Currency">make</a><span class="delimiter">(</span><span title="(x: String)scala.math.BigDecimal">BigDecimal</span><span class="delimiter">(</span><span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span><span title="(x$1: Any)java.lang.String">+</span><span title="object java.text.NumberFormat">NumberFormat</span>.<span title="(x$1: java.util.Locale)java.text.NumberFormat">getCurrencyInstance</span><span class="delimiter">(</span><a href="#292804" title="=&gt; java.util.Locale">locale</a><span class="delimiter">)</span>.<span title="(x$1: java.lang.String)java.lang.Number">parse</span><span class="delimiter">(</span><a href="#293022" title="String">x</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">}</span> <span class="comment">// try with currency symbol and grouping separator</span>
                    <span class="delimiter">}</span>
                <span class="delimiter">}</span>
        <span class="delimiter">}</span>

    <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="(x: BigDecimal)CurrencyZone.this.Currency" id="292807">apply</a><span class="delimiter">(</span><a title="BigDecimal" id="293147">x</a>: <span title="BigDecimal">BigDecimal</span><span class="delimiter">)</span>: <a href="#292802" title="CurrencyZone.this.Currency">Currency</a> = <a href="#292805" title="(x: BigDecimal)CurrencyZone.this.Currency">make</a><span class="delimiter">(</span><a href="#293147" title="BigDecimal">x</a><span class="delimiter">)</span>

    <span class="comment">/* currency factory*/</span>
    <span class="keyword">abstract</span> <span class="keyword">class</span> <a title="class AbstractCurrency extends java.lang.Object with Ordered[CurrencyZone.this.Currency] with ScalaObject" id="292808">AbstractCurrency</a><a href="#292808" title="ScalaObject" class="delimiter">(</a><span class="keyword">val</span> <a title="String" id="292859">designation</a>: <span title="String">String</span><span class="delimiter">)</span> <span class="keyword">extends</span> <span title="Ordered[CurrencyZone.this.Currency]">Ordered</span><span class="delimiter">[</span>Currency<span class="delimiter">]</span> <span class="delimiter">{</span>

        <span class="keyword">val</span> <a title="java.util.Locale" id="292825">_locale</a>: <span title="java.util.Locale">Locale</span> = <a href="#292804" title="=&gt; java.util.Locale">locale</a>
        <span class="keyword">def</span> <a title="=&gt; BigDecimal" id="292827">amount</a>: <span title="BigDecimal">BigDecimal</span>
        <span class="keyword">def</span> <a title="=&gt; Float" id="292828">floatValue</a> = <a href="#292827" title="=&gt; BigDecimal">amount</a>.<span title="()Float">floatValue</span>
        <span class="keyword">def</span> <a title="=&gt; Double" id="292829">doubleValue</a> = <a href="#292827" title="=&gt; BigDecimal">amount</a>.<span title="()Double">doubleValue</span>
        <span class="keyword">def</span> <a title="=&gt; String" id="292830">currencySymbol</a>: <span title="String">String</span>
        <span class="keyword">def</span> <a title="=&gt; Int" id="292831">numberOfFractionDigits</a>: <span title="Int">Int</span>
        <span class="keyword">def</span> <a title="=&gt; Int" id="292832">scale</a>: <span title="Int">Int</span>

        <span class="keyword">def</span> <a title="(that: CurrencyZone.this.Currency)CurrencyZone.this.Currency" id="292833">+</a><span class="delimiter">(</span><a title="CurrencyZone.this.Currency" id="293159">that</a>: <a href="#292802" title="CurrencyZone.this.Currency">Currency</a><span class="delimiter">)</span>: <a href="#292802" title="CurrencyZone.this.Currency">Currency</a> = <a href="#292805" title="(x: BigDecimal)CurrencyZone.this.Currency">make</a><span class="delimiter">(</span><a href="#292808" title="AbstractCurrency.this.type" class="keyword">this</a>.<a href="#292827" title="=&gt; BigDecimal">amount</a> <span title="(that: scala.math.BigDecimal)scala.math.BigDecimal">+</span> <a href="#293159" title="CurrencyZone.this.Currency">that</a>.<a href="#292827" title="=&gt; BigDecimal">amount</a><span class="delimiter">)</span>
        <span class="keyword">def</span> <a title="(that: Int)CurrencyZone.this.Currency" id="292834">+</a><span class="delimiter">(</span><a title="Int" id="293161">that</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <a href="#292802" title="CurrencyZone.this.Currency">Currency</a> = <a href="#292808" title="AbstractCurrency.this.type" class="keyword">this</a> <a href="#292833" title="(that: CurrencyZone.this.Currency)CurrencyZone.this.Currency">+</a> <a href="#292805" title="(x: BigDecimal)CurrencyZone.this.Currency">make</a><span class="delimiter">(</span><a href="#293161" title="implicit scala.math.BigDecimal.int2bigDecimal : (i: Int)scala.math.BigDecimal">that</a><span class="delimiter">)</span>

        <span class="keyword">def</span> <a title="(that: CurrencyZone.this.Currency)CurrencyZone.this.Currency" id="292835">*</a><span class="delimiter">(</span><a title="CurrencyZone.this.Currency" id="293168">that</a>: <a href="#292802" title="CurrencyZone.this.Currency">Currency</a><span class="delimiter">)</span>: <a href="#292802" title="CurrencyZone.this.Currency">Currency</a> = <a href="#292805" title="(x: BigDecimal)CurrencyZone.this.Currency">make</a><span class="delimiter">(</span><a href="#292808" title="AbstractCurrency.this.type" class="keyword">this</a>.<a href="#292827" title="=&gt; BigDecimal">amount</a> <span title="(that: scala.math.BigDecimal)scala.math.BigDecimal">*</span> <a href="#293168" title="CurrencyZone.this.Currency">that</a>.<a href="#292827" title="=&gt; BigDecimal">amount</a><span class="delimiter">)</span>
        <span class="keyword">def</span> <a title="(that: Int)CurrencyZone.this.Currency" id="292836">*</a><span class="delimiter">(</span><a title="Int" id="293170">that</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <a href="#292802" title="CurrencyZone.this.Currency">Currency</a> = <a href="#292808" title="AbstractCurrency.this.type" class="keyword">this</a> <a href="#292835" title="(that: CurrencyZone.this.Currency)CurrencyZone.this.Currency">*</a> <a href="#292805" title="(x: BigDecimal)CurrencyZone.this.Currency">make</a><span class="delimiter">(</span><a href="#293170" title="implicit scala.math.BigDecimal.int2bigDecimal : (i: Int)scala.math.BigDecimal">that</a><span class="delimiter">)</span>

        <span class="keyword">def</span> <a title="(that: CurrencyZone.this.Currency)CurrencyZone.this.Currency" id="292837">-</a><span class="delimiter">(</span><a title="CurrencyZone.this.Currency" id="293176">that</a>: <a href="#292802" title="CurrencyZone.this.Currency">Currency</a><span class="delimiter">)</span>: <a href="#292802" title="CurrencyZone.this.Currency">Currency</a> = <a href="#292805" title="(x: BigDecimal)CurrencyZone.this.Currency">make</a><span class="delimiter">(</span><a href="#292808" title="AbstractCurrency.this.type" class="keyword">this</a>.<a href="#292827" title="=&gt; BigDecimal">amount</a> <span title="(that: scala.math.BigDecimal)scala.math.BigDecimal">-</span> <a href="#293176" title="CurrencyZone.this.Currency">that</a>.<a href="#292827" title="=&gt; BigDecimal">amount</a><span class="delimiter">)</span>
        <span class="keyword">def</span> <a title="(that: Int)CurrencyZone.this.Currency" id="292838">-</a><span class="delimiter">(</span><a title="Int" id="293178">that</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <a href="#292802" title="CurrencyZone.this.Currency">Currency</a> = <a href="#292808" title="AbstractCurrency.this.type" class="keyword">this</a> <a href="#292837" title="(that: CurrencyZone.this.Currency)CurrencyZone.this.Currency">-</a> <a href="#292805" title="(x: BigDecimal)CurrencyZone.this.Currency">make</a><span class="delimiter">(</span><a href="#293178" title="implicit scala.math.BigDecimal.int2bigDecimal : (i: Int)scala.math.BigDecimal">that</a><span class="delimiter">)</span>

        <span class="keyword">def</span> <a title="(that: CurrencyZone.this.Currency)CurrencyZone.this.Currency" id="292839">/</a><span class="delimiter">(</span><a title="CurrencyZone.this.Currency" id="293184">that</a>: <a href="#292802" title="CurrencyZone.this.Currency">Currency</a><span class="delimiter">)</span>: <a href="#292802" title="CurrencyZone.this.Currency">Currency</a> =
        <a href="#292805" title="(x: BigDecimal)CurrencyZone.this.Currency">make</a><span class="delimiter">(</span><span title="(bigDecimal: java.math.BigDecimal)scala.math.BigDecimal" class="keyword">new</span> <span title="scala.math.BigDecimal">BigDecimal</span><span class="delimiter">(</span><a href="#292808" title="AbstractCurrency.this.type" class="keyword">this</a>.<a href="#292827" title="=&gt; BigDecimal">amount</a>.<span title="=&gt; java.math.BigDecimal">bigDecimal</span>.<span title="(x$1: java.math.BigDecimal, x$2: Int, x$3: Int)java.math.BigDecimal">divide</span><span class="delimiter">(</span><a href="#293184" title="CurrencyZone.this.Currency">that</a>.<a href="#292827" title="=&gt; BigDecimal">amount</a>.<span title="=&gt; java.math.BigDecimal">bigDecimal</span>, <a href="#292832" title="=&gt; Int">scale</a>, java.math.BigDecimal.<span title="Int(4)">ROUND_HALF_UP</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">)</span>
        <span class="keyword">def</span> <a title="(that: Int)CurrencyZone.this.Currency" id="292840">/</a><span class="delimiter">(</span><a title="Int" id="293192">that</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <a href="#292802" title="CurrencyZone.this.Currency">Currency</a> = <a href="#292808" title="AbstractCurrency.this.type" class="keyword">this</a> <a href="#292839" title="(that: CurrencyZone.this.Currency)CurrencyZone.this.Currency">/</a> <a href="#292805" title="(x: BigDecimal)CurrencyZone.this.Currency">make</a><span class="delimiter">(</span><a href="#293192" title="implicit scala.math.BigDecimal.int2bigDecimal : (i: Int)scala.math.BigDecimal">that</a><span class="delimiter">)</span>

        <span class="keyword">def</span> <a title="(that: CurrencyZone.this.Currency)Int" id="292841">compare</a><span class="delimiter">(</span><a title="CurrencyZone.this.Currency" id="292902">that</a>: <a href="#292802" title="CurrencyZone.this.Currency">Currency</a><span class="delimiter">)</span> = <a href="#292808" title="AbstractCurrency.this.type" class="keyword">this</a>.<a href="#292827" title="=&gt; BigDecimal">amount</a> <span title="(that: scala.math.BigDecimal)Int">compare</span> <a href="#292902" title="CurrencyZone.this.Currency">that</a>.<a href="#292827" title="=&gt; BigDecimal">amount</a>

        <span class="keyword">override</span> <span class="keyword">def</span> <a title="(that: Any)Boolean" id="292842">equals</a><span class="delimiter">(</span><a title="Any" id="292876">that</a>: <span title="Any">Any</span><span class="delimiter">)</span> = <a href="#292876" title="Any">that</a> <span title="Boolean" class="keyword">match</span> <span class="delimiter">{</span>
            <span class="keyword">case</span> <a title="Boolean" id="292879">that</a>: <a href="#292808" title="CurrencyZone.this.AbstractCurrency">AbstractCurrency</a> =&gt; <a href="#292808" title="AbstractCurrency.this.type" class="keyword">this</a>.<a href="#292859" title="=&gt; String">designation</a><span title="(x$1: Any)java.lang.String">+</span><a href="#292808" title="AbstractCurrency.this.type" class="keyword">this</a>.<a href="#292848" title="(currencySymbol: String, numberOfFractionDigits: Int)String">format</a><span class="delimiter">(</span><span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span>, <a href="#292832" title="=&gt; Int">scale</a><span class="delimiter">)</span> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#292879" title="CurrencyZone.this.AbstractCurrency">that</a>.<a href="#292859" title="=&gt; String">designation</a><span title="(x$1: Any)java.lang.String">+</span><a href="#292879" title="CurrencyZone.this.AbstractCurrency">that</a>.<a href="#292848" title="(currencySymbol: String, numberOfFractionDigits: Int)String">format</a><span class="delimiter">(</span><span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span>, <a href="#292832" title="=&gt; Int">scale</a><span class="delimiter">)</span>
            <span class="keyword">case</span> <span title="Boolean(false)">_</span> =&gt; <span title="Boolean(false)" class="keyword">false</span>
        <span class="delimiter">}</span>

        <span class="keyword">override</span> <span class="keyword">def</span> <a title="()Int" id="292843">hashCode</a> = <span class="delimiter">(</span><a href="#292808" title="AbstractCurrency.this.type" class="keyword">this</a>.<a href="#292859" title="=&gt; String">designation</a><span title="(x$1: Any)java.lang.String">+</span><a href="#292848" title="(currencySymbol: String, numberOfFractionDigits: Int)String">format</a><span class="delimiter">(</span><span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span>, <a href="#292832" title="=&gt; Int">scale</a><span class="delimiter">)</span><span class="delimiter">)</span>.<span title="()Int">hashCode</span>

        <span class="keyword">def</span> <a title="(precision: Int)CurrencyZone.this.Currency" id="292844">round</a><span class="delimiter">(</span><a title="Int" id="293198">precision</a>: <span title="Int">Int</span><span class="delimiter">)</span> = <a href="#292805" title="(x: BigDecimal)CurrencyZone.this.Currency">make</a><span class="delimiter">(</span><span title="(x: String)scala.math.BigDecimal">BigDecimal</span><span class="delimiter">(</span><a href="#292850" title="(numberOfFractionDigits: Int)String">get</a><span class="delimiter">(</span><a href="#293198" title="Int">precision</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>

        <span class="keyword">override</span> <span class="keyword">def</span> <a title="()String" id="292845">toString</a> = <a href="#292848" title="(currencySymbol: String, numberOfFractionDigits: Int)String">format</a><span class="delimiter">(</span><span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span>, <a href="#292831" title="=&gt; Int">numberOfFractionDigits</a><span class="delimiter">)</span>

        <span class="keyword">def</span> <a title="(fd: Int)String" id="292846">format</a><span class="delimiter">(</span><a title="Int" id="292872">fd</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="String">String</span> = <a href="#292848" title="(currencySymbol: String, numberOfFractionDigits: Int)String">format</a><span class="delimiter">(</span><a href="#292830" title="=&gt; String">currencySymbol</a>, <a href="#292872" title="Int">fd</a><span class="delimiter">)</span>

        <span class="keyword">def</span> <a title="=&gt; String" id="292847">format</a>: <span title="String">String</span> = <a href="#292848" title="(currencySymbol: String, numberOfFractionDigits: Int)String">format</a><span class="delimiter">(</span><a href="#292830" title="=&gt; String">currencySymbol</a>, <a href="#292831" title="=&gt; Int">numberOfFractionDigits</a><span class="delimiter">)</span>

        <span class="keyword">def</span> <a title="(currencySymbol: String, numberOfFractionDigits: Int)String" id="292848">format</a><span class="delimiter">(</span><a title="String" id="292867">currencySymbol</a>: <span title="String">String</span>, <a title="Int" id="292868">numberOfFractionDigits</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="String">String</span> = <span class="delimiter">{</span>
            <span class="keyword">val</span> <a title="Double" id="293225">moneyValue</a> = <a href="#292827" title="=&gt; BigDecimal">amount</a> <span title="Double" class="keyword">match</span> <span class="delimiter">{</span>
                <span class="keyword">case</span> <span title="Int(0)" class="keyword">null</span> =&gt; <span title="Double(0.0)" class="int">0</span>
                <span class="keyword">case</span> <span title="Double">_</span> =&gt; <a href="#292827" title="=&gt; BigDecimal">amount</a>.<span title="(scale: Int, mode: scala.math.BigDecimal.RoundingMode.RoundingMode)scala.math.BigDecimal">setScale</span><span class="delimiter">(</span><a href="#292868" title="Int">numberOfFractionDigits</a>, <span title="=&gt; math.BigDecimal.type">BigDecimal</span>.<span title="object BigDecimal.RoundingMode">RoundingMode</span>.<span title="=&gt; BigDecimal.RoundingMode.Value">HALF_UP</span><span class="delimiter">)</span>.<span title="()Double">doubleValue</span>;
            <span class="delimiter">}</span>

            <span class="keyword">val</span> <a title="java.text.NumberFormat" id="293226">numberFormat</a> = <span title="object java.text.NumberFormat">NumberFormat</span>.<span title="(x$1: java.util.Locale)java.text.NumberFormat">getCurrencyInstance</span><span class="delimiter">(</span><a href="#292825" title="=&gt; java.util.Locale">_locale</a><span class="delimiter">)</span>;
            <a href="#293226" title="java.text.NumberFormat">numberFormat</a>.<span title="(x$1: Int)Unit">setMinimumFractionDigits</span><span class="delimiter">(</span><a href="#292868" title="Int">numberOfFractionDigits</a><span class="delimiter">)</span>;
            <a href="#293226" title="java.text.NumberFormat">numberFormat</a>.<span title="(x$1: Int)Unit">setMaximumFractionDigits</span><span class="delimiter">(</span><a href="#292868" title="Int">numberOfFractionDigits</a><span class="delimiter">)</span>;
            <span class="keyword">val</span> <a title="java.lang.String" id="293227">symbol</a>=<a href="#293226" title="java.text.NumberFormat">numberFormat</a>.<span title="()java.util.Currency">getCurrency</span>.<span title="(x$1: java.util.Locale)java.lang.String">getSymbol</span><span class="delimiter">(</span><a href="#292825" title="=&gt; java.util.Locale">_locale</a><span class="delimiter">)</span>
            <a href="#293226" title="java.text.NumberFormat">numberFormat</a>.<span title="(x$1: Double)java.lang.String">format</span><span class="delimiter">(</span><a href="#293225" title="Double">moneyValue</a><span class="delimiter">)</span>.<span title="(x$1: java.lang.CharSequence, x$2: java.lang.CharSequence)java.lang.String">replace</span><span class="delimiter">(</span><a href="#293227" title="java.lang.String">symbol</a>, <a href="#292867" title="String">currencySymbol</a><span class="delimiter">)</span>

        <span class="delimiter">}</span>

        <span class="keyword">def</span> <a title="=&gt; String" id="292849">get</a>: <span title="String">String</span> = <a href="#292850" title="(numberOfFractionDigits: Int)String">get</a><span class="delimiter">(</span><a href="#292831" title="=&gt; Int">numberOfFractionDigits</a><span class="delimiter">)</span>

        <span class="keyword">def</span> <a title="(numberOfFractionDigits: Int)String" id="292850">get</a><span class="delimiter">(</span><a title="Int" id="293213">numberOfFractionDigits</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="String">String</span> = <span class="delimiter">{</span>
            <span class="keyword">val</span> <a title="java.text.NumberFormat" id="293283">nf</a> = <span title="object java.text.NumberFormat">NumberFormat</span>.<span title="(x$1: java.util.Locale)java.text.NumberFormat">getNumberInstance</span><span class="delimiter">(</span><a href="#292825" title="=&gt; java.util.Locale">_locale</a><span class="delimiter">)</span>
            <span class="keyword">val</span> <a title="java.text.DecimalFormat" id="293284">df</a> = <a href="#293283" title="java.text.NumberFormat">nf</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="java.text.DecimalFormat" class="delimiter">[</span><span title="java.text.DecimalFormat">DecimalFormat</span><span class="delimiter">]</span>
            <span class="keyword">val</span> <a title="Char" id="293285">groupingSeparator</a> = <a href="#293284" title="java.text.DecimalFormat">df</a>.<span title="()java.text.DecimalFormatSymbols">getDecimalFormatSymbols</span>.<span title="()Char">getGroupingSeparator</span>

            <a href="#292848" title="(currencySymbol: String, numberOfFractionDigits: Int)String">format</a><span class="delimiter">(</span><span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span>, <a href="#293213" title="Int">numberOfFractionDigits</a><span class="delimiter">)</span>.<span title="(x$1: java.lang.String, x$2: java.lang.String)java.lang.String">replaceAll</span><span class="delimiter">(</span><a href="#293285" title="Char">groupingSeparator</a><span title="(x: String)String">+</span><span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span>, <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span><span class="delimiter">)</span>;
        <span class="delimiter">}</span>

    <span class="delimiter">}</span>

<span class="delimiter">}</span>

        </pre>
    </body>
</html>