<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>couchdb/net/liftweb/couchdb/JSONRecord.scala</title>
        <script type="text/javascript" src="../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/*
 * Copyright 2010-2011 WorldWide Conferencing, LLC
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */</span>

<span class="keyword">package</span> net.liftweb
<span class="keyword">package</span> couchdb

<span class="keyword">import</span> java.math.MathContext
<span class="keyword">import</span> java.util.Calendar
<span class="keyword">import</span> scala.collection.immutable.TreeSet
<span class="keyword">import</span> scala.reflect.Manifest
<span class="keyword">import</span> scala.xml.NodeSeq
<span class="keyword">import</span> net.liftweb.common.<span class="delimiter">{</span>Box, Empty, Failure, Full<span class="delimiter">}</span>
<span class="keyword">import</span> <a href="../../../../common/net/liftweb/common/Box.scala.html#10572" title="object net.liftweb.common.Box">Box</a>.<span class="delimiter">{</span>box2Iterable, option2Box<span class="delimiter">}</span>
<span class="keyword">import</span> net.liftweb.http.js.<span class="delimiter">{</span>JsExp, JsObj<span class="delimiter">}</span>
<span class="keyword">import</span> net.liftweb.json.JsonParser
<span class="keyword">import</span> net.liftweb.json.<a href="../../../../json/net/liftweb/json/JsonAST.scala.html#11132" title="object net.liftweb.json.JsonAST">JsonAST</a>._
<span class="keyword">import</span> net.liftweb.record.<span class="delimiter">{</span>Field, MandatoryTypedField, MetaRecord, Record<span class="delimiter">}</span>
<span class="keyword">import</span> net.liftweb.record.<a href="../../../../record/net/liftweb/record/RecordHelpers.scala.html#12542" title="object net.liftweb.record.RecordHelpers">RecordHelpers</a>.jvalueToJsExp
<span class="keyword">import</span> net.liftweb.record.<a href="../../../../record/net/liftweb/record/Field.scala.html#12471" title="object net.liftweb.record.FieldHelpers">FieldHelpers</a>.expectedA
<span class="keyword">import</span> net.liftweb.record.field._
<span class="keyword">import</span> net.liftweb.util.ThreadGlobal
<span class="keyword">import</span> net.liftweb.util.<a href="../../../../util/net/liftweb/util/Helpers.scala.html#13346" title="object net.liftweb.util.Helpers">Helpers</a>._
<span class="keyword">import</span> java.util.prefs.BackingStoreException

<span class="keyword">private</span><span class="delimiter">[</span>couchdb<span class="delimiter">]</span> <span class="keyword">object</span> <a title="object net.liftweb.couchdb.JSONRecordHelpers" id="10864">JSONRecordHelpers</a> <span title="ScalaObject" class="delimiter">{</span>

  <span class="comment">/** Remove duplicate fields, preferring the first field seen with a given name */</span>
  <span class="keyword">def</span> <a title="(fields: List[net.liftweb.json.JsonAST.JField])List[net.liftweb.json.JsonAST.JField]" id="48769">dedupe</a><span class="delimiter">(</span><a title="List[net.liftweb.json.JsonAST.JField]" id="55745">fields</a>: <span title="List[net.liftweb.json.JsonAST.JField]">List</span><span class="delimiter">[</span>JField<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="List[net.liftweb.json.JsonAST.JField]">List</span><span class="delimiter">[</span>JField<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">var</span> <a title="scala.collection.immutable.TreeSet[String]" id="55747">seen</a> = <span title="object scala.collection.immutable.TreeSet">TreeSet</span>.<span title="[A](implicit ordering: Ordering[A])scala.collection.immutable.TreeSet[A]">empty</span><span title="(implicit ordering: Ordering[String])scala.collection.immutable.TreeSet[String]" class="delimiter">[</span><span title="String">String</span><span class="delimiter">]</span>
    <a href="#55745" title="List[net.liftweb.json.JsonAST.JField]">fields</a>.<span title="(p: net.liftweb.json.JsonAST.JField =&gt; Boolean)List[net.liftweb.json.JsonAST.JField]">filter</span> <a href="#57278" title="Boolean" class="delimiter">{</a>
      <span class="keyword">case</span> <span title="Boolean(false)">JField</span><span class="delimiter">(</span><a title="String" id="57281">name</a>, _<span class="delimiter">)</span> <span class="keyword">if</span> <a href="#55747" title="scala.collection.immutable.TreeSet[String]">seen</a> <span title="(elem: String)Boolean">contains</span> <a href="#57281" title="String">name</a> =&gt; <span title="Boolean(false)" class="keyword">false</span>
      <span class="keyword">case</span> <span title="Boolean">JField</span><span class="delimiter">(</span><a title="String" id="57944">name</a>, _<span class="delimiter">)</span> =&gt; <span class="delimiter">{</span> <a href="#55747" title="scala.collection.immutable.TreeSet[String]">seen</a> = <a href="#55747" title="scala.collection.immutable.TreeSet[String]">seen</a> <span title="(elem: String)scala.collection.immutable.TreeSet[String]">+</span> <a href="#57944" title="String">name</a>; <span title="Boolean(true)" class="keyword">true</span> <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="keyword">import</span> <a href="#10864" title="object net.liftweb.couchdb.JSONRecordHelpers">JSONRecordHelpers</a>._

<span class="comment">/** Specialized Record that can be encoded and decoded from JSON */</span>
<span class="keyword">trait</span> <a title="trait JSONRecord[MyType &lt;: net.liftweb.couchdb.JSONRecord[MyType]] extends java.lang.Object with net.liftweb.record.Record[MyType] with ScalaObject" id="10867">JSONRecord</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: net.liftweb.couchdb.JSONRecord[MyType]" id="10868">MyType</a> &lt;: JSONRecord<span class="delimiter">[</span>MyType<span class="delimiter">]</span><span class="delimiter">]</span> <span title="ScalaObject" class="keyword">extends</span> <a href="../../../../record/net/liftweb/record/Record.scala.html#12529" title="net.liftweb.record.Record[MyType]">Record</a><span class="delimiter">[</span>MyType<span class="delimiter">]</span> <span class="delimiter">{</span>
  self: MyType =&gt;
  
  <span class="keyword">private</span> <span class="keyword">var</span> <a title="List[net.liftweb.json.JsonAST.JField]" id="49139">_additionalJFields</a>: <span title="List[net.liftweb.json.JsonAST.JField]">List</span><span class="delimiter">[</span>JField<span class="delimiter">]</span> = <span title="object Nil">Nil</span>

  <span class="comment">/** Refines meta to require a JSONMetaRecord */</span>
  <span class="keyword">def</span> <a title="=&gt; net.liftweb.couchdb.JSONMetaRecord[MyType]" id="49141">meta</a>: <a href="#10871" title="net.liftweb.couchdb.JSONMetaRecord[MyType]">JSONMetaRecord</a><span class="delimiter">[</span>MyType<span class="delimiter">]</span>

  <span class="comment">/** Extra fields to add to the encoded object, such as type. Default is none (Nil) */</span>
  <span class="keyword">def</span> <a title="=&gt; List[net.liftweb.json.JsonAST.JField]" id="49142">fixedAdditionalJFields</a>: <span title="List[net.liftweb.json.JsonAST.JField]">List</span><span class="delimiter">[</span>JField<span class="delimiter">]</span> = <span title="object Nil">Nil</span>

  <span class="comment">/**
   * Additional fields that are not represented by Record fields, nor are fixed additional fields.
   * Default implementation is for preserving unknown fields across read/write
   */</span>
  <span class="keyword">def</span> <a title="=&gt; List[net.liftweb.json.JsonAST.JField]" id="49143">additionalJFields</a>: <span title="List[net.liftweb.json.JsonAST.JField]">List</span><span class="delimiter">[</span>JField<span class="delimiter">]</span> = <a href="#49139" title="=&gt; List[net.liftweb.json.JsonAST.JField]">_additionalJFields</a>

  <span class="comment">/**
   * Handle any additional fields that are not represented by Record fields when decoding from a JObject.
   * Default implementation preserves the fields intact and returns them via additionalJFields
   */</span>
  <span class="keyword">def</span> <a title="(fields: List[net.liftweb.json.JsonAST.JField])Unit" id="49144">additionalJFields_=</a> <span class="delimiter">(</span><a title="List[net.liftweb.json.JsonAST.JField]" id="57967">fields</a>: <span title="List[net.liftweb.json.JsonAST.JField]">List</span><span class="delimiter">[</span>JField<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <a href="#49139" title="(x$1: List[net.liftweb.json.JsonAST.JField])Unit">_additionalJFields</a> = <a href="#57967" title="List[net.liftweb.json.JsonAST.JField]">fields</a>



 <span class="comment">/**
  * Save the instance and return the instance
  */</span>
  <span class="keyword">override</span> <span class="keyword">def</span> <a title="()net.liftweb.common.Box[MyType]" id="49145">saveTheRecord</a><span class="delimiter">(</span><span class="delimiter">)</span>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[MyType]">Box</a><span class="delimiter">[</span>MyType<span class="delimiter">]</span> = <span title="Nothing" class="keyword">throw</span> <span title="java.util.prefs.BackingStoreException" class="keyword">new</span> <span title="java.util.prefs.BackingStoreException">BackingStoreException</span><span class="delimiter">(</span><span title="java.lang.String(&quot;JSON Records don\'t save themselves&quot;)" class="string">&quot;JSON Records don't save themselves&quot;</span><span class="delimiter">)</span>
<span class="delimiter">}</span>

<span class="keyword">object</span> <a title="object net.liftweb.couchdb.JSONMetaRecord" id="10869">JSONMetaRecord</a> <span title="ScalaObject" class="delimiter">{</span>
  <span class="comment">/** Local override to record parsing that can cause extra fields to be ignored, even if they otherwise would cause a failure */</span>
  <span class="keyword">object</span> <a title="object net.liftweb.couchdb.JSONMetaRecord.overrideIgnoreExtraJSONFields" id="51263">overrideIgnoreExtraJSONFields</a> <span title="ScalaObject" class="keyword">extends</span> <a href="../../../../util/net/liftweb/util/ThreadGlobal.scala.html#13699" title="net.liftweb.util.ThreadGlobal[Boolean]">ThreadGlobal</a><span class="delimiter">[</span>Boolean<span class="delimiter">]</span>

  <span class="comment">/** Local override to record parsing that can cause missing fields to be ignored, even if they otherwise would cause a failure */</span>
  <span class="keyword">object</span> <a title="object net.liftweb.couchdb.JSONMetaRecord.overrideNeedAllJSONFields" id="51265">overrideNeedAllJSONFields</a> <span title="ScalaObject" class="keyword">extends</span> <a href="../../../../util/net/liftweb/util/ThreadGlobal.scala.html#13699" title="net.liftweb.util.ThreadGlobal[Boolean]">ThreadGlobal</a><span class="delimiter">[</span>Boolean<span class="delimiter">]</span>
<span class="delimiter">}</span>

<span class="comment">/** Specialized MetaRecord that deals with JSONRecords */</span>
<span class="keyword">trait</span> <a title="trait JSONMetaRecord[BaseRecord &lt;: net.liftweb.couchdb.JSONRecord[BaseRecord]] extends java.lang.Object with net.liftweb.record.MetaRecord[BaseRecord] with ScalaObject" id="10871">JSONMetaRecord</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: net.liftweb.couchdb.JSONRecord[BaseRecord]" id="10872">BaseRecord</a> &lt;: JSONRecord<span class="delimiter">[</span>BaseRecord<span class="delimiter">]</span><span class="delimiter">]</span> <span title="ScalaObject" class="keyword">extends</span> <a href="../../../../record/net/liftweb/record/MetaRecord.scala.html#12493" title="net.liftweb.record.MetaRecord[BaseRecord]">MetaRecord</a><span class="delimiter">[</span>BaseRecord<span class="delimiter">]</span> <span class="delimiter">{</span>
  self: BaseRecord =&gt;

  <span class="comment">/**
   * Return the name of the field in the encoded JSON object. If the field implements JSONField and has overridden jsonName then
   * that will be used, otherwise the record field name
   */</span>
  <span class="keyword">def</span> <a title="(field: net.liftweb.record.Field[_, BaseRecord])String" id="49230">jsonName</a><span class="delimiter">(</span><a title="net.liftweb.record.Field[_, BaseRecord]" id="57982">field</a>: <a href="../../../../record/net/liftweb/record/Field.scala.html#12459" title="net.liftweb.record.Field[_, BaseRecord]">Field</a><span class="delimiter">[</span>_, BaseRecord<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="String">String</span> = <a href="#57982" title="net.liftweb.record.Field[_, BaseRecord]">field</a> <span title="String" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <span title="String" class="delimiter">(</span><a title="&lt;none&gt; extends net.liftweb.couchdb.JSONField with net.liftweb.record.Field[_$1,BaseRecord]" id="57988">jsonField</a>: <a href="#10873" title="net.liftweb.couchdb.JSONField">JSONField</a><span class="delimiter">)</span> =&gt; <a href="#57988" title="&lt;none&gt; extends net.liftweb.couchdb.JSONField with net.liftweb.record.Field[_$1,BaseRecord]">jsonField</a>.<a href="#49909" title="=&gt; net.liftweb.common.Box[String]">jsonName</a> <a href="../../../../common/net/liftweb/common/Box.scala.html#27017" title="(default: =&gt; String)String">openOr</a> <a href="#57982" title="net.liftweb.record.Field[_, BaseRecord]">field</a>.<a href="../../../../record/net/liftweb/record/Field.scala.html#49729" title="=&gt; String">name</a>
    <span class="keyword">case</span> <span title="String">_</span>                      =&gt;                           <a href="#57982" title="net.liftweb.record.Field[_, BaseRecord]">field</a>.<a href="../../../../record/net/liftweb/record/Field.scala.html#49729" title="=&gt; String">name</a>
  <span class="delimiter">}</span>

  <span class="comment">/** Whether or not extra fields in a JObject to decode is an error (false) or not (true). The default is true */</span>
  <span class="keyword">def</span> <a title="=&gt; Boolean" id="49231">ignoreExtraJSONFields</a>: <span title="Boolean">Boolean</span> = <span title="Boolean(true)" class="keyword">true</span>

  <span class="comment">/** Whether or not missing fields in a JObject to decode is an error (false) or not (true). The default is true */</span>
  <span class="keyword">def</span> <a title="=&gt; Boolean" id="49232">needAllJSONFields</a>: <span title="Boolean">Boolean</span> = <span title="Boolean(true)" class="keyword">true</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(inst: BaseRecord)net.liftweb.http.js.JsObj" id="49233">asJSON</a><span class="delimiter">(</span><a title="BaseRecord" id="58003">inst</a>: <a href="#10872" title="BaseRecord">BaseRecord</a><span class="delimiter">)</span>: <a href="../../../../webkit/net/liftweb/http/js/JsCommands.scala.html#14905" title="net.liftweb.http.js.JsObj">JsObj</a> = <a href="../../../../record/net/liftweb/record/RecordHelpers.scala.html#55621" title="implicit net.liftweb.record.RecordHelpers.jvalueToJsExp : (jvalue: net.liftweb.json.JsonAST.JValue)net.liftweb.http.js.JsExp">jvalueToJsExp</a><span class="delimiter">(</span><a href="../../../../record/net/liftweb/record/Record.scala.html#49129" title="=&gt; net.liftweb.json.JsonAST.JObject">asJValue</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="net.liftweb.http.js.JsObj" class="delimiter">[</span><a href="../../../../webkit/net/liftweb/http/js/JsCommands.scala.html#14905" title="net.liftweb.http.js.JsObj">JsObj</a><span class="delimiter">]</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(inst: BaseRecord, json: String)net.liftweb.common.Box[Unit]" id="49234">setFieldsFromJSON</a><span class="delimiter">(</span><a title="BaseRecord" id="58042">inst</a>: <a href="#10872" title="BaseRecord">BaseRecord</a>, <a title="String" id="58043">json</a>: <span title="String">String</span><span class="delimiter">)</span>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[Unit]">Box</a><span class="delimiter">[</span>Unit<span class="delimiter">]</span> =
    <a href="#49236" title="(rec: BaseRecord, jvalue: net.liftweb.json.JsonAST.JValue)net.liftweb.common.Box[Unit]">setFieldsFromJValue</a><span class="delimiter">(</span><a href="#58042" title="BaseRecord">inst</a>, <a href="../../../../json/net/liftweb/json/JsonParser.scala.html#11146" title="object net.liftweb.json.JsonParser">JsonParser</a>.<a href="../../../../json/net/liftweb/json/JsonParser.scala.html#54535" title="(s: String)net.liftweb.json.package.JValue">parse</a><span class="delimiter">(</span><a href="#58043" title="String">json</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="comment">/** Encode a record instance into a JValue */</span>
  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(rec: BaseRecord)net.liftweb.json.JsonAST.JObject" id="49235">asJValue</a><span class="delimiter">(</span><a title="BaseRecord" id="58032">rec</a>: <a href="#10872" title="BaseRecord">BaseRecord</a><span class="delimiter">)</span>: <a href="../../../../json/net/liftweb/json/JsonAST.scala.html#48530" title="net.liftweb.json.JsonAST.JObject">JObject</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="List[net.liftweb.json.JsonAST.JField]" id="58109">recordJFields</a> = <a href="../../../../record/net/liftweb/record/MetaRecord.scala.html#49223" title="(rec: BaseRecord)List[net.liftweb.record.Field[_, BaseRecord]]">fields</a><span class="delimiter">(</span><a href="#58032" title="BaseRecord">rec</a><span class="delimiter">)</span>.<span title="(f: net.liftweb.record.Field[_, BaseRecord] =&gt; net.liftweb.json.JsonAST.JField)(implicit bf: scala.collection.generic.CanBuildFrom[List[net.liftweb.record.Field[_, BaseRecord]],net.liftweb.json.JsonAST.JField,List[net.liftweb.json.JsonAST.JField]])List[net.liftweb.json.JsonAST.JField]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.List.Coll,net.liftweb.json.JsonAST.JField,List[net.liftweb.json.JsonAST.JField]]" class="delimiter">(</span><a title="net.liftweb.record.Field[_, BaseRecord]" id="58146">f</a> =&gt; <a href="../../../../json/net/liftweb/json/JsonAST.scala.html#50050" title="(name: String, value: net.liftweb.json.JsonAST.JValue)net.liftweb.json.JsonAST.JField">JField</a><span class="delimiter">(</span><a href="#49230" title="(field: net.liftweb.record.Field[_, BaseRecord])String">jsonName</a><span class="delimiter">(</span><a href="#58146" title="net.liftweb.record.Field[_, BaseRecord]">f</a><span class="delimiter">)</span>, <a href="#58146" title="net.liftweb.record.Field[_, BaseRecord]">f</a>.<a href="../../../../record/net/liftweb/record/Field.scala.html#49737" title="=&gt; net.liftweb.json.JsonAST.JValue">asJValue</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="../../../../json/net/liftweb/json/JsonAST.scala.html#51392" title="(obj: List[net.liftweb.json.JsonAST.JField])net.liftweb.json.JsonAST.JObject">JObject</a><span class="delimiter">(</span><a href="#48769" title="(fields: List[net.liftweb.json.JsonAST.JField])List[net.liftweb.json.JsonAST.JField]">dedupe</a><span class="delimiter">(</span><a href="#58109" title="List[net.liftweb.json.JsonAST.JField]">recordJFields</a> <span title="(that: scala.collection.GenTraversableOnce[net.liftweb.json.JsonAST.JField])(implicit bf: scala.collection.generic.CanBuildFrom[List[net.liftweb.json.JsonAST.JField],net.liftweb.json.JsonAST.JField,List[net.liftweb.json.JsonAST.JField]])List[net.liftweb.json.JsonAST.JField]">++</span> <a href="#58032" title="BaseRecord">rec</a>.<a href="#49142" title="=&gt; List[net.liftweb.json.JsonAST.JField]">fixedAdditionalJFields</a> <span title="(that: scala.collection.GenTraversableOnce[net.liftweb.json.JsonAST.JField])(implicit bf: scala.collection.generic.CanBuildFrom[List[net.liftweb.json.JsonAST.JField],net.liftweb.json.JsonAST.JField,List[net.liftweb.json.JsonAST.JField]])List[net.liftweb.json.JsonAST.JField]">++</span> <a href="#58032" title="BaseRecord">rec</a>.<a href="#49143" title="=&gt; List[net.liftweb.json.JsonAST.JField]">additionalJFields</a><span class="delimiter">)</span>.<span title="(lt: (net.liftweb.json.JsonAST.JField, net.liftweb.json.JsonAST.JField) =&gt; Boolean)List[net.liftweb.json.JsonAST.JField]">sortWith</span><span class="delimiter">(</span><a href="#58341" title="net.liftweb.json.JsonAST.JField">_</a>.<a href="../../../../json/net/liftweb/json/JsonAST.scala.html#50112" title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps">name</a> <span title="(that: String)Boolean">&lt;</span> <a href="#58342" title="net.liftweb.json.JsonAST.JField">_</a>.<a href="../../../../json/net/liftweb/json/JsonAST.scala.html#50112" title="=&gt; String">name</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/** Attempt to decode a JValue, which must be a JObject, into a record instance */</span>
  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(rec: BaseRecord, jvalue: net.liftweb.json.JsonAST.JValue)net.liftweb.common.Box[Unit]" id="49236">setFieldsFromJValue</a><span class="delimiter">(</span><a title="BaseRecord" id="58052">rec</a>: <a href="#10872" title="BaseRecord">BaseRecord</a>, <a title="net.liftweb.json.JsonAST.JValue" id="58053">jvalue</a>: <a href="../../../../json/net/liftweb/json/JsonAST.scala.html#48510" title="net.liftweb.json.JsonAST.JValue">JValue</a><span class="delimiter">)</span>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[Unit]">Box</a><span class="delimiter">[</span>Unit<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="(jfields: List[net.liftweb.json.JsonAST.JField])net.liftweb.common.Box[Unit]" id="58538">fromJFields</a><span class="delimiter">(</span><a title="List[net.liftweb.json.JsonAST.JField]" id="58539">jfields</a>: <span title="List[net.liftweb.json.JsonAST.JField]">List</span><span class="delimiter">[</span>JField<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[Unit]">Box</a><span class="delimiter">[</span>Unit<span class="delimiter">]</span> = <span class="delimiter">{</span>
      <span class="keyword">import</span> <a href="#10869" title="object net.liftweb.couchdb.JSONMetaRecord">JSONMetaRecord</a>._

      <span class="keyword">val</span> <a title="List[net.liftweb.record.Field[_, BaseRecord]]" id="58541">flds</a> = <a href="../../../../record/net/liftweb/record/MetaRecord.scala.html#49223" title="(rec: BaseRecord)List[net.liftweb.record.Field[_, BaseRecord]]">fields</a><span class="delimiter">(</span><a href="#58052" title="BaseRecord">rec</a><span class="delimiter">)</span>
      <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="scala.collection.immutable.TreeSet[String]" id="58543">recordFieldNames</a> = <span title="(elems: String*)(implicit ord: Ordering[String])scala.collection.immutable.TreeSet[String]">TreeSet</span><span title="object scala.math.Ordering.String" class="delimiter">(</span><a href="#58541" title="List[net.liftweb.record.Field[_, BaseRecord]]">flds</a>.<span title="(f: net.liftweb.record.Field[_, BaseRecord] =&gt; String)(implicit bf: scala.collection.generic.CanBuildFrom[List[net.liftweb.record.Field[_, BaseRecord]],String,List[String]])List[String]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.List.Coll,String,List[String]]" class="delimiter">(</span><a href="#49230" title="(field: net.liftweb.record.Field[_, BaseRecord])String">jsonName</a><span class="delimiter">)</span>: _*<span class="delimiter">)</span>
      <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="scala.collection.immutable.TreeSet[String]" id="58545">jsonFieldNames</a> = <span title="(elems: String*)(implicit ord: Ordering[String])scala.collection.immutable.TreeSet[String]">TreeSet</span><span title="object scala.math.Ordering.String" class="delimiter">(</span><a href="#58539" title="List[net.liftweb.json.JsonAST.JField]">jfields</a>.<span title="(f: net.liftweb.json.JsonAST.JField =&gt; String)(implicit bf: scala.collection.generic.CanBuildFrom[List[net.liftweb.json.JsonAST.JField],String,List[String]])List[String]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.List.Coll,String,List[String]]" class="delimiter">(</span><a href="#58721" title="net.liftweb.json.JsonAST.JField">_</a>.<a href="../../../../json/net/liftweb/json/JsonAST.scala.html#50112" title="=&gt; String">name</a><span class="delimiter">)</span>: _*<span class="delimiter">)</span>
      <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="scala.collection.immutable.TreeSet[String]" id="58547">optionalFieldNames</a> = <span title="(elems: String*)(implicit ord: Ordering[String])scala.collection.immutable.TreeSet[String]">TreeSet</span><span title="object scala.math.Ordering.String" class="delimiter">(</span><a href="#58541" title="List[net.liftweb.record.Field[_, BaseRecord]]">flds</a>.<span title="(p: net.liftweb.record.Field[_, BaseRecord] =&gt; Boolean)List[net.liftweb.record.Field[_, BaseRecord]]">filter</span><span class="delimiter">(</span><a href="#58812" title="net.liftweb.record.Field[_, BaseRecord]">_</a>.<a href="../../../../record/net/liftweb/record/Field.scala.html#49728" title="=&gt; Boolean">optional_?</a><span class="delimiter">)</span>.<span title="(f: net.liftweb.record.Field[_, BaseRecord] =&gt; String)(implicit bf: scala.collection.generic.CanBuildFrom[List[net.liftweb.record.Field[_, BaseRecord]],String,List[String]])List[String]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.List.Coll,String,List[String]]" class="delimiter">(</span><a href="#49230" title="(field: net.liftweb.record.Field[_, BaseRecord])String">jsonName</a><span class="delimiter">)</span>: _*<span class="delimiter">)</span>
      <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="scala.collection.immutable.TreeSet[String]" id="58549">recordFieldsNotInJson</a> = <a href="#58542" title="=&gt; scala.collection.immutable.TreeSet[String]">recordFieldNames</a> <span title="(xs: scala.collection.GenTraversableOnce[String])scala.collection.immutable.TreeSet[String]">--</span> <a href="#58544" title="=&gt; scala.collection.immutable.TreeSet[String]">jsonFieldNames</a> <span title="(xs: scala.collection.GenTraversableOnce[String])scala.collection.immutable.TreeSet[String]">--</span> <a href="#58546" title="=&gt; scala.collection.immutable.TreeSet[String]">optionalFieldNames</a>
      <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="scala.collection.immutable.TreeSet[String]" id="58551">jsonFieldsNotInRecord</a> = <a href="#58544" title="=&gt; scala.collection.immutable.TreeSet[String]">jsonFieldNames</a> <span title="(xs: scala.collection.GenTraversableOnce[String])scala.collection.immutable.TreeSet[String]">--</span> <a href="#58542" title="=&gt; scala.collection.immutable.TreeSet[String]">recordFieldNames</a>
      
      <span class="comment">// If this record type has been configured to be stricter about fields, check those first</span>
      <span title="net.liftweb.common.Box[Unit]" class="keyword">if</span> <span class="delimiter">(</span><span class="delimiter">(</span><a href="#51265" title="object net.liftweb.couchdb.JSONMetaRecord.overrideNeedAllJSONFields">overrideNeedAllJSONFields</a>.<a href="../../../../util/net/liftweb/util/ThreadGlobal.scala.html#51271" title="=&gt; net.liftweb.common.Box[Boolean]">box</a> <a href="../../../../common/net/liftweb/common/Box.scala.html#27017" title="(default: =&gt; Boolean)Boolean">openOr</a> <a href="#49232" title="=&gt; Boolean">needAllJSONFields</a><span class="delimiter">)</span> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <span title="=&gt; Boolean">!</span><a href="#58548" title="=&gt; scala.collection.immutable.TreeSet[String]">recordFieldsNotInJson</a>.<span title="=&gt; Boolean">isEmpty</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="../../../../common/net/liftweb/common/Box.scala.html#37829" title="(msg: String)net.liftweb.common.Failure">Failure</a><span class="delimiter">(</span><span title="java.lang.String(&quot;The &quot;)" class="string">&quot;The &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#58548" title="=&gt; scala.collection.immutable.TreeSet[String]">recordFieldsNotInJson</a>.<span title="(sep: String)String">mkString</span><span class="delimiter">(</span><span title="java.lang.String(&quot;, &quot;)" class="string">&quot;, &quot;</span><span class="delimiter">)</span> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot; field(s) were not found, but are required.&quot;)" class="string">&quot; field(s) were not found, but are required.&quot;</span><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span title="net.liftweb.common.Box[Unit]" class="keyword">if</span> <span class="delimiter">(</span><span title="=&gt; Boolean">!</span><span class="delimiter">(</span><a href="#51263" title="object net.liftweb.couchdb.JSONMetaRecord.overrideIgnoreExtraJSONFields">overrideIgnoreExtraJSONFields</a>.<a href="../../../../util/net/liftweb/util/ThreadGlobal.scala.html#51271" title="=&gt; net.liftweb.common.Box[Boolean]">box</a> <a href="../../../../common/net/liftweb/common/Box.scala.html#27017" title="(default: =&gt; Boolean)Boolean">openOr</a> <a href="#49231" title="=&gt; Boolean">ignoreExtraJSONFields</a><span class="delimiter">)</span> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <span title="=&gt; Boolean">!</span><a href="#58550" title="=&gt; scala.collection.immutable.TreeSet[String]">jsonFieldsNotInRecord</a>.<span title="=&gt; Boolean">isEmpty</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="../../../../common/net/liftweb/common/Box.scala.html#37829" title="(msg: String)net.liftweb.common.Failure">Failure</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Field(s) &quot;)" class="string">&quot;Field(s) &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#58550" title="=&gt; scala.collection.immutable.TreeSet[String]">jsonFieldsNotInRecord</a>.<span title="(sep: String)String">mkString</span><span class="delimiter">(</span><span title="java.lang.String(&quot;, &quot;)" class="string">&quot;, &quot;</span><span class="delimiter">)</span> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot; are not recognized.&quot;)" class="string">&quot; are not recognized.&quot;</span><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
        <span class="keyword">for</span> <span class="delimiter">{</span>
          <a title="net.liftweb.json.JsonAST.JField" id="59016">jfield</a> &lt;- <a href="#58539" title="(f: net.liftweb.json.JsonAST.JField =&gt; Unit)Unit">jfields</a>
          <a title="net.liftweb.record.Field[_, BaseRecord]" id="59032">field</a>  &lt;- <a href="#58541" title="(f: net.liftweb.record.Field[_, BaseRecord] =&gt; net.liftweb.common.Box[Any])Unit">flds</a> <span class="keyword">if</span> <a href="#49230" title="(field: net.liftweb.record.Field[_, BaseRecord])String">jsonName</a><span class="delimiter">(</span><a href="#59032" title="net.liftweb.record.Field[_, BaseRecord]">field</a><span class="delimiter">)</span> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#59016" title="net.liftweb.json.JsonAST.JField">jfield</a>.<a href="../../../../json/net/liftweb/json/JsonAST.scala.html#50112" title="=&gt; String">name</a>
        <span class="delimiter">}</span> <a href="#59032" title="net.liftweb.record.Field[_, BaseRecord]">field</a>.<a href="../../../../record/net/liftweb/record/Field.scala.html#49805" title="(jvalue: net.liftweb.json.JsonAST.JValue)net.liftweb.common.Box[field.MyType]">setFromJValue</a><span class="delimiter">(</span><a href="#59016" title="net.liftweb.json.JsonAST.JField">jfield</a>.<a href="../../../../json/net/liftweb/json/JsonAST.scala.html#50114" title="=&gt; net.liftweb.json.JsonAST.JValue">value</a><span class="delimiter">)</span>

        <a href="#58052" title="BaseRecord">rec</a>.<a href="#49144" title="(fields: List[net.liftweb.json.JsonAST.JField])Unit">additionalJFields</a> = <a href="#58550" title="=&gt; scala.collection.immutable.TreeSet[String]">jsonFieldsNotInRecord</a>.<span title="=&gt; List[String]">toList</span> <span title="(f: String =&gt; net.liftweb.json.JsonAST.JField)(implicit bf: scala.collection.generic.CanBuildFrom[List[String],net.liftweb.json.JsonAST.JField,List[net.liftweb.json.JsonAST.JField]])List[net.liftweb.json.JsonAST.JField]">map</span> <span class="delimiter">{</span>
          <a title="String" id="59056">name</a> =&gt; <a href="#58539" title="List[net.liftweb.json.JsonAST.JField]">jfields</a>.<span title="(p: net.liftweb.json.JsonAST.JField =&gt; Boolean)Option[net.liftweb.json.JsonAST.JField]">find</span><span class="delimiter">(</span><a href="#59063" title="net.liftweb.json.JsonAST.JField">_</a>.<a href="../../../../json/net/liftweb/json/JsonAST.scala.html#50112" title="=&gt; String">name</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#59056" title="String">name</a><span class="delimiter">)</span>.<span title="=&gt; net.liftweb.json.JsonAST.JField">get</span>
        <span class="delimiter">}</span>

        <a href="../../../../common/net/liftweb/common/Box.scala.html#27086" title="(value: Unit)net.liftweb.common.Full[Unit]">Full</a><span class="delimiter">(</span><span title="Unit" class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <a href="#58053" title="net.liftweb.json.JsonAST.JValue">jvalue</a> <span title="net.liftweb.common.Box[Unit]" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <span title="net.liftweb.common.Box[Unit]">JObject</span><span class="delimiter">(</span><a title="List[net.liftweb.json.JsonAST.JField]" id="59100">jfields</a><span class="delimiter">)</span> =&gt; <a href="#58538" title="(jfields: List[net.liftweb.json.JsonAST.JField])net.liftweb.common.Box[Unit]">fromJFields</a><span class="delimiter">(</span><a href="#59100" title="List[net.liftweb.json.JsonAST.JField]">jfields</a><span class="delimiter">)</span>
      <span class="keyword">case</span> <a title="net.liftweb.common.Failure" id="59101">other</a> =&gt; <a href="../../../../record/net/liftweb/record/Field.scala.html#55623" title="(what: String, notA: AnyRef)net.liftweb.common.Failure">expectedA</a><span class="delimiter">(</span><span title="java.lang.String(&quot;JObject&quot;)" class="string">&quot;JObject&quot;</span>, <a href="#59101" title="net.liftweb.json.JsonAST.JValue">other</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>      
  <span class="delimiter">}</span>
<span class="delimiter">}</span>
 
<span class="comment">/** Trait for fields with JSON-specific behavior */</span>
<span class="keyword">trait</span> <a title="trait JSONField extends java.lang.Object with ScalaObject" id="10873">JSONField</a> <span title="ScalaObject" class="delimiter">{</span>
  <span class="comment">/** Return Full(name) to use that name in the encoded JSON object, or Empty to use the same name as in Scala. Defaults to Empty */</span>
  <span class="keyword">def</span> <a title="=&gt; net.liftweb.common.Box[String]" id="49909">jsonName</a>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[String]">Box</a><span class="delimiter">[</span>String<span class="delimiter">]</span> = <a href="../../../../common/net/liftweb/common/Box.scala.html#10581" title="object net.liftweb.common.Empty">Empty</a>
<span class="delimiter">}</span>


<span class="comment">/* ****************************************************************************************************************************************** */</span>


<span class="comment">/** Field that contains an entire record represented as an inline object value in the final JSON */</span>
<span class="keyword">class</span> <a title="class JSONSubRecordField[OwnerType &lt;: net.liftweb.couchdb.JSONRecord[OwnerType], SubRecordType &lt;: net.liftweb.couchdb.JSONRecord[SubRecordType]] extends java.lang.Object with net.liftweb.record.Field[SubRecordType,OwnerType] with net.liftweb.record.MandatoryTypedField[SubRecordType] with ScalaObject" id="10874">JSONSubRecordField</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: net.liftweb.couchdb.JSONRecord[OwnerType]" id="10875">OwnerType</a> &lt;: JSONRecord<span class="delimiter">[</span>OwnerType<span class="delimiter">]</span>, <a title="&gt;: Nothing &lt;: net.liftweb.couchdb.JSONRecord[SubRecordType]" id="10876">SubRecordType</a> &lt;: JSONRecord<span class="delimiter">[</span>SubRecordType<span class="delimiter">]</span><span class="delimiter">]</span>
                        <span class="delimiter">(</span><a title="OwnerType" id="59143">rec</a>: <a href="#10875" title="OwnerType">OwnerType</a>, <a title="net.liftweb.couchdb.JSONMetaRecord[SubRecordType]" id="59144">valueMeta</a>: <a href="#10871" title="net.liftweb.couchdb.JSONMetaRecord[SubRecordType]">JSONMetaRecord</a><span class="delimiter">[</span>SubRecordType<span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scala.reflect.Manifest[SubRecordType]" id="59145">subRecordType</a>: <span title="scala.reflect.Manifest[SubRecordType]">Manifest</span><span class="delimiter">[</span>SubRecordType<span class="delimiter">]</span><span class="delimiter">)</span>
  <span class="keyword">extends</span> <a href="../../../../record/net/liftweb/record/Field.scala.html#12459" title="net.liftweb.record.Field[SubRecordType,OwnerType]">Field</a><span class="delimiter">[</span>SubRecordType, OwnerType<span class="delimiter">]</span> <span class="keyword">with</span> <a href="../../../../record/net/liftweb/record/Field.scala.html#12455" title="net.liftweb.record.MandatoryTypedField[SubRecordType]">MandatoryTypedField</a><span class="delimiter">[</span>SubRecordType<span class="delimiter">]</span>
<span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="(rec: OwnerType, value: SubRecordType)(implicit subRecordType: scala.reflect.Manifest[SubRecordType])net.liftweb.couchdb.JSONSubRecordField[OwnerType,SubRecordType]" id="59114" class="keyword">this</a><span class="delimiter">(</span><a title="OwnerType" id="59149">rec</a>: <a href="#10875" title="OwnerType">OwnerType</a>, <a title="SubRecordType" id="59150">value</a>: <a href="#10876" title="SubRecordType">SubRecordType</a><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scala.reflect.Manifest[SubRecordType]" id="59151">subRecordType</a>: <span title="scala.reflect.Manifest[SubRecordType]">Manifest</span><span class="delimiter">[</span>SubRecordType<span class="delimiter">]</span><span class="delimiter">)</span> = <span title="Unit" class="delimiter">{</span>
      <a href="#10874" title="JSONSubRecordField.this.type" class="keyword">this</a><span class="delimiter">(</span><a href="#59149" title="OwnerType">rec</a>, <a href="#59150" title="SubRecordType">value</a>.<a href="#49141" title="=&gt; net.liftweb.couchdb.JSONMetaRecord[SubRecordType]">meta</a><span class="delimiter">)</span>
      <a href="../../../../record/net/liftweb/record/Field.scala.html#59133" title="(in: JSONSubRecordField.this.MyType)JSONSubRecordField.this.MyType">set</a><span class="delimiter">(</span><a href="#59150" title="SubRecordType">value</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(rec: OwnerType, valueMeta: net.liftweb.couchdb.JSONMetaRecord[SubRecordType], value: net.liftweb.common.Box[SubRecordType])(implicit subRecordType: scala.reflect.Manifest[SubRecordType])net.liftweb.couchdb.JSONSubRecordField[OwnerType,SubRecordType]" id="59115" class="keyword">this</a><span class="delimiter">(</span><a title="OwnerType" id="59158">rec</a>: <a href="#10875" title="OwnerType">OwnerType</a>, <a title="net.liftweb.couchdb.JSONMetaRecord[SubRecordType]" id="59159">valueMeta</a>: <a href="#10871" title="net.liftweb.couchdb.JSONMetaRecord[SubRecordType]">JSONMetaRecord</a><span class="delimiter">[</span>SubRecordType<span class="delimiter">]</span>, <a title="net.liftweb.common.Box[SubRecordType]" id="59160">value</a>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[SubRecordType]">Box</a><span class="delimiter">[</span>SubRecordType<span class="delimiter">]</span><span class="delimiter">)</span>
          <span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scala.reflect.Manifest[SubRecordType]" id="59161">subRecordType</a>: <span title="scala.reflect.Manifest[SubRecordType]">Manifest</span><span class="delimiter">[</span>SubRecordType<span class="delimiter">]</span><span class="delimiter">)</span> = <span title="Unit" class="delimiter">{</span>
      <a href="#10874" title="JSONSubRecordField.this.type" class="keyword">this</a><span class="delimiter">(</span><a href="#59158" title="OwnerType">rec</a>, <a href="#59159" title="net.liftweb.couchdb.JSONMetaRecord[SubRecordType]">valueMeta</a><span class="delimiter">)</span>
      <a href="../../../../record/net/liftweb/record/Field.scala.html#49816" title="(in: net.liftweb.common.Box[JSONSubRecordField.this.MyType])net.liftweb.common.Box[JSONSubRecordField.this.MyType]">setBox</a><span class="delimiter">(</span><a href="#59160" title="net.liftweb.common.Box[SubRecordType]">value</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="=&gt; OwnerType" id="59116">owner</a> = <a href="#59143" title="OwnerType">rec</a>
  <span class="keyword">def</span> <a title="=&gt; net.liftweb.http.js.JsExp" id="59117">asJs</a> = <a href="../../../../record/net/liftweb/record/RecordHelpers.scala.html#55621" title="implicit net.liftweb.record.RecordHelpers.jvalueToJsExp : (jvalue: net.liftweb.json.JsonAST.JValue)net.liftweb.http.js.JsExp">asJValue</a>
  <span class="keyword">def</span> <a title="=&gt; net.liftweb.common.Box[scala.xml.NodeSeq]" id="59118">toForm</a>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[scala.xml.NodeSeq]">Box</a><span class="delimiter">[</span>NodeSeq<span class="delimiter">]</span> = <a href="../../../../common/net/liftweb/common/Box.scala.html#10581" title="object net.liftweb.common.Empty">Empty</a> <span class="comment">// FIXME</span>
  <span class="keyword">def</span> <a title="=&gt; SubRecordType" id="59119">defaultValue</a> = <a href="#59144" title="net.liftweb.couchdb.JSONMetaRecord[SubRecordType]">valueMeta</a>.<a href="../../../../record/net/liftweb/record/MetaRecord.scala.html#49196" title="=&gt; SubRecordType">createRecord</a>

  <span class="keyword">def</span> <a title="(s: String)net.liftweb.common.Box[SubRecordType]" id="59120">setFromString</a><span class="delimiter">(</span><a title="String" id="59217">s</a>: <span title="String">String</span><span class="delimiter">)</span>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[SubRecordType]">Box</a><span class="delimiter">[</span>SubRecordType<span class="delimiter">]</span> = <a href="#59144" title="net.liftweb.couchdb.JSONMetaRecord[SubRecordType]">valueMeta</a>.<a href="../../../../record/net/liftweb/record/MetaRecord.scala.html#49205" title="(json: String)net.liftweb.common.Box[SubRecordType]">fromJSON</a><span class="delimiter">(</span><a href="#59217" title="String">s</a><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(in: Any)net.liftweb.common.Box[SubRecordType]" id="59121">setFromAny</a><span class="delimiter">(</span><a title="Any" id="59223">in</a>: <span title="Any">Any</span><span class="delimiter">)</span>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[SubRecordType]">Box</a><span class="delimiter">[</span>SubRecordType<span class="delimiter">]</span> = <a href="../../../../record/net/liftweb/record/Field.scala.html#49825" title="(in: Any)(implicit m: scala.reflect.Manifest[JSONSubRecordField.this.MyType])net.liftweb.common.Box[JSONSubRecordField.this.MyType]">genericSetFromAny</a><a href="#59145" title="scala.reflect.Manifest[SubRecordType]" class="delimiter">(</a><a href="#59223" title="Any">in</a><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="=&gt; net.liftweb.json.JsonAST.JValue" id="59122">asJValue</a>: <a href="../../../../json/net/liftweb/json/JsonAST.scala.html#48510" title="net.liftweb.json.JsonAST.JValue">JValue</a> = <a href="../../../../record/net/liftweb/record/Field.scala.html#49827" title="=&gt; net.liftweb.common.Box[JSONSubRecordField.this.MyType]">valueBox</a>.<a href="../../../../common/net/liftweb/common/Box.scala.html#27020" title="(f: JSONSubRecordField.this.MyType =&gt; net.liftweb.json.JsonAST.JObject)net.liftweb.common.Box[net.liftweb.json.JsonAST.JObject]">map</a><span class="delimiter">(</span><a href="#59236" title="JSONSubRecordField.this.MyType">_</a>.<a href="../../../../record/net/liftweb/record/Record.scala.html#49129" title="=&gt; net.liftweb.json.JsonAST.JObject">asJValue</a><span class="delimiter">)</span> <a href="../../../../common/net/liftweb/common/Box.scala.html#27017" title="(default: =&gt; net.liftweb.json.JsonAST.JValue)net.liftweb.json.JsonAST.JValue">openOr</a> <span class="delimiter">(</span><a href="../../../../json/net/liftweb/json/JsonAST.scala.html#48511" title="object net.liftweb.json.JsonAST.JNothing">JNothing</a>: <a href="../../../../json/net/liftweb/json/JsonAST.scala.html#48510" title="net.liftweb.json.JsonAST.JValue">JValue</a><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="(jvalue: net.liftweb.json.JsonAST.JValue)net.liftweb.common.Box[SubRecordType]" id="59123">setFromJValue</a><span class="delimiter">(</span><a title="net.liftweb.json.JsonAST.JValue" id="59243">jvalue</a>: <a href="../../../../json/net/liftweb/json/JsonAST.scala.html#48510" title="net.liftweb.json.JsonAST.JValue">JValue</a><span class="delimiter">)</span>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[SubRecordType]">Box</a><span class="delimiter">[</span>SubRecordType<span class="delimiter">]</span> = <a href="#59243" title="net.liftweb.json.JsonAST.JValue">jvalue</a> <span title="net.liftweb.common.Box[SubRecordType]" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <a href="../../../../json/net/liftweb/json/JsonAST.scala.html#48511" title="net.liftweb.common.Box[JSONSubRecordField.this.MyType]">JNothing</a>|<a href="../../../../json/net/liftweb/json/JsonAST.scala.html#48513" title="object net.liftweb.json.JsonAST.JNull">JNull</a> <span class="keyword">if</span> <a href="../../../../record/net/liftweb/record/Field.scala.html#59132" title="=&gt; Boolean">optional_?</a> =&gt; <a href="../../../../record/net/liftweb/record/Field.scala.html#49816" title="(in: net.liftweb.common.Box[JSONSubRecordField.this.MyType])net.liftweb.common.Box[JSONSubRecordField.this.MyType]">setBox</a><span class="delimiter">(</span><a href="../../../../common/net/liftweb/common/Box.scala.html#10581" title="object net.liftweb.common.Empty">Empty</a><span class="delimiter">)</span>
    <span class="keyword">case</span> <span title="net.liftweb.common.Box[JSONSubRecordField.this.MyType]">_</span>                            =&gt; <a href="../../../../record/net/liftweb/record/Field.scala.html#49816" title="(in: net.liftweb.common.Box[JSONSubRecordField.this.MyType])net.liftweb.common.Box[JSONSubRecordField.this.MyType]">setBox</a><span class="delimiter">(</span><a href="#59144" title="net.liftweb.couchdb.JSONMetaRecord[SubRecordType]">valueMeta</a>.<a href="../../../../record/net/liftweb/record/MetaRecord.scala.html#49208" title="(jvalue: net.liftweb.json.JsonAST.JValue)net.liftweb.common.Box[SubRecordType]">fromJValue</a><span class="delimiter">(</span><a href="#59243" title="net.liftweb.json.JsonAST.JValue">jvalue</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="comment">/** Field that contains an array of some basic JSON type */</span>
<span class="keyword">class</span> <a title="class JSONBasicArrayField[OwnerType &lt;: net.liftweb.couchdb.JSONRecord[OwnerType], ElemType &lt;: net.liftweb.json.JsonAST.JValue] extends java.lang.Object with net.liftweb.record.Field[List[ElemType],OwnerType] with net.liftweb.record.MandatoryTypedField[List[ElemType]] with ScalaObject" id="10877">JSONBasicArrayField</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: net.liftweb.couchdb.JSONRecord[OwnerType]" id="10878">OwnerType</a> &lt;: JSONRecord<span class="delimiter">[</span>OwnerType<span class="delimiter">]</span>, <a title="&gt;: Nothing &lt;: net.liftweb.json.JsonAST.JValue" id="10879">ElemType</a> &lt;: JValue<span class="delimiter">]</span><a href="#10877" title="ScalaObject" class="delimiter">(</a><a title="OwnerType" id="59270">rec</a>: <a href="#10878" title="OwnerType">OwnerType</a><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scala.reflect.Manifest[ElemType]" id="59271">elemType</a>: <span title="scala.reflect.Manifest[ElemType]">Manifest</span><span class="delimiter">[</span>ElemType<span class="delimiter">]</span><span class="delimiter">)</span>
  <span class="keyword">extends</span> <a href="../../../../record/net/liftweb/record/Field.scala.html#12459" title="net.liftweb.record.Field[List[ElemType],OwnerType]">Field</a><span class="delimiter">[</span>List<span class="delimiter">[</span>ElemType<span class="delimiter">]</span>, OwnerType<span class="delimiter">]</span> <span class="keyword">with</span> <a href="../../../../record/net/liftweb/record/Field.scala.html#12455" title="net.liftweb.record.MandatoryTypedField[List[ElemType]]">MandatoryTypedField</a><span class="delimiter">[</span>List<span class="delimiter">[</span>ElemType<span class="delimiter">]</span><span class="delimiter">]</span>
<span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="(rec: OwnerType, value: List[ElemType])(implicit elemType: scala.reflect.Manifest[ElemType])net.liftweb.couchdb.JSONBasicArrayField[OwnerType,ElemType]" id="59256" class="keyword">this</a><span class="delimiter">(</span><a title="OwnerType" id="59275">rec</a>: <a href="#10878" title="OwnerType">OwnerType</a>, <a title="List[ElemType]" id="59276">value</a>: <span title="List[ElemType]">List</span><span class="delimiter">[</span>ElemType<span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scala.reflect.Manifest[ElemType]" id="59277">elemType</a>: <span title="scala.reflect.Manifest[ElemType]">Manifest</span><span class="delimiter">[</span>ElemType<span class="delimiter">]</span><span class="delimiter">)</span> = <span title="Unit" class="delimiter">{</span> <a href="#10877" title="JSONBasicArrayField.this.type" class="keyword">this</a><span class="delimiter">(</span><a href="#59275" title="OwnerType">rec</a><span class="delimiter">)</span>; <a href="../../../../record/net/liftweb/record/Field.scala.html#59133" title="(in: JSONBasicArrayField.this.MyType)JSONBasicArrayField.this.MyType">set</a><span class="delimiter">(</span><a href="#59276" title="List[ElemType]">value</a><span class="delimiter">)</span> <span class="delimiter">}</span>
  <span class="keyword">def</span> <a title="(rec: OwnerType, value: net.liftweb.common.Box[List[ElemType]])(implicit elemType: scala.reflect.Manifest[ElemType])net.liftweb.couchdb.JSONBasicArrayField[OwnerType,ElemType]" id="59257" class="keyword">this</a><span class="delimiter">(</span><a title="OwnerType" id="59284">rec</a>: <a href="#10878" title="OwnerType">OwnerType</a>, <a title="net.liftweb.common.Box[List[ElemType]]" id="59285">value</a>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[List[ElemType]]">Box</a><span class="delimiter">[</span>List<span class="delimiter">[</span>ElemType<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scala.reflect.Manifest[ElemType]" id="59286">elemType</a>: <span title="scala.reflect.Manifest[ElemType]">Manifest</span><span class="delimiter">[</span>ElemType<span class="delimiter">]</span><span class="delimiter">)</span> = <span title="Unit" class="delimiter">{</span> <a href="#10877" title="JSONBasicArrayField.this.type" class="keyword">this</a><span class="delimiter">(</span><a href="#59284" title="OwnerType">rec</a><span class="delimiter">)</span>; <a href="../../../../record/net/liftweb/record/Field.scala.html#49816" title="(in: net.liftweb.common.Box[JSONBasicArrayField.this.MyType])net.liftweb.common.Box[JSONBasicArrayField.this.MyType]">setBox</a><span class="delimiter">(</span><a href="#59285" title="net.liftweb.common.Box[List[ElemType]]">value</a><span class="delimiter">)</span> <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="=&gt; OwnerType" id="59258">owner</a> = <a href="#59270" title="OwnerType">rec</a>
  <span class="keyword">def</span> <a title="=&gt; net.liftweb.http.js.JsExp" id="59259">asJs</a> = <a href="../../../../record/net/liftweb/record/RecordHelpers.scala.html#55621" title="implicit net.liftweb.record.RecordHelpers.jvalueToJsExp : (jvalue: net.liftweb.json.JsonAST.JValue)net.liftweb.http.js.JsExp">asJValue</a>
  <span class="keyword">def</span> <a title="=&gt; net.liftweb.common.Box[scala.xml.NodeSeq]" id="59260">toForm</a>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[scala.xml.NodeSeq]">Box</a><span class="delimiter">[</span>NodeSeq<span class="delimiter">]</span> = <a href="../../../../common/net/liftweb/common/Box.scala.html#10581" title="object net.liftweb.common.Empty">Empty</a> <span class="comment">// FIXME</span>
  <span class="keyword">def</span> <a title="=&gt; scala.collection.immutable.Nil.type" id="59261">defaultValue</a> = <span title="object Nil">Nil</span>

  <span class="keyword">def</span> <a title="(s: String)net.liftweb.common.Box[List[ElemType]]" id="59262">setFromString</a><span class="delimiter">(</span><a title="String" id="59313">s</a>: <span title="String">String</span><span class="delimiter">)</span>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[List[ElemType]]">Box</a><span class="delimiter">[</span>List<span class="delimiter">[</span>ElemType<span class="delimiter">]</span><span class="delimiter">]</span> =
    <a href="../../../../record/net/liftweb/record/Field.scala.html#49816" title="(in: net.liftweb.common.Box[JSONBasicArrayField.this.MyType])net.liftweb.common.Box[JSONBasicArrayField.this.MyType]">setBox</a><span class="delimiter">(</span><a href="../../../../util/net/liftweb/util/ControlHelpers.scala.html#48608" title="(f: =&gt; net.liftweb.json.package.JValue)net.liftweb.common.Box[net.liftweb.json.package.JValue]">tryo</a><span class="delimiter">(</span><a href="../../../../json/net/liftweb/json/JsonParser.scala.html#11146" title="object net.liftweb.json.JsonParser">JsonParser</a>.<a href="../../../../json/net/liftweb/json/JsonParser.scala.html#54535" title="(s: String)net.liftweb.json.package.JValue">parse</a><span class="delimiter">(</span><a href="#59313" title="String">s</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../../../common/net/liftweb/common/Box.scala.html#27023" title="(f: net.liftweb.json.package.JValue =&gt; net.liftweb.common.Box[JSONBasicArrayField.this.MyType])net.liftweb.common.Box[JSONBasicArrayField.this.MyType]">flatMap</a> <a href="#59369" title="net.liftweb.common.Box[JSONBasicArrayField.this.MyType]" class="delimiter">{</a>
      <span class="keyword">case</span> <span title="net.liftweb.common.Box[List[ElemType]]">JArray</span><span class="delimiter">(</span><a title="List[net.liftweb.json.JsonAST.JValue]" id="59371">values</a><span class="delimiter">)</span> =&gt; <a href="#59264" title="(in: List[net.liftweb.json.JsonAST.JValue])net.liftweb.common.Box[List[ElemType]]">checkValueTypes</a><span class="delimiter">(</span><a href="#59371" title="List[net.liftweb.json.JsonAST.JValue]">values</a><span class="delimiter">)</span>
      <span class="keyword">case</span> <a title="net.liftweb.common.Failure" id="59374">other</a>          =&gt; <a href="../../../../record/net/liftweb/record/Field.scala.html#55623" title="(what: String, notA: AnyRef)net.liftweb.common.Failure">expectedA</a><span class="delimiter">(</span><span title="java.lang.String(&quot;JSON string with an array of &quot;)" class="string">&quot;JSON string with an array of &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#59271" title="scala.reflect.Manifest[ElemType]">elemType</a>, <a href="#59374" title="net.liftweb.json.package.JValue">other</a><span class="delimiter">)</span>
    <span class="delimiter">}</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(in: Any)net.liftweb.common.Box[List[ElemType]]" id="59263">setFromAny</a><span class="delimiter">(</span><a title="Any" id="59376">in</a>: <span title="Any">Any</span><span class="delimiter">)</span>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[List[ElemType]]">Box</a><span class="delimiter">[</span>List<span class="delimiter">[</span>ElemType<span class="delimiter">]</span><span class="delimiter">]</span> = <a href="../../../../record/net/liftweb/record/Field.scala.html#49825" title="(in: Any)(implicit m: scala.reflect.Manifest[JSONBasicArrayField.this.MyType])net.liftweb.common.Box[JSONBasicArrayField.this.MyType]">genericSetFromAny</a><a href="#59271" title="(clazz: Class[JSONBasicArrayField.this.MyType], arg1: scala.reflect.Manifest[_], args: scala.reflect.Manifest[_]*)scala.reflect.Manifest[JSONBasicArrayField.this.MyType]" class="delimiter">(</a><a href="#59376" title="Any">in</a><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(in: List[net.liftweb.json.JsonAST.JValue])net.liftweb.common.Box[List[ElemType]]" id="59264">checkValueTypes</a><span class="delimiter">(</span><a title="List[net.liftweb.json.JsonAST.JValue]" id="59372">in</a>: <span title="List[net.liftweb.json.JsonAST.JValue]">List</span><span class="delimiter">[</span>JValue<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[List[ElemType]]">Box</a><span class="delimiter">[</span>List<span class="delimiter">[</span>ElemType<span class="delimiter">]</span><span class="delimiter">]</span> =
    <a href="#59372" title="List[net.liftweb.json.JsonAST.JValue]">in</a>.<span title="(p: net.liftweb.json.JsonAST.JValue =&gt; Boolean)Option[net.liftweb.json.JsonAST.JValue]">find</span><span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#59402" title="net.liftweb.json.JsonAST.JValue">_</a>.<span title="[T0]=&gt; Boolean">isInstanceOf</span><span title="Boolean" class="delimiter">[</span><a href="#10879" title="ElemType">ElemType</a><span class="delimiter">]</span><span class="delimiter">)</span> <span title="net.liftweb.common.Box[List[ElemType]]" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <span title="net.liftweb.common.Failure">Some</span><span class="delimiter">(</span><a title="net.liftweb.json.JsonAST.JValue" id="59404">erroneousValue</a><span class="delimiter">)</span> <span class="keyword">if</span> <a href="#59404" title="net.liftweb.json.JsonAST.JValue">erroneousValue</a> <span title="(x$1: AnyRef)Boolean">!=</span> <span title="Null(null)" class="keyword">null</span> =&gt;
          <a href="../../../../common/net/liftweb/common/Box.scala.html#37829" title="(msg: String)net.liftweb.common.Failure">Failure</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Value in input array is a &quot;)" class="string">&quot;Value in input array is a &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="../../../../record/net/liftweb/record/Field.scala.html#59136" title="=&gt; JSONBasicArrayField.this.MyType">value</a>.<span title="()java.lang.Class[_]">getClass</span>.<span title="()java.lang.String">getName</span> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;, should be a &quot;)" class="string">&quot;, should be a &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#59271" title="scala.reflect.Manifest[ElemType]">elemType</a>.<span title="()java.lang.String">toString</span><span class="delimiter">)</span>

      <span class="keyword">case</span> <span title="net.liftweb.common.Failure">Some</span><span class="delimiter">(</span><a title="net.liftweb.json.JsonAST.JValue" id="59425">erroneousValue</a><span class="delimiter">)</span> =&gt; <a href="../../../../common/net/liftweb/common/Box.scala.html#37829" title="(msg: String)net.liftweb.common.Failure">Failure</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Value in input array is null, should be a &quot;)" class="string">&quot;Value in input array is null, should be a &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#59271" title="scala.reflect.Manifest[ElemType]">elemType</a>.<span title="()java.lang.String">toString</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="net.liftweb.common.Full[List[ElemType]]">None</span>                 =&gt; <a href="../../../../common/net/liftweb/common/Box.scala.html#27086" title="(value: List[ElemType])net.liftweb.common.Full[List[ElemType]]">Full</a><span class="delimiter">(</span><a href="#59372" title="List[net.liftweb.json.JsonAST.JValue]">in</a>.<span title="(f: net.liftweb.json.JsonAST.JValue =&gt; ElemType)(implicit bf: scala.collection.generic.CanBuildFrom[List[net.liftweb.json.JsonAST.JValue],ElemType,List[ElemType]])List[ElemType]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.List.Coll,ElemType,List[ElemType]]" class="delimiter">(</span><a href="#59461" title="net.liftweb.json.JsonAST.JValue">_</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="ElemType" class="delimiter">[</span><a href="#10879" title="ElemType">ElemType</a><span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="=&gt; net.liftweb.json.JsonAST.JValue" id="59265">asJValue</a>: <a href="../../../../json/net/liftweb/json/JsonAST.scala.html#48510" title="net.liftweb.json.JsonAST.JValue">JValue</a> = <a href="../../../../record/net/liftweb/record/Field.scala.html#49827" title="=&gt; net.liftweb.common.Box[JSONBasicArrayField.this.MyType]">valueBox</a>.<a href="../../../../common/net/liftweb/common/Box.scala.html#27020" title="(f: JSONBasicArrayField.this.MyType =&gt; net.liftweb.json.JsonAST.JArray)net.liftweb.common.Box[net.liftweb.json.JsonAST.JArray]">map</a><span class="delimiter">(</span><a href="../../../../json/net/liftweb/json/JsonAST.scala.html#48534" title="object net.liftweb.json.JsonAST.JArray">JArray</a><span class="delimiter">)</span> <a href="../../../../common/net/liftweb/common/Box.scala.html#27017" title="(default: =&gt; net.liftweb.json.JsonAST.JValue)net.liftweb.json.JsonAST.JValue">openOr</a> <span class="delimiter">(</span><a href="../../../../json/net/liftweb/json/JsonAST.scala.html#48511" title="object net.liftweb.json.JsonAST.JNothing">JNothing</a>: <a href="../../../../json/net/liftweb/json/JsonAST.scala.html#48510" title="net.liftweb.json.JsonAST.JValue">JValue</a><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="(jvalue: net.liftweb.json.JsonAST.JValue)net.liftweb.common.Box[List[ElemType]]" id="59266">setFromJValue</a><span class="delimiter">(</span><a title="net.liftweb.json.JsonAST.JValue" id="59500">jvalue</a>: <a href="../../../../json/net/liftweb/json/JsonAST.scala.html#48510" title="net.liftweb.json.JsonAST.JValue">JValue</a><span class="delimiter">)</span>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[List[ElemType]]">Box</a><span class="delimiter">[</span>List<span class="delimiter">[</span>ElemType<span class="delimiter">]</span><span class="delimiter">]</span> = <a href="#59500" title="net.liftweb.json.JsonAST.JValue">jvalue</a> <span title="net.liftweb.common.Box[List[ElemType]]" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <a href="../../../../json/net/liftweb/json/JsonAST.scala.html#48511" title="net.liftweb.common.Box[JSONBasicArrayField.this.MyType]">JNothing</a>|<a href="../../../../json/net/liftweb/json/JsonAST.scala.html#48513" title="object net.liftweb.json.JsonAST.JNull">JNull</a> <span class="keyword">if</span> <a href="../../../../record/net/liftweb/record/Field.scala.html#59132" title="=&gt; Boolean">optional_?</a> =&gt; <a href="../../../../record/net/liftweb/record/Field.scala.html#49816" title="(in: net.liftweb.common.Box[JSONBasicArrayField.this.MyType])net.liftweb.common.Box[JSONBasicArrayField.this.MyType]">setBox</a><span class="delimiter">(</span><a href="../../../../common/net/liftweb/common/Box.scala.html#10581" title="object net.liftweb.common.Empty">Empty</a><span class="delimiter">)</span>
    <span class="keyword">case</span> <span title="net.liftweb.common.Box[JSONBasicArrayField.this.MyType]">JArray</span><span class="delimiter">(</span><a title="List[net.liftweb.json.JsonAST.JValue]" id="59503">values</a><span class="delimiter">)</span>               =&gt; <a href="../../../../record/net/liftweb/record/Field.scala.html#49816" title="(in: net.liftweb.common.Box[JSONBasicArrayField.this.MyType])net.liftweb.common.Box[JSONBasicArrayField.this.MyType]">setBox</a><span class="delimiter">(</span><a href="#59264" title="(in: List[net.liftweb.json.JsonAST.JValue])net.liftweb.common.Box[List[ElemType]]">checkValueTypes</a><span class="delimiter">(</span><a href="#59503" title="List[net.liftweb.json.JsonAST.JValue]">values</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="keyword">case</span> <a title="net.liftweb.common.Box[JSONBasicArrayField.this.MyType]" id="59504">other</a>                        =&gt; <a href="../../../../record/net/liftweb/record/Field.scala.html#49816" title="(in: net.liftweb.common.Box[JSONBasicArrayField.this.MyType])net.liftweb.common.Box[JSONBasicArrayField.this.MyType]">setBox</a><span class="delimiter">(</span><a href="../../../../record/net/liftweb/record/Field.scala.html#55623" title="(what: String, notA: AnyRef)net.liftweb.common.Failure">expectedA</a><span class="delimiter">(</span><span title="java.lang.String(&quot;JArray containing &quot;)" class="string">&quot;JArray containing &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#59271" title="scala.reflect.Manifest[ElemType]">elemType</a>.<span title="()java.lang.String">toString</span>, <a href="#59504" title="net.liftweb.json.JsonAST.JValue">other</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="comment">/** Field that contains a homogeneous array of subrecords */</span>
<span class="keyword">class</span> <a title="class JSONSubRecordArrayField[OwnerType &lt;: net.liftweb.couchdb.JSONRecord[OwnerType], SubRecordType &lt;: net.liftweb.couchdb.JSONRecord[SubRecordType]] extends java.lang.Object with net.liftweb.record.Field[List[SubRecordType],OwnerType] with net.liftweb.record.MandatoryTypedField[List[SubRecordType]] with ScalaObject" id="10880">JSONSubRecordArrayField</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: net.liftweb.couchdb.JSONRecord[OwnerType]" id="10881">OwnerType</a> &lt;: JSONRecord<span class="delimiter">[</span>OwnerType<span class="delimiter">]</span>, <a title="&gt;: Nothing &lt;: net.liftweb.couchdb.JSONRecord[SubRecordType]" id="10882">SubRecordType</a> &lt;: JSONRecord<span class="delimiter">[</span>SubRecordType<span class="delimiter">]</span><span class="delimiter">]</span>
                             <span class="delimiter">(</span><a title="OwnerType" id="59527">rec</a>: <a href="#10881" title="OwnerType">OwnerType</a>, <a title="net.liftweb.couchdb.JSONMetaRecord[SubRecordType]" id="59528">valueMeta</a>: <a href="#10871" title="net.liftweb.couchdb.JSONMetaRecord[SubRecordType]">JSONMetaRecord</a><span class="delimiter">[</span>SubRecordType<span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scala.reflect.Manifest[SubRecordType]" id="59529">valueType</a>: <span title="scala.reflect.Manifest[SubRecordType]">Manifest</span><span class="delimiter">[</span>SubRecordType<span class="delimiter">]</span><span class="delimiter">)</span>
  <span class="keyword">extends</span> <a href="../../../../record/net/liftweb/record/Field.scala.html#12459" title="net.liftweb.record.Field[List[SubRecordType],OwnerType]">Field</a><span class="delimiter">[</span>List<span class="delimiter">[</span>SubRecordType<span class="delimiter">]</span>, OwnerType<span class="delimiter">]</span> <span class="keyword">with</span> <a href="../../../../record/net/liftweb/record/Field.scala.html#12455" title="net.liftweb.record.MandatoryTypedField[List[SubRecordType]]">MandatoryTypedField</a><span class="delimiter">[</span>List<span class="delimiter">[</span>SubRecordType<span class="delimiter">]</span><span class="delimiter">]</span>
<span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="(rec: OwnerType, value: List[SubRecordType])(implicit subRecordType: scala.reflect.Manifest[SubRecordType])net.liftweb.couchdb.JSONSubRecordArrayField[OwnerType,SubRecordType]" id="59512" class="keyword">this</a><span class="delimiter">(</span><a title="OwnerType" id="59533">rec</a>: <a href="#10881" title="OwnerType">OwnerType</a>, <a title="List[SubRecordType]" id="59534">value</a>: <span title="List[SubRecordType]">List</span><span class="delimiter">[</span>SubRecordType<span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scala.reflect.Manifest[SubRecordType]" id="59535">subRecordType</a>: <span title="scala.reflect.Manifest[SubRecordType]">Manifest</span><span class="delimiter">[</span>SubRecordType<span class="delimiter">]</span><span class="delimiter">)</span> = <span title="Unit" class="delimiter">{</span>
      <a href="#10880" title="JSONSubRecordArrayField.this.type" class="keyword">this</a><span class="delimiter">(</span><a href="#59533" title="OwnerType">rec</a>, <a href="#59534" title="List[SubRecordType]">value</a>.<span title="=&gt; SubRecordType">head</span>.<a href="#49141" title="=&gt; net.liftweb.couchdb.JSONMetaRecord[SubRecordType]">meta</a><span class="delimiter">)</span>
      <a href="../../../../record/net/liftweb/record/Field.scala.html#59133" title="(in: JSONSubRecordArrayField.this.MyType)JSONSubRecordArrayField.this.MyType">set</a><span class="delimiter">(</span><a href="#59534" title="List[SubRecordType]">value</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(rec: OwnerType, valueMeta: net.liftweb.couchdb.JSONMetaRecord[SubRecordType], value: net.liftweb.common.Box[List[SubRecordType]])(implicit subRecordType: scala.reflect.Manifest[SubRecordType])net.liftweb.couchdb.JSONSubRecordArrayField[OwnerType,SubRecordType]" id="59513" class="keyword">this</a><span class="delimiter">(</span><a title="OwnerType" id="59542">rec</a>: <a href="#10881" title="OwnerType">OwnerType</a>, <a title="net.liftweb.couchdb.JSONMetaRecord[SubRecordType]" id="59543">valueMeta</a>: <a href="#10871" title="net.liftweb.couchdb.JSONMetaRecord[SubRecordType]">JSONMetaRecord</a><span class="delimiter">[</span>SubRecordType<span class="delimiter">]</span>, <a title="net.liftweb.common.Box[List[SubRecordType]]" id="59544">value</a>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[List[SubRecordType]]">Box</a><span class="delimiter">[</span>List<span class="delimiter">[</span>SubRecordType<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span>
          <span class="delimiter">(</span><span class="keyword">implicit</span> <a title="scala.reflect.Manifest[SubRecordType]" id="59545">subRecordType</a>: <span title="scala.reflect.Manifest[SubRecordType]">Manifest</span><span class="delimiter">[</span>SubRecordType<span class="delimiter">]</span><span class="delimiter">)</span> = <span title="Unit" class="delimiter">{</span>
      <a href="#10880" title="JSONSubRecordArrayField.this.type" class="keyword">this</a><span class="delimiter">(</span><a href="#59542" title="OwnerType">rec</a>, <a href="#59543" title="net.liftweb.couchdb.JSONMetaRecord[SubRecordType]">valueMeta</a><span class="delimiter">)</span>
      <a href="../../../../record/net/liftweb/record/Field.scala.html#49816" title="(in: net.liftweb.common.Box[JSONSubRecordArrayField.this.MyType])net.liftweb.common.Box[JSONSubRecordArrayField.this.MyType]">setBox</a><span class="delimiter">(</span><a href="#59544" title="net.liftweb.common.Box[List[SubRecordType]]">value</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="=&gt; OwnerType" id="59514">owner</a> = <a href="#59527" title="OwnerType">rec</a>
  <span class="keyword">def</span> <a title="=&gt; net.liftweb.http.js.JsExp" id="59515">asJs</a> = <a href="../../../../record/net/liftweb/record/RecordHelpers.scala.html#55621" title="implicit net.liftweb.record.RecordHelpers.jvalueToJsExp : (jvalue: net.liftweb.json.JsonAST.JValue)net.liftweb.http.js.JsExp">asJValue</a>
  <span class="keyword">def</span> <a title="=&gt; net.liftweb.common.Box[scala.xml.NodeSeq]" id="59516">toForm</a>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[scala.xml.NodeSeq]">Box</a><span class="delimiter">[</span>NodeSeq<span class="delimiter">]</span> = <a href="../../../../common/net/liftweb/common/Box.scala.html#10581" title="object net.liftweb.common.Empty">Empty</a> <span class="comment">// FIXME</span>
  <span class="keyword">def</span> <a title="=&gt; scala.collection.immutable.Nil.type" id="59517">defaultValue</a> = <span title="object Nil">Nil</span>

  <span class="keyword">def</span> <a title="(s: String)net.liftweb.common.Box[List[SubRecordType]]" id="59518">setFromString</a><span class="delimiter">(</span><a title="String" id="59577">s</a>: <span title="String">String</span><span class="delimiter">)</span>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[List[SubRecordType]]">Box</a><span class="delimiter">[</span>List<span class="delimiter">[</span>SubRecordType<span class="delimiter">]</span><span class="delimiter">]</span> =
    <a href="../../../../record/net/liftweb/record/Field.scala.html#49816" title="(in: net.liftweb.common.Box[JSONSubRecordArrayField.this.MyType])net.liftweb.common.Box[JSONSubRecordArrayField.this.MyType]">setBox</a><span class="delimiter">(</span><a href="../../../../util/net/liftweb/util/ControlHelpers.scala.html#48608" title="(f: =&gt; net.liftweb.json.package.JValue)net.liftweb.common.Box[net.liftweb.json.package.JValue]">tryo</a><span class="delimiter">(</span><a href="../../../../json/net/liftweb/json/JsonParser.scala.html#11146" title="object net.liftweb.json.JsonParser">JsonParser</a>.<a href="../../../../json/net/liftweb/json/JsonParser.scala.html#54535" title="(s: String)net.liftweb.json.package.JValue">parse</a><span class="delimiter">(</span><a href="#59577" title="String">s</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../../../common/net/liftweb/common/Box.scala.html#27023" title="(f: net.liftweb.json.package.JValue =&gt; net.liftweb.common.Box[JSONSubRecordArrayField.this.MyType])net.liftweb.common.Box[JSONSubRecordArrayField.this.MyType]">flatMap</a> <a href="#59632" title="net.liftweb.common.Box[JSONSubRecordArrayField.this.MyType]" class="delimiter">{</a>
      <span class="keyword">case</span> <span title="net.liftweb.common.Box[List[SubRecordType]]">JArray</span><span class="delimiter">(</span><a title="List[net.liftweb.json.JsonAST.JValue]" id="59634">values</a><span class="delimiter">)</span> =&gt; <a href="#59520" title="(jvalues: List[net.liftweb.json.JsonAST.JValue])net.liftweb.common.Box[List[SubRecordType]]">fromJValues</a><span class="delimiter">(</span><a href="#59634" title="List[net.liftweb.json.JsonAST.JValue]">values</a><span class="delimiter">)</span>
      <span class="keyword">case</span> <a title="net.liftweb.common.Failure" id="59637">other</a>          =&gt; <a href="../../../../record/net/liftweb/record/Field.scala.html#55623" title="(what: String, notA: AnyRef)net.liftweb.common.Failure">expectedA</a><span class="delimiter">(</span><span title="java.lang.String(&quot;JSON string containing an array of &quot;)" class="string">&quot;JSON string containing an array of &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#59528" title="net.liftweb.couchdb.JSONMetaRecord[SubRecordType]">valueMeta</a>.<span title="()java.lang.Class[_]">getClass</span>.<span title="()java.lang.Class[_ &gt;: ?0]">getSuperclass</span>.<span title="()java.lang.String">getName</span>, <a href="#59637" title="net.liftweb.json.package.JValue">other</a><span class="delimiter">)</span>
    <span class="delimiter">}</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="(in: Any)net.liftweb.common.Box[List[SubRecordType]]" id="59519">setFromAny</a><span class="delimiter">(</span><a title="Any" id="59643">in</a>: <span title="Any">Any</span><span class="delimiter">)</span>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[List[SubRecordType]]">Box</a><span class="delimiter">[</span>List<span class="delimiter">[</span>SubRecordType<span class="delimiter">]</span><span class="delimiter">]</span> = <a href="../../../../record/net/liftweb/record/Field.scala.html#49825" title="(in: Any)(implicit m: scala.reflect.Manifest[JSONSubRecordArrayField.this.MyType])net.liftweb.common.Box[JSONSubRecordArrayField.this.MyType]">genericSetFromAny</a><a href="#59529" title="(clazz: Class[JSONSubRecordArrayField.this.MyType], arg1: scala.reflect.Manifest[_], args: scala.reflect.Manifest[_]*)scala.reflect.Manifest[JSONSubRecordArrayField.this.MyType]" class="delimiter">(</a><a href="#59643" title="Any">in</a><span class="delimiter">)</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(jvalues: List[net.liftweb.json.JsonAST.JValue])net.liftweb.common.Box[List[SubRecordType]]" id="59520">fromJValues</a><span class="delimiter">(</span><a title="List[net.liftweb.json.JsonAST.JValue]" id="59635">jvalues</a>: <span title="List[net.liftweb.json.JsonAST.JValue]">List</span><span class="delimiter">[</span>JValue<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[List[SubRecordType]]">Box</a><span class="delimiter">[</span>List<span class="delimiter">[</span>SubRecordType<span class="delimiter">]</span><span class="delimiter">]</span> =
    <a href="#59635" title="List[net.liftweb.json.JsonAST.JValue]">jvalues</a>
      .<span title="[B](z: B)(f: (B, net.liftweb.json.JsonAST.JValue) =&gt; B)B">foldLeft</span><span title="(z: net.liftweb.common.Box[List[SubRecordType]])(f: (net.liftweb.common.Box[List[SubRecordType]], net.liftweb.json.JsonAST.JValue) =&gt; net.liftweb.common.Box[List[SubRecordType]])net.liftweb.common.Box[List[SubRecordType]]" class="delimiter">[</span><a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[List[SubRecordType]]">Box</a><span class="delimiter">[</span>List<span class="delimiter">[</span>SubRecordType<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">(</span><a href="../../../../common/net/liftweb/common/Box.scala.html#27086" title="(value: scala.collection.immutable.Nil.type)net.liftweb.common.Full[scala.collection.immutable.Nil.type]">Full</a><span class="delimiter">(</span><span title="object Nil">Nil</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="delimiter">(</span><a title="net.liftweb.common.Box[List[SubRecordType]]" id="59689">prev</a>, <a title="net.liftweb.json.JsonAST.JValue" id="59690">cur</a><span class="delimiter">)</span> =&gt; <a href="#59689" title="net.liftweb.common.Box[List[SubRecordType]]">prev</a>.<a href="../../../../common/net/liftweb/common/Box.scala.html#27023" title="(f: List[SubRecordType] =&gt; net.liftweb.common.Box[List[SubRecordType]])net.liftweb.common.Box[List[SubRecordType]]">flatMap</a> <span class="delimiter">{</span>
          <a title="List[SubRecordType]" id="59695">rest</a> =&gt; <a href="#59528" title="net.liftweb.couchdb.JSONMetaRecord[SubRecordType]">valueMeta</a>.<a href="../../../../record/net/liftweb/record/MetaRecord.scala.html#49208" title="(jvalue: net.liftweb.json.JsonAST.JValue)net.liftweb.common.Box[SubRecordType]">fromJValue</a><span class="delimiter">(</span><a href="#59690" title="net.liftweb.json.JsonAST.JValue">cur</a><span class="delimiter">)</span>.<a href="../../../../common/net/liftweb/common/Box.scala.html#27020" title="(f: SubRecordType =&gt; List[SubRecordType])net.liftweb.common.Box[List[SubRecordType]]">map</a><span class="delimiter">(</span><a href="#59700" title="SubRecordType">_</a><a href="#59701" title="(x: SubRecordType)List[SubRecordType]">::</a><a href="#59695" title="List[SubRecordType]">rest</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span>
      .<a href="../../../../common/net/liftweb/common/Box.scala.html#27020" title="(f: List[SubRecordType] =&gt; List[SubRecordType])net.liftweb.common.Box[List[SubRecordType]]">map</a><span class="delimiter">(</span><a href="#59713" title="List[SubRecordType]">_</a>.<span title="=&gt; List[SubRecordType]">reverse</span><span class="delimiter">)</span>

  <span class="keyword">def</span> <a title="=&gt; net.liftweb.json.JsonAST.JArray" id="59521">asJValue</a>: <a href="../../../../json/net/liftweb/json/JsonAST.scala.html#48533" title="net.liftweb.json.JsonAST.JArray">JArray</a> = <a href="../../../../json/net/liftweb/json/JsonAST.scala.html#51423" title="(arr: List[net.liftweb.json.JsonAST.JValue])net.liftweb.json.JsonAST.JArray">JArray</a><span class="delimiter">(</span><a href="../../../../record/net/liftweb/record/Field.scala.html#59136" title="=&gt; JSONSubRecordArrayField.this.MyType">value</a>.<span title="(f: SubRecordType =&gt; net.liftweb.json.JsonAST.JObject)(implicit bf: scala.collection.generic.CanBuildFrom[List[SubRecordType],net.liftweb.json.JsonAST.JObject,List[net.liftweb.json.JsonAST.JValue]])List[net.liftweb.json.JsonAST.JValue]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.List.Coll,net.liftweb.json.JsonAST.JObject,List[net.liftweb.json.JsonAST.JObject]]" class="delimiter">(</span><a href="#59739" title="SubRecordType">_</a>.<a href="../../../../record/net/liftweb/record/Record.scala.html#49129" title="=&gt; net.liftweb.json.JsonAST.JObject">asJValue</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="(jvalue: net.liftweb.json.JsonAST.JValue)net.liftweb.common.Box[List[SubRecordType]]" id="59522">setFromJValue</a><span class="delimiter">(</span><a title="net.liftweb.json.JsonAST.JValue" id="59768">jvalue</a>: <a href="../../../../json/net/liftweb/json/JsonAST.scala.html#48510" title="net.liftweb.json.JsonAST.JValue">JValue</a><span class="delimiter">)</span>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[List[SubRecordType]]">Box</a><span class="delimiter">[</span>List<span class="delimiter">[</span>SubRecordType<span class="delimiter">]</span><span class="delimiter">]</span> = <a href="#59768" title="net.liftweb.json.JsonAST.JValue">jvalue</a> <span title="net.liftweb.common.Box[List[SubRecordType]]" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <a href="../../../../json/net/liftweb/json/JsonAST.scala.html#48511" title="net.liftweb.common.Box[JSONSubRecordArrayField.this.MyType]">JNothing</a>|<a href="../../../../json/net/liftweb/json/JsonAST.scala.html#48513" title="object net.liftweb.json.JsonAST.JNull">JNull</a> <span class="keyword">if</span> <a href="../../../../record/net/liftweb/record/Field.scala.html#59132" title="=&gt; Boolean">optional_?</a> =&gt; <a href="../../../../record/net/liftweb/record/Field.scala.html#49816" title="(in: net.liftweb.common.Box[JSONSubRecordArrayField.this.MyType])net.liftweb.common.Box[JSONSubRecordArrayField.this.MyType]">setBox</a><span class="delimiter">(</span><a href="../../../../common/net/liftweb/common/Box.scala.html#10581" title="object net.liftweb.common.Empty">Empty</a><span class="delimiter">)</span>
    <span class="keyword">case</span> <span title="net.liftweb.common.Box[JSONSubRecordArrayField.this.MyType]">JArray</span><span class="delimiter">(</span><a title="List[net.liftweb.json.JsonAST.JValue]" id="59771">jvalues</a><span class="delimiter">)</span>              =&gt; <a href="../../../../record/net/liftweb/record/Field.scala.html#49816" title="(in: net.liftweb.common.Box[JSONSubRecordArrayField.this.MyType])net.liftweb.common.Box[JSONSubRecordArrayField.this.MyType]">setBox</a><span class="delimiter">(</span><a href="#59520" title="(jvalues: List[net.liftweb.json.JsonAST.JValue])net.liftweb.common.Box[List[SubRecordType]]">fromJValues</a><span class="delimiter">(</span><a href="#59771" title="List[net.liftweb.json.JsonAST.JValue]">jvalues</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="keyword">case</span> <a title="net.liftweb.common.Box[JSONSubRecordArrayField.this.MyType]" id="59772">other</a>                        =&gt; <a href="../../../../record/net/liftweb/record/Field.scala.html#49816" title="(in: net.liftweb.common.Box[JSONSubRecordArrayField.this.MyType])net.liftweb.common.Box[JSONSubRecordArrayField.this.MyType]">setBox</a><span class="delimiter">(</span><a href="../../../../record/net/liftweb/record/Field.scala.html#55623" title="(what: String, notA: AnyRef)net.liftweb.common.Failure">expectedA</a><span class="delimiter">(</span><span title="java.lang.String(&quot;JArray containing &quot;)" class="string">&quot;JArray containing &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#59528" title="net.liftweb.couchdb.JSONMetaRecord[SubRecordType]">valueMeta</a>.<span title="()java.lang.Class[_]">getClass</span>.<span title="()java.lang.Class[_ &gt;: ?0]">getSuperclass</span>.<span title="()java.lang.String">getName</span>, <a href="#59772" title="net.liftweb.json.JsonAST.JValue">other</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>


        </pre>
    </body>
</html>