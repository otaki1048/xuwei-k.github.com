<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>couchdb/net/liftweb/couchdb/CouchRecord.scala</title>
        <script type="text/javascript" src="../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/*
 * Copyright 2010-2011 WorldWide Conferencing, LLC
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */</span>

<span class="keyword">package</span> net.liftweb
<span class="keyword">package</span> couchdb

<span class="keyword">import</span> scala.collection.immutable.Map
<span class="keyword">import</span> dispatch.<span class="delimiter">{</span>Handler, Http<span class="delimiter">}</span>
<span class="keyword">import</span> net.liftweb.common.<span class="delimiter">{</span>Box, Empty, Failure, Full<span class="delimiter">}</span>
<span class="keyword">import</span> <a href="../../../../common/net/liftweb/common/Box.scala.html#10572" title="object net.liftweb.common.Box">Box</a>.<span class="delimiter">{</span>box2Iterable, option2Box<span class="delimiter">}</span>
<span class="keyword">import</span> net.liftweb.json.<a href="../../../../json/net/liftweb/json/JsonAST.scala.html#11132" title="object net.liftweb.json.JsonAST">JsonAST</a>.<span class="delimiter">{</span>JField, JString, JValue<span class="delimiter">}</span>
<span class="keyword">import</span> net.liftweb.record.field.OptionalStringField
<span class="keyword">import</span> net.liftweb.util.<a href="../../../../util/net/liftweb/util/ControlHelpers.scala.html#13215" title="object net.liftweb.util.ControlHelpers">ControlHelpers</a>.tryo
<span class="keyword">import</span> <a href="DocumentHelpers.scala.html#10842" title="object net.liftweb.couchdb.DocumentHelpers">DocumentHelpers</a>.jobjectToJObjectExtension

<span class="keyword">object</span> <a title="object net.liftweb.couchdb.CouchDB" id="10768">CouchDB</a> <span title="ScalaObject" class="delimiter">{</span>
  <span class="comment">/** Default database instance of the application */</span>
  <span class="keyword">var</span> <a title="net.liftweb.couchdb.Database" id="48631">defaultDatabase</a>: <a href="Database.scala.html#10806" title="net.liftweb.couchdb.Database">Database</a> = <a href="Database.scala.html#48713" title="(database: String)net.liftweb.couchdb.Database" class="keyword">new</a> <a href="Database.scala.html#10806" title="net.liftweb.couchdb.Database">Database</a><span class="delimiter">(</span><span title="java.lang.String(&quot;default&quot;)" class="string">&quot;default&quot;</span><span class="delimiter">)</span>
<span class="delimiter">}</span>

<span class="comment">/** Base trait of records that can be stored in CouchDB */</span>
<span class="keyword">trait</span> <a title="trait CouchRecord[MyType &lt;: net.liftweb.couchdb.CouchRecord[MyType]] extends java.lang.Object with net.liftweb.couchdb.JSONRecord[MyType] with ScalaObject" id="10770">CouchRecord</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: net.liftweb.couchdb.CouchRecord[MyType]" id="10771">MyType</a> &lt;: CouchRecord<span class="delimiter">[</span>MyType<span class="delimiter">]</span><span class="delimiter">]</span> <span title="ScalaObject" class="keyword">extends</span> <a href="JSONRecord.scala.html#10867" title="net.liftweb.couchdb.JSONRecord[MyType]">JSONRecord</a><span class="delimiter">[</span>MyType<span class="delimiter">]</span> <span class="delimiter">{</span>
  self: MyType =&gt;

  <span class="comment">/** Refine meta to require a CouchMetaRecord */</span>
  <span class="keyword">def</span> <a title="=&gt; net.liftweb.couchdb.CouchMetaRecord[MyType]" id="49148">meta</a>: <a href="#10772" title="net.liftweb.couchdb.CouchMetaRecord[MyType]">CouchMetaRecord</a><span class="delimiter">[</span>MyType<span class="delimiter">]</span>

  <span class="comment">/** The mandatory _id field */</span>
  <span class="keyword">object</span> <a title="object CouchRecord.this.id" id="49149">id</a> <span title="ScalaObject" class="keyword">extends</span> <a href="../../../../record/net/liftweb/record/field/StringField.scala.html#12814" title="net.liftweb.record.field.OptionalStringField[MyType]">OptionalStringField</a><span class="delimiter">(</span><a href="#10770" title="MyType" class="keyword">this</a>, <span title="Int(100)" class="int">100</span><span class="delimiter">)</span> <span class="keyword">with</span> <a href="JSONRecord.scala.html#10873" title="net.liftweb.couchdb.JSONField">JSONField</a> <span class="delimiter">{</span>
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; net.liftweb.common.Full[java.lang.String]" id="49892">jsonName</a> = <a href="../../../../common/net/liftweb/common/Box.scala.html#27086" title="(value: java.lang.String)net.liftweb.common.Full[java.lang.String]">Full</a><span class="delimiter">(</span><span title="java.lang.String(&quot;_id&quot;)" class="string">&quot;_id&quot;</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/** The mandatory _rev field */</span>
  <span class="keyword">object</span> <a title="object CouchRecord.this.rev" id="49151">rev</a> <span title="ScalaObject" class="keyword">extends</span> <a href="../../../../record/net/liftweb/record/field/StringField.scala.html#12814" title="net.liftweb.record.field.OptionalStringField[MyType]">OptionalStringField</a><span class="delimiter">(</span><a href="#10770" title="MyType" class="keyword">this</a>, <span title="Int(100)" class="int">100</span><span class="delimiter">)</span> <span class="keyword">with</span> <a href="JSONRecord.scala.html#10873" title="net.liftweb.couchdb.JSONField">JSONField</a> <span class="delimiter">{</span>
    <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; net.liftweb.common.Full[java.lang.String]" id="49945">jsonName</a> = <a href="../../../../common/net/liftweb/common/Box.scala.html#27086" title="(value: java.lang.String)net.liftweb.common.Full[java.lang.String]">Full</a><span class="delimiter">(</span><span title="java.lang.String(&quot;_rev&quot;)" class="string">&quot;_rev&quot;</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/** By default include a &quot;type&quot; field with value calculated by the typeName method */</span>
  <span class="keyword">override</span> <span class="keyword">def</span> <a title="=&gt; List[net.liftweb.json.JsonAST.JField]" id="49153">fixedAdditionalJFields</a>: <span title="List[net.liftweb.json.JsonAST.JField]">List</span><span class="delimiter">[</span>JField<span class="delimiter">]</span> = <a href="../../../../json/net/liftweb/json/JsonAST.scala.html#50050" title="(name: String, value: net.liftweb.json.JsonAST.JValue)net.liftweb.json.JsonAST.JField">JField</a><span class="delimiter">(</span><span title="java.lang.String(&quot;type&quot;)" class="string">&quot;type&quot;</span>, <a href="../../../../json/net/liftweb/json/JsonAST.scala.html#50133" title="(s: String)net.liftweb.json.JsonAST.JString">JString</a><span class="delimiter">(</span><a href="#49154" title="=&gt; String">typeName</a><span class="delimiter">)</span><span class="delimiter">)</span><a href="#49983" title="(x: net.liftweb.json.JsonAST.JField)List[net.liftweb.json.JsonAST.JField]">::</a><span title="object Nil">Nil</span>

  <span class="comment">/**
   * The value of the &quot;type&quot; field for this class of record. Only used with default implementation of extraEncodedFields.
   * The default definition is the unqualified class name (e.g. the fully-qualified class name with the package name stripped)
   */</span>
  <span class="keyword">def</span> <a title="=&gt; String" id="49154">typeName</a>: <span title="String">String</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="java.lang.String" id="50153">className</a> = <a href="#10770" title="()java.lang.Class[_]">getClass</a>.<span title="()java.lang.String">getName</span>

    <a href="#50153" title="java.lang.String">className</a>.<span title="(x$1: Int)Int">lastIndexOf</span><span class="delimiter">(</span><span title="Int(46)" class="char">'.'</span><span class="delimiter">)</span> <span title="String" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <span title="java.lang.String">-</span><span class="int">1</span> =&gt; <a href="#50153" title="java.lang.String">className</a>
      <span class="keyword">case</span> <a title="java.lang.String" id="50159">n</a>  =&gt; <a href="#50153" title="java.lang.String">className</a>.<span title="(x$1: Int)java.lang.String">substring</span><span class="delimiter">(</span><a href="#50159" title="Int">n</a><span title="(x: Int)Int">+</span><span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="comment">/** Save the record instance and return it */</span>
  <span class="keyword">def</span> <a title="=&gt; net.liftweb.common.Box[MyType]" id="49155">save</a>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[MyType]">Box</a><span class="delimiter">[</span>MyType<span class="delimiter">]</span> = <span class="keyword">for</span> <span class="delimiter">(</span><a title="Unit" id="50188">ok</a> &lt;- <a href="#49148" title="=&gt; net.liftweb.couchdb.CouchMetaRecord[MyType]">meta</a>.<a href="#49242" title="(inst: MyType)net.liftweb.common.Box[Unit]">save</a><a href="../../../../common/net/liftweb/common/Box.scala.html#27020" title="(f: Unit =&gt; MyType)net.liftweb.common.Box[MyType]" class="delimiter">(</a><a href="#10770" title="MyType" class="keyword">this</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="keyword">yield</span> <a href="#10770" title="MyType" class="keyword">this</a>

  <span class="comment">/**
  * Save the instance and return the instance
  */</span>
  <span class="keyword">override</span> <span class="keyword">def</span> <a title="()net.liftweb.common.Box[MyType]" id="49156">saveTheRecord</a><span class="delimiter">(</span><span class="delimiter">)</span>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[MyType]">Box</a><span class="delimiter">[</span>MyType<span class="delimiter">]</span> = <a href="#10770" title="CouchRecord.this.type" class="keyword">this</a>.<a href="#49155" title="=&gt; net.liftweb.common.Box[MyType]">save</a>

  <span class="comment">/** Return whether this instance was saved into the backing store or not */</span>
  <span class="keyword">def</span> <a title="=&gt; Boolean" id="49157">saved_?</a> : <span title="Boolean">Boolean</span> = <a href="#49148" title="=&gt; net.liftweb.couchdb.CouchMetaRecord[MyType]">meta</a>.<a href="#49243" title="(inst: MyType)Boolean">saved_?</a><span class="delimiter">(</span><a href="#10770" title="MyType" class="keyword">this</a><span class="delimiter">)</span>

  <span class="comment">/** Delete the record instance from the backing store */</span>
  <span class="keyword">def</span> <a title="=&gt; net.liftweb.common.Box[Unit]" id="49158">delete_!</a> : <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[Unit]">Box</a><span class="delimiter">[</span>Unit<span class="delimiter">]</span> = <a href="#49159" title="=&gt; Boolean">canDelete_?</a> <span title="net.liftweb.common.Box[Unit]" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <span title="net.liftweb.common.Box[Unit]" class="keyword">true</span> =&gt; <a href="../../../../record/net/liftweb/record/Record.scala.html#49120" title="(f: =&gt; net.liftweb.common.Box[Unit])net.liftweb.common.Box[Unit]">runSafe</a><span class="delimiter">(</span><a href="#49148" title="=&gt; net.liftweb.couchdb.CouchMetaRecord[MyType]">meta</a>.<a href="#49244" title="(inst: MyType)net.liftweb.common.Box[Unit]">delete_!</a><span class="delimiter">(</span><a href="#10770" title="MyType" class="keyword">this</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="keyword">case</span> <span title="net.liftweb.common.Failure" class="keyword">false</span> =&gt; <a href="../../../../common/net/liftweb/common/Box.scala.html#37829" title="(msg: String)net.liftweb.common.Failure">Failure</a><span class="delimiter">(</span><span title="java.lang.String(&quot;can\'t delete&quot;)" class="string">&quot;can't delete&quot;</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/** Can this record instance be deleted (e.g. is it in the backing store in the first place?) */</span>
  <span class="keyword">def</span> <a title="=&gt; Boolean" id="49159">canDelete_?</a> : <span title="Boolean">Boolean</span> = <a href="#49148" title="=&gt; net.liftweb.couchdb.CouchMetaRecord[MyType]">meta</a>.<a href="#49243" title="(inst: MyType)Boolean">saved_?</a><span class="delimiter">(</span><a href="#10770" title="MyType" class="keyword">this</a><span class="delimiter">)</span>

  <span class="comment">/** The database this record is associated with */</span>
  <span class="keyword">private</span> <span class="keyword">var</span> <a title="net.liftweb.common.Box[net.liftweb.couchdb.Database]" id="49161">_database</a>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[net.liftweb.couchdb.Database]">Box</a><span class="delimiter">[</span>Database<span class="delimiter">]</span> = <a href="../../../../common/net/liftweb/common/Box.scala.html#10581" title="object net.liftweb.common.Empty">Empty</a>

  <span class="comment">/** Return the database this record is associated with, determining it if necessary */</span>
  <span class="keyword">def</span> <a title="=&gt; net.liftweb.couchdb.Database" id="49163">database</a>: <a href="Database.scala.html#10806" title="net.liftweb.couchdb.Database">Database</a> = <a href="#49161" title="=&gt; net.liftweb.common.Box[net.liftweb.couchdb.Database]">_database</a> <span title="net.liftweb.couchdb.Database" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <span title="net.liftweb.couchdb.Database">Full</span><span class="delimiter">(</span><a title="net.liftweb.couchdb.Database" id="50220">database</a><span class="delimiter">)</span> =&gt; <a href="#50220" title="net.liftweb.couchdb.Database">database</a>
    <span class="keyword">case</span> <span title="net.liftweb.couchdb.Database">_</span> =&gt;
      <a href="#49161" title="(x$1: net.liftweb.common.Box[net.liftweb.couchdb.Database])Unit">_database</a> = <a href="../../../../common/net/liftweb/common/Box.scala.html#27086" title="(value: net.liftweb.couchdb.Database)net.liftweb.common.Full[net.liftweb.couchdb.Database]">Full</a><span class="delimiter">(</span><a href="#49166" title="=&gt; net.liftweb.couchdb.Database">_calcDatabase</a><span class="delimiter">)</span>
      <a href="#49161" title="=&gt; net.liftweb.common.Box[net.liftweb.couchdb.Database]">_database</a>.<a href="../../../../common/net/liftweb/common/Box.scala.html#27015" title="=&gt; net.liftweb.couchdb.Database">open_!</a>
  <span class="delimiter">}</span>

  <span class="comment">/** Set the current database (if any) for this record */</span>
  <span class="keyword">def</span> <a title="(database: net.liftweb.couchdb.Database)Unit" id="49164">database_=</a> <span class="delimiter">(</span><a title="net.liftweb.couchdb.Database" id="50226">database</a>: <a href="Database.scala.html#10806" title="net.liftweb.couchdb.Database">Database</a><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <a href="#49161" title="(x$1: net.liftweb.common.Box[net.liftweb.couchdb.Database])Unit">_database</a> = <a href="../../../../common/net/liftweb/common/Box.scala.html#27086" title="(value: net.liftweb.couchdb.Database)net.liftweb.common.Full[net.liftweb.couchdb.Database]">Full</a><span class="delimiter">(</span><a href="#50226" title="net.liftweb.couchdb.Database">database</a><span class="delimiter">)</span>

  <span class="comment">/** Override to calculate which database to use on a per-record basis */</span>
  <span class="keyword">def</span> <a title="=&gt; PartialFunction[MyType,net.liftweb.couchdb.Database]" id="49165">calculateDatabase</a>: <span title="PartialFunction[MyType,net.liftweb.couchdb.Database]">PartialFunction</span><span class="delimiter">[</span>MyType, Database<span class="delimiter">]</span> = <span title="object scala.collection.immutable.Map">Map</span>.<span title="scala.collection.immutable.Map[MyType,Nothing]">empty</span>

  <span class="comment">/**
   * Calculate the database for this record, falling back to the CouchMetaRecord's default database if
   * calculateDatabase does not apply to this instance
   */</span>
  <span class="keyword">def</span> <a title="=&gt; net.liftweb.couchdb.Database" id="49166">_calcDatabase</a>: <a href="Database.scala.html#10806" title="net.liftweb.couchdb.Database">Database</a> = <span title="net.liftweb.couchdb.Database" class="keyword">if</span> <span class="delimiter">(</span><a href="#49165" title="=&gt; PartialFunction[MyType,net.liftweb.couchdb.Database]">calculateDatabase</a>.<span title="(x: MyType)Boolean">isDefinedAt</span><span class="delimiter">(</span><a href="#10770" title="MyType" class="keyword">this</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="#49165" title="(v1: MyType)net.liftweb.couchdb.Database">calculateDatabase</a><span class="delimiter">(</span><a href="#10770" title="MyType" class="keyword">this</a><span class="delimiter">)</span> <span class="keyword">else</span> <a href="#49148" title="=&gt; net.liftweb.couchdb.CouchMetaRecord[MyType]">meta</a>.<a href="#49240" title="=&gt; net.liftweb.couchdb.Database">defaultDatabase</a>
<span class="delimiter">}</span>

<span class="comment">/** Base trait of meta records for records that can be stored in CouchDB */</span>
<span class="keyword">trait</span> <a title="trait CouchMetaRecord[BaseRecord &lt;: net.liftweb.couchdb.CouchRecord[BaseRecord]] extends java.lang.Object with net.liftweb.couchdb.JSONMetaRecord[BaseRecord] with ScalaObject" id="10772">CouchMetaRecord</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: net.liftweb.couchdb.CouchRecord[BaseRecord]" id="10773">BaseRecord</a> &lt;: CouchRecord<span class="delimiter">[</span>BaseRecord<span class="delimiter">]</span><span class="delimiter">]</span> <span title="ScalaObject" class="keyword">extends</span> <a href="JSONRecord.scala.html#10871" title="net.liftweb.couchdb.JSONMetaRecord[BaseRecord]">JSONMetaRecord</a><span class="delimiter">[</span>BaseRecord<span class="delimiter">]</span> <span class="delimiter">{</span>
  self: BaseRecord =&gt;

  <span class="comment">/** Get the default Database to use, if the record's calculateDatabase function does not provide one. Defaults to CouchDB.defaultDatabase */</span>
  <span class="keyword">def</span> <a title="=&gt; net.liftweb.couchdb.Database" id="49240">defaultDatabase</a>: <a href="Database.scala.html#10806" title="net.liftweb.couchdb.Database">Database</a> = <a href="#10768" title="object net.liftweb.couchdb.CouchDB">CouchDB</a>.<a href="#48631" title="=&gt; net.liftweb.couchdb.Database">defaultDatabase</a>

  <span class="comment">/** Get an Http instance to use when accessing CouchDB */</span>
  <span class="keyword">def</span> <a title="=&gt; dispatch.Http" id="49241">http</a>: <span title="dispatch.Http">Http</span> = <span title="object dispatch.Http">Http</span>

  <span class="comment">/** Save the record instance in the backing store */</span>
  <span class="keyword">def</span> <a title="(inst: BaseRecord)net.liftweb.common.Box[Unit]" id="49242">save</a><span class="delimiter">(</span><a title="BaseRecord" id="50180">inst</a>: <a href="#10773" title="BaseRecord">BaseRecord</a><span class="delimiter">)</span>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[Unit]">Box</a><span class="delimiter">[</span>Unit<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <a href="../../../../record/net/liftweb/record/MetaRecord.scala.html#49212" title="(inst: BaseRecord, f: net.liftweb.record.LifecycleCallbacks =&gt; Any)Unit">foreachCallback</a><span class="delimiter">(</span><a href="#50180" title="BaseRecord">inst</a>, <a href="#50331" title="net.liftweb.record.LifecycleCallbacks">_</a>.<a href="../../../../record/net/liftweb/record/Field.scala.html#50336" title="=&gt; Unit">beforeSave</a><span class="delimiter">)</span>
    <span class="keyword">try</span> <span class="delimiter">{</span>
      <span class="keyword">for</span> <span class="delimiter">(</span><a title="net.liftweb.json.JsonAST.JObject" id="50406">newDoc</a> &lt;- <a href="#49241" title="(hand: dispatch.Handler[net.liftweb.common.Box[net.liftweb.json.JsonAST.JObject]])net.liftweb.common.Box[net.liftweb.json.JsonAST.JObject]">http</a><a href="../../../../common/net/liftweb/common/Box.scala.html#27020" title="(f: net.liftweb.json.JsonAST.JObject =&gt; Unit)net.liftweb.common.Box[Unit]" class="delimiter">(</a><a href="#50180" title="BaseRecord">inst</a>.<a href="#49163" title="=&gt; net.liftweb.couchdb.Database">database</a> <a href="Database.scala.html#48725" title="(doc: net.liftweb.json.JsonAST.JObject)dispatch.Handler[net.liftweb.common.Box[net.liftweb.json.JsonAST.JObject]]">store</a> <a href="#50180" title="BaseRecord">inst</a>.<a href="../../../../record/net/liftweb/record/Record.scala.html#49129" title="=&gt; net.liftweb.json.JsonAST.JObject">asJValue</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="keyword">yield</span> <span class="delimiter">{</span>
        <a href="#50180" title="BaseRecord">inst</a>.<a href="#49149" title="object inst.id">id</a>.<a href="../../../../record/net/liftweb/record/Field.scala.html#49816" title="(in: net.liftweb.common.Box[inst.id.MyType])net.liftweb.common.Box[inst.id.MyType]">setBox</a><span class="delimiter">(</span><a href="DocumentHelpers.scala.html#48627" title="implicit net.liftweb.couchdb.DocumentHelpers.jobjectToJObjectExtension : (obj: net.liftweb.json.JsonAST.JObject)net.liftweb.couchdb.DocumentHelpers.JObjectExtension">newDoc</a>.<a href="DocumentHelpers.scala.html#50415" title="=&gt; net.liftweb.common.Box[String]">_id</a><span class="delimiter">)</span>
        <a href="#50180" title="BaseRecord">inst</a>.<a href="#49151" title="object inst.rev">rev</a>.<a href="../../../../record/net/liftweb/record/Field.scala.html#49816" title="(in: net.liftweb.common.Box[inst.rev.MyType])net.liftweb.common.Box[inst.rev.MyType]">setBox</a><span class="delimiter">(</span><a href="DocumentHelpers.scala.html#48627" title="implicit net.liftweb.couchdb.DocumentHelpers.jobjectToJObjectExtension : (obj: net.liftweb.json.JsonAST.JObject)net.liftweb.couchdb.DocumentHelpers.JObjectExtension">newDoc</a>.<a href="DocumentHelpers.scala.html#50416" title="=&gt; net.liftweb.common.Box[String]">_rev</a><span class="delimiter">)</span>
        <span title="Unit" class="delimiter">(</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span> <span class="keyword">finally</span> <span class="delimiter">{</span>
      <a href="../../../../record/net/liftweb/record/MetaRecord.scala.html#49212" title="(inst: BaseRecord, f: net.liftweb.record.LifecycleCallbacks =&gt; Any)Unit">foreachCallback</a><span class="delimiter">(</span><a href="#50180" title="BaseRecord">inst</a>, <a href="#50443" title="net.liftweb.record.LifecycleCallbacks">_</a>.<a href="../../../../record/net/liftweb/record/Field.scala.html#50339" title="=&gt; Unit">afterSave</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="comment">/** Was the record instance saved in the backing store? */</span>
  <span class="keyword">def</span> <a title="(inst: BaseRecord)Boolean" id="49243">saved_?</a> <span class="delimiter">(</span><a title="BaseRecord" id="50195">inst</a>: <a href="#10773" title="BaseRecord">BaseRecord</a><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> = <a href="#50195" title="BaseRecord">inst</a>.<a href="#49149" title="object inst.id">id</a>.<a href="../../../../record/net/liftweb/record/Field.scala.html#49827" title="=&gt; net.liftweb.common.Box[inst.id.MyType]">valueBox</a>.<a href="../../../../common/net/liftweb/common/Box.scala.html#27014" title="=&gt; Boolean">isDefined</a> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#50195" title="BaseRecord">inst</a>.<a href="#49151" title="object inst.rev">rev</a>.<a href="../../../../record/net/liftweb/record/Field.scala.html#49827" title="=&gt; net.liftweb.common.Box[inst.rev.MyType]">valueBox</a>.<a href="../../../../common/net/liftweb/common/Box.scala.html#27014" title="=&gt; Boolean">isDefined</a>

  <span class="comment">/** Delete the instance from the backing store. Only works if the instance is the current revision in the database. */</span>
  <span class="keyword">def</span> <a title="(inst: BaseRecord)net.liftweb.common.Box[Unit]" id="49244">delete_!</a> <span class="delimiter">(</span><a title="BaseRecord" id="50207">inst</a>: <a href="#10773" title="BaseRecord">BaseRecord</a><span class="delimiter">)</span>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[Unit]">Box</a><span class="delimiter">[</span>Unit<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <a href="../../../../record/net/liftweb/record/MetaRecord.scala.html#49212" title="(inst: BaseRecord, f: net.liftweb.record.LifecycleCallbacks =&gt; Any)Unit">foreachCallback</a><span class="delimiter">(</span><a href="#50207" title="BaseRecord">inst</a>, <a href="#50449" title="net.liftweb.record.LifecycleCallbacks">_</a>.<a href="../../../../record/net/liftweb/record/Field.scala.html#50342" title="=&gt; Unit">beforeDelete</a><span class="delimiter">)</span>
    <span class="keyword">try</span> <span class="delimiter">{</span>
      <span class="keyword">for</span> <span class="delimiter">{</span>
        <a title="inst.id.MyType" id="50456">id</a> &lt;- <a href="#50207" title="BaseRecord">inst</a>.<a href="#49149" title="object inst.id">id</a>.<a href="../../../../common/net/liftweb/common/Box.scala.html#27023" title="(f: inst.id.MyType =&gt; net.liftweb.common.Box[Unit])net.liftweb.common.Box[Unit]">valueBox</a>
        <a title="inst.rev.MyType" id="50461">rev</a> &lt;- <a href="#50207" title="BaseRecord">inst</a>.<a href="#49151" title="object inst.rev">rev</a>.<a href="../../../../common/net/liftweb/common/Box.scala.html#27023" title="(f: inst.rev.MyType =&gt; net.liftweb.common.Box[Unit])net.liftweb.common.Box[Unit]">valueBox</a>
        <a title="Unit" id="50595">deletedOk</a> &lt;- <a href="../../../../util/net/liftweb/util/ControlHelpers.scala.html#48608" title="(f: =&gt; Unit)net.liftweb.common.Box[Unit]">tryo</a><a href="../../../../common/net/liftweb/common/Box.scala.html#27020" title="(f: Unit =&gt; Unit)net.liftweb.common.Box[Unit]" class="delimiter">(</a><a href="#49241" title="(hand: dispatch.Handler[Unit])Unit">http</a><span class="delimiter">(</span><a href="#50207" title="BaseRecord">inst</a>.<a href="Database.scala.html#48719" title="(id: String)net.liftweb.couchdb.Document">database</a><span class="delimiter">(</span><a href="#50456" title="inst.id.MyType">id</a><span class="delimiter">)</span> <a href="Database.scala.html#50555" title="(rev: String)net.liftweb.couchdb.DocumentRevision">@@</a> <a href="#50461" title="inst.rev.MyType">rev</a> <a href="Database.scala.html#50572" title="=&gt; dispatch.Handler[Unit]">delete</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">yield</span> <span class="delimiter">{</span>
        <a href="#50207" title="BaseRecord">inst</a>.<a href="#49149" title="object inst.id">id</a>.<a href="../../../../record/net/liftweb/record/Field.scala.html#49816" title="(in: net.liftweb.common.Box[inst.id.MyType])net.liftweb.common.Box[inst.id.MyType]">setBox</a><span class="delimiter">(</span><a href="../../../../common/net/liftweb/common/Box.scala.html#10581" title="object net.liftweb.common.Empty">Empty</a><span class="delimiter">)</span>
        <a href="#50207" title="BaseRecord">inst</a>.<a href="#49151" title="object inst.rev">rev</a>.<a href="../../../../record/net/liftweb/record/Field.scala.html#49816" title="(in: net.liftweb.common.Box[inst.rev.MyType])net.liftweb.common.Box[inst.rev.MyType]">setBox</a><span class="delimiter">(</span><a href="../../../../common/net/liftweb/common/Box.scala.html#10581" title="object net.liftweb.common.Empty">Empty</a><span class="delimiter">)</span>
        <span title="Unit" class="delimiter">(</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span> <span class="keyword">finally</span> <span class="delimiter">{</span>
      <a href="../../../../record/net/liftweb/record/MetaRecord.scala.html#49212" title="(inst: BaseRecord, f: net.liftweb.record.LifecycleCallbacks =&gt; Any)Unit">foreachCallback</a><span class="delimiter">(</span><a href="#50207" title="BaseRecord">inst</a>, <a href="#50602" title="net.liftweb.record.LifecycleCallbacks">_</a>.<a href="../../../../record/net/liftweb/record/Field.scala.html#50343" title="=&gt; Unit">afterDelete</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="comment">/** Query a single document by _id from the default database */</span>
  <span class="keyword">def</span> <a title="(id: String)net.liftweb.common.Box[BaseRecord]" id="49245">fetch</a><span class="delimiter">(</span><a title="String" id="50605">id</a>: <span title="String">String</span><span class="delimiter">)</span>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[BaseRecord]">Box</a><span class="delimiter">[</span>BaseRecord<span class="delimiter">]</span> = <a href="#49246" title="(database: net.liftweb.couchdb.Database, id: String)net.liftweb.common.Box[BaseRecord]">fetchFrom</a><span class="delimiter">(</span><a href="#49240" title="=&gt; net.liftweb.couchdb.Database">defaultDatabase</a>, <a href="#50605" title="String">id</a><span class="delimiter">)</span>

  <span class="comment">/** Query a single document by _id from the given database */</span>
  <span class="keyword">def</span> <a title="(database: net.liftweb.couchdb.Database, id: String)net.liftweb.common.Box[BaseRecord]" id="49246">fetchFrom</a><span class="delimiter">(</span><a title="net.liftweb.couchdb.Database" id="50607">database</a>: <a href="Database.scala.html#10806" title="net.liftweb.couchdb.Database">Database</a>, <a title="String" id="50608">id</a>: <span title="String">String</span><span class="delimiter">)</span>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[BaseRecord]">Box</a><span class="delimiter">[</span>BaseRecord<span class="delimiter">]</span> = <a href="../../../../util/net/liftweb/util/ControlHelpers.scala.html#48608" title="(f: =&gt; net.liftweb.json.JsonAST.JObject)net.liftweb.common.Box[net.liftweb.json.JsonAST.JObject]">tryo</a><span class="delimiter">(</span><a href="#49241" title="(hand: dispatch.Handler[net.liftweb.json.JsonAST.JObject])net.liftweb.json.JsonAST.JObject">http</a><span class="delimiter">(</span><a href="Database.scala.html#48719" title="(id: String)net.liftweb.couchdb.Document">database</a><span class="delimiter">(</span><a href="#50608" title="String">id</a><span class="delimiter">)</span> <a href="Database.scala.html#50562" title="=&gt; dispatch.Handler[net.liftweb.json.JsonAST.JObject]">fetch</a><span class="delimiter">)</span><span class="delimiter">)</span>.<a href="../../../../common/net/liftweb/common/Box.scala.html#27023" title="(f: net.liftweb.json.JsonAST.JObject =&gt; net.liftweb.common.Box[BaseRecord])net.liftweb.common.Box[BaseRecord]">flatMap</a><span class="delimiter">(</span><a href="../../../../record/net/liftweb/record/MetaRecord.scala.html#49208" title="(jvalue: net.liftweb.json.JsonAST.JValue)net.liftweb.common.Box[BaseRecord]">fromJValue</a><span class="delimiter">)</span>

  <span class="comment">/** Query a series of documents by _id from the default database */</span>
  <span class="keyword">def</span> <a title="(ids: String*)net.liftweb.common.Box[Seq[BaseRecord]]" id="49247">fetchMany</a><span class="delimiter">(</span><a title="String*" id="50671">ids</a>: <span title="String*">String</span>*<span class="delimiter">)</span>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[Seq[BaseRecord]]">Box</a><span class="delimiter">[</span>Seq<span class="delimiter">[</span>BaseRecord<span class="delimiter">]</span><span class="delimiter">]</span> = <a href="#49248" title="(database: net.liftweb.couchdb.Database, ids: String*)net.liftweb.common.Box[Seq[BaseRecord]]">fetchManyFrom</a><span class="delimiter">(</span><a href="#49240" title="=&gt; net.liftweb.couchdb.Database">defaultDatabase</a>, <a href="#50671" title="String*">ids</a>: _*<span class="delimiter">)</span>

  <span class="comment">/** Query a series of documents by _id from the given database */</span>
  <span class="keyword">def</span> <a title="(database: net.liftweb.couchdb.Database, ids: String*)net.liftweb.common.Box[Seq[BaseRecord]]" id="49248">fetchManyFrom</a><span class="delimiter">(</span><a title="net.liftweb.couchdb.Database" id="50673">database</a>: <a href="Database.scala.html#10806" title="net.liftweb.couchdb.Database">Database</a>, <a title="String*" id="50674">ids</a>: <span title="String*">String</span>*<span class="delimiter">)</span>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[Seq[BaseRecord]]">Box</a><span class="delimiter">[</span>Seq<span class="delimiter">[</span>BaseRecord<span class="delimiter">]</span><span class="delimiter">]</span> =
    <span class="keyword">for</span> <span class="delimiter">(</span><a title="net.liftweb.common.Box[net.liftweb.couchdb.QueryResults]" id="50763">resultBox</a> &lt;- <a href="../../../../util/net/liftweb/util/ControlHelpers.scala.html#48608" title="(f: =&gt; net.liftweb.common.Box[net.liftweb.couchdb.QueryResults])net.liftweb.common.Box[net.liftweb.common.Box[net.liftweb.couchdb.QueryResults]]">tryo</a><a href="../../../../common/net/liftweb/common/Box.scala.html#27023" title="(f: net.liftweb.common.Box[net.liftweb.couchdb.QueryResults] =&gt; net.liftweb.common.Box[Seq[BaseRecord]])net.liftweb.common.Box[Seq[BaseRecord]]" class="delimiter">(</a><a href="#49241" title="(hand: dispatch.Handler[net.liftweb.common.Box[net.liftweb.couchdb.QueryResults]])net.liftweb.common.Box[net.liftweb.couchdb.QueryResults]">http</a><span class="delimiter">(</span><a href="Database.scala.html#48721" title="(ids: Seq[String])net.liftweb.couchdb.AllDocs">database</a><span class="delimiter">(</span><a href="#50674" title="String*">ids</a><span class="delimiter">)</span> <a href="Database.scala.html#50716" title="=&gt; dispatch.Handler[net.liftweb.common.Box[net.liftweb.couchdb.QueryResults]]">query</a><span class="delimiter">)</span><span class="delimiter">)</span>; <a title="net.liftweb.couchdb.QueryResults" id="50768">result</a> &lt;- <a href="../../../../common/net/liftweb/common/Box.scala.html#27020" title="(f: net.liftweb.couchdb.QueryResults =&gt; Seq[BaseRecord])net.liftweb.common.Box[Seq[BaseRecord]]">resultBox</a><span class="delimiter">)</span>
      <span class="keyword">yield</span> <a href="#50768" title="net.liftweb.couchdb.QueryResults">result</a>.<a href="Database.scala.html#50776" title="=&gt; Seq[net.liftweb.couchdb.QueryRow]">rows</a>.<span title="(f: net.liftweb.couchdb.QueryRow =&gt; scala.collection.GenTraversableOnce[BaseRecord])(implicit bf: scala.collection.generic.CanBuildFrom[Seq[net.liftweb.couchdb.QueryRow],BaseRecord,Seq[BaseRecord]])Seq[BaseRecord]">flatMap</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.Seq.Coll,BaseRecord,Seq[BaseRecord]]" class="delimiter">(</span><a href="#50796" title="net.liftweb.couchdb.QueryRow">_</a>.<a href="Database.scala.html#50808" title="=&gt; net.liftweb.common.Box[net.liftweb.json.JsonAST.JObject]">doc</a>.<a href="../../../../common/net/liftweb/common/Box.scala.html#27023" title="(f: net.liftweb.json.JsonAST.JObject =&gt; net.liftweb.common.Box[BaseRecord])net.liftweb.common.Box[BaseRecord]">flatMap</a><a href="../../../../common/net/liftweb/common/Box.scala.html#28624" title="(in: net.liftweb.common.Box[BaseRecord])Iterable[BaseRecord]" class="delimiter">(</a><a href="../../../../record/net/liftweb/record/MetaRecord.scala.html#49208" title="(jvalue: net.liftweb.json.JsonAST.JValue)net.liftweb.common.Box[BaseRecord]">fromJValue</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="comment">/**
   * Query records from the default database by document id. includeDocs is always on for this type of query.
   * Filter refines the query (e.g. by key), see Queryable.
   * Note that this is probably not very useful, as there is no way to constrain the documents retrieved by type
   */</span>
  <span class="keyword">def</span> <a title="(filter: net.liftweb.couchdb.AllDocs =&gt; net.liftweb.couchdb.AllDocs)net.liftweb.common.Box[Seq[BaseRecord]]" id="49249">all</a><span class="delimiter">(</span><a title="net.liftweb.couchdb.AllDocs =&gt; net.liftweb.couchdb.AllDocs" id="50906">filter</a>: AllDocs =&gt; AllDocs<span class="delimiter">)</span>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[Seq[BaseRecord]]">Box</a><span class="delimiter">[</span>Seq<span class="delimiter">[</span>BaseRecord<span class="delimiter">]</span><span class="delimiter">]</span> = <a href="#49250" title="(database: net.liftweb.couchdb.Database, filter: net.liftweb.couchdb.AllDocs =&gt; net.liftweb.couchdb.AllDocs)net.liftweb.common.Box[Seq[BaseRecord]]">allIn</a><span class="delimiter">(</span><a href="#49240" title="=&gt; net.liftweb.couchdb.Database">defaultDatabase</a>, <a href="#50906" title="net.liftweb.couchdb.AllDocs =&gt; net.liftweb.couchdb.AllDocs">filter</a><span class="delimiter">)</span>

  <span class="comment">/**
   * Query records from the given database by document id. includeDocs is always on for this type of query.
   * Filter refines the query (e.g. by key), see Queryable.
   * Note that this is probably not very useful, as there is no way to constrain the documents retrieved by type
   */</span>
  <span class="keyword">def</span> <a title="(database: net.liftweb.couchdb.Database, filter: net.liftweb.couchdb.AllDocs =&gt; net.liftweb.couchdb.AllDocs)net.liftweb.common.Box[Seq[BaseRecord]]" id="49250">allIn</a><span class="delimiter">(</span><a title="net.liftweb.couchdb.Database" id="50908">database</a>: <a href="Database.scala.html#10806" title="net.liftweb.couchdb.Database">Database</a>, <a title="net.liftweb.couchdb.AllDocs =&gt; net.liftweb.couchdb.AllDocs" id="50909">filter</a>: AllDocs =&gt; AllDocs<span class="delimiter">)</span>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[Seq[BaseRecord]]">Box</a><span class="delimiter">[</span>Seq<span class="delimiter">[</span>BaseRecord<span class="delimiter">]</span><span class="delimiter">]</span> =
    <span class="keyword">for</span> <span class="delimiter">(</span><a title="net.liftweb.common.Box[net.liftweb.couchdb.QueryResults]" id="50962">resultBox</a> &lt;- <a href="../../../../util/net/liftweb/util/ControlHelpers.scala.html#48608" title="(f: =&gt; net.liftweb.common.Box[net.liftweb.couchdb.QueryResults])net.liftweb.common.Box[net.liftweb.common.Box[net.liftweb.couchdb.QueryResults]]">tryo</a><a href="../../../../common/net/liftweb/common/Box.scala.html#27023" title="(f: net.liftweb.common.Box[net.liftweb.couchdb.QueryResults] =&gt; net.liftweb.common.Box[Seq[BaseRecord]])net.liftweb.common.Box[Seq[BaseRecord]]" class="delimiter">(</a><a href="#49241" title="(hand: dispatch.Handler[net.liftweb.common.Box[net.liftweb.couchdb.QueryResults]])net.liftweb.common.Box[net.liftweb.couchdb.QueryResults]">http</a><span class="delimiter">(</span><a href="#50909" title="(v1: net.liftweb.couchdb.AllDocs)net.liftweb.couchdb.AllDocs">filter</a><span class="delimiter">(</span><a href="#50908" title="net.liftweb.couchdb.Database">database</a>.<a href="Database.scala.html#48718" title="=&gt; net.liftweb.couchdb.AllDocs">all</a>.<a href="Database.scala.html#50729" title="=&gt; net.liftweb.couchdb.AllDocs">includeDocs</a><span class="delimiter">)</span> <a href="Database.scala.html#50716" title="=&gt; dispatch.Handler[net.liftweb.common.Box[net.liftweb.couchdb.QueryResults]]">query</a><span class="delimiter">)</span><span class="delimiter">)</span>; <a title="net.liftweb.couchdb.QueryResults" id="50967">result</a> &lt;- <a href="../../../../common/net/liftweb/common/Box.scala.html#27020" title="(f: net.liftweb.couchdb.QueryResults =&gt; Seq[BaseRecord])net.liftweb.common.Box[Seq[BaseRecord]]">resultBox</a><span class="delimiter">)</span>
      <span class="keyword">yield</span> <a href="#50967" title="net.liftweb.couchdb.QueryResults">result</a>.<a href="Database.scala.html#50776" title="=&gt; Seq[net.liftweb.couchdb.QueryRow]">rows</a>.<span title="(f: net.liftweb.couchdb.QueryRow =&gt; scala.collection.GenTraversableOnce[BaseRecord])(implicit bf: scala.collection.generic.CanBuildFrom[Seq[net.liftweb.couchdb.QueryRow],BaseRecord,Seq[BaseRecord]])Seq[BaseRecord]">flatMap</span> <span title="scala.collection.generic.CanBuildFrom[scala.collection.Seq.Coll,BaseRecord,Seq[BaseRecord]]" class="delimiter">{</span> <a title="net.liftweb.couchdb.QueryRow" id="50984">row</a> =&gt; <a href="#50984" title="net.liftweb.couchdb.QueryRow">row</a>.<a href="Database.scala.html#50808" title="=&gt; net.liftweb.common.Box[net.liftweb.json.JsonAST.JObject]">doc</a>.<a href="../../../../common/net/liftweb/common/Box.scala.html#27023" title="(f: net.liftweb.json.JsonAST.JObject =&gt; net.liftweb.common.Box[BaseRecord])net.liftweb.common.Box[BaseRecord]">flatMap</a><a href="../../../../common/net/liftweb/common/Box.scala.html#28624" title="(in: net.liftweb.common.Box[BaseRecord])Iterable[BaseRecord]" class="delimiter">(</a><a href="../../../../record/net/liftweb/record/MetaRecord.scala.html#49208" title="(jvalue: net.liftweb.json.JsonAST.JValue)net.liftweb.common.Box[BaseRecord]">fromJValue</a><span class="delimiter">)</span> <span class="delimiter">}</span>

  <span class="comment">/** Query using a view in the default database. */</span>
  <span class="keyword">def</span> <a title="(design: String, view: String)net.liftweb.common.Box[Seq[BaseRecord]]" id="49251">queryView</a><span class="delimiter">(</span><a title="String" id="51049">design</a>: <span title="String">String</span>, <a title="String" id="51050">view</a>: <span title="String">String</span><span class="delimiter">)</span>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[Seq[BaseRecord]]">Box</a><span class="delimiter">[</span>Seq<span class="delimiter">[</span>BaseRecord<span class="delimiter">]</span><span class="delimiter">]</span> =
    <a href="#49253" title="(database: net.liftweb.couchdb.Database, design: String, view: String, filter: net.liftweb.couchdb.View =&gt; net.liftweb.couchdb.View)net.liftweb.common.Box[Seq[BaseRecord]]">queryViewFrom</a><span class="delimiter">(</span><a href="#49240" title="=&gt; net.liftweb.couchdb.Database">defaultDatabase</a>, <a href="#51049" title="String">design</a>, <a href="#51050" title="String">view</a>, <a href="#51062" title="(x: net.liftweb.couchdb.View)net.liftweb.couchdb.View">identity</a><span class="delimiter">)</span>

  <span class="comment">/** Query using a view in the default database. Filter refines the query (e.g. by key), see Queryable. */</span>
  <span class="keyword">def</span> <a title="(design: String, view: String, filter: net.liftweb.couchdb.View =&gt; net.liftweb.couchdb.View)net.liftweb.common.Box[Seq[BaseRecord]]" id="49252">queryView</a><span class="delimiter">(</span><a title="String" id="51066">design</a>: <span title="String">String</span>, <a title="String" id="51067">view</a>: <span title="String">String</span>, <a title="net.liftweb.couchdb.View =&gt; net.liftweb.couchdb.View" id="51068">filter</a>: View =&gt; View<span class="delimiter">)</span>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[Seq[BaseRecord]]">Box</a><span class="delimiter">[</span>Seq<span class="delimiter">[</span>BaseRecord<span class="delimiter">]</span><span class="delimiter">]</span> =
    <a href="#49253" title="(database: net.liftweb.couchdb.Database, design: String, view: String, filter: net.liftweb.couchdb.View =&gt; net.liftweb.couchdb.View)net.liftweb.common.Box[Seq[BaseRecord]]">queryViewFrom</a><span class="delimiter">(</span><a href="#49240" title="=&gt; net.liftweb.couchdb.Database">defaultDatabase</a>, <a href="#51066" title="String">design</a>, <a href="#51067" title="String">view</a>, <a href="#51068" title="net.liftweb.couchdb.View =&gt; net.liftweb.couchdb.View">filter</a><span class="delimiter">)</span>

  <span class="comment">/** Query using a view in the given database. Filter refines the query (e.g. by key), see Queryable. */</span>
  <span class="keyword">def</span> <a title="(database: net.liftweb.couchdb.Database, design: String, view: String, filter: net.liftweb.couchdb.View =&gt; net.liftweb.couchdb.View)net.liftweb.common.Box[Seq[BaseRecord]]" id="49253">queryViewFrom</a><span class="delimiter">(</span><a title="net.liftweb.couchdb.Database" id="51052">database</a>: <a href="Database.scala.html#10806" title="net.liftweb.couchdb.Database">Database</a>, <a title="String" id="51053">design</a>: <span title="String">String</span>, <a title="String" id="51054">view</a>: <span title="String">String</span>, <a title="net.liftweb.couchdb.View =&gt; net.liftweb.couchdb.View" id="51055">filter</a>: View =&gt; View<span class="delimiter">)</span>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[Seq[BaseRecord]]">Box</a><span class="delimiter">[</span>Seq<span class="delimiter">[</span>BaseRecord<span class="delimiter">]</span><span class="delimiter">]</span> =
    <a href="#49259" title="(database: net.liftweb.couchdb.Database, design: String, view: String, filter: net.liftweb.couchdb.View =&gt; net.liftweb.couchdb.View, project: net.liftweb.couchdb.QueryRow =&gt; net.liftweb.common.Box[net.liftweb.json.JsonAST.JValue])net.liftweb.common.Box[Seq[BaseRecord]]">queryViewProjectionFrom</a><span class="delimiter">(</span><a href="#51052" title="net.liftweb.couchdb.Database">database</a>, <a href="#51053" title="String">design</a>, <a href="#51054" title="String">view</a>, <a href="#51055" title="net.liftweb.couchdb.View =&gt; net.liftweb.couchdb.View">filter</a>, <a href="#51077" title="net.liftweb.couchdb.QueryRow">_</a>.<a href="Database.scala.html#50806" title="=&gt; net.liftweb.common.Box[net.liftweb.json.JsonAST.JValue]">value</a><span class="delimiter">)</span>

  <span class="comment">/**
   * Query using a view in the default database, returning records created from the documents returned with the view.
   * If used against a reduce view, make sure to use dontReduce in the filter, otherwise CouchDB will signal an error.
   * includeDocs are always on for this type of query.
   */</span>
  <span class="keyword">def</span> <a title="(design: String, view: String)net.liftweb.common.Box[Seq[BaseRecord]]" id="49254">queryViewDocs</a><span class="delimiter">(</span><a title="String" id="51078">design</a>: <span title="String">String</span>, <a title="String" id="51079">view</a>: <span title="String">String</span><span class="delimiter">)</span>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[Seq[BaseRecord]]">Box</a><span class="delimiter">[</span>Seq<span class="delimiter">[</span>BaseRecord<span class="delimiter">]</span><span class="delimiter">]</span> =
    <a href="#49256" title="(database: net.liftweb.couchdb.Database, design: String, view: String, filter: net.liftweb.couchdb.View =&gt; net.liftweb.couchdb.View)net.liftweb.common.Box[Seq[BaseRecord]]">queryViewDocsFrom</a><span class="delimiter">(</span><a href="#49240" title="=&gt; net.liftweb.couchdb.Database">defaultDatabase</a>, <a href="#51078" title="String">design</a>, <a href="#51079" title="String">view</a>, <a href="#51091" title="(x: net.liftweb.couchdb.View)net.liftweb.couchdb.View">identity</a><span class="delimiter">)</span>

  <span class="comment">/**
   * Query using a view in the default database, returning records created from the documents returned with the view.
   * If used against a reduce view, make sure to use dontReduce in the filter, otherwise CouchDB will signal an error.
   * Filter refines the query (e.g. by key), see Queryable.
   * includeDocs are always on for this type of query.
   */</span>
  <span class="keyword">def</span> <a title="(design: String, view: String, filter: net.liftweb.couchdb.View =&gt; net.liftweb.couchdb.View)net.liftweb.common.Box[Seq[BaseRecord]]" id="49255">queryViewDocs</a><span class="delimiter">(</span><a title="String" id="51093">design</a>: <span title="String">String</span>, <a title="String" id="51094">view</a>: <span title="String">String</span>, <a title="net.liftweb.couchdb.View =&gt; net.liftweb.couchdb.View" id="51095">filter</a>: View =&gt; View<span class="delimiter">)</span>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[Seq[BaseRecord]]">Box</a><span class="delimiter">[</span>Seq<span class="delimiter">[</span>BaseRecord<span class="delimiter">]</span><span class="delimiter">]</span> =
    <a href="#49256" title="(database: net.liftweb.couchdb.Database, design: String, view: String, filter: net.liftweb.couchdb.View =&gt; net.liftweb.couchdb.View)net.liftweb.common.Box[Seq[BaseRecord]]">queryViewDocsFrom</a><span class="delimiter">(</span><a href="#49240" title="=&gt; net.liftweb.couchdb.Database">defaultDatabase</a>, <a href="#51093" title="String">design</a>, <a href="#51094" title="String">view</a>, <a href="#51095" title="net.liftweb.couchdb.View =&gt; net.liftweb.couchdb.View">filter</a><span class="delimiter">)</span>

  <span class="comment">/**
   * Query using a view in the given database, returning records created from the documents returned with the view.
   * If used against a reduce view, make sure to use dontReduce in the filter, otherwise CouchDB will signal an error.
   * Filter refines the query (e.g. by key), see Queryable.
   * includeDocs are always on for this type of query.
   */</span>
  <span class="keyword">def</span> <a title="(database: net.liftweb.couchdb.Database, design: String, view: String, filter: net.liftweb.couchdb.View =&gt; net.liftweb.couchdb.View)net.liftweb.common.Box[Seq[BaseRecord]]" id="49256">queryViewDocsFrom</a><span class="delimiter">(</span><a title="net.liftweb.couchdb.Database" id="51081">database</a>: <a href="Database.scala.html#10806" title="net.liftweb.couchdb.Database">Database</a>, <a title="String" id="51082">design</a>: <span title="String">String</span>, <a title="String" id="51083">view</a>: <span title="String">String</span>, <a title="net.liftweb.couchdb.View =&gt; net.liftweb.couchdb.View" id="51084">filter</a>: View =&gt; View<span class="delimiter">)</span>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[Seq[BaseRecord]]">Box</a><span class="delimiter">[</span>Seq<span class="delimiter">[</span>BaseRecord<span class="delimiter">]</span><span class="delimiter">]</span> =
    <a href="#49259" title="(database: net.liftweb.couchdb.Database, design: String, view: String, filter: net.liftweb.couchdb.View =&gt; net.liftweb.couchdb.View, project: net.liftweb.couchdb.QueryRow =&gt; net.liftweb.common.Box[net.liftweb.json.JsonAST.JValue])net.liftweb.common.Box[Seq[BaseRecord]]">queryViewProjectionFrom</a><span class="delimiter">(</span><a href="#51081" title="net.liftweb.couchdb.Database">database</a>, <a href="#51082" title="String">design</a>, <a href="#51083" title="String">view</a>, <a title="net.liftweb.couchdb.View" id="51098">v</a> =&gt; <a href="#51084" title="(v1: net.liftweb.couchdb.View)net.liftweb.couchdb.View">filter</a><span class="delimiter">(</span><a href="#51098" title="net.liftweb.couchdb.View">v</a>.<a href="Database.scala.html#50729" title="=&gt; net.liftweb.couchdb.View">includeDocs</a><span class="delimiter">)</span>, <a href="#51101" title="net.liftweb.couchdb.QueryRow">_</a>.<a href="Database.scala.html#50808" title="=&gt; net.liftweb.common.Box[net.liftweb.json.JsonAST.JObject]">doc</a><span class="delimiter">)</span>

  <span class="comment">/**
   * Query using a view in the default database, using some projection function that converts each QueryRow into a JSON document to read
   * as the record.
   */</span>
  <span class="keyword">def</span> <a title="(design: String, view: String, project: net.liftweb.couchdb.QueryRow =&gt; net.liftweb.common.Box[net.liftweb.json.JsonAST.JValue])net.liftweb.common.Box[Seq[BaseRecord]]" id="49257">queryViewProjection</a><span class="delimiter">(</span><a title="String" id="51102">design</a>: <span title="String">String</span>, <a title="String" id="51103">view</a>: <span title="String">String</span>, <a title="net.liftweb.couchdb.QueryRow =&gt; net.liftweb.common.Box[net.liftweb.json.JsonAST.JValue]" id="51104">project</a>: QueryRow =&gt; Box<span class="delimiter">[</span>JValue<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[Seq[BaseRecord]]">Box</a><span class="delimiter">[</span>Seq<span class="delimiter">[</span>BaseRecord<span class="delimiter">]</span><span class="delimiter">]</span> =
    <a href="#49259" title="(database: net.liftweb.couchdb.Database, design: String, view: String, filter: net.liftweb.couchdb.View =&gt; net.liftweb.couchdb.View, project: net.liftweb.couchdb.QueryRow =&gt; net.liftweb.common.Box[net.liftweb.json.JsonAST.JValue])net.liftweb.common.Box[Seq[BaseRecord]]">queryViewProjectionFrom</a><span class="delimiter">(</span><a href="#49240" title="=&gt; net.liftweb.couchdb.Database">defaultDatabase</a>, <a href="#51102" title="String">design</a>, <a href="#51103" title="String">view</a>, <a href="#51111" title="(x: net.liftweb.couchdb.View)net.liftweb.couchdb.View">identity</a>, <a href="#51104" title="net.liftweb.couchdb.QueryRow =&gt; net.liftweb.common.Box[net.liftweb.json.JsonAST.JValue]">project</a><span class="delimiter">)</span>

  <span class="comment">/**
   * Query using a view in the default database, using some projection function that converts each QueryRow into a JSON document to read
   * as the record. Filter refines the query (e.g. by key), see Queryable.
   */</span>
  <span class="keyword">def</span> <a title="(design: String, view: String, filter: net.liftweb.couchdb.View =&gt; net.liftweb.couchdb.View, project: net.liftweb.couchdb.QueryRow =&gt; net.liftweb.common.Box[net.liftweb.json.JsonAST.JValue])net.liftweb.common.Box[Seq[BaseRecord]]" id="49258">queryViewProjection</a><span class="delimiter">(</span><a title="String" id="51113">design</a>: <span title="String">String</span>, <a title="String" id="51114">view</a>: <span title="String">String</span>, <a title="net.liftweb.couchdb.View =&gt; net.liftweb.couchdb.View" id="51115">filter</a>: View =&gt; View, <a title="net.liftweb.couchdb.QueryRow =&gt; net.liftweb.common.Box[net.liftweb.json.JsonAST.JValue]" id="51116">project</a>: QueryRow =&gt; Box<span class="delimiter">[</span>JValue<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[Seq[BaseRecord]]">Box</a><span class="delimiter">[</span>Seq<span class="delimiter">[</span>BaseRecord<span class="delimiter">]</span><span class="delimiter">]</span> =
    <a href="#49259" title="(database: net.liftweb.couchdb.Database, design: String, view: String, filter: net.liftweb.couchdb.View =&gt; net.liftweb.couchdb.View, project: net.liftweb.couchdb.QueryRow =&gt; net.liftweb.common.Box[net.liftweb.json.JsonAST.JValue])net.liftweb.common.Box[Seq[BaseRecord]]">queryViewProjectionFrom</a><span class="delimiter">(</span><a href="#49240" title="=&gt; net.liftweb.couchdb.Database">defaultDatabase</a>, <a href="#51113" title="String">design</a>, <a href="#51114" title="String">view</a>, <a href="#51115" title="net.liftweb.couchdb.View =&gt; net.liftweb.couchdb.View">filter</a>, <a href="#51116" title="net.liftweb.couchdb.QueryRow =&gt; net.liftweb.common.Box[net.liftweb.json.JsonAST.JValue]">project</a><span class="delimiter">)</span>

  <span class="comment">/**
   * Query using a view in the given database, using some projection function that converts each QueryRow into a JSON document to read
   * as the record.
   */</span>
  <span class="keyword">def</span> <a title="(database: net.liftweb.couchdb.Database, design: String, view: String, filter: net.liftweb.couchdb.View =&gt; net.liftweb.couchdb.View, project: net.liftweb.couchdb.QueryRow =&gt; net.liftweb.common.Box[net.liftweb.json.JsonAST.JValue])net.liftweb.common.Box[Seq[BaseRecord]]" id="49259">queryViewProjectionFrom</a><span class="delimiter">(</span><a title="net.liftweb.couchdb.Database" id="51070">database</a>: <a href="Database.scala.html#10806" title="net.liftweb.couchdb.Database">Database</a>, <a title="String" id="51071">design</a>: <span title="String">String</span>, <a title="String" id="51072">view</a>: <span title="String">String</span>, 
                              <a title="net.liftweb.couchdb.View =&gt; net.liftweb.couchdb.View" id="51073">filter</a>: View =&gt; View, <a title="net.liftweb.couchdb.QueryRow =&gt; net.liftweb.common.Box[net.liftweb.json.JsonAST.JValue]" id="51074">project</a>: QueryRow =&gt; Box<span class="delimiter">[</span>JValue<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[Seq[BaseRecord]]">Box</a><span class="delimiter">[</span>Seq<span class="delimiter">[</span>BaseRecord<span class="delimiter">]</span><span class="delimiter">]</span> =
    <span class="keyword">for</span> <span class="delimiter">(</span><a title="net.liftweb.common.Box[net.liftweb.couchdb.QueryResults]" id="51171">resultBox</a> &lt;- <a href="../../../../util/net/liftweb/util/ControlHelpers.scala.html#48608" title="(f: =&gt; net.liftweb.common.Box[net.liftweb.couchdb.QueryResults])net.liftweb.common.Box[net.liftweb.common.Box[net.liftweb.couchdb.QueryResults]]">tryo</a><a href="../../../../common/net/liftweb/common/Box.scala.html#27023" title="(f: net.liftweb.common.Box[net.liftweb.couchdb.QueryResults] =&gt; net.liftweb.common.Box[Seq[BaseRecord]])net.liftweb.common.Box[Seq[BaseRecord]]" class="delimiter">(</a><a href="#49241" title="(hand: dispatch.Handler[net.liftweb.common.Box[net.liftweb.couchdb.QueryResults]])net.liftweb.common.Box[net.liftweb.couchdb.QueryResults]">http</a><span class="delimiter">(</span><a href="#51073" title="(v1: net.liftweb.couchdb.View)net.liftweb.couchdb.View">filter</a><span class="delimiter">(</span><a href="#51070" title="net.liftweb.couchdb.Database">database</a>.<a href="Database.scala.html#48722" title="(name: String)net.liftweb.couchdb.Design">design</a><span class="delimiter">(</span><a href="#51071" title="String">design</a><span class="delimiter">)</span>.<a href="Database.scala.html#51148" title="(name: String)net.liftweb.couchdb.View">view</a><span class="delimiter">(</span><a href="#51072" title="String">view</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="Database.scala.html#50716" title="=&gt; dispatch.Handler[net.liftweb.common.Box[net.liftweb.couchdb.QueryResults]]">query</a><span class="delimiter">)</span><span class="delimiter">)</span>; <a title="net.liftweb.couchdb.QueryResults" id="51176">result</a> &lt;- <a href="../../../../common/net/liftweb/common/Box.scala.html#27020" title="(f: net.liftweb.couchdb.QueryResults =&gt; Seq[BaseRecord])net.liftweb.common.Box[Seq[BaseRecord]]">resultBox</a><span class="delimiter">)</span>
      <span class="keyword">yield</span> <a href="#51176" title="net.liftweb.couchdb.QueryResults">result</a>.<a href="Database.scala.html#50776" title="=&gt; Seq[net.liftweb.couchdb.QueryRow]">rows</a>.<span title="(f: net.liftweb.couchdb.QueryRow =&gt; scala.collection.GenTraversableOnce[BaseRecord])(implicit bf: scala.collection.generic.CanBuildFrom[Seq[net.liftweb.couchdb.QueryRow],BaseRecord,Seq[BaseRecord]])Seq[BaseRecord]">flatMap</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.Seq.Coll,BaseRecord,Seq[BaseRecord]]" class="delimiter">(</span><a title="net.liftweb.couchdb.QueryRow" id="51193">row</a> =&gt; <a href="#51074" title="(v1: net.liftweb.couchdb.QueryRow)net.liftweb.common.Box[net.liftweb.json.JsonAST.JValue]">project</a><span class="delimiter">(</span><a href="#51193" title="net.liftweb.couchdb.QueryRow">row</a><span class="delimiter">)</span>.<a href="../../../../common/net/liftweb/common/Box.scala.html#27023" title="(f: net.liftweb.json.JsonAST.JValue =&gt; net.liftweb.common.Box[BaseRecord])net.liftweb.common.Box[BaseRecord]">flatMap</a><a href="../../../../common/net/liftweb/common/Box.scala.html#28624" title="(in: net.liftweb.common.Box[BaseRecord])Iterable[BaseRecord]" class="delimiter">(</a><a href="../../../../record/net/liftweb/record/MetaRecord.scala.html#49208" title="(jvalue: net.liftweb.json.JsonAST.JValue)net.liftweb.common.Box[BaseRecord]">fromJValue</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="comment">/** Perform the given action with loose parsing turned on */</span>
  <span class="keyword">def</span> <a title="[A](f: =&gt; A)A" id="49260">looseParsing</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="49262">A</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="=&gt; A" id="51259">f</a>: =&gt; A<span class="delimiter">)</span>: <a href="#49262" title="A">A</a> = 
    <a href="JSONRecord.scala.html#10869" title="object net.liftweb.couchdb.JSONMetaRecord">JSONMetaRecord</a>.<a href="JSONRecord.scala.html#51263" title="object net.liftweb.couchdb.JSONMetaRecord.overrideIgnoreExtraJSONFields">overrideIgnoreExtraJSONFields</a>.<a href="../../../../util/net/liftweb/util/ThreadGlobal.scala.html#51274" title="(x: Boolean)(f: =&gt; A)A">doWith</a><span class="delimiter">(</span><span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="JSONRecord.scala.html#10869" title="object net.liftweb.couchdb.JSONMetaRecord">JSONMetaRecord</a>.<a href="JSONRecord.scala.html#51265" title="object net.liftweb.couchdb.JSONMetaRecord.overrideNeedAllJSONFields">overrideNeedAllJSONFields</a>.<a href="../../../../util/net/liftweb/util/ThreadGlobal.scala.html#51274" title="(x: Boolean)(f: =&gt; A)A">doWith</a><span class="delimiter">(</span><span title="Boolean(false)" class="keyword">false</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="#51259" title="=&gt; A">f</a>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
<span class="delimiter">}</span>


        </pre>
    </body>
</html>