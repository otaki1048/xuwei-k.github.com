<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>db/net/liftweb/db/DB.scala</title>
        <script type="text/javascript" src="../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>
<span class="comment">/*
 * Copyright 2006-2011 WorldWide Conferencing, LLC
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */</span>

<span class="keyword">package</span> net.liftweb
<span class="keyword">package</span> db

<span class="keyword">import</span> common._
<span class="keyword">import</span> util._
<span class="keyword">import</span> <a href="../../../../util/net/liftweb/util/Helpers.scala.html#13346" title="object net.liftweb.util.Helpers">Helpers</a>._

<span class="keyword">import</span> javax.sql.<span class="delimiter">{</span>DataSource<span class="delimiter">}</span>
<span class="keyword">import</span> java.sql.ResultSetMetaData
<span class="keyword">import</span> java.sql.<span class="delimiter">{</span>Statement, ResultSet, Types, PreparedStatement, Connection, DriverManager<span class="delimiter">}</span>
<span class="keyword">import</span> scala.collection.mutable.<span class="delimiter">{</span>HashMap, ListBuffer<span class="delimiter">}</span>
<span class="keyword">import</span> javax.naming.<span class="delimiter">{</span>Context, InitialContext<span class="delimiter">}</span>

<span class="keyword">trait</span> <a title="trait DB1 extends java.lang.Object" id="10902">DB1</a>

<span class="keyword">object</span> <a title="object net.liftweb.db.DB1" id="10903">DB1</a> <span title="ScalaObject" class="delimiter">{</span>
  <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="implicit net.liftweb.db.DB1.db1ToDb : (in: net.liftweb.db.DB1)net.liftweb.db.DB" id="60272">db1ToDb</a><span class="delimiter">(</span><a title="net.liftweb.db.DB1" id="60274">in</a>: <a href="#10902" title="net.liftweb.db.DB1">DB1</a><span class="delimiter">)</span>: <a href="#10907" title="net.liftweb.db.DB">DB</a> = <a href="#10905" title="object net.liftweb.db.DB">DB</a>.<a href="#60381" title="=&gt; java.lang.Object with net.liftweb.db.DB">theDB</a>
<span class="delimiter">}</span>

<span class="keyword">object</span> <a title="object net.liftweb.db.DB" id="10905">DB</a> <span title="ScalaObject" class="keyword">extends</span> <a href="#10902" title="net.liftweb.db.DB1">DB1</a> <span class="delimiter">{</span>

  <span class="keyword">private</span><span class="delimiter">[</span>db<span class="delimiter">]</span> <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="theDB extends java.lang.Object with net.liftweb.db.DB" id="60382">theDB</a> = <a href="#60383" title="java.lang.Object with net.liftweb.db.DB" class="keyword">new</a> <a title="anonymous class $anon extends java.lang.Object with net.liftweb.db.DB" id="60383">DB</a><span class="delimiter">{</span><span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="keyword">trait</span> <a title="trait DB extends java.lang.Object with net.liftweb.common.Loggable with ScalaObject" id="10907">DB</a> <span title="ScalaObject" class="keyword">extends</span> <a href="../../../../common/net/liftweb/common/Logging.scala.html#10717" title="net.liftweb.common.Loggable">Loggable</a> <span class="delimiter">{</span>
  <span class="keyword">private</span> <span class="keyword">val</span> <a title="java.lang.ThreadLocal[scala.collection.mutable.HashMap[net.liftweb.db.ConnectionIdentifier,DB.this.ConnectionHolder]]" id="60277">threadStore</a> = <span title="java.lang.ThreadLocal[scala.collection.mutable.HashMap[net.liftweb.db.ConnectionIdentifier,DB.this.ConnectionHolder]]" class="keyword">new</span> <span title="java.lang.ThreadLocal[scala.collection.mutable.HashMap[net.liftweb.db.ConnectionIdentifier,DB.this.ConnectionHolder]]">ThreadLocal</span><span class="delimiter">[</span>HashMap<span class="delimiter">[</span>ConnectionIdentifier, ConnectionHolder<span class="delimiter">]</span><span class="delimiter">]</span>
  <span class="keyword">private</span> <span class="keyword">val</span> <a title="java.lang.ThreadLocal[List[() =&gt; Unit]]" id="60279">_postCommitFuncs</a> = <span title="java.lang.ThreadLocal[List[() =&gt; Unit]]" class="keyword">new</span> <span title="java.lang.ThreadLocal[List[() =&gt; Unit]]">ThreadLocal</span><span class="delimiter">[</span>List<span class="delimiter">[</span><span class="delimiter">(</span><span class="delimiter">)</span> =&gt; Unit<span class="delimiter">]</span><span class="delimiter">]</span>

  <span class="keyword">var</span> <a title="net.liftweb.common.Box[String]" id="60282">globalDefaultSchemaName</a>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[String]">Box</a><span class="delimiter">[</span>String<span class="delimiter">]</span> = <a href="../../../../common/net/liftweb/common/Box.scala.html#10581" title="object net.liftweb.common.Empty">Empty</a>

  <span class="keyword">var</span> <a title="net.liftweb.common.Box[Int]" id="60285">queryTimeout</a>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[Int]">Box</a><span class="delimiter">[</span>Int<span class="delimiter">]</span> = <a href="../../../../common/net/liftweb/common/Box.scala.html#10581" title="object net.liftweb.common.Empty">Empty</a>

  <span class="keyword">type</span> <a title="(net.liftweb.db.DBLog, Long) =&gt; Any" id="60287">LogFunc</a> = <span class="delimiter">(</span>DBLog, Long<span class="delimiter">)</span> =&gt; Any
  <span class="keyword">private</span> <span class="keyword">var</span> <a title="List[(net.liftweb.db.DBLog, Long) =&gt; Any]" id="60289">logFuncs</a>: <span title="List[(net.liftweb.db.DBLog, Long) =&gt; Any]">List</span><span class="delimiter">[</span>LogFunc<span class="delimiter">]</span> = <span title="object Nil">Nil</span>

  <span class="keyword">def</span> <a title="(f: (net.liftweb.db.DBLog, Long) =&gt; Any)List[(net.liftweb.db.DBLog, Long) =&gt; Any]" id="60291">addLogFunc</a><span class="delimiter">(</span><a title="(net.liftweb.db.DBLog, Long) =&gt; Any" id="60822">f</a>: <span title="(net.liftweb.db.DBLog, Long) =&gt; Any">LogFunc</span><span class="delimiter">)</span>: <span title="List[(net.liftweb.db.DBLog, Long) =&gt; Any]">List</span><span class="delimiter">[</span>LogFunc<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <a href="#60289" title="(x$1: List[(net.liftweb.db.DBLog, Long) =&gt; Any])Unit">logFuncs</a> = <a href="#60289" title="=&gt; List[(net.liftweb.db.DBLog, Long) =&gt; Any]">logFuncs</a> <a href="#60824" title="(prefix: List[(net.liftweb.db.DBLog, Long) =&gt; Any])List[(net.liftweb.db.DBLog, Long) =&gt; Any]">:::</a> <span title="(xs: (net.liftweb.db.DBLog, Long) =&gt; Any*)List[(net.liftweb.db.DBLog, Long) =&gt; Any]">List</span><span class="delimiter">(</span><a href="#60822" title="(net.liftweb.db.DBLog, Long) =&gt; Any">f</a><span class="delimiter">)</span>
    <a href="#60289" title="=&gt; List[(net.liftweb.db.DBLog, Long) =&gt; Any]">logFuncs</a>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="=&gt; Boolean" id="60292">loggingEnabled_?</a> = <span title="=&gt; Boolean">!</span><a href="#60289" title="=&gt; List[(net.liftweb.db.DBLog, Long) =&gt; Any]">logFuncs</a>.<span title="=&gt; Boolean">isEmpty</span>

  <span class="comment">/**
   * queryCollector can be used to collect all statements executed in a single request when passed to addLogFunc
   *
   * Use S.queryLog to get the list of (statement, duration) entries or set an analyzer function using
   * S.addAnalyzer
   */</span>
  @volatile <span class="keyword">var</span> <a title="(net.liftweb.db.DBLog, Long) =&gt; Any" id="60294">queryCollector</a>: <span title="(net.liftweb.db.DBLog, Long) =&gt; Any">LogFunc</span> = <a href="#60859" title="Any" class="delimiter">{</a>
    <span class="keyword">case</span> <span title="Unit" class="delimiter">(</span><a title="net.liftweb.db.DBLog" id="60888">query</a>:<a href="LoggingStatementWrappers.scala.html#10966" title="net.liftweb.db.DBLog">DBLog</a>, <a title="Long" id="60889">time</a><span class="delimiter">)</span> =&gt;
  <span class="delimiter">}</span>



  <span class="comment">/**
   * Try to obtain a Connection using the jndiName of the ConnectionIdentifier
   */</span>
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(name: net.liftweb.db.ConnectionIdentifier)net.liftweb.common.Box[java.sql.Connection]" id="60296">jndiConnection</a><span class="delimiter">(</span><a title="net.liftweb.db.ConnectionIdentifier" id="60890">name</a>: <a href="#10911" title="net.liftweb.db.ConnectionIdentifier">ConnectionIdentifier</a><span class="delimiter">)</span> : <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[java.sql.Connection]">Box</a><span class="delimiter">[</span>Connection<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="List[() =&gt; java.sql.Connection]" id="60892">toTry</a>: <span title="List[() =&gt; java.sql.Connection]">List</span><span class="delimiter">[</span><span class="delimiter">(</span><span class="delimiter">)</span> =&gt; Connection<span class="delimiter">]</span> = <span title="(xs: () =&gt; java.sql.Connection*)List[() =&gt; java.sql.Connection]">List</span><span class="delimiter">(</span>
      <span class="delimiter">(</span><span class="delimiter">)</span> =&gt; <span class="delimiter">{</span>
        <a href="../../../../common/net/liftweb/common/Logging.scala.html#19845" title="=&gt; net.liftweb.common.Logger">logger</a>.<a href="../../../../common/net/liftweb/common/Logging.scala.html#31936" title="(msg: =&gt; AnyRef)Unit">trace</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;Trying JNDI lookup on java:/comp/env followed by lookup on %s&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#60890" title="net.liftweb.db.ConnectionIdentifier">name</a>.<a href="#60050" title="=&gt; String">jndiName</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="delimiter">(</span><span title="()javax.naming.InitialContext" class="keyword">new</span> <span title="javax.naming.InitialContext">InitialContext</span><span class="delimiter">)</span>.<span title="(x$1: java.lang.String)java.lang.Object">lookup</span><span class="delimiter">(</span><span title="java.lang.String(&quot;java:/comp/env&quot;)" class="string">&quot;java:/comp/env&quot;</span><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="javax.naming.Context" class="delimiter">[</span><span title="javax.naming.Context">Context</span><span class="delimiter">]</span>.<span title="(x$1: java.lang.String)java.lang.Object">lookup</span><span class="delimiter">(</span><a href="#60890" title="net.liftweb.db.ConnectionIdentifier">name</a>.<a href="#60050" title="=&gt; String">jndiName</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="javax.sql.DataSource" class="delimiter">[</span><span title="javax.sql.DataSource">DataSource</span><span class="delimiter">]</span>.<span title="()java.sql.Connection">getConnection</span>
      <span class="delimiter">}</span>,
      <span class="delimiter">(</span><span class="delimiter">)</span> =&gt; <span class="delimiter">{</span>
        <a href="../../../../common/net/liftweb/common/Logging.scala.html#19845" title="=&gt; net.liftweb.common.Logger">logger</a>.<a href="../../../../common/net/liftweb/common/Logging.scala.html#31936" title="(msg: =&gt; AnyRef)Unit">trace</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;Trying JNDI lookup on java:/comp/env/%s&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#60890" title="net.liftweb.db.ConnectionIdentifier">name</a>.<a href="#60050" title="=&gt; String">jndiName</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="delimiter">(</span><span title="()javax.naming.InitialContext" class="keyword">new</span> <span title="javax.naming.InitialContext">InitialContext</span><span class="delimiter">)</span>.<span title="(x$1: java.lang.String)java.lang.Object">lookup</span><span class="delimiter">(</span><span title="java.lang.String(&quot;java:/comp/env/&quot;)" class="string">&quot;java:/comp/env/&quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#60890" title="net.liftweb.db.ConnectionIdentifier">name</a>.<a href="#60050" title="=&gt; String">jndiName</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="javax.sql.DataSource" class="delimiter">[</span><span title="javax.sql.DataSource">DataSource</span><span class="delimiter">]</span>.<span title="()java.sql.Connection">getConnection</span>

      <span class="delimiter">}</span>,
      <span class="delimiter">(</span><span class="delimiter">)</span> =&gt; <span class="delimiter">{</span>
        <a href="../../../../common/net/liftweb/common/Logging.scala.html#19845" title="=&gt; net.liftweb.common.Logger">logger</a>.<a href="../../../../common/net/liftweb/common/Logging.scala.html#31936" title="(msg: =&gt; AnyRef)Unit">trace</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;Trying JNDI lookup on %s&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#60890" title="net.liftweb.db.ConnectionIdentifier">name</a>.<a href="#60050" title="=&gt; String">jndiName</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="delimiter">(</span><span title="()javax.naming.InitialContext" class="keyword">new</span> <span title="javax.naming.InitialContext">InitialContext</span><span class="delimiter">)</span>.<span title="(x$1: java.lang.String)java.lang.Object">lookup</span><span class="delimiter">(</span><a href="#60890" title="net.liftweb.db.ConnectionIdentifier">name</a>.<a href="#60050" title="=&gt; String">jndiName</a><span class="delimiter">)</span>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="javax.sql.DataSource" class="delimiter">[</span><span title="javax.sql.DataSource">DataSource</span><span class="delimiter">]</span>.<span title="()java.sql.Connection">getConnection</span>

      <span class="delimiter">}</span>
    <span class="delimiter">)</span>

    <a href="../../../../util/net/liftweb/util/ListHelpers.scala.html#48877" title="(in: Seq[() =&gt; java.sql.Connection])(_f: () =&gt; java.sql.Connection =&gt; net.liftweb.common.Box[java.sql.Connection])net.liftweb.common.Box[java.sql.Connection]">first</a><span class="delimiter">(</span><a href="#60892" title="List[() =&gt; java.sql.Connection]">toTry</a><span class="delimiter">)</span> <span class="delimiter">(</span><a title="() =&gt; java.sql.Connection" id="61547">f</a> =&gt; <a href="../../../../util/net/liftweb/util/ControlHelpers.scala.html#48611" title="(onError: Throwable =&gt; Unit)(f: =&gt; java.sql.Connection)net.liftweb.common.Box[java.sql.Connection]">tryo</a><span class="delimiter">{</span>t:<span title="Throwable">Throwable</span> =&gt; <a href="../../../../common/net/liftweb/common/Logging.scala.html#19845" title="=&gt; net.liftweb.common.Logger">logger</a>.<a href="../../../../common/net/liftweb/common/Logging.scala.html#31936" title="(msg: =&gt; AnyRef)Unit">trace</a><span class="delimiter">(</span><span title="java.lang.String(&quot;JNDI Lookup failed: &quot;)" class="string">&quot;JNDI Lookup failed: &quot;</span><span title="(x$1: Any)java.lang.String">+</span><a href="#61659" title="Throwable">t</a><span class="delimiter">)</span><span class="delimiter">}</span><span class="delimiter">(</span><a href="#61547" title="()java.sql.Connection">f</a><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../../../common/net/liftweb/common/Box.scala.html#27043" title="(alternative: =&gt; net.liftweb.common.Box[java.sql.Connection])net.liftweb.common.Box[java.sql.Connection]">or</a> <span class="delimiter">{</span>
      <a href="../../../../common/net/liftweb/common/Logging.scala.html#19845" title="=&gt; net.liftweb.common.Logger">logger</a>.<a href="../../../../common/net/liftweb/common/Logging.scala.html#31954" title="(msg: =&gt; AnyRef)Unit">warn</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;A JNDI name was specified(%s), but no connection could be obtained&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#60890" title="net.liftweb.db.ConnectionIdentifier">name</a>.<a href="#60050" title="=&gt; String">jndiName</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="../../../../common/net/liftweb/common/Box.scala.html#10581" title="object net.liftweb.common.Empty">Empty</a>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * can we get a JDBC connection from JNDI?
   */</span>
  <span class="keyword">def</span> <a title="=&gt; Boolean" id="60297">jndiJdbcConnAvailable_?</a> : <span title="Boolean">Boolean</span> = <a href="#60296" title="(name: net.liftweb.db.ConnectionIdentifier)net.liftweb.common.Box[java.sql.Connection]">jndiConnection</a><span class="delimiter">(</span><a href="#66906" title="object net.liftweb.db.DefaultConnectionIdentifier">DefaultConnectionIdentifier</a><span class="delimiter">)</span>.<a href="../../../../common/net/liftweb/common/Box.scala.html#27014" title="=&gt; Boolean">isDefined</a>

  <span class="keyword">private</span> <span class="keyword">val</span> <a title="scala.collection.mutable.HashMap[net.liftweb.db.ConnectionIdentifier,net.liftweb.db.ConnectionManager]" id="60298">connectionManagers</a> = <span title="()scala.collection.mutable.HashMap[net.liftweb.db.ConnectionIdentifier,net.liftweb.db.ConnectionManager]" class="keyword">new</span> <span title="scala.collection.mutable.HashMap[net.liftweb.db.ConnectionIdentifier,net.liftweb.db.ConnectionManager]">HashMap</span><span class="delimiter">[</span>ConnectionIdentifier, ConnectionManager<span class="delimiter">]</span>

  <span class="keyword">private</span> <span class="keyword">val</span> <a title="net.liftweb.util.ThreadGlobal[Map[net.liftweb.db.ConnectionIdentifier,net.liftweb.db.ConnectionManager]]" id="60300">threadLocalConnectionManagers</a> = <span title="net.liftweb.util.ThreadGlobal[Map[net.liftweb.db.ConnectionIdentifier,net.liftweb.db.ConnectionManager]]" class="keyword">new</span> <a href="../../../../util/net/liftweb/util/ThreadGlobal.scala.html#13699" title="net.liftweb.util.ThreadGlobal[Map[net.liftweb.db.ConnectionIdentifier,net.liftweb.db.ConnectionManager]]">ThreadGlobal</a><span class="delimiter">[</span>Map<span class="delimiter">[</span>ConnectionIdentifier, ConnectionManager<span class="delimiter">]</span><span class="delimiter">]</span>

  <span class="keyword">def</span> <a title="(name: net.liftweb.db.ConnectionIdentifier, mgr: net.liftweb.db.ConnectionManager)Unit" id="60302">defineConnectionManager</a><span class="delimiter">(</span><a title="net.liftweb.db.ConnectionIdentifier" id="61705">name</a>: <a href="#10911" title="net.liftweb.db.ConnectionIdentifier">ConnectionIdentifier</a>, <a title="net.liftweb.db.ConnectionManager" id="61706">mgr</a>: <a href="ConnectionManager.scala.html#10890" title="net.liftweb.db.ConnectionManager">ConnectionManager</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <a href="#60298" title="(key: net.liftweb.db.ConnectionIdentifier, value: net.liftweb.db.ConnectionManager)Unit">connectionManagers</a><span class="delimiter">(</span><a href="#61705" title="net.liftweb.db.ConnectionIdentifier">name</a><span class="delimiter">)</span> = <a href="#61706" title="net.liftweb.db.ConnectionManager">mgr</a>
  <span class="delimiter">}</span>

  <span class="comment">/**
  * Allows you to override the connection manager associated with particular connection identifiers for the duration
  * of the call.
  */</span>
  <span class="keyword">def</span> <a title="[T](mgrs: (net.liftweb.db.ConnectionIdentifier, net.liftweb.db.ConnectionManager)*)(f: =&gt; T)T" id="60303">doWithConnectionManagers</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="60305">T</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="(net.liftweb.db.ConnectionIdentifier, net.liftweb.db.ConnectionManager)*" id="61713">mgrs</a>: <span title="(net.liftweb.db.ConnectionIdentifier, net.liftweb.db.ConnectionManager)*" class="delimiter">(</span>ConnectionIdentifier, ConnectionManager<span class="delimiter">)</span>*<span class="delimiter">)</span><span class="delimiter">(</span><a title="=&gt; T" id="61714">f</a>: =&gt; T<span class="delimiter">)</span>: <a href="#60305" title="T">T</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="Map[net.liftweb.db.ConnectionIdentifier,net.liftweb.db.ConnectionManager]" id="61717">newMap</a> = <a href="#61713" title="(net.liftweb.db.ConnectionIdentifier, net.liftweb.db.ConnectionManager)*">mgrs</a>.<span title="(z: Map[net.liftweb.db.ConnectionIdentifier,net.liftweb.db.ConnectionManager])(op: (Map[net.liftweb.db.ConnectionIdentifier,net.liftweb.db.ConnectionManager], (net.liftweb.db.ConnectionIdentifier, net.liftweb.db.ConnectionManager)) =&gt; Map[net.liftweb.db.ConnectionIdentifier,net.liftweb.db.ConnectionManager])Map[net.liftweb.db.ConnectionIdentifier,net.liftweb.db.ConnectionManager]">foldLeft</span><span class="delimiter">(</span><a href="#60300" title="=&gt; net.liftweb.util.ThreadGlobal[Map[net.liftweb.db.ConnectionIdentifier,net.liftweb.db.ConnectionManager]]">threadLocalConnectionManagers</a>.<a href="../../../../util/net/liftweb/util/ThreadGlobal.scala.html#51271" title="=&gt; net.liftweb.common.Box[Map[net.liftweb.db.ConnectionIdentifier,net.liftweb.db.ConnectionManager]]">box</a> <a href="../../../../common/net/liftweb/common/Box.scala.html#27017" title="(default: =&gt; Map[net.liftweb.db.ConnectionIdentifier,net.liftweb.db.ConnectionManager])Map[net.liftweb.db.ConnectionIdentifier,net.liftweb.db.ConnectionManager]">openOr</a> <span title="(elems: (net.liftweb.db.ConnectionIdentifier, Nothing)*)scala.collection.immutable.Map[net.liftweb.db.ConnectionIdentifier,Nothing]">Map</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">(</span><a href="#61760" title="Map[net.liftweb.db.ConnectionIdentifier,net.liftweb.db.ConnectionManager]">_</a> <span title="(kv: (net.liftweb.db.ConnectionIdentifier, net.liftweb.db.ConnectionManager))scala.collection.immutable.Map[net.liftweb.db.ConnectionIdentifier,net.liftweb.db.ConnectionManager]">+</span> <a href="#61761" title="(net.liftweb.db.ConnectionIdentifier, net.liftweb.db.ConnectionManager)">_</a><span class="delimiter">)</span>
    <a href="#60300" title="=&gt; net.liftweb.util.ThreadGlobal[Map[net.liftweb.db.ConnectionIdentifier,net.liftweb.db.ConnectionManager]]">threadLocalConnectionManagers</a>.<a href="../../../../util/net/liftweb/util/ThreadGlobal.scala.html#51274" title="(x: Map[net.liftweb.db.ConnectionIdentifier,net.liftweb.db.ConnectionManager])(f: =&gt; T)T">doWith</a><span class="delimiter">(</span><a href="#61717" title="Map[net.liftweb.db.ConnectionIdentifier,net.liftweb.db.ConnectionManager]">newMap</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#61714" title="=&gt; T">f</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  case <span class="keyword">class</span> <a title="class ConnectionHolder extends java.lang.Object with ScalaObject with Product with Serializable" id="61867">ConnectionHolder</a><a href="#61867" title="ScalaObject" class="delimiter">(</a><a title="net.liftweb.db.SuperConnection" id="63173">conn</a>: <a href="#10908" title="net.liftweb.db.SuperConnection">SuperConnection</a>, <a title="Int" id="63174">cnt</a>: <span title="Int">Int</span>, <a title="List[Boolean =&gt; Unit]" id="63175">postTransaction</a>: <span title="List[Boolean =&gt; Unit]">List</span><span class="delimiter">[</span>Boolean =&gt; Unit<span class="delimiter">]</span><span class="delimiter">)</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="=&gt; scala.collection.mutable.HashMap[net.liftweb.db.ConnectionIdentifier,DB.this.ConnectionHolder]" id="60309">info</a>: <span title="scala.collection.mutable.HashMap[net.liftweb.db.ConnectionIdentifier,DB.this.ConnectionHolder]">HashMap</span><span class="delimiter">[</span>ConnectionIdentifier, ConnectionHolder<span class="delimiter">]</span> = <span class="delimiter">{</span>
    <a href="#60277" title="=&gt; java.lang.ThreadLocal[scala.collection.mutable.HashMap[net.liftweb.db.ConnectionIdentifier,DB.this.ConnectionHolder]]">threadStore</a>.<span title="()scala.collection.mutable.HashMap[net.liftweb.db.ConnectionIdentifier,DB.this.ConnectionHolder]">get</span> <span title="scala.collection.mutable.HashMap[net.liftweb.db.ConnectionIdentifier,DB.this.ConnectionHolder]" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <span title="scala.collection.mutable.HashMap[net.liftweb.db.ConnectionIdentifier,DB.this.ConnectionHolder]" class="keyword">null</span> =&gt;
        <span class="keyword">val</span> <a title="scala.collection.mutable.HashMap[net.liftweb.db.ConnectionIdentifier,DB.this.ConnectionHolder]" id="61931">tinfo</a> = <span title="()scala.collection.mutable.HashMap[net.liftweb.db.ConnectionIdentifier,DB.this.ConnectionHolder]" class="keyword">new</span> <span title="scala.collection.mutable.HashMap[net.liftweb.db.ConnectionIdentifier,DB.this.ConnectionHolder]">HashMap</span><span class="delimiter">[</span>ConnectionIdentifier, ConnectionHolder<span class="delimiter">]</span>
        <a href="#60277" title="=&gt; java.lang.ThreadLocal[scala.collection.mutable.HashMap[net.liftweb.db.ConnectionIdentifier,DB.this.ConnectionHolder]]">threadStore</a>.<span title="(x$1: scala.collection.mutable.HashMap[net.liftweb.db.ConnectionIdentifier,DB.this.ConnectionHolder])Unit">set</span><span class="delimiter">(</span><a href="#61931" title="scala.collection.mutable.HashMap[net.liftweb.db.ConnectionIdentifier,DB.this.ConnectionHolder]">tinfo</a><span class="delimiter">)</span>
        <a href="#61931" title="scala.collection.mutable.HashMap[net.liftweb.db.ConnectionIdentifier,DB.this.ConnectionHolder]">tinfo</a>

      <span class="keyword">case</span> <a title="scala.collection.mutable.HashMap[net.liftweb.db.ConnectionIdentifier,DB.this.ConnectionHolder]" id="61934">v</a> =&gt; <a href="#61934" title="scala.collection.mutable.HashMap[net.liftweb.db.ConnectionIdentifier,DB.this.ConnectionHolder]">v</a>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="=&gt; List[() =&gt; Unit]" id="60310">postCommit</a>: <span title="List[() =&gt; Unit]">List</span><span class="delimiter">[</span><span class="delimiter">(</span><span class="delimiter">)</span> =&gt; Unit<span class="delimiter">]</span> =
    <a href="#60279" title="=&gt; java.lang.ThreadLocal[List[() =&gt; Unit]]">_postCommitFuncs</a>.<span title="()List[() =&gt; Unit]">get</span> <span title="List[() =&gt; Unit]" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <span title="scala.collection.immutable.Nil.type" class="keyword">null</span> =&gt;
        <a href="#60279" title="=&gt; java.lang.ThreadLocal[List[() =&gt; Unit]]">_postCommitFuncs</a>.<span title="(x$1: List[() =&gt; Unit])Unit">set</span><span class="delimiter">(</span><span title="object Nil">Nil</span><span class="delimiter">)</span>
        <span title="object Nil">Nil</span>

      <span class="keyword">case</span> <a title="List[() =&gt; Unit]" id="61938">v</a> =&gt; <a href="#61938" title="List[() =&gt; Unit]">v</a>
    <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(lst: List[() =&gt; Unit])Unit" id="60311">postCommit_=</a><span class="delimiter">(</span><a title="List[() =&gt; Unit]" id="61939">lst</a>: <span title="List[() =&gt; Unit]">List</span><span class="delimiter">[</span><span class="delimiter">(</span><span class="delimiter">)</span> =&gt; Unit<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <a href="#60279" title="=&gt; java.lang.ThreadLocal[List[() =&gt; Unit]]">_postCommitFuncs</a>.<span title="(x$1: List[() =&gt; Unit])Unit">set</span><span class="delimiter">(</span><a href="#61939" title="List[() =&gt; Unit]">lst</a><span class="delimiter">)</span>

  <span class="comment">/**
   * perform this function after transaction has ended.  This is helpful for sending messages to Actors after we know
   * a transaction has been either committed or rolled back
   */</span>
  @deprecated<span class="delimiter">(</span><span class="string">&quot;Use appendPostTransaction {committed =&gt; ...}&quot;</span><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="(f: =&gt; Unit)Unit" id="60312">performPostCommit</a><span class="delimiter">(</span><a title="=&gt; Unit" id="61941">f</a>: =&gt; Unit<span class="delimiter">)</span> <span class="delimiter">{</span>
    <a href="#60311" title="(lst: List[() =&gt; Unit])Unit">postCommit</a> = <span class="delimiter">(</span><span class="delimiter">(</span><span class="delimiter">)</span> =&gt; <a href="#61941" title="=&gt; Unit">f</a><span class="delimiter">)</span> <a href="#61943" title="(x: () =&gt; Unit)List[() =&gt; Unit]">::</a> <a href="#60310" title="=&gt; List[() =&gt; Unit]">postCommit</a>
  <span class="delimiter">}</span>

  <span class="comment">// remove thread-local association</span>
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(success: Boolean)Unit" id="60313">clearThread</a><span class="delimiter">(</span><a title="Boolean" id="61950">success</a>: <span title="Boolean">Boolean</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="scala.collection.Set[net.liftweb.db.ConnectionIdentifier]" id="61952">ks</a> = <a href="#60309" title="=&gt; scala.collection.mutable.HashMap[net.liftweb.db.ConnectionIdentifier,DB.this.ConnectionHolder]">info</a>.<span title="=&gt; scala.collection.Set[net.liftweb.db.ConnectionIdentifier]">keySet</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#61952" title="scala.collection.Set[net.liftweb.db.ConnectionIdentifier]">ks</a>.<span title="=&gt; Boolean">isEmpty</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#60310" title="=&gt; List[() =&gt; Unit]">postCommit</a>.<span title="(f: () =&gt; Unit =&gt; net.liftweb.common.Box[Unit])Unit">foreach</span><span class="delimiter">(</span><a title="() =&gt; Unit" id="62013">f</a> =&gt; <a href="../../../../util/net/liftweb/util/ControlHelpers.scala.html#48608" title="(f: =&gt; Unit)net.liftweb.common.Box[Unit]">tryo</a><span class="delimiter">(</span><a href="#62013" title="() =&gt; Unit">f</a>.<span title="()Unit">apply</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>

      <a href="#60279" title="=&gt; java.lang.ThreadLocal[List[() =&gt; Unit]]">_postCommitFuncs</a>.<span title="()Unit">remove</span>
      <a href="#60277" title="=&gt; java.lang.ThreadLocal[scala.collection.mutable.HashMap[net.liftweb.db.ConnectionIdentifier,DB.this.ConnectionHolder]]">threadStore</a>.<span title="()Unit">remove</span>
    <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
      <a href="#61952" title="scala.collection.Set[net.liftweb.db.ConnectionIdentifier]">ks</a>.<span title="(f: net.liftweb.db.ConnectionIdentifier =&gt; Unit)Unit">foreach</span><span class="delimiter">(</span><a title="net.liftweb.db.ConnectionIdentifier" id="62070">n</a> =&gt; <a href="#60325" title="(name: net.liftweb.db.ConnectionIdentifier, rollback: Boolean)Unit">releaseConnectionNamed</a><span class="delimiter">(</span><a href="#62070" title="net.liftweb.db.ConnectionIdentifier">n</a>, <span title="=&gt; Boolean">!</span><a href="#61950" title="Boolean">success</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <a href="#60313" title="(success: Boolean)Unit">clearThread</a><span class="delimiter">(</span><a href="#61950" title="Boolean">success</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(name: net.liftweb.db.ConnectionIdentifier)net.liftweb.db.SuperConnection" id="60314">newConnection</a><span class="delimiter">(</span><a title="net.liftweb.db.ConnectionIdentifier" id="62075">name</a>: <a href="#10911" title="net.liftweb.db.ConnectionIdentifier">ConnectionIdentifier</a><span class="delimiter">)</span>: <a href="#10908" title="net.liftweb.db.SuperConnection">SuperConnection</a> = <span class="delimiter">{</span>
    <span class="keyword">def</span> <a title="(cm: net.liftweb.db.ConnectionManager)net.liftweb.common.Box[net.liftweb.db.SuperConnection]" id="62077">cmSuperConnection</a><span class="delimiter">(</span><a title="net.liftweb.db.ConnectionManager" id="62081">cm</a>: <a href="ConnectionManager.scala.html#10890" title="net.liftweb.db.ConnectionManager">ConnectionManager</a><span class="delimiter">)</span>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[net.liftweb.db.SuperConnection]">Box</a><span class="delimiter">[</span>SuperConnection<span class="delimiter">]</span> =
      <a href="#62081" title="net.liftweb.db.ConnectionManager">cm</a>.<a href="ConnectionManager.scala.html#59939" title="(name: net.liftweb.db.ConnectionIdentifier)net.liftweb.common.Box[net.liftweb.db.SuperConnection]">newSuperConnection</a><span class="delimiter">(</span><a href="#62075" title="net.liftweb.db.ConnectionIdentifier">name</a><span class="delimiter">)</span> <a href="../../../../common/net/liftweb/common/Box.scala.html#27043" title="(alternative: =&gt; net.liftweb.common.Box[net.liftweb.db.SuperConnection])net.liftweb.common.Box[net.liftweb.db.SuperConnection]">or</a> <a href="#62081" title="net.liftweb.db.ConnectionManager">cm</a>.<a href="ConnectionManager.scala.html#59937" title="(name: net.liftweb.db.ConnectionIdentifier)net.liftweb.common.Box[java.sql.Connection]">newConnection</a><span class="delimiter">(</span><a href="#62075" title="net.liftweb.db.ConnectionIdentifier">name</a><span class="delimiter">)</span>.<a href="../../../../common/net/liftweb/common/Box.scala.html#27020" title="(f: java.sql.Connection =&gt; net.liftweb.db.SuperConnection)net.liftweb.common.Box[net.liftweb.db.SuperConnection]">map</a><span class="delimiter">(</span><a title="java.sql.Connection" id="62090">c</a> =&gt; <a href="#60068" title="(c: java.sql.Connection, rf: () =&gt; Unit)net.liftweb.db.SuperConnection" class="keyword">new</a> <a href="#10908" title="net.liftweb.db.SuperConnection">SuperConnection</a><span class="delimiter">(</span><a href="#62090" title="java.sql.Connection">c</a>, <span class="delimiter">(</span><span class="delimiter">)</span> =&gt; <a href="#62081" title="net.liftweb.db.ConnectionManager">cm</a>.<a href="ConnectionManager.scala.html#59938" title="(conn: java.sql.Connection)Unit">releaseConnection</a><span class="delimiter">(</span><a href="#62090" title="java.sql.Connection">c</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>

    <span class="keyword">def</span> <a title="=&gt; net.liftweb.common.Box[net.liftweb.db.SuperConnection]" id="62078">jndiSuperConnection</a>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[net.liftweb.db.SuperConnection]">Box</a><span class="delimiter">[</span>SuperConnection<span class="delimiter">]</span> = <a href="#60296" title="(name: net.liftweb.db.ConnectionIdentifier)net.liftweb.common.Box[java.sql.Connection]">jndiConnection</a><span class="delimiter">(</span><a href="#62075" title="net.liftweb.db.ConnectionIdentifier">name</a><span class="delimiter">)</span>.<a href="../../../../common/net/liftweb/common/Box.scala.html#27020" title="(f: java.sql.Connection =&gt; net.liftweb.db.SuperConnection)net.liftweb.common.Box[net.liftweb.db.SuperConnection]">map</a><span class="delimiter">(</span><a title="java.sql.Connection" id="62104">c</a> =&gt; <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="java.lang.String" id="62105">uniqueId</a> = <span title="java.lang.String" class="keyword">if</span> <span class="delimiter">(</span><a href="../../../../common/net/liftweb/common/Logging.scala.html#19845" title="=&gt; net.liftweb.common.Logger">logger</a>.<a href="../../../../common/net/liftweb/common/Logging.scala.html#31946" title="=&gt; Boolean">isDebugEnabled</a><span class="delimiter">)</span> <a href="../../../../util/net/liftweb/util/Helpers.scala.html#13346" title="object net.liftweb.util.Helpers">Helpers</a>.<a href="../../../../util/net/liftweb/util/HttpHelpers.scala.html#49062" title="=&gt; Long">nextNum</a>.<span title="()java.lang.String">toString</span> <span class="keyword">else</span> <span title="java.lang.String(&quot;&quot;)" class="string">&quot;&quot;</span>
      <a href="../../../../common/net/liftweb/common/Logging.scala.html#19845" title="=&gt; net.liftweb.common.Logger">logger</a>.<a href="../../../../common/net/liftweb/common/Logging.scala.html#31942" title="(msg: =&gt; AnyRef)Unit">debug</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Connection ID &quot;)" class="string">&quot;Connection ID &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#62105" title="java.lang.String">uniqueId</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot; for JNDI connection &quot;)" class="string">&quot; for JNDI connection &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#62075" title="net.liftweb.db.ConnectionIdentifier">name</a>.<a href="#60050" title="=&gt; String">jndiName</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot; opened&quot;)" class="string">&quot; opened&quot;</span><span class="delimiter">)</span>
      <a href="#60068" title="(c: java.sql.Connection, rf: () =&gt; Unit)net.liftweb.db.SuperConnection" class="keyword">new</a> <a href="#10908" title="net.liftweb.db.SuperConnection">SuperConnection</a><span class="delimiter">(</span><a href="#62104" title="java.sql.Connection">c</a>, <span class="delimiter">(</span><span class="delimiter">)</span> =&gt; <span class="delimiter">{</span><a href="../../../../common/net/liftweb/common/Logging.scala.html#19845" title="=&gt; net.liftweb.common.Logger">logger</a>.<a href="../../../../common/net/liftweb/common/Logging.scala.html#31942" title="(msg: =&gt; AnyRef)Unit">debug</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Connection ID &quot;)" class="string">&quot;Connection ID &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#62105" title="java.lang.String">uniqueId</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot; for JNDI connection &quot;)" class="string">&quot; for JNDI connection &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#62075" title="net.liftweb.db.ConnectionIdentifier">name</a>.<a href="#60050" title="=&gt; String">jndiName</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot; closed&quot;)" class="string">&quot; closed&quot;</span><span class="delimiter">)</span>; <a href="#62104" title="java.sql.Connection">c</a>.<span title="()Unit">close</span><span class="delimiter">}</span><span class="delimiter">)</span>
    <span class="delimiter">}</span><span class="delimiter">)</span>


    <span class="keyword">val</span> <a title="net.liftweb.common.Box[net.liftweb.db.SuperConnection]" id="62079">cmConn</a> = <span class="keyword">for</span> <span class="delimiter">{</span>
      <a title="net.liftweb.db.ConnectionManager" id="62623">connectionManager</a> &lt;- <a href="#60300" title="=&gt; net.liftweb.util.ThreadGlobal[Map[net.liftweb.db.ConnectionIdentifier,net.liftweb.db.ConnectionManager]]">threadLocalConnectionManagers</a>.<a href="../../../../util/net/liftweb/util/ThreadGlobal.scala.html#51271" title="=&gt; net.liftweb.common.Box[Map[net.liftweb.db.ConnectionIdentifier,net.liftweb.db.ConnectionManager]]">box</a>.<a href="../../../../common/net/liftweb/common/Box.scala.html#27023" title="(f: Map[net.liftweb.db.ConnectionIdentifier,net.liftweb.db.ConnectionManager] =&gt; net.liftweb.common.Box[net.liftweb.db.ConnectionManager])net.liftweb.common.Box[net.liftweb.db.ConnectionManager]">flatMap</a><span class="delimiter">(</span><a href="#62517" title="Map[net.liftweb.db.ConnectionIdentifier,net.liftweb.db.ConnectionManager]">_</a>.<span title="(key: net.liftweb.db.ConnectionIdentifier)Option[net.liftweb.db.ConnectionManager]">get</span><a href="../../../../common/net/liftweb/common/Box.scala.html#28627" title="(in: Option[net.liftweb.db.ConnectionManager])net.liftweb.common.Box[net.liftweb.db.ConnectionManager]" class="delimiter">(</a><a href="#62075" title="net.liftweb.db.ConnectionIdentifier">name</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../../../common/net/liftweb/common/Box.scala.html#27023" title="(f: net.liftweb.db.ConnectionManager =&gt; net.liftweb.common.Box[net.liftweb.db.SuperConnection])net.liftweb.common.Box[net.liftweb.db.SuperConnection]">or</a> <a href="../../../../common/net/liftweb/common/Box.scala.html#28602" title="(in: Option[net.liftweb.db.ConnectionManager])net.liftweb.common.Box[net.liftweb.db.ConnectionManager] with Serializable">Box</a><span class="delimiter">(</span><a href="#60298" title="=&gt; scala.collection.mutable.HashMap[net.liftweb.db.ConnectionIdentifier,net.liftweb.db.ConnectionManager]">connectionManagers</a>.<span title="(key: net.liftweb.db.ConnectionIdentifier)Option[net.liftweb.db.ConnectionManager]">get</span><span class="delimiter">(</span><a href="#62075" title="net.liftweb.db.ConnectionIdentifier">name</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <a title="net.liftweb.db.SuperConnection" id="62628">connection</a> &lt;- <a href="#62077" title="(cm: net.liftweb.db.ConnectionManager)net.liftweb.common.Box[net.liftweb.db.SuperConnection]">cmSuperConnection</a><a href="../../../../common/net/liftweb/common/Box.scala.html#27020" title="(f: net.liftweb.db.SuperConnection =&gt; net.liftweb.db.SuperConnection)net.liftweb.common.Box[net.liftweb.db.SuperConnection]" class="delimiter">(</a><a href="#62623" title="net.liftweb.db.ConnectionManager">connectionManager</a><span class="delimiter">)</span>
    <span class="delimiter">}</span> <span class="keyword">yield</span> <a href="#62628" title="net.liftweb.db.SuperConnection">connection</a>

    <span class="keyword">val</span> <a title="net.liftweb.common.Box[net.liftweb.db.SuperConnection]" id="62080">ret</a> = <a href="#62079" title="net.liftweb.common.Box[net.liftweb.db.SuperConnection]">cmConn</a> <a href="../../../../common/net/liftweb/common/Box.scala.html#27043" title="(alternative: =&gt; net.liftweb.common.Box[net.liftweb.db.SuperConnection])net.liftweb.common.Box[net.liftweb.db.SuperConnection]">or</a> <a href="#62078" title="=&gt; net.liftweb.common.Box[net.liftweb.db.SuperConnection]">jndiSuperConnection</a>

    <a href="#62080" title="net.liftweb.common.Box[net.liftweb.db.SuperConnection]">ret</a>.<a href="../../../../common/net/liftweb/common/Box.scala.html#27031" title="(f: net.liftweb.db.SuperConnection =&gt; Unit)Unit">foreach</a> <span class="delimiter">(</span><a href="#62644" title="implicit net.liftweb.db.SuperConnection.superToConn : (in: net.liftweb.db.SuperConnection)java.sql.Connection">_</a>.<span title="(x$1: Boolean)Unit">setAutoCommit</span><span class="delimiter">(</span><span title="Boolean(false)" class="keyword">false</span><span class="delimiter">)</span><span class="delimiter">)</span>

    <a href="#62080" title="net.liftweb.common.Box[net.liftweb.db.SuperConnection]">ret</a> <a href="../../../../common/net/liftweb/common/Box.scala.html#27017" title="(default: =&gt; net.liftweb.db.SuperConnection)net.liftweb.db.SuperConnection">openOr</a> <span class="delimiter">{</span>
      <span title="Nothing" class="keyword">throw</span> <span title="(x$1: java.lang.String)java.lang.NullPointerException" class="keyword">new</span> <span title="java.lang.NullPointerException">NullPointerException</span><span class="delimiter">(</span><span title="java.lang.String(&quot;Looking for Connection Identifier &quot;)" class="string">&quot;Looking for Connection Identifier &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#62075" title="net.liftweb.db.ConnectionIdentifier">name</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot; but failed to find either a JNDI data source &quot;)" class="string">&quot; but failed to find either a JNDI data source &quot;</span> <span title="(x$1: Any)java.lang.String">+</span>
                                       <span title="java.lang.String(&quot;with the name &quot;)" class="string">&quot;with the name &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#62075" title="net.liftweb.db.ConnectionIdentifier">name</a>.<a href="#60050" title="=&gt; String">jndiName</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot; or a lift connection manager with the correct name&quot;)" class="string">&quot; or a lift connection manager with the correct name&quot;</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">class</span> <a title="class ThreadBasedConnectionManager extends java.lang.Object with ScalaObject" id="60315">ThreadBasedConnectionManager</a><a href="#60315" title="ScalaObject" class="delimiter">(</a><a title="List[net.liftweb.db.ConnectionIdentifier]" id="62667">connections</a>: <span title="List[net.liftweb.db.ConnectionIdentifier]">List</span><span class="delimiter">[</span>ConnectionIdentifier<span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <span class="keyword">private</span> <span class="keyword">var</span> <a title="Set[net.liftweb.db.ConnectionIdentifier]" id="62661">used</a>: <span title="Set[net.liftweb.db.ConnectionIdentifier]">Set</span><span class="delimiter">[</span>ConnectionIdentifier<span class="delimiter">]</span> = <span title="(elems: net.liftweb.db.ConnectionIdentifier*)scala.collection.immutable.Set[net.liftweb.db.ConnectionIdentifier]">Set</span><span class="delimiter">(</span><span class="delimiter">)</span>

    <span class="keyword">def</span> <a title="(conn: net.liftweb.db.ConnectionIdentifier)Int" id="62663">use</a><span class="delimiter">(</span><a title="net.liftweb.db.ConnectionIdentifier" id="62699">conn</a>: <a href="#10911" title="net.liftweb.db.ConnectionIdentifier">ConnectionIdentifier</a><span class="delimiter">)</span>: <span title="Int">Int</span> = <span title="Int" class="keyword">if</span> <span class="delimiter">(</span><a href="#62667" title="List[net.liftweb.db.ConnectionIdentifier]">connections</a>.<span title="(elem: Any)Boolean">contains</span><span class="delimiter">(</span><a href="#62699" title="net.liftweb.db.ConnectionIdentifier">conn</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#62661" title="(x$1: Set[net.liftweb.db.ConnectionIdentifier])Unit">used</a> <span title="(elem: net.liftweb.db.ConnectionIdentifier)scala.collection.immutable.Set[net.liftweb.db.ConnectionIdentifier]">+=</span> <a href="#62699" title="net.liftweb.db.ConnectionIdentifier">conn</a>
      <span title="Int(1)" class="int">1</span>
    <span class="delimiter">}</span> <span class="keyword">else</span> <span title="Int(0)" class="int">0</span>
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">object</span> <a title="object DB.this.CurrentConnectionSet" id="60316">CurrentConnectionSet</a> <span title="ScalaObject" class="keyword">extends</span> <a href="../../../../util/net/liftweb/util/ThreadGlobal.scala.html#13701" title="net.liftweb.util.DynoVar[DB.this.ThreadBasedConnectionManager]">DynoVar</a><span class="delimiter">[</span>ThreadBasedConnectionManager<span class="delimiter">]</span>

  <span class="comment">/**
   * Build a LoanWrapper to pass into S.addAround() to make requests for
   * the DefaultConnectionIdentifier transactional for the complete HTTP request
   */</span>
  <span class="keyword">def</span> <a title="()net.liftweb.util.LoanWrapper" id="60318">buildLoanWrapper</a><span class="delimiter">(</span><span class="delimiter">)</span>: <a href="../../../../util/net/liftweb/util/LoanWrapper.scala.html#13462" title="net.liftweb.util.LoanWrapper">LoanWrapper</a> =
  <a href="#60319" title="(in: List[net.liftweb.db.ConnectionIdentifier])net.liftweb.util.LoanWrapper">buildLoanWrapper</a><span class="delimiter">(</span><span title="(xs: net.liftweb.db.DefaultConnectionIdentifier.type*)List[net.liftweb.db.DefaultConnectionIdentifier.type]">List</span><span class="delimiter">(</span><a href="#66906" title="object net.liftweb.db.DefaultConnectionIdentifier">DefaultConnectionIdentifier</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="comment">/**
   * Build a LoanWrapper to pass into S.addAround() to make requests for
   * the List of ConnectionIdentifiers transactional for the complete HTTP request
   */</span>
  <span class="keyword">def</span> <a title="(in: List[net.liftweb.db.ConnectionIdentifier])net.liftweb.util.LoanWrapper" id="60319">buildLoanWrapper</a><span class="delimiter">(</span><a title="List[net.liftweb.db.ConnectionIdentifier]" id="63027">in</a>: <span title="List[net.liftweb.db.ConnectionIdentifier]">List</span><span class="delimiter">[</span>ConnectionIdentifier<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../../../util/net/liftweb/util/LoanWrapper.scala.html#13462" title="net.liftweb.util.LoanWrapper">LoanWrapper</a> =
  <a href="#60321" title="(eager: Boolean, in: List[net.liftweb.db.ConnectionIdentifier])net.liftweb.util.LoanWrapper">buildLoanWrapper</a><span class="delimiter">(</span><span title="Boolean(true)" class="keyword">true</span>, <a href="#63027" title="List[net.liftweb.db.ConnectionIdentifier]">in</a><span class="delimiter">)</span>

  <span class="comment">/**
   * Build a LoanWrapper to pass into S.addAround() to make requests for
   * the DefaultConnectionIdentifier transactional for the complete HTTP request
   */</span>
  <span class="keyword">def</span> <a title="(eager: Boolean)net.liftweb.util.LoanWrapper" id="60320">buildLoanWrapper</a><span class="delimiter">(</span><a title="Boolean" id="63025">eager</a>: <span title="Boolean">Boolean</span><span class="delimiter">)</span>: <a href="../../../../util/net/liftweb/util/LoanWrapper.scala.html#13462" title="net.liftweb.util.LoanWrapper">LoanWrapper</a> =
  <a href="#60321" title="(eager: Boolean, in: List[net.liftweb.db.ConnectionIdentifier])net.liftweb.util.LoanWrapper">buildLoanWrapper</a><span class="delimiter">(</span><a href="#63025" title="Boolean">eager</a>, <span title="(xs: net.liftweb.db.DefaultConnectionIdentifier.type*)List[net.liftweb.db.DefaultConnectionIdentifier.type]">List</span><span class="delimiter">(</span><a href="#66906" title="object net.liftweb.db.DefaultConnectionIdentifier">DefaultConnectionIdentifier</a><span class="delimiter">)</span><span class="delimiter">)</span>

  <span class="comment">/**
   * Build a LoanWrapper to pass into S.addAround() to make requests for
   * the List of ConnectionIdentifiers transactional for the complete HTTP request
   */</span>
  <span class="keyword">def</span> <a title="(eager: Boolean, in: List[net.liftweb.db.ConnectionIdentifier])net.liftweb.util.LoanWrapper" id="60321">buildLoanWrapper</a><span class="delimiter">(</span><a title="Boolean" id="63022">eager</a>: <span title="Boolean">Boolean</span>, <a title="List[net.liftweb.db.ConnectionIdentifier]" id="63023">in</a>: <span title="List[net.liftweb.db.ConnectionIdentifier]">List</span><span class="delimiter">[</span>ConnectionIdentifier<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="../../../../util/net/liftweb/util/LoanWrapper.scala.html#13462" title="net.liftweb.util.LoanWrapper">LoanWrapper</a> =
    <a href="#63053" title="java.lang.Object with net.liftweb.util.LoanWrapper{}" class="keyword">new</a> <a title="anonymous class $anon extends java.lang.Object with net.liftweb.util.LoanWrapper" id="63053">LoanWrapper</a> <span class="delimiter">{</span>
      <span class="keyword">private</span> <span class="keyword">object</span> <a title="object this.DepthCnt" id="63057">DepthCnt</a> <span title="ScalaObject" class="keyword">extends</span> <a href="../../../../util/net/liftweb/util/ThreadGlobal.scala.html#13701" title="net.liftweb.util.DynoVar[Boolean]">DynoVar</a><span class="delimiter">[</span>Boolean<span class="delimiter">]</span>

      <span class="keyword">def</span> <a title="[T](f: =&gt; T)T" id="63059">apply</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="63061">T</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="=&gt; T" id="63062">f</a>: =&gt; T<span class="delimiter">)</span>: <a href="#63061" title="T">T</a> = <span title="T" class="keyword">if</span> <span class="delimiter">(</span><a href="#63057" title="object this.DepthCnt">DepthCnt</a>.<a href="../../../../util/net/liftweb/util/ThreadGlobal.scala.html#63009" title="=&gt; net.liftweb.common.Box[Boolean]">is</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="../../../../common/net/liftweb/common/Box.scala.html#27086" title="(value: Boolean)net.liftweb.common.Full[Boolean]">Full</a><span class="delimiter">(</span><span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span><span class="delimiter">)</span> <a href="#63062" title="=&gt; T">f</a>
      <span class="keyword">else</span> <a href="#63057" title="object this.DepthCnt">DepthCnt</a>.<a href="../../../../util/net/liftweb/util/ThreadGlobal.scala.html#63012" title="(x: Boolean)(f: =&gt; T)T">run</a><span class="delimiter">(</span><span title="Boolean(true)" class="keyword">true</span><span class="delimiter">)</span> <span class="delimiter">{</span>

        <span class="keyword">var</span> <a title="Boolean" id="63093">success</a> = <span title="Boolean(false)" class="keyword">false</span>
        <span title="T" class="keyword">if</span> <span class="delimiter">(</span><a href="#63022" title="Boolean">eager</a><span class="delimiter">)</span> <span class="delimiter">{</span>
          <span class="keyword">def</span> <a title="(lst: List[net.liftweb.db.ConnectionIdentifier])T" id="63094">recurseMe</a><span class="delimiter">(</span><a title="List[net.liftweb.db.ConnectionIdentifier]" id="63095">lst</a>: <span title="List[net.liftweb.db.ConnectionIdentifier]">List</span><span class="delimiter">[</span>ConnectionIdentifier<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#63061" title="T">T</a> = <a href="#63095" title="List[net.liftweb.db.ConnectionIdentifier]">lst</a> <span title="T" class="keyword">match</span> <span class="delimiter">{</span>
            <span class="keyword">case</span> <span title="T">Nil</span> =&gt;
              <span class="keyword">try</span> <span class="delimiter">{</span>
                <span class="keyword">try</span> <span class="delimiter">{</span>
                  <span class="keyword">val</span> <a title="T" id="63096">ret</a> = <a href="#63062" title="=&gt; T">f</a>
                  <a href="#63093" title="Boolean">success</a> = <span title="Boolean(true)" class="keyword">true</span>
                  <a href="#63096" title="T">ret</a>
                <span class="delimiter">}</span> <span class="keyword">catch</span> <span class="delimiter">{</span>
                  <span class="comment">// this is the case when we want to commit the transaction</span>
                  <span class="comment">// but continue to throw the exception</span>
                  <span class="keyword">case</span> <a title="Nothing" id="63097">e</a>: <a href="../../../../util/net/liftweb/util/Helpers.scala.html#13350" title="net.liftweb.util.LiftFlowOfControlException">LiftFlowOfControlException</a> =&gt; <span class="delimiter">{</span>
                    <a href="#63093" title="Boolean">success</a> = <span title="Boolean(true)" class="keyword">true</span>
                    <span title="Nothing" class="keyword">throw</span> <a href="#63097" title="net.liftweb.util.LiftFlowOfControlException">e</a>
                  <span class="delimiter">}</span>
                <span class="delimiter">}</span>

              <span class="delimiter">}</span> <span class="keyword">finally</span> <span class="delimiter">{</span>
                <a href="#60313" title="(success: Boolean)Unit">clearThread</a><span class="delimiter">(</span><a href="#63093" title="Boolean">success</a><span class="delimiter">)</span>
              <span class="delimiter">}</span>

            <span class="keyword">case</span> <a title="T" id="63107">x</a> :: <a title="List[net.liftweb.db.ConnectionIdentifier]" id="63108">xs</a> =&gt; <a href="#60272" title="implicit net.liftweb.db.DB1.db1ToDb : (in: net.liftweb.db.DB1)net.liftweb.db.DB">DB</a>.<a href="#60371" title="(name: net.liftweb.db.ConnectionIdentifier)(f: net.liftweb.db.SuperConnection =&gt; T)T">use</a><span class="delimiter">(</span><a href="#63107" title="net.liftweb.db.ConnectionIdentifier">x</a><span class="delimiter">)</span> <span class="delimiter">{</span><a title="net.liftweb.db.SuperConnection" id="63122">ignore</a> =&gt; <a href="#63094" title="(lst: List[net.liftweb.db.ConnectionIdentifier])T">recurseMe</a><span class="delimiter">(</span><a href="#63108" title="List[net.liftweb.db.ConnectionIdentifier]">xs</a><span class="delimiter">)</span><span class="delimiter">}</span>
          <span class="delimiter">}</span>
          <a href="#63094" title="(lst: List[net.liftweb.db.ConnectionIdentifier])T">recurseMe</a><span class="delimiter">(</span><a href="#63023" title="List[net.liftweb.db.ConnectionIdentifier]">in</a><span class="delimiter">)</span>
        <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
          <a href="#60316" title="object DB.this.CurrentConnectionSet">CurrentConnectionSet</a>.<a href="../../../../util/net/liftweb/util/ThreadGlobal.scala.html#63012" title="(x: DB.this.ThreadBasedConnectionManager)(f: =&gt; T)T">run</a><span class="delimiter">(</span><span title="DB.this.ThreadBasedConnectionManager" class="keyword">new</span> <a href="#60315" title="DB.this.ThreadBasedConnectionManager">ThreadBasedConnectionManager</a><span class="delimiter">(</span><a href="#63023" title="List[net.liftweb.db.ConnectionIdentifier]">in</a><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
            <span class="keyword">try</span> <span class="delimiter">{</span>
              <span class="keyword">try</span> <span class="delimiter">{</span>
                <span class="keyword">val</span> <a title="T" id="63130">ret</a> = <a href="#63062" title="=&gt; T">f</a>
                <a href="#63093" title="Boolean">success</a> = <span title="Boolean(true)" class="keyword">true</span>
                <a href="#63130" title="T">ret</a>
              <span class="delimiter">}</span> <span class="keyword">catch</span> <span class="delimiter">{</span>
                <span class="comment">// this is the case when we want to commit the transaction</span>
                <span class="comment">// but continue to throw the exception</span>
                <span class="keyword">case</span> <a title="Nothing" id="63131">e</a>: <a href="../../../../util/net/liftweb/util/Helpers.scala.html#13350" title="net.liftweb.util.LiftFlowOfControlException">LiftFlowOfControlException</a> =&gt; <span class="delimiter">{</span>
                  <a href="#63093" title="Boolean">success</a> = <span title="Boolean(true)" class="keyword">true</span>
                  <span title="Nothing" class="keyword">throw</span> <a href="#63131" title="net.liftweb.util.LiftFlowOfControlException">e</a>
                <span class="delimiter">}</span>
              <span class="delimiter">}</span>
            <span class="delimiter">}</span> <span class="keyword">finally</span> <span class="delimiter">{</span>
              <a href="#60313" title="(success: Boolean)Unit">clearThread</a><span class="delimiter">(</span><a href="#63093" title="Boolean">success</a><span class="delimiter">)</span>
            <span class="delimiter">}</span>
          <span class="delimiter">}</span>
        <span class="delimiter">}</span>

      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(conn: net.liftweb.db.SuperConnection)Unit" id="60322">releaseConnection</a><span class="delimiter">(</span><a title="net.liftweb.db.SuperConnection" id="63137">conn</a>: <a href="#10908" title="net.liftweb.db.SuperConnection">SuperConnection</a><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <a href="#62644" title="implicit net.liftweb.db.SuperConnection.superToConn : (in: net.liftweb.db.SuperConnection)java.sql.Connection">conn</a>.<span title="()Unit">close</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(conn: net.liftweb.db.ConnectionIdentifier)Int" id="60323">calcBaseCount</a><span class="delimiter">(</span><a title="net.liftweb.db.ConnectionIdentifier" id="63143">conn</a>: <a href="#10911" title="net.liftweb.db.ConnectionIdentifier">ConnectionIdentifier</a><span class="delimiter">)</span>: <span title="Int">Int</span> =
  <a href="#60316" title="object DB.this.CurrentConnectionSet">CurrentConnectionSet</a>.<a href="../../../../util/net/liftweb/util/ThreadGlobal.scala.html#63009" title="=&gt; net.liftweb.common.Box[DB.this.ThreadBasedConnectionManager]">is</a>.<a href="../../../../common/net/liftweb/common/Box.scala.html#27020" title="(f: DB.this.ThreadBasedConnectionManager =&gt; Int)net.liftweb.common.Box[Int]">map</a><span class="delimiter">(</span><a href="#63149" title="DB.this.ThreadBasedConnectionManager">_</a>.<a href="#62663" title="(conn: net.liftweb.db.ConnectionIdentifier)Int">use</a><span class="delimiter">(</span><a href="#63143" title="net.liftweb.db.ConnectionIdentifier">conn</a><span class="delimiter">)</span><span class="delimiter">)</span> <a href="../../../../common/net/liftweb/common/Box.scala.html#27017" title="(default: =&gt; Int)Int">openOr</a> <span title="Int(0)" class="int">0</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(name: net.liftweb.db.ConnectionIdentifier)net.liftweb.db.SuperConnection" id="60324">getConnection</a><span class="delimiter">(</span><a title="net.liftweb.db.ConnectionIdentifier" id="63156">name</a>: <a href="#10911" title="net.liftweb.db.ConnectionIdentifier">ConnectionIdentifier</a><span class="delimiter">)</span>: <a href="#10908" title="net.liftweb.db.SuperConnection">SuperConnection</a> = <span class="delimiter">{</span>
    <a href="../../../../common/net/liftweb/common/Logging.scala.html#19845" title="=&gt; net.liftweb.common.Logger">logger</a>.<a href="../../../../common/net/liftweb/common/Logging.scala.html#31936" title="(msg: =&gt; AnyRef)Unit">trace</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Acquiring &quot;)" class="string">&quot;Acquiring &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#63156" title="net.liftweb.db.ConnectionIdentifier">name</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot; On thread &quot;)" class="string">&quot; On thread &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <span title="object java.lang.Thread">Thread</span>.<span title="()java.lang.Thread">currentThread</span><span class="delimiter">)</span>
    <span class="keyword">var</span> <a title="DB.this.ConnectionHolder" id="63158">ret</a> = <a href="#60309" title="=&gt; scala.collection.mutable.HashMap[net.liftweb.db.ConnectionIdentifier,DB.this.ConnectionHolder]">info</a>.<span title="(key: net.liftweb.db.ConnectionIdentifier)Option[DB.this.ConnectionHolder]">get</span><span class="delimiter">(</span><a href="#63156" title="net.liftweb.db.ConnectionIdentifier">name</a><span class="delimiter">)</span> <span title="DB.this.ConnectionHolder" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <span title="DB.this.ConnectionHolder">None</span> =&gt; <a href="#61867" title="(conn: net.liftweb.db.SuperConnection, cnt: Int, postTransaction: List[Boolean =&gt; Unit])DB.this.ConnectionHolder">ConnectionHolder</a><span class="delimiter">(</span><a href="#60314" title="(name: net.liftweb.db.ConnectionIdentifier)net.liftweb.db.SuperConnection">newConnection</a><span class="delimiter">(</span><a href="#63156" title="net.liftweb.db.ConnectionIdentifier">name</a><span class="delimiter">)</span>, <a href="#60323" title="(conn: net.liftweb.db.ConnectionIdentifier)Int">calcBaseCount</a><span class="delimiter">(</span><a href="#63156" title="net.liftweb.db.ConnectionIdentifier">name</a><span class="delimiter">)</span> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span>, <span title="object Nil">Nil</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="DB.this.ConnectionHolder">Some</span><span class="delimiter">(</span>ConnectionHolder<span class="delimiter">(</span><a title="net.liftweb.db.SuperConnection" id="63188">conn</a>, <a title="Int" id="63189">cnt</a>, <a title="List[Boolean =&gt; Unit]" id="63190">post</a><span class="delimiter">)</span><span class="delimiter">)</span> =&gt; <a href="#61867" title="(conn: net.liftweb.db.SuperConnection, cnt: Int, postTransaction: List[Boolean =&gt; Unit])DB.this.ConnectionHolder">ConnectionHolder</a><span class="delimiter">(</span><a href="#63188" title="net.liftweb.db.SuperConnection">conn</a>, <a href="#63189" title="Int">cnt</a> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span>, <a href="#63190" title="List[Boolean =&gt; Unit]">post</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
    <a href="#60309" title="(key: net.liftweb.db.ConnectionIdentifier, value: DB.this.ConnectionHolder)Unit">info</a><span class="delimiter">(</span><a href="#63156" title="net.liftweb.db.ConnectionIdentifier">name</a><span class="delimiter">)</span> = <a href="#63158" title="DB.this.ConnectionHolder">ret</a>
    <a href="../../../../common/net/liftweb/common/Logging.scala.html#19845" title="=&gt; net.liftweb.common.Logger">logger</a>.<a href="../../../../common/net/liftweb/common/Logging.scala.html#31936" title="(msg: =&gt; AnyRef)Unit">trace</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Acquired &quot;)" class="string">&quot;Acquired &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#63156" title="net.liftweb.db.ConnectionIdentifier">name</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot; on thread &quot;)" class="string">&quot; on thread &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <span title="object java.lang.Thread">Thread</span>.<span title="()java.lang.Thread">currentThread</span> <span title="(x$1: Any)java.lang.String">+</span>
              <span title="java.lang.String(&quot; count &quot;)" class="string">&quot; count &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#63158" title="DB.this.ConnectionHolder">ret</a>.<a href="#63174" title="=&gt; Int">cnt</a><span class="delimiter">)</span>
    <a href="#63158" title="DB.this.ConnectionHolder">ret</a>.<a href="#63173" title="=&gt; net.liftweb.db.SuperConnection">conn</a>
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(name: net.liftweb.db.ConnectionIdentifier, rollback: Boolean)Unit" id="60325">releaseConnectionNamed</a><span class="delimiter">(</span><a title="net.liftweb.db.ConnectionIdentifier" id="62071">name</a>: <a href="#10911" title="net.liftweb.db.ConnectionIdentifier">ConnectionIdentifier</a>, <a title="Boolean" id="62072">rollback</a>: <span title="Boolean">Boolean</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <a href="../../../../common/net/liftweb/common/Logging.scala.html#19845" title="=&gt; net.liftweb.common.Logger">logger</a>.<a href="../../../../common/net/liftweb/common/Logging.scala.html#31936" title="(msg: =&gt; AnyRef)Unit">trace</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Request to release &quot;)" class="string">&quot;Request to release &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#62071" title="net.liftweb.db.ConnectionIdentifier">name</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot; on thread &quot;)" class="string">&quot; on thread &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <span title="object java.lang.Thread">Thread</span>.<span title="()java.lang.Thread">currentThread</span><span class="delimiter">)</span>
    <span class="delimiter">(</span><a href="#60309" title="=&gt; scala.collection.mutable.HashMap[net.liftweb.db.ConnectionIdentifier,DB.this.ConnectionHolder]">info</a>.<span title="(key: net.liftweb.db.ConnectionIdentifier)Option[DB.this.ConnectionHolder]">get</span><span class="delimiter">(</span><a href="#62071" title="net.liftweb.db.ConnectionIdentifier">name</a><span class="delimiter">)</span>: @<span title="Option[DB.this.ConnectionHolder] @unchecked">unchecked</span><span class="delimiter">)</span> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <span title="Unit">Some</span><span class="delimiter">(</span>ConnectionHolder<span class="delimiter">(</span><a title="net.liftweb.db.SuperConnection" id="63219">c</a>, <span title="Int(1)" class="int">1</span>, <a title="List[Boolean =&gt; Unit]" id="63220">post</a><span class="delimiter">)</span><span class="delimiter">)</span> =&gt; <span class="delimiter">{</span>
        <span title="Any" class="keyword">if</span> <span class="delimiter">(</span><span title="=&gt; Boolean">!</span> <a href="#62644" title="implicit net.liftweb.db.SuperConnection.superToConn : (in: net.liftweb.db.SuperConnection)java.sql.Connection">c</a>.<span title="()Boolean">getAutoCommit</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span> <span class="delimiter">{</span>
          <span title="Any" class="keyword">if</span> <span class="delimiter">(</span><a href="#62072" title="Boolean">rollback</a><span class="delimiter">)</span> <a href="../../../../util/net/liftweb/util/ControlHelpers.scala.html#48608" title="(f: =&gt; Unit)net.liftweb.common.Box[Unit]">tryo</a><span class="delimiter">{</span><a href="#62644" title="implicit net.liftweb.db.SuperConnection.superToConn : (in: net.liftweb.db.SuperConnection)java.sql.Connection">c</a>.<span title="()Unit">rollback</span><span class="delimiter">}</span>
          <span class="keyword">else</span> <a href="#62644" title="implicit net.liftweb.db.SuperConnection.superToConn : (in: net.liftweb.db.SuperConnection)java.sql.Connection">c</a>.<span title="()Unit">commit</span>
        <span class="delimiter">}</span>
        <a href="../../../../util/net/liftweb/util/ControlHelpers.scala.html#48608" title="(f: =&gt; Unit)net.liftweb.common.Box[Unit]">tryo</a><span class="delimiter">(</span><a href="#63219" title="net.liftweb.db.SuperConnection">c</a>.<a href="#62096" title="()Unit">releaseFunc</a><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
        <a href="#60309" title="=&gt; scala.collection.mutable.HashMap[net.liftweb.db.ConnectionIdentifier,DB.this.ConnectionHolder]">info</a> <span title="(key: net.liftweb.db.ConnectionIdentifier)scala.collection.mutable.HashMap[net.liftweb.db.ConnectionIdentifier,DB.this.ConnectionHolder]">-=</span> <a href="#62071" title="net.liftweb.db.ConnectionIdentifier">name</a>
        <a href="../../../../common/net/liftweb/common/Logging.scala.html#19845" title="=&gt; net.liftweb.common.Logger">logger</a>.<a href="../../../../common/net/liftweb/common/Logging.scala.html#31936" title="(msg: =&gt; AnyRef)Unit">trace</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;Invoking %d postTransaction functions &quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#63220" title="List[Boolean =&gt; Unit]">post</a>.<span title="=&gt; Int">size</span><span class="delimiter">)</span><span class="delimiter">)</span>
        <a href="#63220" title="List[Boolean =&gt; Unit]">post</a>.<span title="=&gt; List[Boolean =&gt; Unit]">reverse</span>.<span title="(f: Boolean =&gt; Unit =&gt; net.liftweb.common.Box[Unit])Unit">foreach</span><span class="delimiter">(</span><a title="Boolean =&gt; Unit" id="63376">f</a> =&gt; <a href="../../../../util/net/liftweb/util/ControlHelpers.scala.html#48608" title="(f: =&gt; Unit)net.liftweb.common.Box[Unit]">tryo</a><span class="delimiter">(</span><a href="#63376" title="(v1: Boolean)Unit">f</a><span class="delimiter">(</span><span title="=&gt; Boolean">!</span><a href="#62072" title="Boolean">rollback</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">)</span>
        <a href="../../../../common/net/liftweb/common/Logging.scala.html#19845" title="=&gt; net.liftweb.common.Logger">logger</a>.<a href="../../../../common/net/liftweb/common/Logging.scala.html#31936" title="(msg: =&gt; AnyRef)Unit">trace</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Released &quot;)" class="string">&quot;Released &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#62071" title="net.liftweb.db.ConnectionIdentifier">name</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot; on thread &quot;)" class="string">&quot; on thread &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <span title="object java.lang.Thread">Thread</span>.<span title="()java.lang.Thread">currentThread</span><span class="delimiter">)</span>
      <span class="delimiter">}</span>
      <span class="keyword">case</span> <span title="Unit">Some</span><span class="delimiter">(</span>ConnectionHolder<span class="delimiter">(</span><a title="net.liftweb.db.SuperConnection" id="63424">c</a>, <a title="Int" id="63425">n</a>, <a title="List[Boolean =&gt; Unit]" id="63426">post</a><span class="delimiter">)</span><span class="delimiter">)</span> =&gt;
        <a href="../../../../common/net/liftweb/common/Logging.scala.html#19845" title="=&gt; net.liftweb.common.Logger">logger</a>.<a href="../../../../common/net/liftweb/common/Logging.scala.html#31936" title="(msg: =&gt; AnyRef)Unit">trace</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Did not release &quot;)" class="string">&quot;Did not release &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#62071" title="net.liftweb.db.ConnectionIdentifier">name</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot; on thread &quot;)" class="string">&quot; on thread &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <span title="object java.lang.Thread">Thread</span>.<span title="()java.lang.Thread">currentThread</span> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot; count &quot;)" class="string">&quot; count &quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <span class="delimiter">(</span><a href="#63425" title="Int">n</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span><span class="delimiter">)</span>
        <a href="#60309" title="(key: net.liftweb.db.ConnectionIdentifier, value: DB.this.ConnectionHolder)Unit">info</a><span class="delimiter">(</span><a href="#62071" title="net.liftweb.db.ConnectionIdentifier">name</a><span class="delimiter">)</span> = <a href="#61867" title="(conn: net.liftweb.db.SuperConnection, cnt: Int, postTransaction: List[Boolean =&gt; Unit])DB.this.ConnectionHolder">ConnectionHolder</a><span class="delimiter">(</span><a href="#63424" title="net.liftweb.db.SuperConnection">c</a>, <a href="#63425" title="Int">n</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span>, <a href="#63426" title="List[Boolean =&gt; Unit]">post</a><span class="delimiter">)</span>
      <span class="keyword">case</span> <a title="Unit" id="63447">x</a> =&gt;
        <span class="comment">// ignore</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   *  Append a function to be invoked after the transaction has ended for the given connection identifier
   */</span>
  @deprecated<span class="delimiter">(</span><span class="string">&quot;Use appendPostTransaction (name, {committed =&gt; ...})&quot;</span><span class="delimiter">)</span>
  <span class="keyword">def</span> <a title="(name: net.liftweb.db.ConnectionIdentifier, func: () =&gt; Unit)Unit" id="60326">appendPostFunc</a><span class="delimiter">(</span><a title="net.liftweb.db.ConnectionIdentifier" id="63448">name</a>: <a href="#10911" title="net.liftweb.db.ConnectionIdentifier">ConnectionIdentifier</a>, <a title="() =&gt; Unit" id="63449">func</a>: <span class="delimiter">(</span><span class="delimiter">)</span> =&gt; Unit<span class="delimiter">)</span> <span class="delimiter">{</span>
    <a href="#60327" title="(name: net.liftweb.db.ConnectionIdentifier, func: Boolean =&gt; Unit)Unit">appendPostTransaction</a><span class="delimiter">(</span><a href="#63448" title="net.liftweb.db.ConnectionIdentifier">name</a>, <a title="Boolean" id="63461">dontUse</a> =&gt; <a href="#63449" title="()Unit">func</a><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Append a function to be invoked after the transaction on the specified connection identifier has ended.
   * The value passed to the function indicates true for success/commit or false for failure/rollback.
   *
   * Note: the function will only be called when automatic transaction management is in effect, either by executing within
   * the context of a buildLoanWrapper or a DB.use {}
   */</span>
  <span class="keyword">def</span> <a title="(name: net.liftweb.db.ConnectionIdentifier, func: Boolean =&gt; Unit)Unit" id="60327">appendPostTransaction</a><span class="delimiter">(</span><a title="net.liftweb.db.ConnectionIdentifier" id="63457">name</a>: <a href="#10911" title="net.liftweb.db.ConnectionIdentifier">ConnectionIdentifier</a>, <a title="Boolean =&gt; Unit" id="63458">func</a>: Boolean =&gt; Unit<span class="delimiter">)</span> <span class="delimiter">{</span>
    <a href="#60309" title="=&gt; scala.collection.mutable.HashMap[net.liftweb.db.ConnectionIdentifier,DB.this.ConnectionHolder]">info</a>.<span title="(key: net.liftweb.db.ConnectionIdentifier)Option[DB.this.ConnectionHolder]">get</span><span class="delimiter">(</span><a href="#63457" title="net.liftweb.db.ConnectionIdentifier">name</a><span class="delimiter">)</span> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <span title="Unit">Some</span><span class="delimiter">(</span>ConnectionHolder<span class="delimiter">(</span><a title="net.liftweb.db.SuperConnection" id="63468">c</a>, <a title="Int" id="63469">n</a>, <a title="List[Boolean =&gt; Unit]" id="63470">post</a><span class="delimiter">)</span><span class="delimiter">)</span> =&gt;
        <a href="#60309" title="(key: net.liftweb.db.ConnectionIdentifier, value: DB.this.ConnectionHolder)Unit">info</a><span class="delimiter">(</span><a href="#63457" title="net.liftweb.db.ConnectionIdentifier">name</a><span class="delimiter">)</span> = <a href="#61867" title="(conn: net.liftweb.db.SuperConnection, cnt: Int, postTransaction: List[Boolean =&gt; Unit])DB.this.ConnectionHolder">ConnectionHolder</a><span class="delimiter">(</span><a href="#63468" title="net.liftweb.db.SuperConnection">c</a>, <a href="#63469" title="Int">n</a>, <a href="#63458" title="Boolean =&gt; Unit">func</a> <a href="#63478" title="(x: Boolean =&gt; Unit)List[Boolean =&gt; Unit]">::</a> <a href="#63470" title="List[Boolean =&gt; Unit]">post</a><span class="delimiter">)</span>
        <a href="../../../../common/net/liftweb/common/Logging.scala.html#19845" title="=&gt; net.liftweb.common.Logger">logger</a>.<a href="../../../../common/net/liftweb/common/Logging.scala.html#31936" title="(msg: =&gt; AnyRef)Unit">trace</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;Appended postTransaction function on %s, new count=%d&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#63457" title="net.liftweb.db.ConnectionIdentifier">name</a>, <a href="#63470" title="List[Boolean =&gt; Unit]">post</a>.<span title="=&gt; Int">size</span><span title="(x: Int)Int">+</span><span title="Int(1)" class="int">1</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="Nothing">_</span> =&gt; <span title="Nothing" class="keyword">throw</span> <span title="(x$1: java.lang.String)java.lang.IllegalStateException" class="keyword">new</span> <span title="java.lang.IllegalStateException">IllegalStateException</span><span class="delimiter">(</span><span title="java.lang.String(&quot;Tried to append postTransaction function on illegal ConnectionIdentifer or outside transaction context&quot;)" class="string">&quot;Tried to append postTransaction function on illegal ConnectionIdentifer or outside transaction context&quot;</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Append function to be invoked after the current transaction on DefaultConnectionIdentifier has ended
   *
   */</span>
  <span class="keyword">def</span> <a title="(func: Boolean =&gt; Unit)Unit" id="60328">appendPostTransaction</a><span class="delimiter">(</span><a title="Boolean =&gt; Unit" id="63455">func</a>: Boolean =&gt; Unit<span class="delimiter">)</span>:<span title="Unit">Unit</span> = <a href="#60327" title="(name: net.liftweb.db.ConnectionIdentifier, func: Boolean =&gt; Unit)Unit">appendPostTransaction</a><span class="delimiter">(</span><a href="#66906" title="object net.liftweb.db.DefaultConnectionIdentifier">DefaultConnectionIdentifier</a>, <a href="#63455" title="Boolean =&gt; Unit">func</a><span class="delimiter">)</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(logged: java.sql.Statement, time: Long)Unit" id="60329">runLogger</a><span class="delimiter">(</span><a title="java.sql.Statement" id="63513">logged</a>: <span title="java.sql.Statement">Statement</span>, <a title="Long" id="63514">time</a>: <span title="Long">Long</span><span class="delimiter">)</span> = <a href="#63513" title="java.sql.Statement">logged</a> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <a title="Unit" id="63589">st</a>: <a href="LoggingStatementWrappers.scala.html#10966" title="net.liftweb.db.DBLog">DBLog</a> =&gt; <a href="#60289" title="=&gt; List[(net.liftweb.db.DBLog, Long) =&gt; Any]">logFuncs</a>.<span title="(f: (net.liftweb.db.DBLog, Long) =&gt; Any =&gt; Any)Unit">foreach</span><span class="delimiter">(</span><a href="#63612" title="(v1: net.liftweb.db.DBLog, v2: Long)Any">_</a><span class="delimiter">(</span><a href="#63589" title="&lt;none&gt; extends java.sql.Statement with net.liftweb.db.DBLog">st</a>, <a href="#63514" title="Long">time</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="keyword">case</span> <span title="Unit">_</span> =&gt; <span class="comment">// NOP</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="[T](db: net.liftweb.db.SuperConnection)(f: java.sql.Statement =&gt; T)T" id="60330">statement</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="60332">T</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="net.liftweb.db.SuperConnection" id="63616">db</a>: <a href="#10908" title="net.liftweb.db.SuperConnection">SuperConnection</a><span class="delimiter">)</span><span class="delimiter">(</span><a title="java.sql.Statement =&gt; T" id="63617">f</a>: <span class="delimiter">(</span>Statement<span class="delimiter">)</span> =&gt; T<span class="delimiter">)</span>: <a href="#60332" title="T">T</a> = <span class="delimiter">{</span>
    <a href="../../../../util/net/liftweb/util/Helpers.scala.html#13346" title="object net.liftweb.util.Helpers">Helpers</a>.<a href="../../../../util/net/liftweb/util/TimeHelpers.scala.html#48811" title="(f: =&gt; (java.sql.Statement, T))(Long, (java.sql.Statement, T))">calcTime</a> <span class="delimiter">{</span>
      <span class="keyword">val</span> <a title="java.sql.Statement" id="63625">st</a> =
      <span title="java.sql.Statement" class="keyword">if</span> <span class="delimiter">(</span><a href="#60292" title="=&gt; Boolean">loggingEnabled_?</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a href="LoggingStatementWrappers.scala.html#10967" title="object net.liftweb.db.DBLog">DBLog</a>.<a href="LoggingStatementWrappers.scala.html#63627" title="(conn: java.sql.Connection)java.sql.Statement">createStatement</a><span class="delimiter">(</span><a href="#63616" title="net.liftweb.db.SuperConnection">db</a>.<a href="#62095" title="=&gt; java.sql.Connection">connection</a><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
        <a href="#62644" title="implicit net.liftweb.db.SuperConnection.superToConn : (in: net.liftweb.db.SuperConnection)java.sql.Connection">db</a>.<span title="()java.sql.Statement">createStatement</span>
      <span class="delimiter">}</span>

      <a href="#60285" title="=&gt; net.liftweb.common.Box[Int]">queryTimeout</a>.<a href="../../../../common/net/liftweb/common/Box.scala.html#27031" title="(f: Int =&gt; Unit)Unit">foreach</a><span class="delimiter">(</span><a title="Int" id="63773">to</a> =&gt; <a href="#63625" title="java.sql.Statement">st</a>.<span title="(x$1: Int)Unit">setQueryTimeout</span><span class="delimiter">(</span><a href="#63773" title="Int">to</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">try</span> <span class="delimiter">{</span>
        <span title="(_1: java.sql.Statement, _2: T)(java.sql.Statement, T)" class="delimiter">(</span><a href="#63625" title="java.sql.Statement">st</a>, <a href="#63617" title="(v1: java.sql.Statement)T">f</a><span class="delimiter">(</span><a href="#63625" title="java.sql.Statement">st</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">finally</span> <span class="delimiter">{</span>
        <a href="#63625" title="java.sql.Statement">st</a>.<span title="()Unit">close</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span> <span title="T" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <span title="T" class="delimiter">(</span><a title="Long" id="63785">time</a>, <span class="delimiter">(</span><a title="java.sql.Statement" id="63788">query</a>, <a title="T" id="63789">res</a><span class="delimiter">)</span><span class="delimiter">)</span> =&gt; <a href="#60329" title="(logged: java.sql.Statement, time: Long)Unit">runLogger</a><span class="delimiter">(</span><a href="#63788" title="java.sql.Statement">query</a>, <a href="#63785" title="Long">time</a><span class="delimiter">)</span>; <a href="#63789" title="T">res</a>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="[T](db: net.liftweb.db.SuperConnection, query: String)(f: java.sql.ResultSet =&gt; T)T" id="60333">exec</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="60335">T</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="net.liftweb.db.SuperConnection" id="63790">db</a>: <a href="#10908" title="net.liftweb.db.SuperConnection">SuperConnection</a>, <a title="String" id="63791">query</a>: <span title="String">String</span><span class="delimiter">)</span><span class="delimiter">(</span><a title="java.sql.ResultSet =&gt; T" id="63792">f</a>: <span class="delimiter">(</span>ResultSet<span class="delimiter">)</span> =&gt; T<span class="delimiter">)</span>: <a href="#60335" title="T">T</a> =
  <a href="#60330" title="(db: net.liftweb.db.SuperConnection)(f: java.sql.Statement =&gt; T)T">statement</a><span class="delimiter">(</span><a href="#63790" title="net.liftweb.db.SuperConnection">db</a><span class="delimiter">)</span> <span class="delimiter">{</span>
    <a title="java.sql.Statement" id="64272">st</a> =&gt;
    <a href="#63792" title="(v1: java.sql.ResultSet)T">f</a><span class="delimiter">(</span><a href="#64272" title="java.sql.Statement">st</a>.<span title="(x$1: java.lang.String)java.sql.ResultSet">executeQuery</span><span class="delimiter">(</span><a href="#63791" title="String">query</a><span class="delimiter">)</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(pos: Int, rs: java.sql.ResultSet, md: java.sql.ResultSetMetaData)String" id="60336">asString</a><span class="delimiter">(</span><a title="Int" id="64276">pos</a>: <span title="Int">Int</span>, <a title="java.sql.ResultSet" id="64277">rs</a>: <span title="java.sql.ResultSet">ResultSet</span>, <a title="java.sql.ResultSetMetaData" id="64278">md</a>: <span title="java.sql.ResultSetMetaData">ResultSetMetaData</span><span class="delimiter">)</span>: <span title="String">String</span> = <span class="delimiter">{</span>
    <span class="keyword">import</span> java.sql.<span title="object java.sql.Types">Types</span>._
    <a href="#64278" title="java.sql.ResultSetMetaData">md</a>.<span title="(x$1: Int)Int">getColumnType</span><span class="delimiter">(</span><a href="#64276" title="Int">pos</a><span class="delimiter">)</span> <span title="String" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <span title="String">ARRAY</span> | <span title="Int(-2)">BINARY</span> | <span title="Int(2004)">BLOB</span> | <span title="Int(70)">DATALINK</span> | <span title="Int(2001)">DISTINCT</span> | <span title="Int(2000)">JAVA_OBJECT</span> | <span title="Int(-4)">LONGVARBINARY</span> | <span title="Int(0)">NULL</span> | <span title="Int(1111)">OTHER</span> | <span title="Int(2006)">REF</span> | <span title="Int(2002)">STRUCT</span> | <span title="Int(-3)">VARBINARY</span> =&gt; <a href="#64277" title="java.sql.ResultSet">rs</a>.<span title="(x$1: Int)java.lang.Object">getObject</span><span class="delimiter">(</span><a href="#64276" title="Int">pos</a><span class="delimiter">)</span> <span title="String" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <span title="Null(null)" class="keyword">null</span> =&gt; <span title="Null(null)" class="keyword">null</span>
        <span class="keyword">case</span> <a title="java.lang.String" id="64365">s</a> =&gt; <a href="#64365" title="java.lang.Object">s</a>.<span title="()java.lang.String">toString</span>
      <span class="delimiter">}</span>

      <span class="keyword">case</span> <span title="String">DECIMAL</span> | <span title="Int(2)">NUMERIC</span> =&gt;
        <a href="#64277" title="java.sql.ResultSet">rs</a>.<span title="(x$1: Int)java.math.BigDecimal">getBigDecimal</span><span class="delimiter">(</span><a href="#64276" title="Int">pos</a><span class="delimiter">)</span> <span title="String" class="keyword">match</span> <span class="delimiter">{</span>
          <span class="keyword">case</span> <span title="Null(null)" class="keyword">null</span> =&gt; <span title="Null(null)" class="keyword">null</span>
          <span class="keyword">case</span> <a title="java.lang.String" id="64370">x</a> =&gt; <a href="#64370" title="java.math.BigDecimal">x</a>.<span title="()java.lang.String">toString</span>
        <span class="delimiter">}</span>

      <span class="keyword">case</span> <span title="java.lang.String">BIGINT</span> | <span title="Int(4)">INTEGER</span> | <span class="comment">/* DECIMAL | NUMERIC | */</span> <span title="Int(5)">SMALLINT</span> | <span title="Int(-6)">TINYINT</span> =&gt; <a href="#64277" title="java.sql.ResultSet">rs</a>.<span title="(x$1: Int)Long">getLong</span><span class="delimiter">(</span><a href="#64276" title="Int">pos</a><span class="delimiter">)</span>.<span title="()java.lang.String">toString</span>

      <span class="keyword">case</span> <span title="java.lang.String">BIT</span> | <span title="Int(16)">BOOLEAN</span> =&gt; <a href="#64277" title="java.sql.ResultSet">rs</a>.<span title="(x$1: Int)Boolean">getBoolean</span><span class="delimiter">(</span><a href="#64276" title="Int">pos</a><span class="delimiter">)</span>.<span title="()java.lang.String">toString</span>

      <span class="keyword">case</span> <span title="java.lang.String">VARCHAR</span> | <span title="Int(1)">CHAR</span> | <span title="Int(2005)">CLOB</span> | <span title="Int(-1)">LONGVARCHAR</span> =&gt; <a href="#64277" title="java.sql.ResultSet">rs</a>.<span title="(x$1: Int)java.lang.String">getString</span><span class="delimiter">(</span><a href="#64276" title="Int">pos</a><span class="delimiter">)</span>

      <span class="keyword">case</span> <span title="String">DATE</span> | <span title="Int(92)">TIME</span> | <span title="Int(93)">TIMESTAMP</span> =&gt; <a href="#64277" title="java.sql.ResultSet">rs</a>.<span title="(x$1: Int)java.sql.Timestamp">getTimestamp</span><span class="delimiter">(</span><a href="#64276" title="Int">pos</a><span class="delimiter">)</span> <span title="String" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <span title="Null(null)" class="keyword">null</span> =&gt; <span title="Null(null)" class="keyword">null</span>
        <span class="keyword">case</span> <a title="java.lang.String" id="64421">x</a> =&gt; <a href="#64421" title="java.sql.Timestamp">x</a>.<span title="()java.lang.String">toString</span>
      <span class="delimiter">}</span>

      <span class="keyword">case</span> <span title="java.lang.String">DOUBLE</span> | <span title="Int(6)">FLOAT</span> | <span title="Int(7)">REAL</span> =&gt; <a href="#64277" title="java.sql.ResultSet">rs</a>.<span title="(x$1: Int)Double">getDouble</span><span class="delimiter">(</span><a href="#64276" title="Int">pos</a><span class="delimiter">)</span>.<span title="()java.lang.String">toString</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(pos: Int, rs: java.sql.ResultSet, md: java.sql.ResultSetMetaData)Any" id="60337">asAny</a><span class="delimiter">(</span><a title="Int" id="64426">pos</a>: <span title="Int">Int</span>, <a title="java.sql.ResultSet" id="64427">rs</a>: <span title="java.sql.ResultSet">ResultSet</span>, <a title="java.sql.ResultSetMetaData" id="64428">md</a>: <span title="java.sql.ResultSetMetaData">ResultSetMetaData</span><span class="delimiter">)</span>: <span title="Any">Any</span> = <span class="delimiter">{</span>
    <span class="keyword">import</span> java.sql.<span title="object java.sql.Types">Types</span>._
    <a href="#64428" title="java.sql.ResultSetMetaData">md</a>.<span title="(x$1: Int)Int">getColumnType</span><span class="delimiter">(</span><a href="#64426" title="Int">pos</a><span class="delimiter">)</span> <span title="Any" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <span title="java.lang.Object">ARRAY</span> | <span title="Int(-2)">BINARY</span> | <span title="Int(2004)">BLOB</span> | <span title="Int(70)">DATALINK</span> | <span title="Int(2001)">DISTINCT</span> | <span title="Int(2000)">JAVA_OBJECT</span> | <span title="Int(-4)">LONGVARBINARY</span> | <span title="Int(0)">NULL</span> | <span title="Int(1111)">OTHER</span> | <span title="Int(2006)">REF</span> | <span title="Int(2002)">STRUCT</span> | <span title="Int(-3)">VARBINARY</span> =&gt; <a href="#64427" title="java.sql.ResultSet">rs</a>.<span title="(x$1: Int)java.lang.Object">getObject</span><span class="delimiter">(</span><a href="#64426" title="Int">pos</a><span class="delimiter">)</span>

      <span class="keyword">case</span> <span title="java.math.BigDecimal">DECIMAL</span> | <span title="Int(2)">NUMERIC</span> =&gt; <a href="#64427" title="java.sql.ResultSet">rs</a>.<span title="(x$1: Int)java.math.BigDecimal">getBigDecimal</span><span class="delimiter">(</span><a href="#64426" title="Int">pos</a><span class="delimiter">)</span>

      <span class="keyword">case</span> <span title="Long">BIGINT</span> | <span title="Int(4)">INTEGER</span> | <span class="comment">/* DECIMAL | NUMERIC | */</span> <span title="Int(5)">SMALLINT</span> | <span title="Int(-6)">TINYINT</span> =&gt; <a href="#64427" title="java.sql.ResultSet">rs</a>.<span title="(x$1: Int)Long">getLong</span><span class="delimiter">(</span><a href="#64426" title="Int">pos</a><span class="delimiter">)</span>

      <span class="keyword">case</span> <span title="Boolean">BIT</span> | <span title="Int(16)">BOOLEAN</span> =&gt; <a href="#64427" title="java.sql.ResultSet">rs</a>.<span title="(x$1: Int)Boolean">getBoolean</span><span class="delimiter">(</span><a href="#64426" title="Int">pos</a><span class="delimiter">)</span>

      <span class="keyword">case</span> <span title="java.lang.String">VARCHAR</span> | <span title="Int(1)">CHAR</span> | <span title="Int(2005)">CLOB</span> | <span title="Int(-1)">LONGVARCHAR</span> =&gt; <a href="#64427" title="java.sql.ResultSet">rs</a>.<span title="(x$1: Int)java.lang.String">getString</span><span class="delimiter">(</span><a href="#64426" title="Int">pos</a><span class="delimiter">)</span>

      <span class="keyword">case</span> <span title="java.sql.Timestamp">DATE</span> | <span title="Int(92)">TIME</span> | <span title="Int(93)">TIMESTAMP</span> =&gt; <a href="#64427" title="java.sql.ResultSet">rs</a>.<span title="(x$1: Int)java.sql.Timestamp">getTimestamp</span><span class="delimiter">(</span><a href="#64426" title="Int">pos</a><span class="delimiter">)</span>

      <span class="keyword">case</span> <span title="Double">DOUBLE</span> | <span title="Int(6)">FLOAT</span> | <span title="Int(7)">REAL</span> =&gt; <a href="#64427" title="java.sql.ResultSet">rs</a>.<span title="(x$1: Int)Double">getDouble</span><span class="delimiter">(</span><a href="#64426" title="Int">pos</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(rs: java.sql.ResultSet)(List[String], List[List[String]])" id="60338">resultSetTo</a><span class="delimiter">(</span><a title="java.sql.ResultSet" id="64459">rs</a>: <span title="java.sql.ResultSet">ResultSet</span><span class="delimiter">)</span>: <span title="(List[String], List[List[String]])" class="delimiter">(</span>List<span class="delimiter">[</span>String<span class="delimiter">]</span>, List<span class="delimiter">[</span>List<span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="java.sql.ResultSetMetaData" id="64461">md</a> = <a href="#64459" title="java.sql.ResultSet">rs</a>.<span title="()java.sql.ResultSetMetaData">getMetaData</span>
    <span class="keyword">val</span> <a title="Int" id="64462">cnt</a> = <a href="#64461" title="java.sql.ResultSetMetaData">md</a>.<span title="()Int">getColumnCount</span>
    <span class="keyword">val</span> <a title="List[Int]" id="64463">cntList</a> = <span class="delimiter">(</span><span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">1</span> <span title="(end: Int)scala.collection.immutable.Range.Inclusive">to</span> <a href="#64462" title="Int">cnt</a><span class="delimiter">)</span>.<span title="=&gt; List[Int]">toList</span>
    <span class="keyword">val</span> <a title="List[java.lang.String]" id="64464">colNames</a> = <a href="#64463" title="List[Int]">cntList</a>.<span title="(f: Int =&gt; java.lang.String)(implicit bf: scala.collection.generic.CanBuildFrom[List[Int],java.lang.String,List[java.lang.String]])List[java.lang.String]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.List.Coll,java.lang.String,List[java.lang.String]]" class="delimiter">(</span><a title="Int" id="64982">i</a> =&gt; <a href="#64461" title="java.sql.ResultSetMetaData">md</a>.<span title="(x$1: Int)java.lang.String">getColumnName</span><span class="delimiter">(</span><a href="#64982" title="Int">i</a><span class="delimiter">)</span><span class="delimiter">)</span>

    <span class="keyword">val</span> <a title="scala.collection.mutable.ListBuffer[List[String]]" id="64465">lb</a> = <span title="scala.collection.mutable.ListBuffer[List[String]]" class="keyword">new</span> <span title="scala.collection.mutable.ListBuffer[List[String]]">ListBuffer</span><span class="delimiter">[</span>List<span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>

    <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><a href="#64459" title="java.sql.ResultSet">rs</a>.<span title="()Boolean">next</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#64465" title="scala.collection.mutable.ListBuffer[List[String]]">lb</a> <a href="#64466" title="(x: List[String])lb.type">+=</a> <a href="#64463" title="List[Int]">cntList</a>.<span title="(f: Int =&gt; String)(implicit bf: scala.collection.generic.CanBuildFrom[List[Int],String,List[String]])List[String]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.List.Coll,String,List[String]]" class="delimiter">(</span><a title="Int" id="65040">i</a> =&gt; <a href="#60336" title="(pos: Int, rs: java.sql.ResultSet, md: java.sql.ResultSetMetaData)String">asString</a><span class="delimiter">(</span><a href="#65040" title="Int">i</a>, <a href="#64459" title="java.sql.ResultSet">rs</a>, <a href="#64461" title="java.sql.ResultSetMetaData">md</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span title="(_1: List[java.lang.String], _2: List[List[String]])(List[java.lang.String], List[List[String]])" class="delimiter">(</span><a href="#64464" title="List[java.lang.String]">colNames</a>, <a href="#64465" title="scala.collection.mutable.ListBuffer[List[String]]">lb</a>.<span title="=&gt; List[List[String]]">toList</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(rs: java.sql.ResultSet)(List[String], List[List[Any]])" id="60339">resultSetToAny</a><span class="delimiter">(</span><a title="java.sql.ResultSet" id="65089">rs</a>: <span title="java.sql.ResultSet">ResultSet</span><span class="delimiter">)</span>: <span title="(List[String], List[List[Any]])" class="delimiter">(</span>List<span class="delimiter">[</span>String<span class="delimiter">]</span>, List<span class="delimiter">[</span>List<span class="delimiter">[</span>Any<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="java.sql.ResultSetMetaData" id="65091">md</a> = <a href="#65089" title="java.sql.ResultSet">rs</a>.<span title="()java.sql.ResultSetMetaData">getMetaData</span>
    <span class="keyword">val</span> <a title="Int" id="65092">cnt</a> = <a href="#65091" title="java.sql.ResultSetMetaData">md</a>.<span title="()Int">getColumnCount</span>
    <span class="keyword">val</span> <a title="List[Int]" id="65093">cntList</a> = <span class="delimiter">(</span><span title="implicit scala.LowPriorityImplicits.intWrapper : (x: Int)scala.runtime.RichInt" class="int">1</span> <span title="(end: Int)scala.collection.immutable.Range.Inclusive">to</span> <a href="#65092" title="Int">cnt</a><span class="delimiter">)</span>.<span title="=&gt; List[Int]">toList</span>
    <span class="keyword">val</span> <a title="List[java.lang.String]" id="65094">colNames</a> = <a href="#65093" title="List[Int]">cntList</a>.<span title="(f: Int =&gt; java.lang.String)(implicit bf: scala.collection.generic.CanBuildFrom[List[Int],java.lang.String,List[java.lang.String]])List[java.lang.String]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.List.Coll,java.lang.String,List[java.lang.String]]" class="delimiter">(</span><a title="Int" id="65194">i</a> =&gt; <a href="#65091" title="java.sql.ResultSetMetaData">md</a>.<span title="(x$1: Int)java.lang.String">getColumnName</span><span class="delimiter">(</span><a href="#65194" title="Int">i</a><span class="delimiter">)</span><span class="delimiter">)</span>

    <span class="keyword">val</span> <a title="scala.collection.mutable.ListBuffer[List[Any]]" id="65095">lb</a> = <span title="scala.collection.mutable.ListBuffer[List[Any]]" class="keyword">new</span> <span title="scala.collection.mutable.ListBuffer[List[Any]]">ListBuffer</span><span class="delimiter">[</span>List<span class="delimiter">[</span>Any<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">(</span><span class="delimiter">)</span>

    <span title="Unit" class="keyword">while</span> <span class="delimiter">(</span><a href="#65089" title="java.sql.ResultSet">rs</a>.<span title="()Boolean">next</span><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="#65095" title="scala.collection.mutable.ListBuffer[List[Any]]">lb</a> <a href="#65096" title="(x: List[Any])lb.type">+=</a> <a href="#65093" title="List[Int]">cntList</a>.<span title="(f: Int =&gt; Any)(implicit bf: scala.collection.generic.CanBuildFrom[List[Int],Any,List[Any]])List[Any]">map</span><span title="scala.collection.generic.CanBuildFrom[scala.collection.immutable.List.Coll,Any,List[Any]]" class="delimiter">(</span><a title="Int" id="65252">i</a> =&gt; <a href="#60337" title="(pos: Int, rs: java.sql.ResultSet, md: java.sql.ResultSetMetaData)Any">asAny</a><span class="delimiter">(</span><a href="#65252" title="Int">i</a>, <a href="#65089" title="java.sql.ResultSet">rs</a>, <a href="#65091" title="java.sql.ResultSetMetaData">md</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span title="(_1: List[java.lang.String], _2: List[List[Any]])(List[java.lang.String], List[List[Any]])" class="delimiter">(</span><a href="#65094" title="List[java.lang.String]">colNames</a>, <a href="#65095" title="scala.collection.mutable.ListBuffer[List[Any]]">lb</a>.<span title="=&gt; List[List[Any]]">toList</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/*
   * This method handles the common task of setting arguments on a prepared
   * statement based on argument type. Returns the properly updated PreparedStatement.
   */</span>
  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(ps: java.sql.PreparedStatement, params: List[Any])java.sql.PreparedStatement" id="60340">setPreparedParams</a><span class="delimiter">(</span><a title="java.sql.PreparedStatement" id="65299">ps</a> : <span title="java.sql.PreparedStatement">PreparedStatement</span>, <a title="List[Any]" id="65300">params</a>: <span title="List[Any]">List</span><span class="delimiter">[</span>Any<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="java.sql.PreparedStatement">PreparedStatement</span> = <span class="delimiter">{</span>
    <a href="#65300" title="List[Any]">params</a>.<span title="(implicit bf: scala.collection.generic.CanBuildFrom[List[Any],(Any, Int),List[(Any, Int)]])List[(Any, Int)]">zipWithIndex</span>.<span title="(f: (Any, Int) =&gt; Unit)Unit">foreach</span> <a href="#65532" title="Unit" class="delimiter">{</a>
      <span class="keyword">case</span> <span title="Unit" class="delimiter">(</span><span title="Null(null)" class="keyword">null</span>, <a title="Int" id="65535">idx</a><span class="delimiter">)</span> =&gt; <a href="#65299" title="java.sql.PreparedStatement">ps</a>.<span title="(x$1: Int, x$2: Int)Unit">setNull</span><span class="delimiter">(</span><a href="#65535" title="Int">idx</a> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span>, Types.<span title="Int(12)">VARCHAR</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="Unit" class="delimiter">(</span><a title="Int" id="65544">i</a>: <span title="Int">Int</span>, <a title="Int" id="65545">idx</a><span class="delimiter">)</span> =&gt; <a href="#65299" title="java.sql.PreparedStatement">ps</a>.<span title="(x$1: Int, x$2: Int)Unit">setInt</span><span class="delimiter">(</span><a href="#65545" title="Int">idx</a> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span>, <a href="#65544" title="Int">i</a><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="Unit" class="delimiter">(</span><a title="Long" id="65552">l</a>: <span title="Long">Long</span>, <a title="Int" id="65553">idx</a><span class="delimiter">)</span> =&gt; <a href="#65299" title="java.sql.PreparedStatement">ps</a>.<span title="(x$1: Int, x$2: Long)Unit">setLong</span><span class="delimiter">(</span><a href="#65553" title="Int">idx</a> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span>, <a href="#65552" title="Long">l</a><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="Unit" class="delimiter">(</span><a title="Double" id="65560">d</a>: <span title="Double">Double</span>, <a title="Int" id="65561">idx</a><span class="delimiter">)</span> =&gt; <a href="#65299" title="java.sql.PreparedStatement">ps</a>.<span title="(x$1: Int, x$2: Double)Unit">setDouble</span><span class="delimiter">(</span><a href="#65561" title="Int">idx</a> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span>, <a href="#65560" title="Double">d</a><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="Unit" class="delimiter">(</span><a title="Float" id="65568">f</a>: <span title="Float">Float</span>, <a title="Int" id="65569">idx</a><span class="delimiter">)</span> =&gt; <a href="#65299" title="java.sql.PreparedStatement">ps</a>.<span title="(x$1: Int, x$2: Float)Unit">setFloat</span><span class="delimiter">(</span><a href="#65569" title="Int">idx</a> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span>, <a href="#65568" title="Float">f</a><span class="delimiter">)</span>
      <span class="comment">// Allow the user to specify how they want the Date handled based on the input type</span>
      <span class="keyword">case</span> <span title="Unit" class="delimiter">(</span><a title="java.sql.Timestamp" id="65576">t</a>: java.sql.<span title="java.sql.Timestamp">Timestamp</span>, <a title="Int" id="65577">idx</a><span class="delimiter">)</span> =&gt; <a href="#65299" title="java.sql.PreparedStatement">ps</a>.<span title="(x$1: Int, x$2: java.sql.Timestamp)Unit">setTimestamp</span><span class="delimiter">(</span><a href="#65577" title="Int">idx</a> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span>, <a href="#65576" title="java.sql.Timestamp">t</a><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="Unit" class="delimiter">(</span><a title="java.sql.Date" id="65586">d</a>: java.sql.<span title="java.sql.Date">Date</span>, <a title="Int" id="65608">idx</a><span class="delimiter">)</span> =&gt; <a href="#65299" title="java.sql.PreparedStatement">ps</a>.<span title="(x$1: Int, x$2: java.sql.Date)Unit">setDate</span><span class="delimiter">(</span><a href="#65608" title="Int">idx</a> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span>, <a href="#65586" title="java.sql.Date">d</a><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="Unit" class="delimiter">(</span><a title="java.sql.Time" id="65617">t</a>: java.sql.<span title="java.sql.Time">Time</span>, <a title="Int" id="65640">idx</a><span class="delimiter">)</span> =&gt; <a href="#65299" title="java.sql.PreparedStatement">ps</a>.<span title="(x$1: Int, x$2: java.sql.Time)Unit">setTime</span><span class="delimiter">(</span><a href="#65640" title="Int">idx</a> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span>, <a href="#65617" title="java.sql.Time">t</a><span class="delimiter">)</span>
      <span class="comment">/* java.util.Date has to go last, since the java.sql date/time classes subclass it. By default we
       * assume a Timestamp value */</span>
      <span class="keyword">case</span> <span title="Unit" class="delimiter">(</span><a title="java.util.Date" id="65649">d</a>: java.util.<span title="java.util.Date">Date</span>, <a title="Int" id="65650">idx</a><span class="delimiter">)</span> =&gt; <a href="#65299" title="java.sql.PreparedStatement">ps</a>.<span title="(x$1: Int, x$2: java.sql.Timestamp)Unit">setTimestamp</span><span class="delimiter">(</span><a href="#65650" title="Int">idx</a> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span>, <span title="(x$1: Long)java.sql.Timestamp" class="keyword">new</span> java.sql.<span title="java.sql.Timestamp">Timestamp</span><span class="delimiter">(</span><a href="#65649" title="java.util.Date">d</a>.<span title="()Long">getTime</span><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="Unit" class="delimiter">(</span><a title="Boolean" id="65661">b</a>: <span title="Boolean">Boolean</span>, <a title="Int" id="65662">idx</a><span class="delimiter">)</span> =&gt; <a href="#65299" title="java.sql.PreparedStatement">ps</a>.<span title="(x$1: Int, x$2: Boolean)Unit">setBoolean</span><span class="delimiter">(</span><a href="#65662" title="Int">idx</a> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span>, <a href="#65661" title="Boolean">b</a><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="Unit" class="delimiter">(</span><a title="String" id="65669">s</a>: <span title="String">String</span>, <a title="Int" id="65670">idx</a><span class="delimiter">)</span> =&gt; <a href="#65299" title="java.sql.PreparedStatement">ps</a>.<span title="(x$1: Int, x$2: java.lang.String)Unit">setString</span><span class="delimiter">(</span><a href="#65670" title="Int">idx</a> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span>, <a href="#65669" title="String">s</a><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="Unit" class="delimiter">(</span><a title="java.math.BigDecimal" id="65677">bn</a>: java.math.<span title="java.math.BigDecimal">BigDecimal</span>, <a title="Int" id="65678">idx</a><span class="delimiter">)</span> =&gt; <a href="#65299" title="java.sql.PreparedStatement">ps</a>.<span title="(x$1: Int, x$2: java.math.BigDecimal)Unit">setBigDecimal</span><span class="delimiter">(</span><a href="#65678" title="Int">idx</a> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span>, <a href="#65677" title="java.math.BigDecimal">bn</a><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="Unit" class="delimiter">(</span><a title="Any" id="65685">obj</a>, <a title="Int" id="65686">idx</a><span class="delimiter">)</span> =&gt; <a href="#65299" title="java.sql.PreparedStatement">ps</a>.<span title="(x$1: Int, x$2: Any)Unit">setObject</span><span class="delimiter">(</span><a href="#65686" title="Int">idx</a> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span>, <a href="#65685" title="Any">obj</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
    <a href="#65299" title="java.sql.PreparedStatement">ps</a>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Executes the given parameterized query string with the given parameters.
   * Parameters are substituted in order. For Date/Time types, passing a java.util.Date will result in a
   * Timestamp parameter. If you want a specific SQL Date/Time type, use the corresponding
   * java.sql.Date, java.sql.Time, or java.sql.Timestamp classes.
   */</span>
  <span class="keyword">def</span> <a title="(query: String, params: List[Any])(List[String], List[List[String]])" id="60341">runQuery</a><span class="delimiter">(</span><a title="String" id="65694">query</a>: <span title="String">String</span>, <a title="List[Any]" id="65695">params</a>: <span title="List[Any]">List</span><span class="delimiter">[</span>Any<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="(List[String], List[List[String]])" class="delimiter">(</span>List<span class="delimiter">[</span>String<span class="delimiter">]</span>, List<span class="delimiter">[</span>List<span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span> =
  <a href="#60342" title="(query: String, params: List[Any], connectionIdentifier: net.liftweb.db.ConnectionIdentifier)(List[String], List[List[String]])">runQuery</a><span class="delimiter">(</span><a href="#65694" title="String">query</a>, <a href="#65695" title="List[Any]">params</a>, <a href="#66906" title="object net.liftweb.db.DefaultConnectionIdentifier">DefaultConnectionIdentifier</a><span class="delimiter">)</span>

  <span class="comment">/**
   * Executes the given parameterized query string with the given parameters.
   * Parameters are substituted in order. For Date/Time types, passing a java.util.Date will result in a
   * Timestamp parameter. If you want a specific SQL Date/Time type, use the corresponding
   * java.sql.Date, java.sql.Time, or java.sql.Timestamp classes.
   */</span>
  <span class="keyword">def</span> <a title="(query: String, params: List[Any], connectionIdentifier: net.liftweb.db.ConnectionIdentifier)(List[String], List[List[String]])" id="60342">runQuery</a><span class="delimiter">(</span><a title="String" id="65703">query</a>: <span title="String">String</span>, <a title="List[Any]" id="65704">params</a>: <span title="List[Any]">List</span><span class="delimiter">[</span>Any<span class="delimiter">]</span>, <a title="net.liftweb.db.ConnectionIdentifier" id="65705">connectionIdentifier</a>: <a href="#10911" title="net.liftweb.db.ConnectionIdentifier">ConnectionIdentifier</a><span class="delimiter">)</span>: <span title="(List[String], List[List[String]])" class="delimiter">(</span>List<span class="delimiter">[</span>String<span class="delimiter">]</span>, List<span class="delimiter">[</span>List<span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <a href="#60371" title="(name: net.liftweb.db.ConnectionIdentifier)(f: net.liftweb.db.SuperConnection =&gt; (List[String], List[List[String]]))(List[String], List[List[String]])">use</a><span class="delimiter">(</span><a href="#65705" title="net.liftweb.db.ConnectionIdentifier">connectionIdentifier</a><span class="delimiter">)</span><span class="delimiter">(</span><a title="net.liftweb.db.SuperConnection" id="65712">conn</a> =&gt; <a href="#60353" title="(statement: String, conn: net.liftweb.db.SuperConnection)(f: java.sql.PreparedStatement =&gt; (List[String], List[List[String]]))(List[String], List[List[String]])">prepareStatement</a><span class="delimiter">(</span><a href="#65703" title="String">query</a>, <a href="#65712" title="net.liftweb.db.SuperConnection">conn</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a title="java.sql.PreparedStatement" id="65755">ps</a> =&gt; <a href="#60338" title="(rs: java.sql.ResultSet)(List[String], List[List[String]])">resultSetTo</a><span class="delimiter">(</span><a href="#60340" title="(ps: java.sql.PreparedStatement, params: List[Any])java.sql.PreparedStatement">setPreparedParams</a><span class="delimiter">(</span><a href="#65755" title="java.sql.PreparedStatement">ps</a>, <a href="#65704" title="List[Any]">params</a><span class="delimiter">)</span>.<span title="()java.sql.ResultSet">executeQuery</span><span class="delimiter">)</span>
      <span class="delimiter">}</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Executes the given parameterized query string with the given parameters.
   * Parameters are substituted in order. For Date/Time types, passing a java.util.Date will result in a
   * Timestamp parameter. If you want a specific SQL Date/Time type, use the corresponding
   * java.sql.Date, java.sql.Time, or java.sql.Timestamp classes.
   */</span>
  <span class="keyword">def</span> <a title="(query: String, params: List[Any])(List[String], List[List[Any]])" id="60343">performQuery</a><span class="delimiter">(</span><a title="String" id="65763">query</a>: <span title="String">String</span>, <a title="List[Any]" id="65764">params</a>: <span title="List[Any]">List</span><span class="delimiter">[</span>Any<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="(List[String], List[List[Any]])" class="delimiter">(</span>List<span class="delimiter">[</span>String<span class="delimiter">]</span>, List<span class="delimiter">[</span>List<span class="delimiter">[</span>Any<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span> =
  <a href="#60344" title="(query: String, params: List[Any], connectionIdentifier: net.liftweb.db.ConnectionIdentifier)(List[String], List[List[Any]])">performQuery</a><span class="delimiter">(</span><a href="#65763" title="String">query</a>, <a href="#65764" title="List[Any]">params</a>, <a href="#66906" title="object net.liftweb.db.DefaultConnectionIdentifier">DefaultConnectionIdentifier</a><span class="delimiter">)</span>

  <span class="comment">/**
   * Executes the given parameterized query string with the given parameters.
   * Parameters are substituted in order. For Date/Time types, passing a java.util.Date will result in a
   * Timestamp parameter. If you want a specific SQL Date/Time type, use the corresponding
   * java.sql.Date, java.sql.Time, or java.sql.Timestamp classes.
   */</span>
  <span class="keyword">def</span> <a title="(query: String, params: List[Any], connectionIdentifier: net.liftweb.db.ConnectionIdentifier)(List[String], List[List[Any]])" id="60344">performQuery</a><span class="delimiter">(</span><a title="String" id="65772">query</a>: <span title="String">String</span>, <a title="List[Any]" id="65773">params</a>: <span title="List[Any]">List</span><span class="delimiter">[</span>Any<span class="delimiter">]</span>, <a title="net.liftweb.db.ConnectionIdentifier" id="65774">connectionIdentifier</a>: <a href="#10911" title="net.liftweb.db.ConnectionIdentifier">ConnectionIdentifier</a><span class="delimiter">)</span>: <span title="(List[String], List[List[Any]])" class="delimiter">(</span>List<span class="delimiter">[</span>String<span class="delimiter">]</span>, List<span class="delimiter">[</span>List<span class="delimiter">[</span>Any<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span> = <span class="delimiter">{</span>
    <a href="#60371" title="(name: net.liftweb.db.ConnectionIdentifier)(f: net.liftweb.db.SuperConnection =&gt; (List[String], List[List[Any]]))(List[String], List[List[Any]])">use</a><span class="delimiter">(</span><a href="#65774" title="net.liftweb.db.ConnectionIdentifier">connectionIdentifier</a><span class="delimiter">)</span><span class="delimiter">(</span><a title="net.liftweb.db.SuperConnection" id="65781">conn</a> =&gt; <a href="#60353" title="(statement: String, conn: net.liftweb.db.SuperConnection)(f: java.sql.PreparedStatement =&gt; (List[String], List[List[Any]]))(List[String], List[List[Any]])">prepareStatement</a><span class="delimiter">(</span><a href="#65772" title="String">query</a>, <a href="#65781" title="net.liftweb.db.SuperConnection">conn</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a title="java.sql.PreparedStatement" id="65801">ps</a> =&gt; <a href="#60339" title="(rs: java.sql.ResultSet)(List[String], List[List[Any]])">resultSetToAny</a><span class="delimiter">(</span><a href="#60340" title="(ps: java.sql.PreparedStatement, params: List[Any])java.sql.PreparedStatement">setPreparedParams</a><span class="delimiter">(</span><a href="#65801" title="java.sql.PreparedStatement">ps</a>, <a href="#65773" title="List[Any]">params</a><span class="delimiter">)</span>.<span title="()java.sql.ResultSet">executeQuery</span><span class="delimiter">)</span>
      <span class="delimiter">}</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Executes the given parameterized update string with the given parameters.
   * Parameters are substituted in order. For Date/Time types, passing a java.util.Date will result in a
   * Timestamp parameter. If you want a specific SQL Date/Time type, use the corresponding
   * java.sql.Date, java.sql.Time, or java.sql.Timestamp classes.
   */</span>
  <span class="keyword">def</span> <a title="(query: String, params: List[Any])Int" id="60345">runUpdate</a><span class="delimiter">(</span><a title="String" id="65809">query</a>: <span title="String">String</span>, <a title="List[Any]" id="65810">params</a>: <span title="List[Any]">List</span><span class="delimiter">[</span>Any<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="Int">Int</span> =
  <a href="#60346" title="(query: String, params: List[Any], connectionIdentifier: net.liftweb.db.ConnectionIdentifier)Int">runUpdate</a><span class="delimiter">(</span><a href="#65809" title="String">query</a>, <a href="#65810" title="List[Any]">params</a>, <a href="#66906" title="object net.liftweb.db.DefaultConnectionIdentifier">DefaultConnectionIdentifier</a><span class="delimiter">)</span>

  <span class="comment">/**
   * Executes the given parameterized update string with the given parameters.
   * Parameters are substituted in order. For Date/Time types, passing a java.util.Date will result in a
   * Timestamp parameter. If you want a specific SQL Date/Time type, use the corresponding
   * java.sql.Date, java.sql.Time, or java.sql.Timestamp classes.
   */</span>
  <span class="keyword">def</span> <a title="(query: String, params: List[Any], connectionIdentifier: net.liftweb.db.ConnectionIdentifier)Int" id="60346">runUpdate</a><span class="delimiter">(</span><a title="String" id="65816">query</a>: <span title="String">String</span>, <a title="List[Any]" id="65817">params</a>: <span title="List[Any]">List</span><span class="delimiter">[</span>Any<span class="delimiter">]</span>, <a title="net.liftweb.db.ConnectionIdentifier" id="65818">connectionIdentifier</a>: <a href="#10911" title="net.liftweb.db.ConnectionIdentifier">ConnectionIdentifier</a><span class="delimiter">)</span>: <span title="Int">Int</span> = <span class="delimiter">{</span>
    <a href="#60371" title="(name: net.liftweb.db.ConnectionIdentifier)(f: net.liftweb.db.SuperConnection =&gt; Int)Int">use</a><span class="delimiter">(</span><a href="#65818" title="net.liftweb.db.ConnectionIdentifier">connectionIdentifier</a><span class="delimiter">)</span><span class="delimiter">(</span><a title="net.liftweb.db.SuperConnection" id="65825">conn</a> =&gt; <a href="#60353" title="(statement: String, conn: net.liftweb.db.SuperConnection)(f: java.sql.PreparedStatement =&gt; Int)Int">prepareStatement</a><span class="delimiter">(</span><a href="#65816" title="String">query</a>, <a href="#65825" title="net.liftweb.db.SuperConnection">conn</a><span class="delimiter">)</span> <span class="delimiter">{</span>
        <a title="java.sql.PreparedStatement" id="65845">ps</a> =&gt; <a href="#60340" title="(ps: java.sql.PreparedStatement, params: List[Any])java.sql.PreparedStatement">setPreparedParams</a><span class="delimiter">(</span><a href="#65845" title="java.sql.PreparedStatement">ps</a>, <a href="#65817" title="List[Any]">params</a><span class="delimiter">)</span>.<span title="()Int">executeUpdate</span>
      <span class="delimiter">}</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(query: String)(List[String], List[List[String]])" id="60347">runQuery</a><span class="delimiter">(</span><a title="String" id="65701">query</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="(List[String], List[List[String]])" class="delimiter">(</span>List<span class="delimiter">[</span>String<span class="delimiter">]</span>, List<span class="delimiter">[</span>List<span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span> =
    <a href="#60371" title="(name: net.liftweb.db.ConnectionIdentifier)(f: net.liftweb.db.SuperConnection =&gt; (List[String], List[List[String]]))(List[String], List[List[String]])">use</a><span class="delimiter">(</span><a href="#66906" title="object net.liftweb.db.DefaultConnectionIdentifier">DefaultConnectionIdentifier</a><span class="delimiter">)</span><span class="delimiter">(</span><a title="net.liftweb.db.SuperConnection" id="65858">conn</a> =&gt; <a href="#60333" title="(db: net.liftweb.db.SuperConnection, query: String)(f: java.sql.ResultSet =&gt; (List[String], List[List[String]]))(List[String], List[List[String]])">exec</a><span class="delimiter">(</span><a href="#65858" title="net.liftweb.db.SuperConnection">conn</a>, <a href="#65701" title="String">query</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#60338" title="(rs: java.sql.ResultSet)(List[String], List[List[String]])">resultSetTo</a><span class="delimiter">)</span><span class="delimiter">)</span>


  <span class="keyword">def</span> <a title="(query: String)(List[String], List[List[Any]])" id="60348">performQuery</a><span class="delimiter">(</span><a title="String" id="65770">query</a>: <span title="String">String</span><span class="delimiter">)</span>: <span title="(List[String], List[List[Any]])" class="delimiter">(</span>List<span class="delimiter">[</span>String<span class="delimiter">]</span>, List<span class="delimiter">[</span>List<span class="delimiter">[</span>Any<span class="delimiter">]</span><span class="delimiter">]</span><span class="delimiter">)</span> =
    <a href="#60371" title="(name: net.liftweb.db.ConnectionIdentifier)(f: net.liftweb.db.SuperConnection =&gt; (List[String], List[List[Any]]))(List[String], List[List[Any]])">use</a><span class="delimiter">(</span><a href="#66906" title="object net.liftweb.db.DefaultConnectionIdentifier">DefaultConnectionIdentifier</a><span class="delimiter">)</span><span class="delimiter">(</span><a title="net.liftweb.db.SuperConnection" id="65889">conn</a> =&gt; <a href="#60333" title="(db: net.liftweb.db.SuperConnection, query: String)(f: java.sql.ResultSet =&gt; (List[String], List[List[Any]]))(List[String], List[List[Any]])">exec</a><span class="delimiter">(</span><a href="#65889" title="net.liftweb.db.SuperConnection">conn</a>, <a href="#65770" title="String">query</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#60339" title="(rs: java.sql.ResultSet)(List[String], List[List[Any]])">resultSetToAny</a><span class="delimiter">)</span><span class="delimiter">)</span>


  <span class="keyword">def</span> <a title="(name: net.liftweb.db.ConnectionIdentifier)Unit" id="60349">rollback</a><span class="delimiter">(</span><a title="net.liftweb.db.ConnectionIdentifier" id="65911">name</a>: <a href="#10911" title="net.liftweb.db.ConnectionIdentifier">ConnectionIdentifier</a><span class="delimiter">)</span> = <a href="#60371" title="(name: net.liftweb.db.ConnectionIdentifier)(f: net.liftweb.db.SuperConnection =&gt; Unit)Unit">use</a><span class="delimiter">(</span><a href="#65911" title="net.liftweb.db.ConnectionIdentifier">name</a><span class="delimiter">)</span><span class="delimiter">(</span><a title="net.liftweb.db.SuperConnection" id="65919">conn</a> =&gt; <a href="#62644" title="implicit net.liftweb.db.SuperConnection.superToConn : (in: net.liftweb.db.SuperConnection)java.sql.Connection">conn</a>.<span title="()Unit">rollback</span><span class="delimiter">)</span>

  <span class="comment">/**
   * Executes  { @code statement } and converts the  { @code ResultSet } to model
   * instance  { @code T } using  { @code f }
   */</span>
  <span class="keyword">def</span> <a title="[T](statement: java.sql.PreparedStatement)(f: java.sql.ResultSet =&gt; T)T" id="60350">exec</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="60352">T</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="java.sql.PreparedStatement" id="65863">statement</a>: <span title="java.sql.PreparedStatement">PreparedStatement</span><span class="delimiter">)</span><span class="delimiter">(</span><a title="java.sql.ResultSet =&gt; T" id="65864">f</a>: <span class="delimiter">(</span>ResultSet<span class="delimiter">)</span> =&gt; T<span class="delimiter">)</span>: <a href="#60352" title="T">T</a> = <span class="delimiter">{</span>
    <a href="#60285" title="=&gt; net.liftweb.common.Box[Int]">queryTimeout</a>.<a href="../../../../common/net/liftweb/common/Box.scala.html#27031" title="(f: Int =&gt; Unit)Unit">foreach</a><span class="delimiter">(</span><a title="Int" id="65935">to</a> =&gt; <a href="#65863" title="java.sql.PreparedStatement">statement</a>.<span title="(x$1: Int)Unit">setQueryTimeout</span><span class="delimiter">(</span><a href="#65935" title="Int">to</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="keyword">val</span> <a title="java.sql.ResultSet" id="65931">rs</a> = <a href="#65863" title="java.sql.PreparedStatement">statement</a>.<span title="()java.sql.ResultSet">executeQuery</span>
    <span class="keyword">try</span> <span class="delimiter">{</span>
      <a href="#65864" title="(v1: java.sql.ResultSet)T">f</a><span class="delimiter">(</span><a href="#65931" title="java.sql.ResultSet">rs</a><span class="delimiter">)</span>
    <span class="delimiter">}</span> <span class="keyword">finally</span> <span class="delimiter">{</span>
      <a href="#65863" title="java.sql.PreparedStatement">statement</a>.<span title="()Unit">close</span>
      <a href="#65931" title="java.sql.ResultSet">rs</a>.<span title="()Unit">close</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Prepares the given statement and then passes it to the given function for use. This method
   * represents a loan pattern, and will automatically handle creation and closing of the
   * PreparedStatement.
   */</span>
  <span class="keyword">def</span> <a title="[T](statement: String, conn: net.liftweb.db.SuperConnection)(f: java.sql.PreparedStatement =&gt; T)T" id="60353">prepareStatement</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="60355">T</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="String" id="65741">statement</a>: <span title="String">String</span>, <a title="net.liftweb.db.SuperConnection" id="65742">conn</a>: <a href="#10908" title="net.liftweb.db.SuperConnection">SuperConnection</a><span class="delimiter">)</span><span class="delimiter">(</span><a title="java.sql.PreparedStatement =&gt; T" id="65743">f</a>: <span class="delimiter">(</span>PreparedStatement<span class="delimiter">)</span> =&gt; T<span class="delimiter">)</span>: <a href="#60355" title="T">T</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="java.sql.PreparedStatement" id="65940">st</a> =
    <span title="java.sql.PreparedStatement" class="keyword">if</span> <span class="delimiter">(</span><a href="#60292" title="=&gt; Boolean">loggingEnabled_?</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="LoggingStatementWrappers.scala.html#10967" title="object net.liftweb.db.DBLog">DBLog</a>.<a href="LoggingStatementWrappers.scala.html#63628" title="(conn: java.sql.Connection, query: String)java.sql.PreparedStatement">prepareStatement</a><span class="delimiter">(</span><a href="#65742" title="net.liftweb.db.SuperConnection">conn</a>.<a href="#62095" title="=&gt; java.sql.Connection">connection</a>, <a href="#65741" title="String">statement</a><span class="delimiter">)</span>
    <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
      <a href="#62644" title="implicit net.liftweb.db.SuperConnection.superToConn : (in: net.liftweb.db.SuperConnection)java.sql.Connection">conn</a>.<span title="(x$1: java.lang.String)java.sql.PreparedStatement">prepareStatement</span><span class="delimiter">(</span><a href="#65741" title="String">statement</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
    <a href="#60365" title="(st: java.sql.PreparedStatement)(f: java.sql.PreparedStatement =&gt; T)T">runPreparedStatement</a><span class="delimiter">(</span><a href="#65940" title="java.sql.PreparedStatement">st</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#65743" title="java.sql.PreparedStatement =&gt; T">f</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Prepares the given statement and then passes it to the given function for use. This method
   * represents a loan pattern, and will automatically handle creation and closing of the
   * PreparedStatement.
   *
   * Retrieval of generated keys is controlled with the autokeys parameter, corresponding to the
   * constants defined on java.sql.Statement: RETURN_GENERATED_KEYS or NO_GENERATED_KEYS
   */</span>
  <span class="keyword">def</span> <a title="[T](statement: String, autokeys: Int, conn: net.liftweb.db.SuperConnection)(f: java.sql.PreparedStatement =&gt; T)T" id="60356">prepareStatement</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="60358">T</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="String" id="65733">statement</a>: <span title="String">String</span>, <a title="Int" id="65734">autokeys</a>: <span title="Int">Int</span>, <a title="net.liftweb.db.SuperConnection" id="65735">conn</a>: <a href="#10908" title="net.liftweb.db.SuperConnection">SuperConnection</a><span class="delimiter">)</span><span class="delimiter">(</span><a title="java.sql.PreparedStatement =&gt; T" id="65736">f</a>: <span class="delimiter">(</span>PreparedStatement<span class="delimiter">)</span> =&gt; T<span class="delimiter">)</span>: <a href="#60358" title="T">T</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="java.sql.PreparedStatement" id="66122">st</a> =
    <span title="java.sql.PreparedStatement" class="keyword">if</span> <span class="delimiter">(</span><a href="#60292" title="=&gt; Boolean">loggingEnabled_?</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="LoggingStatementWrappers.scala.html#10967" title="object net.liftweb.db.DBLog">DBLog</a>.<a href="LoggingStatementWrappers.scala.html#63629" title="(conn: java.sql.Connection, query: String, autoKeys: Int)java.sql.PreparedStatement">prepareStatement</a><span class="delimiter">(</span><a href="#65735" title="net.liftweb.db.SuperConnection">conn</a>.<a href="#62095" title="=&gt; java.sql.Connection">connection</a>, <a href="#65733" title="String">statement</a>, <a href="#65734" title="Int">autokeys</a><span class="delimiter">)</span>
    <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
      <a href="#62644" title="implicit net.liftweb.db.SuperConnection.superToConn : (in: net.liftweb.db.SuperConnection)java.sql.Connection">conn</a>.<span title="(x$1: java.lang.String, x$2: Int)java.sql.PreparedStatement">prepareStatement</span><span class="delimiter">(</span><a href="#65733" title="String">statement</a>, <a href="#65734" title="Int">autokeys</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
    <a href="#60365" title="(st: java.sql.PreparedStatement)(f: java.sql.PreparedStatement =&gt; T)T">runPreparedStatement</a><span class="delimiter">(</span><a href="#66122" title="java.sql.PreparedStatement">st</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#65736" title="java.sql.PreparedStatement =&gt; T">f</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Prepares the given statement and then passes it to the given function for use. This method
   * represents a loan pattern, and will automatically handle creation and closing of the
   * PreparedStatement.
   *
   * If the driver supports it, generated keys for the given column indices can be retrieved.
   */</span>
  <span class="keyword">def</span> <a title="[T](statement: String, autoColumns: Array[Int], conn: net.liftweb.db.SuperConnection)(f: java.sql.PreparedStatement =&gt; T)T" id="60359">prepareStatement</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="60361">T</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="String" id="65725">statement</a>: <span title="String">String</span>, <a title="Array[Int]" id="65726">autoColumns</a>: <span title="Array[Int]">Array</span><span class="delimiter">[</span>Int<span class="delimiter">]</span>, <a title="net.liftweb.db.SuperConnection" id="65727">conn</a>: <a href="#10908" title="net.liftweb.db.SuperConnection">SuperConnection</a><span class="delimiter">)</span><span class="delimiter">(</span><a title="java.sql.PreparedStatement =&gt; T" id="65728">f</a>: <span class="delimiter">(</span>PreparedStatement<span class="delimiter">)</span> =&gt; T<span class="delimiter">)</span>: <a href="#60361" title="T">T</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="java.sql.PreparedStatement" id="66142">st</a> =
    <span title="java.sql.PreparedStatement" class="keyword">if</span> <span class="delimiter">(</span><a href="#60292" title="=&gt; Boolean">loggingEnabled_?</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="LoggingStatementWrappers.scala.html#10967" title="object net.liftweb.db.DBLog">DBLog</a>.<a href="LoggingStatementWrappers.scala.html#63630" title="(conn: java.sql.Connection, query: String, autoKeys: Array[Int])java.sql.PreparedStatement">prepareStatement</a><span class="delimiter">(</span><a href="#65727" title="net.liftweb.db.SuperConnection">conn</a>.<a href="#62095" title="=&gt; java.sql.Connection">connection</a>, <a href="#65725" title="String">statement</a>, <a href="#65726" title="Array[Int]">autoColumns</a><span class="delimiter">)</span>
    <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
      <a href="#62644" title="implicit net.liftweb.db.SuperConnection.superToConn : (in: net.liftweb.db.SuperConnection)java.sql.Connection">conn</a>.<span title="(x$1: java.lang.String, x$2: Array[Int])java.sql.PreparedStatement">prepareStatement</span><span class="delimiter">(</span><a href="#65725" title="String">statement</a>, <a href="#65726" title="Array[Int]">autoColumns</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
    <a href="#60365" title="(st: java.sql.PreparedStatement)(f: java.sql.PreparedStatement =&gt; T)T">runPreparedStatement</a><span class="delimiter">(</span><a href="#66142" title="java.sql.PreparedStatement">st</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#65728" title="java.sql.PreparedStatement =&gt; T">f</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
   * Prepares the given statement and then passes it to the given function for use. This method
   * represents a loan pattern, and will automatically handle creation and closing of the
   * PreparedStatement.
   *
   * If the driver supports it, generated keys for the given column names can be retrieved.
   */</span>
  <span class="keyword">def</span> <a title="[T](statement: String, autoColumns: Array[String], conn: net.liftweb.db.SuperConnection)(f: java.sql.PreparedStatement =&gt; T)T" id="60362">prepareStatement</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="60364">T</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="String" id="65717">statement</a>: <span title="String">String</span>, <a title="Array[String]" id="65718">autoColumns</a>: <span title="Array[String]">Array</span><span class="delimiter">[</span>String<span class="delimiter">]</span>, <a title="net.liftweb.db.SuperConnection" id="65719">conn</a>: <a href="#10908" title="net.liftweb.db.SuperConnection">SuperConnection</a><span class="delimiter">)</span><span class="delimiter">(</span><a title="java.sql.PreparedStatement =&gt; T" id="65720">f</a>: <span class="delimiter">(</span>PreparedStatement<span class="delimiter">)</span> =&gt; T<span class="delimiter">)</span>: <a href="#60364" title="T">T</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="java.sql.PreparedStatement" id="66162">st</a> =
    <span title="java.sql.PreparedStatement" class="keyword">if</span> <span class="delimiter">(</span><a href="#60292" title="=&gt; Boolean">loggingEnabled_?</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="LoggingStatementWrappers.scala.html#10967" title="object net.liftweb.db.DBLog">DBLog</a>.<a href="LoggingStatementWrappers.scala.html#63631" title="(conn: java.sql.Connection, query: String, autoKeys: Array[String])java.sql.PreparedStatement">prepareStatement</a><span class="delimiter">(</span><a href="#65719" title="net.liftweb.db.SuperConnection">conn</a>.<a href="#62095" title="=&gt; java.sql.Connection">connection</a>, <a href="#65717" title="String">statement</a>, <a href="#65718" title="Array[String]">autoColumns</a><span class="delimiter">)</span>
    <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
      <a href="#62644" title="implicit net.liftweb.db.SuperConnection.superToConn : (in: net.liftweb.db.SuperConnection)java.sql.Connection">conn</a>.<span title="(x$1: java.lang.String, x$2: Array[java.lang.String])java.sql.PreparedStatement">prepareStatement</span><span class="delimiter">(</span><a href="#65717" title="String">statement</a>, <a href="#65718" title="Array[String]">autoColumns</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>
    <a href="#60365" title="(st: java.sql.PreparedStatement)(f: java.sql.PreparedStatement =&gt; T)T">runPreparedStatement</a><span class="delimiter">(</span><a href="#66162" title="java.sql.PreparedStatement">st</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#65720" title="java.sql.PreparedStatement =&gt; T">f</a><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">def</span> <a title="[T](st: java.sql.PreparedStatement)(f: java.sql.PreparedStatement =&gt; T)T" id="60365">runPreparedStatement</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="60367">T</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="java.sql.PreparedStatement" id="66112">st</a>: <span title="java.sql.PreparedStatement">PreparedStatement</span><span class="delimiter">)</span><span class="delimiter">(</span><a title="java.sql.PreparedStatement =&gt; T" id="66113">f</a>: <span class="delimiter">(</span>PreparedStatement<span class="delimiter">)</span> =&gt; T<span class="delimiter">)</span>: <a href="#60367" title="T">T</a> = <span class="delimiter">{</span>
    <a href="#60285" title="=&gt; net.liftweb.common.Box[Int]">queryTimeout</a>.<a href="../../../../common/net/liftweb/common/Box.scala.html#27031" title="(f: Int =&gt; Unit)Unit">foreach</a><span class="delimiter">(</span><a title="Int" id="66185">to</a> =&gt; <a href="#66112" title="java.sql.PreparedStatement">st</a>.<span title="(x$1: Int)Unit">setQueryTimeout</span><span class="delimiter">(</span><a href="#66185" title="Int">to</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="../../../../util/net/liftweb/util/Helpers.scala.html#13346" title="object net.liftweb.util.Helpers">Helpers</a>.<a href="../../../../util/net/liftweb/util/TimeHelpers.scala.html#48811" title="(f: =&gt; (java.sql.PreparedStatement, T))(Long, (java.sql.PreparedStatement, T))">calcTime</a> <span class="delimiter">{</span>
      <span class="keyword">try</span> <span class="delimiter">{</span>
        <span title="(_1: java.sql.PreparedStatement, _2: T)(java.sql.PreparedStatement, T)" class="delimiter">(</span><a href="#66112" title="java.sql.PreparedStatement">st</a>,<a href="#66113" title="(v1: java.sql.PreparedStatement)T">f</a><span class="delimiter">(</span><a href="#66112" title="java.sql.PreparedStatement">st</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="delimiter">}</span> <span class="keyword">finally</span> <span class="delimiter">{</span>
        <a href="#66112" title="java.sql.PreparedStatement">st</a>.<span title="()Unit">close</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span> <span title="T" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <span title="T" class="delimiter">(</span><a title="Long" id="66199">time</a>, <span class="delimiter">(</span><a title="java.sql.PreparedStatement" id="66202">query</a>, <a title="T" id="66203">res</a><span class="delimiter">)</span><span class="delimiter">)</span> =&gt; <a href="#60329" title="(logged: java.sql.Statement, time: Long)Unit">runLogger</a><span class="delimiter">(</span><a href="#66202" title="java.sql.PreparedStatement">query</a>, <a href="#66199" title="Long">time</a><span class="delimiter">)</span>; <a href="#66203" title="T">res</a>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="keyword">private</span> <span class="keyword">object</span> <a title="object DB.this.currentConn" id="60368">currentConn</a> <span title="ScalaObject" class="keyword">extends</span> <a href="../../../../util/net/liftweb/util/ThreadGlobal.scala.html#13701" title="net.liftweb.util.DynoVar[net.liftweb.db.SuperConnection]">DynoVar</a><span class="delimiter">[</span>SuperConnection<span class="delimiter">]</span>

  <span class="keyword">def</span> <a title="=&gt; net.liftweb.common.Box[net.liftweb.db.SuperConnection]" id="60370">currentConnection</a>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[net.liftweb.db.SuperConnection]">Box</a><span class="delimiter">[</span>SuperConnection<span class="delimiter">]</span> = <a href="#60368" title="object DB.this.currentConn">currentConn</a>.<a href="../../../../util/net/liftweb/util/ThreadGlobal.scala.html#63009" title="=&gt; net.liftweb.common.Box[net.liftweb.db.SuperConnection]">is</a>

  <span class="comment">/**
   * Executes function  { @code f } with the connection named  { @code name }. Releases the connection
   * before returning.
   */</span>
  <span class="keyword">def</span> <a title="[T](name: net.liftweb.db.ConnectionIdentifier)(f: net.liftweb.db.SuperConnection =&gt; T)T" id="60371">use</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="60373">T</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="net.liftweb.db.ConnectionIdentifier" id="63112">name</a>: <a href="#10911" title="net.liftweb.db.ConnectionIdentifier">ConnectionIdentifier</a><span class="delimiter">)</span><span class="delimiter">(</span><a title="net.liftweb.db.SuperConnection =&gt; T" id="63113">f</a>: <span class="delimiter">(</span>SuperConnection<span class="delimiter">)</span> =&gt; T<span class="delimiter">)</span>: <a href="#60373" title="T">T</a> = <span class="delimiter">{</span>
    <span class="keyword">val</span> <a title="net.liftweb.db.SuperConnection" id="66208">conn</a> = <a href="#60324" title="(name: net.liftweb.db.ConnectionIdentifier)net.liftweb.db.SuperConnection">getConnection</a><span class="delimiter">(</span><a href="#63112" title="net.liftweb.db.ConnectionIdentifier">name</a><span class="delimiter">)</span>
    <a href="#60368" title="object DB.this.currentConn">currentConn</a>.<a href="../../../../util/net/liftweb/util/ThreadGlobal.scala.html#63012" title="(x: net.liftweb.db.SuperConnection)(f: =&gt; T)T">run</a><span class="delimiter">(</span><a href="#66208" title="net.liftweb.db.SuperConnection">conn</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <span class="keyword">var</span> <a title="Boolean" id="66214">rollback</a> = <span title="Boolean(true)" class="keyword">true</span>
      <span class="keyword">try</span> <span class="delimiter">{</span>
        <span class="keyword">val</span> <a title="T" id="66215">ret</a> = <a href="#63113" title="(v1: net.liftweb.db.SuperConnection)T">f</a><span class="delimiter">(</span><a href="#66208" title="net.liftweb.db.SuperConnection">conn</a><span class="delimiter">)</span>
        <a href="#66214" title="Boolean">rollback</a> = <span title="Boolean(false)" class="keyword">false</span>
        <a href="#66215" title="T">ret</a>
      <span class="delimiter">}</span> <span class="keyword">catch</span> <span class="delimiter">{</span>
        <span class="comment">// this is the case when we want to commit the transaction</span>
        <span class="comment">// but continue to throw the exception</span>
        <span class="keyword">case</span> <a title="Nothing" id="66217">e</a>: <a href="../../../../util/net/liftweb/util/Helpers.scala.html#13350" title="net.liftweb.util.LiftFlowOfControlException">LiftFlowOfControlException</a> =&gt; <span class="delimiter">{</span>
          <a href="#66214" title="Boolean">rollback</a> = <span title="Boolean(false)" class="keyword">false</span>
          <span title="Nothing" class="keyword">throw</span> <a href="#66217" title="net.liftweb.util.LiftFlowOfControlException">e</a>
        <span class="delimiter">}</span>
      <span class="delimiter">}</span> <span class="keyword">finally</span> <span class="delimiter">{</span>
        <a href="#60325" title="(name: net.liftweb.db.ConnectionIdentifier, rollback: Boolean)Unit">releaseConnectionNamed</a><span class="delimiter">(</span><a href="#63112" title="net.liftweb.db.ConnectionIdentifier">name</a>, <a href="#66214" title="Boolean">rollback</a><span class="delimiter">)</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>

  <span class="comment">/**
  * The SQL reserved words.  These words will be changed if they are used for column or table names.
  */</span>
  <span class="keyword">def</span> <a title="=&gt; scala.collection.immutable.Set[String]" id="60374">reservedWords</a>:  scala.collection.immutable.<span title="scala.collection.immutable.Set[String]">Set</span><span class="delimiter">[</span>String<span class="delimiter">]</span> = <a href="#60376" title="=&gt; net.liftweb.common.Box[scala.collection.immutable.Set[String]]">userReservedWords</a> <a href="../../../../common/net/liftweb/common/Box.scala.html#27017" title="(default: =&gt; scala.collection.immutable.Set[String])scala.collection.immutable.Set[String]">openOr</a> <a href="#60378" title="=&gt; scala.collection.immutable.Set[String]">defaultReservedWords</a>

  <span class="comment">/**
  *  If you need to change some of the reserved word, you can supply your own set in Boot.scala:
  * DB.userReservedWords = Full(Set(&quot;foo&quot;, &quot;bar&quot;))
  */</span>
  @volatile <span class="keyword">var</span> <a title="net.liftweb.common.Box[scala.collection.immutable.Set[String]]" id="60376">userReservedWords</a>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[scala.collection.immutable.Set[String]]">Box</a><span class="delimiter">[</span> scala.collection.immutable.Set<span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">]</span> = <a href="../../../../common/net/liftweb/common/Box.scala.html#10581" title="object net.liftweb.common.Empty">Empty</a>


  <span class="comment">/**
  * The default reserved words.
  *
  * TODO : Maybe this should be refactored to allow for driver-specific reserved words
  */</span>
  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="scala.collection.immutable.Set[String]" id="60379">defaultReservedWords</a>:  scala.collection.immutable.<span title="scala.collection.immutable.Set[String]">Set</span><span class="delimiter">[</span>String<span class="delimiter">]</span> = scala.collection.immutable.<span title="(elems: java.lang.String*)scala.collection.immutable.HashSet[java.lang.String]">HashSet</span><span class="delimiter">(</span><span title="java.lang.String(&quot;abort&quot;)" class="string">&quot;abort&quot;</span>,
       <span title="java.lang.String(&quot;accept&quot;)" class="string">&quot;accept&quot;</span>,
       <span title="java.lang.String(&quot;access&quot;)" class="string">&quot;access&quot;</span>,
       <span title="java.lang.String(&quot;add&quot;)" class="string">&quot;add&quot;</span>,
       <span title="java.lang.String(&quot;admin&quot;)" class="string">&quot;admin&quot;</span>,
       <span title="java.lang.String(&quot;after&quot;)" class="string">&quot;after&quot;</span>,
       <span title="java.lang.String(&quot;all&quot;)" class="string">&quot;all&quot;</span>,
       <span title="java.lang.String(&quot;allocate&quot;)" class="string">&quot;allocate&quot;</span>,
       <span title="java.lang.String(&quot;alter&quot;)" class="string">&quot;alter&quot;</span>,
       <span title="java.lang.String(&quot;analyze&quot;)" class="string">&quot;analyze&quot;</span>,
       <span title="java.lang.String(&quot;and&quot;)" class="string">&quot;and&quot;</span>,
       <span title="java.lang.String(&quot;any&quot;)" class="string">&quot;any&quot;</span>,
       <span title="java.lang.String(&quot;archive&quot;)" class="string">&quot;archive&quot;</span>,
       <span title="java.lang.String(&quot;archivelog&quot;)" class="string">&quot;archivelog&quot;</span>,
       <span title="java.lang.String(&quot;array&quot;)" class="string">&quot;array&quot;</span>,
       <span title="java.lang.String(&quot;arraylen&quot;)" class="string">&quot;arraylen&quot;</span>,
       <span title="java.lang.String(&quot;as&quot;)" class="string">&quot;as&quot;</span>,
       <span title="java.lang.String(&quot;asc&quot;)" class="string">&quot;asc&quot;</span>,
       <span title="java.lang.String(&quot;assert&quot;)" class="string">&quot;assert&quot;</span>,
       <span title="java.lang.String(&quot;assign&quot;)" class="string">&quot;assign&quot;</span>,
       <span title="java.lang.String(&quot;at&quot;)" class="string">&quot;at&quot;</span>,
       <span title="java.lang.String(&quot;audit&quot;)" class="string">&quot;audit&quot;</span>,
       <span title="java.lang.String(&quot;authorization&quot;)" class="string">&quot;authorization&quot;</span>,
       <span title="java.lang.String(&quot;avg&quot;)" class="string">&quot;avg&quot;</span>,
       <span title="java.lang.String(&quot;backup&quot;)" class="string">&quot;backup&quot;</span>,
       <span title="java.lang.String(&quot;base_table&quot;)" class="string">&quot;base_table&quot;</span>,
       <span title="java.lang.String(&quot;become&quot;)" class="string">&quot;become&quot;</span>,
       <span title="java.lang.String(&quot;before&quot;)" class="string">&quot;before&quot;</span>,
       <span title="java.lang.String(&quot;begin&quot;)" class="string">&quot;begin&quot;</span>,
       <span title="java.lang.String(&quot;between&quot;)" class="string">&quot;between&quot;</span>,
       <span title="java.lang.String(&quot;binary_integer&quot;)" class="string">&quot;binary_integer&quot;</span>,
       <span title="java.lang.String(&quot;blob&quot;)" class="string">&quot;blob&quot;</span>,
       <span title="java.lang.String(&quot;block&quot;)" class="string">&quot;block&quot;</span>,
       <span title="java.lang.String(&quot;body&quot;)" class="string">&quot;body&quot;</span>,
       <span title="java.lang.String(&quot;boolean&quot;)" class="string">&quot;boolean&quot;</span>,
       <span title="java.lang.String(&quot;by&quot;)" class="string">&quot;by&quot;</span>,
       <span title="java.lang.String(&quot;cache&quot;)" class="string">&quot;cache&quot;</span>,
       <span title="java.lang.String(&quot;cancel&quot;)" class="string">&quot;cancel&quot;</span>,
       <span title="java.lang.String(&quot;cascade&quot;)" class="string">&quot;cascade&quot;</span>,
       <span title="java.lang.String(&quot;case&quot;)" class="string">&quot;case&quot;</span>,
       <span title="java.lang.String(&quot;change&quot;)" class="string">&quot;change&quot;</span>,
       <span title="java.lang.String(&quot;char&quot;)" class="string">&quot;char&quot;</span>,
       <span title="java.lang.String(&quot;character&quot;)" class="string">&quot;character&quot;</span>,
       <span title="java.lang.String(&quot;char_base&quot;)" class="string">&quot;char_base&quot;</span>,
       <span title="java.lang.String(&quot;check&quot;)" class="string">&quot;check&quot;</span>,
       <span title="java.lang.String(&quot;checkpoint&quot;)" class="string">&quot;checkpoint&quot;</span>,
       <span title="java.lang.String(&quot;close&quot;)" class="string">&quot;close&quot;</span>,
       <span title="java.lang.String(&quot;cluster&quot;)" class="string">&quot;cluster&quot;</span>,
       <span title="java.lang.String(&quot;clusters&quot;)" class="string">&quot;clusters&quot;</span>,
       <span title="java.lang.String(&quot;cobol&quot;)" class="string">&quot;cobol&quot;</span>,
       <span title="java.lang.String(&quot;colauth&quot;)" class="string">&quot;colauth&quot;</span>,
       <span title="java.lang.String(&quot;column&quot;)" class="string">&quot;column&quot;</span>,
       <span title="java.lang.String(&quot;columns&quot;)" class="string">&quot;columns&quot;</span>,
       <span title="java.lang.String(&quot;comment&quot;)" class="string">&quot;comment&quot;</span>,
       <span title="java.lang.String(&quot;commit&quot;)" class="string">&quot;commit&quot;</span>,
       <span title="java.lang.String(&quot;compile&quot;)" class="string">&quot;compile&quot;</span>,
       <span title="java.lang.String(&quot;compress&quot;)" class="string">&quot;compress&quot;</span>,
       <span title="java.lang.String(&quot;connect&quot;)" class="string">&quot;connect&quot;</span>,
       <span title="java.lang.String(&quot;constant&quot;)" class="string">&quot;constant&quot;</span>,
       <span title="java.lang.String(&quot;constraint&quot;)" class="string">&quot;constraint&quot;</span>,
       <span title="java.lang.String(&quot;constraints&quot;)" class="string">&quot;constraints&quot;</span>,
       <span title="java.lang.String(&quot;contents&quot;)" class="string">&quot;contents&quot;</span>,
       <span title="java.lang.String(&quot;continue&quot;)" class="string">&quot;continue&quot;</span>,
       <span title="java.lang.String(&quot;controlfile&quot;)" class="string">&quot;controlfile&quot;</span>,
       <span title="java.lang.String(&quot;count&quot;)" class="string">&quot;count&quot;</span>,
       <span title="java.lang.String(&quot;crash&quot;)" class="string">&quot;crash&quot;</span>,
       <span title="java.lang.String(&quot;create&quot;)" class="string">&quot;create&quot;</span>,
       <span title="java.lang.String(&quot;current&quot;)" class="string">&quot;current&quot;</span>,
       <span title="java.lang.String(&quot;currval&quot;)" class="string">&quot;currval&quot;</span>,
       <span title="java.lang.String(&quot;cursor&quot;)" class="string">&quot;cursor&quot;</span>,
       <span title="java.lang.String(&quot;cycle&quot;)" class="string">&quot;cycle&quot;</span>,
       <span title="java.lang.String(&quot;database&quot;)" class="string">&quot;database&quot;</span>,
       <span title="java.lang.String(&quot;data_base&quot;)" class="string">&quot;data_base&quot;</span>,
       <span title="java.lang.String(&quot;datafile&quot;)" class="string">&quot;datafile&quot;</span>,
       <span title="java.lang.String(&quot;date&quot;)" class="string">&quot;date&quot;</span>,
       <span title="java.lang.String(&quot;dba&quot;)" class="string">&quot;dba&quot;</span>,
       <span title="java.lang.String(&quot;debugoff&quot;)" class="string">&quot;debugoff&quot;</span>,
       <span title="java.lang.String(&quot;debugon&quot;)" class="string">&quot;debugon&quot;</span>,
       <span title="java.lang.String(&quot;dec&quot;)" class="string">&quot;dec&quot;</span>,
       <span title="java.lang.String(&quot;decimal&quot;)" class="string">&quot;decimal&quot;</span>,
       <span title="java.lang.String(&quot;declare&quot;)" class="string">&quot;declare&quot;</span>,
       <span title="java.lang.String(&quot;default&quot;)" class="string">&quot;default&quot;</span>,
       <span title="java.lang.String(&quot;definition&quot;)" class="string">&quot;definition&quot;</span>,
       <span title="java.lang.String(&quot;delay&quot;)" class="string">&quot;delay&quot;</span>,
       <span title="java.lang.String(&quot;delete&quot;)" class="string">&quot;delete&quot;</span>,
       <span title="java.lang.String(&quot;delta&quot;)" class="string">&quot;delta&quot;</span>,
       <span title="java.lang.String(&quot;desc&quot;)" class="string">&quot;desc&quot;</span>,
       <span title="java.lang.String(&quot;digits&quot;)" class="string">&quot;digits&quot;</span>,
       <span title="java.lang.String(&quot;disable&quot;)" class="string">&quot;disable&quot;</span>,
       <span title="java.lang.String(&quot;dismount&quot;)" class="string">&quot;dismount&quot;</span>,
       <span title="java.lang.String(&quot;dispose&quot;)" class="string">&quot;dispose&quot;</span>,
       <span title="java.lang.String(&quot;distinct&quot;)" class="string">&quot;distinct&quot;</span>,
       <span title="java.lang.String(&quot;do&quot;)" class="string">&quot;do&quot;</span>,
       <span title="java.lang.String(&quot;double&quot;)" class="string">&quot;double&quot;</span>,
       <span title="java.lang.String(&quot;drop&quot;)" class="string">&quot;drop&quot;</span>,
       <span title="java.lang.String(&quot;dump&quot;)" class="string">&quot;dump&quot;</span>,
       <span title="java.lang.String(&quot;each&quot;)" class="string">&quot;each&quot;</span>,
       <span title="java.lang.String(&quot;else&quot;)" class="string">&quot;else&quot;</span>,
       <span title="java.lang.String(&quot;elsif&quot;)" class="string">&quot;elsif&quot;</span>,
       <span title="java.lang.String(&quot;enable&quot;)" class="string">&quot;enable&quot;</span>,
       <span title="java.lang.String(&quot;end&quot;)" class="string">&quot;end&quot;</span>,
       <span title="java.lang.String(&quot;entry&quot;)" class="string">&quot;entry&quot;</span>,
       <span title="java.lang.String(&quot;escape&quot;)" class="string">&quot;escape&quot;</span>,
       <span title="java.lang.String(&quot;events&quot;)" class="string">&quot;events&quot;</span>,
       <span title="java.lang.String(&quot;except&quot;)" class="string">&quot;except&quot;</span>,
       <span title="java.lang.String(&quot;exception&quot;)" class="string">&quot;exception&quot;</span>,
       <span title="java.lang.String(&quot;exception_init&quot;)" class="string">&quot;exception_init&quot;</span>,
       <span title="java.lang.String(&quot;exceptions&quot;)" class="string">&quot;exceptions&quot;</span>,
       <span title="java.lang.String(&quot;exclusive&quot;)" class="string">&quot;exclusive&quot;</span>,
       <span title="java.lang.String(&quot;exec&quot;)" class="string">&quot;exec&quot;</span>,
       <span title="java.lang.String(&quot;execute&quot;)" class="string">&quot;execute&quot;</span>,
       <span title="java.lang.String(&quot;exists&quot;)" class="string">&quot;exists&quot;</span>,
       <span title="java.lang.String(&quot;exit&quot;)" class="string">&quot;exit&quot;</span>,
       <span title="java.lang.String(&quot;explain&quot;)" class="string">&quot;explain&quot;</span>,
       <span title="java.lang.String(&quot;extent&quot;)" class="string">&quot;extent&quot;</span>,
       <span title="java.lang.String(&quot;externally&quot;)" class="string">&quot;externally&quot;</span>,
       <span title="java.lang.String(&quot;false&quot;)" class="string">&quot;false&quot;</span>,
       <span title="java.lang.String(&quot;fetch&quot;)" class="string">&quot;fetch&quot;</span>,
       <span title="java.lang.String(&quot;file&quot;)" class="string">&quot;file&quot;</span>,
       <span title="java.lang.String(&quot;float&quot;)" class="string">&quot;float&quot;</span>,
       <span title="java.lang.String(&quot;flush&quot;)" class="string">&quot;flush&quot;</span>,
       <span title="java.lang.String(&quot;for&quot;)" class="string">&quot;for&quot;</span>,
       <span title="java.lang.String(&quot;force&quot;)" class="string">&quot;force&quot;</span>,
       <span title="java.lang.String(&quot;foreign&quot;)" class="string">&quot;foreign&quot;</span>,
       <span title="java.lang.String(&quot;form&quot;)" class="string">&quot;form&quot;</span>,
       <span title="java.lang.String(&quot;fortran&quot;)" class="string">&quot;fortran&quot;</span>,
       <span title="java.lang.String(&quot;found&quot;)" class="string">&quot;found&quot;</span>,
       <span title="java.lang.String(&quot;freelist&quot;)" class="string">&quot;freelist&quot;</span>,
       <span title="java.lang.String(&quot;freelists&quot;)" class="string">&quot;freelists&quot;</span>,
       <span title="java.lang.String(&quot;from&quot;)" class="string">&quot;from&quot;</span>,
       <span title="java.lang.String(&quot;function&quot;)" class="string">&quot;function&quot;</span>,
       <span title="java.lang.String(&quot;generic&quot;)" class="string">&quot;generic&quot;</span>,
       <span title="java.lang.String(&quot;go&quot;)" class="string">&quot;go&quot;</span>,
       <span title="java.lang.String(&quot;goto&quot;)" class="string">&quot;goto&quot;</span>,
       <span title="java.lang.String(&quot;grant&quot;)" class="string">&quot;grant&quot;</span>,
       <span title="java.lang.String(&quot;group&quot;)" class="string">&quot;group&quot;</span>,
       <span title="java.lang.String(&quot;having&quot;)" class="string">&quot;having&quot;</span>,
       <span title="java.lang.String(&quot;identified&quot;)" class="string">&quot;identified&quot;</span>,
       <span title="java.lang.String(&quot;if&quot;)" class="string">&quot;if&quot;</span>,
       <span title="java.lang.String(&quot;immediate&quot;)" class="string">&quot;immediate&quot;</span>,
       <span title="java.lang.String(&quot;in&quot;)" class="string">&quot;in&quot;</span>,
       <span title="java.lang.String(&quot;including&quot;)" class="string">&quot;including&quot;</span>,
       <span title="java.lang.String(&quot;increment&quot;)" class="string">&quot;increment&quot;</span>,
       <span title="java.lang.String(&quot;index&quot;)" class="string">&quot;index&quot;</span>,
       <span title="java.lang.String(&quot;indexes&quot;)" class="string">&quot;indexes&quot;</span>,
       <span title="java.lang.String(&quot;indicator&quot;)" class="string">&quot;indicator&quot;</span>,
       <span title="java.lang.String(&quot;initial&quot;)" class="string">&quot;initial&quot;</span>,
       <span title="java.lang.String(&quot;initrans&quot;)" class="string">&quot;initrans&quot;</span>,
       <span title="java.lang.String(&quot;insert&quot;)" class="string">&quot;insert&quot;</span>,
       <span title="java.lang.String(&quot;instance&quot;)" class="string">&quot;instance&quot;</span>,
       <span title="java.lang.String(&quot;notnull&quot;)" class="string">&quot;notnull&quot;</span>, <span class="comment">// reserved word for PostgreSQL</span>
       <span title="java.lang.String(&quot;int&quot;)" class="string">&quot;int&quot;</span>,
       <span title="java.lang.String(&quot;integer&quot;)" class="string">&quot;integer&quot;</span>,
       <span title="java.lang.String(&quot;intersect&quot;)" class="string">&quot;intersect&quot;</span>,
       <span title="java.lang.String(&quot;into&quot;)" class="string">&quot;into&quot;</span>,
       <span title="java.lang.String(&quot;is&quot;)" class="string">&quot;is&quot;</span>,
       <span title="java.lang.String(&quot;key&quot;)" class="string">&quot;key&quot;</span>,
       <span title="java.lang.String(&quot;language&quot;)" class="string">&quot;language&quot;</span>,
       <span title="java.lang.String(&quot;layer&quot;)" class="string">&quot;layer&quot;</span>,
       <span title="java.lang.String(&quot;level&quot;)" class="string">&quot;level&quot;</span>,
       <span title="java.lang.String(&quot;like&quot;)" class="string">&quot;like&quot;</span>,
       <span title="java.lang.String(&quot;limited&quot;)" class="string">&quot;limited&quot;</span>,
       <span title="java.lang.String(&quot;link&quot;)" class="string">&quot;link&quot;</span>,
       <span title="java.lang.String(&quot;lists&quot;)" class="string">&quot;lists&quot;</span>,
       <span title="java.lang.String(&quot;lock&quot;)" class="string">&quot;lock&quot;</span>,
       <span title="java.lang.String(&quot;logfile&quot;)" class="string">&quot;logfile&quot;</span>,
       <span title="java.lang.String(&quot;long&quot;)" class="string">&quot;long&quot;</span>,
       <span title="java.lang.String(&quot;loop&quot;)" class="string">&quot;loop&quot;</span>,
       <span title="java.lang.String(&quot;manage&quot;)" class="string">&quot;manage&quot;</span>,
       <span title="java.lang.String(&quot;manual&quot;)" class="string">&quot;manual&quot;</span>,
       <span title="java.lang.String(&quot;max&quot;)" class="string">&quot;max&quot;</span>,
       <span title="java.lang.String(&quot;maxdatafiles&quot;)" class="string">&quot;maxdatafiles&quot;</span>,
       <span title="java.lang.String(&quot;maxextents&quot;)" class="string">&quot;maxextents&quot;</span>,
       <span title="java.lang.String(&quot;maxinstances&quot;)" class="string">&quot;maxinstances&quot;</span>,
       <span title="java.lang.String(&quot;maxlogfiles&quot;)" class="string">&quot;maxlogfiles&quot;</span>,
       <span title="java.lang.String(&quot;maxloghistory&quot;)" class="string">&quot;maxloghistory&quot;</span>,
       <span title="java.lang.String(&quot;maxlogmembers&quot;)" class="string">&quot;maxlogmembers&quot;</span>,
       <span title="java.lang.String(&quot;maxtrans&quot;)" class="string">&quot;maxtrans&quot;</span>,
       <span title="java.lang.String(&quot;maxvalue&quot;)" class="string">&quot;maxvalue&quot;</span>,
       <span title="java.lang.String(&quot;min&quot;)" class="string">&quot;min&quot;</span>,
       <span title="java.lang.String(&quot;minextents&quot;)" class="string">&quot;minextents&quot;</span>,
       <span title="java.lang.String(&quot;minus&quot;)" class="string">&quot;minus&quot;</span>,
       <span title="java.lang.String(&quot;minvalue&quot;)" class="string">&quot;minvalue&quot;</span>,
       <span title="java.lang.String(&quot;mlslabel&quot;)" class="string">&quot;mlslabel&quot;</span>,
       <span title="java.lang.String(&quot;mod&quot;)" class="string">&quot;mod&quot;</span>,
       <span title="java.lang.String(&quot;mode&quot;)" class="string">&quot;mode&quot;</span>,
       <span title="java.lang.String(&quot;modify&quot;)" class="string">&quot;modify&quot;</span>,
       <span title="java.lang.String(&quot;module&quot;)" class="string">&quot;module&quot;</span>,
       <span title="java.lang.String(&quot;mount&quot;)" class="string">&quot;mount&quot;</span>,
       <span title="java.lang.String(&quot;natural&quot;)" class="string">&quot;natural&quot;</span>,
       <span title="java.lang.String(&quot;new&quot;)" class="string">&quot;new&quot;</span>,
       <span title="java.lang.String(&quot;next&quot;)" class="string">&quot;next&quot;</span>,
       <span title="java.lang.String(&quot;nextval&quot;)" class="string">&quot;nextval&quot;</span>,
       <span title="java.lang.String(&quot;noarchivelog&quot;)" class="string">&quot;noarchivelog&quot;</span>,
       <span title="java.lang.String(&quot;noaudit&quot;)" class="string">&quot;noaudit&quot;</span>,
       <span title="java.lang.String(&quot;nocache&quot;)" class="string">&quot;nocache&quot;</span>,
       <span title="java.lang.String(&quot;nocompress&quot;)" class="string">&quot;nocompress&quot;</span>,
       <span title="java.lang.String(&quot;nocycle&quot;)" class="string">&quot;nocycle&quot;</span>,
       <span title="java.lang.String(&quot;nomaxvalue&quot;)" class="string">&quot;nomaxvalue&quot;</span>,
       <span title="java.lang.String(&quot;nominvalue&quot;)" class="string">&quot;nominvalue&quot;</span>,
       <span title="java.lang.String(&quot;none&quot;)" class="string">&quot;none&quot;</span>,
       <span title="java.lang.String(&quot;noorder&quot;)" class="string">&quot;noorder&quot;</span>,
       <span title="java.lang.String(&quot;noresetlogs&quot;)" class="string">&quot;noresetlogs&quot;</span>,
       <span title="java.lang.String(&quot;normal&quot;)" class="string">&quot;normal&quot;</span>,
       <span title="java.lang.String(&quot;nosort&quot;)" class="string">&quot;nosort&quot;</span>,
       <span title="java.lang.String(&quot;not&quot;)" class="string">&quot;not&quot;</span>,
       <span title="java.lang.String(&quot;notfound&quot;)" class="string">&quot;notfound&quot;</span>,
       <span title="java.lang.String(&quot;nowait&quot;)" class="string">&quot;nowait&quot;</span>,
       <span title="java.lang.String(&quot;null&quot;)" class="string">&quot;null&quot;</span>,
       <span title="java.lang.String(&quot;number&quot;)" class="string">&quot;number&quot;</span>,
       <span title="java.lang.String(&quot;number_base&quot;)" class="string">&quot;number_base&quot;</span>,
       <span title="java.lang.String(&quot;numeric&quot;)" class="string">&quot;numeric&quot;</span>,
       <span title="java.lang.String(&quot;of&quot;)" class="string">&quot;of&quot;</span>,
       <span title="java.lang.String(&quot;off&quot;)" class="string">&quot;off&quot;</span>,
       <span title="java.lang.String(&quot;offline&quot;)" class="string">&quot;offline&quot;</span>,
       <span title="java.lang.String(&quot;old&quot;)" class="string">&quot;old&quot;</span>,
       <span title="java.lang.String(&quot;on&quot;)" class="string">&quot;on&quot;</span>,
       <span title="java.lang.String(&quot;online&quot;)" class="string">&quot;online&quot;</span>,
       <span title="java.lang.String(&quot;only&quot;)" class="string">&quot;only&quot;</span>,
       <span title="java.lang.String(&quot;open&quot;)" class="string">&quot;open&quot;</span>,
       <span title="java.lang.String(&quot;optimal&quot;)" class="string">&quot;optimal&quot;</span>,
       <span title="java.lang.String(&quot;option&quot;)" class="string">&quot;option&quot;</span>,
       <span title="java.lang.String(&quot;or&quot;)" class="string">&quot;or&quot;</span>,
       <span title="java.lang.String(&quot;order&quot;)" class="string">&quot;order&quot;</span>,
       <span title="java.lang.String(&quot;others&quot;)" class="string">&quot;others&quot;</span>,
       <span title="java.lang.String(&quot;out&quot;)" class="string">&quot;out&quot;</span>,
       <span title="java.lang.String(&quot;own&quot;)" class="string">&quot;own&quot;</span>,
       <span title="java.lang.String(&quot;package&quot;)" class="string">&quot;package&quot;</span>,
       <span title="java.lang.String(&quot;parallel&quot;)" class="string">&quot;parallel&quot;</span>,
       <span title="java.lang.String(&quot;partition&quot;)" class="string">&quot;partition&quot;</span>,
       <span title="java.lang.String(&quot;pctfree&quot;)" class="string">&quot;pctfree&quot;</span>,
       <span title="java.lang.String(&quot;pctincrease&quot;)" class="string">&quot;pctincrease&quot;</span>,
       <span title="java.lang.String(&quot;pctused&quot;)" class="string">&quot;pctused&quot;</span>,
       <span title="java.lang.String(&quot;plan&quot;)" class="string">&quot;plan&quot;</span>,
       <span title="java.lang.String(&quot;pli&quot;)" class="string">&quot;pli&quot;</span>,
       <span title="java.lang.String(&quot;positive&quot;)" class="string">&quot;positive&quot;</span>,
       <span title="java.lang.String(&quot;pragma&quot;)" class="string">&quot;pragma&quot;</span>,
       <span title="java.lang.String(&quot;precision&quot;)" class="string">&quot;precision&quot;</span>,
       <span title="java.lang.String(&quot;primary&quot;)" class="string">&quot;primary&quot;</span>,
       <span title="java.lang.String(&quot;prior&quot;)" class="string">&quot;prior&quot;</span>,
       <span title="java.lang.String(&quot;private&quot;)" class="string">&quot;private&quot;</span>,
       <span title="java.lang.String(&quot;privileges&quot;)" class="string">&quot;privileges&quot;</span>,
       <span title="java.lang.String(&quot;procedure&quot;)" class="string">&quot;procedure&quot;</span>,
       <span title="java.lang.String(&quot;profile&quot;)" class="string">&quot;profile&quot;</span>,
       <span title="java.lang.String(&quot;public&quot;)" class="string">&quot;public&quot;</span>,
       <span title="java.lang.String(&quot;quota&quot;)" class="string">&quot;quota&quot;</span>,
       <span title="java.lang.String(&quot;raise&quot;)" class="string">&quot;raise&quot;</span>,
       <span title="java.lang.String(&quot;range&quot;)" class="string">&quot;range&quot;</span>,
       <span title="java.lang.String(&quot;raw&quot;)" class="string">&quot;raw&quot;</span>,
       <span title="java.lang.String(&quot;read&quot;)" class="string">&quot;read&quot;</span>,
       <span title="java.lang.String(&quot;real&quot;)" class="string">&quot;real&quot;</span>,
       <span title="java.lang.String(&quot;record&quot;)" class="string">&quot;record&quot;</span>,
       <span title="java.lang.String(&quot;recover&quot;)" class="string">&quot;recover&quot;</span>,
       <span title="java.lang.String(&quot;references&quot;)" class="string">&quot;references&quot;</span>,
       <span title="java.lang.String(&quot;referencing&quot;)" class="string">&quot;referencing&quot;</span>,
       <span title="java.lang.String(&quot;release&quot;)" class="string">&quot;release&quot;</span>,
       <span title="java.lang.String(&quot;remr&quot;)" class="string">&quot;remr&quot;</span>,
       <span title="java.lang.String(&quot;rename&quot;)" class="string">&quot;rename&quot;</span>,
       <span title="java.lang.String(&quot;resetlogs&quot;)" class="string">&quot;resetlogs&quot;</span>,
       <span title="java.lang.String(&quot;resource&quot;)" class="string">&quot;resource&quot;</span>,
       <span title="java.lang.String(&quot;restricted&quot;)" class="string">&quot;restricted&quot;</span>,
       <span title="java.lang.String(&quot;return&quot;)" class="string">&quot;return&quot;</span>,
       <span title="java.lang.String(&quot;reuse&quot;)" class="string">&quot;reuse&quot;</span>,
       <span title="java.lang.String(&quot;reverse&quot;)" class="string">&quot;reverse&quot;</span>,
       <span title="java.lang.String(&quot;revoke&quot;)" class="string">&quot;revoke&quot;</span>,
       <span title="java.lang.String(&quot;role&quot;)" class="string">&quot;role&quot;</span>,
       <span title="java.lang.String(&quot;roles&quot;)" class="string">&quot;roles&quot;</span>,
       <span title="java.lang.String(&quot;rollback&quot;)" class="string">&quot;rollback&quot;</span>,
       <span title="java.lang.String(&quot;row&quot;)" class="string">&quot;row&quot;</span>,
       <span title="java.lang.String(&quot;rowid&quot;)" class="string">&quot;rowid&quot;</span>,
       <span title="java.lang.String(&quot;rowlabel&quot;)" class="string">&quot;rowlabel&quot;</span>,
       <span title="java.lang.String(&quot;rownum&quot;)" class="string">&quot;rownum&quot;</span>,
       <span title="java.lang.String(&quot;rows&quot;)" class="string">&quot;rows&quot;</span>,
       <span title="java.lang.String(&quot;rowtype&quot;)" class="string">&quot;rowtype&quot;</span>,
       <span title="java.lang.String(&quot;run&quot;)" class="string">&quot;run&quot;</span>,
       <span title="java.lang.String(&quot;savepoint&quot;)" class="string">&quot;savepoint&quot;</span>,
       <span title="java.lang.String(&quot;schema&quot;)" class="string">&quot;schema&quot;</span>,
       <span title="java.lang.String(&quot;scn&quot;)" class="string">&quot;scn&quot;</span>,
       <span title="java.lang.String(&quot;section&quot;)" class="string">&quot;section&quot;</span>,
       <span title="java.lang.String(&quot;segment&quot;)" class="string">&quot;segment&quot;</span>,
       <span title="java.lang.String(&quot;select&quot;)" class="string">&quot;select&quot;</span>,
       <span title="java.lang.String(&quot;separate&quot;)" class="string">&quot;separate&quot;</span>,
       <span title="java.lang.String(&quot;sequence&quot;)" class="string">&quot;sequence&quot;</span>,
       <span title="java.lang.String(&quot;session&quot;)" class="string">&quot;session&quot;</span>,
       <span title="java.lang.String(&quot;set&quot;)" class="string">&quot;set&quot;</span>,
       <span title="java.lang.String(&quot;share&quot;)" class="string">&quot;share&quot;</span>,
       <span title="java.lang.String(&quot;shared&quot;)" class="string">&quot;shared&quot;</span>,
       <span title="java.lang.String(&quot;show&quot;)" class="string">&quot;show&quot;</span>, <span class="comment">// MySQL reserved word</span>
       <span title="java.lang.String(&quot;size&quot;)" class="string">&quot;size&quot;</span>,
       <span title="java.lang.String(&quot;smallint&quot;)" class="string">&quot;smallint&quot;</span>,
       <span title="java.lang.String(&quot;snapshot&quot;)" class="string">&quot;snapshot&quot;</span>,
       <span title="java.lang.String(&quot;some&quot;)" class="string">&quot;some&quot;</span>,
       <span title="java.lang.String(&quot;sort&quot;)" class="string">&quot;sort&quot;</span>,
       <span title="java.lang.String(&quot;space&quot;)" class="string">&quot;space&quot;</span>,
       <span title="java.lang.String(&quot;sql&quot;)" class="string">&quot;sql&quot;</span>,
       <span title="java.lang.String(&quot;sqlbuf&quot;)" class="string">&quot;sqlbuf&quot;</span>,
       <span title="java.lang.String(&quot;sqlcode&quot;)" class="string">&quot;sqlcode&quot;</span>,
       <span title="java.lang.String(&quot;sqlerrm&quot;)" class="string">&quot;sqlerrm&quot;</span>,
       <span title="java.lang.String(&quot;sqlerror&quot;)" class="string">&quot;sqlerror&quot;</span>,
       <span title="java.lang.String(&quot;sqlstate&quot;)" class="string">&quot;sqlstate&quot;</span>,
       <span title="java.lang.String(&quot;start&quot;)" class="string">&quot;start&quot;</span>,
       <span title="java.lang.String(&quot;statement&quot;)" class="string">&quot;statement&quot;</span>,
       <span title="java.lang.String(&quot;statement_id&quot;)" class="string">&quot;statement_id&quot;</span>,
       <span title="java.lang.String(&quot;statistics&quot;)" class="string">&quot;statistics&quot;</span>,
       <span title="java.lang.String(&quot;stddev&quot;)" class="string">&quot;stddev&quot;</span>,
       <span title="java.lang.String(&quot;stop&quot;)" class="string">&quot;stop&quot;</span>,
       <span title="java.lang.String(&quot;storage&quot;)" class="string">&quot;storage&quot;</span>,
       <span title="java.lang.String(&quot;subtype&quot;)" class="string">&quot;subtype&quot;</span>,
       <span title="java.lang.String(&quot;successful&quot;)" class="string">&quot;successful&quot;</span>,
       <span title="java.lang.String(&quot;sum&quot;)" class="string">&quot;sum&quot;</span>,
       <span title="java.lang.String(&quot;switch&quot;)" class="string">&quot;switch&quot;</span>,
       <span title="java.lang.String(&quot;synonym&quot;)" class="string">&quot;synonym&quot;</span>,
       <span title="java.lang.String(&quot;sysdate&quot;)" class="string">&quot;sysdate&quot;</span>,
       <span title="java.lang.String(&quot;system&quot;)" class="string">&quot;system&quot;</span>,
       <span title="java.lang.String(&quot;tabauth&quot;)" class="string">&quot;tabauth&quot;</span>,
       <span title="java.lang.String(&quot;table&quot;)" class="string">&quot;table&quot;</span>,
       <span title="java.lang.String(&quot;tables&quot;)" class="string">&quot;tables&quot;</span>,
       <span title="java.lang.String(&quot;tablespace&quot;)" class="string">&quot;tablespace&quot;</span>,
       <span title="java.lang.String(&quot;task&quot;)" class="string">&quot;task&quot;</span>,
       <span title="java.lang.String(&quot;temporary&quot;)" class="string">&quot;temporary&quot;</span>,
       <span title="java.lang.String(&quot;terminate&quot;)" class="string">&quot;terminate&quot;</span>,
       <span title="java.lang.String(&quot;then&quot;)" class="string">&quot;then&quot;</span>,
       <span title="java.lang.String(&quot;thread&quot;)" class="string">&quot;thread&quot;</span>,
       <span title="java.lang.String(&quot;time&quot;)" class="string">&quot;time&quot;</span>,
       <span title="java.lang.String(&quot;timestamp&quot;)" class="string">&quot;timestamp&quot;</span>, <span class="comment">// reserved in Oracle</span>
       <span title="java.lang.String(&quot;to&quot;)" class="string">&quot;to&quot;</span>,
       <span title="java.lang.String(&quot;tracing&quot;)" class="string">&quot;tracing&quot;</span>,
       <span title="java.lang.String(&quot;transaction&quot;)" class="string">&quot;transaction&quot;</span>,
       <span title="java.lang.String(&quot;trigger&quot;)" class="string">&quot;trigger&quot;</span>,
       <span title="java.lang.String(&quot;triggers&quot;)" class="string">&quot;triggers&quot;</span>,
       <span title="java.lang.String(&quot;true&quot;)" class="string">&quot;true&quot;</span>,
       <span title="java.lang.String(&quot;truncate&quot;)" class="string">&quot;truncate&quot;</span>,
       <span title="java.lang.String(&quot;type&quot;)" class="string">&quot;type&quot;</span>,
       <span title="java.lang.String(&quot;uid&quot;)" class="string">&quot;uid&quot;</span>,
       <span title="java.lang.String(&quot;under&quot;)" class="string">&quot;under&quot;</span>,
       <span title="java.lang.String(&quot;union&quot;)" class="string">&quot;union&quot;</span>,
       <span title="java.lang.String(&quot;unique&quot;)" class="string">&quot;unique&quot;</span>,
       <span title="java.lang.String(&quot;unlimited&quot;)" class="string">&quot;unlimited&quot;</span>,
       <span title="java.lang.String(&quot;until&quot;)" class="string">&quot;until&quot;</span>,
       <span title="java.lang.String(&quot;update&quot;)" class="string">&quot;update&quot;</span>,
       <span title="java.lang.String(&quot;use&quot;)" class="string">&quot;use&quot;</span>,
       <span title="java.lang.String(&quot;user&quot;)" class="string">&quot;user&quot;</span>,
       <span title="java.lang.String(&quot;using&quot;)" class="string">&quot;using&quot;</span>,
       <span title="java.lang.String(&quot;validate&quot;)" class="string">&quot;validate&quot;</span>,
       <span title="java.lang.String(&quot;values&quot;)" class="string">&quot;values&quot;</span>,
       <span title="java.lang.String(&quot;varchar&quot;)" class="string">&quot;varchar&quot;</span>,
       <span title="java.lang.String(&quot;varchar2&quot;)" class="string">&quot;varchar2&quot;</span>,
       <span title="java.lang.String(&quot;variance&quot;)" class="string">&quot;variance&quot;</span>,
       <span title="java.lang.String(&quot;view&quot;)" class="string">&quot;view&quot;</span>,
       <span title="java.lang.String(&quot;views&quot;)" class="string">&quot;views&quot;</span>,
       <span title="java.lang.String(&quot;when&quot;)" class="string">&quot;when&quot;</span>,
       <span title="java.lang.String(&quot;whenever&quot;)" class="string">&quot;whenever&quot;</span>,
       <span title="java.lang.String(&quot;where&quot;)" class="string">&quot;where&quot;</span>,
       <span title="java.lang.String(&quot;while&quot;)" class="string">&quot;while&quot;</span>,
       <span title="java.lang.String(&quot;with&quot;)" class="string">&quot;with&quot;</span>,
       <span title="java.lang.String(&quot;work&quot;)" class="string">&quot;work&quot;</span>,
       <span title="java.lang.String(&quot;write&quot;)" class="string">&quot;write&quot;</span>,
       <span title="java.lang.String(&quot;xor&quot;)" class="string">&quot;xor&quot;</span><span class="delimiter">)</span>
<span class="delimiter">}</span>

<span class="keyword">class</span> <a title="class SuperConnection extends java.lang.Object with ScalaObject" id="10908">SuperConnection</a><a href="#10908" title="ScalaObject" class="delimiter">(</a><span class="keyword">val</span> <a title="java.sql.Connection" id="62095">connection</a>: <span title="java.sql.Connection">Connection</span>, <span class="keyword">val</span> <a title="() =&gt; Unit" id="62096">releaseFunc</a>: <span class="delimiter">(</span><span class="delimiter">)</span> =&gt; Unit, <span class="keyword">val</span> <a title="net.liftweb.common.Box[String]" id="62097">schemaName</a>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[String]">Box</a><span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span>
  <span class="keyword">def</span> <a title="(c: java.sql.Connection, rf: () =&gt; Unit)net.liftweb.db.SuperConnection" id="60068" class="keyword">this</a><span class="delimiter">(</span><a title="java.sql.Connection" id="62093">c</a>: <span title="java.sql.Connection">Connection</span>, <a title="() =&gt; Unit" id="62094">rf</a>: <span class="delimiter">(</span><span class="delimiter">)</span> =&gt; Unit<span class="delimiter">)</span> = <a href="#10908" title="SuperConnection.this.type" class="keyword">this</a> <span class="delimiter">(</span><a href="#62093" title="java.sql.Connection">c</a>, <a href="#62094" title="() =&gt; Unit">rf</a>, <a href="../../../../common/net/liftweb/common/Box.scala.html#10581" title="object net.liftweb.common.Empty">Empty</a><span class="delimiter">)</span>

  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="Boolean" id="60070">brokenLimit_?</a> = <a href="#60073" title="=&gt; net.liftweb.db.DriverType">driverType</a>.<a href="Driver.scala.html#66517" title="=&gt; Boolean">brokenLimit_?</a>

  <span class="keyword">def</span> <a title="=&gt; String" id="60071">createTablePostpend</a>: <span title="String">String</span> = <a href="#60073" title="=&gt; net.liftweb.db.DriverType">driverType</a>.<a href="Driver.scala.html#66516" title="=&gt; String">createTablePostpend</a>

  <span class="keyword">def</span> <a title="=&gt; Boolean" id="60072">supportsForeignKeys_?</a> : <span title="Boolean">Boolean</span> = <a href="#60073" title="=&gt; net.liftweb.db.DriverType">driverType</a>.<a href="Driver.scala.html#66514" title="=&gt; Boolean">supportsForeignKeys_?</a>

  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="net.liftweb.db.DriverType" id="60074">driverType</a>: <a href="Driver.scala.html#10921" title="net.liftweb.db.DriverType">DriverType</a> = <a href="Driver.scala.html#10922" title="object net.liftweb.db.DriverType">DriverType</a>.<a href="Driver.scala.html#66875" title="(v1: java.sql.Connection)net.liftweb.db.DriverType">calcDriver</a><span class="delimiter">(</span><a href="#62095" title="=&gt; java.sql.Connection">connection</a><span class="delimiter">)</span>

  <span class="keyword">lazy</span> <span class="keyword">val</span> <a title="java.sql.DatabaseMetaData" id="60076">metaData</a> = <a href="#62095" title="=&gt; java.sql.Connection">connection</a>.<span title="()java.sql.DatabaseMetaData">getMetaData</span>
<span class="delimiter">}</span>

<span class="keyword">object</span> <a title="object net.liftweb.db.SuperConnection" id="10909">SuperConnection</a> <span title="ScalaObject" class="delimiter">{</span>
  <span class="keyword">implicit</span> <span class="keyword">def</span> <a title="implicit net.liftweb.db.SuperConnection.superToConn : (in: net.liftweb.db.SuperConnection)java.sql.Connection" id="62644">superToConn</a><span class="delimiter">(</span><a title="net.liftweb.db.SuperConnection" id="62645">in</a>: <a href="#10908" title="net.liftweb.db.SuperConnection">SuperConnection</a><span class="delimiter">)</span>: <span title="java.sql.Connection">Connection</span> = <a href="#62645" title="net.liftweb.db.SuperConnection">in</a>.<a href="#62095" title="=&gt; java.sql.Connection">connection</a>
<span class="delimiter">}</span>

<span class="keyword">trait</span> <a title="trait ConnectionIdentifier extends java.lang.Object with ScalaObject" id="10911">ConnectionIdentifier</a> <span title="ScalaObject" class="delimiter">{</span>
  <span class="keyword">def</span> <a title="=&gt; String" id="60050">jndiName</a>: <span title="String">String</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="()java.lang.String" id="60051">toString</a><span class="delimiter">(</span><span class="delimiter">)</span> = <span title="java.lang.String(&quot;ConnectionIdentifier(&quot;)" class="string">&quot;ConnectionIdentifier(&quot;</span> <span title="(x$1: Any)java.lang.String">+</span> <a href="#60050" title="=&gt; String">jndiName</a> <span title="(x$1: Any)java.lang.String">+</span> <span title="java.lang.String(&quot;)&quot;)" class="string">&quot;)&quot;</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="()Int" id="60052">hashCode</a><span class="delimiter">(</span><span class="delimiter">)</span> = <a href="#60050" title="=&gt; String">jndiName</a>.<span title="()Int">hashCode</span><span class="delimiter">(</span><span class="delimiter">)</span>

  <span class="keyword">override</span> <span class="keyword">def</span> <a title="(other: Any)Boolean" id="60053">equals</a><span class="delimiter">(</span><a title="Any" id="66888">other</a>: <span title="Any">Any</span><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> = <a href="#66888" title="Any">other</a> <span title="Boolean" class="keyword">match</span> <span class="delimiter">{</span>
    <span class="keyword">case</span> <a title="Boolean" id="66890">ci</a>: <a href="#10911" title="net.liftweb.db.ConnectionIdentifier">ConnectionIdentifier</a> =&gt; <a href="#66890" title="net.liftweb.db.ConnectionIdentifier">ci</a>.<a href="#60050" title="=&gt; String">jndiName</a> <span title="(x$1: AnyRef)Boolean">==</span> <a href="#10911" title="ConnectionIdentifier.this.type" class="keyword">this</a>.<a href="#60050" title="=&gt; String">jndiName</a>
    <span class="keyword">case</span> <span title="Boolean(false)">_</span> =&gt; <span title="Boolean(false)" class="keyword">false</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

case <span class="keyword">object</span> <a href="#66901" title="object net.liftweb.db.DefaultConnectionIdentifier" id="66906">DefaultConnectionIdentifier</a> <span title="ScalaObject" class="keyword">extends</span> <a href="#10911" title="net.liftweb.db.ConnectionIdentifier">ConnectionIdentifier</a> <span class="delimiter">{</span>
  <span class="keyword">var</span> <a title="java.lang.String" id="61703">jndiName</a> = <span title="java.lang.String(&quot;lift&quot;)" class="string">&quot;lift&quot;</span>
<span class="delimiter">}</span>


<span class="comment">/**
 * The standard DB vendor.
 * @param driverName the name of the database driver
 * @param dbUrl the URL for the JDBC data connection
 * @param dbUser the optional username
 * @param dbPassword the optional db password
 */</span>
<span class="keyword">class</span> <a title="class StandardDBVendor extends java.lang.Object with net.liftweb.db.ProtoDBVendor with ScalaObject" id="10914">StandardDBVendor</a><a href="#10914" title="ScalaObject" class="delimiter">(</a><a title="String" id="66957">driverName</a>: <span title="String">String</span>,
                       <a title="String" id="66958">dbUrl</a>: <span title="String">String</span>,
                       <a title="net.liftweb.common.Box[String]" id="66959">dbUser</a>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[String]">Box</a><span class="delimiter">[</span>String<span class="delimiter">]</span>,
                       <a title="net.liftweb.common.Box[String]" id="66960">dbPassword</a>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[String]">Box</a><span class="delimiter">[</span>String<span class="delimiter">]</span><span class="delimiter">)</span> <span class="keyword">extends</span> <a href="#10915" title="net.liftweb.db.ProtoDBVendor">ProtoDBVendor</a> <span class="delimiter">{</span>

  <span class="keyword">private</span> <span class="keyword">val</span> <a title="net.liftweb.common.Logger" id="66938">logger</a> = <a href="../../../../common/net/liftweb/common/Logging.scala.html#31889" title="(cls: Class[_])net.liftweb.common.Logger">Logger</a><span class="delimiter">(</span>classOf<span title="java.lang.Class[net.liftweb.db.StandardDBVendor](classOf[net.liftweb.db.StandardDBVendor])" class="delimiter">[</span>StandardDBVendor<span class="delimiter">]</span><span class="delimiter">)</span>

  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="=&gt; net.liftweb.common.Box[java.sql.Connection]" id="66940">createOne</a>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[java.sql.Connection]">Box</a><span class="delimiter">[</span>Connection<span class="delimiter">]</span> =  <span class="delimiter">{</span>
    <a href="../../../../util/net/liftweb/util/ControlHelpers.scala.html#48611" title="(onError: Throwable =&gt; Unit)(f: =&gt; Unit)net.liftweb.common.Box[Unit]">tryo</a><span class="delimiter">{</span>t:<span title="Throwable">Throwable</span> =&gt; <a href="#66938" title="=&gt; net.liftweb.common.Logger">logger</a>.<a href="../../../../common/net/liftweb/common/Logging.scala.html#31961" title="(msg: =&gt; AnyRef, t: Throwable)Unit">error</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;Cannot load database driver: %s&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#66957" title="String">driverName</a><span class="delimiter">)</span>, <a href="#67076" title="Throwable">t</a><span class="delimiter">)</span><span class="delimiter">}</span><span class="delimiter">{</span><span title="object java.lang.Class">Class</span>.<span title="(x$1: java.lang.String)java.lang.Class[_]">forName</span><span class="delimiter">(</span><a href="#66957" title="String">driverName</a><span class="delimiter">)</span>;<span title="Unit" class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">}</span>

    <span title="(_1: net.liftweb.common.Box[String], _2: net.liftweb.common.Box[String])(net.liftweb.common.Box[String], net.liftweb.common.Box[String])" class="delimiter">(</span><a href="#66959" title="net.liftweb.common.Box[String]">dbUser</a>, <a href="#66960" title="net.liftweb.common.Box[String]">dbPassword</a><span class="delimiter">)</span> <span title="net.liftweb.common.Box[java.sql.Connection]" class="keyword">match</span> <span class="delimiter">{</span>
      <span class="keyword">case</span> <span title="net.liftweb.common.Box[java.sql.Connection]" class="delimiter">(</span>Full<span class="delimiter">(</span><a title="String" id="67123">user</a><span class="delimiter">)</span>, Full<span class="delimiter">(</span><a title="String" id="67125">pwd</a><span class="delimiter">)</span><span class="delimiter">)</span> =&gt;
        <a href="../../../../util/net/liftweb/util/ControlHelpers.scala.html#48611" title="(onError: Throwable =&gt; Unit)(f: =&gt; java.sql.Connection)net.liftweb.common.Box[java.sql.Connection]">tryo</a><span class="delimiter">{</span>t:<span title="Throwable">Throwable</span> =&gt; <a href="#66938" title="=&gt; net.liftweb.common.Logger">logger</a>.<a href="../../../../common/net/liftweb/common/Logging.scala.html#31961" title="(msg: =&gt; AnyRef, t: Throwable)Unit">error</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;Unable to get database connection. url=%s, user=%s&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#66958" title="String">dbUrl</a>, <a href="#67123" title="String">user</a><span class="delimiter">)</span>,<a href="#67237" title="Throwable">t</a><span class="delimiter">)</span><span class="delimiter">}</span><span class="delimiter">(</span><span title="object java.sql.DriverManager">DriverManager</span>.<span title="(x$1: java.lang.String, x$2: java.lang.String, x$3: java.lang.String)java.sql.Connection">getConnection</span><span class="delimiter">(</span><a href="#66958" title="String">dbUrl</a>, <a href="#67123" title="String">user</a>, <a href="#67125" title="String">pwd</a><span class="delimiter">)</span><span class="delimiter">)</span>
      <span class="keyword">case</span> <span title="net.liftweb.common.Box[java.sql.Connection]">_</span> =&gt;
        <a href="../../../../util/net/liftweb/util/ControlHelpers.scala.html#48611" title="(onError: Throwable =&gt; Unit)(f: =&gt; java.sql.Connection)net.liftweb.common.Box[java.sql.Connection]">tryo</a><span class="delimiter">{</span>t:<span title="Throwable">Throwable</span> =&gt; <a href="#66938" title="=&gt; net.liftweb.common.Logger">logger</a>.<a href="../../../../common/net/liftweb/common/Logging.scala.html#31961" title="(msg: =&gt; AnyRef, t: Throwable)Unit">error</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;Unable to get database connection. url=%s&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#66958" title="String">dbUrl</a><span class="delimiter">)</span>,<a href="#67415" title="Throwable">t</a><span class="delimiter">)</span><span class="delimiter">}</span><span class="delimiter">(</span><span title="object java.sql.DriverManager">DriverManager</span>.<span title="(x$1: java.lang.String)java.sql.Connection">getConnection</span><span class="delimiter">(</span><a href="#66958" title="String">dbUrl</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

<span class="keyword">trait</span> <a title="trait ProtoDBVendor extends java.lang.Object with net.liftweb.db.ConnectionManager with ScalaObject" id="10915">ProtoDBVendor</a> <span title="ScalaObject" class="keyword">extends</span> <a href="ConnectionManager.scala.html#10890" title="net.liftweb.db.ConnectionManager">ConnectionManager</a> <span class="delimiter">{</span>
  <span class="keyword">private</span> <span class="keyword">val</span> <a title="net.liftweb.common.Logger" id="66908">logger</a> = <a href="../../../../common/net/liftweb/common/Logging.scala.html#31889" title="(cls: Class[_])net.liftweb.common.Logger">Logger</a><span class="delimiter">(</span>classOf<span title="java.lang.Class[net.liftweb.db.ProtoDBVendor](classOf[net.liftweb.db.ProtoDBVendor])" class="delimiter">[</span>ProtoDBVendor<span class="delimiter">]</span><span class="delimiter">)</span>
  <span class="keyword">private</span> <span class="keyword">var</span> <a title="List[java.sql.Connection]" id="66911">pool</a>: <span title="List[java.sql.Connection]">List</span><span class="delimiter">[</span>Connection<span class="delimiter">]</span> = <span title="object Nil">Nil</span>
  <span class="keyword">private</span> <span class="keyword">var</span> <a title="Int" id="66914">poolSize</a> = <span title="Int(0)" class="int">0</span>
  <span class="keyword">private</span> <span class="keyword">var</span> <a title="Int" id="66917">tempMaxSize</a> = <a href="#66920" title="=&gt; Int">maxPoolSize</a>

  <span class="comment">/**
   * Override and set to false if the maximum pool size can temporarilly be expanded to avoid pool starvation
   */</span>
  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="=&gt; Boolean" id="66919">allowTemporaryPoolExpansion</a> = <span title="Boolean(true)" class="keyword">true</span>

  <span class="comment">/**
   *  Override this method if you want something other than
   * 4 connections in the pool
   */</span>
  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="=&gt; Int" id="66920">maxPoolSize</a> = <span title="Int(4)" class="int">4</span>

  <span class="comment">/**
   * The absolute maximum that this pool can extend to
   * The default is 20.  Override this method to change.
   */</span>
  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="=&gt; Int" id="66921">doNotExpandBeyond</a> = <span title="Int(20)" class="int">20</span>

  <span class="comment">/**
   * The logic for whether we can expand the pool beyond the current size.  By
   * default, the logic tests allowTemporaryPoolExpansion &amp;amp;&amp;amp; poolSize &amp;lt;= doNotExpandBeyond
   */</span>
  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="=&gt; Boolean" id="66922">canExpand_?</a> : <span title="Boolean">Boolean</span> = <a href="#66919" title="=&gt; Boolean">allowTemporaryPoolExpansion</a> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#66914" title="=&gt; Int">poolSize</a> <span title="(x: Int)Boolean">&lt;=</span> <a href="#66921" title="=&gt; Int">doNotExpandBeyond</a>

  <span class="comment">/**
   *   How is a connection created?
   */</span>
  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="=&gt; net.liftweb.common.Box[java.sql.Connection]" id="66923">createOne</a>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[java.sql.Connection]">Box</a><span class="delimiter">[</span>Connection<span class="delimiter">]</span>

  <span class="comment">/**
   * Test the connection.  By default, setAutoCommit(false),
   * but you can do a real query on your RDBMS to see if the connection is alive
   */</span>
  <span class="keyword">protected</span> <span class="keyword">def</span> <a title="(conn: java.sql.Connection)Unit" id="66924">testConnection</a><span class="delimiter">(</span><a title="java.sql.Connection" id="67483">conn</a>: <span title="java.sql.Connection">Connection</span><span class="delimiter">)</span> <span class="delimiter">{</span>
    <a href="#67483" title="java.sql.Connection">conn</a>.<span title="(x$1: Boolean)Unit">setAutoCommit</span><span class="delimiter">(</span><span title="Boolean(false)" class="keyword">false</span><span class="delimiter">)</span>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(name: net.liftweb.db.ConnectionIdentifier)net.liftweb.common.Box[java.sql.Connection]" id="66925">newConnection</a><span class="delimiter">(</span><a title="net.liftweb.db.ConnectionIdentifier" id="67485">name</a>: <a href="#10911" title="net.liftweb.db.ConnectionIdentifier">ConnectionIdentifier</a><span class="delimiter">)</span>: <a href="../../../../common/net/liftweb/common/Box.scala.html#10575" title="net.liftweb.common.Box[java.sql.Connection]">Box</a><span class="delimiter">[</span>Connection<span class="delimiter">]</span> =
    <a href="#10915" title="(x$1: net.liftweb.common.Box[java.sql.Connection])net.liftweb.common.Box[java.sql.Connection]">synchronized</a> <span class="delimiter">{</span>
      <a href="#66911" title="=&gt; List[java.sql.Connection]">pool</a> <span title="net.liftweb.common.Box[java.sql.Connection]" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <span title="net.liftweb.common.Box[java.sql.Connection]">Nil</span> <span class="keyword">if</span> <a href="#66914" title="=&gt; Int">poolSize</a> <span title="(x: Int)Boolean">&lt;</span> <a href="#66917" title="=&gt; Int">tempMaxSize</a> =&gt;
          <span class="keyword">val</span> <a title="net.liftweb.common.Box[java.sql.Connection]" id="67493">ret</a> = <a href="#66923" title="=&gt; net.liftweb.common.Box[java.sql.Connection]">createOne</a>
          <a href="#67493" title="net.liftweb.common.Box[java.sql.Connection]">ret</a>.<a href="../../../../common/net/liftweb/common/Box.scala.html#27031" title="(f: java.sql.Connection =&gt; Unit)Unit">foreach</a><span class="delimiter">(</span><a href="#67498" title="java.sql.Connection">_</a>.<span title="(x$1: Boolean)Unit">setAutoCommit</span><span class="delimiter">(</span><span title="Boolean(false)" class="keyword">false</span><span class="delimiter">)</span><span class="delimiter">)</span>
          <a href="#66914" title="(x$1: Int)Unit">poolSize</a> = <a href="#66914" title="=&gt; Int">poolSize</a> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span>
          <a href="#66908" title="=&gt; net.liftweb.common.Logger">logger</a>.<a href="../../../../common/net/liftweb/common/Logging.scala.html#31942" title="(msg: =&gt; AnyRef)Unit">debug</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;Created new pool entry. name=%s, poolSize=%d&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#67485" title="net.liftweb.db.ConnectionIdentifier">name</a>, <a href="#66914" title="=&gt; Int">poolSize</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <a href="#67493" title="net.liftweb.common.Box[java.sql.Connection]">ret</a>

        <span class="keyword">case</span> <span title="net.liftweb.common.Box[java.sql.Connection]">Nil</span> =&gt;
          <span class="keyword">val</span> <a title="Int" id="67509">curSize</a> = <a href="#66914" title="=&gt; Int">poolSize</a>
          <a href="#66908" title="=&gt; net.liftweb.common.Logger">logger</a>.<a href="../../../../common/net/liftweb/common/Logging.scala.html#31936" title="(msg: =&gt; AnyRef)Unit">trace</a><span class="delimiter">(</span><span title="java.lang.String(&quot;No connection left in pool, waiting...&quot;)" class="string">&quot;No connection left in pool, waiting...&quot;</span><span class="delimiter">)</span>
          <a href="#10915" title="(x$1: Long)Unit">wait</a><span class="delimiter">(</span><span title="Long(50L)" class="long">50L</span><span class="delimiter">)</span>
          <span class="comment">// if we've waited 50 ms and the pool is still empty, temporarily expand it</span>
          <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#66911" title="=&gt; List[java.sql.Connection]">pool</a>.<span title="=&gt; Boolean">isEmpty</span> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#66914" title="=&gt; Int">poolSize</a> <span title="(x: Int)Boolean">==</span> <a href="#67509" title="Int">curSize</a> <span title="(x: Boolean)Boolean">&amp;&amp;</span> <a href="#66922" title="=&gt; Boolean">canExpand_?</a><span class="delimiter">)</span> <span class="delimiter">{</span>
            <a href="#66917" title="(x$1: Int)Unit">tempMaxSize</a> <span title="(x: Int)Int">+=</span> <span title="Int(1)" class="int">1</span>
            <a href="#66908" title="=&gt; net.liftweb.common.Logger">logger</a>.<a href="../../../../common/net/liftweb/common/Logging.scala.html#31942" title="(msg: =&gt; AnyRef)Unit">debug</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;Temporarily expanding pool. name=%s, tempMaxSize=%d&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#67485" title="net.liftweb.db.ConnectionIdentifier">name</a>, <a href="#66917" title="=&gt; Int">tempMaxSize</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <span class="delimiter">}</span>
          <a href="#66925" title="(name: net.liftweb.db.ConnectionIdentifier)net.liftweb.common.Box[java.sql.Connection]">newConnection</a><span class="delimiter">(</span><a href="#67485" title="net.liftweb.db.ConnectionIdentifier">name</a><span class="delimiter">)</span>

        <span class="keyword">case</span> <a title="net.liftweb.common.Box[java.sql.Connection]" id="67542">x</a> :: <a title="List[java.sql.Connection]" id="67543">xs</a> =&gt;
          <a href="#66908" title="=&gt; net.liftweb.common.Logger">logger</a>.<a href="../../../../common/net/liftweb/common/Logging.scala.html#31936" title="(msg: =&gt; AnyRef)Unit">trace</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;Found connection in pool, name=%s&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#67485" title="net.liftweb.db.ConnectionIdentifier">name</a><span class="delimiter">)</span><span class="delimiter">)</span>
          <a href="#66911" title="(x$1: List[java.sql.Connection])Unit">pool</a> = <a href="#67543" title="List[java.sql.Connection]">xs</a>
          <span class="keyword">try</span> <span class="delimiter">{</span>
            <a href="#10915" title="ProtoDBVendor.this.type" class="keyword">this</a>.<a href="#66924" title="(conn: java.sql.Connection)Unit">testConnection</a><span class="delimiter">(</span><a href="#67542" title="java.sql.Connection">x</a><span class="delimiter">)</span>
            <a href="../../../../common/net/liftweb/common/Box.scala.html#27086" title="(value: java.sql.Connection)net.liftweb.common.Full[java.sql.Connection]">Full</a><span class="delimiter">(</span><a href="#67542" title="java.sql.Connection">x</a><span class="delimiter">)</span>
          <span class="delimiter">}</span> <span class="keyword">catch</span> <span class="delimiter">{</span>
            <span class="keyword">case</span> <a title="net.liftweb.common.Box[java.sql.Connection]" id="67555">e</a> =&gt; <span class="keyword">try</span> <span class="delimiter">{</span>
              <a href="#66908" title="=&gt; net.liftweb.common.Logger">logger</a>.<a href="../../../../common/net/liftweb/common/Logging.scala.html#31942" title="(msg: =&gt; AnyRef)Unit">debug</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;Test connection failed, removing connection from pool, name=%s&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#67485" title="net.liftweb.db.ConnectionIdentifier">name</a><span class="delimiter">)</span><span class="delimiter">)</span>
              <a href="#66914" title="(x$1: Int)Unit">poolSize</a> = <a href="#66914" title="=&gt; Int">poolSize</a> <span title="(x: Int)Int">-</span> <span title="Int(1)" class="int">1</span>
              <a href="../../../../util/net/liftweb/util/ControlHelpers.scala.html#48608" title="(f: =&gt; Unit)net.liftweb.common.Box[Unit]">tryo</a><span class="delimiter">(</span><a href="#67542" title="java.sql.Connection">x</a>.<span title="()Unit">close</span><span class="delimiter">)</span>
              <a href="#66925" title="(name: net.liftweb.db.ConnectionIdentifier)net.liftweb.common.Box[java.sql.Connection]">newConnection</a><span class="delimiter">(</span><a href="#67485" title="net.liftweb.db.ConnectionIdentifier">name</a><span class="delimiter">)</span>
            <span class="delimiter">}</span> <span class="keyword">catch</span> <span class="delimiter">{</span>
              <span class="keyword">case</span> <a title="net.liftweb.common.Box[java.sql.Connection]" id="67604">e</a> =&gt; <a href="#66925" title="(name: net.liftweb.db.ConnectionIdentifier)net.liftweb.common.Box[java.sql.Connection]">newConnection</a><span class="delimiter">(</span><a href="#67485" title="net.liftweb.db.ConnectionIdentifier">name</a><span class="delimiter">)</span>
            <span class="delimiter">}</span>
          <span class="delimiter">}</span>
      <span class="delimiter">}</span>
    <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="(conn: java.sql.Connection)Unit" id="66926">releaseConnection</a><span class="delimiter">(</span><a title="java.sql.Connection" id="67606">conn</a>: <span title="java.sql.Connection">Connection</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <a href="#10915" title="(x$1: Unit)Unit">synchronized</a> <span class="delimiter">{</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#66917" title="=&gt; Int">tempMaxSize</a> <span title="(x: Int)Boolean">&gt;</span> <a href="#66920" title="=&gt; Int">maxPoolSize</a><span class="delimiter">)</span> <span class="delimiter">{</span>
      <a href="../../../../util/net/liftweb/util/ControlHelpers.scala.html#48608" title="(f: =&gt; Unit)net.liftweb.common.Box[Unit]">tryo</a> <span class="delimiter">{</span><a href="#67606" title="java.sql.Connection">conn</a>.<span title="()Unit">close</span><span class="delimiter">(</span><span class="delimiter">)</span><span class="delimiter">}</span>
      <a href="#66917" title="(x$1: Int)Unit">tempMaxSize</a> <span title="(x: Int)Int">-=</span> <span title="Int(1)" class="int">1</span>
      <a href="#66914" title="(x$1: Int)Unit">poolSize</a> <span title="(x: Int)Int">-=</span> <span title="Int(1)" class="int">1</span>
    <span class="delimiter">}</span> <span class="keyword">else</span> <span class="delimiter">{</span>
      <a href="#66911" title="(x$1: List[java.sql.Connection])Unit">pool</a> = <a href="#67606" title="java.sql.Connection">conn</a> <a href="#67663" title="(x: java.sql.Connection)List[java.sql.Connection]">::</a> <a href="#66911" title="=&gt; List[java.sql.Connection]">pool</a>
    <span class="delimiter">}</span>
    <a href="#66908" title="=&gt; net.liftweb.common.Logger">logger</a>.<a href="../../../../common/net/liftweb/common/Logging.scala.html#31942" title="(msg: =&gt; AnyRef)Unit">debug</a><span class="delimiter">(</span><span title="implicit scala.Predef.augmentString : (x: String)scala.collection.immutable.StringOps" class="string">&quot;Released connection. poolSize=%d&quot;</span>.<span title="(args: Any*)String">format</span><span class="delimiter">(</span><a href="#66914" title="=&gt; Int">poolSize</a><span class="delimiter">)</span><span class="delimiter">)</span>
    <a href="#10915" title="()Unit">notifyAll</a>
  <span class="delimiter">}</span>

  <span class="keyword">def</span> <a title="()Unit" id="66927">closeAllConnections_!</a><span class="delimiter">(</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <a href="#66928" title="(cnt: Int)Unit">_closeAllConnections_!</a><span class="delimiter">(</span><span title="Int(0)" class="int">0</span><span class="delimiter">)</span>


  <span class="keyword">private</span> <span class="keyword">def</span> <a title="(cnt: Int)Unit" id="66928">_closeAllConnections_!</a><span class="delimiter">(</span><a title="Int" id="67676">cnt</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <span title="Unit">Unit</span> = <a href="#10915" title="(x$1: Unit)Unit">synchronized</a> <span class="delimiter">{</span>
    <a href="#66908" title="=&gt; net.liftweb.common.Logger">logger</a>.<a href="../../../../common/net/liftweb/common/Logging.scala.html#31948" title="(msg: =&gt; AnyRef)Unit">info</a><span class="delimiter">(</span><span title="java.lang.String(&quot;Closing all connections&quot;)" class="string">&quot;Closing all connections&quot;</span><span class="delimiter">)</span>
    <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#66914" title="=&gt; Int">poolSize</a> <span title="(x: Int)Boolean">&lt;=</span> <span title="Int(0)" class="int">0</span> <span title="(x: Boolean)Boolean">||</span> <a href="#67676" title="Int">cnt</a> <span title="(x: Int)Boolean">&gt;</span> <span title="Int(10)" class="int">10</span><span class="delimiter">)</span> <span title="Unit" class="delimiter">(</span><span class="delimiter">)</span>
    <span class="keyword">else</span> <span class="delimiter">{</span>
      <a href="#66911" title="=&gt; List[java.sql.Connection]">pool</a>.<span title="(f: java.sql.Connection =&gt; Unit)Unit">foreach</span> <span class="delimiter">{</span><a title="java.sql.Connection" id="67711">c</a> =&gt; <a href="../../../../util/net/liftweb/util/ControlHelpers.scala.html#48608" title="(f: =&gt; Unit)net.liftweb.common.Box[Unit]">tryo</a><span class="delimiter">(</span><a href="#67711" title="java.sql.Connection">c</a>.<span title="()Unit">close</span><span class="delimiter">)</span>; <a href="#66914" title="(x$1: Int)Unit">poolSize</a> <span title="(x: Int)Int">-=</span> <span title="Int(1)" class="int">1</span><span class="delimiter">}</span>
      <a href="#66911" title="(x$1: List[java.sql.Connection])Unit">pool</a> = <span title="object Nil">Nil</span>

      <span title="Unit" class="keyword">if</span> <span class="delimiter">(</span><a href="#66914" title="=&gt; Int">poolSize</a> <span title="(x: Int)Boolean">&gt;</span> <span title="Int(0)" class="int">0</span><span class="delimiter">)</span> <a href="#10915" title="(x$1: Long)Unit">wait</a><span class="delimiter">(</span><span title="Long(250L)" class="int">250</span><span class="delimiter">)</span>

      <a href="#66928" title="(cnt: Int)Unit">_closeAllConnections_!</a><span class="delimiter">(</span><a href="#67676" title="Int">cnt</a> <span title="(x: Int)Int">+</span> <span title="Int(1)" class="int">1</span><span class="delimiter">)</span>
    <span class="delimiter">}</span>
  <span class="delimiter">}</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>