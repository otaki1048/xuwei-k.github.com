<?xml version="1.0" encoding="utf-8"?>
      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" ></meta>
        <meta http-equiv="Expires" content="0" />
        <title>com/github/okomok/ken/World.scala</title>
        <script type="text/javascript" src="../../../../jquery-all.js"></script>
        <script type="text/javascript" src="../../../../linked.js"></script>
        <link rel="stylesheet" type="text/css" href="../../../../style.css" title="Style"></link>
    </head>
    <body>
        <pre>


<span class="comment">// Copyright Shunsuke Sogame 2011.</span>
<span class="comment">//</span>
<span class="comment">// Copyright 2004, The University Court of the University of Glasgow.</span>
<span class="comment">// All rights reserved.</span>
<span class="comment">//</span>
<span class="comment">// Copyright (c) 2002 Simon Peyton Jones</span>
<span class="comment">//</span>
<span class="comment">// Distributed under the New BSD license.</span>


<span class="keyword">package</span> com.github.okomok
<span class="keyword">package</span> ken


<span class="keyword">import</span> scala.collection.mutable.ArraySeq


<span class="keyword">class</span> <a title="class World extends java.lang.Object with ScalaObject" id="10627">World</a> <a href="#10627" title="ScalaObject" class="delimiter">{</a> world =&gt;
    <span class="keyword">type</span> <a title="World.this.type" id="31668">This</a> = <span class="keyword">this</span>.<span class="keyword">type</span> <span class="comment">// makes other's `ST` incompatible.</span>

    <span class="comment">// ST</span>
    <span class="comment">//</span>
    <span class="keyword">type</span> <a title="[+a]com.github.okomok.ken.package.State[World.this.This,a]" id="31669">ST</a><span class="delimiter">[</span>+<a title="&gt;: Nothing &lt;: Any" id="31670">a</a><span class="delimiter">]</span> = <a href="StateT.scala.html#10491" title="com.github.okomok.ken.package.State[World.this.This,a]">State</a><span class="delimiter">[</span>This, a<span class="delimiter">]</span>

    <span class="keyword">object</span> <a title="object World.this.ST" id="31671">ST</a> <span title="ScalaObject" class="keyword">extends</span> <a href="MonadState.scala.html#10174" title="com.github.okomok.ken.MonadStateProxy[World.this.This,World.this.ST]">MonadStateProxy</a><span class="delimiter">[</span>This, ST<span class="delimiter">]</span> <span class="delimiter">{</span>
        <span class="keyword">override</span> <span class="keyword">val</span> <a title="com.github.okomok.ken.MonadState[World.this.This,World.this.ST]" id="161213">selfMonadState</a> = <a href="package.scala.html#11193" title="[a](implicit i: a)a">instance</a><a href="StateT.scala.html#166578" title="(implicit i: com.github.okomok.ken.MonadState[World.this.This,World.this.ST])com.github.okomok.ken.MonadState[World.this.This,World.this.ST]" class="delimiter">[</a><a href="MonadState.scala.html#10171" title="com.github.okomok.ken.MonadState[World.this.This,World.this.ST]">MonadState</a><span class="delimiter">[</span>This, ST<span class="delimiter">]</span><span class="delimiter">]</span>

        <span class="keyword">def</span> <a title="[a](run: World.this.This =&gt; (a, World.this.This))World.this.ST[a]" id="161215">apply</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="161217">a</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="World.this.This =&gt; (a, World.this.This)" id="161263">run</a>: This =&gt; <span class="delimiter">(</span>a, This<span class="delimiter">)</span><span class="delimiter">)</span>: <a href="StateT.scala.html#10491" title="World.this.ST[a]">ST</a><span class="delimiter">[</span>a<span class="delimiter">]</span> = <a href="State.scala.html#166485" title="(n: World.this.This =&gt; (a, World.this.This))com.github.okomok.ken.package.State[World.this.This,a]">State</a><span class="delimiter">(</span><a href="#161263" title="World.this.This =&gt; (a, World.this.This)">run</a><span class="delimiter">)</span>
        <span class="keyword">def</span> <a title="[a](st: World.this.ST[a])Option[World.this.This =&gt; (a, World.this.This)]" id="161218">unapply</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="161220">a</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="World.this.ST[a]" id="161224">st</a>: <a href="StateT.scala.html#10491" title="World.this.ST[a]">ST</a><span class="delimiter">[</span>a<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="Option[World.this.This =&gt; (a, World.this.This)]">Option</span><span class="delimiter">[</span>This =&gt; <span class="delimiter">(</span>a, This<span class="delimiter">)</span><span class="delimiter">]</span> = <span title="(x: World.this.This =&gt; (a, World.this.This))Some[World.this.This =&gt; (a, World.this.This)]">Some</span><span class="delimiter">(</span><a href="#161224" title="World.this.ST[a]">st</a>.<a href="NewtypeOf.scala.html#29935" title="=&gt; World.this.This =&gt; (a, World.this.This)">run</a><span class="delimiter">)</span>

        <span class="keyword">def</span> <a title="[a](st: World.this.ST[a])a" id="161221">run</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="161223">a</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="World.this.ST[a]" id="177755">st</a>: <a href="StateT.scala.html#10491" title="World.this.ST[a]">ST</a><span class="delimiter">[</span>a<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="#161223" title="a">a</a> = <a href="package.scala.html#11133" title="=&gt; com.github.okomok.ken._State.type">State</a>.<a href="StateT.scala.html#166448" title="(m: com.github.okomok.ken.StateT[World.this.This,com.github.okomok.ken.WeakIdentity.apply,a])(s: World.this.This)(implicit i: com.github.okomok.ken.Monad[com.github.okomok.ken.WeakIdentity.apply])com.github.okomok.ken.WeakIdentity.apply[a]">eval</a><span class="delimiter">(</span><a href="#177755" title="World.this.ST[a]">st</a><span class="delimiter">)</span><a href="Functor.scala.html#36418" title="=&gt; com.github.okomok.ken.MonadFix[com.github.okomok.ken.WeakIdentity.apply] with com.github.okomok.ken.Comonad[com.github.okomok.ken.WeakIdentity.apply]" class="delimiter">(</a><a href="#10627" title="World.this.type">world</a><span class="delimiter">)</span>
    <span class="delimiter">}</span>

    <span class="keyword">private</span><span class="delimiter">[</span><span class="keyword">this</span><span class="delimiter">]</span> <span class="keyword">def</span> <a title="[a](x: =&gt; a)World.this.ST[a]" id="31673">returnST</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="31675">a</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="=&gt; a" id="177817">x</a>: =&gt; a<span class="delimiter">)</span>: <a href="StateT.scala.html#10491" title="World.this.ST[a]">ST</a><span class="delimiter">[</span>a<span class="delimiter">]</span> = <a href="State.scala.html#166485" title="(n: World.this.This =&gt; (a, World.this.This))com.github.okomok.ken.package.State[World.this.This,a]">State</a> <span class="delimiter">{</span> <a title="World.this.This" id="177824">s</a> =&gt; <span title="(_1: a, _2: World.this.This)(a, World.this.This)" class="delimiter">(</span><a href="#177817" title="=&gt; a">x</a>, <a href="#177824" title="World.this.This">s</a><span class="delimiter">)</span> <span class="delimiter">}</span>

    <span class="comment">// Coercions between IO and ST</span>
    <span class="comment">//</span>
    <span class="keyword">def</span> <a title="[a](io: com.github.okomok.ken.IO[a])World.this.ST[a]" id="31676">unsafeIOToST</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="31678">a</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="com.github.okomok.ken.IO[a]" id="177832">io</a>: <a href="IO.scala.html#9887" title="com.github.okomok.ken.IO[a]">IO</a><span class="delimiter">[</span>a<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="StateT.scala.html#10491" title="World.this.ST[a]">ST</a><span class="delimiter">[</span>a<span class="delimiter">]</span> = <a href="#177832" title="com.github.okomok.ken.IO[a]">io</a> <span title="World.this.ST[a]" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <span title="World.this.ST[a]">IO</span><span class="delimiter">(</span><a title="com.github.okomok.ken.RealWorld.type =&gt; Product2[a,com.github.okomok.ken.RealWorld.type] with com.github.okomok.ken.Trampoline[a]" id="177837">m</a><span class="delimiter">)</span> =&gt; <a href="#161215" title="(run: World.this.This =&gt; (a, World.this.This))World.this.ST[a]">ST</a> <span class="delimiter">{</span> <a title="World.this.This" id="177841">s</a> =&gt;
            <a href="#177837" title="(v1: com.github.okomok.ken.RealWorld.type)Product2[a,com.github.okomok.ken.RealWorld.type] with com.github.okomok.ken.Trampoline[a]">m</a><span class="delimiter">(</span><a href="#177841" title="World.this.This">s</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="com.github.okomok.ken.RealWorld.type" class="delimiter">[</span>RealWorld.<span class="keyword">type</span><span class="delimiter">]</span><span class="delimiter">)</span> <span title="(a, World.this.This)" class="keyword">match</span> <span class="delimiter">{</span>
                <span class="keyword">case</span> <a href="Product2.scala.html#141388" title="(a, World.this.This)">Product2</a><span class="delimiter">(</span><a title="a" id="177852">a</a>, _<span class="delimiter">)</span> =&gt; <span title="(_1: a, _2: World.this.This)(a, World.this.This)" class="delimiter">(</span><a href="#177852" title="a">a</a>, <a href="#177841" title="World.this.This">s</a><span class="delimiter">)</span>
            <span class="delimiter">}</span>
        <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <span class="keyword">def</span> <a title="[a](st: World.this.ST[a])com.github.okomok.ken.IO[a]" id="31679">unsafeSTToIO</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="31681">a</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="World.this.ST[a]" id="177860">st</a>: <a href="StateT.scala.html#10491" title="World.this.ST[a]">ST</a><span class="delimiter">[</span>a<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="IO.scala.html#9887" title="com.github.okomok.ken.IO[a]">IO</a><span class="delimiter">[</span>a<span class="delimiter">]</span> = <a href="#177860" title="World.this.ST[a]">st</a> <span title="com.github.okomok.ken.IO[a]" class="keyword">match</span> <span class="delimiter">{</span>
        <span class="keyword">case</span> <a href="#161218" title="com.github.okomok.ken.IO[a]">ST</a><span class="delimiter">(</span><a title="World.this.This =&gt; (a, World.this.This)" id="177869">m</a><span class="delimiter">)</span> =&gt; <a href="IO.scala.html#58764" title="(old: com.github.okomok.ken.RealWorld.type =&gt; Product2[a,com.github.okomok.ken.RealWorld.type] with com.github.okomok.ken.Trampoline[a])com.github.okomok.ken.IO[a]">IO</a> <span class="delimiter">{</span> <a title="com.github.okomok.ken.RealWorld.type" id="177876">s</a> =&gt;
            <a href="#177869" title="(v1: World.this.This)(a, World.this.This)">m</a><span class="delimiter">(</span><a href="#177876" title="com.github.okomok.ken.RealWorld.type">s</a>.<span title="[T0]=&gt; T0">asInstanceOf</span><span title="World.this.This" class="delimiter">[</span><a href="#10627" title="World.this.This">This</a><span class="delimiter">]</span><span class="delimiter">)</span> <span title="package extends Product2[a,com.github.okomok.ken.RealWorld.type] with com.github.okomok.ken.Trampoline[a]" class="keyword">match</span> <span class="delimiter">{</span>
                <span class="keyword">case</span> <span title="IORep extends Product2[a,com.github.okomok.ken.RealWorld.type] with com.github.okomok.ken.Trampoline[a]" class="delimiter">(</span><a title="a" id="177880">a</a>, _<span class="delimiter">)</span> =&gt; <a href="IORep.scala.html#9900" title="object com.github.okomok.ken.IORep">IORep</a>.<a href="IORep.scala.html#81128" title="(a: a, s: com.github.okomok.ken.RealWorld.type)Product2[a,com.github.okomok.ken.RealWorld.type] with com.github.okomok.ken.Trampoline[a]">done</a><span class="delimiter">(</span><a href="#177880" title="a">a</a>, <a href="#177876" title="com.github.okomok.ken.RealWorld.type">s</a><span class="delimiter">)</span>
            <span class="delimiter">}</span>
        <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <span class="comment">// STRef</span>
    <span class="comment">//</span>
    <span class="keyword">sealed</span> <span class="keyword">class</span> <a title="class STRef[a] extends java.lang.Object with ScalaObject" id="31682">STRef</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="31683">a</a><span class="delimiter">]</span><a href="#31682" title="ScalaObject" class="delimiter">(</a><span class="keyword">private</span><span class="delimiter">[</span>World<span class="delimiter">]</span> <span class="keyword">var</span> <a title="a" id="161278">mutvar</a>: <a href="#31683" title="a">a</a><span class="delimiter">)</span>

    <span class="keyword">object</span> <a title="object World.this.STRef" id="31684">STRef</a> <span title="ScalaObject" class="delimiter">{</span>
        <span class="keyword">def</span> <a title="[a](init: a)World.this.ST[World.this.STRef[a]]" id="161283">`new`</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="161285">a</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="a" id="161300">init</a>: <a href="#161285" title="a">a</a><span class="delimiter">)</span>: <a href="StateT.scala.html#10491" title="World.this.ST[World.this.STRef[a]]">ST</a><span class="delimiter">[</span>STRef<span class="delimiter">[</span>a<span class="delimiter">]</span><span class="delimiter">]</span> = <a href="#31673" title="(x: =&gt; World.this.STRef[a])World.this.ST[World.this.STRef[a]]">returnST</a> <span class="delimiter">{</span> <span title="World.this.STRef[a]" class="keyword">new</span> <a href="#31682" title="World.this.STRef[a]">STRef</a><span class="delimiter">(</span><a href="#161300" title="a">init</a><span class="delimiter">)</span> <span class="delimiter">}</span>

        <span class="keyword">def</span> <a title="[a](ref: World.this.STRef[a])World.this.ST[a]" id="161286">read</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="161288">a</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="World.this.STRef[a]" id="161309">ref</a>: <a href="#31682" title="World.this.STRef[a]">STRef</a><span class="delimiter">[</span>a<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="StateT.scala.html#10491" title="World.this.ST[a]">ST</a><span class="delimiter">[</span>a<span class="delimiter">]</span> = <a href="#31673" title="(x: =&gt; a)World.this.ST[a]">returnST</a> <span class="delimiter">{</span> <a href="#161309" title="World.this.STRef[a]">ref</a>.<a href="#161278" title="=&gt; a">mutvar</a> <span class="delimiter">}</span>

        <span class="keyword">def</span> <a title="[a](ref: World.this.STRef[a])(v: a)World.this.ST[Unit]" id="161289">write</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="161291">a</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="World.this.STRef[a]" id="161319">ref</a>: <a href="#31682" title="World.this.STRef[a]">STRef</a><span class="delimiter">[</span>a<span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">(</span><a title="a" id="161320">v</a>: <a href="#161291" title="a">a</a><span class="delimiter">)</span>: <a href="StateT.scala.html#10491" title="World.this.ST[Unit]">ST</a><span class="delimiter">[</span>Unit<span class="delimiter">]</span> = <a href="#31673" title="(x: =&gt; Unit)World.this.ST[Unit]">returnST</a> <span class="delimiter">{</span> <a href="#161319" title="World.this.STRef[a]">ref</a>.<a href="#161278" title="(x$1: a)Unit">mutvar</a> = <a href="#161320" title="a">v</a>; <span title="Unit" class="delimiter">(</span><span class="delimiter">)</span> <span class="delimiter">}</span>

        <span class="keyword">def</span> <a title="[a](ref: World.this.STRef[a])(f: a =&gt; a)World.this.ST[Unit]" id="161292">modify</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="161294">a</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="World.this.STRef[a]" id="161340">ref</a>: <a href="#31682" title="World.this.STRef[a]">STRef</a><span class="delimiter">[</span>a<span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">(</span><a title="a =&gt; a" id="161341">f</a>: a =&gt; a<span class="delimiter">)</span>: <a href="StateT.scala.html#10491" title="World.this.ST[Unit]">ST</a><span class="delimiter">[</span>Unit<span class="delimiter">]</span> = <span class="delimiter">{</span>
            <span class="keyword">import</span> <a href="#31671" title="object World.this.ST">ST</a>.=&lt;&lt;:
            <span class="delimiter">(</span><a href="#161289" title="(ref: World.this.STRef[a])(v: a)World.this.ST[Unit]">write</a><a href="package.scala.html#11073" title="(f: a =&gt; World.this.ST[Unit])com.github.okomok.ken.package#Op_.[a,World.this.ST[Unit]]" class="delimiter">(</a><a href="#161340" title="World.this.STRef[a]">ref</a><span class="delimiter">)</span>_ <a href="package.scala.html#11790" title="(g: a =&gt; a)a =&gt; World.this.ST[Unit]">`.`</a> <a href="#161341" title="a =&gt; a">f</a><span class="delimiter">)</span> <a href="Monad.scala.html#23638" title="(f: a =&gt; World.this.ST[Unit])World.this.ST[Unit]">=&lt;&lt;:</a> <a href="#161286" title="(ref: World.this.STRef[a])World.this.ST[a]">read</a><a href="Monad.scala.html#22895" title="(x: World.this.ST[a])World.this.ST.Op_=&lt;&lt;:[a]" class="delimiter">(</a><a href="#161340" title="World.this.STRef[a]">ref</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>

        <span class="keyword">def</span> <a title="[a, b](r: World.this.STRef[a])(f: a =&gt; (a, b))World.this.ST[b]" id="161295">atomicModify</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="161298">a</a>, <a title="&gt;: Nothing &lt;: Any" id="161299">b</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="World.this.STRef[a]" id="161356">r</a>: <a href="#31682" title="World.this.STRef[a]">STRef</a><span class="delimiter">[</span>a<span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">(</span><a title="a =&gt; (a, b)" id="161357">f</a>: a =&gt; <span class="delimiter">(</span>a, b<span class="delimiter">)</span><span class="delimiter">)</span>: <a href="StateT.scala.html#10491" title="World.this.ST[b]">ST</a><span class="delimiter">[</span>b<span class="delimiter">]</span> = <a href="#31673" title="(x: =&gt; b)World.this.ST[b]">returnST</a> <span class="delimiter">{</span>
            <a href="#161356" title="World.this.STRef[a]">r</a>.<span title="(x$1: b)b">synchronized</span> <span class="delimiter">{</span>
                <span class="keyword">val</span> <a href="#177979" title="(a, b)" class="delimiter">(</a><a href="#177978" title="a" id="177979">new_r</a>, <a href="#177978" title="b" id="177980">b</a><span class="delimiter">)</span> = <a href="#161357" title="(v1: a)(a, b)">f</a><span title="(a, b) @unchecked" class="delimiter">(</span><a href="#161356" title="World.this.STRef[a]">r</a>.<a href="#161278" title="=&gt; a">mutvar</a><span class="delimiter">)</span>
                <a href="#161356" title="World.this.STRef[a]">r</a>.<a href="#161278" title="(x$1: a)Unit">mutvar</a> = <a href="#177979" title="a">new_r</a>
                <a href="#177980" title="b">b</a>
            <span class="delimiter">}</span>
        <span class="delimiter">}</span>
    <span class="delimiter">}</span>

    <span class="comment">// STArray</span>
    <span class="comment">//</span>
    <span class="keyword">final</span> case <span class="keyword">class</span> <a title="class STArray[i, e] extends java.lang.Object with ScalaObject with Product with Serializable" id="161479">STArray</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="161482">i</a>, <a title="&gt;: Nothing &lt;: Any" id="161483">e</a><span class="delimiter">]</span><a href="#161479" title="ScalaObject" class="delimiter">(</a><a title="i" id="178091">l</a>: <a href="#161482" title="i">i</a>, <a title="i" id="178092">u</a>: <a href="#161482" title="i">i</a>, <a title="Int" id="178093">n</a>: <span title="Int">Int</span>, <a title="scala.collection.mutable.ArraySeq[e]" id="178094">rep</a>: <span title="scala.collection.mutable.ArraySeq[e]">ArraySeq</span><span class="delimiter">[</span>e<span class="delimiter">]</span><span class="delimiter">)</span> <span class="delimiter">{</span>
        <span class="keyword">override</span> <span class="keyword">def</span> <a title="(that: Any)Boolean" id="161386">equals</a><span class="delimiter">(</span><a title="Any" id="178000">that</a>: <span title="Any">Any</span><span class="delimiter">)</span>: <span title="Boolean">Boolean</span> = <a href="#178000" title="Any">that</a> <span title="Boolean" class="keyword">match</span> <span class="delimiter">{</span>
            <span class="keyword">case</span> <a title="Boolean" id="178002">that</a>: <a href="#161479" title="World.this.STArray[_,_]">STArray</a><span class="delimiter">[</span>_, _<span class="delimiter">]</span> =&gt; <a href="#178094" title="=&gt; scala.collection.mutable.ArraySeq[e]">rep</a>.<span title="(that: Any)Boolean">equals</span><span class="delimiter">(</span><a href="#178002" title="World.this.STArray[_,_]">that</a>.<a href="#178094" title="=&gt; scala.collection.mutable.ArraySeq[_]">rep</a><span class="delimiter">)</span>
            <span class="keyword">case</span> <span title="Boolean(false)">_</span> =&gt; <span title="Boolean(false)" class="keyword">false</span>
        <span class="delimiter">}</span>
        <span class="keyword">override</span> <span class="keyword">def</span> <a title="()Int" id="161387">hashCode</a>: <span title="Int">Int</span> = <a href="#178094" title="=&gt; scala.collection.mutable.ArraySeq[e]">rep</a>.<span title="()Int">hashCode</span>
    <span class="delimiter">}</span>

    <span class="keyword">object</span> <a title="object World.this.STArray" id="31689">STArray</a> <span title="ScalaObject" class="delimiter">{</span>
        <span class="keyword">def</span> <a title="[i, e](rng: (i, i))(initial: e)(implicit ix: com.github.okomok.ken.Ix[i])World.this.ST[World.this.STArray[i,e]]" id="161444">`new`</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="161447">i</a>, <a title="&gt;: Nothing &lt;: Any" id="161448">e</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="(i, i)" id="161489">rng</a>: <span title="(i, i)" class="delimiter">(</span>i, i<span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">(</span><a title="e" id="161490">initial</a>: <a href="#161448" title="e">e</a><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="com.github.okomok.ken.Ix[i]" id="161491">ix</a>: <a href="Ix.scala.html#9971" title="com.github.okomok.ken.Ix[i]">Ix</a><span class="delimiter">[</span>i<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="StateT.scala.html#10491" title="World.this.ST[World.this.STArray[i,e]]">ST</a><span class="delimiter">[</span>STArray<span class="delimiter">[</span>i, e<span class="delimiter">]</span><span class="delimiter">]</span> = <a href="#31673" title="(x: =&gt; World.this.STArray[i,e])World.this.ST[World.this.STArray[i,e]]">returnST</a> <span class="delimiter">{</span> <a href="#161489" title="(i, i)">rng</a> <span title="World.this.STArray[i,e]" class="keyword">match</span> <span class="delimiter">{</span>
            <span class="keyword">case</span> <span title="World.this.STArray[i,e]" class="delimiter">(</span><a title="i" id="178066">l</a>, <a title="i" id="178067">u</a><span class="delimiter">)</span> =&gt; <span class="delimiter">{</span>
                <span class="keyword">val</span> <a title="Int" id="178068">n</a> = <a href="#161491" title="com.github.okomok.ken.Ix[i]">ix</a>.<a href="Ix.scala.html#31117" title="(v1: (i, i))Int">safeRangeSize</a><span class="delimiter">(</span><a href="#161489" title="(i, i)">rng</a><span class="delimiter">)</span>
                <span class="keyword">val</span> <a title="scala.collection.mutable.ArraySeq[e]" id="178069">rep</a> = <span title="object scala.collection.mutable.ArraySeq">ArraySeq</span>.<span title="(n: Int)(elem: =&gt; e)scala.collection.mutable.ArraySeq[e]">fill</span><span class="delimiter">(</span><a href="#178068" title="Int">n</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#161490" title="e">initial</a><span class="delimiter">)</span>
                <a href="#161479" title="(l: i, u: i, n: Int, rep: scala.collection.mutable.ArraySeq[e])World.this.STArray[i,e]">STArray</a><span class="delimiter">(</span><a href="#178066" title="i">l</a>, <a href="#178067" title="i">u</a>, <a href="#178068" title="Int">n</a>, <a href="#178069" title="scala.collection.mutable.ArraySeq[e]">rep</a><span class="delimiter">)</span>
            <span class="delimiter">}</span>
        <span class="delimiter">}</span> <span class="delimiter">}</span>

        <span class="keyword">def</span> <a title="[i, e](marr: World.this.STArray[i,e])(i, i)" id="161449">bounds</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="161452">i</a>, <a title="&gt;: Nothing &lt;: Any" id="161453">e</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="World.this.STArray[i,e]" id="161513">marr</a>: <a href="#161479" title="World.this.STArray[i,e]">STArray</a><span class="delimiter">[</span>i, e<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="(i, i)" class="delimiter">(</span>i, i<span class="delimiter">)</span> = <a href="#161513" title="World.this.STArray[i,e]">marr</a> <span title="(i, i)" class="keyword">match</span> <span class="delimiter">{</span>
            <span class="keyword">case</span> <span title="(i, i)">STArray</span><span class="delimiter">(</span><a title="i" id="178181">l</a>, <a title="i" id="178182">u</a>, _, _<span class="delimiter">)</span> =&gt; <span title="(_1: i, _2: i)(i, i)" class="delimiter">(</span><a href="#178181" title="i">l</a>, <a href="#178182" title="i">u</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>

        <span class="keyword">def</span> <a title="[i, e](marr: World.this.STArray[i,e])Int" id="161454">numElements</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="161457">i</a>, <a title="&gt;: Nothing &lt;: Any" id="161458">e</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="World.this.STArray[i,e]" id="161524">marr</a>: <a href="#161479" title="World.this.STArray[i,e]">STArray</a><span class="delimiter">[</span>i, e<span class="delimiter">]</span><span class="delimiter">)</span>: <span title="Int">Int</span> = <a href="#161524" title="World.this.STArray[i,e]">marr</a> <span title="Int" class="keyword">match</span> <span class="delimiter">{</span>
            <span class="keyword">case</span> <span title="Int">STArray</span><span class="delimiter">(</span>_, _, <a title="Int" id="178193">n</a>, _<span class="delimiter">)</span> =&gt; <a href="#178193" title="Int">n</a>
        <span class="delimiter">}</span>

        <span class="keyword">def</span> <a title="[i, e](marr: World.this.STArray[i,e])(i: i)(implicit ix: com.github.okomok.ken.Ix[i])World.this.ST[e]" id="161459">read</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="161462">i</a>, <a title="&gt;: Nothing &lt;: Any" id="161463">e</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="World.this.STArray[i,e]" id="161541">marr</a>: <a href="#161479" title="World.this.STArray[i,e]">STArray</a><span class="delimiter">[</span>i, e<span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">(</span><a title="i" id="161542">i</a>: <a href="#161462" title="i">i</a><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="com.github.okomok.ken.Ix[i]" id="161543">ix</a>: <a href="Ix.scala.html#9971" title="com.github.okomok.ken.Ix[i]">Ix</a><span class="delimiter">[</span>i<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="StateT.scala.html#10491" title="World.this.ST[e]">ST</a><span class="delimiter">[</span>e<span class="delimiter">]</span> = <a href="#161541" title="World.this.STArray[i,e]">marr</a> <span title="World.this.ST[e]" class="keyword">match</span> <span class="delimiter">{</span>
            <span class="keyword">case</span> <span title="World.this.ST[e]">STArray</span><span class="delimiter">(</span><a title="i" id="178198">l</a>, <a title="i" id="178199">u</a>, <a title="Int" id="178200">n</a>, _<span class="delimiter">)</span> =&gt; <a href="#161464" title="(marr: World.this.STArray[i,e])(i: Int)World.this.ST[e]">unsafeRead</a><span class="delimiter">(</span><a href="#161541" title="World.this.STArray[i,e]">marr</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#161543" title="com.github.okomok.ken.Ix[i]">ix</a>.<a href="Ix.scala.html#31119" title="(v1: (i, i))Int =&gt; i =&gt; Int">safeIndex</a><span title="(v1: Int)i =&gt; Int" class="delimiter">(</span><a href="#178198" title="i">l</a>, <a href="#178199" title="i">u</a><span class="delimiter">)</span><span title="(v1: i)Int" class="delimiter">(</span><a href="#178200" title="Int">n</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#161542" title="i">i</a><span class="delimiter">)</span><span class="delimiter">)</span>
        <span class="delimiter">}</span>

        <span class="keyword">def</span> <a title="[i, e](marr: World.this.STArray[i,e])(i: Int)World.this.ST[e]" id="161464">unsafeRead</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="161467">i</a>, <a title="&gt;: Nothing &lt;: Any" id="161468">e</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="World.this.STArray[i,e]" id="161568">marr</a>: <a href="#161479" title="World.this.STArray[i,e]">STArray</a><span class="delimiter">[</span>i, e<span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">(</span><a title="Int" id="161569">i</a>: <span title="Int">Int</span><span class="delimiter">)</span>: <a href="StateT.scala.html#10491" title="World.this.ST[e]">ST</a><span class="delimiter">[</span>e<span class="delimiter">]</span> = <a href="#31673" title="(x: =&gt; e)World.this.ST[e]">returnST</a> <span class="delimiter">{</span> <a href="#161568" title="World.this.STArray[i,e]">marr</a> <span title="e" class="keyword">match</span> <span class="delimiter">{</span>
            <span class="keyword">case</span> <span title="e">STArray</span><span class="delimiter">(</span>_, _, _, <a title="scala.collection.mutable.ArraySeq[e]" id="178220">rep</a><span class="delimiter">)</span> =&gt; <a href="#178220" title="(idx: Int)e">rep</a><span class="delimiter">(</span><a href="#161569" title="Int">i</a><span class="delimiter">)</span>
        <span class="delimiter">}</span> <span class="delimiter">}</span>

        <span class="keyword">def</span> <a title="[i, e](marr: World.this.STArray[i,e])(i: i)(e: e)(implicit ix: com.github.okomok.ken.Ix[i])World.this.ST[Unit]" id="161469">write</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="161472">i</a>, <a title="&gt;: Nothing &lt;: Any" id="161473">e</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="World.this.STArray[i,e]" id="161589">marr</a>: <a href="#161479" title="World.this.STArray[i,e]">STArray</a><span class="delimiter">[</span>i, e<span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">(</span><a title="i" id="161590">i</a>: <a href="#161472" title="i">i</a><span class="delimiter">)</span><span class="delimiter">(</span><a title="e" id="161591">e</a>: <a href="#161473" title="e">e</a><span class="delimiter">)</span><span class="delimiter">(</span><span class="keyword">implicit</span> <a title="com.github.okomok.ken.Ix[i]" id="161592">ix</a>: <a href="Ix.scala.html#9971" title="com.github.okomok.ken.Ix[i]">Ix</a><span class="delimiter">[</span>i<span class="delimiter">]</span><span class="delimiter">)</span>: <a href="StateT.scala.html#10491" title="World.this.ST[Unit]">ST</a><span class="delimiter">[</span>Unit<span class="delimiter">]</span> = <a href="#161589" title="World.this.STArray[i,e]">marr</a> <span title="World.this.ST[Unit]" class="keyword">match</span> <span class="delimiter">{</span>
            <span class="keyword">case</span> <span title="World.this.ST[Unit]">STArray</span><span class="delimiter">(</span><a title="i" id="178279">l</a>, <a title="i" id="178280">u</a>, <a title="Int" id="178281">n</a>, _<span class="delimiter">)</span> =&gt; <a href="#161474" title="(marr: World.this.STArray[i,e])(i: Int)(e: e)World.this.ST[Unit]">unsafeWrite</a><span class="delimiter">(</span><a href="#161589" title="World.this.STArray[i,e]">marr</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#161592" title="com.github.okomok.ken.Ix[i]">ix</a>.<a href="Ix.scala.html#31119" title="(v1: (i, i))Int =&gt; i =&gt; Int">safeIndex</a><span title="(v1: Int)i =&gt; Int" class="delimiter">(</span><a href="#178279" title="i">l</a>, <a href="#178280" title="i">u</a><span class="delimiter">)</span><span title="(v1: i)Int" class="delimiter">(</span><a href="#178281" title="Int">n</a><span class="delimiter">)</span><span class="delimiter">(</span><a href="#161590" title="i">i</a><span class="delimiter">)</span><span class="delimiter">)</span><span class="delimiter">(</span><a href="#161591" title="e">e</a><span class="delimiter">)</span>
        <span class="delimiter">}</span>

        <span class="keyword">def</span> <a title="[i, e](marr: World.this.STArray[i,e])(i: Int)(e: e)World.this.ST[Unit]" id="161474">unsafeWrite</a><span class="delimiter">[</span><a title="&gt;: Nothing &lt;: Any" id="161477">i</a>, <a title="&gt;: Nothing &lt;: Any" id="161478">e</a><span class="delimiter">]</span><span class="delimiter">(</span><a title="World.this.STArray[i,e]" id="161624">marr</a>: <a href="#161479" title="World.this.STArray[i,e]">STArray</a><span class="delimiter">[</span>i, e<span class="delimiter">]</span><span class="delimiter">)</span><span class="delimiter">(</span><a title="Int" id="161625">i</a>: <span title="Int">Int</span><span class="delimiter">)</span><span class="delimiter">(</span><a title="e" id="161626">e</a>: <a href="#161478" title="e">e</a><span class="delimiter">)</span>: <a href="StateT.scala.html#10491" title="World.this.ST[Unit]">ST</a><span class="delimiter">[</span>Unit<span class="delimiter">]</span> = <a href="#31673" title="(x: =&gt; Unit)World.this.ST[Unit]">returnST</a> <span class="delimiter">{</span> <a href="#161624" title="World.this.STArray[i,e]">marr</a> <span title="Unit" class="keyword">match</span> <span class="delimiter">{</span>
            <span class="keyword">case</span> <span title="Unit">STArray</span><span class="delimiter">(</span>_, _, _, <a title="scala.collection.mutable.ArraySeq[e]" id="178305">rep</a><span class="delimiter">)</span> =&gt; <a href="#178305" title="(idx: Int, elem: e)Unit">rep</a><span class="delimiter">(</span><a href="#161625" title="Int">i</a><span class="delimiter">)</span> = <a href="#161626" title="e">e</a>
        <span class="delimiter">}</span> <span class="delimiter">}</span>
    <span class="delimiter">}</span>
<span class="delimiter">}</span>

        </pre>
    </body>
</html>